(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["vendor"],{

/***/ "../node_modules/css-loader/lib/css-base.js":
/***/ (function(module, exports) {

/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function(useSourceMap) {
	var list = [];

	// return the list of modules as css string
	list.toString = function toString() {
		return this.map(function (item) {
			var content = cssWithMappingToString(item, useSourceMap);
			if(item[2]) {
				return "@media " + item[2] + "{" + content + "}";
			} else {
				return content;
			}
		}).join("");
	};

	// import a list of modules into the list
	list.i = function(modules, mediaQuery) {
		if(typeof modules === "string")
			modules = [[null, modules, ""]];
		var alreadyImportedModules = {};
		for(var i = 0; i < this.length; i++) {
			var id = this[i][0];
			if(typeof id === "number")
				alreadyImportedModules[id] = true;
		}
		for(i = 0; i < modules.length; i++) {
			var item = modules[i];
			// skip already imported module
			// this implementation is not 100% perfect for weird media query combinations
			//  when a module is imported multiple times with different media queries.
			//  I hope this will never occur (Hey this way we have smaller bundles)
			if(typeof item[0] !== "number" || !alreadyImportedModules[item[0]]) {
				if(mediaQuery && !item[2]) {
					item[2] = mediaQuery;
				} else if(mediaQuery) {
					item[2] = "(" + item[2] + ") and (" + mediaQuery + ")";
				}
				list.push(item);
			}
		}
	};
	return list;
};

function cssWithMappingToString(item, useSourceMap) {
	var content = item[1] || '';
	var cssMapping = item[3];
	if (!cssMapping) {
		return content;
	}

	if (useSourceMap && typeof btoa === 'function') {
		var sourceMapping = toComment(cssMapping);
		var sourceURLs = cssMapping.sources.map(function (source) {
			return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'
		});

		return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
	}

	return [content].join('\n');
}

// Adapted from convert-source-map (MIT)
function toComment(sourceMap) {
	// eslint-disable-next-line no-undef
	var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
	var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;

	return '/*# ' + data + ' */';
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/hmr-update.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const hot = __webpack_require__("../node_modules/nativescript-dev-webpack/hot.js");
const file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
function hmrUpdate() {
    const applicationFiles = file_system_1.knownFolders.currentApp();
    const latestHash = __webpack_require__["h"]();
    return hot(latestHash, filename => applicationFiles.getFile(filename));
}
exports.hmrUpdate = hmrUpdate;
//# sourceMappingURL=hmr-update.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var hmr_update_1 = __webpack_require__("../node_modules/nativescript-dev-webpack/hmr/hmr-update.js");
exports.hmrUpdate = hmr_update_1.hmrUpdate;
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hot.js":
/***/ (function(module, exports, __webpack_require__) {

const hmrPrefix = 'HMR:';
const log = {
    info: (message) => console.info(`${hmrPrefix} ${message}`),
    warn: (message) => console.warn(`${hmrPrefix} ${message}`),
    error: (message) => console.error(`${hmrPrefix} ${message}`),
};
const refresh = 'Application needs to be restarted in order to apply the changes.';
const hotOptions = {
    ignoreUnaccepted: false,
    ignoreDeclined: false,
    ignoreErrored: false,
    onUnaccepted(data) {
        const chain = [].concat(data.chain);
        const last = chain[chain.length - 1];

        if (last === 0) {
            chain.pop();
        }

        log.warn(`Ignored an update to unaccepted module: `);
        chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onDeclined(data) {
        log.warn(`Ignored an update to declined module:`);
        data.chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onErrored(data) {
        log.warn(
            `Ignored an error while updating module ${data.moduleId} <${data.type}>`
        );
        log.warn(data.error);
    },
};

let nextHash;
let currentHash;

function upToDate() {
    return nextHash.indexOf(__webpack_require__.h()) >= 0;
}

function result(modules, appliedModules) {
    const unaccepted = modules.filter(
        (moduleId) => appliedModules && appliedModules.indexOf(moduleId) < 0
    );

    if (unaccepted.length > 0) {
        log.warn('The following modules could not be updated:');

        for (const moduleId of unaccepted) {
            log.warn(`          ⦻ ${moduleId}`);
        }
    }

    if (!(appliedModules || []).length) {
        log.info('No Modules Updated.');
    } else {
        log.info('The following modules were updated:');

        for (const moduleId of appliedModules) {
            log.info(`         ↻ ${moduleId}`);
        }

        const numberIds = appliedModules.every(
            (moduleId) => typeof moduleId === 'number'
        );
        if (numberIds) {
            log.info(
                'Please consider using the NamedModulesPlugin for module names.'
            );
        }
    }
}

function check(options) {
    return module.hot
        .check()
        .then((modules) => {
            if (!modules) {
                log.warn(
                    `Cannot find update. ${refresh}`
                );
                return null;
            }

            return module.hot
                .apply(hotOptions)
                .then((appliedModules) => {
                    let nextCheck;
                    if (!upToDate()) {
                        nextCheck = check(options);
                    }

                    result(modules, appliedModules);

                    if (upToDate()) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.info(`Successfully applied update with hmr hash ${currentHash}. App is up to date.`);
                    }

                    return nextCheck || null;
                })
                .catch((err) => {
                    const status = module.hot.status();
                    if (['abort', 'fail'].indexOf(status) >= 0) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.error(`Cannot apply update with hmr hash ${currentHash}.`);
                        log.error(err.message || err.stack);
                    } else {
                        log.error(`Update failed: ${err.message || err.stack}`);
                    }
                });
        })
        .catch((err) => {
            const status = module.hot.status();
            if (['abort', 'fail'].indexOf(status) >= 0) {
                log.error(`Cannot check for update. ${refresh}`);
                log.error(err.message || err.stack);
            } else {
                log.error(`Update check failed: ${err.message || err.stack}`);
            }
        });
}

if (true) {
    log.info('Hot Module Replacement Enabled. Waiting for signal.');
} else {}

function update(latestHash, options) {
    nextHash = latestHash;
    if (!upToDate()) {
        const status = module.hot.status();

        if (status === 'idle') {
            //Do not modify message - CLI depends on this exact content to determine hmr operation status.
            log.info(`Checking for updates to the bundle with hmr hash ${currentHash}.`);
            return check(options);
        } else if (['abort', 'fail'].indexOf(status) >= 0) {
            log.warn(
                `Cannot apply update. A previous update ${status}ed. ${refresh}`
            );
        }
    }
};

function getNextHash(hash, getFileContent) {
    const file = getFileContent(`${hash}.hot-update.json`);
    return file.readText().then(hotUpdateContent => {
        if (hotUpdateContent) {
            const manifest = JSON.parse(hotUpdateContent);
            const newHash = manifest.h;
            return getNextHash(newHash, getFileContent);
        } else {
            return Promise.resolve(hash);
        }
    }).catch(error => Promise.reject(error));
}

module.exports = function checkState(initialHash, getFileContent) {
    currentHash = initialHash;
    return getNextHash(initialHash, getFileContent).then(nextHash => {
        if (nextHash != initialHash) {
            return update(nextHash, {});
        }
    })
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css-angular.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {const loadCss = __webpack_require__("../node_modules/nativescript-dev-webpack/load-application-css.js");

module.exports = function() {
    loadCss(function() {
        global.registerModule("./app.css", () => __webpack_require__("./app.scss"));
    });
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css.js":
/***/ (function(module, exports, __webpack_require__) {

module.exports = function (loadModuleFn) {
    const application = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
    __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");

    loadModuleFn();

    application.loadAppCss();
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js":
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "../node_modules/tns-core-modules/application/application-common.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var events = new observable_1.Observable();
var launched = false;
function setLaunched() {
    launched = true;
    events.off("launch", setLaunched);
}
events.on("launch", setLaunched);
if (profiling_1.level() > 0) {
    events.on("displayed", function () {
        var duration = profiling_1.uptime();
        var end = profiling_1.time();
        var start = end - duration;
        profiling_1.trace("Displayed in " + duration.toFixed(2) + "ms", start, end);
    });
}
function hasLaunched() {
    return launched;
}
exports.hasLaunched = hasLaunched;
exports.launchEvent = "launch";
exports.suspendEvent = "suspend";
exports.displayedEvent = "displayed";
exports.resumeEvent = "resume";
exports.exitEvent = "exit";
exports.lowMemoryEvent = "lowMemory";
exports.uncaughtErrorEvent = "uncaughtError";
exports.discardedErrorEvent = "discardedError";
exports.orientationChangedEvent = "orientationChanged";
var cssFile = "./app.css";
var resources = {};
function getResources() {
    return resources;
}
exports.getResources = getResources;
function setResources(res) {
    resources = res;
}
exports.setResources = setResources;
exports.android = undefined;
exports.ios = undefined;
exports.on = events.on.bind(events);
exports.off = events.off.bind(events);
exports.notify = events.notify.bind(events);
exports.hasListeners = events.hasListeners.bind(events);
var app;
function setApplication(instance) {
    app = instance;
}
exports.setApplication = setApplication;
function livesync(rootView, context) {
    events.notify({ eventName: "livesync", object: app });
    var liveSyncCore = global.__onLiveSyncCore;
    var reapplyAppStyles = false;
    if (context && context.path) {
        var styleExtensions = ["css", "scss"];
        var appStylesFullFileName = getCssFileName();
        var appStylesFileName_1 = appStylesFullFileName.substring(0, appStylesFullFileName.lastIndexOf(".") + 1);
        reapplyAppStyles = styleExtensions.some(function (ext) { return context.path === appStylesFileName_1.concat(ext); });
    }
    if (reapplyAppStyles && rootView) {
        rootView._onCssStateChange();
    }
    else if (liveSyncCore) {
        liveSyncCore(context);
    }
}
exports.livesync = livesync;
function setCssFileName(cssFileName) {
    cssFile = cssFileName;
    events.notify({ eventName: "cssChanged", object: app, cssFile: cssFileName });
}
exports.setCssFileName = setCssFileName;
function getCssFileName() {
    return cssFile;
}
exports.getCssFileName = getCssFileName;
function loadAppCss() {
    try {
        events.notify({ eventName: "loadAppCss", object: app, cssFile: getCssFileName() });
    }
    catch (e) {
        throw new Error("The file " + getCssFileName() + " couldn't be loaded! " +
            "You may need to register it inside ./app/vendor.ts.");
    }
}
exports.loadAppCss = loadAppCss;
function addCss(cssText) {
    events.notify({ eventName: "cssChanged", object: app, cssText: cssText });
}
exports.addCss = addCss;
global.__onUncaughtError = function (error) {
    events.notify({ eventName: exports.uncaughtErrorEvent, object: app, android: error, ios: error, error: error });
};
global.__onDiscardedError = function (error) {
    events.notify({ eventName: exports.discardedErrorEvent, object: app, error: error });
};
//# sourceMappingURL=application-common.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/application/application.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application_common_1 = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/application/application-common.js"));
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var getVisibleViewController = utils_1.ios.getVisibleViewController;
var Responder = UIResponder.extend({
    get window() {
        return iosApp ? iosApp.window : undefined;
    },
    set window(setWindow) {
    }
}, {
    protocols: [UIApplicationDelegate]
});
var NotificationObserver = (function (_super) {
    __extends(NotificationObserver, _super);
    function NotificationObserver() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NotificationObserver.initWithCallback = function (onReceiveCallback) {
        var observer = _super.new.call(this);
        observer._onReceiveCallback = onReceiveCallback;
        return observer;
    };
    NotificationObserver.prototype.onReceive = function (notification) {
        this._onReceiveCallback(notification);
    };
    NotificationObserver.ObjCExposedMethods = {
        "onReceive": { returns: interop.types.void, params: [NSNotification] }
    };
    return NotificationObserver;
}(NSObject));
var displayedOnce = false;
var displayedLinkTarget;
var displayedLink;
var CADisplayLinkTarget = (function (_super) {
    __extends(CADisplayLinkTarget, _super);
    function CADisplayLinkTarget() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CADisplayLinkTarget.prototype.onDisplayed = function (link) {
        link.invalidate();
        var ios = UIApplication.sharedApplication;
        var object = iosApp;
        displayedOnce = true;
        application_common_1.notify({ eventName: application_common_1.displayedEvent, object: object, ios: ios });
        displayedLinkTarget = null;
        displayedLink = null;
    };
    CADisplayLinkTarget.ObjCExposedMethods = {
        "onDisplayed": { returns: interop.types.void, params: [CADisplayLink] }
    };
    return CADisplayLinkTarget;
}(NSObject));
var IOSApplication = (function () {
    function IOSApplication() {
        this._currentOrientation = UIDevice.currentDevice.orientation;
        this._observers = new Array();
        this.addNotificationObserver(UIApplicationDidFinishLaunchingNotification, this.didFinishLaunchingWithOptions.bind(this));
        this.addNotificationObserver(UIApplicationDidBecomeActiveNotification, this.didBecomeActive.bind(this));
        this.addNotificationObserver(UIApplicationDidEnterBackgroundNotification, this.didEnterBackground.bind(this));
        this.addNotificationObserver(UIApplicationWillTerminateNotification, this.willTerminate.bind(this));
        this.addNotificationObserver(UIApplicationDidReceiveMemoryWarningNotification, this.didReceiveMemoryWarning.bind(this));
        this.addNotificationObserver(UIDeviceOrientationDidChangeNotification, this.orientationDidChange.bind(this));
    }
    Object.defineProperty(IOSApplication.prototype, "rootController", {
        get: function () {
            return this._window.rootViewController;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "nativeApp", {
        get: function () {
            return UIApplication.sharedApplication;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "window", {
        get: function () {
            return this._window;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "delegate", {
        get: function () {
            return this._delegate;
        },
        set: function (value) {
            if (this._delegate !== value) {
                this._delegate = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "rootView", {
        get: function () {
            return this._rootView;
        },
        enumerable: true,
        configurable: true
    });
    IOSApplication.prototype.addNotificationObserver = function (notificationName, onReceiveCallback) {
        var observer = NotificationObserver.initWithCallback(onReceiveCallback);
        NSNotificationCenter.defaultCenter.addObserverSelectorNameObject(observer, "onReceive", notificationName, null);
        this._observers.push(observer);
        return observer;
    };
    IOSApplication.prototype.removeNotificationObserver = function (observer, notificationName) {
        var index = this._observers.indexOf(observer);
        if (index >= 0) {
            this._observers.splice(index, 1);
            NSNotificationCenter.defaultCenter.removeObserverNameObject(observer, notificationName, null);
        }
    };
    IOSApplication.prototype.didFinishLaunchingWithOptions = function (notification) {
        if (!displayedOnce) {
            displayedLinkTarget = CADisplayLinkTarget.new();
            displayedLink = CADisplayLink.displayLinkWithTargetSelector(displayedLinkTarget, "onDisplayed");
            displayedLink.addToRunLoopForMode(NSRunLoop.mainRunLoop, NSDefaultRunLoopMode);
            displayedLink.addToRunLoopForMode(NSRunLoop.mainRunLoop, UITrackingRunLoopMode);
        }
        this._window = UIWindow.alloc().initWithFrame(UIScreen.mainScreen.bounds);
        this._window.backgroundColor = UIColor.whiteColor;
        this.notifyAppStarted(notification);
    };
    IOSApplication.prototype.notifyAppStarted = function (notification) {
        var args = {
            eventName: application_common_1.launchEvent,
            object: this,
            ios: notification && notification.userInfo && notification.userInfo.objectForKey("UIApplicationLaunchOptionsLocalNotificationKey") || null
        };
        application_common_1.notify(args);
        application_common_1.notify({ eventName: "loadAppCss", object: this, cssFile: application_common_1.getCssFileName() });
        if (this._window) {
            this.setWindowContent(args.root);
        }
        else {
            this._window = UIApplication.sharedApplication.delegate.window;
        }
    };
    IOSApplication.prototype.didBecomeActive = function (notification) {
        var ios = UIApplication.sharedApplication;
        var object = this;
        application_common_1.notify({ eventName: application_common_1.resumeEvent, object: object, ios: ios });
        var rootView = this._rootView;
        if (rootView && !rootView.isLoaded) {
            rootView.callLoaded();
        }
    };
    IOSApplication.prototype.didEnterBackground = function (notification) {
        application_common_1.notify({ eventName: application_common_1.suspendEvent, object: this, ios: UIApplication.sharedApplication });
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    IOSApplication.prototype.willTerminate = function (notification) {
        application_common_1.notify({ eventName: application_common_1.exitEvent, object: this, ios: UIApplication.sharedApplication });
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    IOSApplication.prototype.didReceiveMemoryWarning = function (notification) {
        application_common_1.notify({ eventName: application_common_1.lowMemoryEvent, object: this, ios: UIApplication.sharedApplication });
    };
    IOSApplication.prototype.orientationDidChange = function (notification) {
        var orientation = UIDevice.currentDevice.orientation;
        if (this._currentOrientation !== orientation) {
            this._currentOrientation = orientation;
            var newValue = void 0;
            switch (orientation) {
                case 4:
                case 3:
                    newValue = "landscape";
                    break;
                case 1:
                case 2:
                    newValue = "portrait";
                    break;
                default:
                    newValue = "unknown";
                    break;
            }
            application_common_1.notify({
                eventName: application_common_1.orientationChangedEvent,
                ios: this,
                newValue: newValue,
                object: this
            });
        }
    };
    IOSApplication.prototype._onLivesync = function (context) {
        var isAppRootModuleChanged = context && context.path && context.path.includes(getMainEntry().moduleName) && context.type !== "style";
        if (isAppRootModuleChanged || (this._rootView && !this._rootView._onLivesync(context))) {
            this.setWindowContent();
        }
    };
    IOSApplication.prototype.setWindowContent = function (view) {
        if (this._rootView) {
            this._rootView._onRootViewReset();
        }
        var rootView = createRootView(view);
        var controller = getViewController(rootView);
        this._rootView = rootView;
        if (createRootFrame.value) {
            rootView._setupUI({});
        }
        else {
            rootView._setupAsRootView({});
        }
        setViewControllerView(rootView);
        var haveController = this._window.rootViewController !== null;
        this._window.rootViewController = controller;
        if (!haveController) {
            this._window.makeKeyAndVisible();
        }
    };
    __decorate([
        profiling_1.profile
    ], IOSApplication.prototype, "didFinishLaunchingWithOptions", null);
    __decorate([
        profiling_1.profile
    ], IOSApplication.prototype, "didBecomeActive", null);
    return IOSApplication;
}());
var iosApp = new IOSApplication();
exports.ios = iosApp;
application_common_1.setApplication(iosApp);
global.__onLiveSyncCore = function (context) {
    iosApp._onLivesync(context);
};
var mainEntry;
function createRootView(v) {
    var rootView = v;
    if (!rootView) {
        if (!mainEntry) {
            throw new Error("Main entry is missing. App cannot be started. Verify app bootstrap.");
        }
        else {
            if (createRootFrame.value) {
                var frame = rootView = new frame_1.Frame();
                frame.navigate(mainEntry);
            }
            else {
                rootView = builder_1.createViewFromEntry(mainEntry);
            }
        }
    }
    return rootView;
}
function getMainEntry() {
    return mainEntry;
}
exports.getMainEntry = getMainEntry;
function getRootView() {
    return iosApp.rootView;
}
exports.getRootView = getRootView;
var createRootFrame = { value: true };
var started = false;
function _start(entry) {
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    started = true;
    if (!iosApp.nativeApp) {
        UIApplicationMain(0, null, null, iosApp && iosApp.delegate ? NSStringFromClass(iosApp.delegate) : NSStringFromClass(Responder));
    }
    else {
        var rootView = createRootView();
        if (rootView) {
            var window_1 = iosApp.nativeApp.keyWindow || (iosApp.nativeApp.windows.count > 0 && iosApp.nativeApp.windows[0]);
            if (window_1) {
                var rootController = window_1.rootViewController;
                if (rootController) {
                    var controller = getViewController(rootView);
                    rootView._setupAsRootView({});
                    var embedderDelegate = NativeScriptEmbedder.sharedInstance().delegate;
                    if (embedderDelegate) {
                        embedderDelegate.presentNativeScriptApp(controller);
                    }
                    else {
                        var visibleVC = getVisibleViewController(rootController);
                        visibleVC.presentViewControllerAnimatedCompletion(controller, true, null);
                    }
                    iosApp.notifyAppStarted();
                }
            }
        }
    }
}
exports._start = _start;
function run(entry) {
    createRootFrame.value = false;
    _start(entry);
}
exports.run = run;
function _resetRootView(entry) {
    createRootFrame.value = false;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    iosApp.setWindowContent();
}
exports._resetRootView = _resetRootView;
function getNativeApplication() {
    return iosApp.nativeApp;
}
exports.getNativeApplication = getNativeApplication;
function getViewController(view) {
    var viewController = view.viewController || view.ios;
    if (viewController instanceof UIViewController) {
        return viewController;
    }
    else {
        viewController = view_1.ios.UILayoutViewController.initWithOwner(new WeakRef(view));
        view.viewController = viewController;
        return viewController;
    }
}
function setViewControllerView(view) {
    var viewController = view.viewController || view.ios;
    var nativeView = view.ios || view.nativeViewProtected;
    if (!nativeView || !viewController) {
        throw new Error("Root should be either UIViewController or UIView");
    }
    if (viewController instanceof view_1.ios.UILayoutViewController) {
        viewController.view.addSubview(nativeView);
    }
}
global.__onLiveSync = function __onLiveSync(context) {
    if (!started) {
        return;
    }
    var rootView = getRootView();
    application_common_1.livesync(rootView, context);
};
//# sourceMappingURL=application.ios.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/bundle-entry-points.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {if (true) {
    __webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
    global.registerModule("text/formatted-string", function () { return __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js"); });
    global.registerModule("text/span", function () { return __webpack_require__("../node_modules/tns-core-modules/text/span.js"); });
    global.registerModule("ui/action-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js"); });
    global.registerModule("ui/activity-indicator", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js"); });
    global.registerModule("ui/border", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/border/border.js"); });
    global.registerModule("ui/bottom-navigation", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js"); });
    global.registerModule("ui/button", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js"); });
    global.registerModule("ui/content-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"); });
    global.registerModule("ui/date-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker.js"); });
    global.registerModule("ui/frame", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js"); });
    global.registerModule("ui/html-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view.js"); });
    global.registerModule("ui/image", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/image/image.js"); });
    global.registerModule("ui/label", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js"); });
    global.registerModule("ui/layouts/absolute-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js"); });
    global.registerModule("ui/layouts/dock-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js"); });
    global.registerModule("ui/layouts/grid-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js"); });
    global.registerModule("ui/layouts/stack-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js"); });
    global.registerModule("ui/layouts/flexbox-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js"); });
    global.registerModule("ui/layouts/wrap-layout", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js"); });
    global.registerModule("ui/list-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker.js"); });
    global.registerModule("ui/page", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/page/page.js"); });
    global.registerModule("ui/placeholder", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/placeholder/placeholder.js"); });
    global.registerModule("ui/progress", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress.js"); });
    global.registerModule("ui/proxy-view-container", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js"); });
    global.registerModule("ui/repeater", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/repeater/repeater.js"); });
    global.registerModule("ui/scroll-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js"); });
    global.registerModule("ui/search-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar.js"); });
    global.registerModule("ui/segmented-bar", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js"); });
    global.registerModule("ui/slider", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider.js"); });
    global.registerModule("ui/switch", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch.js"); });
    global.registerModule("ui/tab-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"); });
    global.registerModule("ui/tab-navigation-base/tab-strip-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"); });
    global.registerModule("ui/tab-navigation-base/tab-content-item", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"); });
    global.registerModule("ui/tabs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs.js"); });
    global.registerModule("ui/web-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view.js"); });
    global.registerModule("ui/text-field", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js"); });
    global.registerModule("ui/text-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/text-view/text-view.js"); });
    global.registerModule("ui/time-picker", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker.js"); });
    global.registerModule("ui/list-view", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view.js"); });
}
//# sourceMappingURL=bundle-entry-points.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var knownColors = __webpack_require__("../node_modules/tns-core-modules/color/known-colors.js");
var SHARP = "#";
var HEX_REGEX = /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i;
var Color = (function () {
    function Color() {
        if (arguments.length === 1) {
            var arg = arguments[0];
            if (types.isString(arg)) {
                if (isRgbOrRgba(arg)) {
                    this._argb = argbFromRgbOrRgba(arg);
                }
                else if (knownColors.isKnownName(arg)) {
                    var hex = knownColors.getKnownColor(arg);
                    this._name = arg;
                    this._argb = this._argbFromString(hex);
                }
                else if (HEX_REGEX.test(arg)) {
                    var hex = this._normalizeHex(arg);
                    this._argb = this._argbFromString(hex);
                }
                else {
                    throw new Error("Invalid color: " + arg);
                }
            }
            else if (types.isNumber(arg)) {
                this._argb = arg >>> 0;
            }
            else {
                throw new Error("Expected 1 or 4 constructor parameters.");
            }
        }
        else if (arguments.length === 4) {
            this._argb = (arguments[0] & 0xFF) * 0x01000000
                + (arguments[1] & 0xFF) * 0x00010000
                + (arguments[2] & 0xFF) * 0x00000100
                + (arguments[3] & 0xFF) * 0x00000001;
        }
        else {
            throw new Error("Expected 1 or 4 constructor parameters.");
        }
    }
    Object.defineProperty(Color.prototype, "a", {
        get: function () { return (this._argb / 0x01000000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "r", {
        get: function () { return (this._argb / 0x00010000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "g", {
        get: function () { return (this._argb / 0x00000100) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "b", {
        get: function () { return (this._argb / 0x00000001) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "argb", {
        get: function () {
            return this._argb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "hex", {
        get: function () {
            if (this.a === 0xFF) {
                return ("#" + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
            else {
                return ("#" + this._componentToHex(this.a) + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Color.prototype._argbFromString = function (hex) {
        if (hex.charAt(0) === "#") {
            hex = hex.substr(1);
        }
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        else if (hex.length === 4) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];
        }
        var intVal = parseInt(hex, 16);
        if (hex.length === 6) {
            intVal = (intVal & 0x00FFFFFF) + 0xFF000000;
        }
        return intVal;
    };
    Color.prototype.equals = function (value) {
        return value && this.argb === value.argb;
    };
    Color.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.equals(value2);
    };
    Color.isValid = function (value) {
        if (types.isNullOrUndefined(value) || value instanceof Color) {
            return true;
        }
        if (!types.isString(value)) {
            return false;
        }
        if (knownColors.isKnownName(value)) {
            return true;
        }
        return HEX_REGEX.test(value) || isRgbOrRgba(value);
    };
    Color.prototype._componentToHex = function (component) {
        var hex = component.toString(16);
        if (hex.length === 1) {
            hex = "0" + hex;
        }
        return hex;
    };
    Color.prototype._normalizeHex = function (hexStr) {
        if (hexStr.charAt(0) === SHARP && hexStr.length === 4) {
            hexStr = hexStr.charAt(0)
                + hexStr.charAt(1) + hexStr.charAt(1)
                + hexStr.charAt(2) + hexStr.charAt(2)
                + hexStr.charAt(3) + hexStr.charAt(3);
        }
        return hexStr;
    };
    Color.prototype.toString = function () {
        return this.hex;
    };
    return Color;
}());
exports.Color = Color;
function isRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    return (toLower.indexOf("rgb(") === 0 || toLower.indexOf("rgba(") === 0) && toLower.indexOf(")") === (toLower.length - 1);
}
function argbFromRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    var parts = toLower.replace("rgba(", "").replace("rgb(", "").replace(")", "").trim().split(",");
    var r = 255;
    var g = 255;
    var b = 255;
    var a = 255;
    if (parts[0]) {
        r = parseInt(parts[0].trim());
    }
    if (parts[1]) {
        g = parseInt(parts[1].trim());
    }
    if (parts[2]) {
        b = parseInt(parts[2].trim());
    }
    if (parts[3]) {
        a = Math.round(parseFloat(parts[3].trim()) * 255);
    }
    return (a & 0xFF) * 0x01000000
        + (r & 0xFF) * 0x00010000
        + (g & 0xFF) * 0x00000100
        + (b & 0xFF) * 0x00000001;
}
//# sourceMappingURL=color-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var common = __webpack_require__("../node_modules/tns-core-modules/color/color-common.js");
var Color = (function (_super) {
    __extends(Color, _super);
    function Color() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            if (!this._ios) {
                this._ios = UIColor.alloc().initWithRedGreenBlueAlpha(this.r / 255, this.g / 255, this.b / 255, this.a / 255);
            }
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    return Color;
}(common.Color));
exports.Color = Color;
//# sourceMappingURL=color.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/known-colors.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _allColors = {};
function registerColor(name, value) {
    _allColors[name.toLowerCase()] = value;
    return value;
}
function isKnownName(name) {
    if (!name) {
        return undefined;
    }
    return name.toLowerCase() in _allColors;
}
exports.isKnownName = isKnownName;
function getKnownColor(name) {
    if (!name) {
        return undefined;
    }
    return _allColors[name.toLowerCase()];
}
exports.getKnownColor = getKnownColor;
exports.Transparent = registerColor("Transparent", "#00000000");
exports.AliceBlue = registerColor("AliceBlue", "#F0F8FF");
exports.AntiqueWhite = registerColor("AntiqueWhite", "#FAEBD7");
exports.Aqua = registerColor("Aqua", "#00FFFF");
exports.Aquamarine = registerColor("Aquamarine", "#7FFFD4");
exports.Azure = registerColor("Azure", "#F0FFFF");
exports.Beige = registerColor("Beige", "#F5F5DC");
exports.Bisque = registerColor("Bisque", "#FFE4C4");
exports.Black = registerColor("Black", "#000000");
exports.BlanchedAlmond = registerColor("BlanchedAlmond", "#FFEBCD");
exports.Blue = registerColor("Blue", "#0000FF");
exports.BlueViolet = registerColor("BlueViolet", "#8A2BE2");
exports.Brown = registerColor("Brown", "#A52A2A");
exports.BurlyWood = registerColor("BurlyWood", "#DEB887");
exports.CadetBlue = registerColor("CadetBlue", "#5F9EA0");
exports.Chartreuse = registerColor("Chartreuse", "#7FFF00");
exports.Chocolate = registerColor("Chocolate", "#D2691E");
exports.Coral = registerColor("Coral", "#FF7F50");
exports.CornflowerBlue = registerColor("CornflowerBlue", "#6495ED");
exports.Cornsilk = registerColor("Cornsilk", "#FFF8DC");
exports.Crimson = registerColor("Crimson", "#DC143C");
exports.Cyan = registerColor("Cyan", "#00FFFF");
exports.DarkBlue = registerColor("DarkBlue", "#00008B");
exports.DarkCyan = registerColor("DarkCyan", "#008B8B");
exports.DarkGoldenRod = registerColor("DarkGoldenRod", "#B8860B");
exports.DarkGray = registerColor("DarkGray", "#A9A9A9");
exports.DarkGreen = registerColor("DarkGreen", "#006400");
exports.DarkKhaki = registerColor("DarkKhaki", "#BDB76B");
exports.DarkMagenta = registerColor("DarkMagenta", "#8B008B");
exports.DarkOliveGreen = registerColor("DarkOliveGreen", "#556B2F");
exports.DarkOrange = registerColor("DarkOrange", "#FF8C00");
exports.DarkOrchid = registerColor("DarkOrchid", "#9932CC");
exports.DarkRed = registerColor("DarkRed", "#8B0000");
exports.DarkSalmon = registerColor("DarkSalmon", "#E9967A");
exports.DarkSeaGreen = registerColor("DarkSeaGreen", "#8FBC8F");
exports.DarkSlateBlue = registerColor("DarkSlateBlue", "#483D8B");
exports.DarkSlateGray = registerColor("DarkSlateGray", "#2F4F4F");
exports.DarkTurquoise = registerColor("DarkTurquoise", "#00CED1");
exports.DarkViolet = registerColor("DarkViolet", "#9400D3");
exports.DeepPink = registerColor("DeepPink", "#FF1493");
exports.DeepSkyBlue = registerColor("DeepSkyBlue", "#00BFFF");
exports.DimGray = registerColor("DimGray", "#696969");
exports.DodgerBlue = registerColor("DodgerBlue", "#1E90FF");
exports.FireBrick = registerColor("FireBrick", "#B22222");
exports.FloralWhite = registerColor("FloralWhite", "#FFFAF0");
exports.ForestGreen = registerColor("ForestGreen", "#228B22");
exports.Fuchsia = registerColor("Fuchsia", "#FF00FF");
exports.Gainsboro = registerColor("Gainsboro", "#DCDCDC");
exports.GhostWhite = registerColor("GhostWhite", "#F8F8FF");
exports.Gold = registerColor("Gold", "#FFD700");
exports.GoldenRod = registerColor("GoldenRod", "#DAA520");
exports.Gray = registerColor("Gray", "#808080");
exports.Green = registerColor("Green", "#008000");
exports.GreenYellow = registerColor("GreenYellow", "#ADFF2F");
exports.HoneyDew = registerColor("HoneyDew", "#F0FFF0");
exports.HotPink = registerColor("HotPink", "#FF69B4");
exports.IndianRed = registerColor("IndianRed", "#CD5C5C");
exports.Indigo = registerColor("Indigo", "#4B0082");
exports.Ivory = registerColor("Ivory", "#FFFFF0");
exports.Khaki = registerColor("Khaki", "#F0E68C");
exports.Lavender = registerColor("Lavender", "#E6E6FA");
exports.LavenderBlush = registerColor("LavenderBlush", "#FFF0F5");
exports.LawnGreen = registerColor("LawnGreen", "#7CFC00");
exports.LemonChiffon = registerColor("LemonChiffon", "#FFFACD");
exports.LightBlue = registerColor("LightBlue", "#ADD8E6");
exports.LightCoral = registerColor("LightCoral", "#F08080");
exports.LightCyan = registerColor("LightCyan", "#E0FFFF");
exports.LightGoldenRodYellow = registerColor("LightGoldenRodYellow", "#FAFAD2");
exports.LightGray = registerColor("LightGray", "#D3D3D3");
exports.LightGreen = registerColor("LightGreen", "#90EE90");
exports.LightPink = registerColor("LightPink", "#FFB6C1");
exports.LightSalmon = registerColor("LightSalmon", "#FFA07A");
exports.LightSeaGreen = registerColor("LightSeaGreen", "#20B2AA");
exports.LightSkyBlue = registerColor("LightSkyBlue", "#87CEFA");
exports.LightSlateGray = registerColor("LightSlateGray", "#778899");
exports.LightSteelBlue = registerColor("LightSteelBlue", "#B0C4DE");
exports.LightYellow = registerColor("LightYellow", "#FFFFE0");
exports.Lime = registerColor("Lime", "#00FF00");
exports.LimeGreen = registerColor("LimeGreen", "#32CD32");
exports.Linen = registerColor("Linen", "#FAF0E6");
exports.Magenta = registerColor("Magenta", "#FF00FF");
exports.Maroon = registerColor("Maroon", "#800000");
exports.MediumAquaMarine = registerColor("MediumAquaMarine", "#66CDAA");
exports.MediumBlue = registerColor("MediumBlue", "#0000CD");
exports.MediumOrchid = registerColor("MediumOrchid", "#BA55D3");
exports.MediumPurple = registerColor("MediumPurple", "#9370DB");
exports.MediumSeaGreen = registerColor("MediumSeaGreen", "#3CB371");
exports.MediumSlateBlue = registerColor("MediumSlateBlue", "#7B68EE");
exports.MediumSpringGreen = registerColor("MediumSpringGreen", "#00FA9A");
exports.MediumTurquoise = registerColor("MediumTurquoise", "#48D1CC");
exports.MediumVioletRed = registerColor("MediumVioletRed", "#C71585");
exports.MidnightBlue = registerColor("MidnightBlue", "#191970");
exports.MintCream = registerColor("MintCream", "#F5FFFA");
exports.MistyRose = registerColor("MistyRose", "#FFE4E1");
exports.Moccasin = registerColor("Moccasin", "#FFE4B5");
exports.NavajoWhite = registerColor("NavajoWhite", "#FFDEAD");
exports.Navy = registerColor("Navy", "#000080");
exports.OldLace = registerColor("OldLace", "#FDF5E6");
exports.Olive = registerColor("Olive", "#808000");
exports.OliveDrab = registerColor("OliveDrab", "#6B8E23");
exports.Orange = registerColor("Orange", "#FFA500");
exports.OrangeRed = registerColor("OrangeRed", "#FF4500");
exports.Orchid = registerColor("Orchid", "#DA70D6");
exports.PaleGoldenRod = registerColor("PaleGoldenRod", "#EEE8AA");
exports.PaleGreen = registerColor("PaleGreen", "#98FB98");
exports.PaleTurquoise = registerColor("PaleTurquoise", "#AFEEEE");
exports.PaleVioletRed = registerColor("PaleVioletRed", "#DB7093");
exports.PapayaWhip = registerColor("PapayaWhip", "#FFEFD5");
exports.PeachPuff = registerColor("PeachPuff", "#FFDAB9");
exports.Peru = registerColor("Peru", "#CD853F");
exports.Pink = registerColor("Pink", "#FFC0CB");
exports.Plum = registerColor("Plum", "#DDA0DD");
exports.PowderBlue = registerColor("PowderBlue", "#B0E0E6");
exports.Purple = registerColor("Purple", "#800080");
exports.RebeccaPurple = registerColor("RebeccaPurple", "#663399");
exports.Red = registerColor("Red", "#FF0000");
exports.RosyBrown = registerColor("RosyBrown", "#BC8F8F");
exports.RoyalBlue = registerColor("RoyalBlue", "#4169E1");
exports.SaddleBrown = registerColor("SaddleBrown", "#8B4513");
exports.Salmon = registerColor("Salmon", "#FA8072");
exports.SandyBrown = registerColor("SandyBrown", "#F4A460");
exports.SeaGreen = registerColor("SeaGreen", "#2E8B57");
exports.SeaShell = registerColor("SeaShell", "#FFF5EE");
exports.Sienna = registerColor("Sienna", "#A0522D");
exports.Silver = registerColor("Silver", "#C0C0C0");
exports.SkyBlue = registerColor("SkyBlue", "#87CEEB");
exports.SlateBlue = registerColor("SlateBlue", "#6A5ACD");
exports.SlateGray = registerColor("SlateGray", "#708090");
exports.Snow = registerColor("Snow", "#FFFAFA");
exports.SpringGreen = registerColor("SpringGreen", "#00FF7F");
exports.SteelBlue = registerColor("SteelBlue", "#4682B4");
exports.Tan = registerColor("Tan", "#D2B48C");
exports.Teal = registerColor("Teal", "#008080");
exports.Thistle = registerColor("Thistle", "#D8BFD8");
exports.Tomato = registerColor("Tomato", "#FF6347");
exports.Turquoise = registerColor("Turquoise", "#40E0D0");
exports.Violet = registerColor("Violet", "#EE82EE");
exports.Wheat = registerColor("Wheat", "#F5DEB3");
exports.White = registerColor("White", "#FFFFFF");
exports.WhiteSmoke = registerColor("WhiteSmoke", "#F5F5F5");
exports.Yellow = registerColor("Yellow", "#FFFF00");
exports.YellowGreen = registerColor("YellowGreen", "#9ACD32");
//# sourceMappingURL=known-colors.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/console/console.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var Console = (function () {
    function Console() {
    }
    Console.prototype.time = function (reportName) {
    };
    Console.prototype.timeEnd = function (reportName) {
    };
    Console.prototype.assert = function (test, message) {
    };
    Console.prototype.info = function (message) {
    };
    Console.prototype.warn = function (message) {
    };
    Console.prototype.error = function (message) {
    };
    Console.prototype.log = function (message) {
    };
    Console.prototype.trace = function () {
    };
    Console.prototype.dir = function (obj) {
    };
    return Console;
}());
exports.Console = Console;
//# sourceMappingURL=console.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css-value/index.js":
/***/ (function(module, exports) {


exports.parse = parse;

function parse(str) {
  return new Parser(str).parse();
}

function Parser(str) {
  this.str = str;
}

Parser.prototype.skip = function(m){
  this.str = this.str.slice(m[0].length);
};

Parser.prototype.comma = function(){
  var m = /^, */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return { type: 'comma', string: ',' };
};

Parser.prototype.ident = function(){
  var m = /^([\w-]+) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return {
    type: 'ident',
    string: m[1]
  }
};

Parser.prototype.int = function(){
  var m = /^(([-\+]?\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = ~~m[2];
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.float = function(){
  var m = /^(((?:[-\+]?\d+)?\.\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = parseFloat(m[2]);
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.number = function(){
  return this.float() || this.int();
};

Parser.prototype.double = function(){
  var m = /^"([^"]*)" */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: '"',
    string: '"' + m[1] + '"',
    value: m[1]
  }
};

Parser.prototype.single = function(){
  var m = /^'([^']*)' */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: "'",
    string: "'" + m[1] + "'",
    value: m[1]
  }
};

Parser.prototype.string = function(){
  return this.single() || this.double();
};


Parser.prototype.value = function(){
  return this.number()
    || this.ident()
    || this.string()
    || this.comma();
};

Parser.prototype.parse = function(){
  var vals = [];

  while (this.str.length) {
    var obj = this.value();
    if (!obj) throw new Error('failed to parse near `' + this.str.slice(0, 10) + '...`');
    vals.push(obj);
  }

  return vals;
};


/***/ }),

/***/ "../node_modules/tns-core-modules/css/index.js":
/***/ (function(module, exports, __webpack_require__) {

exports.parse = __webpack_require__("../node_modules/tns-core-modules/css/lib/parse/index.js");


/***/ }),

/***/ "../node_modules/tns-core-modules/css/lib/parse/index.js":
/***/ (function(module, exports) {

// http://www.w3.org/TR/CSS21/grammar.html
// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027
var commentre = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g

module.exports = function(css, options){
  options = options || {};

  /**
   * Positional.
   */

  var lineno = 1;
  var column = 1;

  /**
   * Update lineno and column based on `str`.
   */

  function updatePosition(str) {
    var lines = str.match(/\n/g);
    if (lines) lineno += lines.length;
    var i = str.lastIndexOf('\n');
    column = ~i ? str.length - i : column + str.length;
  }

  /**
   * Mark position and patch `node.position`.
   */

  function position() {
    var start = { line: lineno, column: column };
    return function(node){
      node.position = new Position(start);
      whitespace();
      return node;
    };
  }

  /**
   * Store position information for a node
   */

  function Position(start) {
    this.start = start;
    this.end = { line: lineno, column: column };
    this.source = options.source;
  }

  /**
   * Non-enumerable source string
   */

  Position.prototype.content = css;

  /**
   * Error `msg`.
   */

  var errorsList = [];

  function error(msg) {
    var err = new Error(options.source + ':' + lineno + ':' + column + ': ' + msg);
    err.reason = msg;
    err.filename = options.source;
    err.line = lineno;
    err.column = column;
    err.source = css;

    if (options.silent) {
      errorsList.push(err);
    } else {
      throw err;
    }
  }

  /**
   * Parse stylesheet.
   */

  function stylesheet() {
    var rulesList = rules();

    return {
      type: 'stylesheet',
      stylesheet: {
        rules: rulesList,
        parsingErrors: errorsList
      }
    };
  }

  /**
   * Opening brace.
   */

  function open() {
    return match(/^{\s*/);
  }

  /**
   * Closing brace.
   */

  function close() {
    return match(/^}/);
  }

  /**
   * Parse ruleset.
   */

  function rules() {
    var node;
    var rules = [];
    whitespace();
    comments(rules);
    while (css.length && css.charAt(0) != '}' && (node = atrule() || rule())) {
      if (node !== false) {
        rules.push(node);
        comments(rules);
      }
    }
    return rules;
  }

  /**
   * Match `re` and return captures.
   */

  function match(re) {
    var m = re.exec(css);
    if (!m) return;
    var str = m[0];
    updatePosition(str);
    css = css.slice(str.length);
    return m;
  }

  /**
   * Parse whitespace.
   */

  function whitespace() {
    match(/^\s*/);
  }

  /**
   * Parse comments;
   */

  function comments(rules) {
    var c;
    rules = rules || [];
    while (c = comment()) {
      if (c !== false) {
        rules.push(c);
      }
    }
    return rules;
  }

  /**
   * Parse comment.
   */

  function comment() {
    var pos = position();
    if ('/' != css.charAt(0) || '*' != css.charAt(1)) return;

    var i = 2;
    while ("" != css.charAt(i) && ('*' != css.charAt(i) || '/' != css.charAt(i + 1))) ++i;
    i += 2;

    if ("" === css.charAt(i-1)) {
      return error('End of comment missing');
    }

    var str = css.slice(2, i - 2);
    column += 2;
    updatePosition(str);
    css = css.slice(i);
    column += 2;

    return pos({
      type: 'comment',
      comment: str
    });
  }

  /**
   * Parse selector.
   */

  function selector() {
    var m = match(/^([^{]+)/);
    if (!m) return;
    /* @fix Remove all comments from selectors
     * http://ostermiller.org/findcomment.html */
    return trim(m[0])
      .replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, '')
      .replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function(m) {
        return m.replace(/,/g, '\u200C');
      })
      .split(/\s*(?![^(]*\)),\s*/)
      .map(function(s) {
        return s.replace(/\u200C/g, ',');
      });
  }

  /**
   * Parse declaration.
   */

  function declaration() {
    var pos = position();

    // prop
    var prop = match(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);
    if (!prop) return;
    prop = trim(prop[0]);

    // :
    if (!match(/^:\s*/)) return error("property missing ':'");

    // val
    var val = match(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);

    var ret = pos({
      type: 'declaration',
      property: prop.replace(commentre, ''),
      value: val ? trim(val[0]).replace(commentre, '') : ''
    });

    // ;
    match(/^[;\s]*/);

    return ret;
  }

  /**
   * Parse declarations.
   */

  function declarations() {
    var decls = [];

    if (!open()) return error("missing '{'");
    comments(decls);

    // declarations
    var decl;
    while (decl = declaration()) {
      if (decl !== false) {
        decls.push(decl);
        comments(decls);
      }
    }

    if (!close()) return error("missing '}'");
    return decls;
  }

  /**
   * Parse keyframe.
   */

  function keyframe() {
    var m;
    var vals = [];
    var pos = position();

    while (m = match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)) {
      vals.push(m[1]);
      match(/^,\s*/);
    }

    if (!vals.length) return;

    return pos({
      type: 'keyframe',
      values: vals,
      declarations: declarations()
    });
  }

  /**
   * Parse keyframes.
   */

  function atkeyframes() {
    var pos = position();
    var m = match(/^@([-\w]+)?keyframes\s*/);

    if (!m) return;
    var vendor = m[1];

    // identifier
    var m = match(/^([-\w]+)\s*/);
    if (!m) return error("@keyframes missing name");
    var name = m[1];

    if (!open()) return error("@keyframes missing '{'");

    var frame;
    var frames = comments();
    while (frame = keyframe()) {
      frames.push(frame);
      frames = frames.concat(comments());
    }

    if (!close()) return error("@keyframes missing '}'");

    return pos({
      type: 'keyframes',
      name: name,
      vendor: vendor,
      keyframes: frames
    });
  }

  /**
   * Parse supports.
   */

  function atsupports() {
    var pos = position();
    var m = match(/^@supports *([^{]+)/);

    if (!m) return;
    var supports = trim(m[1]);

    if (!open()) return error("@supports missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@supports missing '}'");

    return pos({
      type: 'supports',
      supports: supports,
      rules: style
    });
  }

  /**
   * Parse host.
   */

  function athost() {
    var pos = position();
    var m = match(/^@host\s*/);

    if (!m) return;

    if (!open()) return error("@host missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@host missing '}'");

    return pos({
      type: 'host',
      rules: style
    });
  }

  /**
   * Parse media.
   */

  function atmedia() {
    var pos = position();
    var m = match(/^@media *([^{]+)/);

    if (!m) return;
    var media = trim(m[1]);

    if (!open()) return error("@media missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@media missing '}'");

    return pos({
      type: 'media',
      media: media,
      rules: style
    });
  }


  /**
   * Parse custom-media.
   */

  function atcustommedia() {
    var pos = position();
    var m = match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);
    if (!m) return;

    return pos({
      type: 'custom-media',
      name: trim(m[1]),
      media: trim(m[2])
    });
  }

  /**
   * Parse paged media.
   */

  function atpage() {
    var pos = position();
    var m = match(/^@page */);
    if (!m) return;

    var sel = selector() || [];

    if (!open()) return error("@page missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@page missing '}'");

    return pos({
      type: 'page',
      selectors: sel,
      declarations: decls
    });
  }

  /**
   * Parse document.
   */

  function atdocument() {
    var pos = position();
    var m = match(/^@([-\w]+)?document *([^{]+)/);
    if (!m) return;

    var vendor = trim(m[1]);
    var doc = trim(m[2]);

    if (!open()) return error("@document missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@document missing '}'");

    return pos({
      type: 'document',
      document: doc,
      vendor: vendor,
      rules: style
    });
  }

  /**
   * Parse font-face.
   */

  function atfontface() {
    var pos = position();
    var m = match(/^@font-face\s*/);
    if (!m) return;

    if (!open()) return error("@font-face missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@font-face missing '}'");

    return pos({
      type: 'font-face',
      declarations: decls
    });
  }

  /**
   * Parse import
   */

  var atimport = _compileAtrule('import');

  /**
   * Parse charset
   */

  var atcharset = _compileAtrule('charset');

  /**
   * Parse namespace
   */

  var atnamespace = _compileAtrule('namespace');

  /**
   * Parse non-block at-rules
   */


  function _compileAtrule(name) {
    var re = new RegExp('^@' + name + '\\s*([^;]+);');
    return function() {
      var pos = position();
      var m = match(re);
      if (!m) return;
      var ret = { type: name };
      ret[name] = m[1].trim();
      return pos(ret);
    }
  }

  /**
   * Parse at rule.
   */

  function atrule() {
    if (css[0] != '@') return;

    return atkeyframes()
      || atmedia()
      || atcustommedia()
      || atsupports()
      || atimport()
      || atcharset()
      || atnamespace()
      || atdocument()
      || atpage()
      || athost()
      || atfontface();
  }

  /**
   * Parse rule.
   */

  function rule() {
    var pos = position();
    var sel = selector();

    if (!sel) return error('selector missing');
    comments();

    return pos({
      type: 'rule',
      selectors: sel,
      declarations: declarations()
    });
  }

  return addParent(stylesheet());
};

/**
 * Trim `str`.
 */

function trim(str) {
  return str ? str.replace(/^\s+|\s+$/g, '') : '';
}

/**
 * Adds non-enumerable parent node reference to each node.
 */

function addParent(obj, parent) {
  var isNode = obj && typeof obj.type === 'string';
  var childParent = isNode ? obj : parent;

  for (var k in obj) {
    var value = obj[k];
    if (Array.isArray(value)) {
      value.forEach(function(v) { addParent(v, childParent); });
    } else if (value && typeof value === 'object') {
      addParent(value, childParent);
    }
  }

  if (isNode) {
    Object.defineProperty(obj, 'parent', {
      configurable: true,
      writable: true,
      enumerable: false,
      value: parent || null
    });
  }

  return obj;
}


/***/ }),

/***/ "../node_modules/tns-core-modules/css/parser.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var urlRegEx = /\s*url\((?:('|")([^\1]*)\1|([^\)]*))\)\s*/gy;
function parseURL(text, start) {
    if (start === void 0) { start = 0; }
    urlRegEx.lastIndex = start;
    var result = urlRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = urlRegEx.lastIndex;
    var value = result[2] || result[3];
    return { start: start, end: end, value: value };
}
exports.parseURL = parseURL;
var hexColorRegEx = /\s*#((?:[0-9A-F]{8})|(?:[0-9A-F]{6})|(?:[0-9A-F]{3}))\s*/giy;
function parseHexColor(text, start) {
    if (start === void 0) { start = 0; }
    hexColorRegEx.lastIndex = start;
    var result = hexColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = hexColorRegEx.lastIndex;
    var hex = result[1];
    var argb;
    if (hex.length === 8) {
        argb = parseInt("0x" + hex);
    }
    else if (hex.length === 6) {
        argb = parseInt("0xFF" + hex);
    }
    else if (hex.length === 3) {
        argb = parseInt("0xFF" + hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]);
    }
    return { start: start, end: end, value: argb };
}
exports.parseHexColor = parseHexColor;
function rgbaToArgbNumber(r, g, b, a) {
    if (a === void 0) { a = 1; }
    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255 && a >= 0 && a <= 1) {
        return (Math.round(a * 0xFF) * 0x01000000) + (r * 0x010000) + (g * 0x000100) + (b * 0x000001);
    }
    else {
        return null;
    }
}
var rgbColorRegEx = /\s*(rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\))/gy;
function parseRGBColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbColorRegEx.lastIndex = start;
    var result = rgbColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbColorRegEx.lastIndex;
    var value = result[1] && rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]));
    return { start: start, end: end, value: value };
}
exports.parseRGBColor = parseRGBColor;
var rgbaColorRegEx = /\s*(rgba\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*,\s*([01]?\.?\d*)\s*\))/gy;
function parseRGBAColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbaColorRegEx.lastIndex = start;
    var result = rgbaColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbaColorRegEx.lastIndex;
    var value = rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]), parseFloat(result[5]));
    return { start: start, end: end, value: value };
}
exports.parseRGBAColor = parseRGBAColor;
var colors;
(function (colors) {
    colors[colors["transparent"] = 0] = "transparent";
    colors[colors["aliceblue"] = 4293982463] = "aliceblue";
    colors[colors["antiquewhite"] = 4294634455] = "antiquewhite";
    colors[colors["aqua"] = 4278255615] = "aqua";
    colors[colors["aquamarine"] = 4286578644] = "aquamarine";
    colors[colors["azure"] = 4293984255] = "azure";
    colors[colors["beige"] = 4294309340] = "beige";
    colors[colors["bisque"] = 4294960324] = "bisque";
    colors[colors["black"] = 4278190080] = "black";
    colors[colors["blanchedalmond"] = 4294962125] = "blanchedalmond";
    colors[colors["blue"] = 4278190335] = "blue";
    colors[colors["blueviolet"] = 4287245282] = "blueviolet";
    colors[colors["brown"] = 4289014314] = "brown";
    colors[colors["burlywood"] = 4292786311] = "burlywood";
    colors[colors["cadetblue"] = 4284456608] = "cadetblue";
    colors[colors["chartreuse"] = 4286578432] = "chartreuse";
    colors[colors["chocolate"] = 4291979550] = "chocolate";
    colors[colors["coral"] = 4294934352] = "coral";
    colors[colors["cornflowerblue"] = 4284782061] = "cornflowerblue";
    colors[colors["cornsilk"] = 4294965468] = "cornsilk";
    colors[colors["crimson"] = 4292613180] = "crimson";
    colors[colors["cyan"] = 4278255615] = "cyan";
    colors[colors["darkblue"] = 4278190219] = "darkblue";
    colors[colors["darkcyan"] = 4278225803] = "darkcyan";
    colors[colors["darkgoldenrod"] = 4290283019] = "darkgoldenrod";
    colors[colors["darkgray"] = 4289309097] = "darkgray";
    colors[colors["darkgreen"] = 4278215680] = "darkgreen";
    colors[colors["darkgrey"] = 4289309097] = "darkgrey";
    colors[colors["darkkhaki"] = 4290623339] = "darkkhaki";
    colors[colors["darkmagenta"] = 4287299723] = "darkmagenta";
    colors[colors["darkolivegreen"] = 4283788079] = "darkolivegreen";
    colors[colors["darkorange"] = 4294937600] = "darkorange";
    colors[colors["darkorchid"] = 4288230092] = "darkorchid";
    colors[colors["darkred"] = 4287299584] = "darkred";
    colors[colors["darksalmon"] = 4293498490] = "darksalmon";
    colors[colors["darkseagreen"] = 4287609999] = "darkseagreen";
    colors[colors["darkslateblue"] = 4282924427] = "darkslateblue";
    colors[colors["darkslategray"] = 4281290575] = "darkslategray";
    colors[colors["darkslategrey"] = 4281290575] = "darkslategrey";
    colors[colors["darkturquoise"] = 4278243025] = "darkturquoise";
    colors[colors["darkviolet"] = 4287889619] = "darkviolet";
    colors[colors["deeppink"] = 4294907027] = "deeppink";
    colors[colors["deepskyblue"] = 4278239231] = "deepskyblue";
    colors[colors["dimgray"] = 4285098345] = "dimgray";
    colors[colors["dimgrey"] = 4285098345] = "dimgrey";
    colors[colors["dodgerblue"] = 4280193279] = "dodgerblue";
    colors[colors["firebrick"] = 4289864226] = "firebrick";
    colors[colors["floralwhite"] = 4294966000] = "floralwhite";
    colors[colors["forestgreen"] = 4280453922] = "forestgreen";
    colors[colors["fuchsia"] = 4294902015] = "fuchsia";
    colors[colors["gainsboro"] = 4292664540] = "gainsboro";
    colors[colors["ghostwhite"] = 4294506751] = "ghostwhite";
    colors[colors["gold"] = 4294956800] = "gold";
    colors[colors["goldenrod"] = 4292519200] = "goldenrod";
    colors[colors["gray"] = 4286611584] = "gray";
    colors[colors["green"] = 4278222848] = "green";
    colors[colors["greenyellow"] = 4289593135] = "greenyellow";
    colors[colors["grey"] = 4286611584] = "grey";
    colors[colors["honeydew"] = 4293984240] = "honeydew";
    colors[colors["hotpink"] = 4294928820] = "hotpink";
    colors[colors["indianred"] = 4291648604] = "indianred";
    colors[colors["indigo"] = 4283105410] = "indigo";
    colors[colors["ivory"] = 4294967280] = "ivory";
    colors[colors["khaki"] = 4293977740] = "khaki";
    colors[colors["lavender"] = 4293322490] = "lavender";
    colors[colors["lavenderblush"] = 4294963445] = "lavenderblush";
    colors[colors["lawngreen"] = 4286381056] = "lawngreen";
    colors[colors["lemonchiffon"] = 4294965965] = "lemonchiffon";
    colors[colors["lightblue"] = 4289583334] = "lightblue";
    colors[colors["lightcoral"] = 4293951616] = "lightcoral";
    colors[colors["lightcyan"] = 4292935679] = "lightcyan";
    colors[colors["lightgoldenrodyellow"] = 4294638290] = "lightgoldenrodyellow";
    colors[colors["lightgray"] = 4292072403] = "lightgray";
    colors[colors["lightgreen"] = 4287688336] = "lightgreen";
    colors[colors["lightgrey"] = 4292072403] = "lightgrey";
    colors[colors["lightpink"] = 4294948545] = "lightpink";
    colors[colors["lightsalmon"] = 4294942842] = "lightsalmon";
    colors[colors["lightseagreen"] = 4280332970] = "lightseagreen";
    colors[colors["lightskyblue"] = 4287090426] = "lightskyblue";
    colors[colors["lightslategray"] = 4286023833] = "lightslategray";
    colors[colors["lightslategrey"] = 4286023833] = "lightslategrey";
    colors[colors["lightsteelblue"] = 4289774814] = "lightsteelblue";
    colors[colors["lightyellow"] = 4294967264] = "lightyellow";
    colors[colors["lime"] = 4278255360] = "lime";
    colors[colors["limegreen"] = 4281519410] = "limegreen";
    colors[colors["linen"] = 4294635750] = "linen";
    colors[colors["magenta"] = 4294902015] = "magenta";
    colors[colors["maroon"] = 4286578688] = "maroon";
    colors[colors["mediumaquamarine"] = 4284927402] = "mediumaquamarine";
    colors[colors["mediumblue"] = 4278190285] = "mediumblue";
    colors[colors["mediumorchid"] = 4290401747] = "mediumorchid";
    colors[colors["mediumpurple"] = 4287852763] = "mediumpurple";
    colors[colors["mediumseagreen"] = 4282168177] = "mediumseagreen";
    colors[colors["mediumslateblue"] = 4286277870] = "mediumslateblue";
    colors[colors["mediumspringgreen"] = 4278254234] = "mediumspringgreen";
    colors[colors["mediumturquoise"] = 4282962380] = "mediumturquoise";
    colors[colors["mediumvioletred"] = 4291237253] = "mediumvioletred";
    colors[colors["midnightblue"] = 4279834992] = "midnightblue";
    colors[colors["mintcream"] = 4294311930] = "mintcream";
    colors[colors["mistyrose"] = 4294960353] = "mistyrose";
    colors[colors["moccasin"] = 4294960309] = "moccasin";
    colors[colors["navajowhite"] = 4294958765] = "navajowhite";
    colors[colors["navy"] = 4278190208] = "navy";
    colors[colors["oldlace"] = 4294833638] = "oldlace";
    colors[colors["olive"] = 4286611456] = "olive";
    colors[colors["olivedrab"] = 4285238819] = "olivedrab";
    colors[colors["orange"] = 4294944000] = "orange";
    colors[colors["orangered"] = 4294919424] = "orangered";
    colors[colors["orchid"] = 4292505814] = "orchid";
    colors[colors["palegoldenrod"] = 4293847210] = "palegoldenrod";
    colors[colors["palegreen"] = 4288215960] = "palegreen";
    colors[colors["paleturquoise"] = 4289720046] = "paleturquoise";
    colors[colors["palevioletred"] = 4292571283] = "palevioletred";
    colors[colors["papayawhip"] = 4294963157] = "papayawhip";
    colors[colors["peachpuff"] = 4294957753] = "peachpuff";
    colors[colors["peru"] = 4291659071] = "peru";
    colors[colors["pink"] = 4294951115] = "pink";
    colors[colors["plum"] = 4292714717] = "plum";
    colors[colors["powderblue"] = 4289781990] = "powderblue";
    colors[colors["purple"] = 4286578816] = "purple";
    colors[colors["rebeccapurple"] = 4284887961] = "rebeccapurple";
    colors[colors["red"] = 4294901760] = "red";
    colors[colors["rosybrown"] = 4290547599] = "rosybrown";
    colors[colors["royalblue"] = 4282477025] = "royalblue";
    colors[colors["saddlebrown"] = 4287317267] = "saddlebrown";
    colors[colors["salmon"] = 4294606962] = "salmon";
    colors[colors["sandybrown"] = 4294222944] = "sandybrown";
    colors[colors["seagreen"] = 4281240407] = "seagreen";
    colors[colors["seashell"] = 4294964718] = "seashell";
    colors[colors["sienna"] = 4288696877] = "sienna";
    colors[colors["silver"] = 4290822336] = "silver";
    colors[colors["skyblue"] = 4287090411] = "skyblue";
    colors[colors["slateblue"] = 4285160141] = "slateblue";
    colors[colors["slategray"] = 4285563024] = "slategray";
    colors[colors["slategrey"] = 4285563024] = "slategrey";
    colors[colors["snow"] = 4294966010] = "snow";
    colors[colors["springgreen"] = 4278255487] = "springgreen";
    colors[colors["steelblue"] = 4282811060] = "steelblue";
    colors[colors["tan"] = 4291998860] = "tan";
    colors[colors["teal"] = 4278222976] = "teal";
    colors[colors["thistle"] = 4292394968] = "thistle";
    colors[colors["tomato"] = 4294927175] = "tomato";
    colors[colors["turquoise"] = 4282441936] = "turquoise";
    colors[colors["violet"] = 4293821166] = "violet";
    colors[colors["wheat"] = 4294303411] = "wheat";
    colors[colors["white"] = 4294967295] = "white";
    colors[colors["whitesmoke"] = 4294309365] = "whitesmoke";
    colors[colors["yellow"] = 4294967040] = "yellow";
    colors[colors["yellowgreen"] = 4288335154] = "yellowgreen";
})(colors = exports.colors || (exports.colors = {}));
function parseColorKeyword(value, start, keyword) {
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && keyword.value in colors) {
        var end = keyword.end;
        var value_1 = colors[keyword.value];
        return { start: start, end: end, value: value_1 };
    }
    return null;
}
exports.parseColorKeyword = parseColorKeyword;
function parseColor(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    return parseHexColor(value, start) || parseColorKeyword(value, start, keyword) || parseRGBColor(value, start) || parseRGBAColor(value, start);
}
exports.parseColor = parseColor;
var keywordRegEx = /\s*([a-z][\w\-]*)\s*/giy;
function parseKeyword(text, start) {
    if (start === void 0) { start = 0; }
    keywordRegEx.lastIndex = start;
    var result = keywordRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = keywordRegEx.lastIndex;
    var value = result[1];
    return { start: start, end: end, value: value };
}
var backgroundRepeatKeywords = new Set(["repeat", "repeat-x", "repeat-y", "no-repeat"]);
function parseRepeat(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && backgroundRepeatKeywords.has(keyword.value)) {
        var end = keyword.end;
        var value_2 = keyword.value;
        return { start: start, end: end, value: value_2 };
    }
    return null;
}
exports.parseRepeat = parseRepeat;
var unitRegEx = /\s*([\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?)([a-zA-Z]+|%)?\s*/gy;
function parseUnit(text, start) {
    if (start === void 0) { start = 0; }
    unitRegEx.lastIndex = start;
    var result = unitRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = unitRegEx.lastIndex;
    var value = parseFloat(result[1]);
    var unit = result[2] || "dip";
    return { start: start, end: end, value: { value: value, unit: unit } };
}
exports.parseUnit = parseUnit;
function parsePercentageOrLength(text, start) {
    if (start === void 0) { start = 0; }
    var unitResult = parseUnit(text, start);
    if (unitResult) {
        var start_1 = unitResult.start, end = unitResult.end;
        var value = unitResult.value;
        if (value.unit === "%") {
            value.value /= 100;
        }
        else if (!value.unit) {
            value.unit = "dip";
        }
        else if (value.unit === "px" || value.unit === "dip") {
        }
        else {
            return null;
        }
        return { start: start_1, end: end, value: value };
    }
    return null;
}
exports.parsePercentageOrLength = parsePercentageOrLength;
var angleUnitsToRadMap = {
    "deg": function (start, end, deg) { return ({ start: start, end: end, value: deg / 180 * Math.PI }); },
    "rad": function (start, end, rad) { return ({ start: start, end: end, value: rad }); },
    "grad": function (start, end, grad) { return ({ start: start, end: end, value: grad / 200 * Math.PI }); },
    "turn": function (start, end, turn) { return ({ start: start, end: end, value: turn * Math.PI * 2 }); }
};
function parseAngle(value, start) {
    if (start === void 0) { start = 0; }
    var angleResult = parseUnit(value, start);
    if (angleResult) {
        var start_2 = angleResult.start, end = angleResult.end, value_3 = angleResult.value;
        return (angleUnitsToRadMap[value_3.unit] || (function (_, __, ___) { return null; }))(start_2, end, value_3.value);
    }
    return null;
}
exports.parseAngle = parseAngle;
var backgroundSizeKeywords = new Set(["auto", "contain", "cover"]);
function parseBackgroundSize(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    var end = start;
    if (keyword && backgroundSizeKeywords.has(keyword.value)) {
        end = keyword.end;
        var value_4 = keyword.value;
        return { start: start, end: end, value: value_4 };
    }
    var firstLength = parsePercentageOrLength(value, end);
    if (firstLength) {
        end = firstLength.end;
        var secondLength = parsePercentageOrLength(value, firstLength.end);
        if (secondLength) {
            end = secondLength.end;
            return { start: start, end: end, value: { x: firstLength.value, y: secondLength.value } };
        }
        else {
            return { start: start, end: end, value: { x: firstLength.value, y: "auto" } };
        }
    }
    return null;
}
exports.parseBackgroundSize = parseBackgroundSize;
var backgroundPositionKeywords = Object.freeze(new Set(["left", "right", "top", "bottom", "center"]));
var backgroundPositionKeywordsDirection = {
    "left": "x",
    "right": "x",
    "center": "center",
    "top": "y",
    "bottom": "y"
};
function parseBackgroundPosition(text, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(text, start); }
    function formatH(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    function formatV(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    var end = start;
    if (keyword && backgroundPositionKeywords.has(keyword.value)) {
        end = keyword.end;
        var firstDirection = backgroundPositionKeywordsDirection[keyword.value];
        var firstLength = firstDirection !== "center" && parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
        }
        var secondKeyword = parseKeyword(text, end);
        if (secondKeyword && backgroundPositionKeywords.has(secondKeyword.value)) {
            end = secondKeyword.end;
            var secondDirection = backgroundPositionKeywordsDirection[secondKeyword.end];
            if (firstDirection === secondDirection && firstDirection !== "center") {
                return null;
            }
            var secondLength = secondDirection !== "center" && parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
            }
            if ((firstDirection === secondDirection && secondDirection === "center") || (firstDirection === "x" || secondDirection === "y")) {
                return { start: start, end: end, value: {
                        x: formatH(keyword, firstLength),
                        y: formatV(secondKeyword, secondLength)
                    } };
            }
            else {
                return { start: start, end: end, value: {
                        x: formatH(secondKeyword, secondLength),
                        y: formatV(keyword, firstLength),
                    } };
            }
        }
        else {
            if (firstDirection === "center") {
                return { start: start, end: end, value: { x: "center", y: "center" } };
            }
            else if (firstDirection === "x") {
                return { start: start, end: end, value: { x: formatH(keyword, firstLength), y: "center" } };
            }
            else {
                return { start: start, end: end, value: { x: "center", y: formatV(keyword, firstLength) } };
            }
        }
    }
    else {
        var firstLength = parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
            var secondLength = parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: { align: "top", offset: secondLength.value } } };
            }
            else {
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: "center" } };
            }
        }
        else {
            return null;
        }
    }
}
exports.parseBackgroundPosition = parseBackgroundPosition;
var directionRegEx = /\s*to\s*(left|right|top|bottom)\s*(left|right|top|bottom)?\s*/gy;
var sideDirections = {
    top: Math.PI * 0 / 2,
    right: Math.PI * 1 / 2,
    bottom: Math.PI * 2 / 2,
    left: Math.PI * 3 / 2
};
var cornerDirections = {
    top: {
        right: Math.PI * 1 / 4,
        left: Math.PI * 7 / 4
    },
    right: {
        top: Math.PI * 1 / 4,
        bottom: Math.PI * 3 / 4
    },
    bottom: {
        right: Math.PI * 3 / 4,
        left: Math.PI * 5 / 4
    },
    left: {
        top: Math.PI * 7 / 4,
        bottom: Math.PI * 5 / 4
    }
};
function parseDirection(text, start) {
    if (start === void 0) { start = 0; }
    directionRegEx.lastIndex = start;
    var result = directionRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = directionRegEx.lastIndex;
    var firstDirection = result[1];
    if (result[2]) {
        var secondDirection = result[2];
        var value = cornerDirections[firstDirection][secondDirection];
        return value === undefined ? null : { start: start, end: end, value: value };
    }
    else {
        return { start: start, end: end, value: sideDirections[firstDirection] };
    }
}
var openingBracketRegEx = /\s*\(\s*/gy;
var closingBracketRegEx = /\s*\)\s*/gy;
var closingBracketOrCommaRegEx = /\s*(\)|,)\s*/gy;
function parseArgumentsList(text, start, argument) {
    openingBracketRegEx.lastIndex = start;
    var openingBracket = openingBracketRegEx.exec(text);
    if (!openingBracket) {
        return null;
    }
    var end = openingBracketRegEx.lastIndex;
    var value = [];
    closingBracketRegEx.lastIndex = end;
    var closingBracket = closingBracketRegEx.exec(text);
    if (closingBracket) {
        return { start: start, end: end, value: value };
    }
    for (var index_1 = 0; true; index_1++) {
        var arg = argument(text, end, index_1);
        if (!arg) {
            return null;
        }
        end = arg.end;
        value.push(arg);
        closingBracketOrCommaRegEx.lastIndex = end;
        var closingBracketOrComma = closingBracketOrCommaRegEx.exec(text);
        if (closingBracketOrComma) {
            end = closingBracketOrCommaRegEx.lastIndex;
            if (closingBracketOrComma[1] === ",") {
                continue;
            }
            else if (closingBracketOrComma[1] === ")") {
                return { start: start, end: end, value: value };
            }
        }
        else {
            return null;
        }
    }
}
function parseColorStop(text, start) {
    if (start === void 0) { start = 0; }
    var color = parseColor(text, start);
    if (!color) {
        return null;
    }
    var end = color.end;
    var offset = parsePercentageOrLength(text, end);
    if (offset) {
        end = offset.end;
        return { start: start, end: end, value: { argb: color.value, offset: offset.value } };
    }
    return { start: start, end: end, value: { argb: color.value } };
}
exports.parseColorStop = parseColorStop;
var linearGradientStartRegEx = /\s*linear-gradient\s*/gy;
function parseLinearGradient(text, start) {
    if (start === void 0) { start = 0; }
    linearGradientStartRegEx.lastIndex = start;
    var lgs = linearGradientStartRegEx.exec(text);
    if (!lgs) {
        return null;
    }
    var end = linearGradientStartRegEx.lastIndex;
    var angle = Math.PI;
    var colors = [];
    var parsedArgs = parseArgumentsList(text, end, function (text, start, index) {
        if (index === 0) {
            var angleArg = parseAngle(text, start) || parseDirection(text, start);
            if (angleArg) {
                angle = angleArg.value;
                return angleArg;
            }
        }
        var colorStop = parseColorStop(text, start);
        if (colorStop) {
            colors.push(colorStop.value);
            return colorStop;
        }
        return null;
    });
    if (!parsedArgs) {
        return null;
    }
    end = parsedArgs.end;
    return { start: start, end: end, value: { angle: angle, colors: colors } };
}
exports.parseLinearGradient = parseLinearGradient;
var slashRegEx = /\s*(\/)\s*/gy;
function parseSlash(text, start) {
    slashRegEx.lastIndex = start;
    var slash = slashRegEx.exec(text);
    if (!slash) {
        return null;
    }
    var end = slashRegEx.lastIndex;
    return { start: start, end: end, value: "/" };
}
function parseBackground(text, start) {
    if (start === void 0) { start = 0; }
    var value = {};
    var end = start;
    while (end < text.length) {
        var keyword = parseKeyword(text, end);
        var color = parseColor(text, end, keyword);
        if (color) {
            value.color = color.value;
            end = color.end;
            continue;
        }
        var repeat = parseRepeat(text, end, keyword);
        if (repeat) {
            value.repeat = repeat.value;
            end = repeat.end;
            continue;
        }
        var position = parseBackgroundPosition(text, end, keyword);
        if (position) {
            position.value.text = text.substring(position.start, position.end);
            value.position = position.value;
            end = position.end;
            var slash = parseSlash(text, end);
            if (slash) {
                end = slash.end;
                var size = parseBackgroundSize(text, end);
                if (!size) {
                    return null;
                }
                value.size = size.value;
                end = size.end;
            }
            continue;
        }
        var url = parseURL(text, end);
        if (url) {
            value.image = url.value;
            end = url.end;
            continue;
        }
        var gradient = parseLinearGradient(text, end);
        if (gradient) {
            value.image = gradient.value;
            end = gradient.end;
            continue;
        }
        return null;
    }
    return { start: start, end: end, value: value };
}
exports.parseBackground = parseBackground;
var universalSelectorRegEx = /\*/gy;
function parseUniversalSelector(text, start) {
    if (start === void 0) { start = 0; }
    universalSelectorRegEx.lastIndex = start;
    var result = universalSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = universalSelectorRegEx.lastIndex;
    return { start: start, end: end, value: { type: "*" } };
}
exports.parseUniversalSelector = parseUniversalSelector;
var simpleIdentifierSelectorRegEx = /(#|\.|:|\b)([_-\w][_-\w\d]*)/gy;
function parseSimpleIdentifierSelector(text, start) {
    if (start === void 0) { start = 0; }
    simpleIdentifierSelectorRegEx.lastIndex = start;
    var result = simpleIdentifierSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = simpleIdentifierSelectorRegEx.lastIndex;
    var type = result[1];
    var identifier = result[2];
    var value = { type: type, identifier: identifier };
    return { start: start, end: end, value: value };
}
exports.parseSimpleIdentifierSelector = parseSimpleIdentifierSelector;
var attributeSelectorRegEx = /\[\s*([_-\w][_-\w\d]*)\s*(?:(=|\^=|\$=|\*=|\~=|\|=)\s*(?:([_-\w][_-\w\d]*)|"((?:[^\\"]|\\(?:"|n|r|f|\\|0-9a-f))*)"|'((?:[^\\']|\\(?:'|n|r|f|\\|0-9a-f))*)')\s*)?\]/gy;
function parseAttributeSelector(text, start) {
    attributeSelectorRegEx.lastIndex = start;
    var result = attributeSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = attributeSelectorRegEx.lastIndex;
    var property = result[1];
    if (result[2]) {
        var test_1 = result[2];
        var value = result[3] || result[4] || result[5];
        return { start: start, end: end, value: { type: "[]", property: property, test: test_1, value: value } };
    }
    return { start: start, end: end, value: { type: "[]", property: property } };
}
exports.parseAttributeSelector = parseAttributeSelector;
function parseSimpleSelector(text, start) {
    if (start === void 0) { start = 0; }
    return parseUniversalSelector(text, start) ||
        parseSimpleIdentifierSelector(text, start) ||
        parseAttributeSelector(text, start);
}
exports.parseSimpleSelector = parseSimpleSelector;
function parseSimpleSelectorSequence(text, start) {
    var simpleSelector = parseSimpleSelector(text, start);
    if (!simpleSelector) {
        return null;
    }
    var end = simpleSelector.end;
    var value = [];
    while (simpleSelector) {
        value.push(simpleSelector.value);
        end = simpleSelector.end;
        simpleSelector = parseSimpleSelector(text, end);
    }
    return { start: start, end: end, value: value };
}
exports.parseSimpleSelectorSequence = parseSimpleSelectorSequence;
var combinatorRegEx = /\s*(\+|~|>)?\s*/gy;
function parseCombinator(text, start) {
    if (start === void 0) { start = 0; }
    combinatorRegEx.lastIndex = start;
    var result = combinatorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = combinatorRegEx.lastIndex;
    var value = result[1] || " ";
    return { start: start, end: end, value: value };
}
exports.parseCombinator = parseCombinator;
var whiteSpaceRegEx = /\s*/gy;
function parseSelector(text, start) {
    if (start === void 0) { start = 0; }
    var end = start;
    whiteSpaceRegEx.lastIndex = end;
    var leadingWhiteSpace = whiteSpaceRegEx.exec(text);
    if (leadingWhiteSpace) {
        end = whiteSpaceRegEx.lastIndex;
    }
    var value = [];
    var combinator;
    var expectSimpleSelector = true;
    var pair;
    do {
        var simpleSelectorSequence = parseSimpleSelectorSequence(text, end);
        if (!simpleSelectorSequence) {
            if (expectSimpleSelector) {
                return null;
            }
            else {
                break;
            }
        }
        end = simpleSelectorSequence.end;
        if (combinator) {
            pair[1] = combinator.value;
        }
        pair = [simpleSelectorSequence.value, undefined];
        value.push(pair);
        combinator = parseCombinator(text, end);
        if (combinator) {
            end = combinator.end;
        }
        expectSimpleSelector = combinator && combinator.value !== " ";
    } while (combinator);
    return { start: start, end: end, value: value };
}
exports.parseSelector = parseSelector;
var whitespaceRegEx = /[\s\t\n\r\f]*/gym;
var singleQuoteStringRegEx = /'((?:[^\n\r\f\']|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?'|$)/gym;
var doubleQuoteStringRegEx = /"((?:[^\n\r\f\"]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?"|$)/gym;
var commentRegEx = /(\/\*(?:[^\*]|\*[^\/])*\*\/)/gym;
var numberRegEx = /[\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?/gym;
var nameRegEx = /-?(?:(?:[a-zA-Z_]|[^\x00-\x7F]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))(?:[a-zA-Z_0-9\-]*|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)/gym;
var CSS3Parser = (function () {
    function CSS3Parser(text) {
        this.text = text;
        this.nextInputCodePointIndex = 0;
    }
    CSS3Parser.prototype.tokenize = function () {
        var tokens = [];
        var inputToken;
        do {
            inputToken = this.consumeAToken();
            tokens.push(inputToken);
        } while (inputToken);
        return tokens;
    };
    CSS3Parser.prototype.consumeAToken = function () {
        if (this.reconsumedInputToken) {
            var result = this.reconsumedInputToken;
            this.reconsumedInputToken = null;
            return result;
        }
        var char = this.text[this.nextInputCodePointIndex];
        switch (char) {
            case "\"": return this.consumeAStringToken();
            case "'": return this.consumeAStringToken();
            case "(":
            case ")":
            case ",":
            case ":":
            case ";":
            case "[":
            case "]":
            case "{":
            case "}":
                this.nextInputCodePointIndex++;
                return char;
            case "#": return this.consumeAHashToken() || this.consumeADelimToken();
            case " ":
            case "\t":
            case "\n":
            case "\r":
            case "\f":
                return this.consumeAWhitespace();
            case "@": return this.consumeAtKeyword() || this.consumeADelimToken();
            case "\\": return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "0":
            case "1":
            case "2":
            case "3":
            case "4":
            case "5":
            case "6":
            case "7":
            case "8":
            case "9":
                return this.consumeANumericToken();
            case "u":
            case "U":
                if (this.text[this.nextInputCodePointIndex + 1] === "+") {
                    var thirdChar = this.text[this.nextInputCodePointIndex + 2];
                    if (thirdChar >= "0" && thirdChar <= "9" || thirdChar === "?") {
                        throw new Error("Unicode tokens not supported!");
                    }
                }
                return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "$":
            case "*":
            case "^":
            case "|":
            case "~":
                return this.consumeAMatchToken() || this.consumeADelimToken();
            case "-": return this.consumeANumericToken() || this.consumeAnIdentLikeToken() || this.consumeCDC() || this.consumeADelimToken();
            case "+":
            case ".":
                return this.consumeANumericToken() || this.consumeADelimToken();
            case "/": return this.consumeAComment() || this.consumeADelimToken();
            case "<": return this.consumeCDO() || this.consumeADelimToken();
            case undefined: return undefined;
            default: return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
        }
    };
    CSS3Parser.prototype.consumeADelimToken = function () {
        return { type: 2, text: this.text[this.nextInputCodePointIndex++] };
    };
    CSS3Parser.prototype.consumeAWhitespace = function () {
        whitespaceRegEx.lastIndex = this.nextInputCodePointIndex;
        whitespaceRegEx.exec(this.text);
        this.nextInputCodePointIndex = whitespaceRegEx.lastIndex;
        return " ";
    };
    CSS3Parser.prototype.consumeAHashToken = function () {
        this.nextInputCodePointIndex++;
        var hashName = this.consumeAName();
        if (hashName) {
            return { type: 12, text: "#" + hashName.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeCDO = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 4) === "<!--") {
            this.nextInputCodePointIndex += 4;
            return "<!--";
        }
        return null;
    };
    CSS3Parser.prototype.consumeCDC = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 3) === "-->") {
            this.nextInputCodePointIndex += 3;
            return "-->";
        }
        return null;
    };
    CSS3Parser.prototype.consumeAMatchToken = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "=") {
            var token = this.text.substr(this.nextInputCodePointIndex, 2);
            this.nextInputCodePointIndex += 2;
            return token;
        }
        return null;
    };
    CSS3Parser.prototype.consumeANumericToken = function () {
        numberRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = numberRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = numberRegEx.lastIndex;
        if (this.text[this.nextInputCodePointIndex] === "%") {
            return { type: 4, text: result[0] };
        }
        var name = this.consumeAName();
        if (name) {
            return { type: 5, text: result[0] + name.text };
        }
        return { type: 3, text: result[0] };
    };
    CSS3Parser.prototype.consumeAnIdentLikeToken = function () {
        var name = this.consumeAName();
        if (!name) {
            return null;
        }
        if (this.text[this.nextInputCodePointIndex] === "(") {
            this.nextInputCodePointIndex++;
            if (name.text.toLowerCase() === "url") {
                return this.consumeAURLToken();
            }
            return { type: 8, name: name.text, text: name.text + "(" };
        }
        return name;
    };
    CSS3Parser.prototype.consumeAStringToken = function () {
        var char = this.text[this.nextInputCodePointIndex];
        var result;
        if (char === "'") {
            singleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = singleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = singleQuoteStringRegEx.lastIndex;
        }
        else if (char === "\"") {
            doubleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = doubleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = doubleQuoteStringRegEx.lastIndex;
        }
        return { type: 1, text: result[0] };
    };
    CSS3Parser.prototype.consumeAURLToken = function () {
        var start = this.nextInputCodePointIndex - 3 - 1;
        var urlToken = { type: 7, text: undefined };
        this.consumeAWhitespace();
        if (this.nextInputCodePointIndex >= this.text.length) {
            return urlToken;
        }
        var nextInputCodePoint = this.text[this.nextInputCodePointIndex];
        if (nextInputCodePoint === "\"" || nextInputCodePoint === "'") {
            var stringToken = this.consumeAStringToken();
            urlToken.text = stringToken.text;
            this.consumeAWhitespace();
            if (this.text[this.nextInputCodePointIndex] === ")" || this.nextInputCodePointIndex >= this.text.length) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                urlToken.text = this.text.substring(start, end);
                return urlToken;
            }
            else {
                return null;
            }
        }
        while (this.nextInputCodePointIndex < this.text.length) {
            var char = this.text[this.nextInputCodePointIndex++];
            switch (char) {
                case ")": return urlToken;
                case " ":
                case "\t":
                case "\n":
                case "\r":
                case "\f":
                    this.consumeAWhitespace();
                    if (this.text[this.nextInputCodePointIndex] === ")") {
                        this.nextInputCodePointIndex++;
                        return urlToken;
                    }
                    else {
                        return null;
                    }
                case "\"":
                case "\'":
                    return null;
                case "\\":
                    throw new Error("Escaping not yet supported!");
                default:
                    urlToken.text += char;
            }
        }
        return urlToken;
    };
    CSS3Parser.prototype.consumeAName = function () {
        nameRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = nameRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = nameRegEx.lastIndex;
        return { type: 6, text: result[0] };
    };
    CSS3Parser.prototype.consumeAtKeyword = function () {
        this.nextInputCodePointIndex++;
        var name = this.consumeAName();
        if (name) {
            return { type: 11, text: name.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeAComment = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "*") {
            commentRegEx.lastIndex = this.nextInputCodePointIndex;
            var result = commentRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = commentRegEx.lastIndex;
            return this.consumeAToken();
        }
        return null;
    };
    CSS3Parser.prototype.reconsumeTheCurrentInputToken = function (currentInputToken) {
        this.reconsumedInputToken = currentInputToken;
    };
    CSS3Parser.prototype.parseAStylesheet = function () {
        this.topLevelFlag = true;
        var stylesheet = {
            rules: this.consumeAListOfRules()
        };
        return stylesheet;
    };
    CSS3Parser.prototype.consumeAListOfRules = function () {
        var rules = [];
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            switch (inputToken) {
                case " ": continue;
                case "<!--":
                case "-->":
                    if (this.topLevelFlag) {
                        continue;
                    }
                    this.reconsumeTheCurrentInputToken(inputToken);
                    var atRule = this.consumeAnAtRule();
                    if (atRule) {
                        rules.push(atRule);
                    }
                    continue;
            }
            if (inputToken.type === 11) {
                this.reconsumeTheCurrentInputToken(inputToken);
                var atRule = this.consumeAnAtRule();
                if (atRule) {
                    rules.push(atRule);
                }
                continue;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var qualifiedRule = this.consumeAQualifiedRule();
            if (qualifiedRule) {
                rules.push(qualifiedRule);
            }
        }
        return rules;
    };
    CSS3Parser.prototype.consumeAnAtRule = function () {
        var inputToken = this.consumeAToken();
        var atRule = {
            type: "at-rule",
            name: inputToken.text,
            prelude: [],
            block: undefined
        };
        while (inputToken = this.consumeAToken()) {
            if (inputToken === ";") {
                return atRule;
            }
            else if (inputToken === "{") {
                atRule.block = this.consumeASimpleBlock(inputToken);
                return atRule;
            }
            else if (inputToken.type === 9 && inputToken.associatedToken === "{") {
                atRule.block = inputToken;
                return atRule;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var component = this.consumeAComponentValue();
            if (component) {
                atRule.prelude.push(component);
            }
        }
        return atRule;
    };
    CSS3Parser.prototype.consumeAQualifiedRule = function () {
        var qualifiedRule = {
            type: "qualified-rule",
            prelude: [],
            block: undefined
        };
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            if (inputToken === "{") {
                var block = this.consumeASimpleBlock(inputToken);
                qualifiedRule.block = block;
                return qualifiedRule;
            }
            else if (inputToken.type === 9) {
                var simpleBlock = inputToken;
                if (simpleBlock.associatedToken === "{") {
                    qualifiedRule.block = simpleBlock;
                    return qualifiedRule;
                }
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var componentValue = this.consumeAComponentValue();
            if (componentValue) {
                qualifiedRule.prelude.push(componentValue);
            }
        }
        return null;
    };
    CSS3Parser.prototype.consumeAComponentValue = function () {
        var inputToken = this.consumeAToken();
        switch (inputToken) {
            case "{":
            case "[":
            case "(":
                this.nextInputCodePointIndex++;
                return this.consumeASimpleBlock(inputToken);
        }
        if (typeof inputToken === "object" && inputToken.type === 8) {
            return this.consumeAFunction(inputToken.name);
        }
        return inputToken;
    };
    CSS3Parser.prototype.consumeASimpleBlock = function (associatedToken) {
        var endianToken = {
            "[": "]",
            "{": "}",
            "(": ")"
        }[associatedToken];
        var start = this.nextInputCodePointIndex - 1;
        var block = {
            type: 9,
            text: undefined,
            associatedToken: associatedToken,
            values: []
        };
        var nextInputToken;
        while (nextInputToken = this.text[this.nextInputCodePointIndex]) {
            if (nextInputToken === endianToken) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                block.text = this.text.substring(start, end);
                return block;
            }
            var value = this.consumeAComponentValue();
            if (value) {
                block.values.push(value);
            }
        }
        block.text = this.text.substring(start);
        return block;
    };
    CSS3Parser.prototype.consumeAFunction = function (name) {
        var start = this.nextInputCodePointIndex;
        var funcToken = { type: 14, name: name, text: undefined, components: [] };
        do {
            if (this.nextInputCodePointIndex >= this.text.length) {
                funcToken.text = name + "(" + this.text.substring(start);
                return funcToken;
            }
            var nextInputToken = this.text[this.nextInputCodePointIndex];
            switch (nextInputToken) {
                case ")":
                    this.nextInputCodePointIndex++;
                    var end = this.nextInputCodePointIndex;
                    funcToken.text = name + "(" + this.text.substring(start, end);
                    return funcToken;
                default:
                    var component = this.consumeAComponentValue();
                    if (component) {
                        funcToken.components.push(component);
                    }
            }
        } while (true);
    };
    return CSS3Parser;
}());
exports.CSS3Parser = CSS3Parser;
var CSSNativeScript = (function () {
    function CSSNativeScript() {
    }
    CSSNativeScript.prototype.parseStylesheet = function (stylesheet) {
        return {
            type: "stylesheet",
            stylesheet: {
                rules: this.parseRules(stylesheet.rules)
            }
        };
    };
    CSSNativeScript.prototype.parseRules = function (rules) {
        var _this = this;
        return rules.map(function (rule) { return _this.parseRule(rule); });
    };
    CSSNativeScript.prototype.parseRule = function (rule) {
        if (rule.type === "at-rule") {
            return this.parseAtRule(rule);
        }
        else if (rule.type === "qualified-rule") {
            return this.parseQualifiedRule(rule);
        }
    };
    CSSNativeScript.prototype.parseAtRule = function (rule) {
        if (rule.name === "import") {
            return {
                import: rule.prelude.map(function (m) { return typeof m === "string" ? m : m.text; }).join("").trim(),
                type: "import"
            };
        }
        return;
    };
    CSSNativeScript.prototype.parseQualifiedRule = function (rule) {
        return {
            type: "rule",
            selectors: this.preludeToSelectorsStringArray(rule.prelude),
            declarations: this.ruleBlockToDeclarations(rule.block.values)
        };
    };
    CSSNativeScript.prototype.ruleBlockToDeclarations = function (declarationsInputTokens) {
        var declarations = [];
        var property = "";
        var value = "";
        var reading = "property";
        for (var i = 0; i < declarationsInputTokens.length; i++) {
            var inputToken = declarationsInputTokens[i];
            if (reading === "property") {
                if (inputToken === ":") {
                    reading = "value";
                }
                else if (typeof inputToken === "string") {
                    property += inputToken;
                }
                else {
                    property += inputToken.text;
                }
            }
            else {
                if (inputToken === ";") {
                    property = property.trim();
                    value = value.trim();
                    declarations.push({ type: "declaration", property: property, value: value });
                    property = "";
                    value = "";
                    reading = "property";
                }
                else if (typeof inputToken === "string") {
                    value += inputToken;
                }
                else {
                    value += inputToken.text;
                }
            }
        }
        property = property.trim();
        value = value.trim();
        if (property || value) {
            declarations.push({ type: "declaration", property: property, value: value });
        }
        return declarations;
    };
    CSSNativeScript.prototype.preludeToSelectorsStringArray = function (prelude) {
        var selectors = [];
        var selector = "";
        prelude.forEach(function (inputToken) {
            if (typeof inputToken === "string") {
                if (inputToken === ",") {
                    if (selector) {
                        selectors.push(selector.trim());
                    }
                    selector = "";
                }
                else {
                    selector += inputToken;
                }
            }
            else if (typeof inputToken === "object") {
                selector += inputToken.text;
            }
        });
        if (selector) {
            selectors.push(selector.trim());
        }
        return selectors;
    };
    return CSSNativeScript;
}());
exports.CSSNativeScript = CSSNativeScript;
//# sourceMappingURL=parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable-array/observable-array.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var ChangeType = (function () {
    function ChangeType() {
    }
    ChangeType.Add = "add";
    ChangeType.Delete = "delete";
    ChangeType.Update = "update";
    ChangeType.Splice = "splice";
    return ChangeType;
}());
exports.ChangeType = ChangeType;
var CHANGE = "change";
var ObservableArray = (function (_super) {
    __extends(ObservableArray, _super);
    function ObservableArray() {
        var _this = _super.call(this) || this;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            _this._array = arguments[0].slice();
        }
        else {
            _this._array = Array.apply(null, arguments);
        }
        _this._addArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Add,
            index: null,
            removed: new Array(),
            addedCount: 1
        };
        _this._deleteArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Delete,
            index: null,
            removed: null,
            addedCount: 0
        };
        return _this;
    }
    ObservableArray.prototype.getItem = function (index) {
        return this._array[index];
    };
    ObservableArray.prototype.setItem = function (index, value) {
        var oldValue = this._array[index];
        this._array[index] = value;
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Update,
            index: index,
            removed: [oldValue],
            addedCount: 1
        });
    };
    Object.defineProperty(ObservableArray.prototype, "length", {
        get: function () {
            return this._array.length;
        },
        set: function (value) {
            if (types.isNumber(value) && this._array && this._array.length !== value) {
                this.splice(value, this._array.length - value);
            }
        },
        enumerable: true,
        configurable: true
    });
    ObservableArray.prototype.toString = function () {
        return this._array.toString();
    };
    ObservableArray.prototype.toLocaleString = function () {
        return this._array.toLocaleString();
    };
    ObservableArray.prototype.concat = function () {
        this._addArgs.index = this._array.length;
        var result = this._array.concat.apply(this._array, arguments);
        return result;
    };
    ObservableArray.prototype.join = function (separator) {
        return this._array.join(separator);
    };
    ObservableArray.prototype.pop = function () {
        this._deleteArgs.index = this._array.length - 1;
        var result = this._array.pop();
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.push = function () {
        this._addArgs.index = this._array.length;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            var source = arguments[0];
            for (var i = 0, l = source.length; i < l; i++) {
                this._array.push(source[i]);
            }
        }
        else {
            this._array.push.apply(this._array, arguments);
        }
        this._addArgs.addedCount = this._array.length - this._addArgs.index;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return this._array.length;
    };
    ObservableArray.prototype._notifyLengthChange = function () {
        var lengthChangedData = this._createPropertyChangeData("length", this._array.length);
        this.notify(lengthChangedData);
    };
    ObservableArray.prototype.reverse = function () {
        return this._array.reverse();
    };
    ObservableArray.prototype.shift = function () {
        var result = this._array.shift();
        this._deleteArgs.index = 0;
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.slice = function (start, end) {
        return this._array.slice(start, end);
    };
    ObservableArray.prototype.sort = function (compareFn) {
        return this._array.sort(compareFn);
    };
    ObservableArray.prototype.splice = function (start, deleteCount) {
        var length = this._array.length;
        var result = this._array.splice.apply(this._array, arguments);
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Splice,
            index: start,
            removed: result,
            addedCount: this._array.length + result.length - length
        });
        if (this._array.length !== length) {
            this._notifyLengthChange();
        }
        return result;
    };
    ObservableArray.prototype.unshift = function () {
        var length = this._array.length;
        var result = this._array.unshift.apply(this._array, arguments);
        this._addArgs.index = 0;
        this._addArgs.addedCount = result - length;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.indexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : 0;
        for (var i = index, l = this._array.length; i < l; i++) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.lastIndexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : this._array.length - 1;
        for (var i = index; i >= 0; i--) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.every = function (callbackfn, thisArg) {
        return this._array.every(callbackfn, thisArg);
    };
    ObservableArray.prototype.some = function (callbackfn, thisArg) {
        return this._array.some(callbackfn, thisArg);
    };
    ObservableArray.prototype.forEach = function (callbackfn, thisArg) {
        this._array.forEach(callbackfn, thisArg);
    };
    ObservableArray.prototype.map = function (callbackfn, thisArg) {
        return this._array.map(callbackfn, thisArg);
    };
    ObservableArray.prototype.filter = function (callbackfn, thisArg) {
        return this._array.filter(callbackfn, thisArg);
    };
    ObservableArray.prototype.reduce = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduce(callbackfn, initialValue) : this._array.reduce(callbackfn);
    };
    ObservableArray.prototype.reduceRight = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduceRight(callbackfn, initialValue) : this._array.reduceRight(callbackfn);
    };
    ObservableArray.changeEvent = CHANGE;
    return ObservableArray;
}(observable.Observable));
exports.ObservableArray = ObservableArray;
//# sourceMappingURL=observable-array.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable/observable.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _wrappedIndex = 0;
var WrappedValue = (function () {
    function WrappedValue(wrapped) {
        this.wrapped = wrapped;
    }
    WrappedValue.unwrap = function (value) {
        return (value instanceof WrappedValue) ? value.wrapped : value;
    };
    WrappedValue.wrap = function (value) {
        var w = _wrappedValues[_wrappedIndex++ % 5];
        w.wrapped = value;
        return w;
    };
    return WrappedValue;
}());
exports.WrappedValue = WrappedValue;
var _wrappedValues = [
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null)
];
var Observable = (function () {
    function Observable() {
        this._observers = {};
    }
    Observable.prototype.get = function (name) {
        return this[name];
    };
    Observable.prototype.set = function (name, value) {
        var oldValue = this[name];
        if (this[name] === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this[name] = newValue;
        this.notifyPropertyChange(name, newValue, oldValue);
    };
    Observable.prototype.on = function (eventNames, callback, thisArg) {
        this.addEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.once = function (event, callback, thisArg) {
        var list = this._getEventList(event, true);
        list.push({ callback: callback, thisArg: thisArg, once: true });
    };
    Observable.prototype.off = function (eventNames, callback, thisArg) {
        this.removeEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.addEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_1 = events[i].trim();
            var list = this._getEventList(event_1, true);
            list.push({
                callback: callback,
                thisArg: thisArg
            });
        }
    };
    Observable.prototype.removeEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (callback && typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_2 = events[i].trim();
            if (callback) {
                var list = this._getEventList(event_2, false);
                if (list) {
                    var index_1 = this._indexOfListener(list, callback, thisArg);
                    if (index_1 >= 0) {
                        list.splice(index_1, 1);
                    }
                    if (list.length === 0) {
                        delete this._observers[event_2];
                    }
                }
            }
            else {
                this._observers[event_2] = undefined;
                delete this._observers[event_2];
            }
        }
    };
    Observable.prototype.notify = function (data) {
        var observers = this._observers[data.eventName];
        if (!observers) {
            return;
        }
        for (var i = observers.length - 1; i >= 0; i--) {
            var entry = observers[i];
            if (entry.once) {
                observers.splice(i, 1);
            }
            if (entry.thisArg) {
                entry.callback.apply(entry.thisArg, [data]);
            }
            else {
                entry.callback(data);
            }
        }
    };
    Observable.prototype.notifyPropertyChange = function (name, value, oldValue) {
        this.notify(this._createPropertyChangeData(name, value, oldValue));
    };
    Observable.prototype.hasListeners = function (eventName) {
        return eventName in this._observers;
    };
    Observable.prototype._createPropertyChangeData = function (propertyName, value, oldValue) {
        return { eventName: Observable.propertyChangeEvent, object: this, propertyName: propertyName, value: value, oldValue: oldValue };
    };
    Observable.prototype._emit = function (eventNames) {
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_3 = events[i].trim();
            this.notify({ eventName: event_3, object: this });
        }
    };
    Observable.prototype._getEventList = function (eventName, createIfNeeded) {
        if (!eventName) {
            throw new TypeError("EventName must be valid string.");
        }
        var list = this._observers[eventName];
        if (!list && createIfNeeded) {
            list = [];
            this._observers[eventName] = list;
        }
        return list;
    };
    Observable.prototype._indexOfListener = function (list, callback, thisArg) {
        for (var i = 0; i < list.length; i++) {
            var entry = list[i];
            if (thisArg) {
                if (entry.callback === callback && entry.thisArg === thisArg) {
                    return i;
                }
            }
            else {
                if (entry.callback === callback) {
                    return i;
                }
            }
        }
        return -1;
    };
    Observable.propertyChangeEvent = "propertyChange";
    return Observable;
}());
exports.Observable = Observable;
var ObservableFromObject = (function (_super) {
    __extends(ObservableFromObject, _super);
    function ObservableFromObject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._map = {};
        return _this;
    }
    ObservableFromObject.prototype.get = function (name) {
        return this._map[name];
    };
    ObservableFromObject.prototype.set = function (name, value) {
        var currentValue = this._map[name];
        if (currentValue === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this._map[name] = newValue;
        this.notifyPropertyChange(name, newValue, currentValue);
    };
    return ObservableFromObject;
}(Observable));
function defineNewProperty(target, propertyName) {
    Object.defineProperty(target, propertyName, {
        get: function () {
            return target._map[propertyName];
        },
        set: function (value) {
            target.set(propertyName, value);
        },
        enumerable: true,
        configurable: true
    });
}
function addPropertiesFromObject(observable, source, recursive) {
    if (recursive === void 0) { recursive = false; }
    Object.keys(source).forEach(function (prop) {
        var value = source[prop];
        if (recursive
            && !Array.isArray(value)
            && value
            && typeof value === "object"
            && !(value instanceof Observable)) {
            value = fromObjectRecursive(value);
        }
        defineNewProperty(observable, prop);
        observable.set(prop, value);
    });
}
function fromObject(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, false);
    return observable;
}
exports.fromObject = fromObject;
function fromObjectRecursive(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, true);
    return observable;
}
exports.fromObjectRecursive = fromObjectRecursive;
//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/InspectorBackendCommands.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function DomainDispatcher(domain) {
    return function (klass) { return __registerDomainDispatcher(domain, klass); };
}
exports.DomainDispatcher = DomainDispatcher;
var HeapDomain;
(function (HeapDomain) {
    var HeapFrontend = (function () {
        function HeapFrontend() {
        }
        HeapFrontend.prototype.garbageCollected = function (collection) {
            __inspectorSendEvent(JSON.stringify({ "method": "Heap.garbageCollected", "params": { "collection": collection } }));
        };
        HeapFrontend.prototype.trackingStart = function (timestamp, snapshotData) {
            __inspectorSendEvent(JSON.stringify({ "method": "Heap.trackingStart", "params": { "timestamp": timestamp, "snapshotData": snapshotData } }));
        };
        HeapFrontend.prototype.trackingComplete = function (timestamp, snapshotData) {
            __inspectorSendEvent(JSON.stringify({ "method": "Heap.trackingComplete", "params": { "timestamp": timestamp, "snapshotData": snapshotData } }));
        };
        return HeapFrontend;
    }());
    HeapDomain.HeapFrontend = HeapFrontend;
})(HeapDomain = exports.HeapDomain || (exports.HeapDomain = {}));
var DebuggerDomain;
(function (DebuggerDomain) {
    var DebuggerFrontend = (function () {
        function DebuggerFrontend() {
        }
        DebuggerFrontend.prototype.globalObjectCleared = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.globalObjectCleared", "params": {} }));
        };
        DebuggerFrontend.prototype.scriptParsed = function (scriptId, url, startLine, startColumn, endLine, endColumn, isContentScript, sourceURL, sourceMapURL) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.scriptParsed", "params": { "scriptId": scriptId, "url": url, "startLine": startLine, "startColumn": startColumn, "endLine": endLine, "endColumn": endColumn, "isContentScript": isContentScript, "sourceURL": sourceURL, "sourceMapURL": sourceMapURL } }));
        };
        DebuggerFrontend.prototype.scriptFailedToParse = function (url, scriptSource, startLine, errorLine, errorMessage) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.scriptFailedToParse", "params": { "url": url, "scriptSource": scriptSource, "startLine": startLine, "errorLine": errorLine, "errorMessage": errorMessage } }));
        };
        DebuggerFrontend.prototype.breakpointResolved = function (breakpointId, location) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.breakpointResolved", "params": { "breakpointId": breakpointId, "location": location } }));
        };
        DebuggerFrontend.prototype.paused = function (callFrames, reason, data) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.paused", "params": { "callFrames": callFrames, "reason": reason, "data": data } }));
        };
        DebuggerFrontend.prototype.resumed = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.resumed", "params": {} }));
        };
        DebuggerFrontend.prototype.didSampleProbe = function (sample) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.didSampleProbe", "params": { "sample": sample } }));
        };
        DebuggerFrontend.prototype.playBreakpointActionSound = function (breakpointActionId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Debugger.playBreakpointActionSound", "params": { "breakpointActionId": breakpointActionId } }));
        };
        return DebuggerFrontend;
    }());
    DebuggerDomain.DebuggerFrontend = DebuggerFrontend;
})(DebuggerDomain = exports.DebuggerDomain || (exports.DebuggerDomain = {}));
var RuntimeDomain;
(function (RuntimeDomain) {
    var RuntimeFrontend = (function () {
        function RuntimeFrontend() {
        }
        RuntimeFrontend.prototype.executionContextCreated = function (context) {
            __inspectorSendEvent(JSON.stringify({ "method": "Runtime.executionContextCreated", "params": { "context": context } }));
        };
        return RuntimeFrontend;
    }());
    RuntimeDomain.RuntimeFrontend = RuntimeFrontend;
})(RuntimeDomain = exports.RuntimeDomain || (exports.RuntimeDomain = {}));
var ConsoleDomain;
(function (ConsoleDomain) {
    var ConsoleFrontend = (function () {
        function ConsoleFrontend() {
        }
        ConsoleFrontend.prototype.messageAdded = function (message) {
            __inspectorSendEvent(JSON.stringify({ "method": "Console.messageAdded", "params": { "message": message } }));
        };
        ConsoleFrontend.prototype.messageRepeatCountUpdated = function (count) {
            __inspectorSendEvent(JSON.stringify({ "method": "Console.messageRepeatCountUpdated", "params": { "count": count } }));
        };
        ConsoleFrontend.prototype.messagesCleared = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "Console.messagesCleared", "params": {} }));
        };
        ConsoleFrontend.prototype.heapSnapshot = function (timestamp, snapshotData, title) {
            __inspectorSendEvent(JSON.stringify({ "method": "Console.heapSnapshot", "params": { "timestamp": timestamp, "snapshotData": snapshotData, "title": title } }));
        };
        return ConsoleFrontend;
    }());
    ConsoleDomain.ConsoleFrontend = ConsoleFrontend;
})(ConsoleDomain = exports.ConsoleDomain || (exports.ConsoleDomain = {}));
var PageDomain;
(function (PageDomain) {
    var PageFrontend = (function () {
        function PageFrontend() {
        }
        PageFrontend.prototype.domContentEventFired = function (timestamp) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.domContentEventFired", "params": { "timestamp": timestamp } }));
        };
        PageFrontend.prototype.loadEventFired = function (timestamp) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.loadEventFired", "params": { "timestamp": timestamp } }));
        };
        PageFrontend.prototype.frameNavigated = function (frame) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameNavigated", "params": { "frame": frame } }));
        };
        PageFrontend.prototype.frameDetached = function (frameId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameDetached", "params": { "frameId": frameId } }));
        };
        PageFrontend.prototype.frameStartedLoading = function (frameId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameStartedLoading", "params": { "frameId": frameId } }));
        };
        PageFrontend.prototype.frameStoppedLoading = function (frameId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameStoppedLoading", "params": { "frameId": frameId } }));
        };
        PageFrontend.prototype.frameScheduledNavigation = function (frameId, delay) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameScheduledNavigation", "params": { "frameId": frameId, "delay": delay } }));
        };
        PageFrontend.prototype.frameClearedScheduledNavigation = function (frameId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.frameClearedScheduledNavigation", "params": { "frameId": frameId } }));
        };
        PageFrontend.prototype.javascriptDialogOpening = function (message) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.javascriptDialogOpening", "params": { "message": message } }));
        };
        PageFrontend.prototype.javascriptDialogClosed = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.javascriptDialogClosed", "params": {} }));
        };
        PageFrontend.prototype.scriptsEnabled = function (isEnabled) {
            __inspectorSendEvent(JSON.stringify({ "method": "Page.scriptsEnabled", "params": { "isEnabled": isEnabled } }));
        };
        return PageFrontend;
    }());
    PageDomain.PageFrontend = PageFrontend;
})(PageDomain = exports.PageDomain || (exports.PageDomain = {}));
var NetworkDomain;
(function (NetworkDomain) {
    var NetworkFrontend = (function () {
        function NetworkFrontend() {
        }
        NetworkFrontend.prototype.requestWillBeSent = function (requestId, frameId, loaderId, documentURL, request, timestamp, initiator, redirectResponse, type) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.requestWillBeSent", "params": { "requestId": requestId, "frameId": frameId, "loaderId": loaderId, "documentURL": documentURL, "request": request, "timestamp": timestamp, "initiator": initiator, "redirectResponse": redirectResponse, "type": type } }));
        };
        NetworkFrontend.prototype.requestServedFromCache = function (requestId) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.requestServedFromCache", "params": { "requestId": requestId } }));
        };
        NetworkFrontend.prototype.responseReceived = function (requestId, frameId, loaderId, timestamp, type, response) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.responseReceived", "params": { "requestId": requestId, "frameId": frameId, "loaderId": loaderId, "timestamp": timestamp, "type": type, "response": response } }));
        };
        NetworkFrontend.prototype.dataReceived = function (requestId, timestamp, dataLength, encodedDataLength) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.dataReceived", "params": { "requestId": requestId, "timestamp": timestamp, "dataLength": dataLength, "encodedDataLength": encodedDataLength } }));
        };
        NetworkFrontend.prototype.loadingFinished = function (requestId, timestamp, sourceMapURL) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.loadingFinished", "params": { "requestId": requestId, "timestamp": timestamp, "sourceMapURL": sourceMapURL } }));
        };
        NetworkFrontend.prototype.loadingFailed = function (requestId, timestamp, errorText, canceled) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.loadingFailed", "params": { "requestId": requestId, "timestamp": timestamp, "errorText": errorText, "canceled": canceled } }));
        };
        NetworkFrontend.prototype.requestServedFromMemoryCache = function (requestId, frameId, loaderId, documentURL, timestamp, initiator, resource) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.requestServedFromMemoryCache", "params": { "requestId": requestId, "frameId": frameId, "loaderId": loaderId, "documentURL": documentURL, "timestamp": timestamp, "initiator": initiator, "resource": resource } }));
        };
        NetworkFrontend.prototype.webSocketWillSendHandshakeRequest = function (requestId, timestamp, request) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketWillSendHandshakeRequest", "params": { "requestId": requestId, "timestamp": timestamp, "request": request } }));
        };
        NetworkFrontend.prototype.webSocketHandshakeResponseReceived = function (requestId, timestamp, response) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketHandshakeResponseReceived", "params": { "requestId": requestId, "timestamp": timestamp, "response": response } }));
        };
        NetworkFrontend.prototype.webSocketCreated = function (requestId, url) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketCreated", "params": { "requestId": requestId, "url": url } }));
        };
        NetworkFrontend.prototype.webSocketClosed = function (requestId, timestamp) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketClosed", "params": { "requestId": requestId, "timestamp": timestamp } }));
        };
        NetworkFrontend.prototype.webSocketFrameReceived = function (requestId, timestamp, response) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketFrameReceived", "params": { "requestId": requestId, "timestamp": timestamp, "response": response } }));
        };
        NetworkFrontend.prototype.webSocketFrameError = function (requestId, timestamp, errorMessage) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketFrameError", "params": { "requestId": requestId, "timestamp": timestamp, "errorMessage": errorMessage } }));
        };
        NetworkFrontend.prototype.webSocketFrameSent = function (requestId, timestamp, response) {
            __inspectorSendEvent(JSON.stringify({ "method": "Network.webSocketFrameSent", "params": { "requestId": requestId, "timestamp": timestamp, "response": response } }));
        };
        return NetworkFrontend;
    }());
    NetworkDomain.NetworkFrontend = NetworkFrontend;
})(NetworkDomain = exports.NetworkDomain || (exports.NetworkDomain = {}));
var DOMDomain;
(function (DOMDomain) {
    var DOMFrontend = (function () {
        function DOMFrontend() {
        }
        DOMFrontend.prototype.documentUpdated = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.documentUpdated", "params": {} }));
        };
        DOMFrontend.prototype.setChildNodes = function (parentId, nodes) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.setChildNodes", "params": { "parentId": parentId, "nodes": nodes } }));
        };
        DOMFrontend.prototype.attributeModified = function (nodeId, name, value) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.attributeModified", "params": { "nodeId": nodeId, "name": name, "value": value } }));
        };
        DOMFrontend.prototype.attributeRemoved = function (nodeId, name) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.attributeRemoved", "params": { "nodeId": nodeId, "name": name } }));
        };
        DOMFrontend.prototype.inlineStyleInvalidated = function (nodeIds) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.inlineStyleInvalidated", "params": { "nodeIds": nodeIds } }));
        };
        DOMFrontend.prototype.characterDataModified = function (nodeId, characterData) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.characterDataModified", "params": { "nodeId": nodeId, "characterData": characterData } }));
        };
        DOMFrontend.prototype.childNodeCountUpdated = function (nodeId, childNodeCount) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.childNodeCountUpdated", "params": { "nodeId": nodeId, "childNodeCount": childNodeCount } }));
        };
        DOMFrontend.prototype.childNodeInserted = function (parentNodeId, previousNodeId, node) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.childNodeInserted", "params": { "parentNodeId": parentNodeId, "previousNodeId": previousNodeId, "node": node } }));
        };
        DOMFrontend.prototype.childNodeRemoved = function (parentNodeId, nodeId) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.childNodeRemoved", "params": { "parentNodeId": parentNodeId, "nodeId": nodeId } }));
        };
        DOMFrontend.prototype.shadowRootPushed = function (hostId, root) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.shadowRootPushed", "params": { "hostId": hostId, "root": root } }));
        };
        DOMFrontend.prototype.shadowRootPopped = function (hostId, rootId) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.shadowRootPopped", "params": { "hostId": hostId, "rootId": rootId } }));
        };
        DOMFrontend.prototype.pseudoElementAdded = function (parentId, pseudoElement) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.pseudoElementAdded", "params": { "parentId": parentId, "pseudoElement": pseudoElement } }));
        };
        DOMFrontend.prototype.pseudoElementRemoved = function (parentId, pseudoElementId) {
            __inspectorSendEvent(JSON.stringify({ "method": "DOM.pseudoElementRemoved", "params": { "parentId": parentId, "pseudoElementId": pseudoElementId } }));
        };
        return DOMFrontend;
    }());
    DOMDomain.DOMFrontend = DOMFrontend;
})(DOMDomain = exports.DOMDomain || (exports.DOMDomain = {}));
var CSSDomain;
(function (CSSDomain) {
    var CSSFrontend = (function () {
        function CSSFrontend() {
        }
        CSSFrontend.prototype.mediaQueryResultChanged = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.mediaQueryResultChanged", "params": {} }));
        };
        CSSFrontend.prototype.fontsUpdated = function () {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.fontsUpdated", "params": {} }));
        };
        CSSFrontend.prototype.styleSheetChanged = function (styleSheetId) {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.styleSheetChanged", "params": { "styleSheetId": styleSheetId } }));
        };
        CSSFrontend.prototype.styleSheetAdded = function (header) {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.styleSheetAdded", "params": { "header": header } }));
        };
        CSSFrontend.prototype.styleSheetRemoved = function (styleSheetId) {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.styleSheetRemoved", "params": { "styleSheetId": styleSheetId } }));
        };
        CSSFrontend.prototype.layoutEditorChange = function (styleSheetId, changeRange) {
            __inspectorSendEvent(JSON.stringify({ "method": "CSS.layoutEditorChange", "params": { "styleSheetId": styleSheetId, "changeRange": changeRange } }));
        };
        return CSSFrontend;
    }());
    CSSDomain.CSSFrontend = CSSFrontend;
})(CSSDomain = exports.CSSDomain || (exports.CSSDomain = {}));
//# sourceMappingURL=InspectorBackendCommands.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/debugger.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var network;
function getNetwork() {
    return network;
}
exports.getNetwork = getNetwork;
function setNetwork(newNetwork) {
    network = newNetwork;
}
exports.setNetwork = setNetwork;
var dom;
function getDOM() {
    return dom;
}
exports.getDOM = getDOM;
function setDOM(newDOM) {
    dom = newDOM;
}
exports.setDOM = setDOM;
var css;
function getCSS() {
    return css;
}
exports.getCSS = getCSS;
function setCSS(newCSS) {
    css = newCSS;
}
exports.setCSS = setCSS;
var NetworkAgent;
(function (NetworkAgent) {
    function responseReceived(requestId, result, headers) {
        var requestIdStr = requestId.toString();
        var mimeType = headers["Content-Type"] || headers["content-type"] || "application/octet-stream";
        var contentLengthHeader = headers["Content-Length"] || headers["content-length"];
        var contentLength = parseInt(contentLengthHeader, 10);
        if (isNaN(contentLength)) {
            contentLength = 0;
        }
        var response = {
            url: result.url || "",
            status: result.statusCode,
            statusText: result.statusText || "",
            headers: headers,
            mimeType: mimeType,
            fromDiskCache: false,
            connectionReused: true,
            connectionId: 0,
            encodedDataLength: contentLength,
            securityState: "info"
        };
        var responseData = {
            requestId: requestIdStr,
            type: mimeTypeToType(response.mimeType),
            response: response,
            timestamp: getTimeStamp()
        };
        global.__inspector.responseReceived(responseData);
        global.__inspector.loadingFinished({
            requestId: requestIdStr,
            timestamp: getTimeStamp(),
            encodedDataLength: contentLength
        });
        var hasTextContent = responseData.type === "Document" || responseData.type === "Script";
        var data;
        if (!hasTextContent) {
            if (responseData.type === "Image") {
                var bitmap = result.responseAsImage;
                if (bitmap) {
                    var outputStream = new java.io.ByteArrayOutputStream();
                    bitmap.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, outputStream);
                    var base64Image = android.util.Base64.encodeToString(outputStream.toByteArray(), android.util.Base64.DEFAULT);
                    data = base64Image;
                }
            }
        }
        else {
            data = result.responseAsString;
        }
        var successfulRequestData = {
            requestId: requestIdStr,
            data: data,
            hasTextContent: hasTextContent
        };
        global.__inspector.dataForRequestId(successfulRequestData);
    }
    NetworkAgent.responseReceived = responseReceived;
    function requestWillBeSent(requestId, options) {
        var request = {
            url: options.url,
            method: options.method,
            headers: options.headers || {},
            postData: options.content ? options.content.toString() : "",
            initialPriority: "Medium",
            referrerPolicy: "no-referrer-when-downgrade"
        };
        var requestData = {
            requestId: requestId.toString(),
            url: request.url,
            request: request,
            timestamp: getTimeStamp(),
            type: "Document",
            wallTime: 0
        };
        global.__inspector.requestWillBeSent(requestData);
    }
    NetworkAgent.requestWillBeSent = requestWillBeSent;
    function getTimeStamp() {
        var d = new Date();
        return Math.round(d.getTime() / 1000);
    }
    function mimeTypeToType(mimeType) {
        var type = "Document";
        if (mimeType) {
            if (mimeType.indexOf("image") === 0) {
                type = "Image";
            }
            else if (mimeType.indexOf("javascript") !== -1 || mimeType.indexOf("json") !== -1) {
                type = "Script";
            }
        }
        return type;
    }
})(NetworkAgent = exports.NetworkAgent || (exports.NetworkAgent = {}));
//# sourceMappingURL=debugger.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var frameTopmost = function () { return __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js").topmost(); };
var unsetValue;
function unsetViewValue(view, name) {
    if (!unsetValue) {
        unsetValue = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").unsetValue;
    }
    view[name] = unsetValue;
}
function getViewById(nodeId) {
    var node = dom_node_1.getNodeById(nodeId);
    var view;
    if (node) {
        view = node.viewRef.get();
    }
    return view;
}
function getDocument() {
    var topMostFrame = frameTopmost();
    if (!topMostFrame) {
        return undefined;
    }
    try {
        topMostFrame.ensureDomNode();
    }
    catch (e) {
        console.log("ERROR in getDocument(): " + e);
    }
    return topMostFrame.domNode.toObject();
}
exports.getDocument = getDocument;
function getComputedStylesForNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        return view.domNode.getComputedProperties();
    }
    return [];
}
exports.getComputedStylesForNode = getComputedStylesForNode;
exports.removeNode = utils_1.mainThreadify(function removeNode(nodeId) {
    var view = getViewById(nodeId);
    if (view) {
        var parent_1 = view.parent;
        if (parent_1.removeChild) {
            parent_1.removeChild(view);
        }
        else if (parent_1.content === view) {
            parent_1.content = null;
        }
        else {
            console.log("Can't remove child from " + parent_1);
        }
    }
});
exports.setAttributeAsText = utils_1.mainThreadify(function setAttributeAsText(nodeId, text, name) {
    var view = getViewById(nodeId);
    if (view) {
        var hasOriginalAttribute = !!name.trim();
        if (text) {
            var textParts = text.split("=");
            if (textParts.length === 2) {
                var attrName = textParts[0];
                var attrValue = textParts[1].replace(/['"]+/g, "");
                if (name !== attrName && hasOriginalAttribute) {
                    unsetViewValue(view, name);
                    view[attrName] = attrValue;
                }
                else {
                    view[hasOriginalAttribute ? name : attrName] = attrValue;
                }
            }
        }
        else {
            unsetViewValue(view, name);
        }
        view.domNode.loadAttributes();
    }
});
//# sourceMappingURL=devtools-elements.common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/devtools-elements.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var devtools_elements_common_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.common.js");
var dom_node_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
function attachDOMInspectorEventCallbacks(DOMDomainFrontend) {
    dom_node_1.registerInspectorEvents(DOMDomainFrontend);
    var originalChildNodeInserted = DOMDomainFrontend.childNodeInserted;
    DOMDomainFrontend.childNodeInserted = function (parentId, lastId, node) {
        originalChildNodeInserted(parentId, lastId, node.toObject());
    };
}
exports.attachDOMInspectorEventCallbacks = attachDOMInspectorEventCallbacks;
function attachDOMInspectorCommandCallbacks(DOMDomainBackend) {
    DOMDomainBackend.getDocument = devtools_elements_common_1.getDocument;
    DOMDomainBackend.removeNode = devtools_elements_common_1.removeNode;
    DOMDomainBackend.setAttributeAsText = devtools_elements_common_1.setAttributeAsText;
}
exports.attachDOMInspectorCommandCallbacks = attachDOMInspectorCommandCallbacks;
function attachCSSInspectorCommandCallbacks(CSSDomainBackend) {
    CSSDomainBackend.getComputedStylesForNode = devtools_elements_common_1.getComputedStylesForNode;
}
exports.attachCSSInspectorCommandCallbacks = attachCSSInspectorCommandCallbacks;
//# sourceMappingURL=devtools-elements.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/dom-node.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var registeredDomNodes = {};
var ELEMENT_NODE_TYPE = 1;
var ROOT_NODE_TYPE = 9;
var propertyBlacklist = [
    "effectivePaddingLeft",
    "effectivePaddingBottom",
    "effectivePaddingRight",
    "effectivePaddingTop",
    "effectiveBorderTopWidth",
    "effectiveBorderRightWidth",
    "effectiveBorderBottomWidth",
    "effectiveBorderLeftWidth",
    "effectiveMinWidth",
    "effectiveMinHeight",
    "effectiveWidth",
    "effectiveHeight",
    "effectiveMarginLeft",
    "effectiveMarginTop",
    "effectiveMarginRight",
    "effectiveMarginBottom",
    "nodeName",
    "nodeType",
    "decodeWidth",
    "decodeHeight",
    "ng-reflect-items",
    "domNode",
    "touchListenerIsSet",
    "bindingContext",
    "nativeView"
];
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
var percentLengthToStringLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js").PercentLength.convertToString; });
var getSetPropertiesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getSetProperties; });
var getComputedCssValuesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getComputedCssValues; });
function registerInspectorEvents(inspector) {
    inspectorFrontendInstance = inspector;
}
exports.registerInspectorEvents = registerInspectorEvents;
var inspectorFrontendInstance;
function notifyInspector(callback) {
    if (inspectorFrontendInstance) {
        callback(inspectorFrontendInstance);
    }
}
function valueToString(value) {
    if (typeof value === "undefined" || value === null) {
        return "";
    }
    else if (typeof value === "object" && value.unit) {
        return percentLengthToStringLazy()(value);
    }
    else {
        return value + "";
    }
}
function propertyFilter(_a) {
    var name = _a[0], value = _a[1];
    if (name[0] === "_") {
        return false;
    }
    if (value !== null && typeof value === "object") {
        return false;
    }
    if (propertyBlacklist.indexOf(name) >= 0) {
        return false;
    }
    return true;
}
function registerNode(domNode) {
    registeredDomNodes[domNode.nodeId] = domNode;
}
function unregisterNode(domNode) {
    delete registeredDomNodes[domNode.nodeId];
}
function getNodeById(id) {
    return registeredDomNodes[id];
}
exports.getNodeById = getNodeById;
var DOMNode = (function () {
    function DOMNode(view) {
        this.nodeValue = "";
        this.attributes = [];
        this.viewRef = new WeakRef(view);
        this.nodeType = view.typeName === "Frame" ? ROOT_NODE_TYPE : ELEMENT_NODE_TYPE;
        this.nodeId = view._domId;
        this.nodeName = view.typeName;
        this.localName = this.nodeName;
        this.loadAttributes();
        registerNode(this);
    }
    DOMNode.prototype.loadAttributes = function () {
        var _this = this;
        this.attributes = [];
        getSetPropertiesLazy()(this.viewRef.get())
            .filter(propertyFilter)
            .forEach(function (pair) { return _this.attributes.push(pair[0], pair[1] + ""); });
    };
    Object.defineProperty(DOMNode.prototype, "children", {
        get: function () {
            var view = this.viewRef.get();
            if (!view) {
                return [];
            }
            var res = [];
            view.eachChild(function (child) {
                child.ensureDomNode();
                res.push(child.domNode);
                return true;
            });
            return res;
        },
        enumerable: true,
        configurable: true
    });
    DOMNode.prototype.onChildAdded = function (childView) {
        var _this = this;
        notifyInspector(function (ins) {
            var view = _this.viewRef.get();
            var previousChild;
            view.eachChild(function (child) {
                if (child === childView) {
                    return false;
                }
                previousChild = child;
                return true;
            });
            var index = !!previousChild ? previousChild._domId : 0;
            childView.ensureDomNode();
            ins.childNodeInserted(_this.nodeId, index, childView.domNode);
        });
    };
    DOMNode.prototype.onChildRemoved = function (view) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.childNodeRemoved(_this.nodeId, view._domId);
        });
    };
    DOMNode.prototype.attributeModified = function (name, value) {
        var _this = this;
        notifyInspector(function (ins) {
            if (propertyBlacklist.indexOf(name) < 0) {
                ins.attributeModified(_this.nodeId, name, valueToString(value));
            }
        });
    };
    DOMNode.prototype.attributeRemoved = function (name) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.attributeRemoved(_this.nodeId, name);
        });
    };
    DOMNode.prototype.getComputedProperties = function () {
        var view = this.viewRef.get();
        if (!view) {
            return [];
        }
        var result = getComputedCssValuesLazy()(view)
            .filter(function (pair) { return pair[0][0] !== "_"; })
            .map(function (pair) {
            return {
                name: pair[0],
                value: valueToString(pair[1])
            };
        });
        return result;
    };
    DOMNode.prototype.dispose = function () {
        unregisterNode(this);
        this.viewRef.clear();
    };
    DOMNode.prototype.toObject = function () {
        return {
            nodeId: this.nodeId,
            nodeType: this.nodeType,
            nodeName: this.nodeName,
            localName: this.localName,
            nodeValue: this.nodeValue,
            children: this.children.map(function (c) { return c.toObject(); }),
            attributes: this.attributes,
            backendNodeId: 0
        };
    };
    return DOMNode;
}());
exports.DOMNode = DOMNode;
//# sourceMappingURL=dom-node.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/webinspector-css.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var inspectorCommands = __webpack_require__("../node_modules/tns-core-modules/debugger/InspectorBackendCommands.js");
var debuggerDomains = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var devtools_elements_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.js");
var CSSDomainDebugger = (function () {
    function CSSDomainDebugger() {
        this.events = new inspectorCommands.CSSDomain.CSSFrontend();
        this.commands = {};
        devtools_elements_1.attachCSSInspectorCommandCallbacks(this.commands);
        this.enable();
    }
    Object.defineProperty(CSSDomainDebugger.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        enumerable: true,
        configurable: true
    });
    CSSDomainDebugger.prototype.enable = function () {
        if (debuggerDomains.getCSS()) {
            throw new Error("One CSSDomainDebugger may be enabled at a time.");
        }
        else {
            debuggerDomains.setCSS(this);
        }
        this._enabled = true;
    };
    CSSDomainDebugger.prototype.disable = function () {
        if (debuggerDomains.getCSS() === this) {
            debuggerDomains.setCSS(null);
        }
        this._enabled = false;
    };
    CSSDomainDebugger.prototype.getMatchedStylesForNode = function (params) {
        return {};
    };
    CSSDomainDebugger.prototype.getInlineStylesForNode = function (params) {
        return {};
    };
    CSSDomainDebugger.prototype.getComputedStyleForNode = function (params) {
        return { computedStyle: this.commands.getComputedStylesForNode(params.nodeId) };
    };
    CSSDomainDebugger.prototype.getPlatformFontsForNode = function (params) {
        return {
            fonts: [
                {
                    familyName: "Standard Font",
                    isCustomFont: false,
                    glyphCount: 0
                }
            ]
        };
    };
    CSSDomainDebugger.prototype.getStyleSheetText = function (params) {
        return null;
    };
    CSSDomainDebugger = __decorate([
        inspectorCommands.DomainDispatcher("CSS")
    ], CSSDomainDebugger);
    return CSSDomainDebugger;
}());
exports.CSSDomainDebugger = CSSDomainDebugger;
//# sourceMappingURL=webinspector-css.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/webinspector-dom.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var inspectorCommands = __webpack_require__("../node_modules/tns-core-modules/debugger/InspectorBackendCommands.js");
var debuggerDomains = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var devtools_elements_1 = __webpack_require__("../node_modules/tns-core-modules/debugger/devtools-elements.js");
var DOMDomainDebugger = (function () {
    function DOMDomainDebugger() {
        this.events = new inspectorCommands.DOMDomain.DOMFrontend();
        this.commands = {};
        devtools_elements_1.attachDOMInspectorEventCallbacks(this.events);
        devtools_elements_1.attachDOMInspectorCommandCallbacks(this.commands);
        this.enable();
    }
    Object.defineProperty(DOMDomainDebugger.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        enumerable: true,
        configurable: true
    });
    DOMDomainDebugger.prototype.enable = function () {
        if (debuggerDomains.getDOM()) {
            throw new Error("One DOMDomainDebugger may be enabled at a time.");
        }
        else {
            debuggerDomains.setDOM(this);
        }
        this._enabled = true;
    };
    DOMDomainDebugger.prototype.disable = function () {
        if (debuggerDomains.getDOM() === this) {
            debuggerDomains.setDOM(null);
        }
        this._enabled = false;
    };
    DOMDomainDebugger.prototype.getDocument = function () {
        var domNode = this.commands.getDocument();
        return { root: domNode };
    };
    DOMDomainDebugger.prototype.removeNode = function (params) {
        this.commands.removeNode(params.nodeId);
    };
    DOMDomainDebugger.prototype.setAttributeValue = function (params) {
        throw new Error("Method not implemented.");
    };
    DOMDomainDebugger.prototype.setAttributesAsText = function (params) {
        this.commands.setAttributeAsText(params.nodeId, params.text, params.name);
    };
    DOMDomainDebugger.prototype.removeAttribute = function (params) {
        throw new Error("Method not implemented.");
    };
    DOMDomainDebugger.prototype.performSearch = function (params) {
        return null;
    };
    DOMDomainDebugger.prototype.getSearchResults = function (params) {
        return null;
    };
    DOMDomainDebugger.prototype.discardSearchResults = function (params) {
        return;
    };
    DOMDomainDebugger.prototype.highlightNode = function (params) {
        return;
    };
    DOMDomainDebugger.prototype.hideHighlight = function () {
        return;
    };
    DOMDomainDebugger.prototype.resolveNode = function (params) {
        return null;
    };
    DOMDomainDebugger = __decorate([
        inspectorCommands.DomainDispatcher("DOM")
    ], DOMDomainDebugger);
    return DOMDomainDebugger;
}());
exports.DOMDomainDebugger = DOMDomainDebugger;
//# sourceMappingURL=webinspector-dom.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/webinspector-network.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var inspectorCommands = __webpack_require__("../node_modules/tns-core-modules/debugger/InspectorBackendCommands.js");
var debuggerDomains = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var frameId = "NativeScriptMainFrameIdentifier";
var loaderId = "Loader Identifier";
var resources_datas = [];
var documentTypeByMimeType = {
    "text/xml": "Document",
    "text/plain": "Document",
    "text/html": "Document",
    "application/xml": "Document",
    "application/xhtml+xml": "Document",
    "text/css": "Stylesheet",
    "text/javascript": "Script",
    "text/ecmascript": "Script",
    "application/javascript": "Script",
    "application/ecmascript": "Script",
    "application/x-javascript": "Script",
    "application/json": "Script",
    "application/x-json": "Script",
    "text/x-javascript": "Script",
    "text/x-json": "Script",
    "text/typescript": "Script"
};
var Request = (function () {
    function Request(_networkDomainDebugger, _requestID) {
        this._networkDomainDebugger = _networkDomainDebugger;
        this._requestID = _requestID;
    }
    Object.defineProperty(Request.prototype, "mimeType", {
        get: function () {
            return this._mimeType;
        },
        set: function (value) {
            if (this._mimeType !== value) {
                if (!value) {
                    this._mimeType = "text/plain";
                    this._resourceType = "Other";
                    return;
                }
                this._mimeType = value;
                var resourceType = "Other";
                if (this._mimeType in documentTypeByMimeType) {
                    resourceType = documentTypeByMimeType[this._mimeType];
                }
                if (this._mimeType.indexOf("image/") !== -1) {
                    resourceType = "Image";
                }
                if (this._mimeType.indexOf("font/") !== -1) {
                    resourceType = "Font";
                }
                this._resourceType = resourceType;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Request.prototype, "requestID", {
        get: function () {
            return this._requestID;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Request.prototype, "hasTextContent", {
        get: function () {
            return ["Document", "Stylesheet", "Script", "XHR"].indexOf(this._resourceType) !== -1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Request.prototype, "data", {
        get: function () {
            return this._data;
        },
        set: function (value) {
            if (this._data !== value) {
                this._data = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Request.prototype, "resourceType", {
        get: function () {
            return this._resourceType;
        },
        set: function (value) {
            if (this._resourceType !== value) {
                this._resourceType = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Request.prototype.responseReceived = function (response) {
        if (this._networkDomainDebugger.enabled) {
            this._networkDomainDebugger.events.responseReceived(this.requestID, frameId, loaderId, __inspectorTimestamp(), this.resourceType, response);
        }
    };
    Request.prototype.loadingFinished = function () {
        if (this._networkDomainDebugger.enabled) {
            this._networkDomainDebugger.events.loadingFinished(this.requestID, __inspectorTimestamp());
        }
    };
    Request.prototype.requestWillBeSent = function (request) {
        if (this._networkDomainDebugger.enabled) {
            this._networkDomainDebugger.events.requestWillBeSent(this.requestID, frameId, loaderId, request.url, request, __inspectorTimestamp(), { type: "Script" });
        }
    };
    return Request;
}());
exports.Request = Request;
var NetworkDomainDebugger = (function () {
    function NetworkDomainDebugger() {
        this.events = new inspectorCommands.NetworkDomain.NetworkFrontend();
        this.enable();
    }
    NetworkDomainDebugger_1 = NetworkDomainDebugger;
    Object.defineProperty(NetworkDomainDebugger.prototype, "enabled", {
        get: function () {
            return this._enabled;
        },
        enumerable: true,
        configurable: true
    });
    NetworkDomainDebugger.prototype.enable = function () {
        if (debuggerDomains.getNetwork()) {
            throw new Error("One NetworkDomainDebugger may be enabled at a time.");
        }
        else {
            debuggerDomains.setNetwork(this);
        }
        this._enabled = true;
    };
    NetworkDomainDebugger.prototype.disable = function () {
        if (debuggerDomains.getNetwork() === this) {
            debuggerDomains.setNetwork(null);
        }
        this._enabled = false;
    };
    NetworkDomainDebugger.prototype.setExtraHTTPHeaders = function (params) {
    };
    NetworkDomainDebugger.prototype.getResponseBody = function (params) {
        var resource_data = resources_datas[params.requestId];
        var body = resource_data.hasTextContent ? NSString.alloc().initWithDataEncoding(resource_data.data, 4).toString() :
            resource_data.data.base64EncodedStringWithOptions(0);
        if (resource_data) {
            return {
                body: body,
                base64Encoded: !resource_data.hasTextContent
            };
        }
    };
    NetworkDomainDebugger.prototype.canClearBrowserCache = function () {
        return {
            result: false
        };
    };
    NetworkDomainDebugger.prototype.clearBrowserCache = function () {
    };
    NetworkDomainDebugger.prototype.canClearBrowserCookies = function () {
        return {
            result: false
        };
    };
    NetworkDomainDebugger.prototype.clearBrowserCookies = function () {
    };
    NetworkDomainDebugger.prototype.setCacheDisabled = function (params) {
    };
    NetworkDomainDebugger.prototype.loadResource = function (params) {
        var appPath = NSBundle.mainBundle.bundlePath;
        var pathUrl = params.url.replace("file://", appPath);
        var fileManager = NSFileManager.defaultManager;
        var data = fileManager.fileExistsAtPath(pathUrl) ? fileManager.contentsAtPath(pathUrl) : undefined;
        var content = data ? NSString.alloc().initWithDataEncoding(data, NSUTF8StringEncoding) : "";
        return {
            content: content.toString(),
            mimeType: "application/octet-stream",
            status: 200
        };
    };
    NetworkDomainDebugger.prototype.create = function () {
        var id = (++NetworkDomainDebugger_1.idSequence).toString();
        var resourceData = new Request(this, id);
        resources_datas[id] = resourceData;
        return resourceData;
    };
    var NetworkDomainDebugger_1;
    NetworkDomainDebugger.idSequence = 0;
    NetworkDomainDebugger = NetworkDomainDebugger_1 = __decorate([
        inspectorCommands.DomainDispatcher("Network")
    ], NetworkDomainDebugger);
    return NetworkDomainDebugger;
}());
exports.NetworkDomainDebugger = NetworkDomainDebugger;
var RuntimeDomainDebugger = (function () {
    function RuntimeDomainDebugger() {
        __inspectorSendEvent("{\"method\":\"Runtime.executionContextCreated\",\"params\":{\"context\":{\"id\":1,\"origin\":\"http://main.xml\",\"name\":\"\",\"auxData\":{\"isDefault\":true,\"frameId\":\"" + frameId + "\"}}}}");
    }
    RuntimeDomainDebugger.prototype.compileScript = function () {
        return {};
    };
    RuntimeDomainDebugger = __decorate([
        inspectorCommands.DomainDispatcher("Runtime")
    ], RuntimeDomainDebugger);
    return RuntimeDomainDebugger;
}());
exports.RuntimeDomainDebugger = RuntimeDomainDebugger;
//# sourceMappingURL=webinspector-network.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {﻿(function () {
    'use strict';

    exports.XMLHttpRequest = global.XMLHttpRequest;
    exports.FormData = global.FormData;

    if (!exports.XMLHttpRequest) {
        var xhr = __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js");
        exports.XMLHttpRequest = xhr.XMLHttpRequest;
        exports.FormData = xhr.FormData;
    }

    function normalizeName(name) {
        if (typeof name !== 'string') {
            name = name.toString();
        }
        if (/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)) {
            throw new TypeError('Invalid character in header field name')
        }
        return name.toLowerCase()
    }

    function normalizeValue(value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return value
    }

    function Headers(headers) {
        this.map = {}

        if (headers instanceof Headers) {
            headers.forEach(function (value, name) {
                this.append(name, value)
            }, this)

        } else if (headers) {
            Object.getOwnPropertyNames(headers).forEach(function (name) {
                this.append(name, headers[name])
            }, this)
        }
    }

    Headers.prototype.append = function (name, value) {
        name = normalizeName(name)
        value = normalizeValue(value)
        var list = this.map[name]
        if (!list) {
            list = []
            this.map[name] = list
        }
        list.push(value)
    }

    Headers.prototype['delete'] = function (name) {
        delete this.map[normalizeName(name)]
    }

    Headers.prototype.get = function (name) {
        var values = this.map[normalizeName(name)]
        return values ? values[0] : null
    }

    Headers.prototype.getAll = function (name) {
        return this.map[normalizeName(name)] || []
    }

    Headers.prototype.has = function (name) {
        return this.map.hasOwnProperty(normalizeName(name))
    }

    Headers.prototype.set = function (name, value) {
        this.map[normalizeName(name)] = [normalizeValue(value)]
    }

    Headers.prototype.forEach = function (callback, thisArg) {
        Object.getOwnPropertyNames(this.map).forEach(function (name) {
            this.map[name].forEach(function (value) {
                callback.call(thisArg, value, name, this)
            }, this)
        }, this)
    }

    function consumed(body) {
        if (body.bodyUsed) {
            return Promise.reject(new TypeError('Already read'))
        }
        body.bodyUsed = true
    }

    function fileReaderReady(reader) {
        return new Promise(function (resolve, reject) {
            reader.onload = function () {
                resolve(reader.result)
            }
            reader.onerror = function () {
                reject(reader.error)
            }
        })
    }

    function readBlobAsArrayBuffer(blob) {
        var reader = new FileReader()
        reader.readAsArrayBuffer(blob)
        return fileReaderReady(reader)
    }

    function readBlobAsText(blob) {
        var reader = new FileReader()
        reader.readAsText(blob)
        return fileReaderReady(reader)
    }

    var support = {
        blob: 'FileReader' in exports && 'Blob' in exports && (function () {
            try {
                new Blob();
                return true
            } catch (e) {
                return false
            }
        })(),
        formData: 'FormData' in exports
    }

    function Body() {
        this.bodyUsed = false


        this._initBody = function (body) {
            this._bodyInit = body
            if (typeof body === 'string') {
                this._bodyText = body
            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
                this._bodyBlob = body
            } else if (support.formData && exports.FormData.prototype.isPrototypeOf(body)) {
                this._bodyFormData = body
            } else if (!body) {
                this._bodyText = ''
            } else {
                throw new Error('unsupported BodyInit type')
            }
        }

        if (support.blob) {
            this.blob = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return Promise.resolve(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as blob')
                } else {
                    return Promise.resolve(new Blob([this._bodyText]))
                }
            }

            this.arrayBuffer = function () {
                return this.blob().then(readBlobAsArrayBuffer)
            }

            this.text = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return readBlobAsText(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as text')
                } else {
                    return Promise.resolve(this._bodyText)
                }
            }
        } else {
            this.text = function () {
                var rejected = consumed(this)
                return rejected ? rejected : Promise.resolve(this._bodyText)
            }
        }

        if (support.formData) {
            this.formData = function () {
                return this.text().then(decode)
            }
        }

        this.json = function () {
            return this.text().then(JSON.parse)
        }

        return this
    }

    // HTTP methods whose capitalization should be normalized
    var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']

    function normalizeMethod(method) {
        var upcased = method.toUpperCase()
        return (methods.indexOf(upcased) > -1) ? upcased : method
    }

    function Request(url, options) {
        options = options || {}
        this.url = url

        this.credentials = options.credentials || 'omit'
        this.headers = new Headers(options.headers)
        this.method = normalizeMethod(options.method || 'GET')
        this.mode = options.mode || null
        this.referrer = null

        if ((this.method === 'GET' || this.method === 'HEAD') && options.body) {
            throw new TypeError('Body not allowed for GET or HEAD requests')
        }
        this._initBody(options.body)
    }

    function decode(body) {
        var form = new exports.FormData()
        body.trim().split('&').forEach(function (bytes) {
            if (bytes) {
                var split = bytes.split('=')
                var name = split.shift().replace(/\+/g, ' ')
                var value = split.join('=').replace(/\+/g, ' ')
                form.append(decodeURIComponent(name), decodeURIComponent(value))
            }
        })
        return form
    }

    function headers(xhr) {
        var head = new Headers()
        var pairs = xhr.getAllResponseHeaders().trim().split('\n')
        pairs.forEach(function (header) {
            var split = header.trim().split(':')
            var key = split.shift().trim()
            var value = split.join(':').trim()
            head.append(key, value)
        })
        return head
    }

    Body.call(Request.prototype)

    function Response(bodyInit, options) {
        if (!options) {
            options = {}
        }

        this._initBody(bodyInit)
        this.type = 'default'
        this.url = null
        this.status = options.status
        this.ok = this.status >= 200 && this.status < 300
        this.statusText = options.statusText
        this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)
        this.url = options.url || ''
    }

    Body.call(Response.prototype)

    exports.Headers = Headers;
    exports.Request = Request;
    exports.Response = Response;

    exports.fetch = function (input, init) {
        // TODO: Request constructor should accept input, init
        var request
        if (Request.prototype.isPrototypeOf(input) && !init) {
            request = input
        } else {
            request = new Request(input, init)
        }

        return new Promise(function (resolve, reject) {
            var xhr = new exports.XMLHttpRequest()

            function responseURL() {
                if ('responseURL' in xhr) {
                    return xhr.responseURL
                }

                // Avoid security warnings on getResponseHeader when not allowed by CORS
                if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {
                    return xhr.getResponseHeader('X-Request-URL')
                }

                return;
            }

            xhr.onload = function () {
                var status = (xhr.status === 1223) ? 204 : xhr.status
                if (status < 100 || status > 599) {
                    reject(new TypeError('Network request failed'))
                    return
                }
                var options = {
                    status: status,
                    statusText: xhr.statusText,
                    headers: headers(xhr),
                    url: responseURL()
                }
                //var body = 'response' in xhr ? xhr.response : xhr.responseText;
                resolve(new Response(xhr.responseText, options))
            }

            xhr.onerror = function (error) {
                reject(new TypeError(['Network request failed:', error.message].join(' ')))
            }

            xhr.open(request.method, request.url, true)

            if (request.credentials === 'include') {
                xhr.withCredentials = true
            }

            if ('responseType' in xhr && support.blob) {
                xhr.responseType = 'blob'
            }

            request.headers.forEach(function (value, name) {
                xhr.setRequestHeader(name, value)
            })

            xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)
        })
    }
    exports.fetch.polyfill = true

})();
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system-access.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var text_1 = __webpack_require__("../node_modules/tns-core-modules/text/text.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var FileSystemAccess = (function () {
    function FileSystemAccess() {
    }
    FileSystemAccess.prototype.getLastModified = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var attributes = fileManager.attributesOfItemAtPathError(path);
        if (attributes) {
            return attributes.objectForKey("NSFileModificationDate");
        }
        else {
            return new Date();
        }
    };
    FileSystemAccess.prototype.getFileSize = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var attributes = fileManager.attributesOfItemAtPathError(path);
        if (attributes) {
            return attributes.objectForKey("NSFileSize");
        }
        else {
            return 0;
        }
    };
    FileSystemAccess.prototype.getParent = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var nsString = NSString.stringWithString(path);
            var parentPath = nsString.stringByDeletingLastPathComponent;
            var name_1 = fileManager.displayNameAtPath(parentPath);
            return {
                path: parentPath.toString(),
                name: name_1
            };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFile = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = fileManager.fileExistsAtPath(path);
            if (!exists) {
                var parentPath = this.getParent(path, onError).path;
                if (!fileManager.createDirectoryAtPathWithIntermediateDirectoriesAttributesError(parentPath, true, null)
                    || !fileManager.createFileAtPathContentsAttributes(path, null, null)) {
                    if (onError) {
                        onError(new Error("Failed to create file at path '" + path + "'"));
                    }
                    return undefined;
                }
            }
            var fileName = fileManager.displayNameAtPath(path);
            return {
                path: path,
                name: fileName,
                extension: this.getFileExtension(path)
            };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFolder = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = this.folderExists(path);
            if (!exists) {
                try {
                    fileManager.createDirectoryAtPathWithIntermediateDirectoriesAttributesError(path, true, null);
                }
                catch (ex) {
                    if (onError) {
                        onError(new Error("Failed to create folder at path '" + path + "': " + ex));
                    }
                    return undefined;
                }
            }
            var dirName = fileManager.displayNameAtPath(path);
            return {
                path: path,
                name: dirName
            };
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to create folder at path '" + path + "'"));
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getExistingFolder = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = this.folderExists(path);
            if (exists) {
                var dirName = fileManager.displayNameAtPath(path);
                return {
                    path: path,
                    name: dirName
                };
            }
            return undefined;
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to get folder at path '" + path + "'"));
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.eachEntity = function (path, onEntity, onError) {
        if (!onEntity) {
            return;
        }
        this.enumEntities(path, onEntity, onError);
    };
    FileSystemAccess.prototype.getEntities = function (path, onError) {
        var fileInfos = new Array();
        var onEntity = function (entity) {
            fileInfos.push(entity);
            return true;
        };
        var errorOccurred;
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            errorOccurred = true;
        };
        this.enumEntities(path, onEntity, localError);
        if (!errorOccurred) {
            return fileInfos;
        }
        return null;
    };
    FileSystemAccess.prototype.fileExists = function (path) {
        var result = this.exists(path);
        return result.exists;
    };
    FileSystemAccess.prototype.folderExists = function (path) {
        var result = this.exists(path);
        return result.exists && result.isDirectory;
    };
    FileSystemAccess.prototype.exists = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var isDirectory = new interop.Reference(interop.types.bool, false);
        var exists = fileManager.fileExistsAtPathIsDirectory(path, isDirectory);
        return { exists: exists, isDirectory: isDirectory.value };
    };
    FileSystemAccess.prototype.concatPath = function (left, right) {
        return NSString.pathWithComponents([left, right]).toString();
    };
    FileSystemAccess.prototype.deleteFile = function (path, onError) {
        this.deleteEntity(path, onError);
    };
    FileSystemAccess.prototype.deleteFolder = function (path, onError) {
        this.deleteEntity(path, onError);
    };
    FileSystemAccess.prototype.emptyFolder = function (path, onError) {
        var fileManager = NSFileManager.defaultManager;
        var entities = this.getEntities(path, onError);
        if (!entities) {
            return;
        }
        for (var i = 0; i < entities.length; i++) {
            try {
                fileManager.removeItemAtPathError(entities[i].path);
            }
            catch (ex) {
                if (onError) {
                    onError(new Error("Failed to empty folder '" + path + "': " + ex));
                }
                return;
            }
        }
    };
    FileSystemAccess.prototype.rename = function (path, newPath, onError) {
        var fileManager = NSFileManager.defaultManager;
        try {
            fileManager.moveItemAtPathToPathError(path, newPath);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to rename '" + path + "' to '" + newPath + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.getLogicalRootPath = function () {
        var mainBundlePath = NSBundle.mainBundle.bundlePath;
        var resolvedPath = NSString.stringWithString(mainBundlePath).stringByResolvingSymlinksInPath;
        return resolvedPath;
    };
    FileSystemAccess.prototype.getDocumentsFolderPath = function () {
        return this.getKnownPath(9);
    };
    FileSystemAccess.prototype.getTempFolderPath = function () {
        return this.getKnownPath(13);
    };
    FileSystemAccess.prototype.getCurrentAppPath = function () {
        return utils_1.ios.getCurrentAppPath();
    };
    FileSystemAccess.prototype.readText = function (path, onError, encoding) {
        var actualEncoding = encoding || text_1.encoding.UTF_8;
        try {
            var nsString = NSString.stringWithContentsOfFileEncodingError(path, actualEncoding);
            return nsString.toString();
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to read file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.read = function (path, onError) {
        try {
            return NSData.dataWithContentsOfFile(path);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to read file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.writeText = function (path, content, onError, encoding) {
        var nsString = NSString.stringWithString(content);
        var actualEncoding = encoding || text_1.encoding.UTF_8;
        try {
            nsString.writeToFileAtomicallyEncodingError(path, false, actualEncoding);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to write to file '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.write = function (path, content, onError) {
        try {
            content.writeToFileAtomically(path, true);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to write to file '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.getKnownPath = function (folderType) {
        var fileManager = NSFileManager.defaultManager;
        var paths = fileManager.URLsForDirectoryInDomains(folderType, 1);
        var url = paths.objectAtIndex(0);
        return url.path;
    };
    FileSystemAccess.prototype.getFileExtension = function (path) {
        var dotIndex = path.lastIndexOf(".");
        if (dotIndex && dotIndex >= 0 && dotIndex < path.length) {
            return path.substring(dotIndex);
        }
        return "";
    };
    FileSystemAccess.prototype.deleteEntity = function (path, onError) {
        var fileManager = NSFileManager.defaultManager;
        try {
            fileManager.removeItemAtPathError(path);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to delete file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.enumEntities = function (path, callback, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var files = void 0;
            try {
                files = fileManager.contentsOfDirectoryAtPathError(path);
            }
            catch (ex) {
                if (onError) {
                    onError(new Error("Failed to enum files for folder '" + path + "': " + ex));
                }
                return;
            }
            for (var i = 0; i < files.count; i++) {
                var file = files.objectAtIndex(i);
                var info = {
                    path: this.concatPath(path, file),
                    name: file,
                    extension: ""
                };
                if (!this.folderExists(this.joinPath(path, file))) {
                    info.extension = this.getFileExtension(info.path);
                }
                var retVal = callback(info);
                if (retVal === false) {
                    break;
                }
            }
        }
        catch (ex) {
            if (onError) {
                onError(ex);
            }
        }
    };
    FileSystemAccess.prototype.getPathSeparator = function () {
        return "/";
    };
    FileSystemAccess.prototype.normalizePath = function (path) {
        var nsString = NSString.stringWithString(path);
        var normalized = nsString.stringByStandardizingPath;
        return normalized;
    };
    FileSystemAccess.prototype.joinPath = function (left, right) {
        var nsString = NSString.stringWithString(left);
        return nsString.stringByAppendingPathComponent(right);
    };
    FileSystemAccess.prototype.joinPaths = function (paths) {
        return utils_1.ios.joinPaths.apply(utils_1.ios, paths);
    };
    return FileSystemAccess;
}());
exports.FileSystemAccess = FileSystemAccess;
//# sourceMappingURL=file-system-access.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var fileAccess;
function getFileAccess() {
    if (!fileAccess) {
        fileAccess = new file_system_access_1.FileSystemAccess();
    }
    return fileAccess;
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
function createFile(info) {
    var file = new File();
    file._path = info.path;
    file._name = info.name;
    file._extension = info.extension;
    return file;
}
function createFolder(info) {
    var documents = knownFolders.documents();
    if (info.path === documents.path) {
        return documents;
    }
    var temp = knownFolders.temp();
    if (info.path === temp.path) {
        return temp;
    }
    var folder = new Folder();
    folder._path = info.path;
    folder._name = info.name;
    return folder;
}
var FileSystemEntity = (function () {
    function FileSystemEntity() {
    }
    Object.defineProperty(FileSystemEntity.prototype, "parent", {
        get: function () {
            var onError = function (error) {
                throw error;
            };
            var folderInfo = getFileAccess().getParent(this.path, onError);
            if (!folderInfo) {
                return undefined;
            }
            return createFolder(folderInfo);
        },
        enumerable: true,
        configurable: true
    });
    FileSystemEntity.prototype.remove = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.removeSync(localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.removeSync = function (onError) {
        if (this._isKnown) {
            if (onError) {
                onError({ message: "Cannot delete known folder." });
            }
            return;
        }
        var fileAccess = getFileAccess();
        if (this instanceof File) {
            fileAccess.deleteFile(this.path, onError);
        }
        else if (this instanceof Folder) {
            fileAccess.deleteFolder(this.path, onError);
        }
    };
    FileSystemEntity.prototype.rename = function (newName) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.renameSync(newName, localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.renameSync = function (newName, onError) {
        if (this._isKnown) {
            if (onError) {
                onError(new Error("Cannot rename known folder."));
            }
            return;
        }
        var parentFolder = this.parent;
        if (!parentFolder) {
            if (onError) {
                onError(new Error("No parent folder."));
            }
            return;
        }
        var fileAccess = getFileAccess();
        var path = parentFolder.path;
        var newPath = fileAccess.joinPath(path, newName);
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            return null;
        };
        fileAccess.rename(this.path, newPath, localError);
        this._path = newPath;
        this._name = newName;
        if (this instanceof File) {
            this._extension = fileAccess.getFileExtension(newPath);
        }
    };
    Object.defineProperty(FileSystemEntity.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "path", {
        get: function () {
            return this._path;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "lastModified", {
        get: function () {
            var value = this._lastModified;
            if (!this._lastModified) {
                value = this._lastModified = getFileAccess().getLastModified(this.path);
            }
            return value;
        },
        enumerable: true,
        configurable: true
    });
    return FileSystemEntity;
}());
exports.FileSystemEntity = FileSystemEntity;
var File = (function (_super) {
    __extends(File, _super);
    function File() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    File.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var fileInfo = getFileAccess().getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    File.exists = function (path) {
        return getFileAccess().fileExists(path);
    };
    Object.defineProperty(File.prototype, "extension", {
        get: function () {
            return this._extension;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "isLocked", {
        get: function () {
            return !!this._locked;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "size", {
        get: function () {
            return getFileAccess().getFileSize(this.path);
        },
        enumerable: true,
        configurable: true
    });
    File.prototype.readSync = function (onError) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().read(this.path, localError);
        this._locked = false;
        return content;
    };
    File.prototype.writeSync = function (content, onError) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_1 = this;
            var localError = function (error) {
                that_1._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().write(this.path, content, localError);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.readText = function (encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var content = _this.readTextSync(localError, encoding);
            if (!hasError) {
                resolve(content);
            }
        });
    };
    File.prototype.readTextSync = function (onError, encoding) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().readText(this.path, localError, encoding);
        this._locked = false;
        return content;
    };
    File.prototype.writeText = function (content, encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.writeTextSync(content, localError, encoding);
            if (!hasError) {
                resolve();
            }
        });
    };
    File.prototype.writeTextSync = function (content, onError, encoding) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_2 = this;
            var localError = function (error) {
                that_2._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().writeText(this.path, content, localError, encoding);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.checkAccess = function () {
        if (this.isLocked) {
            throw new Error("Cannot access a locked file.");
        }
    };
    __decorate([
        profiling_1.profile
    ], File.prototype, "readTextSync", null);
    return File;
}(FileSystemEntity));
exports.File = File;
var Folder = (function (_super) {
    __extends(Folder, _super);
    function Folder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Folder.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var folderInfo = getFileAccess().getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.exists = function (path) {
        return getFileAccess().folderExists(path);
    };
    Folder.prototype.contains = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        if (fileAccess.fileExists(path)) {
            return true;
        }
        return fileAccess.folderExists(path);
    };
    Folder.prototype.clear = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var onError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.clearSync(onError);
            if (!hasError) {
                resolve();
            }
        });
    };
    Folder.prototype.clearSync = function (onError) {
        getFileAccess().emptyFolder(this.path, onError);
    };
    Object.defineProperty(Folder.prototype, "isKnown", {
        get: function () {
            return this._isKnown;
        },
        enumerable: true,
        configurable: true
    });
    Folder.prototype.getFile = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var fileInfo = fileAccess.getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    Folder.prototype.getFolder = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var folderInfo = fileAccess.getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.prototype.getEntities = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var entities = _this.getEntitiesSync(localError);
            if (!hasError) {
                resolve(entities);
            }
        });
    };
    Folder.prototype.getEntitiesSync = function (onError) {
        var fileInfos = getFileAccess().getEntities(this.path, onError);
        if (!fileInfos) {
            return null;
        }
        var entities = new Array();
        for (var i = 0; i < fileInfos.length; i++) {
            if (fileInfos[i].extension) {
                entities.push(createFile(fileInfos[i]));
            }
            else {
                entities.push(createFolder(fileInfos[i]));
            }
        }
        return entities;
    };
    Folder.prototype.eachEntity = function (onEntity) {
        if (!onEntity) {
            return;
        }
        var onSuccess = function (fileInfo) {
            var entity;
            if (fileInfo.extension) {
                entity = createFile(fileInfo);
            }
            else {
                entity = createFolder(fileInfo);
            }
            return onEntity(entity);
        };
        var onError = function (error) {
            throw error;
        };
        getFileAccess().eachEntity(this.path, onSuccess, onError);
    };
    return Folder;
}(FileSystemEntity));
exports.Folder = Folder;
var knownFolders;
(function (knownFolders) {
    var _documents;
    var _temp;
    var _app;
    function documents() {
        if (!_documents) {
            var path_1 = getFileAccess().getDocumentsFolderPath();
            _documents = new Folder();
            _documents._path = path_1;
            _documents._isKnown = true;
        }
        return _documents;
    }
    knownFolders.documents = documents;
    function temp() {
        if (!_temp) {
            var path_2 = getFileAccess().getTempFolderPath();
            _temp = new Folder();
            _temp._path = path_2;
            _temp._isKnown = true;
        }
        return _temp;
    }
    knownFolders.temp = temp;
    function currentApp() {
        if (!_app) {
            var path_3 = getFileAccess().getCurrentAppPath();
            _app = new Folder();
            _app._path = path_3;
            _app._isKnown = true;
        }
        return _app;
    }
    knownFolders.currentApp = currentApp;
    var ios;
    (function (ios) {
        function _checkPlatform(knownFolderName) {
            ensurePlatform();
            if (!platform.isIOS) {
                throw new Error("The \"" + knownFolderName + "\" known folder is available on iOS only!");
            }
        }
        var _library;
        function library() {
            _checkPlatform("library");
            if (!_library) {
                var existingFolderInfo = getExistingFolderInfo(5);
                if (existingFolderInfo) {
                    _library = existingFolderInfo.folder;
                    _library._path = existingFolderInfo.path;
                    _library._isKnown = true;
                }
            }
            return _library;
        }
        ios.library = library;
        var _developer;
        function developer() {
            _checkPlatform("developer");
            if (!_developer) {
                var existingFolderInfo = getExistingFolderInfo(6);
                if (existingFolderInfo) {
                    _developer = existingFolderInfo.folder;
                    _developer._path = existingFolderInfo.path;
                    _developer._isKnown = true;
                }
            }
            return _developer;
        }
        ios.developer = developer;
        var _desktop;
        function desktop() {
            _checkPlatform("desktop");
            if (!_desktop) {
                var existingFolderInfo = getExistingFolderInfo(12);
                if (existingFolderInfo) {
                    _desktop = existingFolderInfo.folder;
                    _desktop._path = existingFolderInfo.path;
                    _desktop._isKnown = true;
                }
            }
            return _desktop;
        }
        ios.desktop = desktop;
        var _downloads;
        function downloads() {
            _checkPlatform("downloads");
            if (!_downloads) {
                var existingFolderInfo = getExistingFolderInfo(15);
                if (existingFolderInfo) {
                    _downloads = existingFolderInfo.folder;
                    _downloads._path = existingFolderInfo.path;
                    _downloads._isKnown = true;
                }
            }
            return _downloads;
        }
        ios.downloads = downloads;
        var _movies;
        function movies() {
            _checkPlatform("movies");
            if (!_movies) {
                var existingFolderInfo = getExistingFolderInfo(17);
                if (existingFolderInfo) {
                    _movies = existingFolderInfo.folder;
                    _movies._path = existingFolderInfo.path;
                    _movies._isKnown = true;
                }
            }
            return _movies;
        }
        ios.movies = movies;
        var _music;
        function music() {
            _checkPlatform("music");
            if (!_music) {
                var existingFolderInfo = getExistingFolderInfo(18);
                if (existingFolderInfo) {
                    _music = existingFolderInfo.folder;
                    _music._path = existingFolderInfo.path;
                    _music._isKnown = true;
                }
            }
            return _music;
        }
        ios.music = music;
        var _pictures;
        function pictures() {
            _checkPlatform("pictures");
            if (!_pictures) {
                var existingFolderInfo = getExistingFolderInfo(19);
                if (existingFolderInfo) {
                    _pictures = existingFolderInfo.folder;
                    _pictures._path = existingFolderInfo.path;
                    _pictures._isKnown = true;
                }
            }
            return _pictures;
        }
        ios.pictures = pictures;
        var _sharedPublic;
        function sharedPublic() {
            _checkPlatform("sharedPublic");
            if (!_sharedPublic) {
                var existingFolderInfo = getExistingFolderInfo(21);
                if (existingFolderInfo) {
                    _sharedPublic = existingFolderInfo.folder;
                    _sharedPublic._path = existingFolderInfo.path;
                    _sharedPublic._isKnown = true;
                }
            }
            return _sharedPublic;
        }
        ios.sharedPublic = sharedPublic;
        function getExistingFolderInfo(pathDirectory) {
            var fileAccess = getFileAccess();
            var folderPath = fileAccess.getKnownPath(pathDirectory);
            var folderInfo = fileAccess.getExistingFolder(folderPath);
            if (folderInfo) {
                return {
                    folder: createFolder(folderInfo),
                    path: folderPath
                };
            }
            return undefined;
        }
    })(ios = knownFolders.ios || (knownFolders.ios = {}));
})(knownFolders = exports.knownFolders || (exports.knownFolders = {}));
var path;
(function (path_4) {
    function normalize(path) {
        return getFileAccess().normalizePath(path);
    }
    path_4.normalize = normalize;
    function join() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        var fileAccess = getFileAccess();
        return fileAccess.joinPaths(paths);
    }
    path_4.join = join;
    path_4.separator = getFileAccess().getPathSeparator();
})(path = exports.path || (exports.path = {}));
//# sourceMappingURL=file-system.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/globals.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/ts-helpers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/register-module-helpers.js");
global.moduleMerge = function (sourceExports, destExports) {
    for (var key in sourceExports) {
        destExports[key] = sourceExports[key];
    }
};
global.zonedCallback = function (callback) {
    if (global.zone) {
        return global.zone.bind(callback);
    }
    if (global.Zone) {
        return global.Zone.current.wrap(callback);
    }
    else {
        return callback;
    }
};
global.registerModule("timer", function () { return __webpack_require__("../node_modules/tns-core-modules/timer/timer.js"); });
global.registerModule("ui/dialogs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js"); });
global.registerModule("xhr", function () { return __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js"); });
global.registerModule("fetch", function () { return __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js"); });
global.System = {
    import: function (path) {
        return new Promise(function (resolve, reject) {
            try {
                resolve(global.require(path));
            }
            catch (e) {
                reject(e);
            }
        });
    }
};
function registerOnGlobalContext(name, module) {
    Object.defineProperty(global, name, {
        get: function () {
            var m = global.loadModule(module);
            var resolvedValue = m[name];
            Object.defineProperty(global, name, { value: resolvedValue, configurable: true, writable: true });
            return resolvedValue;
        },
        configurable: true
    });
}
var snapshotGlobals;
function install() {
    if (global.__snapshot || global.__snapshotEnabled) {
        if (!snapshotGlobals) {
            var timer = __webpack_require__("../node_modules/tns-core-modules/timer/timer.js");
            var dialogs = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js");
            var xhr = __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js");
            var fetch_1 = __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js");
            snapshotGlobals = snapshotGlobals || {
                setTimeout: timer.setTimeout,
                clearTimeout: timer.clearTimeout,
                setInterval: timer.setInterval,
                clearInterval: timer.clearInterval,
                alert: dialogs.alert,
                confirm: dialogs.confirm,
                prompt: dialogs.prompt,
                login: dialogs.login,
                action: dialogs.action,
                XMLHttpRequest: xhr.XMLHttpRequest,
                FormData: xhr.FormData,
                fetch: fetch_1.fetch,
                Headers: fetch_1.Headers,
                Request: fetch_1.Request,
                Response: fetch_1.Response,
            };
        }
        var consoleModule = __webpack_require__("../node_modules/tns-core-modules/console/console.js").Console;
        global.console = global.console || new consoleModule();
        Object.assign(global, snapshotGlobals);
    }
    else {
        registerOnGlobalContext("setTimeout", "timer");
        registerOnGlobalContext("clearTimeout", "timer");
        registerOnGlobalContext("setInterval", "timer");
        registerOnGlobalContext("clearInterval", "timer");
        registerOnGlobalContext("alert", "ui/dialogs");
        registerOnGlobalContext("confirm", "ui/dialogs");
        registerOnGlobalContext("prompt", "ui/dialogs");
        registerOnGlobalContext("login", "ui/dialogs");
        registerOnGlobalContext("action", "ui/dialogs");
        registerOnGlobalContext("XMLHttpRequest", "xhr");
        registerOnGlobalContext("FormData", "xhr");
        registerOnGlobalContext("fetch", "fetch");
        registerOnGlobalContext("Headers", "fetch");
        registerOnGlobalContext("Request", "fetch");
        registerOnGlobalContext("Response", "fetch");
    }
}
exports.install = install;
install();
function Deprecated(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_1 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is deprecated");
            return originalMethod_1.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is deprecated");
        return target;
    }
}
exports.Deprecated = Deprecated;
global.Deprecated = Deprecated;
function Experimental(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_2 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is experimental");
            return originalMethod_2.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is experimental");
        return target;
    }
}
exports.Experimental = Experimental;
global.Experimental = Experimental;
//# sourceMappingURL=globals.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/register-module-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var modules = new Map();
var modulesLoadedForUI = new Set();
var defaultExtensionMap = {
    ".js": ".js",
    ".ts": ".js",
    ".css": ".css",
    ".scss": ".css",
    ".less": ".css",
    ".sass": ".css",
    ".xml": ".xml"
};
global.moduleResolvers = [global.require];
global.registerModule = function (name, loader) {
    modules.set(name, { loader: loader, moduleId: name });
};
global._unregisterModule = function _unregisterModule(name) {
    modules.delete(name);
};
global._isModuleLoadedForUI = function _isModuleLoadedForUI(moduleName) {
    return modulesLoadedForUI.has(moduleName);
};
global.registerWebpackModules = function registerWebpackModules(context, extensionMap) {
    if (extensionMap === void 0) { extensionMap = {}; }
    context.keys().forEach(function (moduleId) {
        var extDotIndex = moduleId.lastIndexOf(".");
        var base = moduleId.substr(0, extDotIndex);
        var originalExt = moduleId.substr(extDotIndex);
        var registerExt = extensionMap[originalExt] || defaultExtensionMap[originalExt] || originalExt;
        var isSourceFile = originalExt !== registerExt;
        var registerName = base + registerExt;
        var registerWithName = function (nickName) {
            modules.set(nickName, {
                moduleId: moduleId,
                loader: function () {
                    return context(moduleId);
                }
            });
        };
        if (registerName.startsWith("./") && registerName.endsWith(".js")) {
            var jsNickNames = [
                registerName.substr(2, registerName.length - 5),
                registerName.substr(0, registerName.length - 3),
                registerName.substr(2),
            ];
            jsNickNames.forEach(function (jsNickName) {
                if (isSourceFile || !global.moduleExists(jsNickName)) {
                    registerWithName(jsNickName);
                }
            });
        }
        else if (registerName.startsWith("./")) {
            var moduleNickNames = [
                registerName.substr(2),
            ];
            moduleNickNames.forEach(function (moduleNickName) {
                if (!global.moduleExists(moduleNickName)) {
                    registerWithName(moduleNickName);
                }
            });
        }
        if (isSourceFile || !global.moduleExists(registerName)) {
            registerWithName(registerName);
        }
    });
};
global.moduleExists = function moduleExists(name) {
    return modules.has(name);
};
global.loadModule = function loadModule(name, isUIModule) {
    if (isUIModule === void 0) { isUIModule = false; }
    var moduleInfo = modules.get(name);
    if (moduleInfo) {
        if (isUIModule) {
            modulesLoadedForUI.add(moduleInfo.moduleId);
        }
        var result = moduleInfo.loader(name);
        if (result.enableAutoAccept) {
            result.enableAutoAccept();
        }
        return result;
    }
    var _loop_1 = function (resolver) {
        var result = resolver(name);
        if (result) {
            modules.set(name, { moduleId: name, loader: function () { return result; } });
            return { value: result };
        }
    };
    for (var _i = 0, _a = global.moduleResolvers; _i < _a.length; _i++) {
        var resolver = _a[_i];
        var state_1 = _loop_1(resolver);
        if (typeof state_1 === "object")
            return state_1.value;
    }
};
global.getRegisteredModules = function getRegisteredModules() {
    return Array.from(modules.keys());
};
//# sourceMappingURL=register-module-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/ts-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
if (!global.__extends) {
    global.__extends = function (d, b) {
        for (var p in b) {
            if (b.hasOwnProperty(p)) {
                d[p] = b[p];
            }
        }
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
}
var tslib = __webpack_require__("../node_modules/tslib/tslib.es6.js");
for (var _i = 0, _a = Object.keys(tslib); _i < _a.length; _i++) {
    var fnName = _a[_i];
    if (typeof tslib[fnName] !== "function") {
        continue;
    }
    if (fnName in global) {
        continue;
    }
    global[fnName] = tslib[fnName];
}
//# sourceMappingURL=ts-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
function getFilenameFromUrl(url) {
    var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    var slashPos = url.lastIndexOf("/") + 1;
    var questionMarkPos = url.lastIndexOf("?");
    var actualFileName;
    if (questionMarkPos !== -1) {
        actualFileName = url.substring(slashPos, questionMarkPos);
    }
    else {
        actualFileName = url.substring(slashPos);
    }
    var result = fs.path.join(fs.knownFolders.documents().path, actualFileName);
    return result;
}
exports.getFilenameFromUrl = getFilenameFromUrl;
//# sourceMappingURL=http-request-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var domainDebugger = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var http_request_common_1 = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request-common.js");
var HttpResponseEncoding;
(function (HttpResponseEncoding) {
    HttpResponseEncoding[HttpResponseEncoding["UTF8"] = 0] = "UTF8";
    HttpResponseEncoding[HttpResponseEncoding["GBK"] = 1] = "GBK";
})(HttpResponseEncoding = exports.HttpResponseEncoding || (exports.HttpResponseEncoding = {}));
var currentDevice = UIDevice.currentDevice;
var device = currentDevice.userInterfaceIdiom === 0 ? "Phone" : "Pad";
var osVersion = currentDevice.systemVersion;
var GET = "GET";
var USER_AGENT_HEADER = "User-Agent";
var USER_AGENT = "Mozilla/5.0 (i" + device + "; CPU OS " + osVersion.replace(".", "_") + " like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/" + osVersion + " Mobile/10A5355d Safari/8536.25";
var sessionConfig = NSURLSessionConfiguration.defaultSessionConfiguration;
var queue = NSOperationQueue.mainQueue;
function parseJSON(source) {
    var src = source.trim();
    if (src.lastIndexOf(")") === src.length - 1) {
        return JSON.parse(src.substring(src.indexOf("(") + 1, src.lastIndexOf(")")));
    }
    return JSON.parse(src);
}
var NSURLSessionTaskDelegateImpl = (function (_super) {
    __extends(NSURLSessionTaskDelegateImpl, _super);
    function NSURLSessionTaskDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NSURLSessionTaskDelegateImpl.prototype.URLSessionTaskWillPerformHTTPRedirectionNewRequestCompletionHandler = function (session, task, response, request, completionHandler) {
        completionHandler(null);
    };
    NSURLSessionTaskDelegateImpl.ObjCProtocols = [NSURLSessionTaskDelegate];
    return NSURLSessionTaskDelegateImpl;
}(NSObject));
var sessionTaskDelegateInstance = NSURLSessionTaskDelegateImpl.new();
var defaultSession;
function ensureDefaultSession() {
    if (!defaultSession) {
        defaultSession = NSURLSession.sessionWithConfigurationDelegateDelegateQueue(sessionConfig, null, queue);
    }
}
var sessionNotFollowingRedirects;
function ensureSessionNotFollowingRedirects() {
    if (!sessionNotFollowingRedirects) {
        sessionNotFollowingRedirects = NSURLSession.sessionWithConfigurationDelegateDelegateQueue(sessionConfig, sessionTaskDelegateInstance, queue);
    }
}
var imageSource;
function ensureImageSource() {
    if (!imageSource) {
        imageSource = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
    }
}
var fs;
function ensureFileSystem() {
    if (!fs) {
        fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    }
}
function request(options) {
    return new Promise(function (resolve, reject) {
        if (!options.url) {
            reject(new Error("Request url was empty."));
            return;
        }
        try {
            var network = domainDebugger.getNetwork();
            var debugRequest_1 = network && network.create();
            var urlRequest = NSMutableURLRequest.requestWithURL(NSURL.URLWithString(options.url));
            urlRequest.HTTPMethod = types.isDefined(options.method) ? options.method : GET;
            urlRequest.setValueForHTTPHeaderField(USER_AGENT, USER_AGENT_HEADER);
            if (options.headers) {
                for (var header in options.headers) {
                    urlRequest.setValueForHTTPHeaderField(options.headers[header] + "", header);
                }
            }
            if (types.isString(options.content) || options.content instanceof FormData) {
                urlRequest.HTTPBody = NSString.stringWithString(options.content.toString()).dataUsingEncoding(4);
            }
            if (types.isNumber(options.timeout)) {
                urlRequest.timeoutInterval = options.timeout / 1000;
            }
            var session = void 0;
            if (types.isBoolean(options.dontFollowRedirects) && options.dontFollowRedirects) {
                ensureSessionNotFollowingRedirects();
                session = sessionNotFollowingRedirects;
            }
            else {
                ensureDefaultSession();
                session = defaultSession;
            }
            var dataTask = session.dataTaskWithRequestCompletionHandler(urlRequest, function (data, response, error) {
                if (error) {
                    reject(new Error(error.localizedDescription));
                }
                else {
                    var headers_1 = {};
                    if (response && response.allHeaderFields) {
                        var headerFields = response.allHeaderFields;
                        headerFields.enumerateKeysAndObjectsUsingBlock(function (key, value, stop) {
                            addHeader(headers_1, key, value);
                        });
                    }
                    if (debugRequest_1) {
                        debugRequest_1.mimeType = response.MIMEType;
                        debugRequest_1.data = data;
                        var debugResponse = {
                            url: options.url,
                            status: response.statusCode,
                            statusText: NSHTTPURLResponse.localizedStringForStatusCode(response.statusCode),
                            headers: headers_1,
                            mimeType: response.MIMEType,
                            fromDiskCache: false
                        };
                        debugRequest_1.responseReceived(debugResponse);
                        debugRequest_1.loadingFinished();
                    }
                    resolve({
                        content: {
                            raw: data,
                            toString: function (encoding) { return NSDataToString(data, encoding); },
                            toJSON: function (encoding) { return parseJSON(NSDataToString(data, encoding)); },
                            toImage: function () {
                                ensureImageSource();
                                return new Promise(function (resolve, reject) {
                                    UIImage.tns_decodeImageWithDataCompletion(data, function (image) {
                                        if (image) {
                                            resolve(imageSource.fromNativeSource(image));
                                        }
                                        else {
                                            reject(new Error("Response content may not be converted to an Image"));
                                        }
                                    });
                                });
                            },
                            toFile: function (destinationFilePath) {
                                ensureFileSystem();
                                if (!destinationFilePath) {
                                    destinationFilePath = http_request_common_1.getFilenameFromUrl(options.url);
                                }
                                if (data instanceof NSData) {
                                    var file = fs.File.fromPath(destinationFilePath);
                                    data.writeToFileAtomically(destinationFilePath, true);
                                    return file;
                                }
                                else {
                                    reject(new Error("Cannot save file with path: " + destinationFilePath + "."));
                                }
                            }
                        },
                        statusCode: response.statusCode,
                        headers: headers_1
                    });
                }
            });
            if (options.url && debugRequest_1) {
                var request_1 = {
                    url: options.url,
                    method: "GET",
                    headers: options.headers
                };
                debugRequest_1.requestWillBeSent(request_1);
            }
            dataTask.resume();
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.request = request;
function NSDataToString(data, encoding) {
    var code = NSUTF8StringEncoding;
    if (encoding === HttpResponseEncoding.GBK) {
        code = 1586;
    }
    var encodedString = NSString.alloc().initWithDataEncoding(data, code);
    if (!encodedString) {
        code = NSISOLatin1StringEncoding;
        encodedString = NSString.alloc().initWithDataEncoding(data, code);
    }
    return encodedString.toString();
}
function addHeader(headers, key, value) {
    if (!headers[key]) {
        headers[key] = value;
    }
    else if (Array.isArray(headers[key])) {
        headers[key].push(value);
    }
    else {
        var values = [headers[key]];
        values.push(value);
        headers[key] = values;
    }
}
exports.addHeader = addHeader;
//# sourceMappingURL=http-request.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var httpRequest = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js");
__export(__webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js"));
function getString(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var str = r.content.toString();
                resolve(str);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getString = getString;
function getJSON(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var json = r.content.toJSON();
                resolve(json);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getJSON = getJSON;
function getImage(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                resolve(r.content.toImage());
            }
            catch (err) {
                reject(err);
            }
        }, function (err) {
            reject(err);
        });
    });
}
exports.getImage = getImage;
function getFile(arg, destinationFilePath) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var file = r.content.toFile(destinationFilePath);
                resolve(file);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getFile = getFile;
//# sourceMappingURL=http.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var ImageAssetBase = (function (_super) {
    __extends(ImageAssetBase, _super);
    function ImageAssetBase() {
        var _this = _super.call(this) || this;
        _this._options = { keepAspectRatio: true, autoScaleFactor: true };
        return _this;
    }
    Object.defineProperty(ImageAssetBase.prototype, "options", {
        get: function () {
            return this._options;
        },
        set: function (value) {
            this._options = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageAssetBase.prototype, "nativeImage", {
        get: function () {
            return this._nativeImage;
        },
        set: function (value) {
            this._nativeImage = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAssetBase.prototype.getImageAsync = function (callback) {
    };
    return ImageAssetBase;
}(observable_1.Observable));
exports.ImageAssetBase = ImageAssetBase;
function getAspectSafeDimensions(sourceWidth, sourceHeight, reqWidth, reqHeight) {
    var widthCoef = sourceWidth / reqWidth;
    var heightCoef = sourceHeight / reqHeight;
    var aspectCoef = Math.min(widthCoef, heightCoef);
    return {
        width: Math.floor(sourceWidth / aspectCoef),
        height: Math.floor(sourceHeight / aspectCoef)
    };
}
exports.getAspectSafeDimensions = getAspectSafeDimensions;
function getRequestedImageSize(src, options) {
    var screen = platform_1.screen.mainScreen;
    var reqWidth = options.width || Math.min(src.width, screen.widthPixels);
    var reqHeight = options.height || Math.min(src.height, screen.heightPixels);
    if (options && options.keepAspectRatio) {
        var safeAspectSize = getAspectSafeDimensions(src.width, src.height, reqWidth, reqHeight);
        reqWidth = safeAspectSize.width;
        reqHeight = safeAspectSize.height;
    }
    return {
        width: reqWidth,
        height: reqHeight
    };
}
exports.getRequestedImageSize = getRequestedImageSize;
//# sourceMappingURL=image-asset-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-asset/image-asset.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_asset_common_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset-common.js"));
var ImageAsset = (function (_super) {
    __extends(ImageAsset, _super);
    function ImageAsset(asset) {
        var _this = _super.call(this) || this;
        if (typeof asset === "string") {
            if (asset.indexOf("~/") === 0) {
                asset = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, asset.replace("~/", ""));
            }
            _this.nativeImage = UIImage.imageWithContentsOfFile(asset);
        }
        else if (asset instanceof UIImage) {
            _this.nativeImage = asset;
        }
        else {
            _this.ios = asset;
        }
        return _this;
    }
    Object.defineProperty(ImageAsset.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        set: function (value) {
            this._ios = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageAsset.prototype.getImageAsync = function (callback) {
        var _this = this;
        if (!this.ios && !this.nativeImage) {
            callback(null, "Asset cannot be found.");
        }
        var srcWidth = this.nativeImage ? this.nativeImage.size.width : this.ios.pixelWidth;
        var srcHeight = this.nativeImage ? this.nativeImage.size.height : this.ios.pixelHeight;
        var requestedSize = image_asset_common_1.getRequestedImageSize({ width: srcWidth, height: srcHeight }, this.options);
        if (this.nativeImage) {
            var newSize = CGSizeMake(requestedSize.width, requestedSize.height);
            var resizedImage = this.scaleImage(this.nativeImage, newSize);
            callback(resizedImage, null);
            return;
        }
        var imageRequestOptions = PHImageRequestOptions.alloc().init();
        imageRequestOptions.deliveryMode = 1;
        imageRequestOptions.networkAccessAllowed = true;
        PHImageManager.defaultManager().requestImageForAssetTargetSizeContentModeOptionsResultHandler(this.ios, requestedSize, 0, imageRequestOptions, function (image, imageResultInfo) {
            if (image) {
                var resultImage = _this.scaleImage(image, requestedSize);
                callback(resultImage, null);
            }
            else {
                callback(null, imageResultInfo.valueForKey(PHImageErrorKey));
            }
        });
    };
    ImageAsset.prototype.scaleImage = function (image, requestedSize) {
        var scaleFactor = this.options && this.options.autoScaleFactor === false ? 1.0 : 0.0;
        UIGraphicsBeginImageContextWithOptions(requestedSize, false, scaleFactor);
        image.drawInRect(CGRectMake(0, 0, requestedSize.width, requestedSize.height));
        var resultImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
        return resultImage;
    };
    return ImageAsset;
}(image_asset_common_1.ImageAssetBase));
exports.ImageAsset = ImageAsset;
//# sourceMappingURL=image-asset.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-source/image-source.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
var http;
function ensureHttp() {
    if (!http) {
        http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
    }
}
var ImageSource = (function () {
    function ImageSource() {
    }
    ImageSource.prototype.fromAsset = function (asset) {
        return new Promise(function (resolve, reject) {
            asset.getImageAsync(function (image, err) {
                if (image) {
                    resolve(fromNativeSource(image));
                }
                else {
                    reject(err);
                }
            });
        });
    };
    ImageSource.prototype.loadFromResource = function (name) {
        this.ios = UIImage.tns_safeImageNamed(name) || UIImage.tns_safeImageNamed(name + ".jpg");
        return this.ios != null;
    };
    ImageSource.prototype.fromResource = function (name) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_safeDecodeImageNamedCompletion(name, function (image) {
                    if (image) {
                        _this.ios = image;
                        resolve(true);
                    }
                    else {
                        UIImage.tns_safeDecodeImageNamedCompletion(name + ".jpg", function (image) {
                            _this.ios = image;
                            resolve(true);
                        });
                    }
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromFile = function (path) {
        this.ios = UIImage.imageWithContentsOfFile(getFileName(path));
        return this.ios != null;
    };
    ImageSource.prototype.fromFile = function (path) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_decodeImageWidthContentsOfFileCompletion(getFileName(path), function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromData = function (data) {
        this.ios = UIImage.imageWithData(data);
        return this.ios != null;
    };
    ImageSource.prototype.fromData = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_decodeImageWithDataCompletion(data, function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromBase64 = function (source) {
        if (typeof source === "string") {
            var data = NSData.alloc().initWithBase64EncodedStringOptions(source, 1);
            this.ios = UIImage.imageWithData(data);
        }
        return this.ios != null;
    };
    ImageSource.prototype.fromBase64 = function (source) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                var data = NSData.alloc().initWithBase64EncodedStringOptions(source, 1);
                UIImage.imageWithData["async"](UIImage, [data]).then(function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromFontIconCode = function (source, font, color) {
        var _a;
        var fontSize = utils_1.layout.toDevicePixels(font.fontSize);
        if (!fontSize) {
            fontSize = UIFont.labelFontSize;
        }
        var density = utils_1.layout.getDisplayDensity();
        var scaledFontSize = fontSize * density;
        var attributes = (_a = {},
            _a[NSFontAttributeName] = font.getUIFont(UIFont.systemFontOfSize(scaledFontSize)),
            _a);
        if (color) {
            attributes[NSForegroundColorAttributeName] = color.ios;
        }
        var attributedString = NSAttributedString.alloc().initWithStringAttributes(source, attributes);
        UIGraphicsBeginImageContextWithOptions(attributedString.size(), false, 0.0);
        attributedString.drawAtPoint(CGPointMake(0, 0));
        var iconImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
        this.ios = iconImage;
        return this.ios != null;
    };
    ImageSource.prototype.setNativeSource = function (source) {
        if (source && !(source instanceof UIImage)) {
            throw new Error("The method setNativeSource() expects UIImage instance.");
        }
        this.ios = source;
    };
    ImageSource.prototype.saveToFile = function (path, format, quality) {
        if (!this.ios) {
            return false;
        }
        if (quality) {
            quality = (quality - 0) / (100 - 0);
        }
        var data = getImageData(this.ios, format, quality);
        if (data) {
            return NSFileManager.defaultManager.createFileAtPathContentsAttributes(path, data, null);
        }
        return false;
    };
    ImageSource.prototype.toBase64String = function (format, quality) {
        var res = null;
        if (!this.ios) {
            return res;
        }
        if (quality) {
            quality = (quality - 0) / (100 - 0);
        }
        var data = getImageData(this.ios, format, quality);
        if (data) {
            res = data.base64Encoding();
        }
        return res;
    };
    Object.defineProperty(ImageSource.prototype, "height", {
        get: function () {
            if (this.ios) {
                return this.ios.size.height;
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "width", {
        get: function () {
            if (this.ios) {
                return this.ios.size.width;
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "rotationAngle", {
        get: function () {
            return NaN;
        },
        set: function (_value) {
        },
        enumerable: true,
        configurable: true
    });
    return ImageSource;
}());
exports.ImageSource = ImageSource;
function getFileName(path) {
    var fileName = typeof path === "string" ? path.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
    }
    return fileName;
}
function getImageData(instance, format, quality) {
    if (quality === void 0) { quality = 0.9; }
    var data = null;
    switch (format) {
        case "png":
            data = UIImagePNGRepresentation(instance);
            break;
        case "jpeg":
        case "jpg":
            data = UIImageJPEGRepresentation(instance, quality);
            break;
    }
    return data;
}
function fromAsset(asset) {
    var image = new ImageSource();
    return image.fromAsset(asset);
}
exports.fromAsset = fromAsset;
function fromResource(name) {
    var image = new ImageSource();
    return image.loadFromResource(name) ? image : null;
}
exports.fromResource = fromResource;
function fromFile(path) {
    var image = new ImageSource();
    return image.loadFromFile(path) ? image : null;
}
exports.fromFile = fromFile;
function fromFontIconCode(source, font, color) {
    var image = new ImageSource();
    return image.loadFromFontIconCode(source, font, color) ? image : null;
}
exports.fromFontIconCode = fromFontIconCode;
function fromData(data) {
    var image = new ImageSource();
    return image.loadFromData(data) ? image : null;
}
exports.fromData = fromData;
function fromBase64(source) {
    var image = new ImageSource();
    return image.loadFromBase64(source) ? image : null;
}
exports.fromBase64 = fromBase64;
function fromNativeSource(source) {
    var imageSource = new ImageSource();
    imageSource.setNativeSource(source);
    return imageSource;
}
exports.fromNativeSource = fromNativeSource;
function fromUrl(url) {
    ensureHttp();
    return http.getImage(url);
}
exports.fromUrl = fromUrl;
function fromFileOrResource(path) {
    if (!utils_1.isFileOrResourcePath(path)) {
        throw new Error("Path \"" + "\" is not a valid file or resource.");
    }
    if (path.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        return fromResource(path.substr(utils_1.RESOURCE_PREFIX.length));
    }
    return fromFile(path);
}
exports.fromFileOrResource = fromFileOrResource;
//# sourceMappingURL=image-source.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/inspector_modules.js":
/***/ (function(module, exports, __webpack_require__) {

console.log("Loading inspector modules...");
__webpack_require__("../node_modules/tns-core-modules/globals/ts-helpers.js");
__webpack_require__("../node_modules/tns-core-modules/debugger/webinspector-network.js");
__webpack_require__("../node_modules/tns-core-modules/debugger/webinspector-dom.js");
__webpack_require__("../node_modules/tns-core-modules/debugger/webinspector-css.js");
console.log("Finished loading inspector modules.");
//# sourceMappingURL=inspector_modules.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/easysax/easysax.js":
/***/ (function(module, exports, __webpack_require__) {

﻿	/*
	new function() {
		var parser = new EasySAXParser();

		parser.ns('rss', { // or false
			rss: 'http://purl.org/rss/1.0/',
			atom: 'http://www.w3.org/2005/Atom',
			xhtml: 'http://www.w3.org/1999/xhtml',
			media: 'http://search.yahoo.com/mrss/'
		});


		parser.on('error', function(msg) {
			//console.log(msg)
		});

		parser.on('startNode', function(elem, attr, uq, tagend, getStrNode) {
			attr();
			return;
			if (tagend) {
				console.log('   '+str)
			} else {
				console.log('+  '+str)
			};
		});

		parser.on('endNode', function(elem, uq, tagstart, str) {
			return;
			if (!tagstart) console.log('-  ' + str)
		});

		parser.on('textNode', function(s, uq) {
			uq(s);
			return
			console.log('   '+s)
		});

		parser.on('cdata', function(data) {
		});


		parser.on('comment', function(text) {
			//console.log('--'+text+'--')
		});

		//parser.on('question', function() {}); // <? ... ?>
		//parser.on('attention', function() {}); // <!XXXXX zzzz="eeee">

		console.time('easysax');
		for(var z=1000;z--;) {
			parser.parse(xml)
		};
		console.timeEnd('easysax');
	};


	*/

// << ------------------------------------------------------------------------ >> //


if (true /*&& this == exports*/) {
	module.exports.EasySAXParser = EasySAXParser;
};

function EasySAXParser() {
	'use strict';

	if (!this) return null;

    this.angularSyntax = false;

	function nullFunc() {};

	this.onTextNode = nullFunc;
    this.onStartNode = nullFunc;
    this.onEndNode = nullFunc;
    this.onCDATA = nullFunc;
    this.onError = nullFunc;
    this.onComment = null;
    this.onQuestion = null;
    this.onAttention = null;
	this.is_onComment = this.is_onQuestion = this.is_onAttention = false;

	this.isNamespace = false;
    this.useNS = null;
    this.default_xmlns = null;
    this.xmlns = null;
	this.nsmatrix = {xmlns: this.xmlns};
	this.hasSurmiseNS = false;
	;


	this.attr_string = ''; // строка атрибутов
	this.attr_posstart = 0; //
	this.attr_res; // закешированный результат разбора атрибутов , null - разбор не проводился, object - хеш атрибутов, true - нет атрибутов, false - невалидный xml
}

EasySAXParser.prototype.on = function(name, cb) {
    if (typeof cb !== 'function') {
        if (cb !== null) return;
    };

    switch(name) {
        case 'error': this.onError = cb || nullFunc; break;
        case 'startNode': this.onStartNode = cb || nullFunc; break;
        case 'endNode': this.onEndNode = cb || nullFunc; break;
        case 'textNode': this.onTextNode = cb || nullFunc; break;
        case 'cdata': this.onCDATA = cb || nullFunc; break;

        case 'comment': this.onComment = cb; this.is_onComment = !!cb; break;
        case 'question': this.onQuestion = cb; this.is_onQuestion = !!cb; break; // <? ....  ?>
        case 'attention': this.onAttention = cb; this.is_onAttention = !!cb; break; // <!XXXXX zzzz="eeee">
    };
};

EasySAXParser.prototype.ns = function(root, ns) {
    if (!root || typeof root !== 'string' || !ns) {
        return;
    };

    var u, x = {}, ok, v, i;

    for(i in ns) {
        v = ns[i];
        if (typeof v === 'string') {
            if (root === v) ok = true;
            x[i] = v;
        };
    };

    if (ok) {
        this.isNamespace = true;
        this.default_xmlns = root;
        this.useNS = x;
    };
};


EasySAXParser.prototype.parse = function(xml) {
    if (typeof xml !== 'string') {
        return;
    };

    if (this.isNamespace) {
        this.nsmatrix = {xmlns: this.default_xmlns};

        parse(xml);

        this.nsmatrix = false;

    } else {
        parse(xml);
    };

    this.attr_res = true;
};

// -----------------------------------------------------

var xharsQuot={constructor: false, hasOwnProperty: false, isPrototypeOf: false, propertyIsEnumerable: false, toLocaleString: false, toString: false, valueOf: false
    , quot: '"'
    , QUOT: '"'
    , amp: '&'
    , AMP: '&'
    , nbsp: '\u00A0'
    , apos: '\''
    , lt: '<'
    , LT: '<'
    , gt: '>'
    , GT: '>'
    , copy: '\u00A9'
    , laquo: '\u00AB'
    , raquo: '\u00BB'
    , reg: '\u00AE'
    , deg: '\u00B0'
    , plusmn: '\u00B1'
    , sup2: '\u00B2'
    , sup3: '\u00B3'
    , micro: '\u00B5'
    , para: '\u00B6'
};


function rpEntities(s, d, x, z) {
    if (z) {
        return xharsQuot[z] || '\x01';
    };

    if (d) {
        return String.fromCharCode(d);
    };

    return String.fromCharCode(parseInt(x, 16));
};

function unEntities(s, i) {
    s = String(s);
    if (s.length > 3 && s.indexOf('&') !== -1) {
        if (s.indexOf('&gt;') !== -1) s = s.replace(/&gt;/g, '>');
        if (s.indexOf('&lt;') !== -1) s = s.replace(/&lt;/g, '<');
        if (s.indexOf('&quot;') !== -1) s = s.replace(/&quot;/g, '"');

        if (s.indexOf('&') !== -1) {
            s = s.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig, rpEntities);
        };
    };

    return s;
};


EasySAXParser.prototype.allowedAngularAttributeChars = function(w) {
    if (!this.angularSyntax) {
        return false;
    } else {
        return (
            w === 40 || // (
            w === 41 || // )
            w === 91 || // [
            w === 93 || // ]
            w === 94 || // ^
            w === 35    // #
        );
    }
};

	/*
		парсит атрибуты по требованию. Важно! - функция не генерирует исключения.

		если была ошибка разбора возврашается false
		если атрибутов нет и разбор удачен то возврашается true
		если есть атрибуты то возврашается обьект(хеш)
	*/

EasySAXParser.prototype.getAttrs = function() {
    if (this.attr_res !== null) {
        return this.attr_res;
    };

    /*
    if (xxtest !== u && attr_string.indexOf(xxtest) === -1) {
        / *
            // для ускорения
            if (getAttrs('html').type == 'html') {
                ...
            };
        * /
        return true;
    };
    */

    var u
    , res = {}
    , s = this.attr_string
    , i = this.attr_posstart
    , l = s.length
    , attr_list = this.hasSurmiseNS ? [] : false
    , name, value = ''
    , ok = false
    , noValueAttribute = false
    , j, w, nn, n
    , hasNewMatrix
    , alias, newalias
    ;

    aa:
    for(; i < l; i++) {
        w = s.charCodeAt(i);

        if (w===32 || (w<14 && w > 8) ) { // \f\n\r\t\v
            continue
        };

        // Check for valid attribute start char
        if ((w < 65 && !this.allowedAngularAttributeChars(w)) ||
                w > 122 || (w > 90 && w < 97 && !this.allowedAngularAttributeChars(w)) ) { // ожидаем символ
            return this.attr_res = false; // error. invalid char
        };

        for(j = i + 1; j < l; j++) { // проверяем все символы имени атрибута
            w = s.charCodeAt(j);

            if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                if (noValueAttribute) {
                    j--; //Started next attribute. Get back and break out of the loop.
                    break;
                } else {
                    continue;
                }
            };

            if (this.allowedAngularAttributeChars(w)) {
                continue;
            }

            if (w === 32 || (w > 8 && w < 14) ) {  // \f\n\r\t\v пробел
                noValueAttribute = true;
                continue;
            } else if (w === 61) { // "=" == 61
                noValueAttribute = false;
                break;
            } else {
                //console.log('error 2');
                if (!noValueAttribute)
                    return this.attr_res = false; // error. invalid char
            };

            break;
        };

        name = s.substring(i, j).trim();
        ok = true;

        if (name === 'xmlns:xmlns') {
            //console.log('error 6')
            return this.attr_res = false; // error. invalid name
        };

        w = s.charCodeAt(j+1);

        while (w = s.charCodeAt(j+1)) {
            if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                j++;
            } else {
                break;
            }
        }

        if (!noValueAttribute) {
            if (w === 34) {  // '"'
                j = s.indexOf('"', i = j+2 );

            } else {
                if (w === 39) {
                    j = s.indexOf('\'', i = j+2 );

                } else {  // "'"
                    return this.attr_res = false; // error. invalid char
                };
            };
        }

        if (j === -1) {
            //console.log('error 4')
            return this.attr_res = false; // error. invalid char
        };


        if (j+1 < l && !noValueAttribute) {
            w = s.charCodeAt(j+1);

            if (w > 32 || w < 9 || (w < 32 && w > 13)) {
                // error. invalid char
                //console.log('error 5')
                return this.attr_res = false;
            };
        };


        if (noValueAttribute) {
            value = '';
        } else {
            value = s.substring(i, j);
        }

        //i = j + 1; // след. семвол уже проверен потому проверять нужно следуюший
        i = j; // след. семвол уже проверен потому проверять нужно следуюший

        if (this.isNamespace) { //
            if (this.hasSurmiseNS) {
                // есть подозрение что в атрибутах присутствует xmlns

                if (newalias = name === 'xmlns' ? 'xmlns' : name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:' && name.substr(6) ) {
                    alias = this.useNS[unEntities(value)];

                    if (alias) {
                        if (this.nsmatrix[newalias] !== alias) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = alias;
                        };
                    } else {
                        if (this.nsmatrix[newalias]) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = false;
                        };
                    };

                    res[name] = value;
                    continue;
                };

                attr_list.push(name, value);
                continue;
            };

            w = name.length;
            while(--w) {
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)] ) {
                        res[w + name.substr(w)] = value;
                    };
                    continue aa;

                    // 'xml:base' ???
                };
            };
        };

        res[name] = value;
        noValueAttribute = false;
    };


    if (!ok) {
        return this.attr_res = true;  // атрибутов нет, ошибок тоже нет
    };


    if (this.hasSurmiseNS)  {
        bb:

        for (i = 0, l = attr_list.length; i < l; i++) {
            name = attr_list[i++];

            w = name.length;
            while(--w) { // name.indexOf(':')
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)]) {
                        res[w + name.substr(w)] = attr_list[i];
                    };
                    continue bb;
                    break;
                };
            };

            res[name] = attr_list[i];
        };
    };

    return this.attr_res = res;
};


// xml - string
EasySAXParser.prototype.parse = function(xml) {
    var u
    , xml = String(xml)
    , nodestack = []
    , stacknsmatrix = []
    //, string_node
    , elem
    , tagend = false
    , tagstart = false
    , j = 0, i = 0, k = 0, len
    , x, y, q, w
    , xmlns
    , stopIndex = 0
    , stop // используется при разборе "namespace" . если встретился неизвестное пространство то события не генерируются
    , _nsmatrix
    , ok
    , pos = 0, ln = 0, lnStart = -2, lnEnd = -1
    ;

    len = xml.length;
    function getStringNode() {
        return xml.substring(i, j+1)
    };
    function findLineAndColumnFromPos() {
        while (lnStart < lnEnd && lnEnd < pos) {
            lnStart = lnEnd;
            lnEnd = xml.indexOf("\n", lnEnd + 1);
            ++ln;
        }
        return { line: ln, column: pos - lnStart };
    }
    function position(p) {
        pos = p;
        return findLineAndColumnFromPos;
    }

    while(j !== -1) {
        stop = stopIndex > 0;

        if (xml.charCodeAt(j) === 60) { // "<"
            i = j;
        } else {
            i = xml.indexOf('<', j);
        };

        if (i === -1) { // конец разбора

            if (nodestack.length) {
                this.onError('end file', position(j));
                return;
            };

            return;
        };

        if (j !== i && !stop) {
            ok = this.onTextNode(xml.substring(j, i), unEntities, position(j));
            if (ok === false) return;
        };

        w = xml.charCodeAt(i+1);

        if (w === 33) { // "!"
            w = xml.charCodeAt(i+2);
            if (w === 91 && xml.substr(i+3, 6) === 'CDATA[') { // 91 == "["
                j = xml.indexOf(']]>', i);
                if (j === -1) {
                    this.onError('cdata', position(i));
                    return;
                };

                //x = xml.substring(i+9, j);
                if (!stop) {
                    ok = this.onCDATA(xml.substring(i+9, j), false, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            if (w === 45 && xml.charCodeAt(i+3) === 45) { // 45 == "-"
                j = xml.indexOf('-->', i);
                if (j === -1) {
                    this.onError('expected -->', position(i));
                    return;
                };


                if (this.is_onComment && !stop) {
                    ok = this.onComment(xml.substring(i+4, j), unEntities, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            j = xml.indexOf('>', i+1);
            if (j === -1) {
                this.onError('expected ">"', position(i + 1));
                return;
            };

            if (this.is_onAttention && !stop) {
                ok = this.onAttention(xml.substring(i, j+1), unEntities, position(i));
                if (ok === false) return;
            };

            j += 1;
            continue;

        } else {
            if (w === 63) { // "?"
                j = xml.indexOf('?>', i);
                if (j === -1) { // error
                    this.onError('...?>', position(i));
                    return;
                };

                if (this.is_onQuestion) {
                    ok = this.onQuestion(xml.substring(i, j+2), position(i));
                    if (ok === false) return;
                };

                j += 2;
                continue;
            };
        };

        var inside=false;
        for (k=i,j=-1;k<len;k++) {
            var c = xml.charCodeAt(k);
            if (!inside) {

                if (c === 34) { // '"'
                    inside = c;
                }
                else if (c === 39) { // "'"
                    inside = c;
                }
                else if (c === 62) { // <
                    j = k; break;
                }
            } else {
                if (c === inside) { inside = false; }
            }
        }

        if (j == -1) { // error
            this.onError('...>', position(i + 1));
            return;
        };

        this.attr_res = true; // атрибутов нет

        //if (xml.charCodeAt(i+1) === 47) { // </...
        if (w === 47) { // </...
            tagstart = false;
            tagend = true;

            // проверяем что должен быть закрыт тотже тег что и открывался
            x = elem = nodestack.pop();
            q = i + 2 + x.length;

            //console.log()
            if (xml.substring(i+2, q) !== x) {
                this.onError('close tagname', position(i + 2));
                return;
            };

            // проверим что в закрываюшем теге нет лишнего
            for(; q < j; q++) {
                w = xml.charCodeAt(q);

                if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                    continue;
                };

                this.onError('close tag', position(i + 2));
                return;
            };

        } else {
            if (xml.charCodeAt(j-1) ===  47) { // .../>
                x = elem = xml.substring(i+1, j-1);

                tagstart = true;
                tagend = true;
            } else {
                x = elem = xml.substring(i+1, j);

                tagstart = true;
                tagend = false;
            };

            if ( !(w > 96  && w < 123 || w > 64 && w <91) ) {
                this.onError('first char nodeName', position(i + 1));
                return;
            };

            for(q = 1, y = x.length; q < y; q++) {
                w = x.charCodeAt(q);

                if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                    continue;
                };

                if (w===32 || (w<14 && w > 8)) { // \f\n\r\t\v пробел
                    elem = x.substring(0, q)
                    this.attr_res = null; // возможно есть атирибуты
                    break;
                };

                this.onError('invalid nodeName', position(i + 1));
                return;
            };

            if (!tagend) {
                nodestack.push(elem);
            };
        };


        if (this.isNamespace) {
            if (stop) {
                if (tagend) {
                    if (!tagstart) {
                        if (--stopIndex === 0) {
                            this.nsmatrix = stacknsmatrix.pop();
                        };
                    };

                } else {
                    stopIndex += 1;
                };


                j += 1;
                continue;
            };

            _nsmatrix = this.nsmatrix;

            if (!tagend) {
                stacknsmatrix.push(this.nsmatrix);

                if (this.attr_res !== true) {
                    if (this.hasSurmiseNS = x.indexOf('xmlns', q) !== -1) {
                        this.attr_string = x;
                        this.attr_posstart = q;

                        this.getAttrs();

                        this.hasSurmiseNS = false;
                    };
                };
            };


            w = elem.indexOf(':');
            if (w !== -1) {
                xmlns = this.nsmatrix[elem.substring(0, w)];
                elem = elem.substr(w+1);

            } else {
                xmlns = this.nsmatrix.xmlns;
            };

            if (!xmlns) {
                if (tagend) {
                    if (tagstart) {
                        this.nsmatrix = _nsmatrix;
                    } else {
                        this.nsmatrix = stacknsmatrix.pop();
                    };
                } else {
                    stopIndex = 1; // первый элемент для которого не определено пространство имен
                    this.attr_res = true;
                };

                j += 1;
                continue;
            };

            elem = xmlns + ':' + elem;
        };

        //string_node = xml.substring(i, j+1); // текст ноды как есть

        if (tagstart) { // is_onStartNode
            this.attr_string = x;
            this.attr_posstart = q;

            var that = this;
            ok = this.onStartNode(elem, function() { return that.getAttrs() }, unEntities, tagend
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            this.attr_res = true;
        };

        if (tagend) {
            ok = this.onEndNode(elem, unEntities, tagstart
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            if (this.isNamespace) {
                if (tagstart) {
                    this.nsmatrix = _nsmatrix;
                } else {
                    this.nsmatrix = stacknsmatrix.pop();
                };
            };
        };

        j += 1;
    };
};


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/esprima/esprima.js":
/***/ (function(module, exports) {

﻿/*
  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

(function (global) {
    'use strict';

    var Token,
        TokenName,
        Syntax,
        Messages,
        source,
        index,
        length,
        delegate,
        lookahead,
        state;

    Token = {
        BooleanLiteral: 1,
        EOF: 2,
        Identifier: 3,
        Keyword: 4,
        NullLiteral: 5,
        NumericLiteral: 6,
        Punctuator: 7,
        StringLiteral: 8
    };

    TokenName = {};
    TokenName[Token.BooleanLiteral] = 'Boolean';
    TokenName[Token.EOF] = '<end>';
    TokenName[Token.Identifier] = 'Identifier';
    TokenName[Token.Keyword] = 'Keyword';
    TokenName[Token.NullLiteral] = 'Null';
    TokenName[Token.NumericLiteral] = 'Numeric';
    TokenName[Token.Punctuator] = 'Punctuator';
    TokenName[Token.StringLiteral] = 'String';

    Syntax = {
        ArrayExpression: 'ArrayExpression',
        BinaryExpression: 'BinaryExpression',
        CallExpression: 'CallExpression',
        ConditionalExpression: 'ConditionalExpression',
        EmptyStatement: 'EmptyStatement',
        ExpressionStatement: 'ExpressionStatement',
        Identifier: 'Identifier',
        Literal: 'Literal',
        LabeledStatement: 'LabeledStatement',
        LogicalExpression: 'LogicalExpression',
        MemberExpression: 'MemberExpression',
        ObjectExpression: 'ObjectExpression',
        Program: 'Program',
        Property: 'Property',
        ThisExpression: 'ThisExpression',
        UnaryExpression: 'UnaryExpression'
    };

    // Error messages should be identical to V8.
    Messages = {
        UnexpectedToken: 'Unexpected token %0',
        UnknownLabel: 'Undefined label \'%0\'',
        Redeclaration: '%0 \'%1\' has already been declared'
    };

    // Ensure the condition is true, otherwise throw an error.
    // This is only to have a better contract semantic, i.e. another safety net
    // to catch a logic error. The condition shall be fulfilled in normal case.
    // Do NOT use this to enforce a certain condition on any user input.

    function assert(condition, message) {
        if (!condition) {
            throw new Error('ASSERT: ' + message);
        }
    }

    function isDecimalDigit(ch) {
        return (ch >= 48 && ch <= 57);   // 0..9
    }


    // 7.2 White Space

    function isWhiteSpace(ch) {
        return (ch === 32) ||  // space
            (ch === 9) ||      // tab
            (ch === 0xB) ||
            (ch === 0xC) ||
            (ch === 0xA0) ||
            (ch >= 0x1680 && '\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);
    }

    // 7.3 Line Terminators

    function isLineTerminator(ch) {
        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);
    }

    // 7.6 Identifier Names and Identifiers

    function isIdentifierStart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122);          // a..z
    }

    function isIdentifierPart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122) ||        // a..z
            (ch >= 48 && ch <= 57);           // 0..9
    }

    // 7.6.1.1 Keywords

    function isKeyword(id) {
        return (id === 'this')
    }

    // 7.4 Comments

    function skipWhitespace() {
        while (index < length && isWhiteSpace(source.charCodeAt(index))) {
            ++index;
        }
    }

    function getIdentifier() {
        var start, ch;

        start = index++;
        while (index < length) {
            ch = source.charCodeAt(index);
            if (isIdentifierPart(ch)) {
                ++index;
            } else {
                break;
            }
        }

        return source.slice(start, index);
    }

    function scanIdentifier() {
        var start, id, type;

        start = index;

        id = getIdentifier();

        // There is no keyword or literal with only one character.
        // Thus, it must be an identifier.
        if (id.length === 1) {
            type = Token.Identifier;
        } else if (isKeyword(id)) {
            type = Token.Keyword;
        } else if (id === 'null') {
            type = Token.NullLiteral;
        } else if (id === 'true' || id === 'false') {
            type = Token.BooleanLiteral;
        } else {
            type = Token.Identifier;
        }

        return {
            type: type,
            value: id,
            range: [start, index]
        };
    }


    // 7.7 Punctuators

    function scanPunctuator() {
        var start = index,
            code = source.charCodeAt(index),
            code2,
            ch1 = source[index],
            ch2;

        switch (code) {

            // Check for most common single-character punctuators.
            case 46:   // . dot
            case 40:   // ( open bracket
            case 41:   // ) close bracket
            case 59:   // ; semicolon
            case 44:   // , comma
            case 123:  // { open curly brace
            case 125:  // } close curly brace
            case 91:   // [
            case 93:   // ]
            case 58:   // :
            case 63:   // ?
                ++index;
                return {
                    type: Token.Punctuator,
                    value: String.fromCharCode(code),
                    range: [start, index]
                };

            default:
                code2 = source.charCodeAt(index + 1);

                // '=' (char #61) marks an assignment or comparison operator.
                if (code2 === 61) {
                    switch (code) {
                        case 37:  // %
                        case 38:  // &
                        case 42:  // *:
                        case 43:  // +
                        case 45:  // -
                        case 47:  // /
                        case 60:  // <
                        case 62:  // >
                        case 124: // |
                            index += 2;
                            return {
                                type: Token.Punctuator,
                                value: String.fromCharCode(code) + String.fromCharCode(code2),
                                range: [start, index]
                            };

                        case 33: // !
                        case 61: // =
                            index += 2;

                            // !== and ===
                            if (source.charCodeAt(index) === 61) {
                                ++index;
                            }
                            return {
                                type: Token.Punctuator,
                                value: source.slice(start, index),
                                range: [start, index]
                            };
                        default:
                            break;
                    }
                }
                break;
        }

        // Peek more characters.

        ch2 = source[index + 1];

        // Other 2-character punctuators: && ||

        if (ch1 === ch2 && ('&|'.indexOf(ch1) >= 0)) {
            index += 2;
            return {
                type: Token.Punctuator,
                value: ch1 + ch2,
                range: [start, index]
            };
        }

        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {
            ++index;
            return {
                type: Token.Punctuator,
                value: ch1,
                range: [start, index]
            };
        }

        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
    }

    // 7.8.3 Numeric Literals
    function scanNumericLiteral() {
        var number, start, ch;

        ch = source[index];
        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),
            'Numeric literal must start with a decimal digit or a decimal point');

        start = index;
        number = '';
        if (ch !== '.') {
            number = source[index++];
            ch = source[index];

            // Hex number starts with '0x'.
            // Octal number starts with '0'.
            if (number === '0') {
                // decimal number starts with '0' such as '09' is illegal.
                if (ch && isDecimalDigit(ch.charCodeAt(0))) {
                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
                }
            }

            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === '.') {
            number += source[index++];
            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === 'e' || ch === 'E') {
            number += source[index++];

            ch = source[index];
            if (ch === '+' || ch === '-') {
                number += source[index++];
            }
            if (isDecimalDigit(source.charCodeAt(index))) {
                while (isDecimalDigit(source.charCodeAt(index))) {
                    number += source[index++];
                }
            } else {
                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
            }
        }

        if (isIdentifierStart(source.charCodeAt(index))) {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.NumericLiteral,
            value: parseFloat(number),
            range: [start, index]
        };
    }

    // 7.8.4 String Literals

    function scanStringLiteral() {
        var str = '', quote, start, ch, octal = false;

        quote = source[index];
        assert((quote === '\'' || quote === '"'),
            'String literal must starts with a quote');

        start = index;
        ++index;

        while (index < length) {
            ch = source[index++];

            if (ch === quote) {
                quote = '';
                break;
            } else if (ch === '\\') {
                ch = source[index++];
                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {
                    switch (ch) {
                        case 'n':
                            str += '\n';
                            break;
                        case 'r':
                            str += '\r';
                            break;
                        case 't':
                            str += '\t';
                            break;
                        case 'b':
                            str += '\b';
                            break;
                        case 'f':
                            str += '\f';
                            break;
                        case 'v':
                            str += '\x0B';
                            break;

                        default:
                            str += ch;
                            break;
                    }
                } else {
                    if (ch === '\r' && source[index] === '\n') {
                        ++index;
                    }
                }
            } else if (isLineTerminator(ch.charCodeAt(0))) {
                break;
            } else {
                str += ch;
            }
        }

        if (quote !== '') {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.StringLiteral,
            value: str,
            octal: octal,
            range: [start, index]
        };
    }

    function isIdentifierName(token) {
        return token.type === Token.Identifier ||
            token.type === Token.Keyword ||
            token.type === Token.BooleanLiteral ||
            token.type === Token.NullLiteral;
    }

    function advance() {
        var ch;

        skipWhitespace();

        if (index >= length) {
            return {
                type: Token.EOF,
                range: [index, index]
            };
        }

        ch = source.charCodeAt(index);

        // Very common: ( and ) and ;
        if (ch === 40 || ch === 41 || ch === 58) {
            return scanPunctuator();
        }

        // String literal starts with single quote (#39) or double quote (#34).
        if (ch === 39 || ch === 34) {
            return scanStringLiteral();
        }

        if (isIdentifierStart(ch)) {
            return scanIdentifier();
        }

        // Dot (.) char #46 can also start a floating-point number, hence the need
        // to check the next character.
        if (ch === 46) {
            if (isDecimalDigit(source.charCodeAt(index + 1))) {
                return scanNumericLiteral();
            }
            return scanPunctuator();
        }

        if (isDecimalDigit(ch)) {
            return scanNumericLiteral();
        }

        return scanPunctuator();
    }

    function lex() {
        var token;

        token = lookahead;
        index = token.range[1];

        lookahead = advance();

        index = token.range[1];

        return token;
    }

    function peek() {
        var pos;

        pos = index;
        lookahead = advance();
        index = pos;
    }

    // Throw an exception

    function throwError(token, messageFormat) {
        var error,
            args = Array.prototype.slice.call(arguments, 2),
            msg = messageFormat.replace(
                /%(\d)/g,
                function (whole, index) {
                    assert(index < args.length, 'Message reference must be in range');
                    return args[index];
                }
            );

        error = new Error(msg);
        error.index = index;
        error.description = msg;
        throw error;
    }

    // Throw an exception because of the token.

    function throwUnexpected(token) {
        throwError(token, Messages.UnexpectedToken, token.value);
    }

    // Expect the next token to match the specified punctuator.
    // If not, an exception will be thrown.

    function expect(value) {
        var token = lex();
        if (token.type !== Token.Punctuator || token.value !== value) {
            throwUnexpected(token);
        }
    }

    // Return true if the next token matches the specified punctuator.

    function match(value) {
        return lookahead.type === Token.Punctuator && lookahead.value === value;
    }

    // Return true if the next token matches the specified keyword

    function matchKeyword(keyword) {
        return lookahead.type === Token.Keyword && lookahead.value === keyword;
    }

    function consumeSemicolon() {
        // Catch the very common case first: immediately a semicolon (char #59).
        if (source.charCodeAt(index) === 59) {
            lex();
            return;
        }

        skipWhitespace();

        if (match(';')) {
            lex();
            return;
        }

        if (lookahead.type !== Token.EOF && !match('}')) {
            throwUnexpected(lookahead);
        }
    }

    // 11.1.4 Array Initialiser

    function parseArrayInitialiser() {
        var elements = [];

        expect('[');

        while (!match(']')) {
            if (match(',')) {
                lex();
                elements.push(null);
            } else {
                elements.push(parseExpression());

                if (!match(']')) {
                    expect(',');
                }
            }
        }

        expect(']');

        return delegate.createArrayExpression(elements);
    }

    // 11.1.5 Object Initialiser

    function parseObjectPropertyKey() {
        var token;

        skipWhitespace();
        token = lex();

        // Note: This function is called only from parseObjectProperty(), where
        // EOF and Punctuator tokens are already filtered out.
        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {
            return delegate.createLiteral(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseObjectProperty() {
        var token, key;

        token = lookahead;
        skipWhitespace();

        if (token.type === Token.EOF || token.type === Token.Punctuator) {
            throwUnexpected(token);
        }

        key = parseObjectPropertyKey();
        expect(':');
        return delegate.createProperty('init', key, parseExpression());
    }

    function parseObjectInitialiser() {
        var properties = [];

        expect('{');

        while (!match('}')) {
            properties.push(parseObjectProperty());

            if (!match('}')) {
                expect(',');
            }
        }

        expect('}');

        return delegate.createObjectExpression(properties);
    }

    // 11.1.6 The Grouping Operator

    function parseGroupExpression() {
        var expr;

        expect('(');

        expr = parseExpression();

        expect(')');

        return expr;
    }


    // 11.1 Primary Expressions

    function parsePrimaryExpression() {
        var type, token, expr;

        if (match('(')) {
            return parseGroupExpression();
        }

        type = lookahead.type;

        if (type === Token.Identifier) {
            expr = delegate.createIdentifier(lex().value);
        } else if (type === Token.StringLiteral || type === Token.NumericLiteral) {
            expr = delegate.createLiteral(lex());
        } else if (type === Token.Keyword) {
            if (matchKeyword('this')) {
                lex();
                expr = delegate.createThisExpression();
            }
        } else if (type === Token.BooleanLiteral) {
            token = lex();
            token.value = (token.value === 'true');
            expr = delegate.createLiteral(token);
        } else if (type === Token.NullLiteral) {
            token = lex();
            token.value = null;
            expr = delegate.createLiteral(token);
        } else if (match('[')) {
            expr = parseArrayInitialiser();
        } else if (match('{')) {
            expr = parseObjectInitialiser();
        }

        if (expr) {
            return expr;
        }

        throwUnexpected(lex());
    }

    // 11.2 Left-Hand-Side Expressions

    function parseArguments() {
        var args = [];

        expect('(');

        if (!match(')')) {
            while (index < length) {
                args.push(parseExpression());
                if (match(')')) {
                    break;
                }
                expect(',');
            }
        }

        expect(')');

        return args;
    }

    function parseNonComputedProperty() {
        var token;

        token = lex();

        if (!isIdentifierName(token)) {
            throwUnexpected(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseNonComputedMember() {
        expect('.');

        return parseNonComputedProperty();
    }

    function parseComputedMember() {
        var expr;

        expect('[');

        expr = parseExpression();

        expect(']');

        return expr;
    }

    function parseLeftHandSideExpression() {
        var expr, args, property;

        expr = parsePrimaryExpression();

        while (true) {
            if (match('[')) {
                property = parseComputedMember();
                expr = delegate.createMemberExpression('[', expr, property);
            } else if (match('.')) {
                property = parseNonComputedMember();
                expr = delegate.createMemberExpression('.', expr, property);
            } else if (match('(')) {
                args = parseArguments();
                expr = delegate.createCallExpression(expr, args);
            } else {
                break;
            }
        }

        return expr;
    }

    // 11.3 Postfix Expressions

    var parsePostfixExpression = parseLeftHandSideExpression;

    // 11.4 Unary Operators

    function parseUnaryExpression() {
        var token, expr;

        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {
            expr = parsePostfixExpression();
        } else if (match('+') || match('-') || match('!')) {
            token = lex();
            expr = parseUnaryExpression();
            expr = delegate.createUnaryExpression(token.value, expr);
        } else if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {
            throwError({}, Messages.UnexpectedToken);
        } else {
            expr = parsePostfixExpression();
        }

        return expr;
    }

    function binaryPrecedence(token) {
        var prec = 0;

        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {
            return 0;
        }

        switch (token.value) {
            case '||':
                prec = 1;
                break;

            case '&&':
                prec = 2;
                break;

            case '==':
            case '!=':
            case '===':
            case '!==':
                prec = 6;
                break;

            case '<':
            case '>':
            case '<=':
            case '>=':
            case 'instanceof':
                prec = 7;
                break;

            case 'in':
                prec = 7;
                break;

            case '+':
            case '-':
                prec = 9;
                break;

            case '*':
            case '/':
            case '%':
                prec = 11;
                break;

            default:
                break;
        }

        return prec;
    }

    // 11.5 Multiplicative Operators
    // 11.6 Additive Operators
    // 11.7 Bitwise Shift Operators
    // 11.8 Relational Operators
    // 11.9 Equality Operators
    // 11.10 Binary Bitwise Operators
    // 11.11 Binary Logical Operators

    function parseBinaryExpression() {
        var expr, token, prec, stack, right, operator, left, i;

        left = parseUnaryExpression();

        token = lookahead;
        prec = binaryPrecedence(token);
        if (prec === 0) {
            return left;
        }
        token.prec = prec;
        lex();

        right = parseUnaryExpression();

        stack = [left, token, right];

        while ((prec = binaryPrecedence(lookahead)) > 0) {

            // Reduce: make a binary expression from the three topmost entries.
            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {
                right = stack.pop();
                operator = stack.pop().value;
                left = stack.pop();
                expr = delegate.createBinaryExpression(operator, left, right);
                stack.push(expr);
            }

            // Shift.
            token = lex();
            token.prec = prec;
            stack.push(token);
            expr = parseUnaryExpression();
            stack.push(expr);
        }

        // Final reduce to clean-up the stack.
        i = stack.length - 1;
        expr = stack[i];
        while (i > 1) {
            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);
            i -= 2;
        }

        return expr;
    }


    // 11.12 Conditional Operator

    function parseConditionalExpression() {
        var expr, consequent, alternate;

        expr = parseBinaryExpression();

        if (match('?')) {
            lex();
            consequent = parseConditionalExpression();
            expect(':');
            alternate = parseConditionalExpression();

            expr = delegate.createConditionalExpression(expr, consequent, alternate);
        }

        return expr;
    }

    // Simplification since we do not support AssignmentExpression.
    var parseExpression = parseConditionalExpression;

    // Polymer Syntax extensions

    // Filter ::
    //   Identifier
    //   Identifier "(" ")"
    //   Identifier "(" FilterArguments ")"

    function parseFilter() {
        var identifier, args;

        identifier = lex();

        if (identifier.type !== Token.Identifier) {
            throwUnexpected(identifier);
        }

        args = match('(') ? parseArguments() : [];

        return delegate.createFilter(identifier.value, args);
    }

    // Filters ::
    //   "|" Filter
    //   Filters "|" Filter

    function parseFilters() {
        while (match('|')) {
            lex();
            parseFilter();
        }
    }

    // TopLevel ::
    //   LabelledExpressions
    //   AsExpression
    //   InExpression
    //   FilterExpression

    // AsExpression ::
    //   FilterExpression as Identifier

    // InExpression ::
    //   Identifier, Identifier in FilterExpression
    //   Identifier in FilterExpression

    // FilterExpression ::
    //   Expression
    //   Expression Filters

    function parseTopLevel() {
        skipWhitespace();
        peek();

        var expr = parseExpression();
        if (expr) {
            if (lookahead.value === ',' || lookahead.value == 'in' &&
                       expr.type === Syntax.Identifier) {
                parseInExpression(expr);
            } else {
                parseFilters();
                if (lookahead.value === 'as') {
                    parseAsExpression(expr);
                } else {
                    delegate.createTopLevel(expr);
                }
            }
        }

        if (lookahead.type !== Token.EOF) {
            throwUnexpected(lookahead);
        }
    }

    function parseAsExpression(expr) {
        lex();  // as
        var identifier = lex().value;
        delegate.createAsExpression(expr, identifier);
    }

    function parseInExpression(identifier) {
        var indexName;
        if (lookahead.value === ',') {
            lex();
            if (lookahead.type !== Token.Identifier)
                throwUnexpected(lookahead);
            indexName = lex().value;
        }

        lex();  // in
        var expr = parseExpression();
        parseFilters();
        delegate.createInExpression(identifier.name, indexName, expr);
    }

    function parse(code, inDelegate) {
        delegate = inDelegate;
        source = code;
        index = 0;
        length = source.length;
        lookahead = null;
        state = {
            labelSet: {}
        };

        return parseTopLevel();
    }

    global.esprima = {
        parse: parse
    };
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
﻿/*
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */



function detectEval() {
    // Don't test for eval if we're running in a Chrome App environment.
    // We check for APIs set that only exist in a Chrome App context.
    if (typeof chrome !== 'undefined' && chrome.app && chrome.app.runtime) {
        return false;
    }

    // Firefox OS Apps do not allow eval. This feature detection is very hacky
    // but even if some other platform adds support for this function this code
    // will continue to work.
    if (typeof navigator != 'undefined' && navigator.getDeviceStorage) {
        return false;
    }

    try {
        var f = new Function('', 'return true;');
        return f();
    } catch (ex) {
        return false;
    }
}

var hasEval = detectEval();

function isIndex(s) {
    return +s === s >>> 0 && s !== '';
}

function toNumber(s) {
    return +s;
}

function isObject(obj) {
    return obj === Object(obj);
}

var numberIsNaN = Number.isNaN || function (value) {
    return typeof value === 'number' && isNaN(value);
}

function areSameValue(left, right) {
    if (left === right)
        return left !== 0 || 1 / left === 1 / right;
    if (numberIsNaN(left) && numberIsNaN(right))
        return true;

    return left !== left && right !== right;
}

var createObject = ('__proto__' in {}) ?
  function (obj) { return obj; } :
  function (obj) {
      var proto = obj.__proto__;
      if (!proto)
          return obj;
      var newObject = Object.create(proto);
      Object.getOwnPropertyNames(obj).forEach(function (name) {
          Object.defineProperty(newObject, name,
                               Object.getOwnPropertyDescriptor(obj, name));
      });
      return newObject;
  };

var identStart = '[\$_a-zA-Z]';
var identPart = '[\$_a-zA-Z0-9]';
var identRegExp = new RegExp('^' + identStart + '+' + identPart + '*' + '$');

function getPathCharType(char) {
    if (char === undefined)
        return 'eof';

    var code = char.charCodeAt(0);

    switch (code) {
        case 0x5B: // [
        case 0x5D: // ]
        case 0x2E: // .
        case 0x22: // "
        case 0x27: // '
        case 0x30: // 0
            return char;

        case 0x5F: // _
        case 0x24: // $
            return 'ident';

        case 0x20: // Space
        case 0x09: // Tab
        case 0x0A: // Newline
        case 0x0D: // Return
        case 0xA0:  // No-break space
        case 0xFEFF:  // Byte Order Mark
        case 0x2028:  // Line Separator
        case 0x2029:  // Paragraph Separator
            return 'ws';
    }

    // a-z, A-Z
    if ((0x61 <= code && code <= 0x7A) || (0x41 <= code && code <= 0x5A))
        return 'ident';

    // 1-9
    if (0x31 <= code && code <= 0x39)
        return 'number';

    return 'else';
}

var pathStateMachine = {
    'beforePath': {
        'ws': ['beforePath'],
        'ident': ['inIdent', 'append'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'inPath': {
        'ws': ['inPath'],
        '.': ['beforeIdent'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'beforeIdent': {
        'ws': ['beforeIdent'],
        'ident': ['inIdent', 'append']
    },

    'inIdent': {
        'ident': ['inIdent', 'append'],
        '0': ['inIdent', 'append'],
        'number': ['inIdent', 'append'],
        'ws': ['inPath', 'push'],
        '.': ['beforeIdent', 'push'],
        '[': ['beforeElement', 'push'],
        'eof': ['afterPath', 'push']
    },

    'beforeElement': {
        'ws': ['beforeElement'],
        '0': ['afterZero', 'append'],
        'number': ['inIndex', 'append'],
        "'": ['inSingleQuote', 'append', ''],
        '"': ['inDoubleQuote', 'append', '']
    },

    'afterZero': {
        'ws': ['afterElement', 'push'],
        ']': ['inPath', 'push']
    },

    'inIndex': {
        '0': ['inIndex', 'append'],
        'number': ['inIndex', 'append'],
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    },

    'inSingleQuote': {
        "'": ['afterElement'],
        'eof': ['error'],
        'else': ['inSingleQuote', 'append']
    },

    'inDoubleQuote': {
        '"': ['afterElement'],
        'eof': ['error'],
        'else': ['inDoubleQuote', 'append']
    },

    'afterElement': {
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    }
}

function noop() { }

function parsePath(path) {
    var keys = [];
    var index = -1;
    var c, newChar, key, type, transition, action, typeMap, mode = 'beforePath';

    var actions = {
        push: function () {
            if (key === undefined)
                return;

            keys.push(key);
            key = undefined;
        },

        append: function () {
            if (key === undefined)
                key = newChar
            else
                key += newChar;
        }
    };

    function maybeUnescapeQuote() {
        if (index >= path.length)
            return;

        var nextChar = path[index + 1];
        if ((mode == 'inSingleQuote' && nextChar == "'") ||
            (mode == 'inDoubleQuote' && nextChar == '"')) {
            index++;
            newChar = nextChar;
            actions.append();
            return true;
        }
    }

    while (mode) {
        index++;
        c = path[index];

        if (c == '\\' && maybeUnescapeQuote(mode))
            continue;

        type = getPathCharType(c);
        typeMap = pathStateMachine[mode];
        transition = typeMap[type] || typeMap['else'] || 'error';

        if (transition == 'error')
            return; // parse error;

        mode = transition[0];
        action = actions[transition[1]] || noop;
        newChar = transition[2] === undefined ? c : transition[2];
        action();

        if (mode === 'afterPath') {
            return keys;
        }
    }

    return; // parse error
}

function isIdent(s) {
    return identRegExp.test(s);
}

var constructorIsPrivate = {};

function Path(parts, privateToken) {
    if (privateToken !== constructorIsPrivate)
        throw Error('Use Path.get to retrieve path objects');

    for (var i = 0; i < parts.length; i++) {
        this.push(String(parts[i]));
    }

    if (hasEval && this.length) {
        this.getValueFrom = this.compiledGetValueFromFn();
    }
}

// TODO(rafaelw): Make simple LRU cache
var pathCache = {};

function getPath(pathString) {
    if (pathString instanceof Path)
        return pathString;

    if (pathString == null || pathString.length == 0)
        pathString = '';

    if (typeof pathString != 'string') {
        if (isIndex(pathString.length)) {
            // Constructed with array-like (pre-parsed) keys
            return new Path(pathString, constructorIsPrivate);
        }

        pathString = String(pathString);
    }

    var path = pathCache[pathString];
    if (path)
        return path;

    var parts = parsePath(pathString);
    if (!parts)
        return invalidPath;

    var path = new Path(parts, constructorIsPrivate);
    pathCache[pathString] = path;
    return path;
}

Path.get = getPath;

function formatAccessor(key) {
    if (isIndex(key)) {
        return '[' + key + ']';
    } else {
        return '["' + key.replace(/"/g, '\\"') + '"]';
    }
}

Path.prototype = createObject({
    __proto__: [],
    valid: true,

    toString: function () {
        var pathString = '';
        for (var i = 0; i < this.length; i++) {
            var key = this[i];
            if (isIdent(key)) {
                pathString += i ? '.' + key : key;
            } else {
                pathString += formatAccessor(key);
            }
        }

        return pathString;
    },

    getValueFrom: function (obj, directObserver) {
        for (var i = 0; i < this.length; i++) {
            if (obj == null)
                return;
            obj = obj[this[i]];
        }
        return obj;
    },

    iterateObjects: function (obj, observe) {
        for (var i = 0; i < this.length; i++) {
            if (i)
                obj = obj[this[i - 1]];
            if (!isObject(obj))
                return;
            observe(obj, this[i]);
        }
    },

    compiledGetValueFromFn: function () {
        var str = '';
        var pathString = 'obj';
        str += 'if (obj != null';
        var i = 0;
        var key;
        for (; i < (this.length - 1) ; i++) {
            key = this[i];
            pathString += isIdent(key) ? '.' + key : formatAccessor(key);
            str += ' &&\n     ' + pathString + ' != null';
        }
        str += ')\n';

        var key = this[i];
        pathString += isIdent(key) ? '.' + key : formatAccessor(key);

        str += '  return ' + pathString + ';\nelse\n  return undefined;';
        return new Function('obj', str);
    },

    setValueFrom: function (obj, value) {
        if (!this.length)
            return false;

        for (var i = 0; i < this.length - 1; i++) {
            if (!isObject(obj))
                return false;
            obj = obj[this[i]];
        }

        if (!isObject(obj))
            return false;

        obj[this[i]] = value;
        return true;
    }
});

var invalidPath = new Path('', constructorIsPrivate);
invalidPath.valid = false;
invalidPath.getValueFrom = invalidPath.setValueFrom = function () { };

exports.Path = Path;


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js":
/***/ (function(module, exports, __webpack_require__) {

﻿// Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
// This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
// The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
// The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
// Code distributed by Google as part of the polymer project is also
// subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt

var esprima = __webpack_require__("../node_modules/tns-core-modules/js-libs/esprima/esprima.js").esprima;
var Path = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js").Path;

(function (global) {
    'use strict';

    // TODO(rafaelw): Implement simple LRU.
    var expressionParseCache = Object.create(null);

    function getExpression(expressionText) {
        var expression = expressionParseCache[expressionText];
        if (!expression) {
            var delegate = new ASTDelegate();
            esprima.parse(expressionText, delegate);
            expression = new Expression(delegate);
            expressionParseCache[expressionText] = expression;
        }
        return expression;
    }

    function Literal(value) {
        this.value = value;
        this.valueFn_ = undefined;
    }

    Literal.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var value = this.value;
                this.valueFn_ = function () {
                    return value;
                }
            }

            return this.valueFn_;
        }
    }

    function IdentPath(name) {
        this.name = name;
        this.path = Path.get(name);
    }

    IdentPath.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var name = this.name;
                var path = this.path;
                this.valueFn_ = function (model, observer, changedModel) {
                    if (observer)
                        observer.addPath(model, path);

                    if (changedModel) {
                        var result = path.getValueFrom(changedModel);
                        if (result !== undefined) {
                            return result;
                        }
                    }

                    return path.getValueFrom(model);
                }
            }

            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.path.length == 1) {
                model = findScope(model, this.path[0]);
            }

            return this.path.setValueFrom(model, newValue);
        }
    };

    function MemberExpression(object, property, accessor) {
        this.computed = accessor == '[';

        this.dynamicDeps = typeof object == 'function' ||
                           object.dynamicDeps ||
                           (this.computed && !(property instanceof Literal));

        this.simplePath =
            !this.dynamicDeps &&
            (property instanceof IdentPath || property instanceof Literal) &&
            (object instanceof MemberExpression || object instanceof IdentPath);

        this.object = this.simplePath ? object : getFn(object);
        this.property = !this.computed || this.simplePath ?
            property : getFn(property);
    }

    MemberExpression.prototype = {
        get fullPath() {
            if (!this.fullPath_) {

                var parts = this.object instanceof MemberExpression ?
                    this.object.fullPath.slice() : [this.object.name];
                parts.push(this.property instanceof IdentPath ?
                    this.property.name : this.property.value);
                this.fullPath_ = Path.get(parts);
            }

            return this.fullPath_;
        },

        valueFn: function () {
            if (!this.valueFn_) {
                var object = this.object;

                if (this.simplePath) {
                    var path = this.fullPath;

                    this.valueFn_ = function (model, observer) {
                        if (observer)
                            observer.addPath(model, path);

                        return path.getValueFrom(model);
                    };
                } else if (!this.computed) {
                    var path = Path.get(this.property.name);

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);

                        if (observer)
                            observer.addPath(context, path);

                        return path.getValueFrom(context);
                    }
                } else {
                    // Computed property.
                    var property = this.property;

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);
                        var propName = property(model, observer, filterRegistry);
                        if (observer)
                            observer.addPath(context, [propName]);

                        return context ? context[propName] : undefined;
                    };
                }
            }
            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.simplePath) {
                this.fullPath.setValueFrom(model, newValue);
                return newValue;
            }

            var object = this.object(model);
            var propName = this.property instanceof IdentPath ? this.property.name :
                this.property(model);
            return object[propName] = newValue;
        }
    };

    function Filter(name, args) {
        this.name = name;
        this.args = [];
        for (var i = 0; i < args.length; i++) {
            this.args[i] = getFn(args[i]);
        }
    }

    Filter.prototype = {
        transform: function (model, observer, filterRegistry, toModelDirection,
                            initialArgs) {
            var fn = filterRegistry[this.name];
            var context = model;
            if (fn) {
                context = undefined;
            } else {
                fn = context[this.name];
                if (!fn) {
                    console.error('Cannot find function or filter: ' + this.name);
                    return;
                }
            }

            // If toModelDirection is falsey, then the "normal" (dom-bound) direction
            // is used. Otherwise, it looks for a 'toModel' property function on the
            // object.
            if (toModelDirection) {
                fn = fn.toModel;
            } else if (typeof fn.toView == 'function') {
                fn = fn.toView;
            }

            if (typeof fn != 'function') {
                console.error('Cannot find function or filter: ' + this.name);
                return;
            }

            var args = initialArgs || [];
            for (var i = 0; i < this.args.length; i++) {
                args.push(getFn(this.args[i])(model, observer, filterRegistry));
            }

            return fn.apply(context, args);
        }
    };

    function notImplemented() { throw Error('Not Implemented'); }

    var unaryOperators = {
        '+': function (v) { return +v; },
        '-': function (v) { return -v; },
        '!': function (v) { return !v; }
    };

    var binaryOperators = {
        '+': function (l, r) { return l + r; },
        '-': function (l, r) { return l - r; },
        '*': function (l, r) { return l * r; },
        '/': function (l, r) { return l / r; },
        '%': function (l, r) { return l % r; },
        '<': function (l, r) { return l < r; },
        '>': function (l, r) { return l > r; },
        '<=': function (l, r) { return l <= r; },
        '>=': function (l, r) { return l >= r; },
        '==': function (l, r) { return l == r; },
        '!=': function (l, r) { return l != r; },
        '===': function (l, r) { return l === r; },
        '!==': function (l, r) { return l !== r; },
        '&&': function (l, r) { return l && r; },
        '||': function (l, r) { return l || r; },
    };

    function getFn(arg) {
        return typeof arg == 'function' ? arg : arg.valueFn();
    }

    function ASTDelegate() {
        this.expression = null;
        this.filters = [];
        this.deps = {};
        this.currentPath = undefined;
        this.scopeIdent = undefined;
        this.indexIdent = undefined;
        this.dynamicDeps = false;
    }

    ASTDelegate.prototype = {
        createUnaryExpression: function (op, argument) {
            if (!unaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            argument = getFn(argument);

            return function (model, observer, filterRegistry) {
                return unaryOperators[op](argument(model, observer, filterRegistry));
            };
        },

        createBinaryExpression: function (op, left, right) {
            if (!binaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            left = getFn(left);
            right = getFn(right);

            switch (op) {
                case '||':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) ||
                            right(model, observer, filterRegistry);
                    };
                case '&&':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) &&
                            right(model, observer, filterRegistry);
                    };
            }

            return function (model, observer, filterRegistry) {
                return binaryOperators[op](left(model, observer, filterRegistry),
                                           right(model, observer, filterRegistry));
            };
        },

        createConditionalExpression: function (test, consequent, alternate) {
            test = getFn(test);
            consequent = getFn(consequent);
            alternate = getFn(alternate);

            this.dynamicDeps = true;

            return function (model, observer, filterRegistry) {
                return test(model, observer, filterRegistry) ?
                    consequent(model, observer, filterRegistry) :
                    alternate(model, observer, filterRegistry);
            }
        },

        createIdentifier: function (name) {
            var ident = new IdentPath(name);
            ident.type = 'Identifier';
            return ident;
        },

        createMemberExpression: function (accessor, object, property) {
            var ex = new MemberExpression(object, property, accessor);
            if (ex.dynamicDeps)
                this.dynamicDeps = true;
            return ex;
        },

        createCallExpression: function (expression, args) {
            if (!(expression instanceof IdentPath))
                throw Error('Only identifier function invocations are allowed');

            var filter = new Filter(expression.name, args);

            return function (model, observer, filterRegistry) {
                return filter.transform(model, observer, filterRegistry, false);
            };
        },

        createLiteral: function (token) {
            return new Literal(token.value);
        },

        createArrayExpression: function (elements) {
            for (var i = 0; i < elements.length; i++)
                elements[i] = getFn(elements[i]);

            return function (model, observer, filterRegistry) {
                var arr = []
                for (var i = 0; i < elements.length; i++)
                    arr.push(elements[i](model, observer, filterRegistry));
                return arr;
            }
        },

        createProperty: function (kind, key, value) {
            return {
                key: key instanceof IdentPath ? key.name : key.value,
                value: value
            };
        },

        createObjectExpression: function (properties) {
            for (var i = 0; i < properties.length; i++)
                properties[i].value = getFn(properties[i].value);

            return function (model, observer, filterRegistry) {
                var obj = {};
                for (var i = 0; i < properties.length; i++)
                    obj[properties[i].key] =
                        properties[i].value(model, observer, filterRegistry);
                return obj;
            }
        },

        createFilter: function (name, args) {
            this.filters.push(new Filter(name, args));
        },

        createAsExpression: function (expression, scopeIdent) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
        },

        createInExpression: function (scopeIdent, indexIdent, expression) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
            this.indexIdent = indexIdent;
        },

        createTopLevel: function (expression) {
            this.expression = expression;
        },

        createThisExpression: notImplemented
    }

    function Expression(delegate) {
        this.scopeIdent = delegate.scopeIdent;
        this.indexIdent = delegate.indexIdent;

        if (!delegate.expression)
            throw Error('No expression found.');

        this.expression = delegate.expression;
        getFn(this.expression); // forces enumeration of path dependencies

        this.filters = delegate.filters;
        this.dynamicDeps = delegate.dynamicDeps;
    }

    Expression.prototype = {
        getValue: function (model, isBackConvert, changedModel, observer) {
            var value = getFn(this.expression)(model.context, observer, changedModel);
            for (var i = 0; i < this.filters.length; i++) {
                value = this.filters[i].transform(model.context, observer, model.context, isBackConvert, [value]);
            }

            return value;
        },

        setValue: function (model, newValue, filterRegistry) {
            var count = this.filters ? this.filters.length : 0;
            while (count-- > 0) {
                newValue = this.filters[count].transform(model, undefined,
                    filterRegistry, true, [newValue]);
            }

            if (this.expression.setValue)
                return this.expression.setValue(model, newValue);
        }
    }

    /**
     * Converts a style property name to a css property name. For example:
     * "WebkitUserSelect" to "-webkit-user-select"
     */
    function convertStylePropertyName(name) {
        return String(name).replace(/[A-Z]/g, function (c) {
            return '-' + c.toLowerCase();
        });
    }

    var parentScopeName = '@' + Math.random().toString(36).slice(2);

    // Single ident paths must bind directly to the appropriate scope object.
    // I.e. Pushed values in two-bindings need to be assigned to the actual model
    // object.
    function findScope(model, prop) {
        while (model[parentScopeName] &&
               !Object.prototype.hasOwnProperty.call(model, prop)) {
            model = model[parentScopeName];
        }

        return model;
    }

    function isLiteralExpression(pathString) {
        switch (pathString) {
            case '':
                return false;

            case 'false':
            case 'null':
            case 'true':
                return true;
        }

        if (!isNaN(Number(pathString)))
            return true;

        return false;
    };

    function PolymerExpressions() { }

    PolymerExpressions.prototype = {
        // "built-in" filters
        styleObject: function (value) {
            var parts = [];
            for (var key in value) {
                parts.push(convertStylePropertyName(key) + ': ' + value[key]);
            }
            return parts.join('; ');
        },

        tokenList: function (value) {
            var tokens = [];
            for (var key in value) {
                if (value[key])
                    tokens.push(key);
            }
            return tokens.join(' ');
        },

        // binding delegate API
        prepareInstancePositionChanged: function (template) {
            var indexIdent = template.polymerExpressionIndexIdent_;
            if (!indexIdent)
                return;

            return function (templateInstance, index) {
                templateInstance.model[indexIdent] = index;
            };
        },

        prepareInstanceModel: function (template) {
            var scopeName = template.polymerExpressionScopeIdent_;
            if (!scopeName)
                return;

            var parentScope = template.templateInstance ?
                template.templateInstance.model :
                template.model;

            var indexName = template.polymerExpressionIndexIdent_;

            return function (model) {
                return createScopeObject(parentScope, model, scopeName, indexName);
            };
        }
    };

    var createScopeObject = ('__proto__' in {}) ?
      function (parentScope, model, scopeName, indexName) {
          var scope = {};
          scope[scopeName] = model;
          scope[indexName] = undefined;
          scope[parentScopeName] = parentScope;
          scope.__proto__ = parentScope;
          return scope;
      } :
      function (parentScope, model, scopeName, indexName) {
          var scope = Object.create(parentScope);
          Object.defineProperty(scope, scopeName,
              { value: model, configurable: true, writable: true });
          Object.defineProperty(scope, indexName,
              { value: undefined, configurable: true, writable: true });
          Object.defineProperty(scope, parentScopeName,
              { value: parentScope, configurable: true, writable: true });
          return scope;
      };

    global.PolymerExpressions = PolymerExpressions;
    PolymerExpressions.getExpression = getExpression;
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/matrix/matrix.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
exports.getTransformMatrix = function (_a) {
    var property = _a.property, value = _a.value;
    return TRANSFORM_MATRIXES[property](value);
};
var TRANSFORM_MATRIXES = {
    "scale": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            x, 0, 0,
            0, y, 0,
            0, 0, 1,
        ];
    },
    "translate": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            1, 0, x,
            0, 1, y,
            0, 0, 1,
        ];
    },
    "rotate": function (angleInDeg) {
        var angleInRad = number_utils_1.degreesToRadians(angleInDeg);
        return [
            Math.cos(angleInRad), -Math.sin(angleInRad), 0,
            Math.sin(angleInRad), Math.cos(angleInRad), 0,
            0, 0, 1,
        ];
    },
};
exports.matrixArrayToCssMatrix = function (m) { return [
    m[0], m[3], m[1],
    m[4], m[2], m[5],
]; };
function multiplyAffine2d(m1, m2) {
    return [
        m1[0] * m2[0] + m1[1] * m2[3],
        m1[0] * m2[1] + m1[1] * m2[4],
        m1[0] * m2[2] + m1[1] * m2[5] + m1[2],
        m1[3] * m2[0] + m1[4] * m2[3],
        m1[3] * m2[1] + m1[4] * m2[4],
        m1[3] * m2[2] + m1[4] * m2[5] + m1[5]
    ];
}
exports.multiplyAffine2d = multiplyAffine2d;
function decompose2DTransformMatrix(matrix) {
    verifyTransformMatrix(matrix);
    var _a = matrix.slice(), A = _a[0], B = _a[1], C = _a[2], D = _a[3], E = _a[4], F = _a[5];
    var determinant = A * D - B * C;
    var translate = { x: E || 0, y: F || 0 };
    var rotate = 0;
    var scale = { x: 1, y: 1 };
    if (A || B) {
        var R = Math.sqrt(A * A + B * B);
        rotate = B > 0 ? Math.acos(A / R) : -Math.acos(A / R);
        scale = { x: R, y: determinant / R };
    }
    else if (C || D) {
        var R = Math.sqrt(C * C + D * D);
        rotate = Math.PI / 2 - (D > 0 ? Math.acos(-C / R) : -Math.acos(C / R));
        scale = { x: determinant / R, y: R };
    }
    rotate = number_utils_1.radiansToDegrees(rotate);
    return { translate: translate, rotate: rotate, scale: scale };
}
exports.decompose2DTransformMatrix = decompose2DTransformMatrix;
function verifyTransformMatrix(matrix) {
    if (matrix.length < 6) {
        throw new Error("Transform matrix should be 2x3.");
    }
}
//# sourceMappingURL=matrix.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var qualifier_matcher_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js");
var non_bundle_workflow_compat_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js");
var ModuleNameResolver = (function () {
    function ModuleNameResolver(context, moduleListProvider) {
        if (moduleListProvider === void 0) { moduleListProvider = global.getRegisteredModules; }
        this.context = context;
        this.moduleListProvider = moduleListProvider;
        this._cache = {};
    }
    ModuleNameResolver.prototype.resolveModuleName = function (path, ext) {
        var key = path + ext;
        var result = this._cache[key];
        if (result === undefined) {
            result = this.resolveModuleNameImpl(path, ext);
            this._cache[key] = result;
        }
        return result;
    };
    ModuleNameResolver.prototype.clearCache = function () {
        this._cache = {};
    };
    ModuleNameResolver.prototype.resolveModuleNameImpl = function (path, ext) {
        var result = null;
        ext = ext ? "." + ext : "";
        if (false) {}
        var candidates = this.getCandidates(path, ext);
        result = qualifier_matcher_1.findMatch(path, ext, candidates, this.context);
        return result;
    };
    ModuleNameResolver.prototype.getCandidates = function (path, ext) {
        var candidates = this.moduleListProvider()
            .filter(function (moduleName) { return moduleName.startsWith(path) && (!ext || moduleName.endsWith(ext)); });
        return candidates;
    };
    return ModuleNameResolver;
}());
exports.ModuleNameResolver = ModuleNameResolver;
var resolverInstance;
function resolveModuleName(path, ext) {
    if (!resolverInstance) {
        resolverInstance = new ModuleNameResolver({
            width: platform_1.screen.mainScreen.widthDIPs,
            height: platform_1.screen.mainScreen.heightDIPs,
            os: platform_1.device.os,
            deviceType: platform_1.device.deviceType
        });
    }
    return resolverInstance.resolveModuleName(path, ext);
}
exports.resolveModuleName = resolveModuleName;
function clearCache() {
    if (resolverInstance) {
        resolverInstance.clearCache();
    }
}
exports.clearCache = clearCache;
function _setResolver(resolver) {
    resolverInstance = resolver;
}
exports._setResolver = _setResolver;
appCommonModule.on("livesync", function (args) { return clearCache(); });
appCommonModule.on("orientationChanged", function (args) {
    resolverInstance = undefined;
});
//# sourceMappingURL=module-name-resolver.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var cache = new Set();
var initialized = false;
function register(name, loader) {
    global.registerModule(name, loader);
}
function processFile(file) {
    var filePathRelativeToApp = file.path.substr(fs.knownFolders.currentApp().path.length + 1);
    var loadContent = function () { return file.readTextSync(); };
    switch (file.extension.toLocaleLowerCase()) {
        case ".js":
            var noExtPath = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - ".js".length);
            register(filePathRelativeToApp, function () { return global.require(file.path); });
            register(noExtPath, function () { return global.require(file.path); });
            break;
        case ".css":
            register(filePathRelativeToApp, loadContent);
            break;
        case ".xml":
            register(filePathRelativeToApp, loadContent);
            break;
    }
    if (file.name === "package.json") {
        var json = global.require(file.path);
        if (json.main) {
            var name_1 = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - "package.json".length - 1);
            var requirePath_1 = fs.path.join(file.parent.path, json.main);
            if (name_1.startsWith("tns_modules")) {
                name_1 = name_1.substr("tns_modules".length + 1);
            }
            register(name_1, function () { return global.require(requirePath_1); });
        }
    }
}
function processFolder(path) {
    if (fs.Folder.exists(path)) {
        var folder = fs.Folder.fromPath(path);
        folder.eachEntity(function (file) {
            if (file instanceof fs.File) {
                processFile(file);
            }
            return true;
        });
    }
}
function registerModulesFromFileSystem(moduleName) {
    initialize();
    if (cache.has(moduleName)) {
        return;
    }
    cache.add(moduleName);
    var path = fs.path.join(fs.knownFolders.currentApp().path, moduleName);
    if (fs.Folder.exists(path)) {
        processFolder(path);
        return;
    }
    var parentName = moduleName.substr(0, moduleName.lastIndexOf(fs.path.separator));
    var parentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, parentName);
    if (fs.Folder.exists(parentFolderPath)) {
        processFolder(parentFolderPath);
        return;
    }
    var tnsModulesPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", moduleName);
    if (fs.Folder.exists(tnsModulesPath)) {
        processFolder(tnsModulesPath);
        return;
    }
    if (parentName) {
        var tnsParentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", parentName);
        if (fs.Folder.exists(tnsParentFolderPath)) {
            processFolder(tnsParentFolderPath);
            return;
        }
    }
}
exports.registerModulesFromFileSystem = registerModulesFromFileSystem;
function initialize() {
    if (!initialized) {
        appCommonModule.on("livesync", function (args) { return cache.clear(); });
        initialized = true;
    }
}
//# sourceMappingURL=non-bundle-workflow-compat.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MIN_WH = "minWH";
var MIN_W = "minW";
var MIN_H = "minH";
var PRIORITY_STEP = 10000;
var minWidthHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_WH) === 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_WH.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualLength = Math.min(context.width, context.height);
        if (actualLength < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualLength - numVal);
    }
};
var minWidthQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_W) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_W.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualWidth = context.width;
        if (actualWidth < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualWidth - numVal);
    }
};
var minHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_H) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_H.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualHeight = context.height;
        if (actualHeight < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualHeight - numVal);
    }
};
var platformQualifier = {
    isMatch: function (value) {
        return value === "android" ||
            value === "ios";
    },
    getMatchValue: function (value, context) {
        return value === context.os.toLowerCase() ? 1 : -1;
    }
};
var orientationQualifier = {
    isMatch: function (value) {
        return value === "land" ||
            value === "port";
    },
    getMatchValue: function (value, context) {
        var isLandscape = (context.width > context.height) ? 1 : -1;
        return (value === "land") ? isLandscape : -isLandscape;
    }
};
var supportedQualifiers = [
    minWidthHeightQualifier,
    minWidthQualifier,
    minHeightQualifier,
    orientationQualifier,
    platformQualifier
];
function checkQualifiers(qualifiers, context) {
    var result = 0;
    var value;
    for (var i = 0; i < qualifiers.length; i++) {
        if (qualifiers[i]) {
            value = checkQualifier(qualifiers[i], context);
            if (value < 0) {
                return -1;
            }
            result += value;
        }
    }
    return result;
}
function checkQualifier(value, context) {
    var result;
    for (var i = 0; i < supportedQualifiers.length; i++) {
        if (supportedQualifiers[i].isMatch(value)) {
            result = supportedQualifiers[i].getMatchValue(value, context);
            if (result > 0) {
                result += (supportedQualifiers.length - i) * PRIORITY_STEP;
            }
            return result;
        }
    }
    return -1;
}
function findMatch(path, ext, candidates, context) {
    var bestValue = -1;
    var result = null;
    for (var i = 0; i < candidates.length; i++) {
        var filePath = candidates[i];
        var qualifiersStr = filePath.substr(path.length, filePath.length - path.length - (ext ? ext.length : 0));
        var qualifiers = qualifiersStr.split(".");
        var value = checkQualifiers(qualifiers, context);
        if (value >= 0 && value > bestValue) {
            bestValue = value;
            result = candidates[i];
        }
    }
    return result;
}
exports.findMatch = findMatch;
//# sourceMappingURL=qualifier-matcher.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/platform/platform.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var platformNames;
(function (platformNames) {
    platformNames.android = "Android";
    platformNames.ios = "iOS";
})(platformNames = exports.platformNames || (exports.platformNames = {}));
var Device = (function () {
    function Device() {
    }
    Object.defineProperty(Device.prototype, "manufacturer", {
        get: function () {
            return "Apple";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "os", {
        get: function () {
            return platformNames.ios;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "osVersion", {
        get: function () {
            if (!this._osVersion) {
                this._osVersion = UIDevice.currentDevice.systemVersion;
            }
            return this._osVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "model", {
        get: function () {
            if (!this._model) {
                this._model = UIDevice.currentDevice.model;
            }
            return this._model;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "sdkVersion", {
        get: function () {
            if (!this._sdkVersion) {
                this._sdkVersion = UIDevice.currentDevice.systemVersion;
            }
            return this._sdkVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "deviceType", {
        get: function () {
            if (!this._deviceType) {
                if (UIDevice.currentDevice.userInterfaceIdiom === 0) {
                    this._deviceType = "Phone";
                }
                else {
                    this._deviceType = "Tablet";
                }
            }
            return this._deviceType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "uuid", {
        get: function () {
            var userDefaults = NSUserDefaults.standardUserDefaults;
            var uuid_key = "TNSUUID";
            var app_uuid = userDefaults.stringForKey(uuid_key);
            if (!app_uuid) {
                app_uuid = NSUUID.UUID().UUIDString;
                userDefaults.setObjectForKey(app_uuid, uuid_key);
                userDefaults.synchronize();
            }
            return app_uuid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "language", {
        get: function () {
            if (!this._language) {
                var languages = NSLocale.preferredLanguages;
                this._language = languages[0];
            }
            return this._language;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "region", {
        get: function () {
            if (!this._region) {
                this._region = NSLocale.currentLocale.objectForKey(NSLocaleCountryCode);
            }
            return this._region;
        },
        enumerable: true,
        configurable: true
    });
    return Device;
}());
var MainScreen = (function () {
    function MainScreen() {
    }
    Object.defineProperty(MainScreen.prototype, "screen", {
        get: function () {
            if (!this._screen) {
                this._screen = UIScreen.mainScreen;
            }
            return this._screen;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthPixels", {
        get: function () {
            return this.widthDIPs * this.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightPixels", {
        get: function () {
            return this.heightDIPs * this.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "scale", {
        get: function () {
            return this.screen.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthDIPs", {
        get: function () {
            return this.screen.bounds.size.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightDIPs", {
        get: function () {
            return this.screen.bounds.size.height;
        },
        enumerable: true,
        configurable: true
    });
    return MainScreen;
}());
exports.device = new Device();
var screen;
(function (screen) {
    screen.mainScreen = new MainScreen();
})(screen = exports.screen || (exports.screen = {}));
exports.isIOS = true;
exports.isAndroid = false;
//# sourceMappingURL=platform.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/profiling/profiling.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function uptime() {
    return global.android ? org.nativescript.Process.getUpTime() : global.__tns_uptime();
}
exports.uptime = uptime;
function log(message) {
    if (global.__nslog) {
        global.__nslog("CONSOLE LOG: " + message);
    }
    console.log(message);
}
exports.log = log;
var timers = {};
var anyGlobal = global;
var profileNames = [];
exports.time = global.__time || Date.now;
function start(name) {
    var info = timers[name];
    if (info) {
        info.currentStart = exports.time();
        info.runCount++;
    }
    else {
        info = {
            totalTime: 0,
            count: 0,
            currentStart: exports.time(),
            runCount: 1
        };
        timers[name] = info;
        profileNames.push(name);
    }
}
exports.start = start;
function stop(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    if (info.runCount) {
        info.runCount--;
        if (info.runCount) {
            info.count++;
        }
        else {
            info.lastTime = exports.time() - info.currentStart;
            info.totalTime += info.lastTime;
            info.count++;
            info.currentStart = 0;
        }
    }
    else {
        throw new Error("Timer " + name + " paused more times than started.");
    }
    return info;
}
exports.stop = stop;
function timer(name) {
    return timers[name];
}
exports.timer = timer;
function print(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
    return info;
}
exports.print = print;
function isRunning(name) {
    var info = timers[name];
    return !!(info && info.runCount);
}
exports.isRunning = isRunning;
function countersProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    profileNames.push(name);
    return function () {
        start(name);
        try {
            return fn.apply(this, arguments);
        }
        finally {
            stop(name);
        }
    };
}
function timelineProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    return type === 1 ? function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + " " + this + "  (" + start + "ms. - " + end + "ms.)");
        }
    } : function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + "  (" + start + "ms. - " + end + "ms.)");
        }
    };
}
var Level;
(function (Level) {
    Level[Level["none"] = 0] = "none";
    Level[Level["lifecycle"] = 1] = "lifecycle";
    Level[Level["timeline"] = 2] = "timeline";
})(Level = exports.Level || (exports.Level = {}));
var tracingLevel = Level.none;
var profileFunctionFactory;
function enable(mode) {
    if (mode === void 0) { mode = "counters"; }
    profileFunctionFactory = mode && {
        counters: countersProfileFunctionFactory,
        timeline: timelineProfileFunctionFactory
    }[mode];
    tracingLevel = {
        lifecycle: Level.lifecycle,
        timeline: Level.timeline,
    }[mode] || Level.none;
}
exports.enable = enable;
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.profiling) {
        enable(appConfig.profiling);
    }
}
catch (e1) {
    try {
        console.log("Profiling startup failed to figure out defaults from package.json, error: " + e1);
    }
    catch (e2) {
    }
}
function disable() {
    profileFunctionFactory = undefined;
}
exports.disable = disable;
function profileFunction(fn, customName) {
    return profileFunctionFactory(fn, customName || fn.name);
}
var profileMethodUnnamed = function (target, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(target, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (target && target.constructor && target.constructor.name) {
        className = target.constructor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 1);
    return descriptor;
};
var profileStaticMethodUnnamed = function (ctor, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(ctor, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (ctor && ctor.name) {
        className = ctor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 0);
    return descriptor;
};
function profileMethodNamed(name) {
    return function (target, key, descriptor) {
        if (descriptor === undefined) {
            descriptor = Object.getOwnPropertyDescriptor(target, key);
        }
        var originalMethod = descriptor.value;
        descriptor.value = profileFunctionFactory(originalMethod, name);
        return descriptor;
    };
}
var voidMethodDecorator = function () {
};
function profile(nameFnOrTarget, fnOrKey, descriptor) {
    if (typeof nameFnOrTarget === "object" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "function" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileStaticMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "string" && typeof fnOrKey === "function") {
        if (!profileFunctionFactory) {
            return fnOrKey;
        }
        return profileFunction(fnOrKey, nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "function") {
        if (!profileFunctionFactory) {
            return nameFnOrTarget;
        }
        return profileFunction(nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "string") {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodNamed(nameFnOrTarget);
    }
    else {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodUnnamed;
    }
}
exports.profile = profile;
function dumpProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
        }
        else {
            console.log("---- [" + name + "] Never called");
        }
    });
}
exports.dumpProfiles = dumpProfiles;
function resetProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            if (info.runCount) {
                console.log("---- timer with name [" + name + "] is currently running and won't be reset");
            }
            else {
                timers[name] = undefined;
            }
        }
    });
}
exports.resetProfiles = resetProfiles;
function startCPUProfile(name) {
    if (anyGlobal.android) {
        __startCPUProfiler(name);
    }
}
exports.startCPUProfile = startCPUProfile;
function stopCPUProfile(name) {
    if (anyGlobal.android) {
        __stopCPUProfiler(name);
    }
}
exports.stopCPUProfile = stopCPUProfile;
function level() {
    return tracingLevel;
}
exports.level = level;
function trace(message, start, end) {
    log("Timeline: Modules: " + message + "  (" + start + "ms. - " + end + "ms.)");
}
exports.trace = trace;
//# sourceMappingURL=profiling.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/text/formatted-string.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var span_1 = __webpack_require__("../node_modules/tns-core-modules/text/span.js");
exports.Span = span_1.Span;
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.spans = "spans";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var FormattedString = (function (_super) {
    __extends(FormattedString, _super);
    function FormattedString() {
        var _this = _super.call(this) || this;
        _this._spans = new observable_array_1.ObservableArray();
        _this._spans.addEventListener(observable_array_1.ObservableArray.changeEvent, _this.onSpansCollectionChanged, _this);
        return _this;
    }
    Object.defineProperty(FormattedString.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "spans", {
        get: function () {
            if (!this._spans) {
                this._spans = new observable_array_1.ObservableArray();
            }
            return this._spans;
        },
        enumerable: true,
        configurable: true
    });
    FormattedString.prototype.toString = function () {
        var result = "";
        for (var i = 0, length_1 = this._spans.length; i < length_1; i++) {
            result += this._spans.getItem(i).text;
        }
        return result;
    };
    FormattedString.prototype._addArrayFromBuilder = function (name, value) {
        if (name === knownCollections.spans) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof span_1.Span) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype.onSpansCollectionChanged = function (eventData) {
        if (eventData.addedCount > 0) {
            for (var i = 0; i < eventData.addedCount; i++) {
                var span = eventData.object.getItem(eventData.index + i);
                this._addView(span);
                this.addPropertyChangeHandler(span);
            }
        }
        if (eventData.removed && eventData.removed.length > 0) {
            for (var p = 0; p < eventData.removed.length; p++) {
                var span = eventData.removed[p];
                this.removePropertyChangeHandler(span);
                this._removeView(span);
            }
        }
        this.notifyPropertyChange(".", this);
    };
    FormattedString.prototype.addPropertyChangeHandler = function (span) {
        var style = span.style;
        span.on(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.on("fontFamilyChange", this.onPropertyChange, this);
        style.on("fontSizeChange", this.onPropertyChange, this);
        style.on("fontStyleChange", this.onPropertyChange, this);
        style.on("fontWeightChange", this.onPropertyChange, this);
        style.on("textDecorationChange", this.onPropertyChange, this);
        style.on("colorChange", this.onPropertyChange, this);
        style.on("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.removePropertyChangeHandler = function (span) {
        var style = span.style;
        span.off(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.off("fontFamilyChange", this.onPropertyChange, this);
        style.off("fontSizeChange", this.onPropertyChange, this);
        style.off("fontStyleChange", this.onPropertyChange, this);
        style.off("fontWeightChange", this.onPropertyChange, this);
        style.off("textDecorationChange", this.onPropertyChange, this);
        style.off("colorChange", this.onPropertyChange, this);
        style.off("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.onPropertyChange = function (data) {
        this.notifyPropertyChange(data.propertyName, this);
    };
    FormattedString.prototype.eachChild = function (callback) {
        this.spans.forEach(function (v, i, arr) { return callback(v); });
    };
    return FormattedString;
}(view_1.ViewBase));
exports.FormattedString = FormattedString;
//# sourceMappingURL=formatted-string.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/span.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Span = (function (_super) {
    __extends(Span, _super);
    function Span() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Span.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "text", {
        get: function () {
            return this._text;
        },
        set: function (value) {
            if (this._text !== value) {
                this._text = value;
                this.notifyPropertyChange("text", value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Span.prototype._setTextInternal = function (value) {
        this._text = value;
    };
    return Span;
}(view_1.ViewBase));
exports.Span = Span;
//# sourceMappingURL=span.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/text.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var encoding;
(function (encoding) {
    encoding.ISO_8859_1 = 5;
    encoding.US_ASCII = 1;
    encoding.UTF_16 = 10;
    encoding.UTF_16BE = 0x90000100;
    encoding.UTF_16LE = 0x94000100;
    encoding.UTF_8 = 4;
})(encoding = exports.encoding || (exports.encoding = {}));
//# sourceMappingURL=text.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/timer/timer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var timeoutCallbacks = new Map();
var timerId = 0;
var TimerTargetImpl = (function (_super) {
    __extends(TimerTargetImpl, _super);
    function TimerTargetImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimerTargetImpl.initWithCallback = function (callback, id, shouldRepeat) {
        var handler = TimerTargetImpl.new();
        handler.callback = callback;
        handler.id = id;
        handler.shouldRepeat = shouldRepeat;
        return handler;
    };
    TimerTargetImpl.prototype.tick = function (timer) {
        if (!this.disposed) {
            this.callback();
        }
        if (!this.shouldRepeat) {
            this.unregister();
        }
    };
    TimerTargetImpl.prototype.unregister = function () {
        if (!this.disposed) {
            this.disposed = true;
            var timer = timeoutCallbacks.get(this.id).k;
            timer.invalidate();
            timeoutCallbacks.delete(this.id);
        }
    };
    TimerTargetImpl.ObjCExposedMethods = {
        "tick": { returns: interop.types.void, params: [NSTimer] }
    };
    return TimerTargetImpl;
}(NSObject));
function createTimerAndGetId(callback, milliseconds, shouldRepeat) {
    timerId++;
    var id = timerId;
    var timerTarget = TimerTargetImpl.initWithCallback(callback, id, shouldRepeat);
    var timer = NSTimer.scheduledTimerWithTimeIntervalTargetSelectorUserInfoRepeats(milliseconds / 1000, timerTarget, "tick", null, shouldRepeat);
    NSRunLoop.currentRunLoop.addTimerForMode(timer, NSRunLoopCommonModes);
    var pair = { k: timer, v: timerTarget };
    timeoutCallbacks.set(id, pair);
    return id;
}
function setTimeout(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var invoke = function () { return callback.apply(void 0, args); };
    return createTimerAndGetId(zonedCallback(invoke), milliseconds, false);
}
exports.setTimeout = setTimeout;
function clearTimeout(id) {
    var pair = timeoutCallbacks.get(id);
    if (pair) {
        pair.v.unregister();
    }
}
exports.clearTimeout = clearTimeout;
function setInterval(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var invoke = function () { return callback.apply(void 0, args); };
    return createTimerAndGetId(zonedCallback(invoke), milliseconds, true);
}
exports.setInterval = setInterval;
exports.clearInterval = clearTimeout;
//# sourceMappingURL=timer.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/trace/trace.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var enabled = false;
var _categories = {};
var _writers = [];
var _eventListeners = [];
var _errorHandler;
function enable() {
    enabled = true;
}
exports.enable = enable;
function disable() {
    enabled = false;
}
exports.disable = disable;
function isEnabled() {
    return enabled;
}
exports.isEnabled = isEnabled;
function isCategorySet(category) {
    return category in _categories;
}
exports.isCategorySet = isCategorySet;
function addWriter(writer) {
    _writers.push(writer);
}
exports.addWriter = addWriter;
function removeWriter(writer) {
    var index = _writers.indexOf(writer);
    if (index >= 0) {
        _writers.splice(index, 1);
    }
}
exports.removeWriter = removeWriter;
function clearWriters() {
    if (_writers.length > 0) {
        _writers.splice(0, _writers.length);
    }
}
exports.clearWriters = clearWriters;
function setCategories(categories) {
    _categories = {};
    addCategories(categories);
}
exports.setCategories = setCategories;
function addCategories(categories) {
    var split = categories.split(",");
    for (var i = 0; i < split.length; i++) {
        _categories[split[i].trim()] = true;
    }
}
exports.addCategories = addCategories;
function write(message, category, type) {
    var i;
    if (type === messageType.error) {
        for (i = 0; i < _writers.length; i++) {
            _writers[i].write(message, category, type);
        }
        return;
    }
    if (!enabled) {
        return;
    }
    if (!(category in _categories)) {
        return;
    }
    for (i = 0; i < _writers.length; i++) {
        _writers[i].write(message, category, type);
    }
}
exports.write = write;
function notifyEvent(object, name, data) {
    if (!enabled) {
        return;
    }
    var i, listener, filters;
    for (i = 0; i < _eventListeners.length; i++) {
        listener = _eventListeners[i];
        if (listener.filter) {
            filters = listener.filter.split(",");
            filters.forEach(function (value) {
                if (value.trim() === name) {
                    listener.on(object, name, data);
                }
            });
        }
        else {
            listener.on(object, name, data);
        }
    }
}
exports.notifyEvent = notifyEvent;
function addEventListener(listener) {
    _eventListeners.push(listener);
}
exports.addEventListener = addEventListener;
function removeEventListener(listener) {
    var index = _eventListeners.indexOf(listener);
    if (index >= 0) {
        _eventListeners.splice(index, 1);
    }
}
exports.removeEventListener = removeEventListener;
var messageType;
(function (messageType) {
    messageType.log = 0;
    messageType.info = 1;
    messageType.warn = 2;
    messageType.error = 3;
})(messageType = exports.messageType || (exports.messageType = {}));
var categories;
(function (categories) {
    categories.VisualTreeEvents = "VisualTreeEvents";
    categories.Layout = "Layout";
    categories.Style = "Style";
    categories.ViewHierarchy = "ViewHierarchy";
    categories.NativeLifecycle = "NativeLifecycle";
    categories.Debug = "Debug";
    categories.Navigation = "Navigation";
    categories.Test = "Test";
    categories.Binding = "Binding";
    categories.BindingError = "BindingError";
    categories.Error = "Error";
    categories.Animation = "Animation";
    categories.Transition = "Transition";
    categories.Livesync = "Livesync";
    categories.separator = ",";
    categories.All = categories.VisualTreeEvents + categories.separator
        + categories.Layout + categories.separator
        + categories.Style + categories.separator
        + categories.ViewHierarchy + categories.separator
        + categories.NativeLifecycle + categories.separator
        + categories.Debug + categories.separator
        + categories.Navigation + categories.separator
        + categories.Test + categories.separator
        + categories.Binding + categories.separator
        + categories.Error + categories.separator
        + categories.Animation + categories.separator
        + categories.Transition + categories.separator
        + categories.Livesync;
    function concat() {
        var result;
        for (var i = 0; i < arguments.length; i++) {
            if (!result) {
                result = arguments[i];
                continue;
            }
            result = result.concat(categories.separator, arguments[i]);
        }
        return result;
    }
    categories.concat = concat;
})(categories = exports.categories || (exports.categories = {}));
var ConsoleWriter = (function () {
    function ConsoleWriter() {
    }
    ConsoleWriter.prototype.write = function (message, category, type) {
        if (!console) {
            return;
        }
        var msgType;
        if (type === undefined) {
            msgType = messageType.log;
        }
        else {
            msgType = type;
        }
        switch (msgType) {
            case messageType.log:
                console.log(category + ": " + message);
                break;
            case messageType.info:
                console.info(category + ": " + message);
                break;
            case messageType.warn:
                console.warn(category + ": " + message);
                break;
            case messageType.error:
                console.error(category + ": " + message);
                break;
        }
    };
    return ConsoleWriter;
}());
addWriter(new ConsoleWriter());
var DefaultErrorHandler = (function () {
    function DefaultErrorHandler() {
    }
    DefaultErrorHandler.prototype.handlerError = function (error) {
        throw error;
    };
    return DefaultErrorHandler;
}());
exports.DefaultErrorHandler = DefaultErrorHandler;
setErrorHandler(new DefaultErrorHandler());
function getErrorHandler() {
    return _errorHandler;
}
exports.getErrorHandler = getErrorHandler;
function setErrorHandler(handler) {
    _errorHandler = handler;
}
exports.setErrorHandler = setErrorHandler;
function error(error) {
    if (!_errorHandler) {
        return;
    }
    if (typeof error === "string") {
        error = new Error(error);
    }
    _errorHandler.handlerError(error);
}
exports.error = error;
//# sourceMappingURL=trace.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.actionItems = "actionItems";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var ActionBarBase = (function (_super) {
    __extends(ActionBarBase, _super);
    function ActionBarBase() {
        var _this = _super.call(this) || this;
        _this._actionItems = new ActionItems(_this);
        return _this;
    }
    Object.defineProperty(ActionBarBase.prototype, "navigationButton", {
        get: function () {
            return this._navigationButton;
        },
        set: function (value) {
            if (this._navigationButton !== value) {
                if (this._navigationButton) {
                    this._removeView(this._navigationButton);
                    this._navigationButton.actionBar = undefined;
                }
                this._navigationButton = value;
                if (this._navigationButton) {
                    this._navigationButton.actionBar = this;
                    this._addView(this._navigationButton);
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "actionItems", {
        get: function () {
            return this._actionItems;
        },
        set: function (value) {
            throw new Error("actionItems property is read-only");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "titleView", {
        get: function () {
            return this._titleView;
        },
        set: function (value) {
            if (this._titleView !== value) {
                if (this._titleView) {
                    this._removeView(this._titleView);
                    this._titleView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._titleView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                }
                this._titleView = value;
                if (value) {
                    this._addView(value);
                    var style = value.style;
                    if (!view_1.horizontalAlignmentProperty.isSet(style)) {
                        style[view_1.horizontalAlignmentProperty.cssName] = "center";
                    }
                    if (!view_1.verticalAlignmentProperty.isSet(style)) {
                        style[view_1.verticalAlignmentProperty.cssName] = "middle";
                    }
                }
                this.update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionBarBase.prototype, "_childrenCount", {
        get: function () {
            var actionViewsCount = 0;
            this._actionItems.getItems().forEach(function (actionItem) {
                if (actionItem.actionView) {
                    actionViewsCount++;
                }
            });
            return actionViewsCount + (this.titleView ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    ActionBarBase.prototype.update = function () {
    };
    ActionBarBase.prototype._onTitlePropertyChanged = function () {
    };
    ActionBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "actionItems") {
            this.actionItems.setItems(value);
        }
    };
    ActionBarBase.prototype.eachChildView = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
    };
    ActionBarBase.prototype.eachChild = function (callback) {
        var titleView = this.titleView;
        if (titleView) {
            callback(titleView);
        }
        var navigationButton = this._navigationButton;
        if (navigationButton) {
            callback(navigationButton);
        }
        this.actionItems.getItems().forEach(function (actionItem) {
            callback(actionItem);
        });
    };
    ActionBarBase.prototype._isEmpty = function () {
        if (this.title ||
            this.titleView ||
            (this.android && this.android.icon) ||
            this.navigationButton ||
            this.actionItems.getItems().length > 0) {
            return false;
        }
        return true;
    };
    ActionBarBase = __decorate([
        view_1.CSSType("ActionBar")
    ], ActionBarBase);
    return ActionBarBase;
}(view_1.View));
exports.ActionBarBase = ActionBarBase;
var ActionItems = (function () {
    function ActionItems(actionBar) {
        this._items = new Array();
        this._actionBar = actionBar;
    }
    ActionItems.prototype.addItem = function (item) {
        if (!item) {
            throw new Error("Cannot add empty item");
        }
        this._items.push(item);
        item.actionBar = this._actionBar;
        this._actionBar._addView(item);
        this.invalidate();
    };
    ActionItems.prototype.removeItem = function (item) {
        if (!item) {
            throw new Error("Cannot remove empty item");
        }
        var itemIndex = this._items.indexOf(item);
        if (itemIndex < 0) {
            throw new Error("Cannot find item to remove");
        }
        this._items.splice(itemIndex, 1);
        this._actionBar._removeView(item);
        item.actionBar = undefined;
        this.invalidate();
    };
    ActionItems.prototype.getItems = function () {
        return this._items.slice();
    };
    ActionItems.prototype.getVisibleItems = function () {
        var visibleItems = [];
        this._items.forEach(function (item) {
            if (isVisible(item)) {
                visibleItems.push(item);
            }
        });
        return visibleItems;
    };
    ActionItems.prototype.getItemAt = function (index) {
        if (index < 0 || index >= this._items.length) {
            return undefined;
        }
        return this._items[index];
    };
    ActionItems.prototype.setItems = function (items) {
        while (this._items.length > 0) {
            this.removeItem(this._items[this._items.length - 1]);
        }
        for (var i = 0; i < items.length; i++) {
            this.addItem(items[i]);
        }
        this.invalidate();
    };
    ActionItems.prototype.invalidate = function () {
        if (this._actionBar) {
            this._actionBar.update();
        }
    };
    return ActionItems;
}());
exports.ActionItems = ActionItems;
var ActionItemBase = (function (_super) {
    __extends(ActionItemBase, _super);
    function ActionItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ActionItemBase.prototype, "actionView", {
        get: function () {
            return this._actionView;
        },
        set: function (value) {
            if (this._actionView !== value) {
                if (this._actionView) {
                    this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._actionView.style[view_1.verticalAlignmentProperty.cssName] = view_1.unsetValue;
                    this._removeView(this._actionView);
                }
                this._actionView = value;
                if (this._actionView) {
                    this._addView(this._actionView);
                }
                if (this._actionBar) {
                    this._actionBar.update();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ActionItemBase.prototype, "actionBar", {
        get: function () {
            return this._actionBar;
        },
        set: function (value) {
            if (value !== this._actionBar) {
                this._actionBar = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    ActionItemBase.prototype.onLoaded = function () {
        if (this._actionView) {
            this._actionView.style[view_1.horizontalAlignmentProperty.cssName] = "center";
            this._actionView.style[view_1.verticalAlignmentProperty.cssName] = "middle";
        }
        _super.prototype.onLoaded.call(this);
    };
    ActionItemBase.prototype._raiseTap = function () {
        this._emit(ActionItemBase.tapEvent);
    };
    ActionItemBase.prototype._addChildFromBuilder = function (name, value) {
        this.actionView = value;
    };
    ActionItemBase.prototype._onVisibilityChanged = function (visibility) {
        if (this.actionBar) {
            this.actionBar.update();
        }
    };
    ActionItemBase.prototype.eachChild = function (callback) {
        if (this._actionView) {
            callback(this._actionView);
        }
    };
    ActionItemBase.tapEvent = "tap";
    __decorate([
        profiling_1.profile
    ], ActionItemBase.prototype, "onLoaded", null);
    return ActionItemBase;
}(view_1.ViewBase));
exports.ActionItemBase = ActionItemBase;
function isVisible(item) {
    return item.visibility === "visible";
}
exports.isVisible = isVisible;
function onTitlePropertyChanged(actionBar, oldValue, newValue) {
    actionBar._onTitlePropertyChanged();
}
exports.titleProperty = new view_1.Property({ name: "title", valueChanged: onTitlePropertyChanged });
exports.titleProperty.register(ActionBarBase);
function onItemChanged(item, oldValue, newValue) {
    if (item.actionBar) {
        item.actionBar.update();
    }
}
function onVisibilityChanged(item, oldValue, newValue) {
    item._onVisibilityChanged(newValue);
}
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load action bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "alwaysOriginal" });
exports.iosIconRenderingModeProperty.register(ActionBarBase);
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", valueChanged: onItemChanged });
exports.textProperty.register(ActionItemBase);
exports.iconProperty = new view_1.Property({ name: "icon", valueChanged: onItemChanged });
exports.iconProperty.register(ActionItemBase);
exports.visibilityProperty = new view_1.Property({ name: "visibility", defaultValue: "visible", valueChanged: onVisibilityChanged });
exports.visibilityProperty.register(ActionItemBase);
exports.flatProperty = new view_1.Property({ name: "flat", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.flatProperty.register(ActionBarBase);
//# sourceMappingURL=action-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/action-bar/action-bar.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var action_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar-common.js"));
var majorVersion = utils_1.ios.MajorVersion;
var UNSPECIFIED = action_bar_common_1.layout.makeMeasureSpec(0, action_bar_common_1.layout.UNSPECIFIED);
function loadActionIconFromFileOrResource(icon) {
    var img = image_source_1.fromFileOrResource(icon);
    if (img && img.ios) {
        return img.ios;
    }
    else {
        action_bar_common_1.traceMissingIcon(icon);
        return null;
    }
}
var TapBarItemHandlerImpl = (function (_super) {
    __extends(TapBarItemHandlerImpl, _super);
    function TapBarItemHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TapBarItemHandlerImpl.initWithOwner = function (owner) {
        var handler = TapBarItemHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    TapBarItemHandlerImpl.prototype.tap = function (args) {
        var owner = this._owner.get();
        if (owner) {
            owner._raiseTap();
        }
    };
    TapBarItemHandlerImpl.ObjCExposedMethods = {
        "tap": { returns: interop.types.void, params: [interop.types.id] }
    };
    return TapBarItemHandlerImpl;
}(NSObject));
var ActionItem = (function (_super) {
    __extends(ActionItem, _super);
    function ActionItem() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._ios = {
            position: "left",
            systemIcon: undefined
        };
        return _this;
    }
    Object.defineProperty(ActionItem.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        set: function (value) {
            throw new Error("ActionItem.ios is read-only");
        },
        enumerable: true,
        configurable: true
    });
    return ActionItem;
}(action_bar_common_1.ActionItemBase));
exports.ActionItem = ActionItem;
var NavigationButton = (function (_super) {
    __extends(NavigationButton, _super);
    function NavigationButton() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NavigationButton.prototype._onVisibilityChanged = function (visibility) {
        if (this._navigationItem) {
            var visible = visibility === "visible";
            this._navigationItem.setHidesBackButtonAnimated(!visible, true);
        }
    };
    return NavigationButton;
}(ActionItem));
exports.NavigationButton = NavigationButton;
var ActionBar = (function (_super) {
    __extends(ActionBar, _super);
    function ActionBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ActionBar.prototype, "ios", {
        get: function () {
            var page = this.page;
            if (!page || !page.parent) {
                return;
            }
            var viewController = page.ios;
            if (viewController.navigationController !== null) {
                return viewController.navigationController.navigationBar;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    ActionBar.prototype.createNativeView = function () {
        return this.ios;
    };
    ActionBar.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof NavigationButton) {
            this.navigationButton = value;
        }
        else if (value instanceof ActionItem) {
            this.actionItems.addItem(value);
        }
        else if (value instanceof action_bar_common_1.View) {
            this.titleView = value;
        }
    };
    Object.defineProperty(ActionBar.prototype, "_getActualSize", {
        get: function () {
            var navBar = this.ios;
            if (!navBar) {
                return { width: 0, height: 0 };
            }
            var frame = navBar.frame;
            var size = frame.size;
            var width = action_bar_common_1.layout.toDevicePixels(size.width);
            var height = action_bar_common_1.layout.toDevicePixels(size.height);
            return { width: width, height: height };
        },
        enumerable: true,
        configurable: true
    });
    ActionBar.prototype.layoutInternal = function () {
        var _a = this._getActualSize, width = _a.width, height = _a.height;
        var widthSpec = action_bar_common_1.layout.makeMeasureSpec(width, action_bar_common_1.layout.EXACTLY);
        var heightSpec = action_bar_common_1.layout.makeMeasureSpec(height, action_bar_common_1.layout.EXACTLY);
        this.measure(widthSpec, heightSpec);
        this.layout(0, 0, width, height, false);
    };
    ActionBar.prototype._getIconRenderingMode = function () {
        switch (this.iosIconRenderingMode) {
            case "alwaysOriginal":
                return 1;
            case "alwaysTemplate":
                return 2;
            case "automatic":
            default:
                return 1;
        }
    };
    ActionBar.prototype.update = function () {
        var page = this.page;
        if (!page || !page.frame) {
            return;
        }
        var viewController = page.ios;
        var navigationItem = viewController.navigationItem;
        var navController = viewController.navigationController;
        if (!navController) {
            return;
        }
        var navigationBar = navController.navigationBar;
        var previousController;
        navigationItem.title = this.title;
        var titleView = this.titleView;
        if (titleView && titleView.ios) {
            navigationItem.titleView = titleView.ios;
        }
        else {
            navigationItem.titleView = null;
        }
        var indexOfViewController = navController.viewControllers.indexOfObject(viewController);
        if (indexOfViewController > 0 && indexOfViewController < navController.viewControllers.count) {
            previousController = navController.viewControllers[indexOfViewController - 1];
        }
        if (previousController) {
            if (this.navigationButton) {
                var tapHandler = TapBarItemHandlerImpl.initWithOwner(new WeakRef(this.navigationButton));
                var barButtonItem = UIBarButtonItem.alloc().initWithTitleStyleTargetAction(this.navigationButton.text + "", 0, tapHandler, "tap");
                previousController.navigationItem.backBarButtonItem = barButtonItem;
            }
            else {
                previousController.navigationItem.backBarButtonItem = null;
            }
        }
        var img;
        if (this.navigationButton && action_bar_common_1.isVisible(this.navigationButton) && this.navigationButton.icon) {
            img = loadActionIconFromFileOrResource(this.navigationButton.icon);
        }
        if (img) {
            var image = img.imageWithRenderingMode(1);
            navigationBar.backIndicatorImage = image;
            navigationBar.backIndicatorTransitionMaskImage = image;
        }
        else {
            navigationBar.backIndicatorImage = null;
            navigationBar.backIndicatorTransitionMaskImage = null;
        }
        if (this.navigationButton) {
            this.navigationButton._navigationItem = navigationItem;
            navigationItem.setHidesBackButtonAnimated(!action_bar_common_1.isVisible(this.navigationButton), false);
        }
        this.populateMenuItems(navigationItem);
        this.updateColors(navigationBar);
        this.updateFlatness(navigationBar);
        if (!this.isLayoutValid) {
            this.layoutInternal();
        }
    };
    ActionBar.prototype.populateMenuItems = function (navigationItem) {
        var items = this.actionItems.getVisibleItems();
        var leftBarItems = [];
        var rightBarItems = [];
        for (var i = 0; i < items.length; i++) {
            var barButtonItem = this.createBarButtonItem(items[i]);
            if (items[i].ios.position === "left") {
                leftBarItems.push(barButtonItem);
            }
            else {
                rightBarItems.splice(0, 0, barButtonItem);
            }
        }
        navigationItem.setLeftBarButtonItemsAnimated(leftBarItems, false);
        navigationItem.setRightBarButtonItemsAnimated(rightBarItems, false);
        if (leftBarItems.length > 0) {
            navigationItem.leftItemsSupplementBackButton = true;
        }
    };
    ActionBar.prototype.createBarButtonItem = function (item) {
        var tapHandler = TapBarItemHandlerImpl.initWithOwner(new WeakRef(item));
        item.handler = tapHandler;
        var barButtonItem;
        if (item.actionView && item.actionView.ios) {
            var recognizer = UITapGestureRecognizer.alloc().initWithTargetAction(tapHandler, "tap");
            item.actionView.ios.addGestureRecognizer(recognizer);
            barButtonItem = UIBarButtonItem.alloc().initWithCustomView(item.actionView.ios);
        }
        else if (item.ios.systemIcon !== undefined) {
            var id = item.ios.systemIcon;
            if (typeof id === "string") {
                id = parseInt(id);
            }
            barButtonItem = UIBarButtonItem.alloc().initWithBarButtonSystemItemTargetAction(id, tapHandler, "tap");
        }
        else if (item.icon) {
            var img = null;
            if (utils_1.isFontIconURI(item.icon)) {
                var fontIconCode = item.icon.split("//")[1];
                var font = item.style.fontInternal;
                var color = item.style.color;
                var is = image_source_1.fromFontIconCode(fontIconCode, font, color);
                if (is && is.ios) {
                    img = is.ios;
                }
                else {
                    action_bar_common_1.traceMissingIcon(item.icon);
                }
            }
            else {
                img = loadActionIconFromFileOrResource(item.icon);
            }
            var image = img.imageWithRenderingMode(this._getIconRenderingMode());
            barButtonItem = UIBarButtonItem.alloc().initWithImageStyleTargetAction(image, 0, tapHandler, "tap");
        }
        else {
            barButtonItem = UIBarButtonItem.alloc().initWithTitleStyleTargetAction(item.text + "", 0, tapHandler, "tap");
        }
        if (item.text) {
            barButtonItem.isAccessibilityElement = true;
            barButtonItem.accessibilityLabel = item.text;
            barButtonItem.accessibilityTraits = UIAccessibilityTraitButton;
        }
        return barButtonItem;
    };
    ActionBar.prototype.updateColors = function (navBar) {
        var color = this.color;
        this.setColor(navBar, color);
        var bgColor = this.backgroundColor;
        navBar.barTintColor = bgColor ? bgColor.ios : null;
    };
    ActionBar.prototype.setColor = function (navBar, color) {
        var _a, _b;
        if (color) {
            navBar.titleTextAttributes = (_a = {}, _a[NSForegroundColorAttributeName] = color.ios, _a);
            navBar.largeTitleTextAttributes = (_b = {}, _b[NSForegroundColorAttributeName] = color.ios, _b);
            navBar.tintColor = color.ios;
        }
        else {
            navBar.titleTextAttributes = null;
            navBar.largeTitleTextAttributes = null;
            navBar.tintColor = null;
        }
    };
    ActionBar.prototype._onTitlePropertyChanged = function () {
        var page = this.page;
        if (!page) {
            return;
        }
        if (page.frame) {
            page.frame._updateActionBar();
        }
        var navigationItem = page.ios.navigationItem;
        navigationItem.title = this.title;
    };
    ActionBar.prototype.updateFlatness = function (navBar) {
        if (this.flat) {
            navBar.setBackgroundImageForBarMetrics(UIImage.new(), 0);
            navBar.shadowImage = UIImage.new();
            navBar.translucent = false;
        }
        else {
            navBar.setBackgroundImageForBarMetrics(null, null);
            navBar.shadowImage = null;
            navBar.translucent = true;
        }
    };
    ActionBar.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        var width = action_bar_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var height = action_bar_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        if (this.titleView) {
            action_bar_common_1.View.measureChild(this, this.titleView, UNSPECIFIED, UNSPECIFIED);
        }
        this.actionItems.getItems().forEach(function (actionItem) {
            var actionView = actionItem.actionView;
            if (actionView) {
                action_bar_common_1.View.measureChild(_this, actionView, UNSPECIFIED, UNSPECIFIED);
            }
        });
        this.setMeasuredDimension(width, height);
    };
    ActionBar.prototype.onLayout = function (left, top, right, bottom) {
        var _this = this;
        var titleView = this.titleView;
        if (titleView) {
            if (majorVersion > 10) {
                action_bar_common_1.View.layoutChild(this, titleView, 0, 0, titleView.getMeasuredWidth(), titleView.getMeasuredHeight());
            }
            else {
                action_bar_common_1.View.layoutChild(this, titleView, 0, 0, right - left, bottom - top);
            }
        }
        this.actionItems.getItems().forEach(function (actionItem) {
            var actionView = actionItem.actionView;
            if (actionView && actionView.ios) {
                var measuredWidth = actionView.getMeasuredWidth();
                var measuredHeight = actionView.getMeasuredHeight();
                action_bar_common_1.View.layoutChild(_this, actionView, 0, 0, measuredWidth, measuredHeight);
            }
        });
        _super.prototype.onLayout.call(this, left, top, right, bottom);
    };
    ActionBar.prototype.layoutNativeView = function (left, top, right, bottom) {
        return;
    };
    Object.defineProperty(ActionBar.prototype, "navBar", {
        get: function () {
            var page = this.page;
            if (!page || !page.frame) {
                return undefined;
            }
            return page.frame.ios.controller.navigationBar;
        },
        enumerable: true,
        configurable: true
    });
    ActionBar.prototype[action_bar_common_1.colorProperty.getDefault] = function () {
        return null;
    };
    ActionBar.prototype[action_bar_common_1.colorProperty.setNative] = function (color) {
        var navBar = this.navBar;
        this.setColor(navBar, color);
    };
    ActionBar.prototype[action_bar_common_1.backgroundColorProperty.getDefault] = function () {
        return null;
    };
    ActionBar.prototype[action_bar_common_1.backgroundColorProperty.setNative] = function (value) {
        var navBar = this.navBar;
        if (navBar) {
            var color = value instanceof action_bar_common_1.Color ? value.ios : value;
            navBar.barTintColor = color;
        }
    };
    ActionBar.prototype[action_bar_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    ActionBar.prototype[action_bar_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    ActionBar.prototype[action_bar_common_1.flatProperty.setNative] = function (value) {
        var navBar = this.navBar;
        if (navBar) {
            this.updateFlatness(navBar);
        }
    };
    ActionBar.prototype[action_bar_common_1.iosIconRenderingModeProperty.getDefault] = function () {
        return "alwaysOriginal";
    };
    ActionBar.prototype[action_bar_common_1.iosIconRenderingModeProperty.setNative] = function (value) {
        this.update();
    };
    return ActionBar;
}(action_bar_common_1.ActionBarBase));
exports.ActionBar = ActionBar;
//# sourceMappingURL=action-bar.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ActivityIndicatorBase = (function (_super) {
    __extends(ActivityIndicatorBase, _super);
    function ActivityIndicatorBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicatorBase = __decorate([
        view_1.CSSType("ActivityIndicator")
    ], ActivityIndicatorBase);
    return ActivityIndicatorBase;
}(view_1.View));
exports.ActivityIndicatorBase = ActivityIndicatorBase;
ActivityIndicatorBase.prototype.recycleNativeView = "auto";
exports.busyProperty = new view_1.Property({ name: "busy", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.busyProperty.register(ActivityIndicatorBase);
//# sourceMappingURL=activity-indicator-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var activity_indicator_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/activity-indicator/activity-indicator-common.js"));
var ActivityIndicator = (function (_super) {
    __extends(ActivityIndicator, _super);
    function ActivityIndicator() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActivityIndicator.prototype.createNativeView = function () {
        var view = UIActivityIndicatorView.alloc().initWithActivityIndicatorStyle(2);
        view.hidesWhenStopped = true;
        return view;
    };
    Object.defineProperty(ActivityIndicator.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.getDefault] = function () {
        if (this.nativeViewProtected.isAnimating) {
            return this.nativeViewProtected.isAnimating();
        }
        else {
            return this.nativeViewProtected.animating;
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.busyProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (value) {
            nativeView.startAnimating();
        }
        else {
            nativeView.stopAnimating();
        }
        if (nativeView.hidesWhenStopped) {
            this.requestLayout();
        }
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.color;
    };
    ActivityIndicator.prototype[activity_indicator_common_1.colorProperty.setNative] = function (value) {
        this.nativeViewProtected.color = value instanceof activity_indicator_common_1.Color ? value.ios : value;
    };
    return ActivityIndicator;
}(activity_indicator_common_1.ActivityIndicatorBase));
exports.ActivityIndicator = ActivityIndicator;
//# sourceMappingURL=activity-indicator.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceCategories = trace_1.categories;
exports.traceType = trace_1.messageType;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Properties;
(function (Properties) {
    Properties.opacity = "opacity";
    Properties.backgroundColor = "backgroundColor";
    Properties.translate = "translate";
    Properties.rotate = "rotate";
    Properties.scale = "scale";
    Properties.height = "height";
    Properties.width = "width";
})(Properties = exports.Properties || (exports.Properties = {}));
var CubicBezierAnimationCurve = (function () {
    function CubicBezierAnimationCurve(x1, y1, x2, y2) {
        this.x1 = x1;
        this.y1 = y1;
        this.x2 = x2;
        this.y2 = y2;
    }
    return CubicBezierAnimationCurve;
}());
exports.CubicBezierAnimationCurve = CubicBezierAnimationCurve;
var AnimationBase = (function () {
    function AnimationBase(animationDefinitions, playSequentially) {
        if (!animationDefinitions || animationDefinitions.length === 0) {
            throw new Error("No animation definitions specified");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Analyzing " + animationDefinitions.length + " animation definitions...", trace_1.categories.Animation);
        }
        this._propertyAnimations = new Array();
        for (var i = 0, length_1 = animationDefinitions.length; i < length_1; i++) {
            if (animationDefinitions[i].curve) {
                animationDefinitions[i].curve = this._resolveAnimationCurve(animationDefinitions[i].curve);
            }
            this._propertyAnimations = this._propertyAnimations.concat(AnimationBase._createPropertyAnimations(animationDefinitions[i]));
        }
        if (this._propertyAnimations.length === 0) {
            throw new Error("Nothing to animate.");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Created " + this._propertyAnimations.length + " individual property animations.", trace_1.categories.Animation);
        }
        this._playSequentially = playSequentially;
    }
    AnimationBase.prototype._rejectAlreadyPlaying = function () {
        var reason = "Animation is already playing.";
        trace_1.write(reason, trace_1.categories.Animation, trace_1.messageType.warn);
        return new Promise(function (resolve, reject) {
            reject(reason);
        });
    };
    AnimationBase.prototype.play = function () {
        var _this_1 = this;
        var animationFinishedPromise = new Promise(function (resolve, reject) {
            _this_1._resolve = resolve;
            _this_1._reject = reject;
        });
        this.fixupAnimationPromise(animationFinishedPromise);
        this._isPlaying = true;
        return animationFinishedPromise;
    };
    AnimationBase.prototype.fixupAnimationPromise = function (promise) {
        var _this = this;
        promise.cancel = function () {
            _this.cancel();
        };
        var _then = promise.then;
        promise.then = function () {
            var r = _then.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
        var _catch = promise.catch;
        promise.catch = function () {
            var r = _catch.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
    };
    AnimationBase.prototype.cancel = function () {
    };
    Object.defineProperty(AnimationBase.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    AnimationBase.prototype._resolveAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._resolve();
    };
    AnimationBase.prototype._rejectAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._reject(new Error("Animation cancelled."));
    };
    AnimationBase._createPropertyAnimations = function (animationDefinition) {
        if (!animationDefinition.target) {
            throw new Error("No animation target specified.");
        }
        for (var item in animationDefinition) {
            if (animationDefinition[item] === undefined) {
                continue;
            }
            if ((item === Properties.opacity ||
                item === Properties.rotate ||
                item === "duration" ||
                item === "delay" ||
                item === "iterations") && typeof animationDefinition[item] !== "number") {
                throw new Error("Property " + item + " must be valid number. Value: " + animationDefinition[item]);
            }
            else if ((item === Properties.scale || item === Properties.translate) &&
                (typeof animationDefinition[item].x !== "number" || typeof animationDefinition[item].y !== "number")) {
                throw new Error("Property " + item + " must be valid Pair. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.backgroundColor && !color_1.Color.isValid(animationDefinition.backgroundColor)) {
                throw new Error("Property " + item + " must be valid color. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.width || item === Properties.height) {
                animationDefinition[item] = style_properties_1.PercentLength.parse(animationDefinition[item]);
            }
        }
        var propertyAnimations = new Array();
        if (animationDefinition.opacity !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.opacity,
                value: animationDefinition.opacity,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.backgroundColor !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.backgroundColor,
                value: typeof animationDefinition.backgroundColor === "string" ?
                    new color_1.Color(animationDefinition.backgroundColor) : animationDefinition.backgroundColor,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.translate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.translate,
                value: animationDefinition.translate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.scale !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.scale,
                value: animationDefinition.scale,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.rotate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.rotate,
                value: animationDefinition.rotate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.height !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.height,
                value: animationDefinition.height,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.width !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.width,
                value: animationDefinition.width,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (propertyAnimations.length === 0) {
            throw new Error("No known animation properties specified");
        }
        return propertyAnimations;
    };
    AnimationBase._getAnimationInfo = function (animation) {
        return JSON.stringify({
            target: animation.target.id,
            property: animation.property,
            value: animation.value,
            duration: animation.duration,
            delay: animation.delay,
            iterations: animation.iterations,
            curve: animation.curve
        });
    };
    return AnimationBase;
}());
exports.AnimationBase = AnimationBase;
//# sourceMappingURL=animation-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var animation_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js"));
var _transform = "_transform";
var _skip = "_skip";
var FLT_MAX = 340282346638528859811704183484516925440.000000;
var AnimationInfo = (function () {
    function AnimationInfo() {
    }
    return AnimationInfo;
}());
var AnimationDelegateImpl = (function (_super) {
    __extends(AnimationDelegateImpl, _super);
    function AnimationDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnimationDelegateImpl.initWithFinishedCallback = function (finishedCallback, propertyAnimation, valueSource) {
        var delegate = AnimationDelegateImpl.new();
        delegate._finishedCallback = finishedCallback;
        delegate._propertyAnimation = propertyAnimation;
        delegate._valueSource = valueSource;
        return delegate;
    };
    AnimationDelegateImpl.prototype.animationDidStart = function (anim) {
        var value = this._propertyAnimation.value;
        var setLocal = this._valueSource === "animation";
        var targetStyle = this._propertyAnimation.target.style;
        this._propertyAnimation.target._suspendPresentationLayerUpdates();
        switch (this._propertyAnimation.property) {
            case animation_common_1.Properties.backgroundColor:
                targetStyle[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.opacity:
                targetStyle[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.rotate:
                targetStyle[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.translate:
                targetStyle[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.x;
                targetStyle[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.y;
                break;
            case animation_common_1.Properties.height:
                targetStyle[setLocal ? style_properties_1.heightProperty.name : style_properties_1.heightProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.width:
                targetStyle[setLocal ? style_properties_1.widthProperty.name : style_properties_1.widthProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.scale:
                targetStyle[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.x === 0 ? 0.001 : value.x;
                targetStyle[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.y === 0 ? 0.001 : value.y;
                break;
            case _transform:
                if (value[animation_common_1.Properties.translate] !== undefined) {
                    targetStyle[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value[animation_common_1.Properties.translate].x;
                    targetStyle[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value[animation_common_1.Properties.translate].y;
                }
                if (value[animation_common_1.Properties.scale] !== undefined) {
                    var x = value[animation_common_1.Properties.scale].x;
                    var y = value[animation_common_1.Properties.scale].y;
                    targetStyle[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = x === 0 ? 0.001 : x;
                    targetStyle[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = y === 0 ? 0.001 : y;
                }
                break;
        }
        this._propertyAnimation.target._resumePresentationLayerUpdates();
    };
    AnimationDelegateImpl.prototype.animationDidStopFinished = function (anim, finished) {
        if (this._finishedCallback) {
            this._finishedCallback(!finished);
        }
        if (finished && this.nextAnimation) {
            this.nextAnimation();
        }
    };
    AnimationDelegateImpl.ObjCProtocols = global.CAAnimationDelegate ? [global.CAAnimationDelegate] : [];
    return AnimationDelegateImpl;
}(NSObject));
function _resolveAnimationCurve(curve) {
    switch (curve) {
        case "easeIn":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseIn);
        case "easeOut":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseOut);
        case "easeInOut":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseInEaseOut);
        case "linear":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionLinear);
        case "spring":
            return curve;
        case "ease":
            return CAMediaTimingFunction.functionWithControlPoints(0.25, 0.1, 0.25, 1.0);
        default:
            if (curve instanceof CAMediaTimingFunction) {
                return curve;
            }
            else if (curve instanceof animation_common_1.CubicBezierAnimationCurve) {
                var animationCurve = curve;
                return CAMediaTimingFunction.functionWithControlPoints(animationCurve.x1, animationCurve.y1, animationCurve.x2, animationCurve.y2);
            }
            else {
                throw new Error("Invalid animation curve: " + curve);
            }
    }
}
exports._resolveAnimationCurve = _resolveAnimationCurve;
var Animation = (function (_super) {
    __extends(Animation, _super);
    function Animation(animationDefinitions, playSequentially) {
        var _this = _super.call(this, animationDefinitions, playSequentially) || this;
        _this._valueSource = "animation";
        if (animationDefinitions.length > 0 && animationDefinitions[0].valueSource !== undefined) {
            _this._valueSource = animationDefinitions[0].valueSource;
        }
        if (!playSequentially) {
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Non-merged Property Animations: " + _this._propertyAnimations.length, animation_common_1.traceCategories.Animation);
            }
            _this._mergedPropertyAnimations = Animation._mergeAffineTransformAnimations(_this._propertyAnimations);
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Merged Property Animations: " + _this._mergedPropertyAnimations.length, animation_common_1.traceCategories.Animation);
            }
        }
        else {
            _this._mergedPropertyAnimations = _this._propertyAnimations;
        }
        var that = _this;
        var animationFinishedCallback = function (cancelled) {
            if (that._playSequentially) {
                if (cancelled) {
                    that._rejectAnimationFinishedPromise();
                }
                else {
                    that._resolveAnimationFinishedPromise();
                }
            }
            else {
                if (cancelled) {
                    that._cancelledAnimations++;
                }
                else {
                    that._finishedAnimations++;
                }
                if (that._cancelledAnimations > 0 && (that._cancelledAnimations + that._finishedAnimations) === that._mergedPropertyAnimations.length) {
                    if (animation_common_1.traceEnabled()) {
                        animation_common_1.traceWrite(that._cancelledAnimations + " animations cancelled.", animation_common_1.traceCategories.Animation);
                    }
                    that._rejectAnimationFinishedPromise();
                }
                else if (that._finishedAnimations === that._mergedPropertyAnimations.length) {
                    if (animation_common_1.traceEnabled()) {
                        animation_common_1.traceWrite(that._finishedAnimations + " animations finished.", animation_common_1.traceCategories.Animation);
                    }
                    that._resolveAnimationFinishedPromise();
                }
            }
        };
        _this._iOSAnimationFunction = Animation._createiOSAnimationFunction(_this._mergedPropertyAnimations, 0, _this._playSequentially, _this._valueSource, animationFinishedCallback);
        return _this;
    }
    Animation.prototype.play = function () {
        if (this.isPlaying) {
            return this._rejectAlreadyPlaying();
        }
        var animationFinishedPromise = _super.prototype.play.call(this);
        this._finishedAnimations = 0;
        this._cancelledAnimations = 0;
        this._iOSAnimationFunction();
        return animationFinishedPromise;
    };
    Animation.prototype.cancel = function () {
        if (!this.isPlaying) {
            animation_common_1.traceWrite("Animation is not currently playing.", animation_common_1.traceCategories.Animation, animation_common_1.traceType.warn);
            return;
        }
        var i = 0;
        var length = this._mergedPropertyAnimations.length;
        for (; i < length; i++) {
            var propertyAnimation = this._mergedPropertyAnimations[i];
            propertyAnimation.target.nativeViewProtected.layer.removeAllAnimations();
            if (propertyAnimation._propertyResetCallback) {
                propertyAnimation._propertyResetCallback(propertyAnimation._originalValue, this._valueSource);
            }
        }
    };
    Animation.prototype._resolveAnimationCurve = function (curve) {
        return _resolveAnimationCurve(curve);
    };
    Animation._createiOSAnimationFunction = function (propertyAnimations, index, playSequentially, valueSource, finishedCallback) {
        return function (cancelled) {
            if (cancelled && finishedCallback) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Animation " + (index - 1).toString() + " was cancelled. Will skip the rest of animations and call finishedCallback(true).", animation_common_1.traceCategories.Animation);
                }
                finishedCallback(cancelled);
                return;
            }
            var animation = propertyAnimations[index];
            var args = Animation._getNativeAnimationArguments(animation, valueSource);
            if (animation.curve === "spring") {
                Animation._createNativeSpringAnimation(propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback);
            }
            else {
                Animation._createNativeAnimation(propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback);
            }
        };
    };
    Animation._getNativeAnimationArguments = function (animation, valueSource) {
        var nativeView = animation.target.nativeViewProtected;
        var propertyNameToAnimate = animation.property;
        var toValue = animation.value;
        var fromValue;
        var parent = animation.target.parent;
        var screenScale = platform_1.screen.mainScreen.scale;
        var tempRotate = (animation.target.rotate || 0) * Math.PI / 180;
        var abs;
        var setLocal = valueSource === "animation";
        switch (animation.property) {
            case animation_common_1.Properties.backgroundColor:
                animation._originalValue = animation.target.backgroundColor;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = value;
                };
                fromValue = nativeView.layer.backgroundColor;
                if (nativeView instanceof UILabel) {
                    nativeView.setValueForKey(UIColor.clearColor, "backgroundColor");
                }
                toValue = toValue.CGColor;
                break;
            case animation_common_1.Properties.opacity:
                animation._originalValue = animation.target.opacity;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = value;
                };
                fromValue = nativeView.layer.opacity;
                break;
            case animation_common_1.Properties.rotate:
                animation._originalValue = animation.target.rotate !== undefined ? animation.target.rotate : 0;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = value;
                };
                propertyNameToAnimate = "transform.rotation";
                fromValue = nativeView.layer.valueForKeyPath("transform.rotation");
                if (animation.target.rotate !== undefined && animation.target.rotate !== 0 && Math.floor(toValue / 360) - toValue / 360 === 0) {
                    fromValue = animation.target.rotate * Math.PI / 180;
                }
                toValue = toValue * Math.PI / 180;
                abs = fabs(fromValue - toValue);
                if (abs < 0.001 && fromValue !== tempRotate) {
                    fromValue = tempRotate;
                }
                break;
            case animation_common_1.Properties.translate:
                animation._originalValue = { x: animation.target.translateX, y: animation.target.translateY };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.x;
                    animation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.y;
                };
                propertyNameToAnimate = "transform";
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                toValue = NSValue.valueWithCATransform3D(CATransform3DTranslate(nativeView.layer.transform, toValue.x, toValue.y, 0));
                break;
            case animation_common_1.Properties.scale:
                if (toValue.x === 0) {
                    toValue.x = 0.001;
                }
                if (toValue.y === 0) {
                    toValue.y = 0.001;
                }
                animation._originalValue = { x: animation.target.scaleX, y: animation.target.scaleY };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.x;
                    animation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.y;
                };
                propertyNameToAnimate = "transform";
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                toValue = NSValue.valueWithCATransform3D(CATransform3DScale(nativeView.layer.transform, toValue.x, toValue.y, 1));
                break;
            case _transform:
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                animation._originalValue = {
                    xs: animation.target.scaleX, ys: animation.target.scaleY,
                    xt: animation.target.translateX, yt: animation.target.translateY
                };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.xt;
                    animation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.yt;
                    animation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.xs;
                    animation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.ys;
                };
                propertyNameToAnimate = "transform";
                toValue = NSValue.valueWithCATransform3D(Animation._createNativeAffineTransform(animation));
                break;
            case animation_common_1.Properties.width:
            case animation_common_1.Properties.height:
                var direction = animation.property;
                var isHeight_1 = direction === "height";
                propertyNameToAnimate = "bounds";
                if (!parent) {
                    throw new Error("cannot animate " + direction + " on root view");
                }
                var parentExtent = isHeight_1 ? parent.getMeasuredHeight() : parent.getMeasuredWidth();
                var asNumber = style_properties_1.PercentLength.toDevicePixels(style_properties_1.PercentLength.parse(toValue), parentExtent, parentExtent) / screenScale;
                var currentBounds = nativeView.layer.bounds;
                var extentX = isHeight_1 ? currentBounds.size.width : asNumber;
                var extentY = isHeight_1 ? asNumber : currentBounds.size.height;
                fromValue = NSValue.valueWithCGRect(currentBounds);
                toValue = NSValue.valueWithCGRect(CGRectMake(currentBounds.origin.x, currentBounds.origin.y, extentX, extentY));
                animation._originalValue = animation.target.height;
                animation._propertyResetCallback = function (value, valueSource) {
                    var prop = isHeight_1 ? style_properties_1.heightProperty : style_properties_1.widthProperty;
                    animation.target.style[setLocal ? prop.name : prop.keyframe] = value;
                };
                break;
            default:
                throw new Error("Animating property '" + animation.property + "' is unsupported");
        }
        var duration = 0.3;
        if (animation.duration !== undefined) {
            duration = animation.duration / 1000.0;
        }
        var delay = undefined;
        if (animation.delay) {
            delay = animation.delay / 1000.0;
        }
        var repeatCount = undefined;
        if (animation.iterations !== undefined) {
            if (animation.iterations === Number.POSITIVE_INFINITY) {
                repeatCount = FLT_MAX;
            }
            else {
                repeatCount = animation.iterations;
            }
        }
        return {
            propertyNameToAnimate: propertyNameToAnimate,
            fromValue: fromValue,
            toValue: toValue,
            duration: duration,
            repeatCount: repeatCount,
            delay: delay
        };
    };
    Animation._createNativeAnimation = function (propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback) {
        var nativeView = animation.target.nativeViewProtected;
        var nativeAnimation = CABasicAnimation.animationWithKeyPath(args.propertyNameToAnimate);
        nativeAnimation.fromValue = args.fromValue;
        nativeAnimation.toValue = args.toValue;
        nativeAnimation.duration = args.duration;
        if (args.repeatCount !== undefined) {
            nativeAnimation.repeatCount = args.repeatCount;
        }
        if (args.delay !== undefined) {
            nativeAnimation.beginTime = CACurrentMediaTime() + args.delay;
        }
        if (animation.curve !== undefined) {
            nativeAnimation.timingFunction = animation.curve;
        }
        var animationDelegate = AnimationDelegateImpl.initWithFinishedCallback(finishedCallback, animation, valueSource);
        nativeAnimation.setValueForKey(animationDelegate, "delegate");
        nativeView.layer.addAnimationForKey(nativeAnimation, args.propertyNameToAnimate);
        var callback = undefined;
        if (index + 1 < propertyAnimations.length) {
            callback = Animation._createiOSAnimationFunction(propertyAnimations, index + 1, playSequentially, valueSource, finishedCallback);
            if (!playSequentially) {
                callback();
            }
            else {
                animationDelegate.nextAnimation = callback;
            }
        }
    };
    Animation._createNativeSpringAnimation = function (propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback) {
        var nativeView = animation.target.nativeViewProtected;
        var callback = undefined;
        var nextAnimation;
        if (index + 1 < propertyAnimations.length) {
            callback = Animation._createiOSAnimationFunction(propertyAnimations, index + 1, playSequentially, valueSource, finishedCallback);
            if (!playSequentially) {
                callback();
            }
            else {
                nextAnimation = callback;
            }
        }
        var delay = 0;
        if (args.delay) {
            delay = args.delay;
        }
        UIView.animateWithDurationDelayUsingSpringWithDampingInitialSpringVelocityOptionsAnimationsCompletion(args.duration, delay, 0.2, 0, 196608, function () {
            if (args.repeatCount !== undefined) {
                UIView.setAnimationRepeatCount(args.repeatCount);
            }
            switch (animation.property) {
                case animation_common_1.Properties.backgroundColor:
                    animation.target.backgroundColor = args.toValue;
                    break;
                case animation_common_1.Properties.opacity:
                    animation.target.opacity = args.toValue;
                    break;
                case animation_common_1.Properties.height:
                case animation_common_1.Properties.width:
                    animation._originalValue = animation.target[animation.property];
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    animation._propertyResetCallback = function (value) {
                        animation.target[animation.property] = value;
                    };
                    break;
                case animation_common_1.Properties.rotate:
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    break;
                case _transform:
                    animation._originalValue = nativeView.layer.transform;
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    animation._propertyResetCallback = function (value) {
                        nativeView.layer.transform = value;
                    };
                    break;
            }
        }, function (animationDidFinish) {
            if (animationDidFinish) {
                if (animation.property === _transform) {
                    if (animation.value[animation_common_1.Properties.translate] !== undefined) {
                        animation.target.translateX = animation.value[animation_common_1.Properties.translate].x;
                        animation.target.translateY = animation.value[animation_common_1.Properties.translate].y;
                    }
                    if (animation.value[animation_common_1.Properties.scale] !== undefined) {
                        animation.target.scaleX = animation.value[animation_common_1.Properties.scale].x;
                        animation.target.scaleY = animation.value[animation_common_1.Properties.scale].y;
                    }
                }
            }
            else {
                if (animation._propertyResetCallback) {
                    animation._propertyResetCallback(animation._originalValue);
                }
            }
            if (finishedCallback) {
                var cancelled = !animationDidFinish;
                finishedCallback(cancelled);
            }
            if (animationDidFinish && nextAnimation) {
                nextAnimation();
            }
        });
    };
    Animation._createNativeAffineTransform = function (animation) {
        var value = animation.value;
        var result = CATransform3DIdentity;
        if (value[animation_common_1.Properties.translate] !== undefined) {
            var x = value[animation_common_1.Properties.translate].x;
            var y = value[animation_common_1.Properties.translate].y;
            result = CATransform3DTranslate(result, x, y, 0);
        }
        if (value[animation_common_1.Properties.scale] !== undefined) {
            var x = value[animation_common_1.Properties.scale].x;
            var y = value[animation_common_1.Properties.scale].y;
            result = CATransform3DScale(result, x === 0 ? 0.001 : x, y === 0 ? 0.001 : y, 1);
        }
        return result;
    };
    Animation._isAffineTransform = function (property) {
        return property === _transform
            || property === animation_common_1.Properties.translate
            || property === animation_common_1.Properties.scale;
    };
    Animation._canBeMerged = function (animation1, animation2) {
        var result = Animation._isAffineTransform(animation1.property) &&
            Animation._isAffineTransform(animation2.property) &&
            animation1.target === animation2.target &&
            animation1.duration === animation2.duration &&
            animation1.delay === animation2.delay &&
            animation1.iterations === animation2.iterations &&
            animation1.curve === animation2.curve;
        return result;
    };
    Animation._mergeAffineTransformAnimations = function (propertyAnimations) {
        var result = new Array();
        var i = 0;
        var j;
        var length = propertyAnimations.length;
        for (; i < length; i++) {
            if (propertyAnimations[i][_skip]) {
                continue;
            }
            if (!Animation._isAffineTransform(propertyAnimations[i].property)) {
                result.push(propertyAnimations[i]);
            }
            else {
                var newTransformAnimation = {
                    target: propertyAnimations[i].target,
                    property: _transform,
                    value: {},
                    duration: propertyAnimations[i].duration,
                    delay: propertyAnimations[i].delay,
                    iterations: propertyAnimations[i].iterations,
                    curve: propertyAnimations[i].curve
                };
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Curve: " + propertyAnimations[i].curve, animation_common_1.traceCategories.Animation);
                }
                newTransformAnimation.value[propertyAnimations[i].property] = propertyAnimations[i].value;
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Created new transform animation: " + Animation._getAnimationInfo(newTransformAnimation), animation_common_1.traceCategories.Animation);
                }
                j = i + 1;
                if (j < length) {
                    for (; j < length; j++) {
                        if (Animation._canBeMerged(propertyAnimations[i], propertyAnimations[j])) {
                            if (animation_common_1.traceEnabled()) {
                                animation_common_1.traceWrite("Merging animations: " + Animation._getAnimationInfo(newTransformAnimation) + " + " + Animation._getAnimationInfo(propertyAnimations[j]) + ";", animation_common_1.traceCategories.Animation);
                            }
                            newTransformAnimation.value[propertyAnimations[j].property] = propertyAnimations[j].value;
                            propertyAnimations[j][_skip] = true;
                        }
                    }
                }
                result.push(newTransformAnimation);
            }
        }
        return result;
    };
    return Animation;
}(animation_common_1.AnimationBase));
exports.Animation = Animation;
function _getTransformMismatchErrorMessage(view) {
    var result = CGAffineTransformIdentity;
    var tx = view.translateX;
    var ty = view.translateY;
    result = CGAffineTransformTranslate(result, tx, ty);
    result = CGAffineTransformRotate(result, (view.rotate || 0) * Math.PI / 180);
    result = CGAffineTransformScale(result, view.scaleX || 1, view.scaleY || 1);
    var viewTransform = NSStringFromCGAffineTransform(result);
    var nativeTransform = NSStringFromCGAffineTransform(view.nativeViewProtected.transform);
    if (viewTransform !== nativeTransform) {
        return "View and Native transforms do not match. View: " + viewTransform + "; Native: " + nativeTransform;
    }
    return undefined;
}
exports._getTransformMismatchErrorMessage = _getTransformMismatchErrorMessage;
//# sourceMappingURL=animation.ios.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/keyframe-animation.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Keyframes = (function () {
    function Keyframes() {
    }
    return Keyframes;
}());
exports.Keyframes = Keyframes;
var UnparsedKeyframe = (function () {
    function UnparsedKeyframe() {
    }
    return UnparsedKeyframe;
}());
exports.UnparsedKeyframe = UnparsedKeyframe;
var KeyframeDeclaration = (function () {
    function KeyframeDeclaration() {
    }
    return KeyframeDeclaration;
}());
exports.KeyframeDeclaration = KeyframeDeclaration;
var KeyframeInfo = (function () {
    function KeyframeInfo() {
        this.curve = enums_1.AnimationCurve.ease;
    }
    return KeyframeInfo;
}());
exports.KeyframeInfo = KeyframeInfo;
var KeyframeAnimationInfo = (function () {
    function KeyframeAnimationInfo() {
        this.name = "";
        this.duration = 0.3;
        this.delay = 0;
        this.iterations = 1;
        this.curve = "ease";
        this.isForwards = false;
        this.isReverse = false;
    }
    return KeyframeAnimationInfo;
}());
exports.KeyframeAnimationInfo = KeyframeAnimationInfo;
var KeyframeAnimation = (function () {
    function KeyframeAnimation() {
        this.delay = 0;
        this.iterations = 1;
    }
    KeyframeAnimation.keyframeAnimationFromInfo = function (info) {
        var length = info.keyframes.length;
        var animations = new Array();
        var startDuration = 0;
        if (info.isReverse) {
            for (var index_1 = length - 1; index_1 >= 0; index_1--) {
                var keyframe = info.keyframes[index_1];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
        }
        else {
            for (var index_2 = 0; index_2 < length; index_2++) {
                var keyframe = info.keyframes[index_2];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
            for (var index_3 = length - 1; index_3 > 0; index_3--) {
                var a1 = animations[index_3];
                var a2 = animations[index_3 - 1];
                if (a2["curve"] !== undefined) {
                    a1["curve"] = a2["curve"];
                    a2["curve"] = undefined;
                }
            }
        }
        animations.map(function (a) { return a["curve"] ? a : Object.assign(a, { curve: info.curve }); });
        var animation = new KeyframeAnimation();
        animation.delay = info.delay;
        animation.iterations = info.iterations;
        animation.animations = animations;
        animation._isForwards = info.isForwards;
        return animation;
    };
    KeyframeAnimation.parseKeyframe = function (info, keyframe, animations, startDuration) {
        var animation = {};
        for (var _i = 0, _a = keyframe.declarations; _i < _a.length; _i++) {
            var declaration = _a[_i];
            animation[declaration.property] = declaration.value;
        }
        var duration = keyframe.duration;
        if (duration === 0) {
            duration = 0.01;
        }
        else {
            duration = (info.duration * duration) - startDuration;
            startDuration += duration;
        }
        animation.duration = info.isReverse ? info.duration - duration : duration;
        animation.curve = keyframe.curve;
        animation.forceLayer = true;
        animation.valueSource = "keyframe";
        animations.push(animation);
        return startDuration;
    };
    Object.defineProperty(KeyframeAnimation.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    KeyframeAnimation.prototype.cancel = function () {
        if (!this.isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        this._isPlaying = false;
        for (var i = this._nativeAnimations.length - 1; i >= 0; i--) {
            var animation = this._nativeAnimations[i];
            if (animation.isPlaying) {
                animation.cancel();
            }
        }
        if (this._nativeAnimations.length > 0) {
            var animation = this._nativeAnimations[0];
            this._resetAnimationValues(this._target, animation);
        }
        this._resetAnimations();
    };
    KeyframeAnimation.prototype.play = function (view) {
        var _this = this;
        if (this._isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return new Promise(function (resolve) {
                resolve();
            });
        }
        var animationFinishedPromise = new Promise(function (resolve) {
            _this._resolve = resolve;
        });
        this._isPlaying = true;
        this._nativeAnimations = new Array();
        this._target = view;
        if (this.delay !== 0) {
            setTimeout(function () { return _this.animate(view, 0, _this.iterations); }, this.delay);
        }
        else {
            this.animate(view, 0, this.iterations);
        }
        return animationFinishedPromise;
    };
    KeyframeAnimation.prototype.animate = function (view, index, iterations) {
        var _this = this;
        if (!this._isPlaying) {
            return;
        }
        if (index === 0) {
            var animation = this.animations[0];
            if ("backgroundColor" in animation) {
                view.style[style_properties_1.backgroundColorProperty.keyframe] = animation.backgroundColor;
            }
            if ("scale" in animation) {
                view.style[style_properties_1.scaleXProperty.keyframe] = animation.scale.x;
                view.style[style_properties_1.scaleYProperty.keyframe] = animation.scale.y;
            }
            if ("translate" in animation) {
                view.style[style_properties_1.translateXProperty.keyframe] = animation.translate.x;
                view.style[style_properties_1.translateYProperty.keyframe] = animation.translate.y;
            }
            if ("rotate" in animation) {
                view.style[style_properties_1.rotateProperty.keyframe] = animation.rotate;
            }
            if ("opacity" in animation) {
                view.style[style_properties_1.opacityProperty.keyframe] = animation.opacity;
            }
            if ("height" in animation) {
                view.style[style_properties_1.heightProperty.keyframe] = animation.height;
            }
            if ("width" in animation) {
                view.style[style_properties_1.widthProperty.keyframe] = animation.width;
            }
            setTimeout(function () { return _this.animate(view, 1, iterations); }, 1);
        }
        else if (index < 0 || index >= this.animations.length) {
            iterations -= 1;
            if (iterations > 0) {
                this.animate(view, 0, iterations);
            }
            else {
                if (this._isForwards === false) {
                    var animation = this.animations[this.animations.length - 1];
                    this._resetAnimationValues(view, animation);
                }
                this._resolveAnimationFinishedPromise();
            }
        }
        else {
            var animation = void 0;
            var cachedAnimation = this._nativeAnimations[index - 1];
            if (cachedAnimation) {
                animation = cachedAnimation;
            }
            else {
                var animationDef = this.animations[index];
                animationDef.target = view;
                animation = new animation_1.Animation([animationDef]);
                this._nativeAnimations.push(animation);
            }
            var isLastIteration = iterations - 1 <= 0;
            animation.play(isLastIteration).then(function () {
                _this.animate(view, index + 1, iterations);
            }, function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            }).catch(function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            });
        }
    };
    KeyframeAnimation.prototype._resolveAnimationFinishedPromise = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
        this._resolve();
    };
    KeyframeAnimation.prototype._resetAnimations = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
    };
    KeyframeAnimation.prototype._resetAnimationValues = function (view, animation) {
        if ("backgroundColor" in animation) {
            view.style[style_properties_1.backgroundColorProperty.keyframe] = properties_1.unsetValue;
        }
        if ("scale" in animation) {
            view.style[style_properties_1.scaleXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.scaleYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("translate" in animation) {
            view.style[style_properties_1.translateXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.translateYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("rotate" in animation) {
            view.style[style_properties_1.rotateProperty.keyframe] = properties_1.unsetValue;
        }
        if ("opacity" in animation) {
            view.style[style_properties_1.opacityProperty.keyframe] = properties_1.unsetValue;
        }
        if ("height" in animation) {
            view.style[style_properties_1.heightProperty.keyframe] = properties_1.unsetValue;
        }
        if ("width" in animation) {
            view.style[style_properties_1.widthProperty.keyframe] = properties_1.unsetValue;
        }
    };
    return KeyframeAnimation;
}());
exports.KeyframeAnimation = KeyframeAnimation;
//# sourceMappingURL=keyframe-animation.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/border/border.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var Border = (function (_super) {
    __extends(Border, _super);
    function Border() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Border.prototype, "cornerRadius", {
        get: function () {
            if (typeof this.borderRadius === "number") {
                return this.borderRadius;
            }
            return 0;
        },
        set: function (value) {
            this.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Border.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = content_view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = content_view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = content_view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = content_view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var result = content_view_1.View.measureChild(this, this.layoutView, content_view_1.layout.makeMeasureSpec(width - horizontalBorderLength, widthMode), content_view_1.layout.makeMeasureSpec(height - verticalBorderLength, heightMode));
        var widthAndState = content_view_1.View.resolveSizeAndState(result.measuredWidth + horizontalBorderLength, width, widthMode, 0);
        var heightAndState = content_view_1.View.resolveSizeAndState(result.measuredHeight + verticalBorderLength, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Border.prototype.onLayout = function (left, top, right, bottom) {
        var horizontalBorderLength = this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalBorderLength = this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        content_view_1.View.layoutChild(this, this.layoutView, this.effectiveBorderLeftWidth, this.effectiveBorderTopWidth, right - left - horizontalBorderLength, bottom - top - verticalBorderLength);
    };
    Border = __decorate([
        Deprecated,
        content_view_1.CSSType("Border")
    ], Border);
    return Border;
}(content_view_1.ContentView));
exports.Border = Border;
Border.prototype.recycleNativeView = "auto";
//# sourceMappingURL=border.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/bottom-navigation/bottom-navigation.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_strip_item_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js");
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
var majorVersion = utils_1.ios.MajorVersion;
var isPhone = platform_1.device.deviceType === "Phone";
var UITabBarControllerImpl = (function (_super) {
    __extends(UITabBarControllerImpl, _super);
    function UITabBarControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITabBarControllerImpl.initWithOwner = function (owner) {
        var handler = UITabBarControllerImpl.new();
        handler._owner = owner;
        return handler;
    };
    UITabBarControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        this.extendedLayoutIncludesOpaqueBars = true;
        view_1.ios.updateAutoAdjustScrollInsets(this, owner);
        if (!owner.parent) {
            owner.callLoaded();
        }
    };
    UITabBarControllerImpl.prototype.viewDidDisappear = function (animated) {
        _super.prototype.viewDidDisappear.call(this, animated);
        var owner = this._owner.get();
        if (owner && !owner.parent && owner.isLoaded && !this.presentedViewController) {
            owner.callUnloaded();
        }
    };
    UITabBarControllerImpl.prototype.viewWillTransitionToSizeWithTransitionCoordinator = function (size, coordinator) {
        var _this = this;
        _super.prototype.viewWillTransitionToSizeWithTransitionCoordinator.call(this, size, coordinator);
        UIViewControllerTransitionCoordinator.prototype.animateAlongsideTransitionCompletion
            .call(coordinator, null, function () {
            var owner = _this._owner.get();
            if (owner && owner.items) {
            }
        });
    };
    return UITabBarControllerImpl;
}(UITabBarController));
var UITabBarControllerDelegateImpl = (function (_super) {
    __extends(UITabBarControllerDelegateImpl, _super);
    function UITabBarControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITabBarControllerDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITabBarControllerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UITabBarControllerDelegateImpl.prototype.tabBarControllerShouldSelectViewController = function (tabBarController, viewController) {
        var owner = this._owner.get();
        if (owner) {
            var backToMoreWillBeVisible = false;
            owner._handleTwoNavigationBars(backToMoreWillBeVisible);
            if (tabBarController.viewControllers) {
                var position = tabBarController.viewControllers.indexOfObject(viewController);
                if (position !== NSNotFound) {
                    var tabStripItems = owner.tabStrip && owner.tabStrip.items;
                    if (tabStripItems && tabStripItems[position]) {
                        tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.tapEvent);
                    }
                }
            }
        }
        if (tabBarController.selectedViewController === viewController) {
            return false;
        }
        tabBarController._willSelectViewController = viewController;
        return true;
    };
    UITabBarControllerDelegateImpl.prototype.tabBarControllerDidSelectViewController = function (tabBarController, viewController) {
        var owner = this._owner.get();
        if (owner) {
            if (tabBarController.viewControllers) {
                var position = tabBarController.viewControllers.indexOfObject(viewController);
                if (position !== NSNotFound) {
                    var prevPosition = owner.selectedIndex;
                    var tabStripItems = owner.tabStrip && owner.tabStrip.items;
                    if (tabStripItems) {
                        if (tabStripItems[position]) {
                            tabStripItems[position]._emit(tab_strip_item_1.TabStripItem.selectEvent);
                        }
                        if (tabStripItems[prevPosition]) {
                            tabStripItems[prevPosition]._emit(tab_strip_item_1.TabStripItem.unselectEvent);
                        }
                    }
                }
            }
            owner._onViewControllerShown(viewController);
        }
        tabBarController._willSelectViewController = undefined;
    };
    UITabBarControllerDelegateImpl.ObjCProtocols = [UITabBarControllerDelegate];
    return UITabBarControllerDelegateImpl;
}(NSObject));
var UINavigationControllerDelegateImpl = (function (_super) {
    __extends(UINavigationControllerDelegateImpl, _super);
    function UINavigationControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerDelegateImpl.initWithOwner = function (owner) {
        var delegate = UINavigationControllerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UINavigationControllerDelegateImpl.prototype.navigationControllerWillShowViewControllerAnimated = function (navigationController, viewController, animated) {
        var owner = this._owner.get();
        if (owner) {
            var backToMoreWillBeVisible = owner._ios.viewControllers.containsObject(viewController);
            owner._handleTwoNavigationBars(backToMoreWillBeVisible);
        }
    };
    UINavigationControllerDelegateImpl.prototype.navigationControllerDidShowViewControllerAnimated = function (navigationController, viewController, animated) {
        navigationController.navigationBar.topItem.rightBarButtonItem = null;
        var owner = this._owner.get();
        if (owner) {
            owner._onViewControllerShown(viewController);
        }
    };
    UINavigationControllerDelegateImpl.ObjCProtocols = [UINavigationControllerDelegate];
    return UINavigationControllerDelegateImpl;
}(NSObject));
function updateTitleAndIconPositions(tabStripItem, tabBarItem, controller) {
    if (!tabStripItem || !tabBarItem) {
        return;
    }
    var orientation = controller.interfaceOrientation;
    var isPortrait = orientation !== 4 && orientation !== 3;
    var isIconAboveTitle = (majorVersion < 11) || (isPhone && isPortrait);
    if (!tabStripItem.iconSource) {
        if (isIconAboveTitle) {
            tabBarItem.titlePositionAdjustment = { horizontal: 0, vertical: -20 };
        }
        else {
            tabBarItem.titlePositionAdjustment = { horizontal: 0, vertical: 0 };
        }
    }
    if (!tabStripItem.title) {
        if (isIconAboveTitle) {
            tabBarItem.imageInsets = new UIEdgeInsets({ top: 6, left: 0, bottom: -6, right: 0 });
        }
        else {
            tabBarItem.imageInsets = new UIEdgeInsets({ top: 0, left: 0, bottom: 0, right: 0 });
        }
    }
}
var BottomNavigation = (function (_super) {
    __extends(BottomNavigation, _super);
    function BottomNavigation() {
        var _this = _super.call(this) || this;
        _this._iconsCache = {};
        _this.viewController = _this._ios = UITabBarControllerImpl.initWithOwner(new WeakRef(_this));
        _this.nativeViewProtected = _this._ios.view;
        return _this;
    }
    BottomNavigation.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UITabBarControllerDelegateImpl.initWithOwner(new WeakRef(this));
        this._moreNavigationControllerDelegate = UINavigationControllerDelegateImpl.initWithOwner(new WeakRef(this));
    };
    BottomNavigation.prototype.disposeNativeView = function () {
        this._delegate = null;
        this._moreNavigationControllerDelegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    BottomNavigation.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        var selectedIndex = this.selectedIndex;
        var selectedView = this.items && this.items[selectedIndex] && this.items[selectedIndex].view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        this._ios.delegate = this._delegate;
    };
    BottomNavigation.prototype.onUnloaded = function () {
        this._ios.delegate = null;
        this._ios.moreNavigationController.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(BottomNavigation.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    BottomNavigation.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    BottomNavigation.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    BottomNavigation.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        var items = this.items;
        if (!items) {
            return;
        }
        var oldItem = items[oldIndex];
        if (oldItem) {
            oldItem.canBeLoaded = false;
            oldItem.unloadView(oldItem.view);
        }
        var newItem = items[newIndex];
        if (newItem && this.isLoaded) {
            var selectedView = items[newIndex].view;
            if (selectedView instanceof frame_1.Frame) {
                selectedView._pushInFrameStackRecursive();
            }
            newItem.canBeLoaded = true;
            newItem.loadView(newItem.view);
        }
        _super.prototype.onSelectedIndexChanged.call(this, oldIndex, newIndex);
    };
    BottomNavigation.prototype.getTabBarBackgroundColor = function () {
        return this._ios.tabBar.barTintColor;
    };
    BottomNavigation.prototype.setTabBarBackgroundColor = function (value) {
        this._ios.tabBar.barTintColor = value instanceof color_1.Color ? value.ios : value;
    };
    BottomNavigation.prototype.getTabBarColor = function () {
        return this._ios.tabBar.tintColor;
    };
    BottomNavigation.prototype.setTabBarColor = function (value) {
        this._ios.tabBar.tintColor = value instanceof color_1.Color ? value.ios : value;
        if (!this.tabStrip) {
            return;
        }
        var states = getTitleAttributesForStates(this.tabStrip);
        this.tabStrip.items.forEach(function (tabStripItem) {
            applyStatesToItem(tabStripItem.nativeView, states);
        });
    };
    BottomNavigation.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
        if (!this.tabStrip) {
            return;
        }
        var bgView = tabStripItem.bgView;
        if (!bgView) {
            var index_1 = tabStripItem.index;
            var width = this.tabStrip.nativeView.frame.size.width / this.tabStrip.items.length;
            var frame = CGRectMake(width * index_1, 0, width, this.tabStrip.nativeView.frame.size.width);
            bgView = UIView.alloc().initWithFrame(frame);
            this.tabStrip.nativeView.insertSubviewAtIndex(bgView, 0);
            tabStripItem.bgView = bgView;
        }
        bgView.backgroundColor = value instanceof color_1.Color ? value.ios : value;
    };
    BottomNavigation.prototype.getTabBarItemColor = function (tabStripItem) {
        return this._ios.tabBar.tintColor;
    };
    BottomNavigation.prototype.setTabBarItemColor = function (tabStripItem, value) {
        var states = getTitleAttributesForStates(tabStripItem);
        applyStatesToItem(tabStripItem.nativeView, states);
    };
    BottomNavigation.prototype.getTabBarItemFontSize = function (tabStripItem) {
        return null;
    };
    BottomNavigation.prototype.setTabBarItemFontSize = function (tabStripItem, value) {
        var states = getTitleAttributesForStates(tabStripItem);
        applyStatesToItem(tabStripItem.nativeView, states);
    };
    BottomNavigation.prototype.getTabBarItemFontInternal = function (tabStripItem) {
        return null;
    };
    BottomNavigation.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
        var states = getTitleAttributesForStates(tabStripItem);
        applyStatesToItem(tabStripItem.nativeView, states);
    };
    BottomNavigation.prototype.getTabBarItemTextTransform = function (tabStripItem) {
        return null;
    };
    BottomNavigation.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
        var title = text_base_1.getTransformedText(tabStripItem.title, value);
        tabStripItem.nativeView.title = title;
    };
    BottomNavigation.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = utils_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = utils_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = utils_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = utils_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = view_1.View.resolveSizeAndState(width, width, widthMode, 0);
        var heightAndState = view_1.View.resolveSizeAndState(height, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    BottomNavigation.prototype._onViewControllerShown = function (viewController) {
        if (this._ios.viewControllers && this._ios.viewControllers.containsObject(viewController)) {
            this.selectedIndex = this._ios.viewControllers.indexOfObject(viewController);
        }
        else {
        }
    };
    BottomNavigation.prototype._handleTwoNavigationBars = function (backToMoreWillBeVisible) {
        var page = this.page || this._selectedView.page || this._selectedView.currentPage;
        if (!page || !page.frame) {
            return;
        }
        var actionBarVisible = page.frame._getNavBarVisible(page);
        if (backToMoreWillBeVisible && actionBarVisible) {
            page.frame.ios._disableNavBarAnimation = true;
            page.actionBarHidden = true;
            page.frame.ios._disableNavBarAnimation = false;
            this._actionBarHiddenByTabView = true;
            return;
        }
        if (!backToMoreWillBeVisible && this._actionBarHiddenByTabView) {
            page.frame.ios._disableNavBarAnimation = true;
            page.actionBarHidden = false;
            page.frame.ios._disableNavBarAnimation = false;
            this._actionBarHiddenByTabView = undefined;
            return;
        }
    };
    BottomNavigation.prototype.getViewController = function (item) {
        var newController = item.view ? item.view.viewController : null;
        if (newController) {
            item.setViewController(newController, newController.view);
            return newController;
        }
        if (item.view.ios instanceof UIViewController) {
            newController = item.view.ios;
            item.setViewController(newController, newController.view);
        }
        else if (item.view.ios && item.view.ios.controller instanceof UIViewController) {
            newController = item.view.ios.controller;
            item.setViewController(newController, newController.view);
        }
        else {
            newController = view_1.ios.UILayoutViewController.initWithOwner(new WeakRef(item.view));
            newController.view.addSubview(item.view.nativeViewProtected);
            item.view.viewController = newController;
            item.setViewController(newController, item.view.nativeViewProtected);
        }
        return newController;
    };
    BottomNavigation.prototype.setViewControllers = function (items) {
        var _this = this;
        var length = items ? items.length : 0;
        if (length === 0) {
            this._ios.viewControllers = null;
            return;
        }
        var controllers = NSMutableArray.alloc().initWithCapacity(length);
        var states = getTitleAttributesForStates(this);
        if (this.tabStrip) {
            this.tabStrip.setNativeView(this._ios.tabBar);
        }
        items.forEach(function (item, i) {
            var controller = _this.getViewController(item);
            if (_this.tabStrip && _this.tabStrip.items && _this.tabStrip.items[i]) {
                var tabStripItem = _this.tabStrip.items[i];
                var tabBarItem = _this.createTabBarItem(tabStripItem, i);
                updateTitleAndIconPositions(tabStripItem, tabBarItem, controller);
                applyStatesToItem(tabBarItem, states);
                controller.tabBarItem = tabBarItem;
                tabStripItem.index = i;
                tabStripItem.setNativeView(tabBarItem);
            }
            controllers.addObject(controller);
        });
        this._ios.viewControllers = controllers;
        this._ios.customizableViewControllers = null;
        this._ios.moreNavigationController.delegate = this._moreNavigationControllerDelegate;
    };
    BottomNavigation.prototype.createTabBarItem = function (item, index) {
        var image;
        var title;
        image = this._getIcon(item);
        title = item.label ? item.label.text : item.title;
        var tabBarItem = UITabBarItem.alloc().initWithTitleImageTag(title, image, index);
        return tabBarItem;
    };
    BottomNavigation.prototype._getIconRenderingMode = function () {
        return 1;
    };
    BottomNavigation.prototype._getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image ? tabStripItem.image.src : tabStripItem.iconSource;
        if (!iconSource) {
            return null;
        }
        var image = this._iconsCache[iconSource];
        if (!image) {
            var is = new image_source_1.ImageSource;
            if (utils_1.isFontIconURI(iconSource)) {
                var fontIconCode = iconSource.split("//")[1];
                var font = tabStripItem.style.fontInternal;
                var color = tabStripItem.style.color;
                is = image_source_1.fromFontIconCode(fontIconCode, font, color);
            }
            else {
                is = image_source_1.fromFileOrResource(iconSource);
            }
            if (is && is.ios) {
                var originalRenderedImage = is.ios.imageWithRenderingMode(this._getIconRenderingMode());
                this._iconsCache[iconSource] = originalRenderedImage;
                image = originalRenderedImage;
            }
            else {
            }
        }
        return image;
    };
    BottomNavigation.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        if (value > -1) {
            this._ios._willSelectViewController = this._ios.viewControllers[value];
            this._ios.selectedIndex = value;
        }
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    BottomNavigation.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        this.setViewControllers(value);
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    BottomNavigation = __decorate([
        view_1.CSSType("BottomNavigation")
    ], BottomNavigation);
    return BottomNavigation;
}(tab_navigation_base_1.TabNavigationBase));
exports.BottomNavigation = BottomNavigation;
function getTitleAttributesForStates(view) {
    var _a, _b;
    if (!view) {
        return null;
    }
    var result = {};
    var defaultTabItemFontSize = 10;
    var tabItemFontSize = view.style.fontSize || defaultTabItemFontSize;
    var font = view.style.fontInternal.getUIFont(UIFont.systemFontOfSize(tabItemFontSize));
    var tabItemTextColor = view.style.color;
    var textColor = tabItemTextColor instanceof color_1.Color ? tabItemTextColor.ios : null;
    result.normalState = (_a = {}, _a[NSFontAttributeName] = font, _a);
    if (textColor) {
        result.normalState[UITextAttributeTextColor] = textColor;
    }
    var tabSelectedItemTextColor = view.style.color;
    var selectedTextColor = tabSelectedItemTextColor instanceof color_1.Color ? tabSelectedItemTextColor.ios : null;
    result.selectedState = (_b = {}, _b[NSFontAttributeName] = font, _b);
    if (selectedTextColor) {
        result.selectedState[UITextAttributeTextColor] = selectedTextColor;
    }
    return result;
}
function applyStatesToItem(item, states) {
    if (!states) {
        return;
    }
    item.setTitleTextAttributesForState(states.normalState, 0);
    item.setTitleTextAttributesForState(states.selectedState, 4);
}
//# sourceMappingURL=bottom-navigation.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/binding-builder.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var expressionSymbolsRegex = /[\+\-\*\/%\?:<>=!\|&\(\)^~]/;
var bindingConstants;
(function (bindingConstants) {
    bindingConstants.sourceProperty = "sourceProperty";
    bindingConstants.targetProperty = "targetProperty";
    bindingConstants.expression = "expression";
    bindingConstants.twoWay = "twoWay";
    bindingConstants.source = "source";
    bindingConstants.bindingValueKey = "$value";
    bindingConstants.parentValueKey = "$parent";
    bindingConstants.parentsValueKey = "$parents";
    bindingConstants.newPropertyValueKey = "$newPropertyValue";
})(bindingConstants = exports.bindingConstants || (exports.bindingConstants = {}));
var hasEqualSignRegex = /=+/;
var equalSignComparisionOperatorsRegex = /(==|===|>=|<=|!=|!==)/;
exports.parentsRegex = /\$parents\s*\[\s*(['"]*)\w*\1\s*\]/g;
function isNamedParam(value) {
    var equalSignIndex = value.search(hasEqualSignRegex);
    if (equalSignIndex > -1) {
        var equalSignSurround = value.substr(equalSignIndex > 0 ? equalSignIndex - 1 : 0, 3);
        if (equalSignSurround.search(equalSignComparisionOperatorsRegex) === -1) {
            return true;
        }
    }
    return false;
}
function areNamedParams(params) {
    for (var i = 0; i < params.length; i++) {
        if (isNamedParam(params[i])) {
            return true;
        }
    }
    return false;
}
var namedParamConstants = {
    propName: "propName",
    propValue: "propValue"
};
function getPropertyNameValuePair(param, knownOptions, callback) {
    var nameValuePair = {};
    var propertyName = param.substr(0, param.indexOf("=")).trim();
    var propertyValue = param.substr(param.indexOf("=") + 1).trim();
    if (knownOptions) {
        if (!propertyName) {
            propertyName = knownOptions.defaultProperty;
        }
        else {
            propertyName = propertyName in knownOptions ? propertyName : null;
        }
    }
    if (propertyName) {
        if (callback) {
            nameValuePair = callback(propertyName, propertyValue);
        }
        else {
            nameValuePair[namedParamConstants.propName] = propertyName;
            nameValuePair[namedParamConstants.propValue] = propertyValue;
        }
        return nameValuePair;
    }
    return null;
}
function parseNamedProperties(parameterList, knownOptions, callback) {
    var result = {};
    var nameValuePair;
    for (var i = 0; i < parameterList.length; i++) {
        nameValuePair = getPropertyNameValuePair(parameterList[i], knownOptions, callback);
        if (nameValuePair) {
            result[nameValuePair[namedParamConstants.propName]] = nameValuePair[namedParamConstants.propValue];
        }
    }
    return result;
}
function getParamsArray(value) {
    var result = [];
    var skipComma = 0;
    var indexReached = 0;
    var singleQuoteBlock = false;
    var doubleQuoteBlock = false;
    for (var i = 0; i < value.length; i++) {
        if (value[i] === "\"") {
            doubleQuoteBlock = !doubleQuoteBlock;
        }
        if (value[i] === "'") {
            singleQuoteBlock = !singleQuoteBlock;
        }
        if (value[i] === "(" || value[i] === "[") {
            skipComma++;
        }
        if (value[i] === ")" || value[i] === "]") {
            skipComma--;
        }
        if (value[i] === "," && skipComma === 0 && !(singleQuoteBlock || doubleQuoteBlock)) {
            result.push(value.substr(indexReached, i - indexReached));
            indexReached = i + 1;
        }
    }
    result.push(value.substr(indexReached));
    return result;
}
function isExpression(expression) {
    if (expression.search(expressionSymbolsRegex) > -1) {
        var parentsMatches = expression.match(exports.parentsRegex);
        if (parentsMatches) {
            var restOfExpression = expression.substr(expression.indexOf(parentsMatches[0]) + parentsMatches[0].length);
            if (!(restOfExpression.search(expressionSymbolsRegex) > -1)) {
                return false;
            }
        }
        return true;
    }
    return false;
}
function getBindingOptions(name, value) {
    var namedParams = [];
    var params = getParamsArray(value);
    if (!areNamedParams(params)) {
        if (params.length === 1) {
            var trimmedValue = params[0].trim();
            var sourceProp = void 0;
            if (isExpression(trimmedValue)) {
                sourceProp = bindingConstants.bindingValueKey;
                namedParams.push(bindingConstants.expression + " = " + trimmedValue);
            }
            else {
                sourceProp = trimmedValue;
            }
            namedParams.push(bindingConstants.sourceProperty + " = " + sourceProp);
            namedParams.push(bindingConstants.twoWay + " = true");
        }
        else {
            namedParams.push(bindingConstants.sourceProperty + " = " + params[0].trim());
            namedParams.push(bindingConstants.expression + " = " + params[1].trim());
            var twoWay = params[2] ? params[2].toLowerCase().trim() === "true" : true;
            namedParams.push(bindingConstants.twoWay + " = " + twoWay);
        }
    }
    else {
        namedParams = params;
    }
    var bindingPropertyHandler = function (prop, value) {
        var result = {};
        result[namedParamConstants.propName] = prop;
        if (prop === bindingConstants.twoWay) {
            if (value === "true") {
                result[namedParamConstants.propValue] = true;
            }
            else {
                result[namedParamConstants.propValue] = false;
            }
        }
        else {
            result[namedParamConstants.propValue] = value;
        }
        return result;
    };
    var bindingOptionsParameters = parseNamedProperties(namedParams, xmlBindingProperties, bindingPropertyHandler);
    var bindOptions = {
        targetProperty: name
    };
    for (var prop in bindingOptionsParameters) {
        if (bindingOptionsParameters.hasOwnProperty(prop)) {
            bindOptions[prop] = bindingOptionsParameters[prop];
        }
    }
    if (bindOptions[bindingConstants.twoWay] === undefined) {
        bindOptions[bindingConstants.twoWay] = true;
    }
    return bindOptions;
}
exports.getBindingOptions = getBindingOptions;
var xmlBindingProperties = {
    sourceProperty: true,
    expression: true,
    twoWay: true,
    source: true,
    defaultProperty: bindingConstants.sourceProperty
};
//# sourceMappingURL=binding-builder.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var xml = __webpack_require__("../node_modules/tns-core-modules/xml/xml.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var component_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var ios = platform_1.platformNames.ios.toLowerCase();
var android = platform_1.platformNames.android.toLowerCase();
var defaultNameSpaceMatcher = /tns\.xsd$/i;
function parse(value, context) {
    if (typeof value === "function") {
        return value();
    }
    else {
        var exports_1 = context ? getExports(context) : undefined;
        var componentModule = parseInternal(value, exports_1);
        return componentModule && componentModule.component;
    }
}
exports.parse = parse;
function parseMultipleTemplates(value, context) {
    var dummyComponent = "<ListView><ListView.itemTemplates>" + value + "</ListView.itemTemplates></ListView>";
    return parseInternal(dummyComponent, context).component["itemTemplates"];
}
exports.parseMultipleTemplates = parseMultipleTemplates;
function load(pathOrOptions, context) {
    var componentModule;
    if (typeof pathOrOptions === "string") {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(pathOrOptions);
        componentModule = loadInternal(moduleName, context);
    }
    else {
        componentModule = loadCustomComponent(pathOrOptions.path, pathOrOptions.name, pathOrOptions.attributes, pathOrOptions.exports, pathOrOptions.page, true);
    }
    return componentModule && componentModule.component;
}
exports.load = load;
exports.createViewFromEntry = profiling_1.profile("createViewFromEntry", function (entry) {
    if (entry.create) {
        var view = entry.create();
        if (!view) {
            throw new Error("Failed to create View with entry.create() function.");
        }
        return view;
    }
    else if (entry.moduleName) {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(entry.moduleName);
        var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
        var moduleExports = resolvedCodeModuleName ? global.loadModule(resolvedCodeModuleName, true) : null;
        if (moduleExports && moduleExports.createPage) {
            var view = moduleExports.createPage();
            var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
            if (resolvedCssModuleName) {
                view.addCssFile(resolvedCssModuleName);
            }
            return view;
        }
        else {
            var componentModule = loadInternal(moduleName, moduleExports);
            var componentView = componentModule && componentModule.component;
            return componentView;
        }
    }
    throw new Error("Failed to load page XML file for module: " + entry.moduleName);
});
function loadInternal(moduleName, moduleExports) {
    var componentModule;
    var resolvedXmlModule = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    if (resolvedXmlModule) {
        var text = global.loadModule(resolvedXmlModule, true);
        componentModule = parseInternal(text, moduleExports, resolvedXmlModule, moduleName);
    }
    var componentView = componentModule && componentModule.component;
    if (componentView) {
        componentView.exports = moduleExports;
        componentView._moduleName = moduleName;
    }
    if (!componentModule) {
        throw new Error("Failed to load component from module: " + moduleName);
    }
    return componentModule;
}
function loadCustomComponent(componentNamespace, componentName, attributes, context, parentPage, isRootComponent, moduleNamePath) {
    if (isRootComponent === void 0) { isRootComponent = true; }
    if (!parentPage && context) {
        parentPage = context["_parentPage"];
        delete context["_parentPage"];
    }
    var result;
    componentNamespace = module_name_sanitizer_1.sanitizeModuleName(componentNamespace);
    var moduleName = componentNamespace + "/" + componentName;
    var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
    var resolvedXmlModuleName = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
    if (resolvedXmlModuleName) {
        var subExports = context;
        if (resolvedCodeModuleName) {
            subExports = global.loadModule(resolvedCodeModuleName, true);
        }
        if (!subExports) {
            subExports = {};
        }
        subExports["_parentPage"] = parentPage;
        result = loadInternal(moduleName, subExports);
        if (types_1.isDefined(result) && types_1.isDefined(result.component) && types_1.isDefined(attributes)) {
            for (var attr in attributes) {
                component_builder_1.setPropertyValue(result.component, subExports, context, attr, attributes[attr]);
            }
        }
    }
    else {
        result = component_builder_1.getComponentModule(componentName, componentNamespace, attributes, context, moduleNamePath, isRootComponent);
        if (!resolvedCssModuleName) {
            resolvedCssModuleName = module_name_resolver_1.resolveModuleName(componentNamespace, "css");
        }
    }
    if (parentPage && resolvedCssModuleName) {
        parentPage.addCssFile(resolvedCssModuleName);
    }
    return result;
}
function getExports(instance) {
    var isView = !!instance._domId;
    if (!isView) {
        return instance.exports || instance;
    }
    var exportObject = instance.exports;
    var parent = instance.parent;
    while (exportObject === undefined && parent) {
        exportObject = parent.exports;
        parent = parent.parent;
    }
    return exportObject;
}
function parseInternal(value, context, xmlModule, moduleName) {
    var start;
    var ui;
    var errorFormat = (debug_1.debug && xmlModule) ? xml2ui.SourceErrorFormat(xmlModule) : xml2ui.PositionErrorFormat;
    var componentSourceTracker = (debug_1.debug && xmlModule) ? xml2ui.ComponentSourceTracker(xmlModule) : function () {
    };
    (start = new xml2ui.XmlStringParser(errorFormat))
        .pipe(new xml2ui.PlatformFilter())
        .pipe(new xml2ui.XmlStateParser(ui = new xml2ui.ComponentParser(context, errorFormat, componentSourceTracker, moduleName)));
    start.parse(value);
    return ui.rootComponentModule;
}
var xml2ui;
(function (xml2ui) {
    var XmlProducerBase = (function () {
        function XmlProducerBase() {
        }
        XmlProducerBase.prototype.pipe = function (next) {
            this._next = next;
            return next;
        };
        XmlProducerBase.prototype.next = function (args) {
            this._next.parse(args);
        };
        return XmlProducerBase;
    }());
    xml2ui.XmlProducerBase = XmlProducerBase;
    var XmlStringParser = (function (_super) {
        __extends(XmlStringParser, _super);
        function XmlStringParser(error) {
            var _this = _super.call(this) || this;
            _this.error = error || PositionErrorFormat;
            return _this;
        }
        XmlStringParser.prototype.parse = function (value) {
            var _this = this;
            var xmlParser = new xml.XmlParser(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            }, function (e, p) {
                throw _this.error(e, p);
            }, true);
            if (types_1.isString(value)) {
                xmlParser.parse(value);
            }
        };
        return XmlStringParser;
    }(XmlProducerBase));
    xml2ui.XmlStringParser = XmlStringParser;
    function PositionErrorFormat(e, p) {
        return new debug_1.ScopeError(e, "Parsing XML at " + p.line + ":" + p.column);
    }
    xml2ui.PositionErrorFormat = PositionErrorFormat;
    function SourceErrorFormat(uri) {
        return function (e, p) {
            var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
            e = new debug_1.SourceError(e, source, "Building UI from XML.");
            return e;
        };
    }
    xml2ui.SourceErrorFormat = SourceErrorFormat;
    function ComponentSourceTracker(uri) {
        return function (component, p) {
            if (!debug_1.Source.get(component)) {
                var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
                debug_1.Source.set(component, source);
            }
        };
    }
    xml2ui.ComponentSourceTracker = ComponentSourceTracker;
    var PlatformFilter = (function (_super) {
        __extends(PlatformFilter, _super);
        function PlatformFilter() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        PlatformFilter.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    if (this.currentPlatformContext) {
                        throw new Error("Already in '" + this.currentPlatformContext + "' platform context and cannot switch to '" + args.elementName + "' platform! Platform tags cannot be nested.");
                    }
                    this.currentPlatformContext = args.elementName;
                    return;
                }
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    this.currentPlatformContext = undefined;
                    return;
                }
            }
            if (this.currentPlatformContext && !PlatformFilter.isCurentPlatform(this.currentPlatformContext)) {
                return;
            }
            this.next(args);
        };
        PlatformFilter.isPlatform = function (value) {
            if (value) {
                var toLower = value.toLowerCase();
                return toLower === android || toLower === ios;
            }
            return false;
        };
        PlatformFilter.isCurentPlatform = function (value) {
            return value && value.toLowerCase() === platform_1.device.os.toLowerCase();
        };
        return PlatformFilter;
    }(XmlProducerBase));
    xml2ui.PlatformFilter = PlatformFilter;
    var XmlArgsReplay = (function (_super) {
        __extends(XmlArgsReplay, _super);
        function XmlArgsReplay(args, errorFormat) {
            var _this = _super.call(this) || this;
            _this.args = args;
            _this.error = errorFormat;
            return _this;
        }
        XmlArgsReplay.prototype.replay = function () {
            var _this = this;
            this.args.forEach(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            });
        };
        return XmlArgsReplay;
    }(XmlProducerBase));
    xml2ui.XmlArgsReplay = XmlArgsReplay;
    var XmlStateParser = (function () {
        function XmlStateParser(state) {
            this.state = state;
        }
        XmlStateParser.prototype.parse = function (args) {
            this.state = this.state.parse(args);
        };
        return XmlStateParser;
    }());
    xml2ui.XmlStateParser = XmlStateParser;
    var TemplateParser = (function () {
        function TemplateParser(parent, templateProperty, setTemplateProperty) {
            if (setTemplateProperty === void 0) { setTemplateProperty = true; }
            this.parent = parent;
            this._context = templateProperty.context;
            this._recordedXmlStream = new Array();
            this._templateProperty = templateProperty;
            this._nestingLevel = 0;
            this._state = 0;
            this._setTemplateProperty = setTemplateProperty;
        }
        TemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                this.parseStartElement(args.prefix, args.namespace, args.elementName, args.attributes);
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                this.parseEndElement(args.prefix, args.elementName);
            }
            this._recordedXmlStream.push(args);
            return this._state === 2 ? this.parent : this;
        };
        Object.defineProperty(TemplateParser.prototype, "elementName", {
            get: function () {
                return this._templateProperty.elementName;
            },
            enumerable: true,
            configurable: true
        });
        TemplateParser.prototype.parseStartElement = function (prefix, namespace, elementName, attributes) {
            if (this._state === 0) {
                this._state = 1;
            }
            else if (this._state === 2) {
                throw new Error("Template must have exactly one root element but multiple elements were found.");
            }
            this._nestingLevel++;
        };
        TemplateParser.prototype.parseEndElement = function (prefix, elementName) {
            if (this._state === 0) {
                throw new Error("Template must have exactly one root element but none was found.");
            }
            else if (this._state === 2) {
                throw new Error("No more closing elements expected for this template.");
            }
            this._nestingLevel--;
            if (this._nestingLevel === 0) {
                this._state = 2;
                if (this._setTemplateProperty && this._templateProperty.name in this._templateProperty.parent.component) {
                    var template = this.buildTemplate();
                    this._templateProperty.parent.component[this._templateProperty.name] = template;
                }
            }
        };
        TemplateParser.prototype.buildTemplate = function () {
            var _this = this;
            var context = this._context;
            var errorFormat = this._templateProperty.errorFormat;
            var sourceTracker = this._templateProperty.sourceTracker;
            var template = profiling_1.profile("Template()", function () {
                var start;
                var ui;
                (start = new xml2ui.XmlArgsReplay(_this._recordedXmlStream, errorFormat))
                    .pipe(new XmlStateParser(ui = new ComponentParser(context, errorFormat, sourceTracker)));
                start.replay();
                return ui.rootComponentModule.component;
            });
            return template;
        };
        return TemplateParser;
    }());
    xml2ui.TemplateParser = TemplateParser;
    var MultiTemplateParser = (function () {
        function MultiTemplateParser(parent, templateProperty) {
            this.parent = parent;
            this.templateProperty = templateProperty;
            this._childParsers = new Array();
        }
        Object.defineProperty(MultiTemplateParser.prototype, "value", {
            get: function () { return this._value; },
            enumerable: true,
            configurable: true
        });
        MultiTemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement && args.elementName === "template") {
                var childParser = new TemplateParser(this, this.templateProperty, false);
                childParser["key"] = args.attributes["key"];
                this._childParsers.push(childParser);
                return childParser;
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                var name_1 = ComponentParser.getComplexPropertyName(args.elementName);
                if (name_1 === this.templateProperty.name) {
                    var templates = new Array();
                    for (var i = 0; i < this._childParsers.length; i++) {
                        templates.push({
                            key: this._childParsers[i]["key"],
                            createView: this._childParsers[i].buildTemplate()
                        });
                    }
                    this._value = templates;
                    return this.parent.parse(args);
                }
            }
            return this;
        };
        return MultiTemplateParser;
    }());
    xml2ui.MultiTemplateParser = MultiTemplateParser;
    var ComponentParser = (function () {
        function ComponentParser(context, errorFormat, sourceTracker, moduleName) {
            this.moduleName = moduleName;
            this.parents = new Array();
            this.complexProperties = new Array();
            this.context = context;
            this.error = errorFormat;
            this.sourceTracker = sourceTracker;
        }
        ComponentParser.prototype.buildComponent = function (args) {
            if (args.prefix && args.namespace) {
                return loadCustomComponent(args.namespace, args.elementName, args.attributes, this.context, this.currentRootView, !this.currentRootView, this.moduleName);
            }
            else {
                var namespace = args.namespace;
                if (defaultNameSpaceMatcher.test(namespace || "")) {
                    namespace = undefined;
                }
                return component_builder_1.getComponentModule(args.elementName, namespace, args.attributes, this.context, this.moduleName, !this.currentRootView);
            }
        };
        ComponentParser.prototype.parse = function (args) {
            var parent = this.parents[this.parents.length - 1];
            var complexProperty = this.complexProperties[this.complexProperties.length - 1];
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    var name_2 = ComponentParser.getComplexPropertyName(args.elementName);
                    var complexProperty_1 = {
                        parent: parent,
                        name: name_2,
                        items: []
                    };
                    this.complexProperties.push(complexProperty_1);
                    if (ComponentParser.isKnownTemplate(name_2, parent.exports)) {
                        return new TemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                    }
                    if (ComponentParser.isKnownMultiTemplate(name_2, parent.exports)) {
                        var parser = new MultiTemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                        complexProperty_1.parser = parser;
                        return parser;
                    }
                }
                else {
                    var componentModule = this.buildComponent(args);
                    if (componentModule) {
                        this.sourceTracker(componentModule.component, args.position);
                        if (parent) {
                            if (complexProperty) {
                                ComponentParser.addToComplexProperty(parent, complexProperty, componentModule);
                            }
                            else if (parent.component._addChildFromBuilder) {
                                parent.component._addChildFromBuilder(args.elementName, componentModule.component);
                            }
                        }
                        else if (this.parents.length === 0) {
                            this.rootComponentModule = componentModule;
                            if (this.rootComponentModule) {
                                this.currentRootView = this.rootComponentModule.component;
                                if (this.currentRootView.exports) {
                                    this.context = this.currentRootView.exports;
                                }
                            }
                        }
                        this.parents.push(componentModule);
                    }
                }
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    if (complexProperty) {
                        if (complexProperty.parser) {
                            parent.component[complexProperty.name] = complexProperty.parser.value;
                        }
                        else if (parent && parent.component._addArrayFromBuilder) {
                            parent.component._addArrayFromBuilder(complexProperty.name, complexProperty.items);
                            complexProperty.items = [];
                        }
                    }
                    this.complexProperties.pop();
                }
                else {
                    this.parents.pop();
                }
            }
            return this;
        };
        ComponentParser.isComplexProperty = function (name) {
            return types_1.isString(name) && name.indexOf(".") !== -1;
        };
        ComponentParser.getComplexPropertyName = function (fullName) {
            var name;
            if (types_1.isString(fullName)) {
                var names = fullName.split(".");
                name = names[names.length - 1];
            }
            return name;
        };
        ComponentParser.isKnownTemplate = function (name, exports) {
            return ComponentParser.KNOWNTEMPLATES in exports && exports[ComponentParser.KNOWNTEMPLATES] && name in exports[ComponentParser.KNOWNTEMPLATES];
        };
        ComponentParser.isKnownMultiTemplate = function (name, exports) {
            return ComponentParser.KNOWNMULTITEMPLATES in exports && exports[ComponentParser.KNOWNMULTITEMPLATES] && name in exports[ComponentParser.KNOWNMULTITEMPLATES];
        };
        ComponentParser.addToComplexProperty = function (parent, complexProperty, elementModule) {
            var parentComponent = parent.component;
            if (ComponentParser.isKnownCollection(complexProperty.name, parent.exports)) {
                complexProperty.items.push(elementModule.component);
            }
            else if (parentComponent._addChildFromBuilder) {
                parentComponent._addChildFromBuilder(complexProperty.name, elementModule.component);
            }
            else {
                parentComponent[complexProperty.name] = elementModule.component;
            }
        };
        ComponentParser.isKnownCollection = function (name, context) {
            return ComponentParser.KNOWNCOLLECTIONS in context && context[ComponentParser.KNOWNCOLLECTIONS] && name in context[ComponentParser.KNOWNCOLLECTIONS];
        };
        ComponentParser.KNOWNCOLLECTIONS = "knownCollections";
        ComponentParser.KNOWNTEMPLATES = "knownTemplates";
        ComponentParser.KNOWNMULTITEMPLATES = "knownMultiTemplates";
        __decorate([
            profiling_1.profile
        ], ComponentParser.prototype, "buildComponent", null);
        return ComponentParser;
    }());
    xml2ui.ComponentParser = ComponentParser;
})(xml2ui || (xml2ui = {}));
//# sourceMappingURL=builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var UI_PATH = "ui/";
var MODULES = {
    "TabViewItem": "ui/tab-view",
    "TabStrip": "ui/tab-navigation-base/tab-strip",
    "TabStripItem": "ui/tab-navigation-base/tab-strip-item",
    "TabContentItem": "ui/tab-navigation-base/tab-content-item",
    "FormattedString": "text/formatted-string",
    "Span": "text/span",
    "ActionItem": "ui/action-bar",
    "NavigationButton": "ui/action-bar",
    "SegmentedBarItem": "ui/segmented-bar",
};
var CODE_FILE = "codeFile";
var CSS_FILE = "cssFile";
var IMPORT = "import";
var createComponentInstance = profiling_1.profile("createComponentInstance", function (elementName, namespace) {
    var instance;
    var instanceModule;
    var resolvedModuleName;
    try {
        if (typeof namespace === "string") {
            resolvedModuleName = module_name_resolver_1.resolveModuleName(namespace, "");
            instanceModule = global.loadModule(resolvedModuleName, true);
        }
        else {
            resolvedModuleName = MODULES[elementName] || UI_PATH +
                (elementName.toLowerCase().indexOf("layout") !== -1 ? "layouts/" : "") +
                elementName.split(/(?=[A-Z])/).join("-").toLowerCase();
            instanceModule = global.loadModule(resolvedModuleName, false);
        }
        var instanceType = instanceModule[elementName] || Object;
        instance = new instanceType();
    }
    catch (ex) {
        var debug = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
        throw new debug.ScopeError(ex, "Module '" + resolvedModuleName + "' not found for element '" + (namespace ? namespace + ":" : "") + elementName + "'.");
    }
    return { instance: instance, instanceModule: instanceModule };
});
var getComponentModuleExports = profiling_1.profile("getComponentModuleExports", function (instance, moduleExports, attributes) {
    if (attributes) {
        var codeFileAttribute = attributes[CODE_FILE] || attributes[IMPORT];
        if (codeFileAttribute) {
            var resolvedCodeFileModule = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(codeFileAttribute), "");
            if (resolvedCodeFileModule) {
                moduleExports = global.loadModule(resolvedCodeFileModule, true);
                instance.exports = moduleExports;
            }
            else {
                throw new Error("Code file with path \"" + codeFileAttribute + "\" cannot be found! Looking for webpack module with name \"" + resolvedCodeFileModule + "\"");
            }
        }
    }
    return moduleExports;
});
var applyComponentCss = profiling_1.profile("applyComponentCss", function (instance, moduleName, attributes) {
    var cssApplied = false;
    if (attributes && attributes[CSS_FILE]) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(attributes[CSS_FILE]), "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
            cssApplied = true;
        }
        else {
            throw new Error("Css file with path \"" + attributes[CSS_FILE] + "\" cannot be found! Looking for webpack module with name \"" + resolvedCssModuleName + "\"");
        }
    }
    if (moduleName && !cssApplied) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
        }
    }
});
var applyComponentAttributes = profiling_1.profile("applyComponentAttributes", function (instance, instanceModule, moduleExports, attributes) {
    if (instance && instanceModule) {
        for (var attr in attributes) {
            var attrValue = attributes[attr];
            if (attr.indexOf(":") !== -1) {
                var platformName = attr.split(":")[0].trim();
                if (platformName.toLowerCase() === platform.device.os.toLowerCase()) {
                    attr = attr.split(":")[1].trim();
                }
                else {
                    continue;
                }
            }
            if (attr.indexOf(".") !== -1) {
                var subObj = instance;
                var properties = attr.split(".");
                var subPropName = properties[properties.length - 1];
                for (var i = 0; i < properties.length - 1; i++) {
                    if (subObj !== undefined && subObj !== null) {
                        subObj = subObj[properties[i]];
                    }
                }
                if (subObj !== undefined && subObj !== null) {
                    setPropertyValue(subObj, instanceModule, moduleExports, subPropName, attrValue);
                }
            }
            else {
                setPropertyValue(instance, instanceModule, moduleExports, attr, attrValue);
            }
        }
    }
});
function getComponentModule(elementName, namespace, attributes, moduleExports, moduleNamePath, isRootComponent) {
    elementName = elementName.split("-").map(function (s) { return s[0].toUpperCase() + s.substring(1); }).join("");
    var _a = createComponentInstance(elementName, namespace), instance = _a.instance, instanceModule = _a.instanceModule;
    moduleExports = getComponentModuleExports(instance, moduleExports, attributes);
    if (isRootComponent) {
        applyComponentCss(instance, moduleNamePath, attributes);
    }
    applyComponentAttributes(instance, instanceModule, moduleExports, attributes);
    var componentModule;
    if (instance && instanceModule) {
        componentModule = { component: instance, exports: instanceModule };
    }
    return componentModule;
}
exports.getComponentModule = getComponentModule;
function setPropertyValue(instance, instanceModule, exports, propertyName, propertyValue) {
    if (isBinding(propertyValue) && instance.bind) {
        var bindOptions = binding_builder_1.getBindingOptions(propertyName, getBindingExpressionFromAttribute(propertyValue));
        instance.bind({
            sourceProperty: bindOptions[binding_builder_1.bindingConstants.sourceProperty],
            targetProperty: bindOptions[binding_builder_1.bindingConstants.targetProperty],
            expression: bindOptions[binding_builder_1.bindingConstants.expression],
            twoWay: bindOptions[binding_builder_1.bindingConstants.twoWay]
        }, bindOptions[binding_builder_1.bindingConstants.source]);
    }
    else if (bindable_1.isEventOrGesture(propertyName, instance)) {
        var handler = exports && exports[propertyValue];
        if (typeof handler === "function") {
            instance.on(propertyName, handler);
        }
    }
    else if (isKnownFunction(propertyName, instance) && exports && typeof exports[propertyValue] === "function") {
        instance[propertyName] = exports[propertyValue];
    }
    else {
        instance[propertyName] = propertyValue;
    }
}
exports.setPropertyValue = setPropertyValue;
function getBindingExpressionFromAttribute(value) {
    return value.replace("{{", "").replace("}}", "").trim();
}
function isBinding(value) {
    var isBinding;
    if (typeof value === "string") {
        var str = value.trim();
        isBinding = str.indexOf("{{") === 0 && str.lastIndexOf("}}") === str.length - 2;
    }
    return isBinding;
}
var KNOWN_FUNCTIONS = "knownFunctions";
function isKnownFunction(name, instance) {
    return instance.constructor
        && KNOWN_FUNCTIONS in instance.constructor
        && instance.constructor[KNOWN_FUNCTIONS].indexOf(name) !== -1;
}
//# sourceMappingURL=component-builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function sanitizeModuleName(moduleName, removeExtension) {
    if (removeExtension === void 0) { removeExtension = true; }
    moduleName = moduleName.trim();
    if (moduleName.startsWith("~/")) {
        moduleName = moduleName.substring(2);
    }
    else if (moduleName.startsWith("/")) {
        moduleName = moduleName.substring(1);
    }
    if (removeExtension) {
        var lastDot = moduleName.lastIndexOf(".");
        if (lastDot > 0) {
            moduleName = moduleName.substr(0, lastDot);
        }
    }
    return moduleName;
}
exports.sanitizeModuleName = sanitizeModuleName;
//# sourceMappingURL=module-name-sanitizer.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var ButtonBase = (function (_super) {
    __extends(ButtonBase, _super);
    function ButtonBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ButtonBase.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    ButtonBase.tapEvent = "tap";
    ButtonBase = __decorate([
        text_base_1.CSSType("Button")
    ], ButtonBase);
    return ButtonBase;
}(text_base_1.TextBase));
exports.ButtonBase = ButtonBase;
ButtonBase.prototype.recycleNativeView = "auto";
//# sourceMappingURL=button-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var control_state_change_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/control-state-change/control-state-change.js");
var button_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js"));
var Button = (function (_super) {
    __extends(Button, _super);
    function Button() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Button.prototype.createNativeView = function () {
        return UIButton.buttonWithType(1);
    };
    Button.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        this._tapHandler = TapHandlerImpl.initWithOwner(new WeakRef(this));
        nativeView.addTargetActionForControlEvents(this._tapHandler, "tap", 64);
    };
    Button.prototype.disposeNativeView = function () {
        this._tapHandler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Button.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Button.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        if (this._stateChangedHandler) {
            this._stateChangedHandler.stop();
        }
    };
    Button.prototype._updateButtonStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            if (!this._stateChangedHandler) {
                this._stateChangedHandler = new control_state_change_1.ControlStateChangeListener(this.nativeViewProtected, function (s) {
                    _this._goToVisualState(s);
                });
            }
            this._stateChangedHandler.start();
        }
        else {
            this._stateChangedHandler.stop();
        }
    };
    Button.prototype[button_common_1.borderTopWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.top,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderTopWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var top = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.borderRightWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.right,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderRightWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var right = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    Button.prototype[button_common_1.borderBottomWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.bottom,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderBottomWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var bottom = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    Button.prototype[button_common_1.borderLeftWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.left,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderLeftWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var left = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingTopProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.top,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingTopProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var top = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingRightProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.right,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingRightProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var right = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    Button.prototype[button_common_1.paddingBottomProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.bottom,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingBottomProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var bottom = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingLeftProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.left,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingLeftProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var left = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.textAlignmentProperty.setNative] = function (value) {
        switch (value) {
            case "left":
                this.nativeViewProtected.titleLabel.textAlignment = 0;
                this.nativeViewProtected.contentHorizontalAlignment = 1;
                break;
            case "initial":
            case "center":
                this.nativeViewProtected.titleLabel.textAlignment = 1;
                this.nativeViewProtected.contentHorizontalAlignment = 0;
                break;
            case "right":
                this.nativeViewProtected.titleLabel.textAlignment = 2;
                this.nativeViewProtected.contentHorizontalAlignment = 2;
                break;
        }
    };
    Button.prototype[button_common_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected.titleLabel;
        switch (value) {
            case "normal":
                nativeView.lineBreakMode = 0;
                nativeView.numberOfLines = 0;
                break;
            case "nowrap":
            case "initial":
                nativeView.lineBreakMode = 5;
                nativeView.numberOfLines = 1;
                break;
        }
    };
    Button.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        if (!this.textWrap) {
            return _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        }
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            var width = button_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
            var widthMode = button_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
            var height = button_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
            var heightMode = button_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
            var horizontalPadding = this.effectivePaddingLeft + this.effectiveBorderLeftWidth + this.effectivePaddingRight + this.effectiveBorderRightWidth;
            var verticalPadding = this.effectivePaddingTop + this.effectiveBorderTopWidth + this.effectivePaddingBottom + this.effectiveBorderBottomWidth;
            if (verticalPadding === 0) {
                verticalPadding = button_common_1.layout.toDevicePixels(12);
            }
            var desiredSize = button_common_1.layout.measureNativeView(nativeView.titleLabel, width - horizontalPadding, widthMode, height - verticalPadding, heightMode);
            desiredSize.width = desiredSize.width + horizontalPadding;
            desiredSize.height = desiredSize.height + verticalPadding;
            var measureWidth = Math.max(desiredSize.width, this.effectiveMinWidth);
            var measureHeight = Math.max(desiredSize.height, this.effectiveMinHeight);
            var widthAndState = button_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
            var heightAndState = button_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
            this.setMeasuredDimension(widthAndState, heightAndState);
        }
    };
    __decorate([
        button_common_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], Button.prototype, "_updateButtonStateChangeHandler", null);
    return Button;
}(button_common_1.ButtonBase));
exports.Button = Button;
var TapHandlerImpl = (function (_super) {
    __extends(TapHandlerImpl, _super);
    function TapHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TapHandlerImpl.initWithOwner = function (owner) {
        var handler = TapHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    TapHandlerImpl.prototype.tap = function (args) {
        var owner = this._owner.get();
        if (owner) {
            owner._emit(button_common_1.ButtonBase.tapEvent);
        }
    };
    TapHandlerImpl.ObjCExposedMethods = {
        "tap": { returns: interop.types.void, params: [interop.types.id] }
    };
    return TapHandlerImpl;
}(NSObject));
//# sourceMappingURL=button.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/content-view/content-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ContentView = (function (_super) {
    __extends(ContentView, _super);
    function ContentView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ContentView.prototype, "content", {
        get: function () {
            return this._content;
        },
        set: function (value) {
            var oldView = this._content;
            if (this._content) {
                this._removeView(this._content);
            }
            this._content = value;
            if (this._content) {
                this._addView(this._content);
            }
            this._onContentChanged(oldView, value);
            if (view_1.isIOS && oldView !== value) {
                this.requestLayout();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "layoutView", {
        get: function () {
            var result;
            if (this._content) {
                var first_1 = true;
                this._content._eachLayoutView(function (child) {
                    if (first_1) {
                        first_1 = false;
                        result = child;
                    }
                    else {
                        throw new Error("More than one layout child inside a ContentView");
                    }
                });
            }
            return result;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ContentView.prototype, "_childrenCount", {
        get: function () {
            return this._content ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    ContentView.prototype._onContentChanged = function (oldView, newView) {
    };
    ContentView.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.content = value;
        }
    };
    ContentView.prototype.eachChildView = function (callback) {
        var content = this._content;
        if (content) {
            callback(content);
        }
    };
    ContentView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = view_1.View.measureChild(this, this.layoutView, widthMeasureSpec, heightMeasureSpec);
        var width = view_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = view_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = view_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = view_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var measureWidth = Math.max(result.measuredWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(result.measuredHeight, this.effectiveMinHeight);
        var widthAndState = view_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = view_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    ContentView.prototype.onLayout = function (left, top, right, bottom) {
        view_1.View.layoutChild(this, this.layoutView, 0, 0, right - left, bottom - top);
    };
    return ContentView;
}(view_1.CustomLayoutView));
exports.ContentView = ContentView;
ContentView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=content-view.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/bindable/bindable.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
exports.WrappedValue = observable_1.WrappedValue;
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceError = trace_1.error;
exports.traceCategories = trace_1.categories;
exports.traceNotifyEvent = trace_1.notifyEvent;
exports.isCategorySet = trace_1.isCategorySet;
exports.traceMessageType = trace_1.messageType;
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var polymerExpressions = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js");
var contextKey = "context";
var paramsRegex = /\[\s*(['"])*(\w*)\1\s*\]/;
var bc = binding_builder_1.bindingConstants;
var emptyArray = [];
var propertiesCache = {};
function getProperties(property) {
    if (!property) {
        return emptyArray;
    }
    var result = propertiesCache[property];
    if (result) {
        return result;
    }
    var parentsMatches = property.match(binding_builder_1.parentsRegex);
    result = property.replace(binding_builder_1.parentsRegex, "parentsMatch")
        .replace(/\]/g, "")
        .split(/\.|\[/);
    var parentsMatchesCounter = 0;
    for (var i = 0, resultLength = result.length; i < resultLength; i++) {
        if (result[i] === "parentsMatch") {
            result[i] = parentsMatches[parentsMatchesCounter++];
        }
    }
    propertiesCache[property] = result;
    return result;
}
function getEventOrGestureName(name) {
    return name.indexOf("on") === 0 ? name.substr(2, name.length - 2) : name;
}
exports.getEventOrGestureName = getEventOrGestureName;
function isGesture(eventOrGestureName) {
    var t = eventOrGestureName.trim().toLowerCase();
    return t === "tap"
        || t === "doubletap"
        || t === "pinch"
        || t === "pan"
        || t === "swipe"
        || t === "rotation"
        || t === "longpress"
        || t === "touch";
}
exports.isGesture = isGesture;
function isEventOrGesture(name, view) {
    if (typeof name === "string") {
        var eventOrGestureName = getEventOrGestureName(name);
        var evt = eventOrGestureName + "Event";
        return view.constructor && evt in view.constructor || isGesture(eventOrGestureName.toLowerCase());
    }
    return false;
}
exports.isEventOrGesture = isEventOrGesture;
var Binding = (function () {
    function Binding(target, options) {
        this.propertyChangeListeners = new Map();
        this.target = new WeakRef(target);
        this.options = options;
        this.sourceProperties = getProperties(options.sourceProperty);
        this.targetOptions = this.resolveOptions(target, getProperties(options.targetProperty));
        if (!this.targetOptions) {
            throw new Error("Invalid property: " + options.targetProperty + " for target: " + target);
        }
        if (options.twoWay) {
            var target_1 = this.targetOptions.instance.get();
            if (target_1 instanceof observable_1.Observable) {
                target_1.on(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
        }
    }
    Binding.prototype.onTargetPropertyChanged = function (data) {
        this.updateTwoWay(data.value);
    };
    Binding.prototype.loadedHandlerVisualTreeBinding = function (args) {
        var target = args.object;
        target.off("loaded", this.loadedHandlerVisualTreeBinding, this);
        var context = target.bindingContext;
        if (context !== undefined && context !== null) {
            this.update(context);
        }
    };
    Binding.prototype.clearSource = function () {
        var _this = this;
        this.propertyChangeListeners.forEach(function (observable, index, map) {
            weak_event_listener_1.removeWeakEventListener(observable, observable_1.Observable.propertyChangeEvent, _this.onSourcePropertyChanged, _this);
        });
        this.propertyChangeListeners.clear();
        if (this.source) {
            this.source.clear();
        }
        if (this.sourceOptions) {
            this.sourceOptions.instance.clear();
            this.sourceOptions = undefined;
        }
    };
    Binding.prototype.sourceAsObject = function (source) {
        var objectType = typeof source;
        if (objectType === "number") {
            source = new Number(source);
        }
        else if (objectType === "boolean") {
            source = new Boolean(source);
        }
        else if (objectType === "string") {
            source = new String(source);
        }
        return source;
    };
    Binding.prototype.bindingContextChanged = function (data) {
        var target = this.targetOptions.instance.get();
        if (!target) {
            this.unbind();
            return;
        }
        var value = data.value;
        if (value !== null && value !== undefined) {
            this.update(value);
        }
        else {
            this.clearBinding();
        }
    };
    Binding.prototype.bind = function (source) {
        var target = this.targetOptions.instance.get();
        if (this.sourceIsBindingContext && target instanceof observable_1.Observable && this.targetOptions.property !== "bindingContext") {
            target.on("bindingContextChange", this.bindingContextChanged, this);
        }
        this.update(source);
    };
    Binding.prototype.update = function (source) {
        this.clearSource();
        source = this.sourceAsObject(source);
        if (!types.isNullOrUndefined(source)) {
            this.source = new WeakRef(source);
            this.sourceOptions = this.resolveOptions(source, this.sourceProperties);
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue);
            this.addPropertyChangeListeners(this.source, this.sourceProperties);
        }
        else if (!this.sourceIsBindingContext) {
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue ? sourceValue : source);
        }
    };
    Binding.prototype.unbind = function () {
        var target = this.targetOptions.instance.get();
        if (target instanceof observable_1.Observable) {
            if (this.options.twoWay) {
                target.off(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
            if (this.sourceIsBindingContext && this.targetOptions.property !== "bindingContext") {
                target.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        if (this.targetOptions) {
            this.targetOptions = undefined;
        }
        this.sourceProperties = undefined;
        if (!this.source) {
            return;
        }
        this.clearSource();
    };
    Binding.prototype.resolveObjectsAndProperties = function (source, properties) {
        var result = [];
        var currentObject = source;
        var currentObjectChanged = false;
        for (var i = 0, propsArrayLength = properties.length; i < propsArrayLength; i++) {
            var property = properties[i];
            if (property === bc.bindingValueKey) {
                currentObjectChanged = true;
            }
            if (property === bc.parentValueKey || property.indexOf(bc.parentsValueKey) === 0) {
                var parentView = this.getParentView(this.target.get(), property).view;
                if (parentView) {
                    currentObject = parentView.bindingContext;
                }
                else {
                    var targetInstance = this.target.get();
                    targetInstance.off("loaded", this.loadedHandlerVisualTreeBinding, this);
                    targetInstance.on("loaded", this.loadedHandlerVisualTreeBinding, this);
                }
                currentObjectChanged = true;
            }
            if (currentObject) {
                result.push({ instance: currentObject, property: property });
            }
            else {
                break;
            }
            if (!currentObjectChanged && (i < propsArrayLength - 1)) {
                currentObject = currentObject ? currentObject[properties[i]] : null;
            }
            currentObjectChanged = false;
        }
        return result;
    };
    Binding.prototype.addPropertyChangeListeners = function (source, sourceProperty, parentProperies) {
        var objectsAndProperties = this.resolveObjectsAndProperties(source.get(), sourceProperty);
        var prop = parentProperies || "";
        for (var i = 0, length_1 = objectsAndProperties.length; i < length_1; i++) {
            var propName = objectsAndProperties[i].property;
            prop += "$" + propName;
            var currentObject = objectsAndProperties[i].instance;
            if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable && currentObject._isViewBase) {
                weak_event_listener_1.addWeakEventListener(currentObject, propName + "Change", this.onSourcePropertyChanged, this);
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
            else if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable) {
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
        }
    };
    Binding.prototype.prepareExpressionForUpdate = function () {
        var escapedSourceProperty = utils_1.escapeRegexSymbols(this.options.sourceProperty);
        var expRegex = new RegExp(escapedSourceProperty, "g");
        var resultExp = this.options.expression.replace(expRegex, bc.newPropertyValueKey);
        return resultExp;
    };
    Binding.prototype.updateTwoWay = function (value) {
        if (this.updating || !this.options.twoWay) {
            return;
        }
        var newValue = value;
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = value;
            changedModel[bc.newPropertyValueKey] = value;
            var sourcePropertyName = "";
            if (this.sourceOptions) {
                sourcePropertyName = this.sourceOptions.property;
            }
            else if (typeof this.options.sourceProperty === "string" && this.options.sourceProperty.indexOf(".") === -1) {
                sourcePropertyName = this.options.sourceProperty;
            }
            if (sourcePropertyName !== "") {
                changedModel[sourcePropertyName] = value;
            }
            var updateExpression = this.prepareExpressionForUpdate();
            this.prepareContextForExpression(changedModel, updateExpression, undefined);
            var expressionValue = this._getExpressionValue(updateExpression, true, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            newValue = expressionValue;
        }
        this.updateSource(newValue);
    };
    Binding.prototype._getExpressionValue = function (expression, isBackConvert, changedModel) {
        try {
            var exp_1 = polymerExpressions.PolymerExpressions.getExpression(expression);
            if (exp_1) {
                var context_1 = this.source && this.source.get && this.source.get() || global;
                var model = {};
                var addedProps = [];
                var resources = applicationCommon.getResources();
                for (var prop in resources) {
                    if (resources.hasOwnProperty(prop) && !context_1.hasOwnProperty(prop)) {
                        context_1[prop] = resources[prop];
                        addedProps.push(prop);
                    }
                }
                this.prepareContextForExpression(context_1, expression, addedProps);
                model[contextKey] = context_1;
                var result = exp_1.getValue(model, isBackConvert, changedModel ? changedModel : model);
                var addedPropsLength = addedProps.length;
                for (var i = 0; i < addedPropsLength; i++) {
                    delete context_1[addedProps[i]];
                }
                addedProps.length = 0;
                return result;
            }
            return new Error(expression + " is not a valid expression.");
        }
        catch (e) {
            var errorMessage = "Run-time error occured in file: " + e.sourceURL + " at line: " + e.line + " and column: " + e.column;
            return new Error(errorMessage);
        }
    };
    Binding.prototype.onSourcePropertyChanged = function (data) {
        var sourceProps = this.sourceProperties;
        var sourcePropsLength = sourceProps.length;
        var changedPropertyIndex = sourceProps.indexOf(data.propertyName);
        var parentProps = "";
        if (changedPropertyIndex > -1) {
            parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            while (this.propertyChangeListeners.get(parentProps) !== data.object) {
                changedPropertyIndex += sourceProps.slice(changedPropertyIndex + 1).indexOf(data.propertyName) + 1;
                parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            }
        }
        if (this.options.expression) {
            var expressionValue = this._getExpressionValue(this.options.expression, false, undefined);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                this.updateTarget(expressionValue);
            }
        }
        else {
            if (changedPropertyIndex > -1) {
                var props = sourceProps.slice(changedPropertyIndex + 1);
                var propsLength = props.length;
                if (propsLength > 0) {
                    var value = data.value;
                    for (var i = 0; i < propsLength; i++) {
                        value = value[props[i]];
                    }
                    this.updateTarget(value);
                }
                else if (data.propertyName === this.sourceOptions.property) {
                    this.updateTarget(data.value);
                }
            }
        }
        if (changedPropertyIndex > -1 && changedPropertyIndex < sourcePropsLength - 1) {
            var probablyChangedObject = this.propertyChangeListeners.get(parentProps);
            if (probablyChangedObject &&
                probablyChangedObject !== data.object[sourceProps[changedPropertyIndex]]) {
                for (var i = sourcePropsLength - 1; i > changedPropertyIndex; i--) {
                    var prop = "$" + sourceProps.slice(0, i + 1).join("$");
                    if (this.propertyChangeListeners.has(prop)) {
                        weak_event_listener_1.removeWeakEventListener(this.propertyChangeListeners.get(prop), observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                        this.propertyChangeListeners.delete(prop);
                    }
                }
                var newProps = sourceProps.slice(changedPropertyIndex + 1);
                var newObject = data.object[sourceProps[changedPropertyIndex]];
                if (!types.isNullOrUndefined(newObject) && typeof newObject === "object") {
                    this.addPropertyChangeListeners(new WeakRef(newObject), newProps, parentProps);
                }
            }
        }
    };
    Binding.prototype.prepareContextForExpression = function (model, expression, newProps) {
        var parentViewAndIndex;
        var parentView;
        var addedProps = newProps || [];
        if (expression.indexOf(bc.bindingValueKey) > -1) {
            model[bc.bindingValueKey] = model;
            addedProps.push(bc.bindingValueKey);
        }
        if (expression.indexOf(bc.parentValueKey) > -1) {
            parentView = this.getParentView(this.target.get(), bc.parentValueKey).view;
            if (parentView) {
                model[bc.parentValueKey] = parentView.bindingContext;
                addedProps.push(bc.parentValueKey);
            }
        }
        var parentsArray = expression.match(binding_builder_1.parentsRegex);
        if (parentsArray) {
            for (var i = 0; i < parentsArray.length; i++) {
                parentViewAndIndex = this.getParentView(this.target.get(), parentsArray[i]);
                if (parentViewAndIndex.view) {
                    model[bc.parentsValueKey] = model[bc.parentsValueKey] || {};
                    model[bc.parentsValueKey][parentViewAndIndex.index] = parentViewAndIndex.view.bindingContext;
                    addedProps.push(bc.parentsValueKey);
                }
            }
        }
    };
    Binding.prototype.getSourcePropertyValue = function () {
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = this.source ? this.source.get() : undefined;
            var expressionValue = this._getExpressionValue(this.options.expression, false, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                return expressionValue;
            }
        }
        if (this.sourceOptions) {
            var sourceOptionsInstance = this.sourceOptions.instance.get();
            if (this.sourceOptions.property === bc.bindingValueKey) {
                return sourceOptionsInstance;
            }
            else if ((sourceOptionsInstance instanceof observable_1.Observable) && (this.sourceOptions.property && this.sourceOptions.property !== "")) {
                return sourceOptionsInstance.get(this.sourceOptions.property);
            }
            else if (sourceOptionsInstance && this.sourceOptions.property && this.sourceOptions.property !== "" &&
                this.sourceOptions.property in sourceOptionsInstance) {
                return sourceOptionsInstance[this.sourceOptions.property];
            }
            else {
                trace_1.write("Property: '" + this.sourceOptions.property + "' is invalid or does not exist. SourceProperty: '" + this.options.sourceProperty + "'", trace_1.categories.Binding, trace_1.messageType.error);
            }
        }
        return null;
    };
    Binding.prototype.clearBinding = function () {
        this.clearSource();
        this.updateTarget(properties_1.unsetValue);
    };
    Binding.prototype.updateTarget = function (value) {
        if (this.updating) {
            return;
        }
        this.updateOptions(this.targetOptions, types.isNullOrUndefined(value) ? properties_1.unsetValue : value);
    };
    Binding.prototype.updateSource = function (value) {
        if (this.updating || !this.source || !this.source.get()) {
            return;
        }
        this.updateOptions(this.sourceOptions, value);
    };
    Binding.prototype.getParentView = function (target, property) {
        if (!target) {
            return { view: null, index: null };
        }
        var result;
        if (property === bc.parentValueKey) {
            result = target.parent;
        }
        var index = null;
        if (property.indexOf(bc.parentsValueKey) === 0) {
            result = target.parent;
            var indexParams = paramsRegex.exec(property);
            if (indexParams && indexParams.length > 1) {
                index = indexParams[2];
            }
            if (!isNaN(index)) {
                var indexAsInt = parseInt(index);
                while (indexAsInt > 0) {
                    result = result.parent;
                    indexAsInt--;
                }
            }
            else if (types.isString(index)) {
                while (result && result.typeName !== index) {
                    result = result.parent;
                }
            }
        }
        return { view: result, index: index };
    };
    Binding.prototype.resolveOptions = function (obj, properties) {
        var objectsAndProperties = this.resolveObjectsAndProperties(obj, properties);
        if (objectsAndProperties.length > 0) {
            var resolvedObj = objectsAndProperties[objectsAndProperties.length - 1].instance;
            var prop = objectsAndProperties[objectsAndProperties.length - 1].property;
            return {
                instance: new WeakRef(this.sourceAsObject(resolvedObj)),
                property: prop
            };
        }
        return null;
    };
    Binding.prototype.updateOptions = function (options, value) {
        var optionsInstance;
        if (options && options.instance) {
            optionsInstance = options.instance.get();
        }
        if (!optionsInstance) {
            return;
        }
        this.updating = true;
        try {
            if (isEventOrGesture(options.property, optionsInstance) &&
                types.isFunction(value)) {
                optionsInstance.off(options.property, null, optionsInstance.bindingContext);
                optionsInstance.on(options.property, value, optionsInstance.bindingContext);
            }
            else if (optionsInstance instanceof observable_1.Observable) {
                optionsInstance.set(options.property, value);
            }
            else {
                optionsInstance[options.property] = value;
            }
        }
        catch (ex) {
            trace_1.write("Binding error while setting property " + options.property + " of " + optionsInstance + ": " + ex, trace_1.categories.Binding, trace_1.messageType.error);
        }
        this.updating = false;
    };
    return Binding;
}());
exports.Binding = Binding;
//# sourceMappingURL=bindable.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/control-state-change/control-state-change.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var ObserverClass = (function (_super) {
    __extends(ObserverClass, _super);
    function ObserverClass() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ObserverClass.prototype.observeValueForKeyPathOfObjectChangeContext = function (path) {
        if (path === "selected") {
            this["_owner"]._onSelectedChanged();
        }
        else if (path === "enabled") {
            this["_owner"]._onEnabledChanged();
        }
        else if (path === "highlighted") {
            this["_owner"]._onHighlightedChanged();
        }
    };
    return ObserverClass;
}(NSObject));
var ControlStateChangeListener = (function () {
    function ControlStateChangeListener(control, callback) {
        this._observing = false;
        this._observer = ObserverClass.alloc();
        this._observer["_owner"] = this;
        this._control = control;
        this._callback = callback;
    }
    ControlStateChangeListener.prototype.start = function () {
        if (!this._observing) {
            this._control.addObserverForKeyPathOptionsContext(this._observer, "highlighted", 1, null);
            this._observing = true;
            this._updateState();
        }
    };
    ControlStateChangeListener.prototype.stop = function () {
        if (this._observing) {
            this._observing = false;
            this._control.removeObserverForKeyPath(this._observer, "highlighted");
        }
    };
    ControlStateChangeListener.prototype._onEnabledChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._onSelectedChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._onHighlightedChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._updateState = function () {
        var state = "normal";
        if (this._control.highlighted) {
            state = "highlighted";
        }
        this._callback(state);
    };
    return ControlStateChangeListener;
}());
exports.ControlStateChangeListener = ControlStateChangeListener;
//# sourceMappingURL=control-state-change.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/properties/properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var style_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style/style.js");
exports.Style = style_1.Style;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
exports.unsetValue = new Object();
var cssPropertyNames = [];
var symbolPropertyMap = {};
var cssSymbolPropertyMap = {};
var inheritableProperties = new Array();
var inheritableCssProperties = new Array();
function print(map) {
    var symbols = Object.getOwnPropertySymbols(map);
    for (var _i = 0, symbols_1 = symbols; _i < symbols_1.length; _i++) {
        var symbol = symbols_1[_i];
        var prop = map[symbol];
        if (!prop.registered) {
            console.log("Property " + prop.name + " not Registered!!!!!");
        }
    }
}
function _printUnregisteredProperties() {
    print(symbolPropertyMap);
    print(cssSymbolPropertyMap);
}
exports._printUnregisteredProperties = _printUnregisteredProperties;
function _getProperties() {
    return getPropertiesFromMap(symbolPropertyMap);
}
exports._getProperties = _getProperties;
function _getStyleProperties() {
    return getPropertiesFromMap(cssSymbolPropertyMap);
}
exports._getStyleProperties = _getStyleProperties;
function getPropertiesFromMap(map) {
    var props = [];
    Object.getOwnPropertySymbols(map).forEach(function (symbol) { return props.push(map[symbol]); });
    return props;
}
var Property = (function () {
    function Property(options) {
        this.enumerable = true;
        this.configurable = true;
        var propertyName = options.name;
        this.name = propertyName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var equalityComparer = options.equalityComparer;
        var affectsLayout = options.affectsLayout;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        this.get = function () {
            return key in this ? this[key] : defaultValue;
        };
        this.nativeValueChange = function (owner, value) {
            var oldValue = key in owner ? owner[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                owner[key] = value;
                if (valueChanged) {
                    valueChanged(owner, oldValue, value);
                }
                if (owner.nativeViewProtected && !(defaultValueKey in owner)) {
                    owner[defaultValueKey] = owner[getDefault] ? owner[getDefault]() : defaultValue;
                }
                if (owner.hasListeners(eventName)) {
                    owner.notify({ object: owner, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    owner.requestLayout();
                }
                if (owner.domNode) {
                    owner.domNode.attributeModified(propertyName, value);
                }
            }
        };
        symbolPropertyMap[key] = this;
    }
    Property.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this);
    };
    Property.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return Property;
}());
exports.Property = Property;
Property.prototype.isStyleProperty = false;
var CoercibleProperty = (function (_super) {
    __extends(CoercibleProperty, _super);
    function CoercibleProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var defaultValue = _this.defaultValue;
        var coerceKey = Symbol(propertyName + ":coerceKey");
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var coerceCallback = options.coerceValue;
        var property = _this;
        _this.coerce = function (target) {
            var originalValue = coerceKey in target ? target[coerceKey] : defaultValue;
            target[propertyName] = originalValue;
        };
        _this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
                delete this[coerceKey];
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
                this[coerceKey] = value;
                value = coerceCallback(this, value);
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        return _this;
    }
    return CoercibleProperty;
}(Property));
exports.CoercibleProperty = CoercibleProperty;
var InheritedProperty = (function (_super) {
    __extends(InheritedProperty, _super);
    function InheritedProperty(options) {
        var _this = _super.call(this, options) || this;
        var name = options.name;
        var key = _this.key;
        var defaultValue = options.defaultValue;
        var sourceKey = Symbol(name + ":valueSourceKey");
        _this.sourceKey = sourceKey;
        var setBase = _this.set;
        var setFunc = function (valueSource) { return function (value) {
            var that = this;
            var unboxedValue;
            var newValueSource;
            if (value === exports.unsetValue) {
                var parent_1 = that.parent;
                if (parent_1 && parent_1[sourceKey] !== 0) {
                    unboxedValue = parent_1[name];
                    newValueSource = 1;
                }
                else {
                    unboxedValue = defaultValue;
                    newValueSource = 0;
                }
            }
            else {
                unboxedValue = value;
                newValueSource = valueSource;
            }
            var currentValue = that[key];
            setBase.call(that, unboxedValue);
            var newValue = that[key];
            that[sourceKey] = newValueSource;
            if (currentValue !== newValue) {
                var reset_1 = newValueSource === 0;
                that.eachChild(function (child) {
                    var childValueSource = child[sourceKey] || 0;
                    if (reset_1) {
                        if (childValueSource === 1) {
                            setFunc.call(child, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedValue.call(child, newValue);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setInheritedValue = setFunc(1);
        _this.setInheritedValue = setInheritedValue;
        _this.set = setFunc(3);
        inheritableProperties.push(_this);
        return _this;
    }
    return InheritedProperty;
}(Property));
exports.InheritedProperty = InheritedProperty;
var CssProperty = (function () {
    function CssProperty(options) {
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = options.cssName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var sourceKey = Symbol(propertyName + ":valueSourceKey");
        this.sourceKey = sourceKey;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        function setLocalValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                this[sourceKey] = 3;
                value = (valueConverter && typeof newValue === "string") ?
                    valueConverter(newValue) :
                    newValue;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function setCssValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var currentValueSource = this[sourceKey] || 0;
            if (currentValueSource === 3) {
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                value = valueConverter && typeof newValue === "string" ?
                    valueConverter(newValue) :
                    newValue;
                this[sourceKey] = 2;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function get() {
            return key in this ? this[key] : defaultValue;
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setLocalValue
        };
        cssSymbolPropertyMap[key] = this;
    }
    CssProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
    };
    CssProperty.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return CssProperty;
}());
exports.CssProperty = CssProperty;
CssProperty.prototype.isStyleProperty = true;
var CssAnimationProperty = (function () {
    function CssAnimationProperty(options) {
        var valueConverter = options.valueConverter, equalityComparer = options.equalityComparer, valueChanged = options.valueChanged, defaultValue = options.defaultValue;
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        CssAnimationProperty.properties[propertyName] = this;
        if (options.cssName && options.cssName !== propertyName) {
            CssAnimationProperty.properties[options.cssName] = this;
        }
        this._valueConverter = options.valueConverter;
        var cssLocalName = (options.cssName || propertyName);
        this.cssLocalName = cssLocalName;
        var cssName = "css:" + cssLocalName;
        this.cssName = cssName;
        var keyframeName = "keyframe:" + propertyName;
        this.keyframe = keyframeName;
        var defaultName = "default:" + propertyName;
        var defaultValueKey = Symbol(defaultName);
        this.defaultValueKey = defaultValueKey;
        this.defaultValue = defaultValue;
        var cssValue = Symbol(cssName);
        var styleValue = Symbol("local:" + propertyName);
        var keyframeValue = Symbol(keyframeName);
        var computedValue = Symbol("computed-value:" + propertyName);
        this.key = computedValue;
        var computedSource = Symbol("computed-source:" + propertyName);
        this.source = computedSource;
        this.getDefault = Symbol(propertyName + ":getDefault");
        var getDefault = this.getDefault;
        var setNative = this.setNative = Symbol(propertyName + ":setNative");
        var eventName = propertyName + "Change";
        var property = this;
        function descriptor(symbol, propertySource, enumerable, configurable, getsComputed) {
            return {
                enumerable: enumerable, configurable: configurable,
                get: getsComputed ? function () { return this[computedValue]; } : function () { return this[symbol]; },
                set: function (boxedValue) {
                    var view = this.viewRef.get();
                    if (!view) {
                        trace_1.write(boxedValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                        return;
                    }
                    var oldValue = this[computedValue];
                    var oldSource = this[computedSource];
                    var wasSet = oldSource !== 0;
                    var reset = boxedValue === exports.unsetValue || boxedValue === "";
                    if (reset) {
                        this[symbol] = exports.unsetValue;
                        if (this[computedSource] === propertySource) {
                            if (this[styleValue] !== exports.unsetValue) {
                                this[computedSource] = 3;
                                this[computedValue] = this[styleValue];
                            }
                            else if (this[cssValue] !== exports.unsetValue) {
                                this[computedSource] = 2;
                                this[computedValue] = this[cssValue];
                            }
                            else {
                                delete this[computedSource];
                                delete this[computedValue];
                            }
                        }
                    }
                    else {
                        if (valueConverter && typeof boxedValue === "string") {
                            boxedValue = valueConverter(boxedValue);
                        }
                        this[symbol] = boxedValue;
                        if (this[computedSource] <= propertySource) {
                            this[computedSource] = propertySource;
                            this[computedValue] = boxedValue;
                        }
                    }
                    var value = this[computedValue];
                    var source = this[computedSource];
                    var isSet = source !== 0;
                    var computedValueChanged = oldValue !== value && (!equalityComparer || !equalityComparer(oldValue, value));
                    if (computedValueChanged && valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative] && (computedValueChanged || isSet !== wasSet)) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (isSet) {
                                if (!wasSet && !(defaultValueKey in this)) {
                                    this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                                }
                                view[setNative](value);
                            }
                            else if (wasSet) {
                                if (defaultValueKey in this) {
                                    view[setNative](this[defaultValueKey]);
                                }
                                else {
                                    view[setNative](defaultValue);
                                }
                            }
                        }
                    }
                    if (computedValueChanged && this.hasListeners(eventName)) {
                        this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                    }
                }
            };
        }
        var defaultPropertyDescriptor = descriptor(defaultValueKey, 0, false, false, false);
        var cssPropertyDescriptor = descriptor(cssValue, 2, false, false, false);
        var stylePropertyDescriptor = descriptor(styleValue, 3, true, true, true);
        var keyframePropertyDescriptor = descriptor(keyframeValue, 4, false, false, false);
        symbolPropertyMap[computedValue] = this;
        cssSymbolPropertyMap[computedValue] = this;
        this.register = function (cls) {
            cls.prototype[computedValue] = options.defaultValue;
            cls.prototype[computedSource] = 0;
            cls.prototype[cssValue] = exports.unsetValue;
            cls.prototype[styleValue] = exports.unsetValue;
            cls.prototype[keyframeValue] = exports.unsetValue;
            Object.defineProperty(cls.prototype, defaultName, defaultPropertyDescriptor);
            Object.defineProperty(cls.prototype, cssName, cssPropertyDescriptor);
            Object.defineProperty(cls.prototype, propertyName, stylePropertyDescriptor);
            if (options.cssName && options.cssName !== options.name) {
                Object.defineProperty(cls.prototype, options.cssName, stylePropertyDescriptor);
            }
            Object.defineProperty(cls.prototype, keyframeName, keyframePropertyDescriptor);
        };
    }
    CssAnimationProperty.prototype._initDefaultNativeValue = function (target) {
        var view = target.viewRef.get();
        if (!view) {
            trace_1.write("_initDefaultNativeValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        var defaultValueKey = this.defaultValueKey;
        if (!(defaultValueKey in target)) {
            var getDefault = this.getDefault;
            target[defaultValueKey] = view[getDefault] ? view[getDefault]() : this.defaultValue;
        }
    };
    CssAnimationProperty._getByCssName = function (name) {
        return this.properties[name];
    };
    CssAnimationProperty._getPropertyNames = function () {
        return Object.keys(CssAnimationProperty.properties);
    };
    CssAnimationProperty.prototype.isSet = function (instance) {
        return instance[this.source] !== 0;
    };
    CssAnimationProperty.properties = {};
    return CssAnimationProperty;
}());
exports.CssAnimationProperty = CssAnimationProperty;
CssAnimationProperty.prototype.isStyleProperty = true;
var InheritedCssProperty = (function (_super) {
    __extends(InheritedCssProperty, _super);
    function InheritedCssProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var sourceKey = _this.sourceKey;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var eventName = propertyName + "Change";
        var defaultValue = options.defaultValue;
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = _this;
        var setFunc = function (valueSource) { return function (boxedValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(boxedValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = boxedValue === exports.unsetValue || boxedValue === "";
            var currentValueSource = this[sourceKey] || 0;
            if (reset) {
                if (valueSource === 2 && currentValueSource === 3) {
                    return;
                }
            }
            else {
                if (currentValueSource > valueSource) {
                    return;
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var value;
            var unsetNativeValue = false;
            if (reset) {
                var parent_2 = view.parent;
                var style = parent_2 ? parent_2.style : null;
                if (style && style[sourceKey] > 0) {
                    value = style[propertyName];
                    this[sourceKey] = 1;
                    this[key] = value;
                }
                else {
                    value = defaultValue;
                    delete this[sourceKey];
                    delete this[key];
                    unsetNativeValue = true;
                }
            }
            else {
                this[sourceKey] = valueSource;
                if (valueConverter && typeof boxedValue === "string") {
                    value = valueConverter(boxedValue);
                }
                else {
                    value = boxedValue;
                }
                this[key] = value;
            }
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (valueChanged) {
                    valueChanged(this, oldValue, value);
                }
                if (view[setNative]) {
                    if (view._suspendNativeUpdatesCount) {
                        if (view._suspendedUpdates) {
                            view._suspendedUpdates[propertyName] = property;
                        }
                    }
                    else {
                        if (unsetNativeValue) {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
                view.eachChild(function (child) {
                    var childStyle = child.style;
                    var childValueSource = childStyle[sourceKey] || 0;
                    if (reset) {
                        if (childValueSource === 1) {
                            setDefaultFunc.call(childStyle, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedFunc.call(childStyle, value);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setDefaultFunc = setFunc(0);
        var setInheritedFunc = setFunc(1);
        _this.setInheritedValue = setInheritedFunc;
        _this.cssValueDescriptor.set = setFunc(2);
        _this.localValueDescriptor.set = setFunc(3);
        inheritableCssProperties.push(_this);
        return _this;
    }
    return InheritedCssProperty;
}(CssProperty));
exports.InheritedCssProperty = InheritedCssProperty;
var ShorthandProperty = (function () {
    function ShorthandProperty(options) {
        this.name = options.name;
        var key = Symbol(this.name + ":propertyKey");
        this.key = key;
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = "" + options.cssName;
        var converter = options.converter;
        function setLocalValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setLocalValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.name] = v;
                }
            });
        }
        function setCssValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setCssValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.cssName] = v;
                }
            });
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setLocalValue
        };
        this.propertyBagDescriptor = {
            enumerable: false,
            configurable: true,
            set: function (value) {
                var _this = this;
                converter(value).forEach(function (_a) {
                    var property = _a[0], value = _a[1];
                    _this[property.cssLocalName] = value;
                });
            }
        };
        cssSymbolPropertyMap[key] = this;
    }
    ShorthandProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
        Object.defineProperty(cls.prototype.PropertyBag, this.cssLocalName, this.propertyBagDescriptor);
    };
    return ShorthandProperty;
}());
exports.ShorthandProperty = ShorthandProperty;
function inheritablePropertyValuesOn(view) {
    var array = new Array();
    for (var _i = 0, inheritableProperties_1 = inheritableProperties; _i < inheritableProperties_1.length; _i++) {
        var prop = inheritableProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = view[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: view[prop.name] });
        }
    }
    return array;
}
function inheritableCssPropertyValuesOn(style) {
    var array = new Array();
    for (var _i = 0, inheritableCssProperties_1 = inheritableCssProperties; _i < inheritableCssProperties_1.length; _i++) {
        var prop = inheritableCssProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = style[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: style[prop.name] });
        }
    }
    return array;
}
exports.initNativeView = profiling_1.profile("\"properties\".initNativeView", function initNativeView(view) {
    if (view._suspendedUpdates) {
        applyPendingNativeSetters(view);
    }
    else {
        applyAllNativeSetters(view);
    }
    view._suspendedUpdates = {};
});
function applyPendingNativeSetters(view) {
    var suspendedUpdates = view._suspendedUpdates;
    for (var propertyName in suspendedUpdates) {
        var property = suspendedUpdates[propertyName];
        var setNative = property.setNative;
        if (view[setNative]) {
            var getDefault = property.getDefault, isStyleProperty = property.isStyleProperty, defaultValueKey = property.defaultValueKey, defaultValue = property.defaultValue;
            var value = void 0;
            if (isStyleProperty) {
                var style = view.style;
                if (property.isSet(view.style)) {
                    if (!(defaultValueKey in style)) {
                        style[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view.style[propertyName];
                }
                else {
                    value = style[defaultValueKey];
                }
            }
            else {
                if (property.isSet(view)) {
                    if (!(defaultValueKey in view)) {
                        view[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view[propertyName];
                }
                else {
                    value = view[defaultValueKey];
                }
            }
            view[setNative](value);
        }
    }
}
exports.applyPendingNativeSetters = applyPendingNativeSetters;
function applyAllNativeSetters(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_2 = symbols; _i < symbols_2.length; _i++) {
        var symbol = symbols_2[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var setNative = property.setNative;
        var getDefault = property.getDefault;
        if (setNative in view) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in view)) {
                view[defaultValueKey] = view[getDefault] ? view[getDefault]() : property.defaultValue;
            }
            var value = view[symbol];
            view[setNative](value);
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_3 = symbols; _a < symbols_3.length; _a++) {
        var symbol = symbols_3[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in style)) {
                style[defaultValueKey] = view[property.getDefault] ? view[property.getDefault]() : property.defaultValue;
            }
            var value = style[symbol];
            view[property.setNative](value);
        }
    }
}
exports.applyAllNativeSetters = applyAllNativeSetters;
function resetNativeView(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_4 = symbols; _i < symbols_4.length; _i++) {
        var symbol = symbols_4[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in view) {
                view[property.setNative](view[property.defaultValueKey]);
                delete view[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_5 = symbols; _a < symbols_5.length; _a++) {
        var symbol = symbols_5[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in style) {
                view[property.setNative](style[property.defaultValueKey]);
                delete style[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
}
exports.resetNativeView = resetNativeView;
function clearInheritedProperties(view) {
    for (var _i = 0, inheritableProperties_2 = inheritableProperties; _i < inheritableProperties_2.length; _i++) {
        var prop = inheritableProperties_2[_i];
        var sourceKey = prop.sourceKey;
        if (view[sourceKey] === 1) {
            prop.set.call(view, exports.unsetValue);
        }
    }
    var style = view.style;
    for (var _a = 0, inheritableCssProperties_2 = inheritableCssProperties; _a < inheritableCssProperties_2.length; _a++) {
        var prop = inheritableCssProperties_2[_a];
        var sourceKey = prop.sourceKey;
        if (style[sourceKey] === 1) {
            prop.setInheritedValue.call(style, exports.unsetValue);
        }
    }
}
exports.clearInheritedProperties = clearInheritedProperties;
function resetCSSProperties(style) {
    var symbols = Object.getOwnPropertySymbols(style);
    for (var _i = 0, symbols_6 = symbols; _i < symbols_6.length; _i++) {
        var symbol = symbols_6[_i];
        var cssProperty = void 0;
        if (cssProperty = cssSymbolPropertyMap[symbol]) {
            style[cssProperty.cssName] = exports.unsetValue;
            if (cssProperty instanceof CssAnimationProperty) {
                style[cssProperty.keyframe] = exports.unsetValue;
            }
        }
    }
}
exports.resetCSSProperties = resetCSSProperties;
function propagateInheritableProperties(view, child) {
    var inheritablePropertyValues = inheritablePropertyValuesOn(view);
    for (var _i = 0, inheritablePropertyValues_1 = inheritablePropertyValues; _i < inheritablePropertyValues_1.length; _i++) {
        var pair = inheritablePropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = child[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(child, pair.value);
        }
    }
}
exports.propagateInheritableProperties = propagateInheritableProperties;
function propagateInheritableCssProperties(parentStyle, childStyle) {
    var inheritableCssPropertyValues = inheritableCssPropertyValuesOn(parentStyle);
    for (var _i = 0, inheritableCssPropertyValues_1 = inheritableCssPropertyValues; _i < inheritableCssPropertyValues_1.length; _i++) {
        var pair = inheritableCssPropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = childStyle[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(childStyle, pair.value, 1);
        }
    }
}
exports.propagateInheritableCssProperties = propagateInheritableCssProperties;
function makeValidator() {
    var values = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        values[_i] = arguments[_i];
    }
    var set = new Set(values);
    return function (value) { return set.has(value); };
}
exports.makeValidator = makeValidator;
function makeParser(isValid) {
    return function (value) {
        var lower = value && value.toLowerCase();
        if (isValid(lower)) {
            return lower;
        }
        else {
            throw new Error("Invalid value: " + value);
        }
    };
}
exports.makeParser = makeParser;
function getSetProperties(view) {
    var result = [];
    Object.getOwnPropertyNames(view).forEach(function (prop) {
        result.push([prop, view[prop]]);
    });
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_7 = symbols; _i < symbols_7.length; _i++) {
        var symbol = symbols_7[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var value = view[property.key];
        result.push([property.name, value]);
    }
    return result;
}
exports.getSetProperties = getSetProperties;
function getComputedCssValues(view) {
    var result = [];
    var style = view.style;
    for (var _i = 0, cssPropertyNames_1 = cssPropertyNames; _i < cssPropertyNames_1.length; _i++) {
        var prop = cssPropertyNames_1[_i];
        result.push([prop, style[prop]]);
    }
    result.push(["top", "auto"]);
    result.push(["left", "auto"]);
    result.push(["bottom", "auto"]);
    result.push(["right", "auto"]);
    return result;
}
exports.getComputedCssValues = getComputedCssValues;
//# sourceMappingURL=properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view-base/view-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.isIOS = platform_1.isIOS;
exports.isAndroid = platform_1.isAndroid;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.layout = utils_1.layout;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js"));
var ssm = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var domNodeModule;
function ensuredomNodeModule() {
    if (!domNodeModule) {
        domNodeModule = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
    }
}
var styleScopeModule;
function ensureStyleScopeModule() {
    if (!styleScopeModule) {
        styleScopeModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
    }
}
var defaultBindingSource = {};
function getAncestor(view, criterion) {
    var matcher = null;
    if (typeof criterion === "string") {
        matcher = function (view) { return view.typeName === criterion; };
    }
    else {
        matcher = function (view) { return view instanceof criterion; };
    }
    for (var parent_1 = view.parent; parent_1 != null; parent_1 = parent_1.parent) {
        if (matcher(parent_1)) {
            return parent_1;
        }
    }
    return null;
}
exports.getAncestor = getAncestor;
function getViewById(view, id) {
    if (!view) {
        return undefined;
    }
    if (view.id === id) {
        return view;
    }
    var retVal;
    var descendantsCallback = function (child) {
        if (child.id === id) {
            retVal = child;
            return false;
        }
        return true;
    };
    eachDescendant(view, descendantsCallback);
    return retVal;
}
exports.getViewById = getViewById;
function eachDescendant(view, callback) {
    if (!callback || !view) {
        return;
    }
    var continueIteration;
    var localCallback = function (child) {
        continueIteration = callback(child);
        if (continueIteration) {
            child.eachChild(localCallback);
        }
        return continueIteration;
    };
    view.eachChild(localCallback);
}
exports.eachDescendant = eachDescendant;
var viewIdCounter = 1;
var Flags;
(function (Flags) {
    Flags["superOnLoadedCalled"] = "Loaded";
    Flags["superOnUnloadedCalled"] = "Unloaded";
})(Flags || (Flags = {}));
var SuspendType;
(function (SuspendType) {
    SuspendType[SuspendType["Incremental"] = 0] = "Incremental";
    SuspendType[SuspendType["Loaded"] = 1048576] = "Loaded";
    SuspendType[SuspendType["NativeView"] = 2097152] = "NativeView";
    SuspendType[SuspendType["UISetup"] = 4194304] = "UISetup";
    SuspendType[SuspendType["IncrementalCountMask"] = -7340033] = "IncrementalCountMask";
})(SuspendType || (SuspendType = {}));
(function (SuspendType) {
    function toString(type) {
        return (type ? "suspended" : "resumed") + "(" +
            "Incremental: " + (type & SuspendType.IncrementalCountMask) + ", " +
            "Loaded: " + !(type & SuspendType.Loaded) + ", " +
            "NativeView: " + !(type & SuspendType.NativeView) + ", " +
            "UISetup: " + !(type & SuspendType.UISetup) +
            ")";
    }
    SuspendType.toString = toString;
})(SuspendType || (SuspendType = {}));
var ViewBase = (function (_super) {
    __extends(ViewBase, _super);
    function ViewBase() {
        var _this = _super.call(this) || this;
        _this._onLoadedCalled = false;
        _this._onUnloadedCalled = false;
        _this._cssState = new ssm.CssState(new WeakRef(_this));
        _this.pseudoClassAliases = {
            "highlighted": [
                "active",
                "pressed"
            ]
        };
        _this.cssClasses = new Set();
        _this.cssPseudoClasses = new Set();
        _this._domId = viewIdCounter++;
        _this._style = new properties_1.Style(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(ViewBase.prototype, "parentNode", {
        get: function () {
            return this._templateParent || this.parent;
        },
        set: function (node) {
            this._templateParent = node;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "nativeView", {
        get: function () {
            return this.nativeViewProtected;
        },
        set: function (value) {
            this.setNativeView(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "typeName", {
        get: function () {
            return types.getClass(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "style", {
        get: function () {
            return this._style;
        },
        set: function (inlineStyle) {
            if (typeof inlineStyle === "string") {
                this.setInlineStyle(inlineStyle);
            }
            else {
                throw new Error("View.style property is read-only.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "android", {
        get: function () {
            return this._androidView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "ios", {
        get: function () {
            return this._iosView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "isLoaded", {
        get: function () {
            return this._isLoaded;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "class", {
        get: function () {
            return this.className;
        },
        set: function (v) {
            this.className = v;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.getViewById = function (id) {
        return getViewById(this, id);
    };
    Object.defineProperty(ViewBase.prototype, "page", {
        get: function () {
            if (this.parent) {
                return this.parent.page;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.ensureDomNode = function () {
        if (!this.domNode) {
            ensuredomNodeModule();
            this.domNode = new domNodeModule.DOMNode(this);
        }
    };
    ViewBase.prototype.set = function (name, value) {
        this[name] = bindable_1.WrappedValue.unwrap(value);
    };
    ViewBase.prototype.onLoaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnLoadedCalled, true);
        if (this._isLoaded) {
            return;
        }
        this._isLoaded = true;
        this._cssState.onLoaded();
        this._resumeNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.loadView(child);
            return true;
        });
        this._emit("loaded");
    };
    ViewBase.prototype.onUnloaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnUnloadedCalled, true);
        if (!this._isLoaded) {
            return;
        }
        this._suspendNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.unloadView(child);
            return true;
        });
        this._isLoaded = false;
        this._cssState.onUnloaded();
        this._emit("unloaded");
    };
    ViewBase.prototype._suspendNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount | type;
        }
        else {
            this._suspendNativeUpdatesCount++;
        }
    };
    ViewBase.prototype._resumeNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount & ~type;
        }
        else {
            if ((this._suspendNativeUpdatesCount & SuspendType.IncrementalCountMask) === 0) {
                throw new Error("Invalid call to " + this + "._resumeNativeUpdates");
            }
            this._suspendNativeUpdatesCount--;
        }
        if (!this._suspendNativeUpdatesCount) {
            this.onResumeNativeUpdates();
        }
    };
    ViewBase.prototype._batchUpdate = function (callback) {
        try {
            this._suspendNativeUpdates(SuspendType.Incremental);
            return callback();
        }
        finally {
            this._resumeNativeUpdates(SuspendType.Incremental);
        }
    };
    ViewBase.prototype.setFlag = function (flag, value) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                this._onLoadedCalled = value;
                break;
            case Flags.superOnUnloadedCalled:
                this._onUnloadedCalled = value;
                break;
        }
    };
    ViewBase.prototype.isFlagSet = function (flag) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                return this._onLoadedCalled;
            case Flags.superOnUnloadedCalled:
                return this._onUnloadedCalled;
        }
    };
    ViewBase.prototype.callFunctionWithSuper = function (flag, func) {
        this.setFlag(flag, false);
        func();
        if (!this.isFlagSet(flag)) {
            throw new Error("super." + flag + " not called in " + this);
        }
    };
    ViewBase.prototype.callLoaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnLoadedCalled, function () { return _this.onLoaded(); });
    };
    ViewBase.prototype.callUnloaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnUnloadedCalled, function () { return _this.onUnloaded(); });
    };
    ViewBase.prototype.notifyPseudoClassChanged = function (pseudoClass) {
        this.notify({ eventName: ":" + pseudoClass, object: this });
    };
    ViewBase.prototype.getAllAliasedStates = function (name) {
        var allStates = [];
        allStates.push(name);
        if (name in this.pseudoClassAliases) {
            for (var i = 0; i < this.pseudoClassAliases[name].length; i++) {
                allStates.push(this.pseudoClassAliases[name][i]);
            }
        }
        return allStates;
    };
    ViewBase.prototype.addPseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (!this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.add(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.deletePseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.delete(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.bindingContextChanged = function (data) {
        this.bindings.get("bindingContext").bind(data.value);
    };
    ViewBase.prototype.bind = function (options, source) {
        if (source === void 0) { source = defaultBindingSource; }
        var targetProperty = options.targetProperty;
        this.unbind(targetProperty);
        if (!this.bindings) {
            this.bindings = new Map();
        }
        var binding = new bindable_1.Binding(this, options);
        this.bindings.set(targetProperty, binding);
        var bindingSource = source;
        if (bindingSource === defaultBindingSource) {
            bindingSource = this.bindingContext;
            binding.sourceIsBindingContext = true;
            if (targetProperty === "bindingContext") {
                this.bindingContextBoundToParentBindingContextChanged = true;
                var parent_2 = this.parent;
                if (parent_2) {
                    parent_2.on("bindingContextChange", this.bindingContextChanged, this);
                }
                else {
                    this.shouldAddHandlerToParentBindingContextChanged = true;
                }
            }
        }
        binding.bind(bindingSource);
    };
    ViewBase.prototype.unbind = function (property) {
        var bindings = this.bindings;
        if (!bindings) {
            return;
        }
        var binding = bindings.get(property);
        if (binding) {
            binding.unbind();
            bindings.delete(property);
            if (binding.sourceIsBindingContext) {
                if (property === "bindingContext") {
                    this.shouldAddHandlerToParentBindingContextChanged = false;
                    this.bindingContextBoundToParentBindingContextChanged = false;
                    var parent_3 = this.parent;
                    if (parent_3) {
                        parent_3.off("bindingContextChange", this.bindingContextChanged, this);
                    }
                }
            }
        }
    };
    ViewBase.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    ViewBase.prototype.eachChild = function (callback) {
    };
    ViewBase.prototype._addView = function (view, atIndex) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._addView(" + view + ", " + atIndex + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (!view) {
            throw new Error("Expecting a valid View instance.");
        }
        if (!(view instanceof ViewBase)) {
            throw new Error(view + " is not a valid View instance.");
        }
        if (view.parent) {
            throw new Error("View already has a parent. View: " + view + " Parent: " + view.parent);
        }
        view.parent = this;
        this._addViewCore(view, atIndex);
        view._parentChanged(null);
        if (this.domNode) {
            this.domNode.onChildAdded(view);
        }
    };
    ViewBase.prototype._addViewCore = function (view, atIndex) {
        properties_1.propagateInheritableProperties(this, view);
        view._inheritStyleScope(this._styleScope);
        properties_1.propagateInheritableCssProperties(this.style, view.style);
        if (this._context) {
            view._setupUI(this._context, atIndex);
        }
        if (this._isLoaded) {
            this.loadView(view);
        }
    };
    ViewBase.prototype.loadView = function (view) {
        if (view && !view.isLoaded) {
            view.callLoaded();
        }
    };
    ViewBase.prototype.unloadView = function (view) {
        if (view && view.isLoaded) {
            view.callUnloaded();
        }
    };
    ViewBase.prototype._removeView = function (view) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._removeView(" + view + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (view.parent !== this) {
            throw new Error("View not added to this instance. View: " + view + " CurrentParent: " + view.parent + " ExpectedParent: " + this);
        }
        if (this.domNode) {
            this.domNode.onChildRemoved(view);
        }
        this._removeViewCore(view);
        view.parent = undefined;
        view._parentChanged(this);
    };
    ViewBase.prototype._removeViewCore = function (view) {
        this.unloadView(view);
        if (view._context) {
            view._tearDownUI();
        }
    };
    ViewBase.prototype.createNativeView = function () {
        return undefined;
    };
    ViewBase.prototype.disposeNativeView = function () {
    };
    ViewBase.prototype.initNativeView = function () {
    };
    ViewBase.prototype.resetNativeView = function () {
    };
    ViewBase.prototype.resetNativeViewInternal = function () {
    };
    ViewBase.prototype._setupAsRootView = function (context) {
        this._setupUI(context);
    };
    ViewBase.prototype._setupUI = function (context, atIndex, parentIsLoaded) {
        if (this._context === context) {
            return;
        }
        else if (this._context) {
            this._tearDownUI(true);
        }
        this._context = context;
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            nativeView = this.createNativeView();
        }
        if (platform_1.isAndroid) {
            this._androidView = nativeView;
            if (nativeView) {
                if (this._isPaddingRelative === undefined) {
                    this._isPaddingRelative = nativeView.isPaddingRelative();
                }
                var result = nativeView.defaultPaddings;
                if (result === undefined) {
                    result = org.nativescript.widgets.ViewHelper.getPadding(nativeView);
                    nativeView.defaultPaddings = result;
                }
                this._defaultPaddingTop = result.top;
                this._defaultPaddingRight = result.right;
                this._defaultPaddingBottom = result.bottom;
                this._defaultPaddingLeft = result.left;
                var style = this.style;
                if (!style_properties_1.paddingTopProperty.isSet(style)) {
                    this.effectivePaddingTop = this._defaultPaddingTop;
                }
                if (!style_properties_1.paddingRightProperty.isSet(style)) {
                    this.effectivePaddingRight = this._defaultPaddingRight;
                }
                if (!style_properties_1.paddingBottomProperty.isSet(style)) {
                    this.effectivePaddingBottom = this._defaultPaddingBottom;
                }
                if (!style_properties_1.paddingLeftProperty.isSet(style)) {
                    this.effectivePaddingLeft = this._defaultPaddingLeft;
                }
            }
        }
        else {
            this._iosView = nativeView;
        }
        this.setNativeView(nativeView);
        if (this.parent) {
            var nativeIndex = this.parent._childIndexToNativeChildIndex(atIndex);
            this._isAddedToNativeVisualTree = this.parent._addViewToNativeVisualTree(this, nativeIndex);
        }
        this._resumeNativeUpdates(SuspendType.UISetup);
        this.eachChild(function (child) {
            child._setupUI(context);
            return true;
        });
    };
    ViewBase.prototype.setNativeView = function (value) {
        if (this.__nativeView === value) {
            return;
        }
        if (this.__nativeView) {
            this._suspendNativeUpdates(SuspendType.NativeView);
        }
        this.__nativeView = this.nativeViewProtected = value;
        if (this.__nativeView) {
            this._suspendedUpdates = undefined;
            this.initNativeView();
            this._resumeNativeUpdates(SuspendType.NativeView);
        }
    };
    ViewBase.prototype._tearDownUI = function (force) {
        if (!this._context) {
            return;
        }
        this.resetNativeViewInternal();
        this.eachChild(function (child) {
            child._tearDownUI(force);
            return true;
        });
        if (this.parent) {
            this.parent._removeViewFromNativeVisualTree(this);
        }
        this.disposeNativeView();
        this._suspendNativeUpdates(SuspendType.UISetup);
        if (platform_1.isAndroid) {
            this.setNativeView(null);
            this._androidView = null;
        }
        this._context = null;
        if (this.domNode) {
            this.domNode.dispose();
            this.domNode = undefined;
        }
    };
    ViewBase.prototype._childIndexToNativeChildIndex = function (index) {
        return index;
    };
    ViewBase.prototype._addViewToNativeVisualTree = function (view, atIndex) {
        if (view._isAddedToNativeVisualTree) {
            throw new Error("Child already added to the native visual tree.");
        }
        return true;
    };
    ViewBase.prototype._removeViewFromNativeVisualTree = function (view) {
        view._isAddedToNativeVisualTree = false;
    };
    ViewBase.prototype._goToVisualState = function (state) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + " going to state: " + state, bindable_1.traceCategories.Style);
        }
        if (state === this._visualState) {
            return;
        }
        this.deletePseudoClass(this._visualState);
        this._visualState = state;
        this.addPseudoClass(state);
    };
    ViewBase.prototype._applyXmlAttribute = function (attribute, value) {
        console.log("ViewBase._applyXmlAttribute(...) is deprecated; set attributes as plain properties instead");
        if (attribute === "style" || attribute === "rows" || attribute === "columns" || attribute === "fontAttributes") {
            this[attribute] = value;
            return true;
        }
        return false;
    };
    ViewBase.prototype.setInlineStyle = function (style) {
        if (typeof style !== "string") {
            throw new Error("Parameter should be valid CSS string!");
        }
        ensureStyleScopeModule();
        styleScopeModule.applyInlineStyle(this, style);
    };
    ViewBase.prototype._parentChanged = function (oldParent) {
        var newParent = this.parent;
        if (oldParent) {
            properties_1.clearInheritedProperties(this);
            if (this.bindingContextBoundToParentBindingContextChanged) {
                oldParent.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        else if (this.shouldAddHandlerToParentBindingContextChanged) {
            newParent.on("bindingContextChange", this.bindingContextChanged, this);
            this.bindings.get("bindingContext").bind(newParent.bindingContext);
        }
    };
    ViewBase.prototype.onResumeNativeUpdates = function () {
        properties_1.initNativeView(this);
    };
    ViewBase.prototype.toString = function () {
        var str = this.typeName;
        if (this.id) {
            str += "<" + this.id + ">";
        }
        else {
            str += "(" + this._domId + ")";
        }
        var source = debug_1.Source.get(this);
        if (source) {
            str += "@" + source + ";";
        }
        return str;
    };
    ViewBase.prototype._onCssStateChange = function () {
        this._cssState.onChange();
        eachDescendant(this, function (child) {
            child._cssState.onChange();
            return true;
        });
    };
    ViewBase.prototype._inheritStyleScope = function (styleScope) {
        if (this._isStyleScopeHost) {
            return;
        }
        if (this._styleScope !== styleScope) {
            this._styleScope = styleScope;
            this._onCssStateChange();
            this.eachChild(function (child) {
                child._inheritStyleScope(styleScope);
                return true;
            });
        }
    };
    ViewBase.prototype.showModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        return parent && parent.showModal.apply(parent, args);
    };
    ViewBase.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        if (parent) {
            parent.closeModal.apply(parent, args);
        }
    };
    ViewBase.prototype._dialogClosed = function () {
        eachDescendant(this, function (child) {
            child._dialogClosed();
            return true;
        });
    };
    ViewBase.prototype._onRootViewReset = function () {
        eachDescendant(this, function (child) {
            child._onRootViewReset();
            return true;
        });
    };
    ViewBase.loadedEvent = "loaded";
    ViewBase.unloadedEvent = "unloaded";
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "addPseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "deletePseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "requestLayout", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_addView", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_setupUI", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_tearDownUI", null);
    return ViewBase;
}(bindable_1.Observable));
exports.ViewBase = ViewBase;
ViewBase.prototype.isCollapsed = false;
ViewBase.prototype._oldLeft = 0;
ViewBase.prototype._oldTop = 0;
ViewBase.prototype._oldRight = 0;
ViewBase.prototype._oldBottom = 0;
ViewBase.prototype.effectiveMinWidth = 0;
ViewBase.prototype.effectiveMinHeight = 0;
ViewBase.prototype.effectiveWidth = 0;
ViewBase.prototype.effectiveHeight = 0;
ViewBase.prototype.effectiveMarginTop = 0;
ViewBase.prototype.effectiveMarginRight = 0;
ViewBase.prototype.effectiveMarginBottom = 0;
ViewBase.prototype.effectiveMarginLeft = 0;
ViewBase.prototype.effectivePaddingTop = 0;
ViewBase.prototype.effectivePaddingRight = 0;
ViewBase.prototype.effectivePaddingBottom = 0;
ViewBase.prototype.effectivePaddingLeft = 0;
ViewBase.prototype.effectiveBorderTopWidth = 0;
ViewBase.prototype.effectiveBorderRightWidth = 0;
ViewBase.prototype.effectiveBorderBottomWidth = 0;
ViewBase.prototype.effectiveBorderLeftWidth = 0;
ViewBase.prototype._defaultPaddingTop = 0;
ViewBase.prototype._defaultPaddingRight = 0;
ViewBase.prototype._defaultPaddingBottom = 0;
ViewBase.prototype._defaultPaddingLeft = 0;
ViewBase.prototype._isViewBase = true;
ViewBase.prototype.recycleNativeView = "never";
ViewBase.prototype._suspendNativeUpdatesCount =
    SuspendType.Loaded |
        SuspendType.NativeView |
        SuspendType.UISetup;
exports.bindingContextProperty = new properties_1.InheritedProperty({ name: "bindingContext" });
exports.bindingContextProperty.register(ViewBase);
exports.classNameProperty = new properties_1.Property({
    name: "className",
    valueChanged: function (view, oldValue, newValue) {
        var classes = view.cssClasses;
        classes.clear();
        if (typeof newValue === "string" && newValue !== "") {
            newValue.split(" ").forEach(function (c) { return classes.add(c); });
        }
        view._onCssStateChange();
    }
});
exports.classNameProperty.register(ViewBase);
exports.idProperty = new properties_1.Property({ name: "id", valueChanged: function (view, oldValue, newValue) { return view._onCssStateChange(); } });
exports.idProperty.register(ViewBase);
function booleanConverter(v) {
    var lowercase = (v + "").toLowerCase();
    if (lowercase === "true") {
        return true;
    }
    else if (lowercase === "false") {
        return false;
    }
    throw new Error("Invalid boolean: " + v);
}
exports.booleanConverter = booleanConverter;
//# sourceMappingURL=view-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var style_scope_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
exports.LinearGradient = linear_gradient_1.LinearGradient;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js"));
var animationModule;
function ensureAnimationModule() {
    if (!animationModule) {
        animationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
    }
}
function CSSType(type) {
    return function (cls) {
        cls.prototype.cssType = type;
    };
}
exports.CSSType = CSSType;
function viewMatchesModuleContext(view, context, types) {
    return context &&
        view._moduleName &&
        context.type &&
        types.some(function (type) { return type === context.type; }) &&
        context.path &&
        context.path.includes(view._moduleName);
}
exports.viewMatchesModuleContext = viewMatchesModuleContext;
function PseudoClassHandler() {
    var pseudoClasses = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        pseudoClasses[_i] = arguments[_i];
    }
    var stateEventNames = pseudoClasses.map(function (s) { return ":" + s; });
    var listeners = Symbol("listeners");
    return function (target, propertyKey, descriptor) {
        function update(change) {
            var prev = this[listeners] || 0;
            var next = prev + change;
            if (prev <= 0 && next > 0) {
                this[propertyKey](true);
            }
            else if (prev > 0 && next <= 0) {
                this[propertyKey](false);
            }
        }
        stateEventNames.forEach(function (s) { return target[s] = update; });
    };
}
exports.PseudoClassHandler = PseudoClassHandler;
exports._rootModalViews = new Array();
var ViewCommon = (function (_super) {
    __extends(ViewCommon, _super);
    function ViewCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._gestureObservers = {};
        return _this;
    }
    Object.defineProperty(ViewCommon.prototype, "css", {
        get: function () {
            var scope = this._styleScope;
            return scope && scope.css;
        },
        set: function (value) {
            this._updateStyleScope(undefined, undefined, value);
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.addCss = function (cssString) {
        this._updateStyleScope(undefined, cssString);
    };
    ViewCommon.prototype.addCssFile = function (cssFileName) {
        this._updateStyleScope(cssFileName);
    };
    ViewCommon.prototype.changeCssFile = function (cssFileName) {
        var scope = this._styleScope;
        if (scope && cssFileName) {
            scope.changeCssFile(cssFileName);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype._updateStyleScope = function (cssFileName, cssString, css) {
        var scope = this._styleScope;
        if (!scope) {
            scope = new style_scope_1.StyleScope();
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._inheritStyleScope(scope);
            this._isStyleScopeHost = true;
        }
        else {
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype.setScopeProperty = function (scope, cssFileName, cssString, css) {
        if (cssFileName !== undefined) {
            scope.addCssFile(cssFileName);
        }
        else if (cssString !== undefined) {
            scope.addCss(cssString);
        }
        else if (css !== undefined) {
            scope.css = css;
        }
    };
    ViewCommon.prototype._onLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._onLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (this._handleLivesync(context)) {
            return true;
        }
        var handled = false;
        this.eachChildView(function (child) {
            if (child._onLivesync(context)) {
                handled = true;
                return false;
            }
        });
        return handled;
    };
    ViewCommon.prototype._handleLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._handleLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (viewMatchesModuleContext(this, context, ["style"])) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing CSS for " + this, view_base_1.traceCategories.Livesync);
            }
            var cssModuleName = module_name_sanitizer_1.sanitizeModuleName(context.path) + ".css";
            this.changeCssFile(cssModuleName);
            return true;
        }
        if (viewMatchesModuleContext(this, context, ["markup", "script"]) &&
            this.page &&
            this.page.frame) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing " + context.type + " for " + this + " inside " + this.page, view_base_1.traceCategories.Livesync);
            }
            return this.page.frame._handleLivesync({ type: context.type, path: this.page._moduleName });
        }
        return false;
    };
    ViewCommon.prototype._setupAsRootView = function (context) {
        _super.prototype._setupAsRootView.call(this, context);
        if (!this._styleScope) {
            this._updateStyleScope();
        }
    };
    ViewCommon.prototype._observe = function (type, callback, thisArg) {
        if (!this._gestureObservers[type]) {
            this._gestureObservers[type] = [];
        }
        this._gestureObservers[type].push(gestures_1.observe(this, type, callback, thisArg));
    };
    ViewCommon.prototype.getGestureObservers = function (type) {
        return this._gestureObservers[type];
    };
    ViewCommon.prototype.addEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            arg = view_base_1.getEventOrGestureName(arg);
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._observe(gesture, callback, thisArg);
            }
            else {
                var events = (arg).split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._observe(gst, callback, thisArg);
                        }
                        else {
                            _super.prototype.addEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.addEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._observe(arg, callback, thisArg);
        }
    };
    ViewCommon.prototype.removeEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._disconnectGestureObservers(gesture);
            }
            else {
                var events = arg.split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._disconnectGestureObservers(gst);
                        }
                        else {
                            _super.prototype.removeEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._disconnectGestureObservers(arg);
        }
    };
    ViewCommon.prototype.onBackPressed = function () {
        return false;
    };
    ViewCommon.prototype._getFragmentManager = function () {
        return undefined;
    };
    ViewCommon.prototype.getModalOptions = function (args) {
        if (args.length === 0) {
            throw new Error("showModal without parameters is deprecated. Please call showModal on a view instance instead.");
        }
        else {
            var options = null;
            if (args.length === 2) {
                options = args[1];
            }
            else {
                if (args[0] instanceof ViewCommon) {
                    console.log("showModal(view: ViewBase, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(view: ViewBase, modalOptions: ShowModalOptions) instead.");
                }
                else {
                    console.log("showModal(moduleName: string, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(moduleName: string, modalOptions: ShowModalOptions) instead.");
                }
                options = {
                    context: args[1],
                    closeCallback: args[2],
                    fullscreen: args[3],
                    animated: args[4],
                    stretched: args[5]
                };
            }
            var firstArgument = args[0];
            var view = firstArgument instanceof ViewCommon
                ? firstArgument : builder_1.createViewFromEntry({ moduleName: firstArgument });
            return { view: view, options: options };
        }
    };
    ViewCommon.prototype.showModal = function () {
        var _a = this.getModalOptions(arguments), view = _a.view, options = _a.options;
        view._showNativeModalView(this, options);
        return view;
    };
    ViewCommon.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var closeCallback = this._closeModalCallback;
        if (closeCallback) {
            closeCallback.apply(undefined, arguments);
        }
        else {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1.closeModal.apply(parent_1, args);
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "modal", {
        get: function () {
            return this._modal;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype._showNativeModalView = function (parent, options) {
        exports._rootModalViews.push(this);
        parent._modal = this;
        this._modalParent = parent;
        this._modalContext = options.context;
        var that = this;
        this._closeModalCallback = function () {
            var originalArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                originalArgs[_i] = arguments[_i];
            }
            if (that._closeModalCallback) {
                var modalIndex = exports._rootModalViews.indexOf(that);
                exports._rootModalViews.splice(modalIndex);
                that._modalParent = null;
                that._modalContext = null;
                that._closeModalCallback = null;
                that._dialogClosed();
                parent._modal = null;
                var whenClosedCallback = function () {
                    if (typeof options.closeCallback === "function") {
                        options.closeCallback.apply(undefined, originalArgs);
                    }
                };
                that._hideNativeModalView(parent, whenClosedCallback);
            }
        };
    };
    ViewCommon.prototype._raiseLayoutChangedEvent = function () {
        var args = {
            eventName: ViewCommon.layoutChangedEvent,
            object: this
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShownModallyEvent = function () {
        var args = {
            eventName: ViewCommon.shownModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShowingModallyEvent = function () {
        var args = {
            eventName: ViewCommon.showingModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._isEvent = function (name) {
        return this.constructor && name + "Event" in this.constructor;
    };
    ViewCommon.prototype._disconnectGestureObservers = function (type) {
        var observers = this.getGestureObservers(type);
        if (observers) {
            for (var i = 0; i < observers.length; i++) {
                observers[i].disconnect();
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "borderColor", {
        get: function () {
            return this.style.borderColor;
        },
        set: function (value) {
            this.style.borderColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopColor", {
        get: function () {
            return this.style.borderTopColor;
        },
        set: function (value) {
            this.style.borderTopColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightColor", {
        get: function () {
            return this.style.borderRightColor;
        },
        set: function (value) {
            this.style.borderRightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomColor", {
        get: function () {
            return this.style.borderBottomColor;
        },
        set: function (value) {
            this.style.borderBottomColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftColor", {
        get: function () {
            return this.style.borderLeftColor;
        },
        set: function (value) {
            this.style.borderLeftColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderWidth", {
        get: function () {
            return this.style.borderWidth;
        },
        set: function (value) {
            this.style.borderWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopWidth", {
        get: function () {
            return this.style.borderTopWidth;
        },
        set: function (value) {
            this.style.borderTopWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightWidth", {
        get: function () {
            return this.style.borderRightWidth;
        },
        set: function (value) {
            this.style.borderRightWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomWidth", {
        get: function () {
            return this.style.borderBottomWidth;
        },
        set: function (value) {
            this.style.borderBottomWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftWidth", {
        get: function () {
            return this.style.borderLeftWidth;
        },
        set: function (value) {
            this.style.borderLeftWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRadius", {
        get: function () {
            return this.style.borderRadius;
        },
        set: function (value) {
            this.style.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopLeftRadius", {
        get: function () {
            return this.style.borderTopLeftRadius;
        },
        set: function (value) {
            this.style.borderTopLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopRightRadius", {
        get: function () {
            return this.style.borderTopRightRadius;
        },
        set: function (value) {
            this.style.borderTopRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomRightRadius", {
        get: function () {
            return this.style.borderBottomRightRadius;
        },
        set: function (value) {
            this.style.borderBottomRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomLeftRadius", {
        get: function () {
            return this.style.borderBottomLeftRadius;
        },
        set: function (value) {
            this.style.borderBottomLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "background", {
        get: function () {
            return this.style.background;
        },
        set: function (value) {
            this.style.background = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundImage", {
        get: function () {
            return this.style.backgroundImage;
        },
        set: function (value) {
            this.style.backgroundImage = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundSize", {
        get: function () {
            return this.style.backgroundSize;
        },
        set: function (value) {
            this.style.backgroundSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundPosition", {
        get: function () {
            return this.style.backgroundPosition;
        },
        set: function (value) {
            this.style.backgroundPosition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundRepeat", {
        get: function () {
            return this.style.backgroundRepeat;
        },
        set: function (value) {
            this.style.backgroundRepeat = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minWidth", {
        get: function () {
            return this.style.minWidth;
        },
        set: function (value) {
            this.style.minWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minHeight", {
        get: function () {
            return this.style.minHeight;
        },
        set: function (value) {
            this.style.minHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "width", {
        get: function () {
            return this.style.width;
        },
        set: function (value) {
            this.style.width = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "height", {
        get: function () {
            return this.style.height;
        },
        set: function (value) {
            this.style.height = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "margin", {
        get: function () {
            return this.style.margin;
        },
        set: function (value) {
            this.style.margin = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginLeft", {
        get: function () {
            return this.style.marginLeft;
        },
        set: function (value) {
            this.style.marginLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginTop", {
        get: function () {
            return this.style.marginTop;
        },
        set: function (value) {
            this.style.marginTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginRight", {
        get: function () {
            return this.style.marginRight;
        },
        set: function (value) {
            this.style.marginRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginBottom", {
        get: function () {
            return this.style.marginBottom;
        },
        set: function (value) {
            this.style.marginBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "horizontalAlignment", {
        get: function () {
            return this.style.horizontalAlignment;
        },
        set: function (value) {
            this.style.horizontalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "verticalAlignment", {
        get: function () {
            return this.style.verticalAlignment;
        },
        set: function (value) {
            this.style.verticalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "visibility", {
        get: function () {
            return this.style.visibility;
        },
        set: function (value) {
            this.style.visibility = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "opacity", {
        get: function () {
            return this.style.opacity;
        },
        set: function (value) {
            this.style.opacity = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "rotate", {
        get: function () {
            return this.style.rotate;
        },
        set: function (value) {
            this.style.rotate = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateX", {
        get: function () {
            return this.style.translateX;
        },
        set: function (value) {
            this.style.translateX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateY", {
        get: function () {
            return this.style.translateY;
        },
        set: function (value) {
            this.style.translateY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleX", {
        get: function () {
            return this.style.scaleX;
        },
        set: function (value) {
            this.style.scaleX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleY", {
        get: function () {
            return this.style.scaleY;
        },
        set: function (value) {
            this.style.scaleY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidElevation", {
        get: function () {
            return this.style.androidElevation;
        },
        set: function (value) {
            this.style.androidElevation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidDynamicElevationOffset", {
        get: function () {
            return this.style.androidDynamicElevationOffset;
        },
        set: function (value) {
            this.style.androidDynamicElevationOffset = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutValid", {
        get: function () {
            return this._isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "cssType", {
        get: function () {
            if (!this._cssType) {
                this._cssType = this.typeName.toLowerCase();
            }
            return this._cssType;
        },
        set: function (type) {
            this._cssType = type.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutRequired", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
    };
    ViewCommon.prototype.layout = function (left, top, right, bottom) {
        this._setCurrentLayoutBounds(left, top, right, bottom);
    };
    ViewCommon.prototype.getMeasuredWidth = function () {
        return this._measuredWidth & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredHeight = function () {
        return this._measuredHeight & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredState = function () {
        return (this._measuredWidth & view_base_1.layout.MEASURED_STATE_MASK)
            | ((this._measuredHeight >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT)
                & (view_base_1.layout.MEASURED_STATE_MASK >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT));
    };
    ViewCommon.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        this._measuredWidth = measuredWidth;
        this._measuredHeight = measuredHeight;
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + " :setMeasuredDimension: " + measuredWidth + ", " + measuredHeight, view_base_1.traceCategories.Layout);
        }
    };
    ViewCommon.prototype.requestLayout = function () {
        this._isLayoutValid = false;
        _super.prototype.requestLayout.call(this);
    };
    ViewCommon.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_base_1.layout.UNSPECIFIED:
                result = Math.ceil(size);
                break;
            case view_base_1.layout.AT_MOST:
                if (specSize < size) {
                    result = Math.ceil(specSize) | view_base_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_base_1.layout.EXACTLY:
                result = Math.ceil(specSize);
                break;
        }
        return result | (childMeasuredState & view_base_1.layout.MEASURED_STATE_MASK);
    };
    ViewCommon.combineMeasuredStates = function (curState, newState) {
        return curState | newState;
    };
    ViewCommon.layoutChild = function (parent, child, left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        if (!child || child.isCollapsed) {
            return;
        }
        var childStyle = child.style;
        var childTop;
        var childLeft;
        var childWidth = child.getMeasuredWidth();
        var childHeight = child.getMeasuredHeight();
        var effectiveMarginTop = child.effectiveMarginTop;
        var effectiveMarginBottom = child.effectiveMarginBottom;
        var vAlignment;
        if (child.effectiveHeight >= 0 && childStyle.verticalAlignment === "stretch") {
            vAlignment = "middle";
        }
        else {
            vAlignment = childStyle.verticalAlignment;
        }
        switch (vAlignment) {
            case "top":
                childTop = top + effectiveMarginTop;
                break;
            case "middle":
                childTop = top + (bottom - top - childHeight + (effectiveMarginTop - effectiveMarginBottom)) / 2;
                break;
            case "bottom":
                childTop = bottom - childHeight - effectiveMarginBottom;
                break;
            case "stretch":
            default:
                childTop = top + effectiveMarginTop;
                childHeight = bottom - top - (effectiveMarginTop + effectiveMarginBottom);
                break;
        }
        var effectiveMarginLeft = child.effectiveMarginLeft;
        var effectiveMarginRight = child.effectiveMarginRight;
        var hAlignment;
        if (child.effectiveWidth >= 0 && childStyle.horizontalAlignment === "stretch") {
            hAlignment = "center";
        }
        else {
            hAlignment = childStyle.horizontalAlignment;
        }
        switch (hAlignment) {
            case "left":
                childLeft = left + effectiveMarginLeft;
                break;
            case "center":
                childLeft = left + (right - left - childWidth + (effectiveMarginLeft - effectiveMarginRight)) / 2;
                break;
            case "right":
                childLeft = right - childWidth - effectiveMarginRight;
                break;
            case "stretch":
            default:
                childLeft = left + effectiveMarginLeft;
                childWidth = right - left - (effectiveMarginLeft + effectiveMarginRight);
                break;
        }
        var childRight = Math.round(childLeft + childWidth);
        var childBottom = Math.round(childTop + childHeight);
        childLeft = Math.round(childLeft);
        childTop = Math.round(childTop);
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(child.parent + " :layoutChild: " + child + " " + childLeft + ", " + childTop + ", " + childRight + ", " + childBottom, view_base_1.traceCategories.Layout);
        }
        child.layout(childLeft, childTop, childRight, childBottom, setFrame);
    };
    ViewCommon.measureChild = function (parent, child, widthMeasureSpec, heightMeasureSpec) {
        var measureWidth = 0;
        var measureHeight = 0;
        if (child && !child.isCollapsed) {
            var widthSpec = parent ? parent._currentWidthMeasureSpec : widthMeasureSpec;
            var heightSpec = parent ? parent._currentHeightMeasureSpec : heightMeasureSpec;
            var width = view_base_1.layout.getMeasureSpecSize(widthSpec);
            var widthMode = view_base_1.layout.getMeasureSpecMode(widthSpec);
            var height = view_base_1.layout.getMeasureSpecSize(heightSpec);
            var heightMode = view_base_1.layout.getMeasureSpecMode(heightSpec);
            child._updateEffectiveLayoutValues(width, widthMode, height, heightMode);
            var style = child.style;
            var horizontalMargins = child.effectiveMarginLeft + child.effectiveMarginRight;
            var verticalMargins = child.effectiveMarginTop + child.effectiveMarginBottom;
            var childWidthMeasureSpec = ViewCommon.getMeasureSpec(widthMeasureSpec, horizontalMargins, child.effectiveWidth, style.horizontalAlignment === "stretch");
            var childHeightMeasureSpec = ViewCommon.getMeasureSpec(heightMeasureSpec, verticalMargins, child.effectiveHeight, style.verticalAlignment === "stretch");
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite(child.parent + " :measureChild: " + child + " " + view_base_1.layout.measureSpecToString(childWidthMeasureSpec) + ", " + view_base_1.layout.measureSpecToString(childHeightMeasureSpec) + "}", view_base_1.traceCategories.Layout);
            }
            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
            measureWidth = Math.round(child.getMeasuredWidth() + horizontalMargins);
            measureHeight = Math.round(child.getMeasuredHeight() + verticalMargins);
        }
        return { measuredWidth: measureWidth, measuredHeight: measureHeight };
    };
    ViewCommon.getMeasureSpec = function (parentSpec, margins, childLength, stretched) {
        var parentLength = view_base_1.layout.getMeasureSpecSize(parentSpec);
        var parentSpecMode = view_base_1.layout.getMeasureSpecMode(parentSpec);
        var resultSize;
        var resultMode;
        if (childLength >= 0) {
            resultSize = parentSpecMode === view_base_1.layout.UNSPECIFIED ? childLength : Math.min(parentLength, childLength);
            resultMode = view_base_1.layout.EXACTLY;
        }
        else {
            switch (parentSpecMode) {
                case view_base_1.layout.EXACTLY:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = stretched ? view_base_1.layout.EXACTLY : view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.AT_MOST:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.UNSPECIFIED:
                    resultSize = 0;
                    resultMode = view_base_1.layout.UNSPECIFIED;
                    break;
            }
        }
        return view_base_1.layout.makeMeasureSpec(resultSize, resultMode);
    };
    ViewCommon.prototype._setCurrentMeasureSpecs = function (widthMeasureSpec, heightMeasureSpec) {
        var changed = this._currentWidthMeasureSpec !== widthMeasureSpec || this._currentHeightMeasureSpec !== heightMeasureSpec;
        this._currentWidthMeasureSpec = widthMeasureSpec;
        this._currentHeightMeasureSpec = heightMeasureSpec;
        return changed;
    };
    ViewCommon.prototype._getCurrentLayoutBounds = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype._setCurrentLayoutBounds = function (left, top, right, bottom) {
        this._isLayoutValid = true;
        var boundsChanged = this._oldLeft !== left || this._oldTop !== top || this._oldRight !== right || this._oldBottom !== bottom;
        var sizeChanged = (this._oldRight - this._oldLeft !== right - left) || (this._oldBottom - this._oldTop !== bottom - top);
        this._oldLeft = left;
        this._oldTop = top;
        this._oldRight = right;
        this._oldBottom = bottom;
        return { boundsChanged: boundsChanged, sizeChanged: sizeChanged };
    };
    ViewCommon.prototype.eachChild = function (callback) {
        this.eachChildView(callback);
    };
    ViewCommon.prototype.eachChildView = function (callback) {
    };
    ViewCommon.prototype._getNativeViewsCount = function () {
        return this._isAddedToNativeVisualTree ? 1 : 0;
    };
    ViewCommon.prototype._eachLayoutView = function (callback) {
        return callback(this);
    };
    ViewCommon.prototype.focus = function () {
        return undefined;
    };
    ViewCommon.prototype.getSafeAreaInsets = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype.getLocationInWindow = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationOnScreen = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationRelativeTo = function (otherView) {
        return undefined;
    };
    ViewCommon.prototype.getActualSize = function () {
        var currentBounds = this._getCurrentLayoutBounds();
        if (!currentBounds) {
            return undefined;
        }
        return {
            width: view_base_1.layout.toDeviceIndependentPixels(currentBounds.right - currentBounds.left),
            height: view_base_1.layout.toDeviceIndependentPixels(currentBounds.bottom - currentBounds.top),
        };
    };
    ViewCommon.prototype.animate = function (animation) {
        return this.createAnimation(animation).play();
    };
    ViewCommon.prototype.createAnimation = function (animation) {
        ensureAnimationModule();
        if (!this._localAnimations) {
            this._localAnimations = new Set();
        }
        animation.target = this;
        var anim = new animationModule.Animation([animation]);
        this._localAnimations.add(anim);
        return anim;
    };
    ViewCommon.prototype._removeAnimation = function (animation) {
        var localAnimations = this._localAnimations;
        if (localAnimations && localAnimations.has(animation)) {
            localAnimations.delete(animation);
            if (animation.isPlaying) {
                animation.cancel();
            }
            return true;
        }
        return false;
    };
    ViewCommon.prototype.resetNativeView = function () {
        var _this = this;
        if (this._localAnimations) {
            this._localAnimations.forEach(function (a) { return _this._removeAnimation(a); });
        }
        _super.prototype.resetNativeView.call(this);
    };
    ViewCommon.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    ViewCommon.prototype._getValue = function () {
        throw new Error("The View._getValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._setValue = function () {
        throw new Error("The View._setValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._updateEffectiveLayoutValues = function (parentWidthMeasureSize, parentWidthMeasureMode, parentHeightMeasureSize, parentHeightMeasureMode) {
        var style = this.style;
        var availableWidth = parentWidthMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentWidthMeasureSize;
        this.effectiveWidth = style_properties_1.PercentLength.toDevicePixels(style.width, -2, availableWidth);
        this.effectiveMarginLeft = style_properties_1.PercentLength.toDevicePixels(style.marginLeft, 0, availableWidth);
        this.effectiveMarginRight = style_properties_1.PercentLength.toDevicePixels(style.marginRight, 0, availableWidth);
        var availableHeight = parentHeightMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentHeightMeasureSize;
        this.effectiveHeight = style_properties_1.PercentLength.toDevicePixels(style.height, -2, availableHeight);
        this.effectiveMarginTop = style_properties_1.PercentLength.toDevicePixels(style.marginTop, 0, availableHeight);
        this.effectiveMarginBottom = style_properties_1.PercentLength.toDevicePixels(style.marginBottom, 0, availableHeight);
    };
    ViewCommon.prototype._setNativeClipToBounds = function () {
    };
    ViewCommon.prototype._redrawNativeBackground = function (value) {
    };
    ViewCommon.prototype._onAttachedToWindow = function () {
    };
    ViewCommon.prototype._onDetachedFromWindow = function () {
    };
    ViewCommon.prototype._hasAncestorView = function (ancestorView) {
        var matcher = function (view) { return view === ancestorView; };
        for (var parent_2 = this.parent; parent_2 != null; parent_2 = parent_2.parent) {
            if (matcher(parent_2)) {
                return true;
            }
        }
        return false;
    };
    ViewCommon.layoutChangedEvent = "layoutChanged";
    ViewCommon.shownModallyEvent = "shownModally";
    ViewCommon.showingModallyEvent = "showingModally";
    return ViewCommon;
}(view_base_1.ViewBase));
exports.ViewCommon = ViewCommon;
exports.automationTextProperty = new view_base_1.Property({ name: "automationText" });
exports.automationTextProperty.register(ViewCommon);
exports.originXProperty = new view_base_1.Property({ name: "originX", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originXProperty.register(ViewCommon);
exports.originYProperty = new view_base_1.Property({ name: "originY", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originYProperty.register(ViewCommon);
exports.isEnabledProperty = new view_base_1.Property({
    name: "isEnabled",
    defaultValue: true,
    valueConverter: view_base_1.booleanConverter,
    valueChanged: function (target, oldValue, newValue) {
        target._goToVisualState(newValue ? "normal" : "disabled");
    }
});
exports.isEnabledProperty.register(ViewCommon);
exports.isUserInteractionEnabledProperty = new view_base_1.Property({ name: "isUserInteractionEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.isUserInteractionEnabledProperty.register(ViewCommon);
exports.iosOverflowSafeAreaProperty = new view_base_1.Property({ name: "iosOverflowSafeArea", defaultValue: false, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaProperty.register(ViewCommon);
exports.iosOverflowSafeAreaEnabledProperty = new view_base_1.InheritedProperty({ name: "iosOverflowSafeAreaEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaEnabledProperty.register(ViewCommon);
//# sourceMappingURL=view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js"));
var PFLAG_FORCE_LAYOUT = 1;
var PFLAG_MEASURED_DIMENSION_SET = 1 << 1;
var PFLAG_LAYOUT_REQUIRED = 1 << 2;
var majorVersion = utils_1.ios.MajorVersion;
var View = (function (_super) {
    __extends(View, _super);
    function View() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._isLaidOut = false;
        _this._hasTransfrom = false;
        _this._privateFlags = PFLAG_LAYOUT_REQUIRED | PFLAG_FORCE_LAYOUT;
        _this._suspendCATransaction = false;
        return _this;
    }
    Object.defineProperty(View.prototype, "isLayoutRequired", {
        get: function () {
            return (this._privateFlags & PFLAG_LAYOUT_REQUIRED) === PFLAG_LAYOUT_REQUIRED;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "isLayoutRequested", {
        get: function () {
            return (this._privateFlags & PFLAG_FORCE_LAYOUT) === PFLAG_FORCE_LAYOUT;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.requestLayout = function () {
        _super.prototype.requestLayout.call(this);
        this._privateFlags |= PFLAG_FORCE_LAYOUT;
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.setNeedsLayout();
        }
        if (this.viewController && this.viewController.view !== nativeView) {
            this.viewController.view.setNeedsLayout();
        }
    };
    View.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        var measureSpecsChanged = this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
        var forceLayout = (this._privateFlags & PFLAG_FORCE_LAYOUT) === PFLAG_FORCE_LAYOUT;
        if (forceLayout || measureSpecsChanged) {
            this._privateFlags &= ~PFLAG_MEASURED_DIMENSION_SET;
            this.onMeasure(widthMeasureSpec, heightMeasureSpec);
            this._privateFlags |= PFLAG_LAYOUT_REQUIRED;
            if ((this._privateFlags & PFLAG_MEASURED_DIMENSION_SET) !== PFLAG_MEASURED_DIMENSION_SET) {
                throw new Error("onMeasure() did not set the measured dimension by calling setMeasuredDimension() " + this);
            }
        }
    };
    View.prototype.layout = function (left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        var _a = this._setCurrentLayoutBounds(left, top, right, bottom), boundsChanged = _a.boundsChanged, sizeChanged = _a.sizeChanged;
        if (setFrame) {
            this.layoutNativeView(left, top, right, bottom);
        }
        if (boundsChanged || (this._privateFlags & PFLAG_LAYOUT_REQUIRED) === PFLAG_LAYOUT_REQUIRED) {
            var position = { left: left, top: top, right: right, bottom: bottom };
            if (this.nativeViewProtected && majorVersion > 10) {
                var frame = this.nativeViewProtected.frame;
                position = ios.getPositionFromFrame(frame);
            }
            this.onLayout(position.left, position.top, position.right, position.bottom);
            this._privateFlags &= ~PFLAG_LAYOUT_REQUIRED;
        }
        this.updateBackground(sizeChanged);
        this._privateFlags &= ~PFLAG_FORCE_LAYOUT;
    };
    View.prototype.updateBackground = function (sizeChanged) {
        if (sizeChanged) {
            this._onSizeChanged();
        }
        else if (this._nativeBackgroundState === "invalid") {
            var background = this.style.backgroundInternal;
            this._redrawNativeBackground(background);
        }
    };
    View.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        _super.prototype.setMeasuredDimension.call(this, measuredWidth, measuredHeight);
        this._privateFlags |= PFLAG_MEASURED_DIMENSION_SET;
    };
    View.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var view = this.nativeViewProtected;
        var width = view_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = view_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = view_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = view_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var nativeWidth = 0;
        var nativeHeight = 0;
        if (view) {
            var nativeSize = view_common_1.layout.measureNativeView(view, width, widthMode, height, heightMode);
            nativeWidth = nativeSize.width;
            nativeHeight = nativeSize.height;
        }
        var measureWidth = Math.max(nativeWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(nativeHeight, this.effectiveMinHeight);
        var widthAndState = View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    View.prototype.onLayout = function (left, top, right, bottom) {
    };
    View.prototype._setNativeViewFrame = function (nativeView, frame) {
        var oldFrame = this._cachedFrame || nativeView.frame;
        if (!CGRectEqualToRect(oldFrame, frame)) {
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + " :_setNativeViewFrame: " + JSON.stringify(ios.getPositionFromFrame(frame)), view_common_1.traceCategories.Layout);
            }
            this._cachedFrame = frame;
            var adjustedFrame = null;
            var transform = null;
            if (this._hasTransfrom) {
                transform = nativeView.transform;
                nativeView.transform = CGAffineTransformIdentity;
                nativeView.frame = frame;
            }
            else {
                nativeView.frame = frame;
            }
            adjustedFrame = this.applySafeAreaInsets(frame);
            if (adjustedFrame) {
                nativeView.frame = adjustedFrame;
            }
            if (this._hasTransfrom) {
                nativeView.transform = transform;
            }
            var boundsOrigin = nativeView.bounds.origin;
            var boundsFrame = adjustedFrame || frame;
            nativeView.bounds = CGRectMake(boundsOrigin.x, boundsOrigin.y, boundsFrame.size.width, boundsFrame.size.height);
            this._raiseLayoutChangedEvent();
            this._isLaidOut = true;
        }
        else if (!this._isLaidOut) {
            this._raiseLayoutChangedEvent();
            this._isLaidOut = true;
        }
    };
    Object.defineProperty(View.prototype, "isLayoutValid", {
        get: function () {
            if (this.nativeViewProtected) {
                return this._isLayoutValid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.layoutNativeView = function (left, top, right, bottom) {
        if (!this.nativeViewProtected) {
            return;
        }
        var nativeView = this.nativeViewProtected;
        var frame = ios.getFrameFromPosition({ left: left, top: top, right: right, bottom: bottom });
        this._setNativeViewFrame(nativeView, frame);
    };
    View.prototype._setLayoutFlags = function (left, top, right, bottom) {
        var width = right - left;
        var height = bottom - top;
        var widthSpec = view_common_1.layout.makeMeasureSpec(width, view_common_1.layout.EXACTLY);
        var heightSpec = view_common_1.layout.makeMeasureSpec(height, view_common_1.layout.EXACTLY);
        this._setCurrentMeasureSpecs(widthSpec, heightSpec);
        this._privateFlags &= ~PFLAG_FORCE_LAYOUT;
        this.setMeasuredDimension(width, height);
        var sizeChanged = this._setCurrentLayoutBounds(left, top, right, bottom).sizeChanged;
        this.updateBackground(sizeChanged);
        this._privateFlags &= ~PFLAG_LAYOUT_REQUIRED;
    };
    View.prototype.focus = function () {
        if (this.ios) {
            return this.ios.becomeFirstResponder();
        }
        return false;
    };
    View.prototype.applySafeAreaInsets = function (frame) {
        if (majorVersion <= 10) {
            return null;
        }
        if (!this.iosOverflowSafeArea || !this.iosOverflowSafeAreaEnabled) {
            return ios.shrinkToSafeArea(this, frame);
        }
        else if (this.nativeViewProtected && this.nativeViewProtected.window) {
            return ios.expandBeyondSafeArea(this, frame);
        }
        return null;
    };
    View.prototype.getSafeAreaInsets = function () {
        var safeAreaInsets = this.nativeViewProtected && this.nativeViewProtected.safeAreaInsets;
        var insets = { left: 0, top: 0, right: 0, bottom: 0 };
        if (safeAreaInsets) {
            insets.left = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.left));
            insets.top = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.top));
            insets.right = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.right));
            insets.bottom = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.bottom));
        }
        return insets;
    };
    View.prototype.getLocationInWindow = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window) {
            return undefined;
        }
        var pointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        return {
            x: pointInWindow.x,
            y: pointInWindow.y
        };
    };
    View.prototype.getLocationOnScreen = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window) {
            return undefined;
        }
        var pointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        var pointOnScreen = this.nativeViewProtected.window.convertPointToWindow(pointInWindow, null);
        return {
            x: pointOnScreen.x,
            y: pointOnScreen.y
        };
    };
    View.prototype.getLocationRelativeTo = function (otherView) {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window ||
            !otherView.nativeViewProtected || !otherView.nativeViewProtected.window ||
            this.nativeViewProtected.window !== otherView.nativeViewProtected.window) {
            return undefined;
        }
        var myPointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        var otherPointInWindow = otherView.nativeViewProtected.convertPointToView(otherView.nativeViewProtected.bounds.origin, null);
        return {
            x: myPointInWindow.x - otherPointInWindow.x,
            y: myPointInWindow.y - otherPointInWindow.y
        };
    };
    View.prototype._onSizeChanged = function () {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var background = this.style.backgroundInternal;
        var backgroundDependsOnSize = background.image
            || !background.hasUniformBorder()
            || background.hasBorderRadius();
        if (this._nativeBackgroundState === "invalid" || (this._nativeBackgroundState === "drawn" && backgroundDependsOnSize)) {
            this._redrawNativeBackground(background);
        }
        var clipPath = this.style.clipPath;
        if (clipPath !== "" && this[style_properties_1.clipPathProperty.setNative]) {
            this[style_properties_1.clipPathProperty.setNative](clipPath);
        }
    };
    View.prototype.updateNativeTransform = function () {
        var scaleX = this.scaleX || 1e-6;
        var scaleY = this.scaleY || 1e-6;
        var rotate = this.rotate || 0;
        var newTransform = CGAffineTransformIdentity;
        newTransform = CGAffineTransformTranslate(newTransform, this.translateX, this.translateY);
        newTransform = CGAffineTransformRotate(newTransform, rotate * Math.PI / 180);
        newTransform = CGAffineTransformScale(newTransform, scaleX, scaleY);
        if (!CGAffineTransformEqualToTransform(this.nativeViewProtected.transform, newTransform)) {
            var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
            if (!updateSuspended) {
                CATransaction.begin();
            }
            this.nativeViewProtected.transform = newTransform;
            this._hasTransfrom = this.nativeViewProtected && !CGAffineTransformEqualToTransform(this.nativeViewProtected.transform, CGAffineTransformIdentity);
            if (!updateSuspended) {
                CATransaction.commit();
            }
        }
    };
    View.prototype.updateOriginPoint = function (originX, originY) {
        var newPoint = CGPointMake(originX, originY);
        this.nativeViewProtected.layer.anchorPoint = newPoint;
        if (this._cachedFrame) {
            this._setNativeViewFrame(this.nativeViewProtected, this._cachedFrame);
        }
    };
    View.prototype._suspendPresentationLayerUpdates = function () {
        this._suspendCATransaction = true;
    };
    View.prototype._resumePresentationLayerUpdates = function () {
        this._suspendCATransaction = false;
    };
    View.prototype._isPresentationLayerUpdateSuspeneded = function () {
        return this._suspendCATransaction || this._suspendNativeUpdatesCount;
    };
    View.prototype._showNativeModalView = function (parent, options) {
        var _this = this;
        var parentWithController = ios.getParentWithViewController(parent);
        if (!parentWithController) {
            view_common_1.traceWrite("Could not find parent with viewController for " + parent + " while showing modal view.", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        var parentController = parentWithController.viewController;
        if (parentController.presentedViewController) {
            view_common_1.traceWrite("Parent is already presenting view controller. Close the current modal page before showing another one!", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        if (!parentController.view || !parentController.view.window) {
            view_common_1.traceWrite("Parent page is not part of the window hierarchy.", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        this._setupAsRootView({});
        _super.prototype._showNativeModalView.call(this, parentWithController, options);
        var controller = this.viewController;
        if (!controller) {
            var nativeView = this.ios || this.nativeViewProtected;
            controller = ios.UILayoutViewController.initWithOwner(new WeakRef(this));
            if (nativeView instanceof UIView) {
                controller.view.addSubview(nativeView);
            }
            this.viewController = controller;
        }
        if (options.fullscreen) {
            controller.modalPresentationStyle = 0;
        }
        else {
            controller.modalPresentationStyle = 2;
        }
        if (options.ios && options.ios.presentationStyle) {
            var presentationStyle = options.ios.presentationStyle;
            controller.modalPresentationStyle = presentationStyle;
            if (presentationStyle === 7) {
                var popoverPresentationController = controller.popoverPresentationController;
                this._popoverPresentationDelegate = ios.UIPopoverPresentationControllerDelegateImp.initWithOwnerAndCallback(new WeakRef(this), this._closeModalCallback);
                popoverPresentationController.delegate = this._popoverPresentationDelegate;
                var view = parent.nativeViewProtected;
                popoverPresentationController.sourceView = view;
                popoverPresentationController.sourceRect = CGRectMake(0, 0, view.frame.size.width, view.frame.size.height);
            }
        }
        this.horizontalAlignment = "stretch";
        this.verticalAlignment = "stretch";
        this._raiseShowingModallyEvent();
        var animated = options.animated === undefined ? true : !!options.animated;
        controller.animated = animated;
        parentController.presentViewControllerAnimatedCompletion(controller, animated, null);
        var transitionCoordinator = parentController.transitionCoordinator;
        if (transitionCoordinator) {
            UIViewControllerTransitionCoordinator.prototype.animateAlongsideTransitionCompletion
                .call(transitionCoordinator, null, function () { return _this._raiseShownModallyEvent(); });
        }
        else {
            this._raiseShownModallyEvent();
        }
    };
    View.prototype._hideNativeModalView = function (parent, whenClosedCallback) {
        if (!parent || !parent.viewController) {
            view_common_1.traceError("Trying to hide modal view but no parent with viewController specified.");
            return;
        }
        if (!parent.viewController.presentedViewController) {
            whenClosedCallback();
            return;
        }
        var parentController = parent.viewController;
        var animated = this.viewController.animated;
        parentController.dismissViewControllerAnimatedCompletion(animated, whenClosedCallback);
    };
    View.prototype[view_common_1.isEnabledProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        return nativeView instanceof UIControl ? nativeView.enabled : true;
    };
    View.prototype[view_common_1.isEnabledProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (nativeView instanceof UIControl) {
            nativeView.enabled = value;
        }
    };
    View.prototype[view_common_1.originXProperty.getDefault] = function () {
        return this.nativeViewProtected.layer.anchorPoint.x;
    };
    View.prototype[view_common_1.originXProperty.setNative] = function (value) {
        this.updateOriginPoint(value, this.originY);
    };
    View.prototype[view_common_1.originYProperty.getDefault] = function () {
        return this.nativeViewProtected.layer.anchorPoint.y;
    };
    View.prototype[view_common_1.originYProperty.setNative] = function (value) {
        this.updateOriginPoint(this.originX, value);
    };
    View.prototype[view_common_1.automationTextProperty.getDefault] = function () {
        return this.nativeViewProtected.accessibilityLabel;
    };
    View.prototype[view_common_1.automationTextProperty.setNative] = function (value) {
        this.nativeViewProtected.accessibilityIdentifier = value;
        this.nativeViewProtected.accessibilityLabel = value;
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.getDefault] = function () {
        return this.nativeViewProtected.userInteractionEnabled;
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.userInteractionEnabled = value;
    };
    View.prototype[style_properties_1.visibilityProperty.getDefault] = function () {
        return this.nativeViewProtected.hidden ? style_properties_1.Visibility.COLLAPSE : style_properties_1.Visibility.VISIBLE;
    };
    View.prototype[style_properties_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case style_properties_1.Visibility.VISIBLE:
                this.nativeViewProtected.hidden = false;
                break;
            case style_properties_1.Visibility.HIDDEN:
            case style_properties_1.Visibility.COLLAPSE:
                this.nativeViewProtected.hidden = true;
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: \"" + style_properties_1.Visibility.VISIBLE + "\", \"" + style_properties_1.Visibility.HIDDEN + "\", \"" + style_properties_1.Visibility.COLLAPSE + "\".");
        }
    };
    View.prototype[style_properties_1.opacityProperty.getDefault] = function () {
        return this.nativeViewProtected.alpha;
    };
    View.prototype[style_properties_1.opacityProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
        if (!updateSuspended) {
            CATransaction.begin();
        }
        nativeView.alpha = value;
        if (!updateSuspended) {
            CATransaction.commit();
        }
    };
    View.prototype[style_properties_1.rotateProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.rotateProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.scaleXProperty.getDefault] = function () {
        return 1;
    };
    View.prototype[style_properties_1.scaleXProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.scaleYProperty.getDefault] = function () {
        return 1;
    };
    View.prototype[style_properties_1.scaleYProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.translateXProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.translateXProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.translateYProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.translateYProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.zIndexProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.zIndexProperty.setNative] = function (value) {
        this.nativeViewProtected.layer.zPosition = value;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.backgroundColor;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.setNative] = function (value) {
        this._nativeBackgroundState = "invalid";
        if (this.isLayoutValid) {
            this._redrawNativeBackground(value);
        }
    };
    View.prototype._getCurrentLayoutBounds = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView && !this.isCollapsed) {
            var frame = nativeView.frame;
            var origin_1 = frame.origin;
            var size = frame.size;
            return {
                left: Math.round(view_common_1.layout.toDevicePixels(origin_1.x)),
                top: Math.round(view_common_1.layout.toDevicePixels(origin_1.y)),
                right: Math.round(view_common_1.layout.toDevicePixels(origin_1.x + size.width)),
                bottom: Math.round(view_common_1.layout.toDevicePixels(origin_1.y + size.height))
            };
        }
        else {
            return { left: 0, top: 0, right: 0, bottom: 0 };
        }
    };
    View.prototype._redrawNativeBackground = function (value) {
        var _this = this;
        var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
        if (!updateSuspended) {
            CATransaction.begin();
        }
        if (value instanceof UIColor) {
            this.nativeViewProtected.backgroundColor = value;
        }
        else {
            background_1.ios.createBackgroundUIColor(this, function (color) {
                _this.nativeViewProtected.backgroundColor = color;
            });
            this._setNativeClipToBounds();
        }
        if (!updateSuspended) {
            CATransaction.commit();
        }
        this._nativeBackgroundState = "drawn";
    };
    View.prototype._setNativeClipToBounds = function () {
        var backgroundInternal = this.style.backgroundInternal;
        this.nativeViewProtected.clipsToBounds =
            this.nativeViewProtected instanceof UIScrollView ||
                backgroundInternal.hasBorderWidth() ||
                backgroundInternal.hasBorderRadius();
    };
    __decorate([
        profiling_1.profile
    ], View.prototype, "layout", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "onMeasure", null);
    return View;
}(view_common_1.ViewCommon));
exports.View = View;
View.prototype._nativeBackgroundState = "unset";
var ContainerView = (function (_super) {
    __extends(ContainerView, _super);
    function ContainerView() {
        var _this = _super.call(this) || this;
        _this.iosOverflowSafeArea = true;
        return _this;
    }
    return ContainerView;
}(View));
exports.ContainerView = ContainerView;
var CustomLayoutView = (function (_super) {
    __extends(CustomLayoutView, _super);
    function CustomLayoutView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CustomLayoutView.prototype.createNativeView = function () {
        return UIView.alloc().initWithFrame(UIScreen.mainScreen.bounds);
    };
    Object.defineProperty(CustomLayoutView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    CustomLayoutView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
    };
    CustomLayoutView.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
        var parentNativeView = this.nativeViewProtected;
        var childNativeView = child.nativeViewProtected;
        if (parentNativeView && childNativeView) {
            if (typeof atIndex !== "number" || atIndex >= parentNativeView.subviews.count) {
                parentNativeView.addSubview(childNativeView);
            }
            else {
                parentNativeView.insertSubviewAtIndex(childNativeView, atIndex);
            }
            return true;
        }
        return false;
    };
    CustomLayoutView.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        if (child.nativeViewProtected) {
            child.nativeViewProtected.removeFromSuperview();
        }
    };
    return CustomLayoutView;
}(ContainerView));
exports.CustomLayoutView = CustomLayoutView;
var ios;
(function (ios) {
    function getParentWithViewController(view) {
        while (view && !view.viewController) {
            view = view.parent;
        }
        return view;
    }
    ios.getParentWithViewController = getParentWithViewController;
    function updateAutoAdjustScrollInsets(controller, owner) {
        if (majorVersion <= 10) {
            owner._automaticallyAdjustsScrollViewInsets = false;
            controller.automaticallyAdjustsScrollViewInsets = false;
        }
    }
    ios.updateAutoAdjustScrollInsets = updateAutoAdjustScrollInsets;
    function updateConstraints(controller, owner) {
        if (majorVersion <= 10) {
            var layoutGuide = initLayoutGuide(controller);
            controller.view.safeAreaLayoutGuide = layoutGuide;
        }
    }
    ios.updateConstraints = updateConstraints;
    function initLayoutGuide(controller) {
        var rootView = controller.view;
        var layoutGuide = UILayoutGuide.alloc().init();
        rootView.addLayoutGuide(layoutGuide);
        NSLayoutConstraint.activateConstraints([
            layoutGuide.topAnchor.constraintEqualToAnchor(controller.topLayoutGuide.bottomAnchor),
            layoutGuide.bottomAnchor.constraintEqualToAnchor(controller.bottomLayoutGuide.topAnchor),
            layoutGuide.leadingAnchor.constraintEqualToAnchor(rootView.leadingAnchor),
            layoutGuide.trailingAnchor.constraintEqualToAnchor(rootView.trailingAnchor)
        ]);
        return layoutGuide;
    }
    function layoutView(controller, owner) {
        var layoutGuide = controller.view.safeAreaLayoutGuide;
        if (!layoutGuide) {
            view_common_1.traceWrite("safeAreaLayoutGuide during layout of " + owner + ". Creating fallback constraints, but layout might be wrong.", view_common_1.traceCategories.Layout, view_common_1.traceMessageType.error);
            layoutGuide = initLayoutGuide(controller);
        }
        var safeArea = layoutGuide.layoutFrame;
        var position = ios.getPositionFromFrame(safeArea);
        var safeAreaSize = safeArea.size;
        var hasChildViewControllers = controller.childViewControllers.count > 0;
        if (hasChildViewControllers) {
            var fullscreen = controller.view.frame;
            position = ios.getPositionFromFrame(fullscreen);
        }
        var safeAreaWidth = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaSize.width));
        var safeAreaHeight = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaSize.height));
        var widthSpec = view_common_1.layout.makeMeasureSpec(safeAreaWidth, view_common_1.layout.EXACTLY);
        var heightSpec = view_common_1.layout.makeMeasureSpec(safeAreaHeight, view_common_1.layout.EXACTLY);
        View.measureChild(null, owner, widthSpec, heightSpec);
        View.layoutChild(null, owner, position.left, position.top, position.right, position.bottom);
        layoutParent(owner.parent);
    }
    ios.layoutView = layoutView;
    function getPositionFromFrame(frame) {
        var left = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.x));
        var top = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.y));
        var right = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.x + frame.size.width));
        var bottom = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.y + frame.size.height));
        return { left: left, right: right, top: top, bottom: bottom };
    }
    ios.getPositionFromFrame = getPositionFromFrame;
    function getFrameFromPosition(position, insets) {
        insets = insets || { left: 0, top: 0, right: 0, bottom: 0 };
        var left = view_common_1.layout.toDeviceIndependentPixels(position.left + insets.left);
        var top = view_common_1.layout.toDeviceIndependentPixels(position.top + insets.top);
        var width = view_common_1.layout.toDeviceIndependentPixels(position.right - position.left - insets.left - insets.right);
        var height = view_common_1.layout.toDeviceIndependentPixels(position.bottom - position.top - insets.top - insets.bottom);
        return CGRectMake(left, top, width, height);
    }
    ios.getFrameFromPosition = getFrameFromPosition;
    function shrinkToSafeArea(view, frame) {
        var insets = view.getSafeAreaInsets();
        if (insets.left || insets.top) {
            var position = ios.getPositionFromFrame(frame);
            var adjustedFrame = ios.getFrameFromPosition(position, insets);
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + " :shrinkToSafeArea: " + JSON.stringify(ios.getPositionFromFrame(adjustedFrame)), view_common_1.traceCategories.Layout);
            }
            return adjustedFrame;
        }
        return null;
    }
    ios.shrinkToSafeArea = shrinkToSafeArea;
    function expandBeyondSafeArea(view, frame) {
        var availableSpace = getAvailableSpaceFromParent(view, frame);
        var safeArea = availableSpace.safeArea;
        var fullscreen = availableSpace.fullscreen;
        var inWindow = availableSpace.inWindow;
        var position = ios.getPositionFromFrame(frame);
        var safeAreaPosition = ios.getPositionFromFrame(safeArea);
        var fullscreenPosition = ios.getPositionFromFrame(fullscreen);
        var inWindowPosition = ios.getPositionFromFrame(inWindow);
        var adjustedPosition = position;
        if (position.left && inWindowPosition.left <= safeAreaPosition.left) {
            adjustedPosition.left = fullscreenPosition.left;
        }
        if (position.top && inWindowPosition.top <= safeAreaPosition.top) {
            adjustedPosition.top = fullscreenPosition.top;
        }
        if (inWindowPosition.right < fullscreenPosition.right && inWindowPosition.right >= safeAreaPosition.right + fullscreenPosition.left) {
            adjustedPosition.right += fullscreenPosition.right - inWindowPosition.right;
        }
        if (inWindowPosition.bottom < fullscreenPosition.bottom && inWindowPosition.bottom >= safeAreaPosition.bottom + fullscreenPosition.top) {
            adjustedPosition.bottom += fullscreenPosition.bottom - inWindowPosition.bottom;
        }
        var adjustedFrame = CGRectMake(view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.left), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.top), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.right - adjustedPosition.left), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.bottom - adjustedPosition.top));
        if (view_common_1.traceEnabled()) {
            view_common_1.traceWrite(view + " :expandBeyondSafeArea: " + JSON.stringify(ios.getPositionFromFrame(adjustedFrame)), view_common_1.traceCategories.Layout);
        }
        return adjustedFrame;
    }
    ios.expandBeyondSafeArea = expandBeyondSafeArea;
    function layoutParent(view) {
        if (!view) {
            return;
        }
        if (view instanceof View && view.nativeViewProtected) {
            var frame = view.nativeViewProtected.frame;
            var origin_2 = frame.origin;
            var size = frame.size;
            var left = view_common_1.layout.toDevicePixels(origin_2.x);
            var top_1 = view_common_1.layout.toDevicePixels(origin_2.y);
            var width = view_common_1.layout.toDevicePixels(size.width);
            var height = view_common_1.layout.toDevicePixels(size.height);
            view._setLayoutFlags(left, top_1, width + left, height + top_1);
        }
        layoutParent(view.parent);
    }
    function getAvailableSpaceFromParent(view, frame) {
        if (!view) {
            return;
        }
        var scrollView = null;
        var viewControllerView = null;
        if (view.viewController) {
            viewControllerView = view.viewController.view;
        }
        else {
            var parent_1 = view.parent;
            while (parent_1 && !parent_1.viewController && !(parent_1.nativeViewProtected instanceof UIScrollView)) {
                parent_1 = parent_1.parent;
            }
            if (parent_1.nativeViewProtected instanceof UIScrollView) {
                scrollView = parent_1.nativeViewProtected;
            }
            else if (parent_1.viewController) {
                viewControllerView = parent_1.viewController.view;
            }
        }
        var fullscreen = null;
        var safeArea = null;
        if (viewControllerView) {
            safeArea = viewControllerView.safeAreaLayoutGuide.layoutFrame;
            fullscreen = viewControllerView.frame;
        }
        else if (scrollView) {
            var insets = scrollView.safeAreaInsets;
            safeArea = CGRectMake(insets.left, insets.top, scrollView.contentSize.width - insets.left - insets.right, scrollView.contentSize.height - insets.top - insets.bottom);
            fullscreen = CGRectMake(0, 0, scrollView.contentSize.width, scrollView.contentSize.height);
        }
        var locationInWindow = view.getLocationInWindow();
        var inWindowLeft = locationInWindow.x;
        var inWindowTop = locationInWindow.y;
        if (scrollView) {
            inWindowLeft += scrollView.contentOffset.x;
            inWindowTop += scrollView.contentOffset.y;
        }
        var inWindow = CGRectMake(inWindowLeft, inWindowTop, frame.size.width, frame.size.height);
        return { safeArea: safeArea, fullscreen: fullscreen, inWindow: inWindow };
    }
    var UILayoutViewController = (function (_super) {
        __extends(UILayoutViewController, _super);
        function UILayoutViewController() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        UILayoutViewController.initWithOwner = function (owner) {
            var controller = UILayoutViewController.new();
            controller.owner = owner;
            return controller;
        };
        UILayoutViewController.prototype.viewDidLoad = function () {
            _super.prototype.viewDidLoad.call(this);
            this.extendedLayoutIncludesOpaqueBars = true;
        };
        UILayoutViewController.prototype.viewWillLayoutSubviews = function () {
            _super.prototype.viewWillLayoutSubviews.call(this);
            var owner = this.owner.get();
            if (owner) {
                updateConstraints(this, owner);
            }
        };
        UILayoutViewController.prototype.viewDidLayoutSubviews = function () {
            _super.prototype.viewDidLayoutSubviews.call(this);
            var owner = this.owner.get();
            if (owner) {
                if (majorVersion >= 11) {
                    var tabViewItem = owner.parent;
                    var tabView = tabViewItem && tabViewItem.parent;
                    var parent_2 = tabView && tabView.parent;
                    while (parent_2 && !parent_2.nativeViewProtected) {
                        parent_2 = parent_2.parent;
                    }
                    if (parent_2) {
                        var parentPageInsetsTop = parent_2.nativeViewProtected.safeAreaInsets.top;
                        var currentInsetsTop = this.view.safeAreaInsets.top;
                        var additionalInsetsTop = Math.max(parentPageInsetsTop - currentInsetsTop, 0);
                        var parentPageInsetsBottom = parent_2.nativeViewProtected.safeAreaInsets.bottom;
                        var currentInsetsBottom = this.view.safeAreaInsets.bottom;
                        var additionalInsetsBottom = Math.max(parentPageInsetsBottom - currentInsetsBottom, 0);
                        if (additionalInsetsTop > 0 || additionalInsetsBottom > 0) {
                            var additionalInsets = new UIEdgeInsets({ top: additionalInsetsTop, left: 0, bottom: additionalInsetsBottom, right: 0 });
                            this.additionalSafeAreaInsets = additionalInsets;
                        }
                    }
                }
                layoutView(this, owner);
            }
        };
        UILayoutViewController.prototype.viewWillAppear = function (animated) {
            _super.prototype.viewWillAppear.call(this, animated);
            var owner = this.owner.get();
            if (!owner) {
                return;
            }
            updateAutoAdjustScrollInsets(this, owner);
            if (!owner.parent) {
                owner.callLoaded();
            }
        };
        UILayoutViewController.prototype.viewDidDisappear = function (animated) {
            _super.prototype.viewDidDisappear.call(this, animated);
            var owner = this.owner.get();
            if (owner && !owner.parent) {
                owner.callUnloaded();
            }
        };
        return UILayoutViewController;
    }(UIViewController));
    ios.UILayoutViewController = UILayoutViewController;
    var UIPopoverPresentationControllerDelegateImp = (function (_super) {
        __extends(UIPopoverPresentationControllerDelegateImp, _super);
        function UIPopoverPresentationControllerDelegateImp() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        UIPopoverPresentationControllerDelegateImp.initWithOwnerAndCallback = function (owner, whenClosedCallback) {
            var instance = _super.new.call(this);
            instance.owner = owner;
            instance.closedCallback = whenClosedCallback;
            return instance;
        };
        UIPopoverPresentationControllerDelegateImp.prototype.popoverPresentationControllerDidDismissPopover = function (popoverPresentationController) {
            var owner = this.owner.get();
            if (owner && typeof this.closedCallback === "function") {
                this.closedCallback();
            }
        };
        UIPopoverPresentationControllerDelegateImp.ObjCProtocols = [UIPopoverPresentationControllerDelegate];
        return UIPopoverPresentationControllerDelegateImp;
    }(NSObject));
    ios.UIPopoverPresentationControllerDelegateImp = UIPopoverPresentationControllerDelegateImp;
})(ios = exports.ios || (exports.ios = {}));
//# sourceMappingURL=view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var handlersForEventName = new Map();
var sourcesMap = new WeakMap();
var TargetHandlerPair = (function () {
    function TargetHandlerPair(target, handler) {
        this.tagetRef = new WeakRef(target);
        this.handler = handler;
    }
    return TargetHandlerPair;
}());
function getHandlerForEventName(eventName) {
    var handler = handlersForEventName.get(eventName);
    if (!handler) {
        handler = function (eventData) {
            var source = eventData.object;
            var sourceEventMap = sourcesMap.get(source);
            if (!sourceEventMap) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                return;
            }
            var targetHandlerPairList = sourceEventMap.get(eventName);
            if (!targetHandlerPairList) {
                return;
            }
            var deadPairsIndexes = [];
            var pair;
            var target;
            for (var i = 0; i < targetHandlerPairList.length; i++) {
                pair = targetHandlerPairList[i];
                target = pair.tagetRef.get();
                if (target) {
                    pair.handler.call(target, eventData);
                }
                else {
                    deadPairsIndexes.push(i);
                }
            }
            if (deadPairsIndexes.length === targetHandlerPairList.length) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                sourceEventMap.delete(eventName);
            }
            else {
                for (var j = deadPairsIndexes.length - 1; j >= 0; j--) {
                    targetHandlerPairList.splice(deadPairsIndexes[j], 1);
                }
            }
        };
        handlersForEventName.set(eventName, handler);
    }
    return handler;
}
function validateArgs(source, eventName, handler, target) {
    if (!source) {
        throw new Error("source is null or undefined");
    }
    if (!target) {
        throw new Error("target is null or undefined");
    }
    if (typeof eventName !== "string") {
        throw new Error("eventName is not a string");
    }
    if (typeof handler !== "function") {
        throw new Error("handler is not a function");
    }
}
function addWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var shouldAttach = false;
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        sourceEventMap = new Map();
        sourcesMap.set(source, sourceEventMap);
        shouldAttach = true;
    }
    var pairList = sourceEventMap.get(eventName);
    if (!pairList) {
        pairList = new Array();
        sourceEventMap.set(eventName, pairList);
        shouldAttach = true;
    }
    pairList.push(new TargetHandlerPair(target, handler));
    if (shouldAttach) {
        source.addEventListener(eventName, getHandlerForEventName(eventName));
    }
}
exports.addWeakEventListener = addWeakEventListener;
function removeWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var handlerForEventWithName = handlersForEventName.get(eventName);
    if (!handlerForEventWithName) {
        return;
    }
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        return;
    }
    var targetHandlerPairList = sourceEventMap.get(eventName);
    if (!targetHandlerPairList) {
        return;
    }
    var targetHandlerPairsToRemove = [];
    var pair;
    var registeredTarget;
    for (var i = 0; i < targetHandlerPairList.length; i++) {
        pair = targetHandlerPairList[i];
        registeredTarget = pair.tagetRef.get();
        if (!registeredTarget || (registeredTarget === target && handler === pair.handler)) {
            targetHandlerPairsToRemove.push(i);
        }
    }
    if (targetHandlerPairsToRemove.length === targetHandlerPairList.length) {
        source.removeEventListener(eventName, handlerForEventWithName);
        sourceEventMap.delete(eventName);
    }
    else {
        for (var j = targetHandlerPairsToRemove.length - 1; j >= 0; j--) {
            targetHandlerPairList.splice(targetHandlerPairsToRemove[j], 1);
        }
    }
}
exports.removeWeakEventListener = removeWeakEventListener;
//# sourceMappingURL=weak-event-listener.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var defaultDate = new Date();
var dateComparer = function (x, y) { return (x <= y && x >= y); };
var DatePickerBase = (function (_super) {
    __extends(DatePickerBase, _super);
    function DatePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePickerBase = __decorate([
        view_1.CSSType("DatePicker")
    ], DatePickerBase);
    return DatePickerBase;
}(view_1.View));
exports.DatePickerBase = DatePickerBase;
DatePickerBase.prototype.recycleNativeView = "auto";
exports.yearProperty = new view_1.Property({
    name: "year",
    defaultValue: defaultDate.getFullYear(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.yearProperty.register(DatePickerBase);
exports.monthProperty = new view_1.Property({
    name: "month",
    defaultValue: defaultDate.getMonth() + 1,
    valueConverter: function (v) { return parseInt(v); },
});
exports.monthProperty.register(DatePickerBase);
exports.dayProperty = new view_1.Property({
    name: "day",
    defaultValue: defaultDate.getDate(),
    valueConverter: function (v) { return parseInt(v); },
});
exports.dayProperty.register(DatePickerBase);
exports.maxDateProperty = new view_1.Property({
    name: "maxDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.maxDateProperty.register(DatePickerBase);
exports.minDateProperty = new view_1.Property({
    name: "minDate",
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.minDateProperty.register(DatePickerBase);
exports.dateProperty = new view_1.Property({
    name: "date",
    defaultValue: defaultDate,
    equalityComparer: dateComparer,
    valueConverter: function (v) { return new Date(v); },
});
exports.dateProperty.register(DatePickerBase);
//# sourceMappingURL=date-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/date-picker/date-picker.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var date_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/date-picker/date-picker-common.js"));
var DatePicker = (function (_super) {
    __extends(DatePicker, _super);
    function DatePicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DatePicker.prototype.createNativeView = function () {
        var picker = UIDatePicker.new();
        picker.datePickerMode = 1;
        return picker;
    };
    DatePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        this._changeHandler = UIDatePickerChangeHandlerImpl.initWithOwner(new WeakRef(this));
        nativeView.addTargetActionForControlEvents(this._changeHandler, "valueChanged", 4096);
    };
    DatePicker.prototype.disposeNativeView = function () {
        this._changeHandler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(DatePicker.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    DatePicker.prototype[date_picker_common_1.yearProperty.setNative] = function (value) {
        this.date = new Date(value, this.month - 1, this.day);
    };
    DatePicker.prototype[date_picker_common_1.monthProperty.setNative] = function (value) {
        this.date = new Date(this.year, value - 1, this.day);
    };
    DatePicker.prototype[date_picker_common_1.dayProperty.setNative] = function (value) {
        this.date = new Date(this.year, this.month - 1, value);
    };
    DatePicker.prototype[date_picker_common_1.dateProperty.setNative] = function (value) {
        var picker = this.nativeViewProtected;
        var comps = NSCalendar.currentCalendar.componentsFromDate(4 | 8 | 16, picker.date);
        comps.year = value.getFullYear();
        comps.month = value.getMonth() + 1;
        comps.day = value.getDate();
        picker.setDateAnimated(NSCalendar.currentCalendar.dateFromComponents(comps), false);
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.getDefault] = function () {
        return this.nativeViewProtected.maximumDate;
    };
    DatePicker.prototype[date_picker_common_1.maxDateProperty.setNative] = function (value) {
        var picker = this.nativeViewProtected;
        var nsDate = NSDate.dateWithTimeIntervalSince1970(value.getTime() / 1000);
        picker.maximumDate = nsDate;
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.getDefault] = function () {
        return this.nativeViewProtected.minimumDate;
    };
    DatePicker.prototype[date_picker_common_1.minDateProperty.setNative] = function (value) {
        var picker = this.nativeViewProtected;
        var nsDate = NSDate.dateWithTimeIntervalSince1970(value.getTime() / 1000);
        picker.minimumDate = nsDate;
    };
    DatePicker.prototype[date_picker_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.valueForKey("textColor");
    };
    DatePicker.prototype[date_picker_common_1.colorProperty.setNative] = function (value) {
        var picker = this.nativeViewProtected;
        picker.setValueForKey(value instanceof date_picker_common_1.Color ? value.ios : value, "textColor");
    };
    return DatePicker;
}(date_picker_common_1.DatePickerBase));
exports.DatePicker = DatePicker;
var UIDatePickerChangeHandlerImpl = (function (_super) {
    __extends(UIDatePickerChangeHandlerImpl, _super);
    function UIDatePickerChangeHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIDatePickerChangeHandlerImpl.initWithOwner = function (owner) {
        var impl = UIDatePickerChangeHandlerImpl.new();
        impl._owner = owner;
        return impl;
    };
    UIDatePickerChangeHandlerImpl.prototype.valueChanged = function (sender) {
        var comps = NSCalendar.currentCalendar.componentsFromDate(4 | 8 | 16, sender.date);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        var dateChanged = false;
        if (comps.year !== owner.year) {
            date_picker_common_1.yearProperty.nativeValueChange(owner, comps.year);
            dateChanged = true;
        }
        if (comps.month !== owner.month) {
            date_picker_common_1.monthProperty.nativeValueChange(owner, comps.month);
            dateChanged = true;
        }
        if (comps.day !== owner.day) {
            date_picker_common_1.dayProperty.nativeValueChange(owner, comps.day);
            dateChanged = true;
        }
        if (dateChanged) {
            date_picker_common_1.dateProperty.nativeValueChange(owner, new Date(comps.year, comps.month - 1, comps.day));
        }
    };
    UIDatePickerChangeHandlerImpl.ObjCExposedMethods = {
        "valueChanged": { returns: interop.types.void, params: [UIDatePicker] }
    };
    return UIDatePickerChangeHandlerImpl;
}(NSObject));
//# sourceMappingURL=date-picker.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
exports.STRING = "string";
exports.PROMPT = "Prompt";
exports.CONFIRM = "Confirm";
exports.ALERT = "Alert";
exports.LOGIN = "Login";
exports.OK = "OK";
exports.CANCEL = "Cancel";
var inputType;
(function (inputType) {
    inputType.text = "text";
    inputType.password = "password";
    inputType.email = "email";
    inputType.number = "number";
    inputType.decimal = "decimal";
    inputType.phone = "phone";
})(inputType = exports.inputType || (exports.inputType = {}));
var capitalizationType;
(function (capitalizationType) {
    capitalizationType.none = "none";
    capitalizationType.all = "all";
    capitalizationType.sentences = "sentences";
    capitalizationType.words = "words";
})(capitalizationType = exports.capitalizationType || (exports.capitalizationType = {}));
var frame;
function getCurrentPage() {
    if (!frame) {
        frame = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
    }
    var topmostFrame = frame.topmost();
    if (topmostFrame) {
        return topmostFrame.currentPage;
    }
    return undefined;
}
exports.getCurrentPage = getCurrentPage;
function applySelectors(view, callback) {
    var currentPage = getCurrentPage();
    if (currentPage) {
        var styleScope = currentPage._styleScope;
        if (styleScope) {
            view._inheritStyleScope(styleScope);
            view.onLoaded();
            callback(view);
            view.onUnloaded();
        }
    }
}
var button;
var label;
var textField;
function getButtonColors() {
    if (!button) {
        var Button = __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js").Button;
        button = new Button;
        if (platform_1.isIOS) {
            button._setupUI({});
        }
    }
    var buttonColor;
    var buttonBackgroundColor;
    applySelectors(button, function (btn) {
        buttonColor = btn.color;
        buttonBackgroundColor = btn.backgroundColor;
    });
    return { color: buttonColor, backgroundColor: buttonBackgroundColor };
}
exports.getButtonColors = getButtonColors;
function getLabelColor() {
    if (!label) {
        var Label = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js").Label;
        label = new Label;
        if (platform_1.isIOS) {
            label._setupUI({});
        }
    }
    var labelColor;
    applySelectors(label, function (lbl) {
        labelColor = lbl.color;
    });
    return labelColor;
}
exports.getLabelColor = getLabelColor;
function getTextFieldColor() {
    if (!textField) {
        var TextField = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js").TextField;
        textField = new TextField();
        if (platform_1.isIOS) {
            textField._setupUI({});
        }
    }
    var textFieldColor;
    applySelectors(textField, function (tf) {
        textFieldColor = tf.color;
    });
    return textFieldColor;
}
exports.getTextFieldColor = getTextFieldColor;
function isDialogOptions(arg) {
    return arg && (arg.message || arg.title);
}
exports.isDialogOptions = isDialogOptions;
function parseLoginOptions(args) {
    if (args.length === 1 && types_1.isObject(args[0])) {
        return args[0];
    }
    var options = { title: exports.LOGIN, okButtonText: exports.OK, cancelButtonText: exports.CANCEL };
    if (types_1.isString(args[0])) {
        options.message = args[0];
    }
    if (types_1.isString(args[1])) {
        options.userNameHint = args[1];
    }
    if (types_1.isString(args[2])) {
        options.passwordHint = args[2];
    }
    if (types_1.isString(args[3])) {
        options.userName = args[3];
    }
    if (types_1.isString(args[4])) {
        options.password = args[4];
    }
    return options;
}
exports.parseLoginOptions = parseLoginOptions;
//# sourceMappingURL=dialogs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var dialogs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js"));
function addButtonsToAlertController(alertController, options, callback) {
    if (!options) {
        return;
    }
    if (types_1.isString(options.cancelButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.cancelButtonText, 0, function () {
            raiseCallback(callback, false);
        }));
    }
    if (types_1.isString(options.neutralButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.neutralButtonText, 0, function () {
            raiseCallback(callback, undefined);
        }));
    }
    if (types_1.isString(options.okButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.okButtonText, 0, function () {
            raiseCallback(callback, true);
        }));
    }
}
function raiseCallback(callback, result) {
    if (types_1.isFunction(callback)) {
        callback(result);
    }
}
function alert(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.ALERT, okButtonText: dialogs_common_1.OK, message: arg + "" } : arg;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            addButtonsToAlertController(alertController, options, function () { resolve(); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.alert = alert;
function confirm(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.CONFIRM, okButtonText: dialogs_common_1.OK, cancelButtonText: dialogs_common_1.CANCEL, message: arg + "" } : arg;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            addButtonsToAlertController(alertController, options, function (r) { resolve(r); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.confirm = confirm;
function prompt(arg) {
    var options;
    var defaultOptions = {
        title: dialogs_common_1.PROMPT,
        okButtonText: dialogs_common_1.OK,
        cancelButtonText: dialogs_common_1.CANCEL,
        inputType: dialogs_common_1.inputType.text,
    };
    if (arguments.length === 1) {
        if (types_1.isString(arg)) {
            options = defaultOptions;
            options.message = arg;
        }
        else {
            options = arg;
        }
    }
    else if (arguments.length === 2) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.defaultText = arguments[1];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var textField_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.text = types_1.isString(options.defaultText) ? options.defaultText : "";
                arg.secureTextEntry = options && options.inputType === dialogs_common_1.inputType.password;
                if (options && options.inputType === dialogs_common_1.inputType.email) {
                    arg.keyboardType = 7;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.number) {
                    arg.keyboardType = 4;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.decimal) {
                    arg.keyboardType = 8;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.phone) {
                    arg.keyboardType = 5;
                }
                var color = dialogs_common_1.getTextFieldColor();
                if (color) {
                    arg.textColor = arg.tintColor = color.ios;
                }
            });
            textField_1 = alertController.textFields.firstObject;
            if (options) {
                switch (options.capitalizationType) {
                    case dialogs_common_1.capitalizationType.all: {
                        textField_1.autocapitalizationType = 3;
                        break;
                    }
                    case dialogs_common_1.capitalizationType.sentences: {
                        textField_1.autocapitalizationType = 2;
                        break;
                    }
                    case dialogs_common_1.capitalizationType.words: {
                        textField_1.autocapitalizationType = 1;
                        break;
                    }
                    default: {
                        textField_1.autocapitalizationType = 0;
                    }
                }
            }
            addButtonsToAlertController(alertController, options, function (r) { resolve({ result: r, text: textField_1.text }); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.prompt = prompt;
function login() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var options = dialogs_common_1.parseLoginOptions(args);
    return new Promise(function (resolve, reject) {
        try {
            var userNameTextField_1;
            var passwordTextField_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            var textFieldColor_1 = dialogs_common_1.getTextFieldColor();
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.placeholder = "Login";
                arg.placeholder = options.userNameHint ? options.userNameHint : "";
                arg.text = types_1.isString(options.userName) ? options.userName : "";
                if (textFieldColor_1) {
                    arg.textColor = arg.tintColor = textFieldColor_1.ios;
                }
            });
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.placeholder = "Password";
                arg.secureTextEntry = true;
                arg.placeholder = options.passwordHint ? options.passwordHint : "";
                arg.text = types_1.isString(options.password) ? options.password : "";
                if (textFieldColor_1) {
                    arg.textColor = arg.tintColor = textFieldColor_1.ios;
                }
            });
            userNameTextField_1 = alertController.textFields.firstObject;
            passwordTextField_1 = alertController.textFields.lastObject;
            addButtonsToAlertController(alertController, options, function (r) {
                resolve({
                    result: r,
                    userName: userNameTextField_1.text,
                    password: passwordTextField_1.text
                });
            });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.login = login;
function showUIAlertController(alertController) {
    var _a, _b;
    var currentView = dialogs_common_1.getCurrentPage() || application_1.getRootView();
    if (currentView) {
        currentView = currentView.modal || currentView;
        var viewController = currentView.ios;
        if (!(currentView.ios instanceof UIViewController)) {
            var parentWithController = view_1.ios.getParentWithViewController(currentView);
            viewController = parentWithController ? parentWithController.viewController : undefined;
        }
        if (viewController) {
            if (alertController.popoverPresentationController) {
                alertController.popoverPresentationController.sourceView = viewController.view;
                alertController.popoverPresentationController.sourceRect = CGRectMake(viewController.view.bounds.size.width / 2.0, viewController.view.bounds.size.height / 2.0, 1.0, 1.0);
                alertController.popoverPresentationController.permittedArrowDirections = 0;
            }
            var color = dialogs_common_1.getButtonColors().color;
            if (color) {
                alertController.view.tintColor = color.ios;
            }
            var lblColor = dialogs_common_1.getLabelColor();
            if (lblColor) {
                if (alertController.title) {
                    var title = NSAttributedString.alloc().initWithStringAttributes(alertController.title, (_a = {}, _a[NSForegroundColorAttributeName] = lblColor.ios, _a));
                    alertController.setValueForKey(title, "attributedTitle");
                }
                if (alertController.message) {
                    var message = NSAttributedString.alloc().initWithStringAttributes(alertController.message, (_b = {}, _b[NSForegroundColorAttributeName] = lblColor.ios, _b));
                    alertController.setValueForKey(message, "attributedMessage");
                }
            }
            viewController.presentModalViewControllerAnimated(alertController, true);
        }
    }
}
function action() {
    var options;
    var defaultOptions = { title: null, cancelButtonText: dialogs_common_1.CANCEL };
    if (arguments.length === 1) {
        if (types_1.isString(arguments[0])) {
            options = defaultOptions;
            options.message = arguments[0];
        }
        else {
            options = arguments[0];
        }
    }
    else if (arguments.length === 2) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
        }
    }
    else if (arguments.length === 3) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1]) && types_1.isDefined(arguments[2])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
            options.actions = arguments[2];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var i = void 0;
            var action_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 0);
            if (options.actions) {
                for (i = 0; i < options.actions.length; i++) {
                    action_1 = options.actions[i];
                    if (types_1.isString(action_1)) {
                        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(action_1, 0, function (arg) {
                            resolve(arg.title);
                        }));
                    }
                }
            }
            if (types_1.isString(options.cancelButtonText)) {
                alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.cancelButtonText, 1, function (arg) {
                    resolve(arg.title);
                }));
            }
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.action = action;
//# sourceMappingURL=dialogs.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._focusHandler = function () { return _this._goToVisualState("focus"); };
        _this._blurHandler = function () { return _this._goToVisualState("blur"); };
        return _this;
    }
    EditableTextBase.prototype._updateTextBaseFocusStateHandler = function (subscribe) {
        var method = subscribe ? "on" : "off";
        this[method]("focus", this._focusHandler);
        this[method]("blur", this._blurHandler);
    };
    EditableTextBase.blurEvent = "blur";
    EditableTextBase.focusEvent = "focus";
    EditableTextBase.textChangeEvent = "textChange";
    __decorate([
        text_base_1.PseudoClassHandler("focus", "blur")
    ], EditableTextBase.prototype, "_updateTextBaseFocusStateHandler", null);
    return EditableTextBase;
}(text_base_1.TextBase));
exports.EditableTextBase = EditableTextBase;
exports.placeholderColorProperty = new text_base_1.CssProperty({ name: "placeholderColor", cssName: "placeholder-color", equalityComparer: text_base_1.Color.equals, valueConverter: function (v) { return new text_base_1.Color(v); } });
exports.placeholderColorProperty.register(text_base_1.Style);
var keyboardTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("datetime", "phone", "number", "url", "email"));
exports.keyboardTypeProperty = new text_base_1.Property({ name: "keyboardType", valueConverter: keyboardTypeConverter });
exports.keyboardTypeProperty.register(EditableTextBase);
var returnKeyTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("done", "next", "go", "search", "send"));
exports.returnKeyTypeProperty = new text_base_1.Property({ name: "returnKeyType", valueConverter: returnKeyTypeConverter });
exports.returnKeyTypeProperty.register(EditableTextBase);
exports.editableProperty = new text_base_1.Property({ name: "editable", defaultValue: true, valueConverter: text_base_1.booleanConverter });
exports.editableProperty.register(EditableTextBase);
exports.updateTextTriggerProperty = new text_base_1.Property({ name: "updateTextTrigger", defaultValue: "textChanged" });
exports.updateTextTriggerProperty.register(EditableTextBase);
var autocapitalizationTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("none", "words", "sentences", "allcharacters"));
exports.autocapitalizationTypeProperty = new text_base_1.Property({ name: "autocapitalizationType", defaultValue: "sentences", valueConverter: autocapitalizationTypeConverter });
exports.autocapitalizationTypeProperty.register(EditableTextBase);
exports.autocorrectProperty = new text_base_1.Property({ name: "autocorrect", valueConverter: text_base_1.booleanConverter });
exports.autocorrectProperty.register(EditableTextBase);
exports.hintProperty = new text_base_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(EditableTextBase);
exports.maxLengthProperty = new text_base_1.Property({ name: "maxLength", defaultValue: Number.POSITIVE_INFINITY, valueConverter: parseInt });
exports.maxLengthProperty.register(EditableTextBase);
//# sourceMappingURL=editable-text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EditableTextBase.prototype.dismissSoftInput = function () {
        this.nativeTextViewProtected.resignFirstResponder();
        this.notify({ eventName: EditableTextBase.blurEvent, object: this });
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.getDefault] = function () {
        var keyboardType = this.nativeTextViewProtected.keyboardType;
        switch (keyboardType) {
            case 2:
                return "number";
            case 5:
                return "phone";
            case 3:
                return "url";
            case 7:
                return "email";
            default:
                return keyboardType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.setNative] = function (value) {
        var newKeyboardType;
        switch (value) {
            case "datetime":
                newKeyboardType = 2;
                break;
            case "phone":
                newKeyboardType = 5;
                break;
            case "number":
                newKeyboardType = 2;
                break;
            case "url":
                newKeyboardType = 3;
                break;
            case "email":
                newKeyboardType = 7;
                break;
            default:
                var kt = +value;
                if (!isNaN(kt)) {
                    newKeyboardType = kt;
                }
                else {
                    newKeyboardType = 0;
                }
                break;
        }
        this.nativeTextViewProtected.keyboardType = newKeyboardType;
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.getDefault] = function () {
        var returnKeyType = this.nativeTextViewProtected.returnKeyType;
        switch (returnKeyType) {
            case 9:
                return "done";
            case 1:
                return "go";
            case 4:
                return "next";
            case 6:
                return "search";
            case 7:
                return "send";
            default:
                return returnKeyType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.setNative] = function (value) {
        var newValue;
        switch (value) {
            case "done":
                newValue = 9;
                break;
            case "go":
                newValue = 1;
                break;
            case "next":
                newValue = 4;
                break;
            case "search":
                newValue = 6;
                break;
            case "send":
                newValue = 7;
                break;
            default:
                var rkt = +value;
                if (!isNaN(rkt)) {
                    newValue = rkt;
                }
                else {
                    newValue = 0;
                }
                break;
        }
        this.nativeTextViewProtected.returnKeyType = newValue;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.getDefault] = function () {
        var autocapitalizationType = this.nativeTextViewProtected.autocapitalizationType;
        switch (autocapitalizationType) {
            case 0:
                return "none";
            case 1:
                return "words";
            case 2:
                return "sentences";
            case 3:
                return "allcharacters";
            default:
                throw new Error("Invalid autocapitalizationType value:" + autocapitalizationType);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.setNative] = function (value) {
        var newValue;
        switch (value) {
            case "none":
                newValue = 0;
                break;
            case "words":
                newValue = 1;
                break;
            case "sentences":
                newValue = 2;
                break;
            case "allcharacters":
                newValue = 3;
                break;
            default:
                newValue = 2;
                break;
        }
        this.nativeTextViewProtected.autocapitalizationType = newValue;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.getDefault] = function () {
        var autocorrectionType = this.nativeTextViewProtected.autocorrectionType;
        switch (autocorrectionType) {
            case 2:
                return true;
            case 1:
                return false;
            case 0:
                return autocorrectionType;
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.setNative] = function (value) {
        var newValue;
        if (typeof value === "number") {
            newValue = 0;
        }
        else if (value) {
            newValue = 2;
        }
        else {
            newValue = 1;
        }
        this.nativeTextViewProtected.autocorrectionType = newValue;
    };
    return EditableTextBase;
}(editable_text_base_common_1.EditableTextBase));
exports.EditableTextBase = EditableTextBase;
function _updateCharactersInRangeReplacementString(formattedText, rangeLocation, rangeLength, replacementString) {
    var deletingText = !replacementString;
    var currentLocation = 0;
    for (var i = 0, length_1 = formattedText.spans.length; i < length_1; i++) {
        var span = formattedText.spans.getItem(i);
        if (currentLocation <= rangeLocation && rangeLocation < (currentLocation + span.text.length)) {
            var newText = splice(span.text, rangeLocation - currentLocation, deletingText ? rangeLength : 0, replacementString);
            span._setTextInternal(newText);
            return;
        }
        currentLocation += span.text.length;
    }
}
exports._updateCharactersInRangeReplacementString = _updateCharactersInRangeReplacementString;
function splice(value, start, delCount, newSubStr) {
    return value.slice(0, start) + newSubStr + value.slice(start + Math.abs(delCount));
}
//# sourceMappingURL=editable-text-base.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/enums/enums.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var KeyboardType;
(function (KeyboardType) {
    KeyboardType.datetime = "datetime";
    KeyboardType.phone = "phone";
    KeyboardType.number = "number";
    KeyboardType.url = "url";
    KeyboardType.email = "email";
})(KeyboardType = exports.KeyboardType || (exports.KeyboardType = {}));
var ReturnKeyType;
(function (ReturnKeyType) {
    ReturnKeyType.done = "done";
    ReturnKeyType.next = "next";
    ReturnKeyType.go = "go";
    ReturnKeyType.search = "search";
    ReturnKeyType.send = "send";
})(ReturnKeyType = exports.ReturnKeyType || (exports.ReturnKeyType = {}));
var TextAlignment;
(function (TextAlignment) {
    TextAlignment.left = "left";
    TextAlignment.center = "center";
    TextAlignment.right = "right";
})(TextAlignment = exports.TextAlignment || (exports.TextAlignment = {}));
var TextDecoration;
(function (TextDecoration) {
    TextDecoration.none = "none";
    TextDecoration.underline = "underline";
    TextDecoration.lineThrough = "line-through";
})(TextDecoration = exports.TextDecoration || (exports.TextDecoration = {}));
var TextTransform;
(function (TextTransform) {
    TextTransform.none = "none";
    TextTransform.capitalize = "capitalize";
    TextTransform.uppercase = "uppercase";
    TextTransform.lowercase = "lowercase";
})(TextTransform = exports.TextTransform || (exports.TextTransform = {}));
var WhiteSpace;
(function (WhiteSpace) {
    WhiteSpace.normal = "normal";
    WhiteSpace.nowrap = "nowrap";
})(WhiteSpace = exports.WhiteSpace || (exports.WhiteSpace = {}));
var Orientation;
(function (Orientation) {
    Orientation.horizontal = "horizontal";
    Orientation.vertical = "vertical";
})(Orientation = exports.Orientation || (exports.Orientation = {}));
var DeviceOrientation;
(function (DeviceOrientation) {
    DeviceOrientation.portrait = "portrait";
    DeviceOrientation.landscape = "landscape";
    DeviceOrientation.unknown = "unknown";
})(DeviceOrientation = exports.DeviceOrientation || (exports.DeviceOrientation = {}));
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.left = "left";
    HorizontalAlignment.center = "center";
    HorizontalAlignment.right = "right";
    HorizontalAlignment.stretch = "stretch";
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.top = "top";
    VerticalAlignment.middle = "middle";
    VerticalAlignment.bottom = "bottom";
    VerticalAlignment.stretch = "stretch";
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
var Stretch;
(function (Stretch) {
    Stretch.none = "none";
    Stretch.aspectFill = "aspectFill";
    Stretch.aspectFit = "aspectFit";
    Stretch.fill = "fill";
})(Stretch = exports.Stretch || (exports.Stretch = {}));
var Visibility;
(function (Visibility) {
    Visibility.visible = "visible";
    Visibility.collapse = "collapse";
    Visibility.collapsed = "collapsed";
})(Visibility = exports.Visibility || (exports.Visibility = {}));
var FontAttributes;
(function (FontAttributes) {
    FontAttributes.Normal = 0;
    FontAttributes.Bold = 1;
    FontAttributes.Italic = 1 << 1;
})(FontAttributes = exports.FontAttributes || (exports.FontAttributes = {}));
var DeviceType;
(function (DeviceType) {
    DeviceType.Phone = "Phone";
    DeviceType.Tablet = "Tablet";
})(DeviceType = exports.DeviceType || (exports.DeviceType = {}));
var UpdateTextTrigger;
(function (UpdateTextTrigger) {
    UpdateTextTrigger.focusLost = "focusLost";
    UpdateTextTrigger.textChanged = "textChanged";
})(UpdateTextTrigger = exports.UpdateTextTrigger || (exports.UpdateTextTrigger = {}));
var Accuracy;
(function (Accuracy) {
    Accuracy.any = 300;
    Accuracy.high = 3;
})(Accuracy = exports.Accuracy || (exports.Accuracy = {}));
var Dock;
(function (Dock) {
    Dock.left = "left";
    Dock.top = "top";
    Dock.right = "right";
    Dock.bottom = "bottom";
})(Dock = exports.Dock || (exports.Dock = {}));
var AutocapitalizationType;
(function (AutocapitalizationType) {
    AutocapitalizationType.none = "none";
    AutocapitalizationType.words = "words";
    AutocapitalizationType.sentences = "sentences";
    AutocapitalizationType.allCharacters = "allcharacters";
})(AutocapitalizationType = exports.AutocapitalizationType || (exports.AutocapitalizationType = {}));
var NavigationBarVisibility;
(function (NavigationBarVisibility) {
    NavigationBarVisibility.auto = "auto";
    NavigationBarVisibility.never = "never";
    NavigationBarVisibility.always = "always";
})(NavigationBarVisibility = exports.NavigationBarVisibility || (exports.NavigationBarVisibility = {}));
var AndroidActionBarIconVisibility;
(function (AndroidActionBarIconVisibility) {
    AndroidActionBarIconVisibility.auto = "auto";
    AndroidActionBarIconVisibility.never = "never";
    AndroidActionBarIconVisibility.always = "always";
})(AndroidActionBarIconVisibility = exports.AndroidActionBarIconVisibility || (exports.AndroidActionBarIconVisibility = {}));
var AndroidActionItemPosition;
(function (AndroidActionItemPosition) {
    AndroidActionItemPosition.actionBar = "actionBar";
    AndroidActionItemPosition.actionBarIfRoom = "actionBarIfRoom";
    AndroidActionItemPosition.popup = "popup";
})(AndroidActionItemPosition = exports.AndroidActionItemPosition || (exports.AndroidActionItemPosition = {}));
var IOSActionItemPosition;
(function (IOSActionItemPosition) {
    IOSActionItemPosition.left = "left";
    IOSActionItemPosition.right = "right";
})(IOSActionItemPosition = exports.IOSActionItemPosition || (exports.IOSActionItemPosition = {}));
var ImageFormat;
(function (ImageFormat) {
    ImageFormat.png = "png";
    ImageFormat.jpeg = "jpeg";
    ImageFormat.jpg = "jpg";
})(ImageFormat = exports.ImageFormat || (exports.ImageFormat = {}));
var FontStyle;
(function (FontStyle) {
    FontStyle.normal = "normal";
    FontStyle.italic = "italic";
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.thin = "100";
    FontWeight.extraLight = "200";
    FontWeight.light = "300";
    FontWeight.normal = "normal";
    FontWeight.medium = "500";
    FontWeight.semiBold = "600";
    FontWeight.bold = "bold";
    FontWeight.extraBold = "800";
    FontWeight.black = "900";
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.repeat = "repeat";
    BackgroundRepeat.repeatX = "repeat-x";
    BackgroundRepeat.repeatY = "repeat-y";
    BackgroundRepeat.noRepeat = "no-repeat";
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
var animation;
var AnimationCurve;
(function (AnimationCurve) {
    AnimationCurve.ease = "ease";
    AnimationCurve.easeIn = "easeIn";
    AnimationCurve.easeOut = "easeOut";
    AnimationCurve.easeInOut = "easeInOut";
    AnimationCurve.linear = "linear";
    AnimationCurve.spring = "spring";
    function cubicBezier(x1, y1, x2, y2) {
        animation = animation || __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
        return new animation.CubicBezierAnimationCurve(x1, y1, x2, y2);
    }
    AnimationCurve.cubicBezier = cubicBezier;
})(AnimationCurve = exports.AnimationCurve || (exports.AnimationCurve = {}));
var StatusBarStyle;
(function (StatusBarStyle) {
    StatusBarStyle.light = "light";
    StatusBarStyle.dark = "dark";
})(StatusBarStyle = exports.StatusBarStyle || (exports.StatusBarStyle = {}));
//# sourceMappingURL=enums.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.transitions.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var slide_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/slide-transition.js");
var fade_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/fade-transition.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var UIViewControllerAnimatedTransitioningMethods;
(function (UIViewControllerAnimatedTransitioningMethods) {
    var methodSignature = NSMethodSignature.signatureWithObjCTypes("v@:c");
    var invocation = NSInvocation.invocationWithMethodSignature(methodSignature);
    invocation.selector = "completeTransition:";
    function completeTransition(didComplete) {
        var didCompleteReference = new interop.Reference(interop.types.bool, didComplete);
        invocation.setArgumentAtIndex(didCompleteReference, 2);
        invocation.invokeWithTarget(this);
    }
    UIViewControllerAnimatedTransitioningMethods.completeTransition = completeTransition;
})(UIViewControllerAnimatedTransitioningMethods || (UIViewControllerAnimatedTransitioningMethods = {}));
var AnimatedTransitioning = (function (_super) {
    __extends(AnimatedTransitioning, _super);
    function AnimatedTransitioning() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnimatedTransitioning.init = function (transition, operation, fromVC, toVC) {
        var impl = AnimatedTransitioning.new();
        impl._transition = transition;
        impl._operation = operation;
        impl._fromVC = fromVC;
        impl._toVC = toVC;
        return impl;
    };
    AnimatedTransitioning.prototype.animateTransition = function (transitionContext) {
        var containerView = transitionContext.valueForKey("containerView");
        var completion = UIViewControllerAnimatedTransitioningMethods.completeTransition.bind(transitionContext);
        switch (this._operation) {
            case 1:
                this._transitionType = "push";
                break;
            case 2:
                this._transitionType = "pop";
                break;
            case 0:
                this._transitionType = "none";
                break;
        }
        if (trace_1.isEnabled()) {
            trace_1.write("START " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
        }
        this._transition.animateIOSTransition(containerView, this._fromVC.view, this._toVC.view, this._operation, completion);
    };
    AnimatedTransitioning.prototype.transitionDuration = function (transitionContext) {
        return this._transition.getDuration();
    };
    AnimatedTransitioning.prototype.animationEnded = function (transitionCompleted) {
        if (transitionCompleted) {
            if (trace_1.isEnabled()) {
                trace_1.write("END " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
            }
        }
        else {
            if (trace_1.isEnabled()) {
                trace_1.write("CANCEL " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
            }
        }
    };
    AnimatedTransitioning.ObjCProtocols = [UIViewControllerAnimatedTransitioning];
    return AnimatedTransitioning;
}(NSObject));
function _createIOSAnimatedTransitioning(navigationTransition, nativeCurve, operation, fromVC, toVC) {
    var instance = navigationTransition.instance;
    var transition;
    if (instance) {
        transition = instance;
    }
    else if (navigationTransition.name) {
        var name_1 = navigationTransition.name.toLowerCase();
        if (name_1.indexOf("slide") === 0) {
            var direction = name_1.substr("slide".length) || "left";
            transition = new slide_transition_1.SlideTransition(direction, navigationTransition.duration, nativeCurve);
        }
        else if (name_1 === "fade") {
            transition = new fade_transition_1.FadeTransition(navigationTransition.duration, nativeCurve);
        }
    }
    return transition ? AnimatedTransitioning.init(transition, operation, fromVC, toVC) : undefined;
}
exports._createIOSAnimatedTransitioning = _createIOSAnimatedTransitioning;
//# sourceMappingURL=fragment.transitions.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var NavigationType;
(function (NavigationType) {
    NavigationType[NavigationType["back"] = 0] = "back";
    NavigationType[NavigationType["forward"] = 1] = "forward";
    NavigationType[NavigationType["replace"] = 2] = "replace";
})(NavigationType = exports.NavigationType || (exports.NavigationType = {}));
function buildEntryFromArgs(arg) {
    var entry;
    if (typeof arg === "string") {
        entry = {
            moduleName: arg
        };
    }
    else if (typeof arg === "function") {
        entry = {
            create: arg
        };
    }
    else {
        entry = arg;
    }
    return entry;
}
var FrameBase = (function (_super) {
    __extends(FrameBase, _super);
    function FrameBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._backStack = new Array();
        _this._navigationQueue = new Array();
        _this._isInFrameStack = false;
        return _this;
    }
    FrameBase_1 = FrameBase;
    FrameBase.prototype._addChildFromBuilder = function (name, value) {
        throw new Error("Frame should not have a view. Use 'defaultPage' property instead.");
    };
    FrameBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.canGoBack = function () {
        var _this = this;
        var backstack = this._backStack.length;
        var previousForwardNotInBackstack = false;
        this._navigationQueue.forEach(function (item) {
            var entry = item.entry;
            var isBackNavigation = item.navigationType === NavigationType.back;
            if (isBackNavigation) {
                previousForwardNotInBackstack = false;
                if (!entry) {
                    backstack--;
                }
                else {
                    var backstackIndex = _this._backStack.indexOf(entry);
                    if (backstackIndex !== -1) {
                        backstack = backstackIndex;
                    }
                    else {
                        backstack--;
                    }
                }
            }
            else if (entry.entry.clearHistory) {
                previousForwardNotInBackstack = false;
                backstack = 0;
            }
            else {
                backstack++;
                if (previousForwardNotInBackstack) {
                    backstack--;
                }
                previousForwardNotInBackstack = entry.entry.backstackVisible === false;
            }
        });
        if (this._navigationQueue.length > 0 && !this._currentEntry) {
            backstack--;
        }
        return backstack > 0;
    };
    FrameBase.prototype.goBack = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK", view_1.traceCategories.Navigation);
        }
        if (!this.canGoBack()) {
            return;
        }
        if (backstackEntry) {
            var index_1 = this._backStack.indexOf(backstackEntry);
            if (index_1 < 0) {
                return;
            }
        }
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: true,
            navigationType: NavigationType.back
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype._removeEntry = function (removed) {
        var page = removed.resolvedPage;
        var frame = page.frame;
        page._frame = null;
        if (frame) {
            frame._removeView(page);
        }
        else {
            page._tearDownUI(true);
        }
        removed.resolvedPage = null;
    };
    FrameBase.prototype.navigate = function (param) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE", view_1.traceCategories.Navigation);
        }
        var entry = buildEntryFromArgs(param);
        var page = builder_1.createViewFromEntry(entry);
        this._pushInFrameStack();
        var backstackEntry = {
            entry: entry,
            resolvedPage: page,
            navDepth: undefined,
            fragmentTag: undefined
        };
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.forward
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.isCurrent = function (entry) {
        return this._currentEntry === entry;
    };
    FrameBase.prototype.setCurrent = function (entry, navigationType) {
        var newPage = entry.resolvedPage;
        if (!newPage.frame) {
            this._addView(newPage);
            newPage._frame = this;
        }
        this._currentEntry = entry;
        var isBack = navigationType === NavigationType.back;
        if (isBack) {
            this._pushInFrameStack();
        }
        newPage.onNavigatedTo(isBack);
        this._executingContext = null;
    };
    FrameBase.prototype._updateBackstack = function (entry, navigationType) {
        var _this = this;
        var isBack = navigationType === NavigationType.back;
        var isReplace = navigationType === NavigationType.replace;
        this.raiseCurrentPageNavigatedEvents(isBack);
        var current = this._currentEntry;
        if (isBack) {
            var index_2 = this._backStack.indexOf(entry);
            this._backStack.splice(index_2 + 1).forEach(function (e) { return _this._removeEntry(e); });
            this._backStack.pop();
        }
        else if (!isReplace) {
            if (entry.entry.clearHistory) {
                this._backStack.forEach(function (e) { return _this._removeEntry(e); });
                this._backStack.length = 0;
            }
            else if (FrameBase_1._isEntryBackstackVisible(current)) {
                this._backStack.push(current);
            }
        }
        if (current && this._backStack.indexOf(current) < 0) {
            this._removeEntry(current);
        }
    };
    FrameBase.prototype.isNestedWithin = function (parentFrameCandidate) {
        var frameAncestor = this;
        while (frameAncestor) {
            frameAncestor = view_common_1.getAncestor(frameAncestor, FrameBase_1);
            if (frameAncestor === parentFrameCandidate) {
                return true;
            }
        }
        return false;
    };
    FrameBase.prototype.raiseCurrentPageNavigatedEvents = function (isBack) {
        var page = this.currentPage;
        if (page) {
            if (page.isLoaded) {
                page.callUnloaded();
            }
            page.onNavigatedFrom(isBack);
        }
    };
    FrameBase.prototype._processNavigationQueue = function (page) {
        if (this._navigationQueue.length === 0) {
            return;
        }
        var entry = this._navigationQueue[0].entry;
        var currentNavigationPage = entry.resolvedPage;
        if (page !== currentNavigationPage) {
            return;
        }
        this._navigationQueue.shift();
        this._processNextNavigationEntry();
        this._updateActionBar();
    };
    FrameBase.prototype._findEntryForTag = function (fragmentTag) {
        var entry;
        if (this._currentEntry && this._currentEntry.fragmentTag === fragmentTag) {
            entry = this._currentEntry;
        }
        else {
            entry = this._backStack.find(function (value) { return value.fragmentTag === fragmentTag; });
            if (!entry) {
                var navigationItem = this._navigationQueue.find(function (value) { return value.entry.fragmentTag === fragmentTag; });
                entry = navigationItem ? navigationItem.entry : undefined;
            }
        }
        return entry;
    };
    FrameBase.prototype.navigationQueueIsEmpty = function () {
        return this._navigationQueue.length === 0;
    };
    FrameBase._isEntryBackstackVisible = function (entry) {
        if (!entry) {
            return false;
        }
        var backstackVisibleValue = entry.entry.backstackVisible;
        var backstackHidden = backstackVisibleValue !== undefined && !backstackVisibleValue;
        return !backstackHidden;
    };
    FrameBase.prototype._updateActionBar = function (page, disableNavBarAnimation) {
    };
    FrameBase.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext) {
            return;
        }
        if (this._navigationQueue.length > 0) {
            var navigationContext = this._navigationQueue[0];
            var isBackNavigation = navigationContext.navigationType === NavigationType.back;
            if (isBackNavigation) {
                this.performGoBack(navigationContext);
            }
            else {
                this.performNavigation(navigationContext);
            }
        }
    };
    FrameBase.prototype.performNavigation = function (navigationContext) {
        this._executingContext = navigationContext;
        var backstackEntry = navigationContext.entry;
        var isBackNavigation = navigationContext.navigationType === NavigationType.back;
        this._onNavigatingTo(backstackEntry, isBackNavigation);
        this._navigateCore(backstackEntry);
    };
    FrameBase.prototype.performGoBack = function (navigationContext) {
        var backstackEntry = navigationContext.entry;
        var backstack = this._backStack;
        if (!backstackEntry) {
            backstackEntry = backstack[backstack.length - 1];
            navigationContext.entry = backstackEntry;
        }
        this._executingContext = navigationContext;
        this._onNavigatingTo(backstackEntry, true);
        this._goBackCore(backstackEntry);
    };
    FrameBase.prototype._goBackCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._navigateCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._onNavigatingTo = function (backstackEntry, isBack) {
        if (this.currentPage) {
            this.currentPage.onNavigatingFrom(isBack);
        }
        backstackEntry.resolvedPage.onNavigatingTo(backstackEntry.entry.context, isBack, backstackEntry.entry.bindingContext);
    };
    Object.defineProperty(FrameBase.prototype, "animated", {
        get: function () {
            return this._animated;
        },
        set: function (value) {
            this._animated = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "transition", {
        get: function () {
            return this._transition;
        },
        set: function (value) {
            this._transition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "backStack", {
        get: function () {
            return this._backStack.slice();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentPage", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.resolvedPage;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentEntry", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.entry;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._pushInFrameStackRecursive = function () {
        this._pushInFrameStack();
        var framesToPush = [];
        for (var _i = 0, frameStack_1 = frame_stack_1.frameStack; _i < frameStack_1.length; _i++) {
            var frame = frameStack_1[_i];
            if (frame.isNestedWithin(this)) {
                framesToPush.push(frame);
            }
        }
        for (var _a = 0, framesToPush_1 = framesToPush; _a < framesToPush_1.length; _a++) {
            var frame = framesToPush_1[_a];
            frame._pushInFrameStack();
        }
    };
    FrameBase.prototype._pushInFrameStack = function () {
        frame_stack_1._pushInFrameStack(this);
    };
    FrameBase.prototype._popFromFrameStack = function () {
        frame_stack_1._popFromFrameStack(this);
    };
    FrameBase.prototype._removeFromFrameStack = function () {
        frame_stack_1._removeFromFrameStack(this);
    };
    FrameBase.prototype._dialogClosed = function () {
        this._removeFromFrameStack();
    };
    FrameBase.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this._removeFromFrameStack();
    };
    Object.defineProperty(FrameBase.prototype, "_childrenCount", {
        get: function () {
            if (this.currentPage) {
                return 1;
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype.eachChildView = function (callback) {
        var page = this.currentPage;
        if (page) {
            callback(page);
        }
    };
    FrameBase.prototype._getIsAnimatedNavigation = function (entry) {
        if (entry && entry.animated !== undefined) {
            return entry.animated;
        }
        if (this.animated !== undefined) {
            return this.animated;
        }
        return FrameBase_1.defaultAnimatedNavigation;
    };
    FrameBase.prototype._getNavigationTransition = function (entry) {
        if (entry) {
            if (view_1.isIOS && entry.transitioniOS !== undefined) {
                return entry.transitioniOS;
            }
            if (view_1.isAndroid && entry.transitionAndroid !== undefined) {
                return entry.transitionAndroid;
            }
            if (entry.transition !== undefined) {
                return entry.transition;
            }
        }
        if (this.transition !== undefined) {
            return this.transition;
        }
        return FrameBase_1.defaultTransition;
    };
    Object.defineProperty(FrameBase.prototype, "navigationBarHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._getNavBarVisible = function (page) {
        throw new Error();
    };
    FrameBase.prototype._addViewToNativeVisualTree = function (child) {
        return true;
    };
    FrameBase.prototype._removeViewFromNativeVisualTree = function (child) {
        child._isAddedToNativeVisualTree = false;
    };
    FrameBase.prototype._printFrameBackStack = function () {
        var length = this.backStack.length;
        var i = length - 1;
        console.log("Frame Back Stack: ");
        while (i >= 0) {
            var backstackEntry = this.backStack[i--];
            console.log("\t" + backstackEntry.resolvedPage);
        }
    };
    FrameBase.prototype._backstackEntryTrace = function (b) {
        var result = "" + b.resolvedPage;
        var backstackVisible = FrameBase_1._isEntryBackstackVisible(b);
        if (!backstackVisible) {
            result += " | INVISIBLE";
        }
        if (b.entry.clearHistory) {
            result += " | CLEAR HISTORY";
        }
        var animated = this._getIsAnimatedNavigation(b.entry);
        if (!animated) {
            result += " | NOT ANIMATED";
        }
        var t = this._getNavigationTransition(b.entry);
        if (t) {
            result += " | Transition[" + JSON.stringify(t) + "]";
        }
        return result;
    };
    FrameBase.prototype._onLivesync = function (context) {
        if (_super.prototype._onLivesync.call(this, context)) {
            return true;
        }
        if (!context) {
            return this.legacyLivesync();
        }
        return false;
    };
    FrameBase.prototype._handleLivesync = function (context) {
        if (_super.prototype._handleLivesync.call(this, context)) {
            return true;
        }
        if (this.currentPage &&
            view_common_1.viewMatchesModuleContext(this.currentPage, context, ["markup", "script"])) {
            view_1.traceWrite("Change Handled: Replacing page " + context.path, view_1.traceCategories.Livesync);
            this.replacePage(context.path);
            return true;
        }
        return false;
    };
    FrameBase.prototype.legacyLivesync = function () {
        if (view_1.traceEnabled()) {
            view_1.traceWrite(this + "._onLivesync()", view_1.traceCategories.Livesync);
        }
        if (!this._currentEntry || !this._currentEntry.entry) {
            return false;
        }
        var currentEntry = this._currentEntry.entry;
        var newEntry = {
            animated: false,
            clearHistory: true,
            context: currentEntry.context,
            create: currentEntry.create,
            moduleName: currentEntry.moduleName,
            backstackVisible: currentEntry.backstackVisible
        };
        if (newEntry.create) {
            var page = newEntry.create();
            if (page === this.currentPage) {
                return false;
            }
        }
        this.navigate(newEntry);
        return true;
    };
    FrameBase.prototype.replacePage = function (pagePath) {
        var currentBackstackEntry = this._currentEntry;
        var contextModuleName = module_name_sanitizer_1.sanitizeModuleName(pagePath);
        var newPage = builder_1.createViewFromEntry({ moduleName: contextModuleName });
        var newBackstackEntry = {
            entry: currentBackstackEntry.entry,
            resolvedPage: newPage,
            navDepth: currentBackstackEntry.navDepth,
            fragmentTag: currentBackstackEntry.fragmentTag,
            frameId: currentBackstackEntry.frameId
        };
        var navigationContext = {
            entry: newBackstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.replace
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    var FrameBase_1;
    FrameBase.androidOptionSelectedEvent = "optionSelected";
    FrameBase.defaultAnimatedNavigation = true;
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performNavigation", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performGoBack", null);
    FrameBase = FrameBase_1 = __decorate([
        view_1.CSSType("Frame")
    ], FrameBase);
    return FrameBase;
}(view_1.CustomLayoutView));
exports.FrameBase = FrameBase;
function getFrameById(id) {
    return frame_stack_1.frameStack.find(function (frame) { return frame.id && frame.id === id; });
}
exports.getFrameById = getFrameById;
function topmost() {
    return frame_stack_1.topmost();
}
exports.topmost = topmost;
function goBack() {
    var top = topmost();
    if (top && top.canGoBack()) {
        top.goBack();
        return true;
    }
    else if (top) {
        var parentFrameCanGoBack = false;
        var parentFrame = view_common_1.getAncestor(top, "Frame");
        while (parentFrame && !parentFrameCanGoBack) {
            if (parentFrame && parentFrame.canGoBack()) {
                parentFrameCanGoBack = true;
            }
            else {
                parentFrame = view_common_1.getAncestor(parentFrame, "Frame");
            }
        }
        if (parentFrame && parentFrameCanGoBack) {
            parentFrame.goBack();
            return true;
        }
    }
    if (frame_stack_1.frameStack.length > 1) {
        top._popFromFrameStack();
    }
    return false;
}
exports.goBack = goBack;
function _stack() {
    return frame_stack_1.frameStack;
}
exports._stack = _stack;
exports.defaultPage = new view_1.Property({
    name: "defaultPage", valueChanged: function (frame, oldValue, newValue) {
        frame.navigate({ moduleName: newValue });
    }
});
exports.defaultPage.register(FrameBase);
exports.actionBarVisibilityProperty = new view_1.Property({ name: "actionBarVisibility", defaultValue: "auto", affectsLayout: view_1.isIOS });
exports.actionBarVisibilityProperty.register(FrameBase);
//# sourceMappingURL=frame-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-stack.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
exports.frameStack = [];
function topmost() {
    if (exports.frameStack.length > 0) {
        return exports.frameStack[exports.frameStack.length - 1];
    }
    return undefined;
}
exports.topmost = topmost;
function _pushInFrameStack(frame) {
    if (frame._isInFrameStack && exports.frameStack[exports.frameStack.length - 1] === frame) {
        return;
    }
    if (frame._isInFrameStack) {
        var indexOfFrame = exports.frameStack.indexOf(frame);
        exports.frameStack.splice(indexOfFrame, 1);
    }
    exports.frameStack.push(frame);
    frame._isInFrameStack = true;
}
exports._pushInFrameStack = _pushInFrameStack;
function _popFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var top = topmost();
    if (top !== frame) {
        throw new Error("Cannot pop a Frame which is not at the top of the navigation stack.");
    }
    exports.frameStack.pop();
    frame._isInFrameStack = false;
}
exports._popFromFrameStack = _popFromFrameStack;
function _removeFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var index = exports.frameStack.indexOf(frame);
    exports.frameStack.splice(index, 1);
    frame._isInFrameStack = false;
}
exports._removeFromFrameStack = _removeFromFrameStack;
//# sourceMappingURL=frame-stack.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var fragment_transitions_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.transitions.js");
var utils = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js"));
var majorVersion = utils.ios.MajorVersion;
var ENTRY = "_entry";
var DELEGATE = "_delegate";
var NAV_DEPTH = "_navDepth";
var TRANSITION = "_transition";
var NON_ANIMATED_TRANSITION = "non-animated";
var HMR_REPLACE_TRANSITION = "fade";
var navDepth = -1;
var Frame = (function (_super) {
    __extends(Frame, _super);
    function Frame() {
        var _this = _super.call(this) || this;
        _this._animatedDelegate = UINavigationControllerAnimatedDelegate.new();
        _this._ios = new iOSFrame(_this);
        _this.viewController = _this._ios.controller;
        return _this;
    }
    Frame.prototype.createNativeView = function () {
        return this.viewController.view;
    };
    Frame.prototype.disposeNativeView = function () {
        this._removeFromFrameStack();
        this.viewController = null;
        this._ios.controller = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Frame.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype.setCurrent = function (entry, navigationType) {
        var current = this._currentEntry;
        var currentEntryChanged = current !== entry;
        if (currentEntryChanged) {
            this._updateBackstack(entry, navigationType);
            _super.prototype.setCurrent.call(this, entry, navigationType);
        }
    };
    Frame.prototype._navigateCore = function (backstackEntry) {
        _super.prototype._navigateCore.call(this, backstackEntry);
        var viewController = backstackEntry.resolvedPage.ios;
        if (!viewController) {
            throw new Error("Required page does not have a viewController created.");
        }
        var clearHistory = backstackEntry.entry.clearHistory;
        if (clearHistory) {
            navDepth = -1;
        }
        var isReplace = this._executingContext && this._executingContext.navigationType === frame_common_1.NavigationType.replace;
        if (!isReplace) {
            navDepth++;
        }
        var navigationTransition;
        var animated = this.currentPage ? this._getIsAnimatedNavigation(backstackEntry.entry) : false;
        if (isReplace) {
            animated = true;
            navigationTransition = { name: HMR_REPLACE_TRANSITION, duration: 100 };
            viewController[TRANSITION] = navigationTransition;
        }
        else if (animated) {
            navigationTransition = this._getNavigationTransition(backstackEntry.entry);
            if (navigationTransition) {
                viewController[TRANSITION] = navigationTransition;
            }
        }
        else {
            viewController[TRANSITION] = { name: NON_ANIMATED_TRANSITION };
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!nativeTransition && navigationTransition) {
            this._ios.controller.delegate = this._animatedDelegate;
            viewController[DELEGATE] = this._animatedDelegate;
        }
        else {
            viewController[DELEGATE] = null;
            this._ios.controller.delegate = null;
        }
        backstackEntry[NAV_DEPTH] = navDepth;
        viewController[ENTRY] = backstackEntry;
        if (!animated && majorVersion > 10) {
            var barButtonItem = UIBarButtonItem.alloc().initWithTitleStyleTargetAction("", 0, null, null);
            viewController.navigationItem.backBarButtonItem = barButtonItem;
        }
        if (!this._currentEntry) {
            this._updateActionBar(backstackEntry.resolvedPage, true);
            this._ios.controller.pushViewControllerAnimated(viewController, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".pushViewControllerAnimated(" + viewController + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        if (clearHistory) {
            viewController.navigationItem.hidesBackButton = true;
            var newControllers = NSMutableArray.alloc().initWithCapacity(1);
            newControllers.addObject(viewController);
            var oldControllers = this._ios.controller.viewControllers;
            for (var i = 0; i < oldControllers.count; i++) {
                oldControllers.objectAtIndex(i).isBackstackCleared = true;
            }
            this._ios.controller.setViewControllersAnimated(newControllers, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".setViewControllersAnimated([" + viewController + "], " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        if (!Frame._isEntryBackstackVisible(this._currentEntry) || isReplace) {
            var newControllers = NSMutableArray.alloc().initWithArray(this._ios.controller.viewControllers);
            if (newControllers.count === 0) {
                throw new Error("Wrong controllers count.");
            }
            viewController.navigationItem.hidesBackButton = this.backStack.length === 0;
            var skippedNavController = newControllers.lastObject;
            skippedNavController.isBackstackSkipped = true;
            newControllers.removeLastObject();
            newControllers.addObject(viewController);
            this._ios.controller.setViewControllersAnimated(newControllers, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".setViewControllersAnimated([originalControllers - lastController + " + viewController + "], " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        this._ios.controller.pushViewControllerAnimated(viewController, animated);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(this + ".pushViewControllerAnimated(" + viewController + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
        }
    };
    Frame.prototype._goBackCore = function (backstackEntry) {
        _super.prototype._goBackCore.call(this, backstackEntry);
        navDepth = backstackEntry[NAV_DEPTH];
        var controller = backstackEntry.resolvedPage.ios;
        var animated = this._currentEntry ? this._getIsAnimatedNavigation(this._currentEntry.entry) : false;
        this._updateActionBar(backstackEntry.resolvedPage);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(this + ".popToViewControllerAnimated(" + controller + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
        }
        this._ios.controller.popToViewControllerAnimated(controller, animated);
    };
    Frame.prototype._updateActionBar = function (page, disableNavBarAnimation) {
        if (disableNavBarAnimation === void 0) { disableNavBarAnimation = false; }
        _super.prototype._updateActionBar.call(this, page);
        if (page && this.currentPage && this.currentPage.modal === page) {
            return;
        }
        page = page || this.currentPage;
        var newValue = this._getNavBarVisible(page);
        var disableNavBarAnimationCache = this._ios._disableNavBarAnimation;
        if (disableNavBarAnimation) {
            this._ios._disableNavBarAnimation = true;
        }
        this._ios.showNavigationBar = newValue;
        if (disableNavBarAnimation) {
            this._ios._disableNavBarAnimation = disableNavBarAnimationCache;
        }
        if (this._ios.controller.navigationBar) {
            this._ios.controller.navigationBar.userInteractionEnabled = this.navigationQueueIsEmpty();
        }
    };
    Frame.prototype._getNavBarVisible = function (page) {
        switch (this.actionBarVisibility) {
            case "always":
                return true;
            case "never":
                return false;
            case "auto":
                switch (this._ios.navBarVisibility) {
                    case "always":
                        return true;
                    case "never":
                        return false;
                    case "auto":
                        var newValue = void 0;
                        if (page && page.actionBarHidden !== undefined) {
                            newValue = !page.actionBarHidden;
                        }
                        else {
                            newValue = this.ios.controller.viewControllers.count > 1 || (page && page.actionBar && !page.actionBar._isEmpty());
                        }
                        newValue = !!newValue;
                        return newValue;
                }
        }
    };
    Object.defineProperty(Frame, "defaultAnimatedNavigation", {
        get: function () {
            return frame_common_1.FrameBase.defaultAnimatedNavigation;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultAnimatedNavigation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame, "defaultTransition", {
        get: function () {
            return frame_common_1.FrameBase.defaultTransition;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultTransition = value;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = frame_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = frame_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = frame_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = frame_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = frame_common_1.View.resolveSizeAndState(width, width, widthMode, 0);
        var heightAndState = frame_common_1.View.resolveSizeAndState(height, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Frame.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    Frame.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    Frame.prototype._onNavigatingTo = function (backstackEntry, isBack) {
    };
    __decorate([
        profiling_1.profile
    ], Frame.prototype, "_navigateCore", null);
    return Frame;
}(frame_common_1.FrameBase));
exports.Frame = Frame;
var transitionDelegates = new Array();
var TransitionDelegate = (function (_super) {
    __extends(TransitionDelegate, _super);
    function TransitionDelegate() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TransitionDelegate.initWithOwnerId = function (id) {
        var delegate = TransitionDelegate.new();
        delegate._id = id;
        transitionDelegates.push(delegate);
        return delegate;
    };
    TransitionDelegate.prototype.animationWillStart = function (animationID, context) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("START " + this._id, frame_common_1.traceCategories.Transition);
        }
    };
    TransitionDelegate.prototype.animationDidStop = function (animationID, finished, context) {
        if (finished) {
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite("END " + this._id, frame_common_1.traceCategories.Transition);
            }
        }
        else {
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite("CANCEL " + this._id, frame_common_1.traceCategories.Transition);
            }
        }
        var index = transitionDelegates.indexOf(this);
        if (index > -1) {
            transitionDelegates.splice(index, 1);
        }
    };
    TransitionDelegate.ObjCExposedMethods = {
        "animationWillStart": { returns: interop.types.void, params: [NSString, NSObject] },
        "animationDidStop": { returns: interop.types.void, params: [NSString, NSNumber, NSObject] }
    };
    return TransitionDelegate;
}(NSObject));
var _defaultTransitionDuration = 0.35;
var UINavigationControllerAnimatedDelegate = (function (_super) {
    __extends(UINavigationControllerAnimatedDelegate, _super);
    function UINavigationControllerAnimatedDelegate() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerAnimatedDelegate.prototype.navigationControllerAnimationControllerForOperationFromViewControllerToViewController = function (navigationController, operation, fromVC, toVC) {
        var viewController;
        switch (operation) {
            case 1:
                viewController = toVC;
                break;
            case 2:
                viewController = fromVC;
                break;
        }
        if (!viewController) {
            return null;
        }
        var navigationTransition = viewController[TRANSITION];
        if (!navigationTransition) {
            return null;
        }
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.navigationControllerAnimationControllerForOperationFromViewControllerToViewController(" + operation + ", " + fromVC + ", " + toVC + "), transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var curve = _getNativeCurve(navigationTransition);
        var animationController = fragment_transitions_1._createIOSAnimatedTransitioning(navigationTransition, curve, operation, fromVC, toVC);
        return animationController;
    };
    UINavigationControllerAnimatedDelegate.ObjCProtocols = [UINavigationControllerDelegate];
    return UINavigationControllerAnimatedDelegate;
}(NSObject));
var UINavigationControllerImpl = (function (_super) {
    __extends(UINavigationControllerImpl, _super);
    function UINavigationControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerImpl.initWithOwner = function (owner) {
        var controller = UINavigationControllerImpl.new();
        controller._owner = owner;
        return controller;
    };
    Object.defineProperty(UINavigationControllerImpl.prototype, "owner", {
        get: function () {
            return this._owner.get();
        },
        enumerable: true,
        configurable: true
    });
    UINavigationControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (owner && !owner.isLoaded && !owner.parent) {
            owner.callLoaded();
        }
    };
    UINavigationControllerImpl.prototype.viewDidDisappear = function (animated) {
        _super.prototype.viewDidDisappear.call(this, animated);
        var owner = this._owner.get();
        if (owner && owner.isLoaded && !owner.parent && !this.presentedViewController) {
            owner.callUnloaded();
            owner._tearDownUI(true);
        }
    };
    UINavigationControllerImpl.prototype.animateWithDuration = function (navigationTransition, nativeTransition, transitionType, baseCallback) {
        var _this = this;
        var duration = navigationTransition.duration ? navigationTransition.duration / 1000 : _defaultTransitionDuration;
        var curve = _getNativeCurve(navigationTransition);
        var transitionTraced = frame_common_1.isCategorySet(frame_common_1.traceCategories.Transition);
        var transitionDelegate;
        if (transitionTraced) {
            var id = _getTransitionId(nativeTransition, transitionType);
            transitionDelegate = TransitionDelegate.initWithOwnerId(id);
        }
        UIView.animateWithDurationAnimations(duration, function () {
            if (transitionTraced) {
                UIView.setAnimationDelegate(transitionDelegate);
            }
            UIView.setAnimationWillStartSelector("animationWillStart");
            UIView.setAnimationDidStopSelector("animationDidStop");
            UIView.setAnimationCurve(curve);
            baseCallback();
            UIView.setAnimationTransitionForViewCache(nativeTransition, _this.view, true);
        });
    };
    UINavigationControllerImpl.prototype.pushViewControllerAnimated = function (viewController, animated) {
        var _this = this;
        var navigationTransition = viewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.pushViewControllerAnimated(" + viewController + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!animated || !navigationTransition || !nativeTransition) {
            _super.prototype.pushViewControllerAnimated.call(this, viewController, animated);
            return;
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "push", function () {
            _super.prototype.pushViewControllerAnimated.call(_this, viewController, false);
        });
    };
    UINavigationControllerImpl.prototype.setViewControllersAnimated = function (viewControllers, animated) {
        var _this = this;
        var viewController = viewControllers.lastObject;
        var navigationTransition = viewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.setViewControllersAnimated(" + viewControllers + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!animated || !navigationTransition || !nativeTransition) {
            _super.prototype.setViewControllersAnimated.call(this, viewControllers, animated);
            return;
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "set", function () {
            _super.prototype.setViewControllersAnimated.call(_this, viewControllers, false);
        });
    };
    UINavigationControllerImpl.prototype.popViewControllerAnimated = function (animated) {
        var _this = this;
        var lastViewController = this.viewControllers.lastObject;
        var navigationTransition = lastViewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.popViewControllerAnimated(" + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        if (navigationTransition && navigationTransition.name === NON_ANIMATED_TRANSITION) {
            return _super.prototype.popViewControllerAnimated.call(this, false);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, false);
        if (!animated || !navigationTransition || !nativeTransition) {
            return _super.prototype.popViewControllerAnimated.call(this, animated);
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "pop", function () {
            _super.prototype.popViewControllerAnimated.call(_this, false);
        });
        return null;
    };
    UINavigationControllerImpl.prototype.popToViewControllerAnimated = function (viewController, animated) {
        var _this = this;
        var lastViewController = this.viewControllers.lastObject;
        var navigationTransition = lastViewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.popToViewControllerAnimated(" + viewController + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        if (navigationTransition && navigationTransition.name === NON_ANIMATED_TRANSITION) {
            return _super.prototype.popToViewControllerAnimated.call(this, viewController, false);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, false);
        if (!animated || !navigationTransition || !nativeTransition) {
            return _super.prototype.popToViewControllerAnimated.call(this, viewController, animated);
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "popTo", function () {
            _super.prototype.popToViewControllerAnimated.call(_this, viewController, false);
        });
        return null;
    };
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "viewWillAppear", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "viewDidDisappear", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "pushViewControllerAnimated", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "setViewControllersAnimated", null);
    return UINavigationControllerImpl;
}(UINavigationController));
function _getTransitionId(nativeTransition, transitionType) {
    var name;
    switch (nativeTransition) {
        case 4:
            name = "CurlDown";
            break;
        case 3:
            name = "CurlUp";
            break;
        case 1:
            name = "FlipFromLeft";
            break;
        case 2:
            name = "FlipFromRight";
            break;
        case 0:
            name = "None";
            break;
    }
    return name + " " + transitionType;
}
function _getNativeTransition(navigationTransition, push) {
    if (navigationTransition && navigationTransition.name) {
        switch (navigationTransition.name.toLowerCase()) {
            case "flip":
            case "flipright":
                return push ? 2 : 1;
            case "flipleft":
                return push ? 1 : 2;
            case "curl":
            case "curlup":
                return push ? 3 : 4;
            case "curldown":
                return push ? 4 : 3;
        }
    }
    return null;
}
function _getNativeCurve(transition) {
    if (transition.curve) {
        switch (transition.curve) {
            case "easeIn":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseIn.", frame_common_1.traceCategories.Transition);
                }
                return 1;
            case "easeOut":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseOut.", frame_common_1.traceCategories.Transition);
                }
                return 2;
            case "easeInOut":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseInOut.", frame_common_1.traceCategories.Transition);
                }
                return 0;
            case "linear":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.Linear.", frame_common_1.traceCategories.Transition);
                }
                return 3;
            default:
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to original: " + transition.curve, frame_common_1.traceCategories.Transition);
                }
                return transition.curve;
        }
    }
    return 0;
}
exports._getNativeCurve = _getNativeCurve;
var iOSFrame = (function () {
    function iOSFrame(frame) {
        this._navBarVisibility = "auto";
        this._controller = UINavigationControllerImpl.initWithOwner(new WeakRef(frame));
    }
    Object.defineProperty(iOSFrame.prototype, "controller", {
        get: function () {
            return this._controller;
        },
        set: function (value) {
            this._controller = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(iOSFrame.prototype, "showNavigationBar", {
        get: function () {
            return this._showNavigationBar;
        },
        set: function (value) {
            this._showNavigationBar = value;
            this._controller.setNavigationBarHiddenAnimated(!value, !this._disableNavBarAnimation);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(iOSFrame.prototype, "navBarVisibility", {
        get: function () {
            return this._navBarVisibility;
        },
        set: function (value) {
            this._navBarVisibility = value;
        },
        enumerable: true,
        configurable: true
    });
    return iOSFrame;
}());
//# sourceMappingURL=frame.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures-common.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var GestureTypes;
(function (GestureTypes) {
    GestureTypes[GestureTypes["tap"] = 1] = "tap";
    GestureTypes[GestureTypes["doubleTap"] = 2] = "doubleTap";
    GestureTypes[GestureTypes["pinch"] = 4] = "pinch";
    GestureTypes[GestureTypes["pan"] = 8] = "pan";
    GestureTypes[GestureTypes["swipe"] = 16] = "swipe";
    GestureTypes[GestureTypes["rotation"] = 32] = "rotation";
    GestureTypes[GestureTypes["longPress"] = 64] = "longPress";
    GestureTypes[GestureTypes["touch"] = 128] = "touch";
})(GestureTypes = exports.GestureTypes || (exports.GestureTypes = {}));
var GestureStateTypes;
(function (GestureStateTypes) {
    GestureStateTypes[GestureStateTypes["cancelled"] = 0] = "cancelled";
    GestureStateTypes[GestureStateTypes["began"] = 1] = "began";
    GestureStateTypes[GestureStateTypes["changed"] = 2] = "changed";
    GestureStateTypes[GestureStateTypes["ended"] = 3] = "ended";
})(GestureStateTypes = exports.GestureStateTypes || (exports.GestureStateTypes = {}));
var SwipeDirection;
(function (SwipeDirection) {
    SwipeDirection[SwipeDirection["right"] = 1] = "right";
    SwipeDirection[SwipeDirection["left"] = 2] = "left";
    SwipeDirection[SwipeDirection["up"] = 4] = "up";
    SwipeDirection[SwipeDirection["down"] = 8] = "down";
})(SwipeDirection = exports.SwipeDirection || (exports.SwipeDirection = {}));
var TouchAction;
(function (TouchAction) {
    TouchAction.down = "down";
    TouchAction.up = "up";
    TouchAction.move = "move";
    TouchAction.cancel = "cancel";
})(TouchAction = exports.TouchAction || (exports.TouchAction = {}));
function toString(type, separator) {
    var types = new Array();
    if (type & GestureTypes.tap) {
        types.push("tap");
    }
    if (type & GestureTypes.doubleTap) {
        types.push("doubleTap");
    }
    if (type & GestureTypes.pinch) {
        types.push("pinch");
    }
    if (type & GestureTypes.pan) {
        types.push("pan");
    }
    if (type & GestureTypes.swipe) {
        types.push("swipe");
    }
    if (type & GestureTypes.rotation) {
        types.push("rotation");
    }
    if (type & GestureTypes.longPress) {
        types.push("longPress");
    }
    if (type & GestureTypes.touch) {
        types.push("touch");
    }
    return types.join(separator);
}
exports.toString = toString;
function fromString(type) {
    var t = type.trim().toLowerCase();
    if (t === "tap") {
        return GestureTypes.tap;
    }
    else if (t === "doubletap") {
        return GestureTypes.doubleTap;
    }
    else if (t === "pinch") {
        return GestureTypes.pinch;
    }
    else if (t === "pan") {
        return GestureTypes.pan;
    }
    else if (t === "swipe") {
        return GestureTypes.swipe;
    }
    else if (t === "rotation") {
        return GestureTypes.rotation;
    }
    else if (t === "longpress") {
        return GestureTypes.longPress;
    }
    else if (t === "touch") {
        return GestureTypes.touch;
    }
    return undefined;
}
exports.fromString = fromString;
var GesturesObserverBase = (function () {
    function GesturesObserverBase(target, callback, context) {
        this._target = target;
        this._callback = callback;
        this._context = context;
    }
    Object.defineProperty(GesturesObserverBase.prototype, "callback", {
        get: function () {
            return this._callback;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "target", {
        get: function () {
            return this._target;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "context", {
        get: function () {
            return this._context;
        },
        enumerable: true,
        configurable: true
    });
    GesturesObserverBase.prototype.disconnect = function () {
        if (this.target) {
            var list = this.target.getGestureObservers(this.type);
            if (list && list.length > 0) {
                for (var i = 0; i < list.length; i++) {
                    if (list[i].callback === this.callback) {
                        break;
                    }
                }
                list.length = 0;
                this.target._gestureObservers[this.type] = undefined;
                delete this.target._gestureObservers[this.type];
            }
        }
        this._target = null;
        this._callback = null;
        this._context = null;
    };
    return GesturesObserverBase;
}());
exports.GesturesObserverBase = GesturesObserverBase;
//# sourceMappingURL=gestures-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var gestures_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js"));
function observe(target, type, callback, context) {
    var observer = new GesturesObserver(target, callback, context);
    observer.observe(type);
    return observer;
}
exports.observe = observe;
var UIGestureRecognizerDelegateImpl = (function (_super) {
    __extends(UIGestureRecognizerDelegateImpl, _super);
    function UIGestureRecognizerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIGestureRecognizerDelegateImpl.prototype.gestureRecognizerShouldRecognizeSimultaneouslyWithGestureRecognizer = function (gestureRecognizer, otherGestureRecognizer) {
        return true;
    };
    UIGestureRecognizerDelegateImpl.prototype.gestureRecognizerShouldRequireFailureOfGestureRecognizer = function (gestureRecognizer, otherGestureRecognizer) {
        if (gestureRecognizer instanceof UITapGestureRecognizer
            && otherGestureRecognizer instanceof UITapGestureRecognizer
            && otherGestureRecognizer.numberOfTapsRequired === 2) {
            return true;
        }
        return false;
    };
    UIGestureRecognizerDelegateImpl.ObjCProtocols = [UIGestureRecognizerDelegate];
    return UIGestureRecognizerDelegateImpl;
}(NSObject));
var recognizerDelegateInstance = UIGestureRecognizerDelegateImpl.new();
var UIGestureRecognizerImpl = (function (_super) {
    __extends(UIGestureRecognizerImpl, _super);
    function UIGestureRecognizerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIGestureRecognizerImpl.initWithOwnerTypeCallback = function (owner, type, callback, thisArg) {
        var handler = UIGestureRecognizerImpl.new();
        handler._owner = owner;
        handler._type = type;
        if (callback) {
            handler._callback = callback;
        }
        if (thisArg) {
            handler._context = thisArg;
        }
        return handler;
    };
    UIGestureRecognizerImpl.prototype.recognize = function (recognizer) {
        var owner = this._owner.get();
        var callback = this._callback ? this._callback : (owner ? owner.callback : null);
        var typeParam = this._type;
        var target = owner ? owner.target : undefined;
        var args = {
            type: typeParam,
            view: target,
            ios: recognizer,
            android: undefined,
            object: target,
            eventName: gestures_common_1.toString(typeParam),
        };
        if (callback) {
            callback.call(this._context, args);
        }
    };
    UIGestureRecognizerImpl.ObjCExposedMethods = {
        "recognize": { returns: interop.types.void, params: [UIGestureRecognizer] }
    };
    return UIGestureRecognizerImpl;
}(NSObject));
var GesturesObserver = (function (_super) {
    __extends(GesturesObserver, _super);
    function GesturesObserver(target, callback, context) {
        var _this = _super.call(this, target, callback, context) || this;
        _this._recognizers = {};
        return _this;
    }
    GesturesObserver.prototype.androidOnTouchEvent = function (motionEvent) {
    };
    GesturesObserver.prototype.observe = function (type) {
        var _this = this;
        if (this.target) {
            this.type = type;
            this._onTargetLoaded = function (args) {
                _this._attach(_this.target, type);
            };
            this._onTargetUnloaded = function (args) {
                _this._detach();
            };
            this.target.on("loaded", this._onTargetLoaded);
            this.target.on("unloaded", this._onTargetUnloaded);
            if (this.target.isLoaded) {
                this._attach(this.target, type);
            }
        }
    };
    GesturesObserver.prototype._attach = function (target, type) {
        var _this = this;
        this._detach();
        if (target && target.nativeViewProtected && target.nativeViewProtected.addGestureRecognizer) {
            var nativeView = target.nativeViewProtected;
            if (type & gestures_common_1.GestureTypes.tap) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.tap));
            }
            if (type & gestures_common_1.GestureTypes.doubleTap) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.doubleTap));
            }
            if (type & gestures_common_1.GestureTypes.pinch) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.pinch, function (args) {
                    _this._executeCallback(_getPinchData(args));
                }));
            }
            if (type & gestures_common_1.GestureTypes.pan) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.pan, function (args) {
                    _this._executeCallback(_getPanData(args, target.nativeViewProtected));
                }));
            }
            if (type & gestures_common_1.GestureTypes.swipe) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 8));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 2));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 1));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 4));
            }
            if (type & gestures_common_1.GestureTypes.rotation) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.rotation, function (args) {
                    _this._executeCallback(_getRotationData(args));
                }));
            }
            if (type & gestures_common_1.GestureTypes.longPress) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.longPress));
            }
            if (type & gestures_common_1.GestureTypes.touch) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.touch));
            }
        }
    };
    GesturesObserver.prototype._detach = function () {
        if (this.target && this.target.nativeViewProtected) {
            for (var name_1 in this._recognizers) {
                if (this._recognizers.hasOwnProperty(name_1)) {
                    var item = this._recognizers[name_1];
                    this.target.nativeViewProtected.removeGestureRecognizer(item.recognizer);
                    item.recognizer = null;
                    item.target = null;
                }
            }
            this._recognizers = {};
        }
    };
    GesturesObserver.prototype.disconnect = function () {
        this._detach();
        if (this.target) {
            this.target.off("loaded", this._onTargetLoaded);
            this.target.off("unloaded", this._onTargetUnloaded);
            this._onTargetLoaded = null;
            this._onTargetUnloaded = null;
        }
        _super.prototype.disconnect.call(this);
    };
    GesturesObserver.prototype._executeCallback = function (args) {
        if (this.callback) {
            this.callback.call(this.context, args);
        }
    };
    GesturesObserver.prototype._createRecognizer = function (type, callback, swipeDirection) {
        var recognizer;
        var name = gestures_common_1.toString(type);
        var target = _createUIGestureRecognizerTarget(this, type, callback, this.context);
        var recognizerType = _getUIGestureRecognizerType(type);
        if (recognizerType) {
            recognizer = recognizerType.alloc().initWithTargetAction(target, "recognize");
            if (type === gestures_common_1.GestureTypes.swipe && swipeDirection) {
                name = name + swipeDirection.toString();
                recognizer.direction = swipeDirection;
            }
            else if (type === gestures_common_1.GestureTypes.touch) {
                recognizer.observer = this;
            }
            else if (type === gestures_common_1.GestureTypes.doubleTap) {
                recognizer.numberOfTapsRequired = 2;
            }
            if (recognizer) {
                recognizer.delegate = recognizerDelegateInstance;
                this._recognizers[name] = { recognizer: recognizer, target: target };
            }
        }
        return recognizer;
    };
    return GesturesObserver;
}(gestures_common_1.GesturesObserverBase));
exports.GesturesObserver = GesturesObserver;
function _createUIGestureRecognizerTarget(owner, type, callback, context) {
    return UIGestureRecognizerImpl.initWithOwnerTypeCallback(new WeakRef(owner), type, callback, context);
}
function _getUIGestureRecognizerType(type) {
    var nativeType = null;
    if (type === gestures_common_1.GestureTypes.tap) {
        nativeType = UITapGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.doubleTap) {
        nativeType = UITapGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.pinch) {
        nativeType = UIPinchGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.pan) {
        nativeType = UIPanGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.swipe) {
        nativeType = UISwipeGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.rotation) {
        nativeType = UIRotationGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.longPress) {
        nativeType = UILongPressGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.touch) {
        nativeType = TouchGestureRecognizer;
    }
    return nativeType;
}
function getState(recognizer) {
    if (recognizer.state === 1) {
        return gestures_common_1.GestureStateTypes.began;
    }
    else if (recognizer.state === 4) {
        return gestures_common_1.GestureStateTypes.cancelled;
    }
    else if (recognizer.state === 2) {
        return gestures_common_1.GestureStateTypes.changed;
    }
    else if (recognizer.state === 3) {
        return gestures_common_1.GestureStateTypes.ended;
    }
}
function _getSwipeDirection(direction) {
    if (direction === 8) {
        return gestures_common_1.SwipeDirection.down;
    }
    else if (direction === 2) {
        return gestures_common_1.SwipeDirection.left;
    }
    else if (direction === 1) {
        return gestures_common_1.SwipeDirection.right;
    }
    else if (direction === 4) {
        return gestures_common_1.SwipeDirection.up;
    }
}
function _getPinchData(args) {
    var recognizer = args.ios;
    var center = recognizer.locationInView(args.view.nativeViewProtected);
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        scale: recognizer.scale,
        getFocusX: function () { return center.x; },
        getFocusY: function () { return center.y; },
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
function _getSwipeData(args) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        direction: _getSwipeDirection(recognizer.direction),
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
    };
}
function _getPanData(args, view) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        deltaX: recognizer.translationInView(view).x,
        deltaY: recognizer.translationInView(view).y,
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
function _getRotationData(args) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        rotation: recognizer.rotation * (180.0 / Math.PI),
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
var TouchGestureRecognizer = (function (_super) {
    __extends(TouchGestureRecognizer, _super);
    function TouchGestureRecognizer() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TouchGestureRecognizer.prototype.touchesBeganWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.down, touches, event);
        if (this.view) {
            this.view.touchesBeganWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesMovedWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.move, touches, event);
        if (this.view) {
            this.view.touchesMovedWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesEndedWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.up, touches, event);
        if (this.view) {
            this.view.touchesEndedWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesCancelledWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.cancel, touches, event);
        if (this.view) {
            this.view.touchesCancelledWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.executeCallback = function (action, touches, event) {
        if (!this._eventData) {
            this._eventData = new TouchGestureEventData();
        }
        this._eventData.prepare(this.observer.target, action, touches, event);
        this.observer._executeCallback(this._eventData);
    };
    return TouchGestureRecognizer;
}(UIGestureRecognizer));
var Pointer = (function () {
    function Pointer(touch, targetView) {
        this.android = undefined;
        this.ios = undefined;
        this.ios = touch;
        this._view = targetView;
    }
    Object.defineProperty(Pointer.prototype, "location", {
        get: function () {
            if (!this._location) {
                this._location = this.ios.locationInView(this._view.nativeViewProtected);
            }
            return this._location;
        },
        enumerable: true,
        configurable: true
    });
    Pointer.prototype.getX = function () {
        return this.location.x;
    };
    Pointer.prototype.getY = function () {
        return this.location.y;
    };
    return Pointer;
}());
var TouchGestureEventData = (function () {
    function TouchGestureEventData() {
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.touch);
        this.type = gestures_common_1.GestureTypes.touch;
        this.android = undefined;
    }
    TouchGestureEventData.prototype.prepare = function (view, action, touches, event) {
        this.action = action;
        this.view = view;
        this.object = view;
        this.ios = {
            touches: touches,
            event: event
        };
        this._mainPointer = undefined;
        this._activePointers = undefined;
        this._allPointers = undefined;
    };
    TouchGestureEventData.prototype.getPointerCount = function () {
        return this.ios.event.allTouches.count;
    };
    TouchGestureEventData.prototype.getMainPointer = function () {
        if (this._mainPointer === undefined) {
            this._mainPointer = this.ios.touches.anyObject();
        }
        return this._mainPointer;
    };
    TouchGestureEventData.prototype.getActivePointers = function () {
        if (!this._activePointers) {
            this._activePointers = [];
            for (var i = 0, nsArr = this.ios.touches.allObjects; i < nsArr.count; i++) {
                this._activePointers.push(new Pointer(nsArr.objectAtIndex(i), this.view));
            }
        }
        return this._activePointers;
    };
    TouchGestureEventData.prototype.getAllPointers = function () {
        if (!this._allPointers) {
            this._allPointers = [];
            var nsArr = this.ios.event.allTouches.allObjects;
            for (var i = 0; i < nsArr.count; i++) {
                this._allPointers.push(new Pointer(nsArr.objectAtIndex(i), this.view));
            }
        }
        return this._allPointers;
    };
    TouchGestureEventData.prototype.getX = function () {
        return this.getMainPointer().locationInView(this.view.nativeViewProtected).x;
    };
    TouchGestureEventData.prototype.getY = function () {
        return this.getMainPointer().locationInView(this.view.nativeViewProtected).y;
    };
    return TouchGestureEventData;
}());
//# sourceMappingURL=gestures.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var HtmlViewBase = (function (_super) {
    __extends(HtmlViewBase, _super);
    function HtmlViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlViewBase = __decorate([
        view_1.CSSType("HtmlView")
    ], HtmlViewBase);
    return HtmlViewBase;
}(view_1.View));
exports.HtmlViewBase = HtmlViewBase;
HtmlViewBase.prototype.recycleNativeView = "auto";
exports.htmlProperty = new view_1.Property({ name: "html", defaultValue: "", affectsLayout: true });
exports.htmlProperty.register(HtmlViewBase);
//# sourceMappingURL=html-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/html-view/html-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var html_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/html-view/html-view-common.js"));
var HtmlView = (function (_super) {
    __extends(HtmlView, _super);
    function HtmlView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlView.prototype.createNativeView = function () {
        var view = UITextView.new();
        view.scrollEnabled = false;
        view.editable = false;
        view.selectable = true;
        view.userInteractionEnabled = true;
        view.dataDetectorTypes = -1;
        return view;
    };
    Object.defineProperty(HtmlView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    HtmlView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            var width = html_view_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
            var widthMode = html_view_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
            var height = html_view_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
            var heightMode = html_view_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
            var desiredSize = html_view_common_1.layout.measureNativeView(nativeView, width, widthMode, height, heightMode);
            var labelWidth = widthMode === html_view_common_1.layout.AT_MOST ? Math.min(desiredSize.width, width) : desiredSize.width;
            var measureWidth = Math.max(labelWidth, this.effectiveMinWidth);
            var measureHeight = Math.max(desiredSize.height, this.effectiveMinHeight);
            var widthAndState = html_view_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
            var heightAndState = html_view_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
            this.setMeasuredDimension(widthAndState, heightAndState);
        }
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.getDefault] = function () {
        return "";
    };
    HtmlView.prototype[html_view_common_1.htmlProperty.setNative] = function (value) {
        var _a;
        var htmlString = NSString.stringWithString(value + "");
        var nsData = htmlString.dataUsingEncoding(NSUnicodeStringEncoding);
        this.nativeViewProtected.attributedText = NSAttributedString.alloc().initWithDataOptionsDocumentAttributesError(nsData, (_a = {}, _a[NSDocumentTypeDocumentAttribute] = NSHTMLTextDocumentType, _a), null);
    };
    return HtmlView;
}(html_view_common_1.HtmlViewBase));
exports.HtmlView = HtmlView;
//# sourceMappingURL=html-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var image_asset_1 = __webpack_require__("../node_modules/tns-core-modules/image-asset/image-asset.js");
exports.ImageAsset = image_asset_1.ImageAsset;
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
exports.ImageSource = image_source_1.ImageSource;
exports.fromAsset = image_source_1.fromAsset;
exports.fromNativeSource = image_source_1.fromNativeSource;
exports.fromUrl = image_source_1.fromUrl;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isDataURI = utils_1.isDataURI;
exports.isFontIconURI = utils_1.isFontIconURI;
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
exports.RESOURCE_PREFIX = utils_1.RESOURCE_PREFIX;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ImageBase = (function (_super) {
    __extends(ImageBase, _super);
    function ImageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ImageBase.prototype, "tintColor", {
        get: function () {
            return this.style.tintColor;
        },
        set: function (value) {
            this.style.tintColor = value;
        },
        enumerable: true,
        configurable: true
    });
    ImageBase.prototype._createImageSourceFromSrc = function (value) {
        var _this = this;
        var originalValue = value;
        var sync = this.loadMode === "sync";
        if (typeof value === "string" || value instanceof String) {
            value = value.trim();
            this.imageSource = null;
            this["_url"] = value;
            this.isLoading = true;
            var source_1 = new image_source_1.ImageSource();
            var imageLoaded = function () {
                var currentValue = _this.src;
                if (currentValue !== originalValue) {
                    return;
                }
                _this.imageSource = source_1;
                _this.isLoading = false;
            };
            if (utils_1.isFontIconURI(value)) {
                var fontIconCode = value.split("//")[1];
                if (fontIconCode !== undefined) {
                    var font = this.style.fontInternal;
                    var color = this.style.color;
                    source_1.loadFromFontIconCode(fontIconCode, font, color);
                    imageLoaded();
                }
            }
            else if (utils_1.isDataURI(value)) {
                var base64Data = value.split(",")[1];
                if (base64Data !== undefined) {
                    if (sync) {
                        source_1.loadFromBase64(base64Data);
                        imageLoaded();
                    }
                    else {
                        source_1.fromBase64(base64Data).then(imageLoaded);
                    }
                }
            }
            else if (utils_1.isFileOrResourcePath(value)) {
                if (value.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
                    var resPath = value.substr(utils_1.RESOURCE_PREFIX.length);
                    if (sync) {
                        source_1.loadFromResource(resPath);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromResource(resPath).then(imageLoaded);
                    }
                }
                else {
                    if (sync) {
                        source_1.loadFromFile(value);
                        imageLoaded();
                    }
                    else {
                        this.imageSource = null;
                        source_1.fromFile(value).then(imageLoaded);
                    }
                }
            }
            else {
                this.imageSource = null;
                image_source_1.fromUrl(value).then(function (r) {
                    if (_this["_url"] === value) {
                        _this.imageSource = r;
                        _this.isLoading = false;
                    }
                }, function (err) {
                    _this.isLoading = false;
                    if (view_1.traceEnabled()) {
                        if (typeof err === "object" && err.message) {
                            err = err.message;
                        }
                        view_1.traceWrite(err, view_1.traceCategories.Debug);
                    }
                });
            }
        }
        else if (value instanceof image_source_1.ImageSource) {
            this.imageSource = value;
            this.isLoading = false;
        }
        else if (value instanceof image_asset_1.ImageAsset) {
            image_source_1.fromAsset(value).then(function (result) {
                _this.imageSource = result;
                _this.isLoading = false;
            });
        }
        else {
            this.imageSource = image_source_1.fromNativeSource(value);
            this.isLoading = false;
        }
    };
    ImageBase = __decorate([
        view_1.CSSType("Image")
    ], ImageBase);
    return ImageBase;
}(view_1.View));
exports.ImageBase = ImageBase;
ImageBase.prototype.recycleNativeView = "auto";
exports.imageSourceProperty = new view_1.Property({ name: "imageSource" });
exports.imageSourceProperty.register(ImageBase);
exports.srcProperty = new view_1.Property({ name: "src" });
exports.srcProperty.register(ImageBase);
exports.loadModeProperty = new view_1.Property({ name: "loadMode", defaultValue: "sync" });
exports.loadModeProperty.register(ImageBase);
exports.isLoadingProperty = new view_1.Property({ name: "isLoading", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isLoadingProperty.register(ImageBase);
exports.stretchProperty = new view_1.Property({ name: "stretch", defaultValue: "aspectFit", affectsLayout: view_1.isIOS });
exports.stretchProperty.register(ImageBase);
exports.tintColorProperty = new view_1.InheritedCssProperty({ name: "tintColor", cssName: "tint-color", equalityComparer: view_1.Color.equals, valueConverter: function (value) { return new view_1.Color(value); } });
exports.tintColorProperty.register(view_1.Style);
exports.decodeHeightProperty = new view_1.Property({ name: "decodeHeight", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeHeightProperty.register(ImageBase);
exports.decodeWidthProperty = new view_1.Property({ name: "decodeWidth", defaultValue: { value: 0, unit: "dip" }, valueConverter: view_1.Length.parse });
exports.decodeWidthProperty.register(ImageBase);
//# sourceMappingURL=image-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/image/image.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var image_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/image/image-common.js"));
var Image = (function (_super) {
    __extends(Image, _super);
    function Image() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._imageSourceAffectsLayout = true;
        return _this;
    }
    Image.prototype.createNativeView = function () {
        var imageView = UIImageView.new();
        imageView.contentMode = 1;
        imageView.userInteractionEnabled = true;
        return imageView;
    };
    Image.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._setNativeClipToBounds();
    };
    Image.prototype.setTintColor = function (value) {
        if (value && this.nativeViewProtected.image && !this._templateImageWasCreated) {
            this.nativeViewProtected.image = this.nativeViewProtected.image.imageWithRenderingMode(2);
            this._templateImageWasCreated = true;
        }
        else if (!value && this.nativeViewProtected.image && this._templateImageWasCreated) {
            this._templateImageWasCreated = false;
            this.nativeViewProtected.image = this.nativeViewProtected.image.imageWithRenderingMode(0);
        }
        this.nativeViewProtected.tintColor = value ? value.ios : null;
    };
    Image.prototype._setNativeImage = function (nativeImage) {
        this.nativeViewProtected.image = nativeImage;
        this._templateImageWasCreated = false;
        this.setTintColor(this.style.tintColor);
        if (this._imageSourceAffectsLayout) {
            this.requestLayout();
        }
    };
    Image.prototype._setNativeClipToBounds = function () {
        this.nativeViewProtected.clipsToBounds = true;
    };
    Image.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = image_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = image_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = image_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = image_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var nativeWidth = this.imageSource ? image_common_1.layout.toDevicePixels(this.imageSource.width) : 0;
        var nativeHeight = this.imageSource ? image_common_1.layout.toDevicePixels(this.imageSource.height) : 0;
        var measureWidth = Math.max(nativeWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(nativeHeight, this.effectiveMinHeight);
        var finiteWidth = widthMode !== image_common_1.layout.UNSPECIFIED;
        var finiteHeight = heightMode !== image_common_1.layout.UNSPECIFIED;
        this._imageSourceAffectsLayout = widthMode !== image_common_1.layout.EXACTLY || heightMode !== image_common_1.layout.EXACTLY;
        if (nativeWidth !== 0 && nativeHeight !== 0 && (finiteWidth || finiteHeight)) {
            var scale = Image.computeScaleFactor(width, height, finiteWidth, finiteHeight, nativeWidth, nativeHeight, this.stretch);
            var resultW = Math.round(nativeWidth * scale.width);
            var resultH = Math.round(nativeHeight * scale.height);
            measureWidth = finiteWidth ? Math.min(resultW, width) : resultW;
            measureHeight = finiteHeight ? Math.min(resultH, height) : resultH;
            if (image_common_1.traceEnabled()) {
                image_common_1.traceWrite("Image stretch: " + this.stretch +
                    ", nativeWidth: " + nativeWidth +
                    ", nativeHeight: " + nativeHeight, image_common_1.traceCategories.Layout);
            }
        }
        var widthAndState = Image.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = Image.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Image.computeScaleFactor = function (measureWidth, measureHeight, widthIsFinite, heightIsFinite, nativeWidth, nativeHeight, imageStretch) {
        var scaleW = 1;
        var scaleH = 1;
        if ((imageStretch === "aspectFill" || imageStretch === "aspectFit" || imageStretch === "fill") &&
            (widthIsFinite || heightIsFinite)) {
            scaleW = (nativeWidth > 0) ? measureWidth / nativeWidth : 0;
            scaleH = (nativeHeight > 0) ? measureHeight / nativeHeight : 0;
            if (!widthIsFinite) {
                scaleW = scaleH;
            }
            else if (!heightIsFinite) {
                scaleH = scaleW;
            }
            else {
                switch (imageStretch) {
                    case "aspectFit":
                        scaleH = scaleW < scaleH ? scaleW : scaleH;
                        scaleW = scaleH;
                        break;
                    case "aspectFill":
                        scaleH = scaleW > scaleH ? scaleW : scaleH;
                        scaleW = scaleH;
                        break;
                }
            }
        }
        return { width: scaleW, height: scaleH };
    };
    Image.prototype[image_common_1.stretchProperty.setNative] = function (value) {
        switch (value) {
            case "aspectFit":
                this.nativeViewProtected.contentMode = 1;
                break;
            case "aspectFill":
                this.nativeViewProtected.contentMode = 2;
                break;
            case "fill":
                this.nativeViewProtected.contentMode = 0;
                break;
            case "none":
            default:
                this.nativeViewProtected.contentMode = 9;
                break;
        }
    };
    Image.prototype[image_common_1.tintColorProperty.setNative] = function (value) {
        this.setTintColor(value);
    };
    Image.prototype[image_common_1.imageSourceProperty.setNative] = function (value) {
        this._setNativeImage(value ? value.ios : null);
    };
    Image.prototype[image_common_1.srcProperty.setNative] = function (value) {
        this._createImageSourceFromSrc(value);
    };
    return Image;
}(image_common_1.ImageBase));
exports.Image = Image;
//# sourceMappingURL=image.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/label/label.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var background_2 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var FixedSize;
(function (FixedSize) {
    FixedSize[FixedSize["NONE"] = 0] = "NONE";
    FixedSize[FixedSize["WIDTH"] = 1] = "WIDTH";
    FixedSize[FixedSize["HEIGHT"] = 2] = "HEIGHT";
    FixedSize[FixedSize["BOTH"] = 3] = "BOTH";
})(FixedSize || (FixedSize = {}));
var Label = (function (_super) {
    __extends(Label, _super);
    function Label() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Label.prototype.createNativeView = function () {
        var view = TNSLabel.new();
        view.userInteractionEnabled = true;
        return view;
    };
    Object.defineProperty(Label.prototype, "ios", {
        get: function () {
            return this.nativeTextViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Label.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    Label.prototype._requestLayoutOnTextChanged = function () {
        if (this._fixedSize === FixedSize.BOTH) {
            return;
        }
        if (this._fixedSize === FixedSize.WIDTH && !this.textWrap && this.getMeasuredHeight() > 0) {
            return;
        }
        _super.prototype._requestLayoutOnTextChanged.call(this);
    };
    Label.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var nativeView = this.nativeTextViewProtected;
        if (nativeView) {
            var width = text_base_1.layout.getMeasureSpecSize(widthMeasureSpec);
            var widthMode = text_base_1.layout.getMeasureSpecMode(widthMeasureSpec);
            var height = text_base_1.layout.getMeasureSpecSize(heightMeasureSpec);
            var heightMode = text_base_1.layout.getMeasureSpecMode(heightMeasureSpec);
            this._fixedSize = (widthMode === text_base_1.layout.EXACTLY ? FixedSize.WIDTH : FixedSize.NONE)
                | (heightMode === text_base_1.layout.EXACTLY ? FixedSize.HEIGHT : FixedSize.NONE);
            var nativeSize = void 0;
            if (this.textWrap) {
                nativeSize = this._measureNativeView(width, widthMode, height, heightMode);
            }
            else {
                nativeSize = text_base_1.layout.measureNativeView(nativeView, width, widthMode, height, heightMode);
            }
            var labelWidth = nativeSize.width;
            if (this.textWrap && widthMode === text_base_1.layout.AT_MOST) {
                labelWidth = Math.min(labelWidth, width);
            }
            var measureWidth = Math.max(labelWidth, this.effectiveMinWidth);
            var measureHeight = Math.max(nativeSize.height, this.effectiveMinHeight);
            var widthAndState = text_base_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
            var heightAndState = text_base_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
            this.setMeasuredDimension(widthAndState, heightAndState);
        }
    };
    Label.prototype._measureNativeView = function (width, widthMode, height, heightMode) {
        var view = this.nativeTextViewProtected;
        var nativeSize = view.textRectForBoundsLimitedToNumberOfLines(CGRectMake(0, 0, widthMode === 0 ? Number.POSITIVE_INFINITY : text_base_1.layout.toDeviceIndependentPixels(width), heightMode === 0 ? Number.POSITIVE_INFINITY : text_base_1.layout.toDeviceIndependentPixels(height)), 0).size;
        nativeSize.width = text_base_1.layout.round(text_base_1.layout.toDevicePixels(nativeSize.width));
        nativeSize.height = text_base_1.layout.round(text_base_1.layout.toDevicePixels(nativeSize.height));
        return nativeSize;
    };
    Label.prototype[text_base_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "normal":
                nativeView.lineBreakMode = 0;
                nativeView.numberOfLines = 0;
                break;
            case "nowrap":
            case "initial":
                nativeView.lineBreakMode = 4;
                nativeView.numberOfLines = 1;
                break;
        }
    };
    Label.prototype._redrawNativeBackground = function (value) {
        var _this = this;
        if (value instanceof background_1.Background) {
            background_2.ios.createBackgroundUIColor(this, function (color) {
                var cgColor = color ? color.CGColor : null;
                _this.nativeTextViewProtected.layer.backgroundColor = cgColor;
            }, true);
        }
        this._setNativeClipToBounds();
    };
    Label.prototype[text_base_1.borderTopWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderTopWidth),
            right: border.right,
            bottom: border.bottom,
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderRightWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderRightWidth),
            bottom: border.bottom,
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderBottomWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: border.right,
            bottom: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderBottomWidth),
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderLeftWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: border.right,
            bottom: border.bottom,
            left: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderLeftWidth)
        };
    };
    Label.prototype[text_base_1.paddingTopProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop),
            right: padding.right,
            bottom: padding.bottom,
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingRightProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight),
            bottom: padding.bottom,
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingBottomProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: padding.right,
            bottom: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom),
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingLeftProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: padding.right,
            bottom: padding.bottom,
            left: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft)
        };
    };
    Label = __decorate([
        text_base_1.CSSType("Label")
    ], Label);
    return Label;
}(text_base_1.TextBase));
exports.Label = Label;
Label.prototype.recycleNativeView = "auto";
//# sourceMappingURL=label.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
layout_base_1.View.prototype.effectiveLeft = 0;
layout_base_1.View.prototype.effectiveTop = 0;
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var AbsoluteLayoutBase = (function (_super) {
    __extends(AbsoluteLayoutBase, _super);
    function AbsoluteLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayoutBase.getLeft = function (element) {
        return validateArgs(element).left;
    };
    AbsoluteLayoutBase.setLeft = function (element, value) {
        validateArgs(element).left = value;
    };
    AbsoluteLayoutBase.getTop = function (element) {
        return validateArgs(element).top;
    };
    AbsoluteLayoutBase.setTop = function (element, value) {
        validateArgs(element).top = value;
    };
    AbsoluteLayoutBase.prototype.onLeftChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase.prototype.onTopChanged = function (view, oldValue, newValue) {
    };
    AbsoluteLayoutBase = __decorate([
        layout_base_1.CSSType("AbsoluteLayout")
    ], AbsoluteLayoutBase);
    return AbsoluteLayoutBase;
}(layout_base_1.LayoutBase));
exports.AbsoluteLayoutBase = AbsoluteLayoutBase;
AbsoluteLayoutBase.prototype.recycleNativeView = "auto";
exports.leftProperty = new layout_base_1.Property({
    name: "left", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveLeft = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onLeftChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.leftProperty.register(layout_base_1.View);
exports.topProperty = new layout_base_1.Property({
    name: "top", defaultValue: layout_base_1.zeroLength,
    valueChanged: function (target, oldValue, newValue) {
        target.effectiveTop = layout_base_1.Length.toDevicePixels(newValue, 0);
        var layout = target.parent;
        if (layout instanceof AbsoluteLayoutBase) {
            layout.onTopChanged(target, oldValue, newValue);
        }
    }, valueConverter: function (v) { return layout_base_1.Length.parse(v); }
});
exports.topProperty.register(layout_base_1.View);
//# sourceMappingURL=absolute-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var absolute_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/absolute-layout/absolute-layout-common.js"));
var AbsoluteLayout = (function (_super) {
    __extends(AbsoluteLayout, _super);
    function AbsoluteLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AbsoluteLayout.prototype.onLeftChanged = function (view, oldValue, newValue) {
        this.requestLayout();
    };
    AbsoluteLayout.prototype.onTopChanged = function (view, oldValue, newValue) {
        this.requestLayout();
    };
    AbsoluteLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = 0;
        var measureHeight = 0;
        var width = absolute_layout_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = absolute_layout_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = absolute_layout_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = absolute_layout_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var childMeasureSpec = absolute_layout_common_1.layout.makeMeasureSpec(0, absolute_layout_common_1.layout.UNSPECIFIED);
        this.eachLayoutChild(function (child, last) {
            var childSize = absolute_layout_common_1.View.measureChild(_this, child, childMeasureSpec, childMeasureSpec);
            measureWidth = Math.max(measureWidth, child.effectiveLeft + childSize.measuredWidth);
            measureHeight = Math.max(measureHeight, child.effectiveTop + childSize.measuredHeight);
        });
        measureWidth += this.effectiveBorderLeftWidth + this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderRightWidth;
        measureHeight += this.effectiveBorderTopWidth + this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderBottomWidth;
        measureWidth = Math.max(measureWidth, this.effectiveMinWidth);
        measureHeight = Math.max(measureHeight, this.effectiveMinHeight);
        var widthAndState = absolute_layout_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = absolute_layout_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    AbsoluteLayout.prototype.onLayout = function (left, top, right, bottom) {
        var _this = this;
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        var insets = this.getSafeAreaInsets();
        this.eachLayoutChild(function (child, last) {
            var childWidth = child.getMeasuredWidth();
            var childHeight = child.getMeasuredHeight();
            var childLeft = _this.effectiveBorderLeftWidth + _this.effectivePaddingLeft + child.effectiveLeft + insets.left;
            var childTop = _this.effectiveBorderTopWidth + _this.effectivePaddingTop + child.effectiveTop + insets.top;
            var childRight = childLeft + childWidth + child.effectiveMarginLeft + child.effectiveMarginRight;
            var childBottom = childTop + childHeight + child.effectiveMarginTop + child.effectiveMarginBottom;
            absolute_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childRight, childBottom);
        });
    };
    return AbsoluteLayout;
}(absolute_layout_common_1.AbsoluteLayoutBase));
exports.AbsoluteLayout = AbsoluteLayout;
//# sourceMappingURL=absolute-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var DockLayoutBase = (function (_super) {
    __extends(DockLayoutBase, _super);
    function DockLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayoutBase.getDock = function (element) {
        return validateArgs(element).dock;
    };
    DockLayoutBase.setDock = function (element, value) {
        validateArgs(element).dock = value;
    };
    DockLayoutBase.prototype.onDockChanged = function (view, oldValue, newValue) {
    };
    DockLayoutBase = __decorate([
        layout_base_1.CSSType("DockLayout")
    ], DockLayoutBase);
    return DockLayoutBase;
}(layout_base_1.LayoutBase));
exports.DockLayoutBase = DockLayoutBase;
DockLayoutBase.prototype.recycleNativeView = "auto";
var dockConverter = layout_base_1.makeParser(layout_base_1.makeValidator("left", "top", "right", "bottom"));
exports.dockProperty = new layout_base_1.Property({
    name: "dock", defaultValue: "left", valueChanged: function (target, oldValue, newValue) {
        if (target instanceof layout_base_1.View) {
            var layout = target.parent;
            if (layout instanceof DockLayoutBase) {
                layout.onDockChanged(target, oldValue, newValue);
            }
        }
    }, valueConverter: dockConverter
});
exports.dockProperty.register(layout_base_1.View);
exports.stretchLastChildProperty = new layout_base_1.Property({
    name: "stretchLastChild", defaultValue: true, affectsLayout: layout_base_1.isIOS, valueConverter: layout_base_1.booleanConverter
});
exports.stretchLastChildProperty.register(DockLayoutBase);
//# sourceMappingURL=dock-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var dock_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/dock-layout/dock-layout-common.js"));
var DockLayout = (function (_super) {
    __extends(DockLayout, _super);
    function DockLayout() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DockLayout.prototype.onDockChanged = function (view, oldValue, newValue) {
        this.requestLayout();
    };
    DockLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = 0;
        var measureHeight = 0;
        var width = dock_layout_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = dock_layout_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = dock_layout_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = dock_layout_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalPaddingsAndMargins = this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalPaddingsAndMargins = this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var remainingWidth = widthMode === dock_layout_common_1.layout.UNSPECIFIED ? Number.MAX_VALUE : width - horizontalPaddingsAndMargins;
        var remainingHeight = heightMode === dock_layout_common_1.layout.UNSPECIFIED ? Number.MAX_VALUE : height - verticalPaddingsAndMargins;
        var tempHeight = 0;
        var tempWidth = 0;
        var childWidthMeasureSpec;
        var childHeightMeasureSpec;
        this.eachLayoutChild(function (child, last) {
            if (_this.stretchLastChild && last) {
                childWidthMeasureSpec = dock_layout_common_1.layout.makeMeasureSpec(remainingWidth, widthMode);
                childHeightMeasureSpec = dock_layout_common_1.layout.makeMeasureSpec(remainingHeight, heightMode);
            }
            else {
                childWidthMeasureSpec = dock_layout_common_1.layout.makeMeasureSpec(remainingWidth, widthMode === dock_layout_common_1.layout.EXACTLY ? dock_layout_common_1.layout.AT_MOST : widthMode);
                childHeightMeasureSpec = dock_layout_common_1.layout.makeMeasureSpec(remainingHeight, heightMode === dock_layout_common_1.layout.EXACTLY ? dock_layout_common_1.layout.AT_MOST : heightMode);
            }
            var childSize = dock_layout_common_1.View.measureChild(_this, child, childWidthMeasureSpec, childHeightMeasureSpec);
            switch (child.dock) {
                case "top":
                case "bottom":
                    remainingHeight = Math.max(0, remainingHeight - childSize.measuredHeight);
                    tempHeight += childSize.measuredHeight;
                    measureWidth = Math.max(measureWidth, tempWidth + childSize.measuredWidth);
                    measureHeight = Math.max(measureHeight, tempHeight);
                    break;
                case "left":
                case "right":
                default:
                    remainingWidth = Math.max(0, remainingWidth - childSize.measuredWidth);
                    tempWidth += childSize.measuredWidth;
                    measureWidth = Math.max(measureWidth, tempWidth);
                    measureHeight = Math.max(measureHeight, tempHeight + childSize.measuredHeight);
                    break;
            }
        });
        measureWidth += horizontalPaddingsAndMargins;
        measureHeight += verticalPaddingsAndMargins;
        measureWidth = Math.max(measureWidth, this.effectiveMinWidth);
        measureHeight = Math.max(measureHeight, this.effectiveMinHeight);
        var widthAndState = dock_layout_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = dock_layout_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    DockLayout.prototype.onLayout = function (left, top, right, bottom) {
        var _this = this;
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        var insets = this.getSafeAreaInsets();
        var horizontalPaddingsAndMargins = this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth + insets.left + insets.right;
        var verticalPaddingsAndMargins = this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth + insets.top + insets.bottom;
        var childLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var childTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var x = childLeft;
        var y = childTop;
        var remainingWidth = Math.max(0, right - left - horizontalPaddingsAndMargins);
        var remainingHeight = Math.max(0, bottom - top - verticalPaddingsAndMargins);
        this.eachLayoutChild(function (child, last) {
            var childWidth = child.getMeasuredWidth() + child.effectiveMarginLeft + child.effectiveMarginRight;
            var childHeight = child.getMeasuredHeight() + child.effectiveMarginTop + child.effectiveMarginBottom;
            if (last && _this.stretchLastChild) {
                dock_layout_common_1.View.layoutChild(_this, child, x, y, x + remainingWidth, y + remainingHeight);
                return;
            }
            var dock = DockLayout.getDock(child);
            switch (dock) {
                case "top":
                    childLeft = x;
                    childTop = y;
                    childWidth = remainingWidth;
                    y += childHeight;
                    remainingHeight = Math.max(0, remainingHeight - childHeight);
                    break;
                case "bottom":
                    childLeft = x;
                    childTop = y + remainingHeight - childHeight;
                    childWidth = remainingWidth;
                    remainingHeight = Math.max(0, remainingHeight - childHeight);
                    break;
                case "right":
                    childLeft = x + remainingWidth - childWidth;
                    childTop = y;
                    childHeight = remainingHeight;
                    remainingWidth = Math.max(0, remainingWidth - childWidth);
                    break;
                case "left":
                default:
                    childLeft = x;
                    childTop = y;
                    childHeight = remainingHeight;
                    x += childWidth;
                    remainingWidth = Math.max(0, remainingWidth - childWidth);
                    break;
            }
            dock_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childLeft + childWidth, childTop + childHeight);
        });
    };
    return DockLayout;
}(dock_layout_common_1.DockLayoutBase));
exports.DockLayout = DockLayout;
//# sourceMappingURL=dock-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
exports.ORDER_DEFAULT = 1;
exports.FLEX_GROW_DEFAULT = 0.0;
exports.FLEX_SHRINK_DEFAULT = 1.0;
var FlexDirection;
(function (FlexDirection) {
    FlexDirection.ROW = "row";
    FlexDirection.ROW_REVERSE = "row-reverse";
    FlexDirection.COLUMN = "column";
    FlexDirection.COLUMN_REVERSE = "column-reverse";
    FlexDirection.isValid = layout_base_1.makeValidator(FlexDirection.ROW, FlexDirection.ROW_REVERSE, FlexDirection.COLUMN, FlexDirection.COLUMN_REVERSE);
    FlexDirection.parse = layout_base_1.makeParser(FlexDirection.isValid);
})(FlexDirection = exports.FlexDirection || (exports.FlexDirection = {}));
var FlexWrap;
(function (FlexWrap) {
    FlexWrap.NOWRAP = "nowrap";
    FlexWrap.WRAP = "wrap";
    FlexWrap.WRAP_REVERSE = "wrap-reverse";
    FlexWrap.isValid = layout_base_1.makeValidator(FlexWrap.NOWRAP, FlexWrap.WRAP, FlexWrap.WRAP_REVERSE);
    FlexWrap.parse = layout_base_1.makeParser(FlexWrap.isValid);
})(FlexWrap = exports.FlexWrap || (exports.FlexWrap = {}));
var JustifyContent;
(function (JustifyContent) {
    JustifyContent.FLEX_START = "flex-start";
    JustifyContent.FLEX_END = "flex-end";
    JustifyContent.CENTER = "center";
    JustifyContent.SPACE_BETWEEN = "space-between";
    JustifyContent.SPACE_AROUND = "space-around";
    JustifyContent.isValid = layout_base_1.makeValidator(JustifyContent.FLEX_START, JustifyContent.FLEX_END, JustifyContent.CENTER, JustifyContent.SPACE_BETWEEN, JustifyContent.SPACE_AROUND);
    JustifyContent.parse = layout_base_1.makeParser(JustifyContent.isValid);
})(JustifyContent = exports.JustifyContent || (exports.JustifyContent = {}));
var FlexBasisPercent;
(function (FlexBasisPercent) {
    FlexBasisPercent.DEFAULT = -1;
})(FlexBasisPercent = exports.FlexBasisPercent || (exports.FlexBasisPercent = {}));
var AlignItems;
(function (AlignItems) {
    AlignItems.FLEX_START = "flex-start";
    AlignItems.FLEX_END = "flex-end";
    AlignItems.CENTER = "center";
    AlignItems.BASELINE = "baseline";
    AlignItems.STRETCH = "stretch";
    AlignItems.isValid = layout_base_1.makeValidator(AlignItems.FLEX_START, AlignItems.FLEX_END, AlignItems.CENTER, AlignItems.BASELINE, AlignItems.STRETCH);
    AlignItems.parse = layout_base_1.makeParser(AlignItems.isValid);
})(AlignItems = exports.AlignItems || (exports.AlignItems = {}));
var AlignContent;
(function (AlignContent) {
    AlignContent.FLEX_START = "flex-start";
    AlignContent.FLEX_END = "flex-end";
    AlignContent.CENTER = "center";
    AlignContent.SPACE_BETWEEN = "space-between";
    AlignContent.SPACE_AROUND = "space-around";
    AlignContent.STRETCH = "stretch";
    AlignContent.isValid = layout_base_1.makeValidator(AlignContent.FLEX_START, AlignContent.FLEX_END, AlignContent.CENTER, AlignContent.SPACE_BETWEEN, AlignContent.SPACE_AROUND, AlignContent.STRETCH);
    AlignContent.parse = layout_base_1.makeParser(AlignContent.isValid);
})(AlignContent = exports.AlignContent || (exports.AlignContent = {}));
var Order;
(function (Order) {
    function isValid(value) {
        return isFinite(parseInt(value));
    }
    Order.isValid = isValid;
    Order.parse = parseInt;
})(Order = exports.Order || (exports.Order = {}));
var FlexGrow;
(function (FlexGrow) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexGrow.isValid = isValid;
    FlexGrow.parse = parseFloat;
})(FlexGrow = exports.FlexGrow || (exports.FlexGrow = {}));
var FlexShrink;
(function (FlexShrink) {
    function isValid(value) {
        var parsed = parseInt(value);
        return isFinite(parsed) && value >= 0;
    }
    FlexShrink.isValid = isValid;
    FlexShrink.parse = parseFloat;
})(FlexShrink = exports.FlexShrink || (exports.FlexShrink = {}));
var FlexWrapBefore;
(function (FlexWrapBefore) {
    function isValid(value) {
        if (typeof value === "boolean") {
            return true;
        }
        if (typeof value === "string") {
            var str = value.trim().toLowerCase();
            return str === "true" || str === "false";
        }
        return false;
    }
    FlexWrapBefore.isValid = isValid;
    function parse(value) {
        return value && value.toString().trim().toLowerCase() === "true";
    }
    FlexWrapBefore.parse = parse;
})(FlexWrapBefore = exports.FlexWrapBefore || (exports.FlexWrapBefore = {}));
var AlignSelf;
(function (AlignSelf) {
    AlignSelf.AUTO = "auto";
    AlignSelf.FLEX_START = "flex-start";
    AlignSelf.FLEX_END = "flex-end";
    AlignSelf.CENTER = "center";
    AlignSelf.BASELINE = "baseline";
    AlignSelf.STRETCH = "stretch";
    AlignSelf.isValid = layout_base_1.makeValidator(AlignSelf.AUTO, AlignSelf.FLEX_START, AlignSelf.FLEX_END, AlignSelf.CENTER, AlignSelf.BASELINE, AlignSelf.STRETCH);
    AlignSelf.parse = layout_base_1.makeParser(AlignSelf.isValid);
})(AlignSelf = exports.AlignSelf || (exports.AlignSelf = {}));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefinied.");
    }
    return element;
}
var FlexboxLayoutBase = (function (_super) {
    __extends(FlexboxLayoutBase, _super);
    function FlexboxLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexDirection", {
        get: function () {
            return this.style.flexDirection;
        },
        set: function (value) {
            this.style.flexDirection = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "flexWrap", {
        get: function () {
            return this.style.flexWrap;
        },
        set: function (value) {
            this.style.flexWrap = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "justifyContent", {
        get: function () {
            return this.style.justifyContent;
        },
        set: function (value) {
            this.style.justifyContent = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignItems", {
        get: function () {
            return this.style.alignItems;
        },
        set: function (value) {
            this.style.alignItems = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexboxLayoutBase.prototype, "alignContent", {
        get: function () {
            return this.style.alignContent;
        },
        set: function (value) {
            this.style.alignContent = value;
        },
        enumerable: true,
        configurable: true
    });
    FlexboxLayoutBase.setOrder = function (view, order) {
        validateArgs(view).style.order = order;
    };
    FlexboxLayoutBase.getOrder = function (view) {
        return validateArgs(view).style.order;
    };
    FlexboxLayoutBase.setFlexGrow = function (view, grow) {
        validateArgs(view).style.flexGrow = grow;
    };
    FlexboxLayoutBase.getFlexGrow = function (view) {
        return validateArgs(view).style.flexGrow;
    };
    FlexboxLayoutBase.setFlexShrink = function (view, shrink) {
        validateArgs(view).style.flexShrink = shrink;
    };
    FlexboxLayoutBase.getFlexShrink = function (view) {
        return validateArgs(view).style.flexShrink;
    };
    FlexboxLayoutBase.setAlignSelf = function (view, align) {
        validateArgs(view).style.alignSelf = align;
    };
    FlexboxLayoutBase.getAlignSelf = function (view) {
        return validateArgs(view).style.alignSelf;
    };
    FlexboxLayoutBase.setFlexWrapBefore = function (view, wrap) {
        validateArgs(view).style.flexWrapBefore = wrap;
    };
    FlexboxLayoutBase.getFlexWrapBefore = function (view) {
        return validateArgs(view).style.flexWrapBefore;
    };
    FlexboxLayoutBase = __decorate([
        layout_base_1.CSSType("FlexboxLayout")
    ], FlexboxLayoutBase);
    return FlexboxLayoutBase;
}(layout_base_1.LayoutBase));
exports.FlexboxLayoutBase = FlexboxLayoutBase;
FlexboxLayoutBase.prototype.recycleNativeView = "auto";
exports.flexDirectionProperty = new layout_base_1.CssProperty({ name: "flexDirection", cssName: "flex-direction", defaultValue: FlexDirection.ROW, affectsLayout: layout_base_1.isIOS, valueConverter: FlexDirection.parse });
exports.flexDirectionProperty.register(layout_base_1.Style);
exports.flexWrapProperty = new layout_base_1.CssProperty({ name: "flexWrap", cssName: "flex-wrap", defaultValue: "nowrap", affectsLayout: layout_base_1.isIOS, valueConverter: FlexWrap.parse });
exports.flexWrapProperty.register(layout_base_1.Style);
exports.justifyContentProperty = new layout_base_1.CssProperty({ name: "justifyContent", cssName: "justify-content", defaultValue: JustifyContent.FLEX_START, affectsLayout: layout_base_1.isIOS, valueConverter: JustifyContent.parse });
exports.justifyContentProperty.register(layout_base_1.Style);
exports.alignItemsProperty = new layout_base_1.CssProperty({ name: "alignItems", cssName: "align-items", defaultValue: AlignItems.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignItems.parse });
exports.alignItemsProperty.register(layout_base_1.Style);
exports.alignContentProperty = new layout_base_1.CssProperty({ name: "alignContent", cssName: "align-content", defaultValue: AlignContent.STRETCH, affectsLayout: layout_base_1.isIOS, valueConverter: AlignContent.parse });
exports.alignContentProperty.register(layout_base_1.Style);
exports.orderProperty = new layout_base_1.CssProperty({ name: "order", cssName: "order", defaultValue: exports.ORDER_DEFAULT, valueConverter: Order.parse });
exports.orderProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "order", {
    get: function () {
        return this.style.order;
    },
    set: function (value) {
        this.style.order = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexGrowProperty = new layout_base_1.CssProperty({ name: "flexGrow", cssName: "flex-grow", defaultValue: exports.FLEX_GROW_DEFAULT, valueConverter: FlexGrow.parse });
exports.flexGrowProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexGrow", {
    get: function () {
        return this.style.flexGrow;
    },
    set: function (value) {
        this.style.flexGrow = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexShrinkProperty = new layout_base_1.CssProperty({ name: "flexShrink", cssName: "flex-shrink", defaultValue: exports.FLEX_SHRINK_DEFAULT, valueConverter: FlexShrink.parse });
exports.flexShrinkProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexShrink", {
    get: function () {
        return this.style.flexShrink;
    },
    set: function (value) {
        this.style.flexShrink = value;
    },
    enumerable: true,
    configurable: true
});
exports.flexWrapBeforeProperty = new layout_base_1.CssProperty({ name: "flexWrapBefore", cssName: "flex-wrap-before", defaultValue: false, valueConverter: FlexWrapBefore.parse });
exports.flexWrapBeforeProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "flexWrapBefore", {
    get: function () {
        return this.style.flexWrapBefore;
    },
    set: function (value) {
        this.style.flexWrapBefore = value;
    },
    enumerable: true,
    configurable: true
});
exports.alignSelfProperty = new layout_base_1.CssProperty({ name: "alignSelf", cssName: "align-self", defaultValue: AlignSelf.AUTO, valueConverter: AlignSelf.parse });
exports.alignSelfProperty.register(layout_base_1.Style);
Object.defineProperty(layout_base_1.View.prototype, "alignSelf", {
    get: function () {
        return this.style.alignSelf;
    },
    set: function (value) {
        this.style.alignSelf = value;
    },
    enumerable: true,
    configurable: true
});
var flexFlowProperty = new layout_base_1.ShorthandProperty({
    name: "flexFlow", cssName: "flex-flow",
    getter: function () {
        return this.flexDirection + " " + this.flexWrap;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexDirectionProperty, value]);
            properties.push([exports.flexWrapProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length >= 1 && FlexDirection.isValid(values[0])) {
                    properties.push([exports.flexDirectionProperty, FlexDirection.parse(values[0])]);
                }
                if (value.length >= 2 && FlexWrap.isValid(values[1])) {
                    properties.push([exports.flexWrapProperty, FlexWrap.parse(values[1])]);
                }
            }
        }
        return properties;
    }
});
flexFlowProperty.register(layout_base_1.Style);
var flexProperty = new layout_base_1.ShorthandProperty({
    name: "flex", cssName: "flex",
    getter: function () {
        return this.flexGrow + " " + this.flexShrink;
    },
    converter: function (value) {
        var properties = [];
        if (value === layout_base_1.unsetValue) {
            properties.push([exports.flexGrowProperty, value]);
            properties.push([exports.flexShrinkProperty, value]);
        }
        else {
            var trimmed = value && value.trim();
            if (trimmed) {
                var values = trimmed.split(/\s+/);
                if (values.length === 1) {
                    switch (values[0]) {
                        case "inital":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "auto":
                            properties.push([exports.flexGrowProperty, 1]);
                            properties.push([exports.flexShrinkProperty, 1]);
                            break;
                        case "none":
                            properties.push([exports.flexGrowProperty, 0]);
                            properties.push([exports.flexShrinkProperty, 0]);
                            break;
                        default:
                            if (FlexGrow.isValid(values[0])) {
                                properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                                properties.push([exports.flexShrinkProperty, 1]);
                            }
                    }
                }
                if (values.length >= 2) {
                    if (FlexGrow.isValid(values[0]) && FlexShrink.isValid(values[1])) {
                        properties.push([exports.flexGrowProperty, FlexGrow.parse(values[0])]);
                        properties.push([exports.flexShrinkProperty, FlexShrink.parse(values[1])]);
                    }
                }
            }
        }
        return properties;
    }
});
flexProperty.register(layout_base_1.Style);
//# sourceMappingURL=flexbox-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var flexbox_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/flexbox-layout/flexbox-layout-common.js"));
var EXACTLY = flexbox_layout_common_1.layout.EXACTLY;
var AT_MOST = flexbox_layout_common_1.layout.AT_MOST;
var UNSPECIFIED = flexbox_layout_common_1.layout.UNSPECIFIED;
var MEASURED_SIZE_MASK = flexbox_layout_common_1.layout.MEASURED_SIZE_MASK;
var MEASURED_STATE_TOO_SMALL = flexbox_layout_common_1.layout.MEASURED_STATE_TOO_SMALL;
function requestFlexboxLayout(value) {
    var flexbox = this.parent;
    if (flexbox instanceof flexbox_layout_common_1.FlexboxLayoutBase) {
        flexbox.requestLayout();
    }
}
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.orderProperty.setNative] = requestFlexboxLayout;
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexGrowProperty.setNative] = requestFlexboxLayout;
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexShrinkProperty.setNative] = requestFlexboxLayout;
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.flexWrapBeforeProperty.setNative] = requestFlexboxLayout;
flexbox_layout_common_1.View.prototype[flexbox_layout_common_1.alignSelfProperty.setNative] = requestFlexboxLayout;
var MATCH_PARENT = -1;
var WRAP_CONTENT = -2;
var View_sUseZeroUnspecifiedMeasureSpec = true;
var MAX_SIZE = 0x00FFFFFF & MEASURED_SIZE_MASK;
var makeMeasureSpec = flexbox_layout_common_1.layout.makeMeasureSpec;
var getMeasureSpecMode = flexbox_layout_common_1.layout.getMeasureSpecMode;
var getMeasureSpecSize = flexbox_layout_common_1.layout.getMeasureSpecSize;
var MeasureContext = (function () {
    function MeasureContext(owner) {
        var _this = this;
        this.owner = owner;
        this.children = [];
        this.owner.eachLayoutChild(function (child) {
            _this.children.push(child);
        });
    }
    Object.defineProperty(MeasureContext.prototype, "childrenCount", {
        get: function () {
            return this.children.length;
        },
        enumerable: true,
        configurable: true
    });
    MeasureContext.prototype.childAt = function (index) {
        return this.children[index];
    };
    return MeasureContext;
}());
var FlexLine = (function () {
    function FlexLine() {
        this._left = Number.MAX_VALUE;
        this._top = Number.MAX_VALUE;
        this._right = Number.MAX_VALUE;
        this._bottom = Number.MAX_VALUE;
        this._mainSize = 0;
        this._dividerLengthInMainSize = 0;
        this._crossSize = 0;
        this._itemCount = 0;
        this._totalFlexGrow = 0;
        this._totalFlexShrink = 0;
        this._maxBaseline = 0;
        this._indicesAlignSelfStretch = [];
    }
    Object.defineProperty(FlexLine.prototype, "left", {
        get: function () { return this._left; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "top", {
        get: function () { return this._top; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "right", {
        get: function () { return this._right; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "bottom", {
        get: function () { return this._bottom; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "mainSize", {
        get: function () { return this._mainSize; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "crossSize", {
        get: function () { return this._crossSize; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "itemCount", {
        get: function () { return this._itemCount; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "totalFlexGrow", {
        get: function () { return this._totalFlexGrow; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FlexLine.prototype, "totalFlexShrink", {
        get: function () { return this._totalFlexShrink; },
        enumerable: true,
        configurable: true
    });
    return FlexLine;
}());
var Order = (function () {
    function Order() {
    }
    Order.prototype.compareTo = function (another) {
        if (this.order !== another.order) {
            return this.order - another.order;
        }
        return this.index - another.index;
    };
    return Order;
}());
var FlexboxLayout = (function (_super) {
    __extends(FlexboxLayout, _super);
    function FlexboxLayout() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._flexLines = [];
        return _this;
    }
    FlexboxLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        this.measureContext = new MeasureContext(this);
        if (this._isOrderChangedFromLastMeasurement) {
            this._reorderedIndices = this._createReorderedIndices();
        }
        if (!this._childrenFrozen || this._childrenFrozen.length < this.measureContext.childrenCount) {
            this._childrenFrozen = new Array(this.measureContext.childrenCount);
        }
        switch (this.flexDirection) {
            case flexbox_layout_common_1.FlexDirection.ROW:
            case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                this._measureHorizontal(widthMeasureSpec, heightMeasureSpec);
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN:
            case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                this._measureVertical(widthMeasureSpec, heightMeasureSpec);
                break;
            default:
                throw new Error("Invalid value for the flex direction is set: " + this.flexDirection);
        }
        this._childrenFrozen.length = 0;
    };
    FlexboxLayout.prototype._getReorderedChildAt = function (index) {
        var child;
        if (index < 0 || index >= this._reorderedIndices.length) {
            child = null;
        }
        else {
            var reorderedIndex = this._reorderedIndices[index];
            child = this.measureContext.childAt(reorderedIndex);
        }
        return child;
    };
    FlexboxLayout.prototype._createReorderedIndices = function () {
        var childCount = this.measureContext.childrenCount;
        var orders = this._createOrders(childCount);
        return this._sortOrdersIntoReorderedIndices(childCount, orders);
    };
    FlexboxLayout.prototype._sortOrdersIntoReorderedIndices = function (childCount, orders) {
        var _this = this;
        orders.sort(function (a, b) { return a.compareTo(b); });
        if (!this._orderCache) {
            this._orderCache = [];
        }
        this._orderCache.length = 0;
        var reorderedIndices = [];
        orders.forEach(function (order, i) {
            reorderedIndices[i] = order.index;
            _this._orderCache[i] = order.order;
        });
        return reorderedIndices;
    };
    FlexboxLayout.prototype._createOrders = function (childCount) {
        var orders = [];
        for (var i = 0; i < childCount; i++) {
            var child = this.measureContext.childAt(i);
            var order = new Order();
            order.order = FlexboxLayout.getOrder(child);
            order.index = i;
            orders.push(order);
        }
        return orders;
    };
    Object.defineProperty(FlexboxLayout.prototype, "_isOrderChangedFromLastMeasurement", {
        get: function () {
            var childCount = this.measureContext.childrenCount;
            if (!this._orderCache) {
                this._orderCache = [];
            }
            if (this._orderCache.length !== childCount) {
                return true;
            }
            for (var i = 0; i < childCount; i++) {
                var view = this.measureContext.childAt(i);
                if (view === null) {
                    continue;
                }
                if (FlexboxLayout.getOrder(view) !== this._orderCache[i]) {
                    return true;
                }
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    FlexboxLayout.prototype._measureHorizontal = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        var widthSize = getMeasureSpecSize(widthMeasureSpec);
        var widthMode = getMeasureSpecMode(widthMeasureSpec);
        var heightSize = getMeasureSpecSize(heightMeasureSpec);
        var heightMode = getMeasureSpecMode(heightMeasureSpec);
        var childState = 0;
        this._flexLines.length = 0;
        (function () {
            var childCount = _this.measureContext.childrenCount;
            var paddingStart = FlexboxLayout.getPaddingStart(_this);
            var paddingEnd = FlexboxLayout.getPaddingEnd(_this);
            var largestHeightInRow = Number.MIN_VALUE;
            var flexLine = new FlexLine();
            var indexInFlexLine = 0;
            flexLine._mainSize = paddingStart + paddingEnd;
            for (var i = 0; i < childCount; i++) {
                var child = _this._getReorderedChildAt(i);
                if (child === null) {
                    _this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
                    continue;
                }
                else if (child.isCollapsed) {
                    flexLine._itemCount++;
                    _this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
                    continue;
                }
                child._updateEffectiveLayoutValues(widthSize, widthMode, heightSize, heightMode);
                var lp = child;
                if (FlexboxLayout.getAlignSelf(child) === "stretch") {
                    flexLine._indicesAlignSelfStretch.push(i);
                }
                var childWidth = lp.effectiveWidth;
                if (flexbox_layout_common_1.FlexBasisPercent.DEFAULT !== flexbox_layout_common_1.FlexBasisPercent.DEFAULT && widthMode === EXACTLY) {
                    childWidth = Math.round(widthSize * flexbox_layout_common_1.FlexBasisPercent.DEFAULT);
                }
                var childWidthMeasureSpec = FlexboxLayout.getChildMeasureSpec(widthMeasureSpec, lp.effectivePaddingLeft + lp.effectivePaddingRight + lp.effectiveMarginLeft
                    + lp.effectiveMarginRight, childWidth < 0 ? WRAP_CONTENT : childWidth);
                var childHeightMeasureSpec = FlexboxLayout.getChildMeasureSpec(heightMeasureSpec, lp.effectivePaddingTop + lp.effectivePaddingBottom + lp.effectiveMarginTop
                    + lp.effectiveMarginBottom, lp.effectiveHeight < 0 ? WRAP_CONTENT : lp.effectiveHeight);
                child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
                _this._checkSizeConstraints(child);
                childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, child.getMeasuredState());
                largestHeightInRow = Math.max(largestHeightInRow, child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom);
                if (_this._isWrapRequired(child, widthMode, widthSize, flexLine._mainSize, child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight, i, indexInFlexLine)) {
                    if (flexLine.itemCount > 0) {
                        _this._addFlexLine(flexLine);
                    }
                    flexLine = new FlexLine();
                    flexLine._itemCount = 1;
                    flexLine._mainSize = paddingStart + paddingEnd;
                    largestHeightInRow = child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom;
                    indexInFlexLine = 0;
                }
                else {
                    flexLine._itemCount++;
                    indexInFlexLine++;
                }
                flexLine._mainSize += child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight;
                flexLine._totalFlexGrow += FlexboxLayout.getFlexGrow(child);
                flexLine._totalFlexShrink += FlexboxLayout.getFlexShrink(child);
                flexLine._crossSize = Math.max(flexLine._crossSize, largestHeightInRow);
                if (_this.flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    flexLine._maxBaseline = Math.max(flexLine._maxBaseline, FlexboxLayout.getBaseline(child) + lp.effectiveMarginTop);
                }
                else {
                    flexLine._maxBaseline = Math.max(flexLine._maxBaseline, child.getMeasuredHeight() - FlexboxLayout.getBaseline(child) + lp.effectiveMarginBottom);
                }
                _this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
            }
        })();
        this._determineMainSize(this.flexDirection, widthMeasureSpec, heightMeasureSpec);
        if (this.alignItems === flexbox_layout_common_1.AlignItems.BASELINE) {
            var viewIndex_1 = 0;
            this._flexLines.forEach(function (flexLine) {
                var largestHeightInLine = Number.MIN_VALUE;
                for (var i = viewIndex_1; i < viewIndex_1 + flexLine._itemCount; i++) {
                    var child = _this._getReorderedChildAt(i);
                    var lp = child;
                    if (_this.flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                        var marginTop = flexLine._maxBaseline - FlexboxLayout.getBaseline(child);
                        marginTop = Math.max(marginTop, lp.effectiveMarginTop);
                        largestHeightInLine = Math.max(largestHeightInLine, child.getActualSize().height + marginTop + lp.effectiveMarginBottom);
                    }
                    else {
                        var marginBottom = flexLine._maxBaseline - child.getMeasuredHeight() + FlexboxLayout.getBaseline(child);
                        marginBottom = Math.max(marginBottom, lp.effectiveMarginBottom);
                        largestHeightInLine = Math.max(largestHeightInLine, child.getActualSize().height + lp.effectiveMarginTop + marginBottom);
                    }
                }
                flexLine._crossSize = largestHeightInLine;
                viewIndex_1 += flexLine.itemCount;
            });
        }
        this._determineCrossSize(this.flexDirection, widthMeasureSpec, heightMeasureSpec, this.effectivePaddingTop + this.effectivePaddingBottom);
        this._stretchViews(this.flexDirection, this.alignItems);
        this._setMeasuredDimensionForFlex(this.flexDirection, widthMeasureSpec, heightMeasureSpec, childState);
    };
    FlexboxLayout.prototype._measureVertical = function (widthMeasureSpec, heightMeasureSpec) {
        var widthSize = getMeasureSpecSize(widthMeasureSpec);
        var widthMode = getMeasureSpecMode(widthMeasureSpec);
        var heightSize = getMeasureSpecSize(heightMeasureSpec);
        var heightMode = getMeasureSpecMode(heightMeasureSpec);
        var childState = 0;
        this._flexLines.length = 0;
        var childCount = this.measureContext.childrenCount;
        var paddingTop = this.effectivePaddingTop;
        var paddingBottom = this.effectivePaddingBottom;
        var largestWidthInColumn = Number.MIN_VALUE;
        var flexLine = new FlexLine();
        flexLine._mainSize = paddingTop + paddingBottom;
        var indexInFlexLine = 0;
        for (var i = 0; i < childCount; i++) {
            var child = this._getReorderedChildAt(i);
            if (child === null) {
                this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
                continue;
            }
            else if (child.isCollapsed) {
                flexLine._itemCount++;
                this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
                continue;
            }
            child._updateEffectiveLayoutValues(widthSize, widthMode, heightSize, heightMode);
            var lp = child;
            if (FlexboxLayout.getAlignSelf(child) === "stretch") {
                flexLine._indicesAlignSelfStretch.push(i);
            }
            var childHeight = lp.effectiveHeight;
            if (flexbox_layout_common_1.FlexBasisPercent.DEFAULT !== flexbox_layout_common_1.FlexBasisPercent.DEFAULT && heightMode === EXACTLY) {
                childHeight = Math.round(heightSize * flexbox_layout_common_1.FlexBasisPercent.DEFAULT);
            }
            var childWidthMeasureSpec = FlexboxLayout.getChildMeasureSpec(widthMeasureSpec, this.effectivePaddingLeft + this.effectivePaddingRight + lp.effectiveMarginLeft
                + lp.effectiveMarginRight, lp.effectiveWidth < 0 ? WRAP_CONTENT : lp.effectiveWidth);
            var childHeightMeasureSpec = FlexboxLayout.getChildMeasureSpec(heightMeasureSpec, this.effectivePaddingTop + this.effectivePaddingBottom + lp.effectiveMarginTop
                + lp.effectiveMarginBottom, childHeight < 0 ? WRAP_CONTENT : childHeight);
            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
            this._checkSizeConstraints(child);
            childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, child.getMeasuredState());
            largestWidthInColumn = Math.max(largestWidthInColumn, child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight);
            if (this._isWrapRequired(child, heightMode, heightSize, flexLine.mainSize, child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom, i, indexInFlexLine)) {
                if (flexLine._itemCount > 0) {
                    this._addFlexLine(flexLine);
                }
                flexLine = new FlexLine();
                flexLine._itemCount = 1;
                flexLine._mainSize = paddingTop + paddingBottom;
                largestWidthInColumn = child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight;
                indexInFlexLine = 0;
            }
            else {
                flexLine._itemCount++;
                indexInFlexLine++;
            }
            flexLine._mainSize += child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom;
            flexLine._totalFlexGrow += FlexboxLayout.getFlexGrow(child);
            flexLine._totalFlexShrink += FlexboxLayout.getFlexShrink(child);
            flexLine._crossSize = Math.max(flexLine._crossSize, largestWidthInColumn);
            this._addFlexLineIfLastFlexItem(i, childCount, flexLine);
        }
        this._determineMainSize(this.flexDirection, widthMeasureSpec, heightMeasureSpec);
        this._determineCrossSize(this.flexDirection, widthMeasureSpec, heightMeasureSpec, this.effectivePaddingLeft + this.effectivePaddingRight);
        this._stretchViews(this.flexDirection, this.alignItems);
        this._setMeasuredDimensionForFlex(this.flexDirection, widthMeasureSpec, heightMeasureSpec, childState);
    };
    FlexboxLayout.prototype._checkSizeConstraints = function (view) {
        var needsMeasure = false;
        var childWidth = view.getMeasuredWidth();
        var childHeight = view.getMeasuredHeight();
        var minWidth = view.effectiveMinWidth;
        view.effectiveMinWidth = 0;
        if (view.getMeasuredWidth() < minWidth) {
            needsMeasure = true;
            childWidth = minWidth;
        }
        else if (view.getMeasuredWidth() > MAX_SIZE) {
            needsMeasure = true;
            childWidth = MAX_SIZE;
        }
        var minHeight = view.effectiveMinHeight;
        view.effectiveMinHeight = 0;
        if (childHeight < minHeight) {
            needsMeasure = true;
            childHeight = minHeight;
        }
        else if (childHeight > MAX_SIZE) {
            needsMeasure = true;
            childHeight = MAX_SIZE;
        }
        if (needsMeasure) {
            view.measure(makeMeasureSpec(childWidth, EXACTLY), makeMeasureSpec(childHeight, EXACTLY));
        }
        view.effectiveMinWidth = minWidth;
        view.effectiveMinHeight = minHeight;
    };
    FlexboxLayout.prototype._addFlexLineIfLastFlexItem = function (childIndex, childCount, flexLine) {
        if (childIndex === childCount - 1 && flexLine.itemCount !== 0) {
            this._addFlexLine(flexLine);
        }
    };
    FlexboxLayout.prototype._addFlexLine = function (flexLine) {
        this._flexLines.push(flexLine);
    };
    FlexboxLayout.prototype._determineMainSize = function (flexDirection, widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        var mainSize;
        var paddingAlongMainAxis;
        switch (flexDirection) {
            case flexbox_layout_common_1.FlexDirection.ROW:
            case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                var widthMode = getMeasureSpecMode(widthMeasureSpec);
                var widthSize = getMeasureSpecSize(widthMeasureSpec);
                if (widthMode === EXACTLY) {
                    mainSize = widthSize;
                }
                else {
                    mainSize = this._getLargestMainSize();
                }
                paddingAlongMainAxis = this.effectivePaddingLeft + this.effectivePaddingRight;
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN:
            case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                var heightMode = getMeasureSpecMode(heightMeasureSpec);
                var heightSize = getMeasureSpecSize(heightMeasureSpec);
                if (heightMode === EXACTLY) {
                    mainSize = heightSize;
                }
                else {
                    mainSize = this._getLargestMainSize();
                }
                paddingAlongMainAxis = this.effectivePaddingTop + this.effectivePaddingBottom;
                break;
            default:
                throw new Error("Invalid flex direction: " + flexDirection);
        }
        var childIndex = 0;
        this._flexLines.forEach(function (flexLine) {
            if (flexLine.mainSize < mainSize) {
                childIndex = _this._expandFlexItems(flexLine, flexDirection, mainSize, paddingAlongMainAxis, childIndex);
            }
            else {
                childIndex = _this._shrinkFlexItems(flexLine, flexDirection, mainSize, paddingAlongMainAxis, childIndex);
            }
        });
    };
    FlexboxLayout.prototype._expandFlexItems = function (flexLine, flexDirection, maxMainSize, paddingAlongMainAxis, startIndex) {
        var childIndex = startIndex;
        if (flexLine._totalFlexGrow <= 0 || maxMainSize < flexLine._mainSize) {
            childIndex += flexLine._itemCount;
            return childIndex;
        }
        var sizeBeforeExpand = flexLine._mainSize;
        var needsReexpand = false;
        var pendingSpace = maxMainSize - flexLine._mainSize;
        var unitSpace = pendingSpace / flexLine._totalFlexGrow;
        flexLine._mainSize = paddingAlongMainAxis + flexLine._dividerLengthInMainSize;
        var accumulatedRoundError = 0;
        for (var i = 0; i < flexLine.itemCount; i++) {
            var child = this._getReorderedChildAt(childIndex);
            if (child === null) {
                continue;
            }
            else if (child.isCollapsed) {
                childIndex++;
                continue;
            }
            var lp = child;
            if (this._isMainAxisDirectionHorizontal(flexDirection)) {
                if (!this._childrenFrozen[childIndex]) {
                    var flexGrow = FlexboxLayout.getFlexGrow(child);
                    var rawCalculatedWidth = child.getMeasuredWidth() + unitSpace * flexGrow + accumulatedRoundError;
                    var roundedCalculatedWidth = Math.round(rawCalculatedWidth);
                    if (roundedCalculatedWidth > MAX_SIZE) {
                        needsReexpand = true;
                        roundedCalculatedWidth = MAX_SIZE;
                        this._childrenFrozen[childIndex] = true;
                        flexLine._totalFlexGrow -= flexGrow;
                    }
                    else {
                        accumulatedRoundError = rawCalculatedWidth - roundedCalculatedWidth;
                    }
                    child.measure(makeMeasureSpec(roundedCalculatedWidth, EXACTLY), makeMeasureSpec(child.getMeasuredHeight(), EXACTLY));
                }
                flexLine._mainSize += child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight;
            }
            else {
                if (!this._childrenFrozen[childIndex]) {
                    var flexGrow = FlexboxLayout.getFlexGrow(child);
                    var rawCalculatedHeight = child.getMeasuredHeight() + unitSpace * flexGrow + accumulatedRoundError;
                    var roundedCalculatedHeight = Math.round(rawCalculatedHeight);
                    if (roundedCalculatedHeight > MAX_SIZE) {
                        needsReexpand = true;
                        roundedCalculatedHeight = MAX_SIZE;
                        this._childrenFrozen[childIndex] = true;
                        flexLine._totalFlexGrow -= flexGrow;
                    }
                    else {
                        accumulatedRoundError = rawCalculatedHeight - roundedCalculatedHeight;
                    }
                    child.measure(makeMeasureSpec(child.getMeasuredWidth(), EXACTLY), makeMeasureSpec(roundedCalculatedHeight, EXACTLY));
                }
                flexLine._mainSize += child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom;
            }
            childIndex++;
        }
        if (needsReexpand && sizeBeforeExpand !== flexLine._mainSize) {
            this._expandFlexItems(flexLine, flexDirection, maxMainSize, paddingAlongMainAxis, startIndex);
        }
        return childIndex;
    };
    FlexboxLayout.prototype._shrinkFlexItems = function (flexLine, flexDirection, maxMainSize, paddingAlongMainAxis, startIndex) {
        var childIndex = startIndex;
        var sizeBeforeShrink = flexLine._mainSize;
        if (flexLine._totalFlexShrink <= 0 || maxMainSize > flexLine._mainSize) {
            childIndex += flexLine.itemCount;
            return childIndex;
        }
        var needsReshrink = false;
        var unitShrink = (flexLine._mainSize - maxMainSize) / flexLine._totalFlexShrink;
        var accumulatedRoundError = 0;
        flexLine._mainSize = paddingAlongMainAxis + flexLine._dividerLengthInMainSize;
        for (var i = 0; i < flexLine.itemCount; i++) {
            var child = this._getReorderedChildAt(childIndex);
            if (child === null) {
                continue;
            }
            else if (child.isCollapsed) {
                childIndex++;
                continue;
            }
            var lp = child;
            if (this._isMainAxisDirectionHorizontal(flexDirection)) {
                if (!this._childrenFrozen[childIndex]) {
                    var flexShrink = FlexboxLayout.getFlexShrink(child);
                    var rawCalculatedWidth = child.getMeasuredWidth() - unitShrink * flexShrink + accumulatedRoundError;
                    var roundedCalculatedWidth = Math.round(rawCalculatedWidth);
                    var minWidth = child.effectiveMinWidth;
                    child.effectiveMinWidth = 0;
                    if (roundedCalculatedWidth < minWidth) {
                        needsReshrink = true;
                        roundedCalculatedWidth = minWidth;
                        this._childrenFrozen[childIndex] = true;
                        flexLine._totalFlexShrink -= flexShrink;
                    }
                    else {
                        accumulatedRoundError = rawCalculatedWidth - roundedCalculatedWidth;
                    }
                    var childWidthMeasureSpec = makeMeasureSpec(roundedCalculatedWidth, EXACTLY);
                    var childHeightMeasureSpec = FlexboxLayout.getChildMeasureSpec(this._currentHeightMeasureSpec, lp.effectivePaddingTop + lp.effectivePaddingBottom + lp.effectiveMarginTop
                        + lp.effectiveMarginBottom, lp.effectiveHeight < 0 ? WRAP_CONTENT : lp.effectiveHeight);
                    child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
                    child.effectiveMinWidth = minWidth;
                    flexLine._crossSize = Math.max(flexLine._crossSize, child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom);
                }
                flexLine._mainSize += child.getMeasuredWidth() + lp.effectiveMarginLeft + lp.effectiveMarginRight;
            }
            else {
                if (!this._childrenFrozen[childIndex]) {
                    var flexShrink = FlexboxLayout.getFlexShrink(child);
                    var rawCalculatedHeight = child.getMeasuredHeight() - unitShrink * flexShrink + accumulatedRoundError;
                    var roundedCalculatedHeight = Math.round(rawCalculatedHeight);
                    var minHeight = child.effectiveMinHeight;
                    child.effectiveMinHeight = 0;
                    if (roundedCalculatedHeight < minHeight) {
                        needsReshrink = true;
                        roundedCalculatedHeight = minHeight;
                        this._childrenFrozen[childIndex] = true;
                        flexLine._totalFlexShrink -= flexShrink;
                    }
                    else {
                        accumulatedRoundError = rawCalculatedHeight - roundedCalculatedHeight;
                    }
                    child.measure(makeMeasureSpec(child.getMeasuredWidth(), EXACTLY), makeMeasureSpec(roundedCalculatedHeight, EXACTLY));
                    child.effectiveMinHeight = minHeight;
                }
                flexLine._mainSize += child.getMeasuredHeight() + lp.effectiveMarginTop + lp.effectiveMarginBottom;
            }
            childIndex++;
        }
        if (needsReshrink && sizeBeforeShrink !== flexLine._mainSize) {
            this._shrinkFlexItems(flexLine, flexDirection, maxMainSize, paddingAlongMainAxis, startIndex);
        }
        return childIndex;
    };
    FlexboxLayout.prototype._determineCrossSize = function (flexDirection, widthMeasureSpec, heightMeasureSpec, paddingAlongCrossAxis) {
        var _this = this;
        var mode;
        var size;
        switch (flexDirection) {
            case flexbox_layout_common_1.FlexDirection.ROW:
            case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                mode = getMeasureSpecMode(heightMeasureSpec);
                size = getMeasureSpecSize(heightMeasureSpec);
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN:
            case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                mode = getMeasureSpecMode(widthMeasureSpec);
                size = getMeasureSpecSize(widthMeasureSpec);
                break;
            default:
                throw new Error("Invalid flex direction: " + flexDirection);
        }
        if (mode === EXACTLY) {
            var totalCrossSize_1 = this._getSumOfCrossSize() + paddingAlongCrossAxis;
            if (this._flexLines.length === 1) {
                this._flexLines[0]._crossSize = size - paddingAlongCrossAxis;
            }
            else if (this._flexLines.length >= 2 && totalCrossSize_1 < size) {
                switch (this.alignContent) {
                    case flexbox_layout_common_1.AlignContent.STRETCH:
                        (function () {
                            var freeSpaceUnit = (size - totalCrossSize_1) / _this._flexLines.length;
                            var accumulatedError = 0;
                            for (var i = 0, flexLinesSize = _this._flexLines.length; i < flexLinesSize; i++) {
                                var flexLine = _this._flexLines[i];
                                var newCrossSizeAsFloat = flexLine._crossSize + freeSpaceUnit;
                                if (i === _this._flexLines.length - 1) {
                                    newCrossSizeAsFloat += accumulatedError;
                                    accumulatedError = 0;
                                }
                                var newCrossSize = Math.round(newCrossSizeAsFloat);
                                accumulatedError += (newCrossSizeAsFloat - newCrossSize);
                                if (accumulatedError > 1) {
                                    newCrossSize += 1;
                                    accumulatedError -= 1;
                                }
                                else if (accumulatedError < -1) {
                                    newCrossSize -= 1;
                                    accumulatedError += 1;
                                }
                                flexLine._crossSize = newCrossSize;
                            }
                        })();
                        break;
                    case flexbox_layout_common_1.AlignContent.SPACE_AROUND:
                        (function () {
                            var spaceTopAndBottom = size - totalCrossSize_1;
                            var numberOfSpaces = _this._flexLines.length * 2;
                            spaceTopAndBottom = spaceTopAndBottom / numberOfSpaces;
                            var newFlexLines = [];
                            var dummySpaceFlexLine = new FlexLine();
                            dummySpaceFlexLine._crossSize = spaceTopAndBottom;
                            _this._flexLines.forEach(function (flexLine) {
                                newFlexLines.push(dummySpaceFlexLine);
                                newFlexLines.push(flexLine);
                                newFlexLines.push(dummySpaceFlexLine);
                            });
                            _this._flexLines = newFlexLines;
                        })();
                        break;
                    case flexbox_layout_common_1.AlignContent.SPACE_BETWEEN:
                        (function () {
                            var spaceBetweenFlexLine = size - totalCrossSize_1;
                            var numberOfSpaces = _this._flexLines.length - 1;
                            spaceBetweenFlexLine = spaceBetweenFlexLine / numberOfSpaces;
                            var accumulatedError = 0;
                            var newFlexLines = [];
                            for (var i = 0, flexLineSize = _this._flexLines.length; i < flexLineSize; i++) {
                                var flexLine = _this._flexLines[i];
                                newFlexLines.push(flexLine);
                                if (i !== _this._flexLines.length - 1) {
                                    var dummySpaceFlexLine = new FlexLine();
                                    if (i === _this._flexLines.length - 2) {
                                        dummySpaceFlexLine._crossSize = Math.round(spaceBetweenFlexLine + accumulatedError);
                                        accumulatedError = 0;
                                    }
                                    else {
                                        dummySpaceFlexLine._crossSize = Math.round(spaceBetweenFlexLine);
                                    }
                                    accumulatedError += (spaceBetweenFlexLine - dummySpaceFlexLine._crossSize);
                                    if (accumulatedError > 1) {
                                        dummySpaceFlexLine._crossSize += 1;
                                        accumulatedError -= 1;
                                    }
                                    else if (accumulatedError < -1) {
                                        dummySpaceFlexLine._crossSize -= 1;
                                        accumulatedError += 1;
                                    }
                                    newFlexLines.push(dummySpaceFlexLine);
                                }
                            }
                            _this._flexLines = newFlexLines;
                        })();
                        break;
                    case flexbox_layout_common_1.AlignContent.CENTER: {
                        var spaceAboveAndBottom = size - totalCrossSize_1;
                        spaceAboveAndBottom = spaceAboveAndBottom / 2;
                        var newFlexLines = [];
                        var dummySpaceFlexLine = new FlexLine();
                        dummySpaceFlexLine._crossSize = spaceAboveAndBottom;
                        for (var i = 0, flexLineSize = this._flexLines.length; i < flexLineSize; i++) {
                            if (i === 0) {
                                newFlexLines.push(dummySpaceFlexLine);
                            }
                            var flexLine = this._flexLines[i];
                            newFlexLines.push(flexLine);
                            if (i === this._flexLines.length - 1) {
                                newFlexLines.push(dummySpaceFlexLine);
                            }
                        }
                        this._flexLines = newFlexLines;
                        break;
                    }
                    case flexbox_layout_common_1.AlignContent.FLEX_END: {
                        var spaceTop = size - totalCrossSize_1;
                        var dummySpaceFlexLine = new FlexLine();
                        dummySpaceFlexLine._crossSize = spaceTop;
                        this._flexLines.unshift(dummySpaceFlexLine);
                        break;
                    }
                }
            }
        }
    };
    FlexboxLayout.prototype._stretchViews = function (flexDirection, alignItems) {
        var _this = this;
        if (alignItems === flexbox_layout_common_1.AlignItems.STRETCH) {
            var viewIndex_2 = 0;
            this._flexLines.forEach(function (flexLine) {
                for (var i = 0; i < flexLine.itemCount; i++, viewIndex_2++) {
                    var view = _this._getReorderedChildAt(viewIndex_2);
                    var alignSelf = FlexboxLayout.getAlignSelf(view);
                    if (alignSelf !== "auto" && alignSelf !== "stretch") {
                        continue;
                    }
                    switch (flexDirection) {
                        case flexbox_layout_common_1.FlexDirection.ROW:
                        case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                            _this._stretchViewVertically(view, flexLine._crossSize);
                            break;
                        case flexbox_layout_common_1.FlexDirection.COLUMN:
                        case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                            _this._stretchViewHorizontally(view, flexLine._crossSize);
                            break;
                        default:
                            throw new Error("Invalid flex direction: " + flexDirection);
                    }
                }
            });
        }
        else {
            this._flexLines.forEach(function (flexLine) {
                flexLine._indicesAlignSelfStretch.forEach(function (index) {
                    var view = _this._getReorderedChildAt(index);
                    switch (flexDirection) {
                        case flexbox_layout_common_1.FlexDirection.ROW:
                        case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                            _this._stretchViewVertically(view, flexLine._crossSize);
                            break;
                        case flexbox_layout_common_1.FlexDirection.COLUMN:
                        case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                            _this._stretchViewHorizontally(view, flexLine._crossSize);
                            break;
                        default:
                            throw new Error("Invalid flex direction: " + flexDirection);
                    }
                });
            });
        }
    };
    FlexboxLayout.prototype._stretchViewVertically = function (view, crossSize) {
        var newHeight = crossSize - view.effectiveMarginTop - view.effectiveMarginBottom;
        newHeight = Math.max(newHeight, 0);
        var originalMeasuredWidth = view.getMeasuredWidth();
        var childWidthMeasureSpec = FlexboxLayout.getChildMeasureSpec(this._currentWidthMeasureSpec, view.effectivePaddingLeft + view.effectivePaddingRight + view.effectiveMarginLeft
            + view.effectiveMarginRight, view.effectiveWidth < 0 ? WRAP_CONTENT : Math.min(view.effectiveWidth, originalMeasuredWidth));
        view.measure(childWidthMeasureSpec, makeMeasureSpec(newHeight, EXACTLY));
        if (originalMeasuredWidth > view.getMeasuredWidth()) {
            childWidthMeasureSpec = makeMeasureSpec(originalMeasuredWidth, EXACTLY);
            view.measure(childWidthMeasureSpec, makeMeasureSpec(newHeight, EXACTLY));
        }
    };
    FlexboxLayout.prototype._stretchViewHorizontally = function (view, crossSize) {
        var newWidth = crossSize - view.effectiveMarginLeft - view.effectiveMarginRight;
        newWidth = Math.max(newWidth, 0);
        view.measure(makeMeasureSpec(newWidth, EXACTLY), makeMeasureSpec(view.getMeasuredHeight(), EXACTLY));
    };
    FlexboxLayout.prototype._setMeasuredDimensionForFlex = function (flexDirection, widthMeasureSpec, heightMeasureSpec, childState) {
        var widthMode = getMeasureSpecMode(widthMeasureSpec);
        var widthSize = getMeasureSpecSize(widthMeasureSpec);
        var heightMode = getMeasureSpecMode(heightMeasureSpec);
        var heightSize = getMeasureSpecSize(heightMeasureSpec);
        var calculatedMaxHeight;
        var calculatedMaxWidth;
        switch (flexDirection) {
            case flexbox_layout_common_1.FlexDirection.ROW:
            case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                calculatedMaxHeight = this._getSumOfCrossSize() + this.effectivePaddingTop + this.effectivePaddingBottom;
                calculatedMaxWidth = this._getLargestMainSize();
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN:
            case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                calculatedMaxHeight = this._getLargestMainSize();
                calculatedMaxWidth = this._getSumOfCrossSize() + this.effectivePaddingLeft + this.effectivePaddingRight;
                break;
            default:
                throw new Error("Invalid flex direction: " + flexDirection);
        }
        var widthSizeAndState;
        switch (widthMode) {
            case EXACTLY:
                if (widthSize < calculatedMaxWidth) {
                    childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, MEASURED_STATE_TOO_SMALL);
                }
                widthSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(widthSize, widthSize, widthMode, childState);
                break;
            case AT_MOST: {
                if (widthSize < calculatedMaxWidth) {
                    childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, MEASURED_STATE_TOO_SMALL);
                }
                else {
                    widthSize = calculatedMaxWidth;
                }
                widthSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(widthSize, widthSize, widthMode, childState);
                break;
            }
            case UNSPECIFIED: {
                widthSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(calculatedMaxWidth, widthSize, widthMode, childState);
                break;
            }
            default:
                throw new Error("Unknown width mode is set: " + widthMode);
        }
        var heightSizeAndState;
        switch (heightMode) {
            case EXACTLY:
                if (heightSize < calculatedMaxHeight) {
                    childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, MEASURED_STATE_TOO_SMALL >> flexbox_layout_common_1.layout.MEASURED_HEIGHT_STATE_SHIFT);
                }
                heightSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(heightSize, heightSize, heightMode, childState);
                break;
            case AT_MOST: {
                if (heightSize < calculatedMaxHeight) {
                    childState = flexbox_layout_common_1.View.combineMeasuredStates(childState, MEASURED_STATE_TOO_SMALL >> flexbox_layout_common_1.layout.MEASURED_HEIGHT_STATE_SHIFT);
                }
                else {
                    heightSize = calculatedMaxHeight;
                }
                heightSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(heightSize, heightSize, heightMode, childState);
                break;
            }
            case UNSPECIFIED: {
                heightSizeAndState = flexbox_layout_common_1.View.resolveSizeAndState(calculatedMaxHeight, heightSize, heightMode, childState);
                break;
            }
            default:
                throw new Error("Unknown height mode is set: " + heightMode);
        }
        this.setMeasuredDimension(widthSizeAndState, heightSizeAndState);
    };
    FlexboxLayout.prototype._isWrapRequired = function (child, mode, maxSize, currentLength, childLength, childAbsoluteIndex, childRelativeIndexInFlexLine) {
        if (this.flexWrap === flexbox_layout_common_1.FlexWrap.NOWRAP) {
            return false;
        }
        if (FlexboxLayout.getFlexWrapBefore(child)) {
            return true;
        }
        if (mode === UNSPECIFIED) {
            return false;
        }
        return maxSize < currentLength + childLength;
    };
    FlexboxLayout.prototype._getLargestMainSize = function () {
        return this._flexLines.reduce(function (max, flexLine) { return Math.max(max, flexLine.mainSize); }, Number.MIN_VALUE);
    };
    FlexboxLayout.prototype._getSumOfCrossSize = function () {
        return this._flexLines.reduce(function (sum, flexLine) { return sum + flexLine._crossSize; }, 0);
    };
    FlexboxLayout.prototype._isMainAxisDirectionHorizontal = function (flexDirection) {
        return flexDirection === flexbox_layout_common_1.FlexDirection.ROW || flexDirection === flexbox_layout_common_1.FlexDirection.ROW_REVERSE;
    };
    FlexboxLayout.prototype.onLayout = function (left, top, right, bottom) {
        var insets = this.getSafeAreaInsets();
        var isRtl;
        switch (this.flexDirection) {
            case flexbox_layout_common_1.FlexDirection.ROW:
                isRtl = false;
                this._layoutHorizontal(isRtl, left, top, right, bottom, insets);
                break;
            case flexbox_layout_common_1.FlexDirection.ROW_REVERSE:
                isRtl = true;
                this._layoutHorizontal(isRtl, left, top, right, bottom, insets);
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN:
                isRtl = false;
                if (this.flexWrap === flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    isRtl = !isRtl;
                }
                this._layoutVertical(isRtl, false, left, top, right, bottom, insets);
                break;
            case flexbox_layout_common_1.FlexDirection.COLUMN_REVERSE:
                isRtl = false;
                if (this.flexWrap === flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    isRtl = !isRtl;
                }
                this._layoutVertical(isRtl, true, left, top, right, bottom, insets);
                break;
            default:
                throw new Error("Invalid flex direction is set: " + this.flexDirection);
        }
    };
    FlexboxLayout.prototype._layoutHorizontal = function (isRtl, left, top, right, bottom, insets) {
        var _this = this;
        var paddingLeft = this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectivePaddingBottom + insets.bottom;
        var childLeft;
        var currentViewIndex = 0;
        var height = bottom - top;
        var width = right - left;
        var childBottom = height - paddingBottom;
        var childTop = paddingTop;
        var childRight;
        this._flexLines.forEach(function (flexLine, i) {
            var spaceBetweenItem = 0.0;
            switch (_this.justifyContent) {
                case flexbox_layout_common_1.JustifyContent.FLEX_START:
                    childLeft = paddingLeft;
                    childRight = width - paddingRight;
                    break;
                case flexbox_layout_common_1.JustifyContent.FLEX_END:
                    childLeft = width - flexLine._mainSize + paddingRight;
                    childRight = flexLine._mainSize - paddingLeft;
                    break;
                case flexbox_layout_common_1.JustifyContent.CENTER:
                    childLeft = paddingLeft + (width - insets.left - insets.right - flexLine._mainSize) / 2.0;
                    childRight = width - paddingRight - (width - insets.left - insets.right - flexLine._mainSize) / 2.0;
                    break;
                case flexbox_layout_common_1.JustifyContent.SPACE_AROUND:
                    if (flexLine._itemCount !== 0) {
                        spaceBetweenItem = (width - insets.left - insets.right - flexLine.mainSize) / flexLine._itemCount;
                    }
                    childLeft = paddingLeft + spaceBetweenItem / 2.0;
                    childRight = width - paddingRight - spaceBetweenItem / 2.0;
                    break;
                case flexbox_layout_common_1.JustifyContent.SPACE_BETWEEN:
                    childLeft = paddingLeft;
                    var denominator = flexLine.itemCount !== 1 ? flexLine.itemCount - 1 : 1.0;
                    spaceBetweenItem = (width - insets.left - insets.right - flexLine.mainSize) / denominator;
                    childRight = width - paddingRight;
                    break;
                default:
                    throw new Error("Invalid justifyContent is set: " + _this.justifyContent);
            }
            spaceBetweenItem = Math.max(spaceBetweenItem, 0);
            for (var j = 0; j < flexLine.itemCount; j++) {
                var child = _this._getReorderedChildAt(currentViewIndex);
                if (child === null) {
                    continue;
                }
                else if (child.isCollapsed) {
                    currentViewIndex++;
                    continue;
                }
                var lp = child;
                childLeft += lp.effectiveMarginLeft;
                childRight -= lp.effectiveMarginRight;
                if (_this.flexWrap === flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    if (isRtl) {
                        _this._layoutSingleChildHorizontal(child, flexLine, _this.flexWrap, _this.alignItems, Math.round(childRight) - child.getMeasuredWidth(), childBottom - child.getMeasuredHeight(), Math.round(childRight), childBottom);
                    }
                    else {
                        _this._layoutSingleChildHorizontal(child, flexLine, _this.flexWrap, _this.alignItems, Math.round(childLeft), childBottom - child.getMeasuredHeight(), Math.round(childLeft) + child.getMeasuredWidth(), childBottom);
                    }
                }
                else {
                    if (isRtl) {
                        _this._layoutSingleChildHorizontal(child, flexLine, _this.flexWrap, _this.alignItems, Math.round(childRight) - child.getMeasuredWidth(), childTop, Math.round(childRight), childTop + child.getMeasuredHeight());
                    }
                    else {
                        _this._layoutSingleChildHorizontal(child, flexLine, _this.flexWrap, _this.alignItems, Math.round(childLeft), childTop, Math.round(childLeft) + child.getMeasuredWidth(), childTop + child.getMeasuredHeight());
                    }
                }
                childLeft += child.getMeasuredWidth() + spaceBetweenItem + lp.effectiveMarginRight;
                childRight -= child.getMeasuredWidth() + spaceBetweenItem + lp.effectiveMarginLeft;
                currentViewIndex++;
                var bounds = child._getCurrentLayoutBounds();
                flexLine._left = Math.min(flexLine._left, bounds.left - lp.effectiveMarginLeft);
                flexLine._top = Math.min(flexLine._top, bounds.top - lp.effectiveMarginTop);
                flexLine._right = Math.max(flexLine._right, bounds.right + lp.effectiveMarginRight);
                flexLine._bottom = Math.max(flexLine._bottom, bounds.bottom + lp.effectiveMarginBottom);
            }
            childTop += flexLine._crossSize;
            childBottom -= flexLine._crossSize;
        });
    };
    FlexboxLayout.prototype._layoutSingleChildHorizontal = function (view, flexLine, flexWrap, alignItems, left, top, right, bottom) {
        var lp = view;
        var alignSelf = FlexboxLayout.getAlignSelf(view);
        if (alignSelf !== "auto") {
            alignItems = alignSelf;
        }
        var crossSize = flexLine._crossSize;
        switch (alignItems) {
            case flexbox_layout_common_1.AlignItems.FLEX_START:
            case flexbox_layout_common_1.AlignItems.STRETCH:
                if (flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    view.layout(left, top + lp.effectiveMarginTop, right, bottom + lp.effectiveMarginTop);
                }
                else {
                    view.layout(left, top - lp.effectiveMarginBottom, right, bottom - lp.effectiveMarginBottom);
                }
                break;
            case flexbox_layout_common_1.AlignItems.BASELINE:
                if (flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    var marginTop = flexLine._maxBaseline - FlexboxLayout.getBaseline(view);
                    marginTop = Math.max(marginTop, lp.effectiveMarginTop);
                    view.layout(left, top + marginTop, right, bottom + marginTop);
                }
                else {
                    var marginBottom = flexLine._maxBaseline - view.getMeasuredHeight() + FlexboxLayout.getBaseline(view);
                    marginBottom = Math.max(marginBottom, lp.effectiveMarginBottom);
                    view.layout(left, top - marginBottom, right, bottom - marginBottom);
                }
                break;
            case flexbox_layout_common_1.AlignItems.FLEX_END:
                if (flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    view.layout(left, top + crossSize - view.getMeasuredHeight() - lp.effectiveMarginBottom, right, top + crossSize - lp.effectiveMarginBottom);
                }
                else {
                    view.layout(left, top - crossSize + view.getMeasuredHeight() + lp.effectiveMarginTop, right, bottom - crossSize + view.getMeasuredHeight() + lp.effectiveMarginTop);
                }
                break;
            case flexbox_layout_common_1.AlignItems.CENTER:
                var topFromCrossAxis = (crossSize - view.getMeasuredHeight()) / 2;
                if (flexWrap !== flexbox_layout_common_1.FlexWrap.WRAP_REVERSE) {
                    view.layout(left, top + topFromCrossAxis + lp.effectiveMarginTop - lp.effectiveMarginBottom, right, top + topFromCrossAxis + view.getMeasuredHeight() + lp.effectiveMarginTop
                        - lp.effectiveMarginBottom);
                }
                else {
                    view.layout(left, top - topFromCrossAxis + lp.effectiveMarginTop - lp.effectiveMarginBottom, right, top - topFromCrossAxis + view.getMeasuredHeight() + lp.effectiveMarginTop
                        - lp.effectiveMarginBottom);
                }
                break;
        }
    };
    FlexboxLayout.prototype._layoutVertical = function (isRtl, fromBottomToTop, left, top, right, bottom, insets) {
        var _this = this;
        var paddingLeft = this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectivePaddingBottom + insets.bottom;
        var childLeft = paddingLeft;
        var currentViewIndex = 0;
        var width = right - left;
        var height = bottom - top;
        var childRight = width - paddingRight;
        var childTop;
        var childBottom;
        this._flexLines.forEach(function (flexLine) {
            var spaceBetweenItem = 0.0;
            switch (_this.justifyContent) {
                case flexbox_layout_common_1.JustifyContent.FLEX_START:
                    childTop = paddingTop;
                    childBottom = height - paddingBottom;
                    break;
                case flexbox_layout_common_1.JustifyContent.FLEX_END:
                    childTop = height - flexLine._mainSize + paddingBottom;
                    childBottom = flexLine._mainSize - paddingTop;
                    break;
                case flexbox_layout_common_1.JustifyContent.CENTER:
                    childTop = paddingTop + (height - insets.top - insets.bottom - flexLine._mainSize) / 2.0;
                    childBottom = height - paddingBottom - (height - insets.top - insets.bottom - flexLine._mainSize) / 2.0;
                    break;
                case flexbox_layout_common_1.JustifyContent.SPACE_AROUND:
                    if (flexLine._itemCount !== 0) {
                        spaceBetweenItem = (height - insets.top - insets.bottom - flexLine._mainSize) / flexLine.itemCount;
                    }
                    childTop = paddingTop + spaceBetweenItem / 2.0;
                    childBottom = height - paddingBottom - spaceBetweenItem / 2.0;
                    break;
                case flexbox_layout_common_1.JustifyContent.SPACE_BETWEEN:
                    childTop = paddingTop;
                    var denominator = flexLine.itemCount !== 1 ? flexLine.itemCount - 1 : 1.0;
                    spaceBetweenItem = (height - insets.top - insets.bottom - flexLine.mainSize) / denominator;
                    childBottom = height - paddingBottom;
                    break;
                default:
                    throw new Error("Invalid justifyContent is set: " + _this.justifyContent);
            }
            spaceBetweenItem = Math.max(spaceBetweenItem, 0);
            for (var j = 0; j < flexLine.itemCount; j++) {
                var child = _this._getReorderedChildAt(currentViewIndex);
                if (child === null) {
                    continue;
                }
                else if (child.isCollapsed) {
                    currentViewIndex++;
                    continue;
                }
                var lp = child;
                childTop += lp.effectiveMarginTop;
                childBottom -= lp.effectiveMarginBottom;
                if (isRtl) {
                    if (fromBottomToTop) {
                        _this._layoutSingleChildVertical(child, flexLine, true, _this.alignItems, childRight - child.getMeasuredWidth(), Math.round(childBottom) - child.getMeasuredHeight(), childRight, Math.round(childBottom));
                    }
                    else {
                        _this._layoutSingleChildVertical(child, flexLine, true, _this.alignItems, childRight - child.getMeasuredWidth(), Math.round(childTop), childRight, Math.round(childTop) + child.getMeasuredHeight());
                    }
                }
                else {
                    if (fromBottomToTop) {
                        _this._layoutSingleChildVertical(child, flexLine, false, _this.alignItems, childLeft, Math.round(childBottom) - child.getMeasuredHeight(), childLeft + child.getMeasuredWidth(), Math.round(childBottom));
                    }
                    else {
                        _this._layoutSingleChildVertical(child, flexLine, false, _this.alignItems, childLeft, Math.round(childTop), childLeft + child.getMeasuredWidth(), Math.round(childTop) + child.getMeasuredHeight());
                    }
                }
                childTop += child.getMeasuredHeight() + spaceBetweenItem + lp.effectiveMarginBottom;
                childBottom -= child.getMeasuredHeight() + spaceBetweenItem + lp.effectiveMarginTop;
                currentViewIndex++;
                var bounds = child._getCurrentLayoutBounds();
                flexLine._left = Math.min(flexLine._left, bounds.left - lp.effectiveMarginLeft);
                flexLine._top = Math.min(flexLine._top, bounds.top - lp.effectiveMarginTop);
                flexLine._right = Math.max(flexLine._right, bounds.right + lp.effectiveMarginRight);
                flexLine._bottom = Math.max(flexLine._bottom, bounds.bottom + lp.effectiveMarginBottom);
            }
            childLeft += flexLine.crossSize;
            childRight -= flexLine.crossSize;
        });
    };
    FlexboxLayout.prototype._layoutSingleChildVertical = function (view, flexLine, isRtl, alignItems, left, top, right, bottom) {
        var lp = view;
        var alignSelf = FlexboxLayout.getAlignSelf(view);
        if (alignSelf !== "auto") {
            alignItems = alignSelf;
        }
        var crossSize = flexLine.crossSize;
        switch (alignItems) {
            case flexbox_layout_common_1.AlignItems.FLEX_START:
            case flexbox_layout_common_1.AlignItems.STRETCH:
            case flexbox_layout_common_1.AlignItems.BASELINE:
                if (!isRtl) {
                    view.layout(left + lp.effectiveMarginLeft, top, right + lp.effectiveMarginLeft, bottom);
                }
                else {
                    view.layout(left - lp.effectiveMarginRight, top, right - lp.effectiveMarginRight, bottom);
                }
                break;
            case flexbox_layout_common_1.AlignItems.FLEX_END:
                if (!isRtl) {
                    view.layout(left + crossSize - view.getMeasuredWidth() - lp.effectiveMarginRight, top, right + crossSize - view.getMeasuredWidth() - lp.effectiveMarginRight, bottom);
                }
                else {
                    view.layout(left - crossSize + view.getMeasuredWidth() + lp.effectiveMarginLeft, top, right - crossSize + view.getMeasuredWidth() + lp.effectiveMarginLeft, bottom);
                }
                break;
            case flexbox_layout_common_1.AlignItems.CENTER:
                var leftFromCrossAxis = (crossSize - view.getMeasuredWidth()) / 2;
                if (!isRtl) {
                    view.layout(left + leftFromCrossAxis + lp.effectiveMarginLeft - lp.effectiveMarginRight, top, right + leftFromCrossAxis + lp.effectiveMarginLeft - lp.effectiveMarginRight, bottom);
                }
                else {
                    view.layout(left - leftFromCrossAxis + lp.effectiveMarginLeft - lp.effectiveMarginRight, top, right - leftFromCrossAxis + lp.effectiveMarginLeft - lp.effectiveMarginRight, bottom);
                }
                break;
        }
    };
    FlexboxLayout.getChildMeasureSpec = function (spec, padding, childDimension) {
        var specMode = flexbox_layout_common_1.layout.getMeasureSpecMode(spec);
        var specSize = flexbox_layout_common_1.layout.getMeasureSpecSize(spec);
        var size = Math.max(0, specSize - padding);
        var resultSize = 0;
        var resultMode = 0;
        switch (specMode) {
            case EXACTLY:
                if (childDimension >= 0) {
                    resultSize = childDimension;
                    resultMode = EXACTLY;
                }
                else if (childDimension === MATCH_PARENT) {
                    resultSize = size;
                    resultMode = EXACTLY;
                }
                else if (childDimension === WRAP_CONTENT) {
                    resultSize = size;
                    resultMode = AT_MOST;
                }
                break;
            case AT_MOST:
                if (childDimension >= 0) {
                    resultSize = childDimension;
                    resultMode = EXACTLY;
                }
                else if (childDimension === MATCH_PARENT) {
                    resultSize = size;
                    resultMode = AT_MOST;
                }
                else if (childDimension === WRAP_CONTENT) {
                    resultSize = size;
                    resultMode = AT_MOST;
                }
                break;
            case UNSPECIFIED:
                if (childDimension >= 0) {
                    resultSize = childDimension;
                    resultMode = EXACTLY;
                }
                else if (childDimension === MATCH_PARENT) {
                    resultSize = View_sUseZeroUnspecifiedMeasureSpec ? 0 : size;
                    resultMode = UNSPECIFIED;
                }
                else if (childDimension === WRAP_CONTENT) {
                    resultSize = View_sUseZeroUnspecifiedMeasureSpec ? 0 : size;
                    resultMode = UNSPECIFIED;
                }
                break;
        }
        return flexbox_layout_common_1.layout.makeMeasureSpec(resultSize, resultMode);
    };
    return FlexboxLayout;
}(flexbox_layout_common_1.FlexboxLayoutBase));
exports.FlexboxLayout = FlexboxLayout;
(function (FlexboxLayout) {
    function getBaseline(child) {
        return 0;
    }
    FlexboxLayout.getBaseline = getBaseline;
    function getPaddingStart(child) {
        return child.effectivePaddingLeft;
    }
    FlexboxLayout.getPaddingStart = getPaddingStart;
    function getPaddingEnd(child) {
        return child.effectivePaddingRight;
    }
    FlexboxLayout.getPaddingEnd = getPaddingEnd;
})(FlexboxLayout = exports.FlexboxLayout || (exports.FlexboxLayout = {}));
exports.FlexboxLayout = FlexboxLayout;
//# sourceMappingURL=flexbox-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
function validateArgs(element) {
    if (!element) {
        throw new Error("element cannot be null or undefined.");
    }
    return element;
}
layout_base_1.View.prototype.row = 0;
layout_base_1.View.prototype.col = 0;
layout_base_1.View.prototype.rowSpan = 1;
layout_base_1.View.prototype.colSpan = 1;
function validateItemSpec(itemSpec) {
    if (!itemSpec) {
        throw new Error("Value cannot be undefined.");
    }
    if (itemSpec.owner) {
        throw new Error("itemSpec is already added to GridLayout.");
    }
}
function convertGridLength(value) {
    if (value === GridUnitType.AUTO) {
        return ItemSpec.create(1, GridUnitType.AUTO);
    }
    else if (value.indexOf("*") !== -1) {
        var starCount = parseInt(value.replace("*", "") || "1");
        return ItemSpec.create(starCount, GridUnitType.STAR);
    }
    else if (!isNaN(parseInt(value))) {
        return ItemSpec.create(parseInt(value), GridUnitType.PIXEL);
    }
    else {
        throw new Error("Cannot parse item spec from string: " + value);
    }
}
function parseAndAddItemSpecs(value, func) {
    var arr = value.split(/[\s,]+/);
    for (var i = 0, length_1 = arr.length; i < length_1; i++) {
        var str = arr[i].trim();
        if (str.length > 0) {
            func(convertGridLength(arr[i].trim()));
        }
    }
}
var ItemSpec = (function (_super) {
    __extends(ItemSpec, _super);
    function ItemSpec() {
        var _this = _super.call(this) || this;
        _this._actualLength = 0;
        if (arguments.length === 0) {
            _this._value = 1;
            _this._unitType = GridUnitType.STAR;
        }
        else if (arguments.length === 2) {
            var value = arguments[0];
            var type = arguments[1];
            if (typeof value === "number" && typeof type === "string") {
                if (value < 0 || isNaN(value) || !isFinite(value)) {
                    throw new Error("Value should not be negative, NaN or Infinity: " + value);
                }
                _this._value = value;
                _this._unitType = GridUnitType.parse(type);
            }
            else {
                throw new Error("First argument should be number, second argument should be string.");
            }
        }
        else {
            throw new Error("ItemSpec expects 0 or 2 arguments");
        }
        _this.index = -1;
        return _this;
    }
    ItemSpec.create = function (value, type) {
        var spec = new ItemSpec();
        spec._value = value;
        spec._unitType = type;
        return spec;
    };
    Object.defineProperty(ItemSpec.prototype, "actualLength", {
        get: function () {
            return this._actualLength;
        },
        enumerable: true,
        configurable: true
    });
    ItemSpec.equals = function (value1, value2) {
        return (value1.gridUnitType === value2.gridUnitType) && (value1.value === value2.value) && (value1.owner === value2.owner) && (value1.index === value2.index);
    };
    Object.defineProperty(ItemSpec.prototype, "gridUnitType", {
        get: function () {
            return this._unitType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAbsolute", {
        get: function () {
            return this._unitType === GridUnitType.PIXEL;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isAuto", {
        get: function () {
            return this._unitType === GridUnitType.AUTO;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "isStar", {
        get: function () {
            return this._unitType === GridUnitType.STAR;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ItemSpec.prototype, "value", {
        get: function () {
            return this._value;
        },
        enumerable: true,
        configurable: true
    });
    return ItemSpec;
}(layout_base_1.Observable));
exports.ItemSpec = ItemSpec;
var GridLayoutBase = (function (_super) {
    __extends(GridLayoutBase, _super);
    function GridLayoutBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._rows = new Array();
        _this._cols = new Array();
        return _this;
    }
    GridLayoutBase_1 = GridLayoutBase;
    GridLayoutBase.getColumn = function (element) {
        return validateArgs(element).col;
    };
    GridLayoutBase.setColumn = function (element, value) {
        validateArgs(element).col = value;
    };
    GridLayoutBase.getColumnSpan = function (element) {
        return validateArgs(element).colSpan;
    };
    GridLayoutBase.setColumnSpan = function (element, value) {
        validateArgs(element).colSpan = value;
    };
    GridLayoutBase.getRow = function (element) {
        return validateArgs(element).row;
    };
    GridLayoutBase.setRow = function (element, value) {
        validateArgs(element).row = value;
    };
    GridLayoutBase.getRowSpan = function (element) {
        return validateArgs(element).rowSpan;
    };
    GridLayoutBase.setRowSpan = function (element, value) {
        validateArgs(element).rowSpan = value;
    };
    GridLayoutBase.prototype.addRow = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._rows.push(itemSpec);
        this._onRowAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addColumn = function (itemSpec) {
        validateItemSpec(itemSpec);
        itemSpec.owner = this;
        this._cols.push(itemSpec);
        this._onColumnAdded(itemSpec);
        this.invalidate();
    };
    GridLayoutBase.prototype.addChildAtCell = function (view, row, column, rowSpan, columnSpan) {
        this.addChild(view);
        GridLayoutBase_1.setRow(view, row);
        GridLayoutBase_1.setColumn(view, column);
        if (rowSpan) {
            GridLayoutBase_1.setRowSpan(view, rowSpan);
        }
        if (columnSpan) {
            GridLayoutBase_1.setColumnSpan(view, columnSpan);
        }
    };
    GridLayoutBase.prototype.removeRow = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._rows.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Row is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._rows.splice(index, 1);
        this._onRowRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumn = function (itemSpec) {
        if (!itemSpec) {
            throw new Error("Value is null.");
        }
        var index = this._cols.indexOf(itemSpec);
        if (itemSpec.owner !== this || index < 0) {
            throw new Error("Column is not child of this GridLayout");
        }
        itemSpec.index = -1;
        this._cols.splice(index, 1);
        this._onColumnRemoved(itemSpec, index);
        this.invalidate();
    };
    GridLayoutBase.prototype.removeColumns = function () {
        for (var i = this._cols.length - 1; i >= 0; i--) {
            var colSpec = this._cols[i];
            this._onColumnRemoved(colSpec, i);
            colSpec.index = -1;
        }
        this._cols.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.removeRows = function () {
        for (var i = this._rows.length - 1; i >= 0; i--) {
            var rowSpec = this._rows[i];
            this._onRowRemoved(rowSpec, i);
            rowSpec.index = -1;
        }
        this._rows.length = 0;
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onRowSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype.onColumnSpanChanged = function (element, oldValue, newValue) {
        this.invalidate();
    };
    GridLayoutBase.prototype._onRowAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onColumnAdded = function (itemSpec) {
    };
    GridLayoutBase.prototype._onRowRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype._onColumnRemoved = function (itemSpec, index) {
    };
    GridLayoutBase.prototype.getColumns = function () {
        return this._cols.slice();
    };
    GridLayoutBase.prototype.getRows = function () {
        return this._rows.slice();
    };
    Object.defineProperty(GridLayoutBase.prototype, "columnsInternal", {
        get: function () {
            return this._cols;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "rowsInternal", {
        get: function () {
            return this._rows;
        },
        enumerable: true,
        configurable: true
    });
    GridLayoutBase.prototype.invalidate = function () {
    };
    Object.defineProperty(GridLayoutBase.prototype, "rows", {
        set: function (value) {
            var _this = this;
            this.removeRows();
            parseAndAddItemSpecs(value, function (spec) { return _this.addRow(spec); });
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GridLayoutBase.prototype, "columns", {
        set: function (value) {
            var _this = this;
            this.removeColumns();
            parseAndAddItemSpecs(value, function (spec) { return _this.addColumn(spec); });
        },
        enumerable: true,
        configurable: true
    });
    var GridLayoutBase_1;
    GridLayoutBase = GridLayoutBase_1 = __decorate([
        layout_base_1.CSSType("GridLayout")
    ], GridLayoutBase);
    return GridLayoutBase;
}(layout_base_1.LayoutBase));
exports.GridLayoutBase = GridLayoutBase;
GridLayoutBase.prototype.recycleNativeView = "auto";
exports.columnProperty = new layout_base_1.Property({
    name: "col", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.columnProperty.register(layout_base_1.View);
exports.columnSpanProperty = new layout_base_1.Property({
    name: "colSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onColumnSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.columnSpanProperty.register(layout_base_1.View);
exports.rowProperty = new layout_base_1.Property({
    name: "row", defaultValue: 0,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(0, parseInt(v)); }
});
exports.rowProperty.register(layout_base_1.View);
exports.rowSpanProperty = new layout_base_1.Property({
    name: "rowSpan", defaultValue: 1,
    valueChanged: function (target, oldValue, newValue) {
        var grid = target.parent;
        if (grid instanceof GridLayoutBase) {
            grid.onRowSpanChanged(target, oldValue, newValue);
        }
    },
    valueConverter: function (v) { return Math.max(1, parseInt(v)); }
});
exports.rowSpanProperty.register(layout_base_1.View);
var GridUnitType;
(function (GridUnitType) {
    GridUnitType.PIXEL = "pixel";
    GridUnitType.STAR = "star";
    GridUnitType.AUTO = "auto";
    GridUnitType.isValid = layout_base_1.makeValidator(GridUnitType.PIXEL, GridUnitType.STAR, GridUnitType.AUTO);
    GridUnitType.parse = layout_base_1.makeParser(GridUnitType.isValid);
})(GridUnitType = exports.GridUnitType || (exports.GridUnitType = {}));
//# sourceMappingURL=grid-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var grid_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/grid-layout/grid-layout-common.js"));
var GridLayout = (function (_super) {
    __extends(GridLayout, _super);
    function GridLayout() {
        var _this = _super.call(this) || this;
        _this.columnOffsets = new Array();
        _this.rowOffsets = new Array();
        _this.map = new Map();
        _this.helper = new MeasureHelper(_this);
        return _this;
    }
    GridLayout.prototype._onRowAdded = function (itemSpec) {
        this.helper.rows.push(new ItemGroup(itemSpec));
    };
    GridLayout.prototype._onColumnAdded = function (itemSpec) {
        this.helper.columns.push(new ItemGroup(itemSpec));
    };
    GridLayout.prototype._onRowRemoved = function (itemSpec, index) {
        this.helper.rows[index].children.length = 0;
        this.helper.rows.splice(index, 1);
    };
    GridLayout.prototype._onColumnRemoved = function (itemSpec, index) {
        this.helper.columns[index].children.length = 0;
        this.helper.columns.splice(index, 1);
    };
    GridLayout.prototype._registerLayoutChild = function (child) {
        this.addToMap(child);
    };
    GridLayout.prototype._unregisterLayoutChild = function (child) {
        this.removeFromMap(child);
    };
    GridLayout.prototype.invalidate = function () {
        _super.prototype.invalidate.call(this);
        this.requestLayout();
    };
    GridLayout.prototype.getColumnIndex = function (view) {
        return Math.max(0, Math.min(GridLayout.getColumn(view), this.columnsInternal.length - 1));
    };
    GridLayout.prototype.getRowIndex = function (view) {
        return Math.max(0, Math.min(GridLayout.getRow(view), this.rowsInternal.length - 1));
    };
    GridLayout.prototype.getColumnSpan = function (view, columnIndex) {
        return Math.max(1, Math.min(GridLayout.getColumnSpan(view), this.columnsInternal.length - columnIndex));
    };
    GridLayout.prototype.getRowSpan = function (view, rowIndex) {
        return Math.max(1, Math.min(GridLayout.getRowSpan(view), this.rowsInternal.length - rowIndex));
    };
    GridLayout.prototype.getColumnSpec = function (view) {
        return this.columnsInternal[this.getColumnIndex(view)] || this.helper.singleColumn;
    };
    GridLayout.prototype.getRowSpec = function (view) {
        return this.rowsInternal[this.getRowIndex(view)] || this.helper.singleRow;
    };
    GridLayout.prototype.updateMeasureSpecs = function (child, measureSpec) {
        var column = this.getColumnSpec(child);
        var columnIndex = this.getColumnIndex(child);
        var columnSpan = this.getColumnSpan(child, columnIndex);
        var row = this.getRowSpec(child);
        var rowIndex = this.getRowIndex(child);
        var rowSpan = this.getRowSpan(child, rowIndex);
        measureSpec.setColumn(column);
        measureSpec.setColumnIndex(columnIndex);
        measureSpec.setColumnSpan(columnSpan);
        measureSpec.setRow(row);
        measureSpec.setRowIndex(rowIndex);
        measureSpec.setRowSpan(rowSpan);
        measureSpec.autoColumnsCount = 0;
        measureSpec.autoRowsCount = 0;
        measureSpec.measured = false;
        measureSpec.pixelHeight = 0;
        measureSpec.pixelWidth = 0;
        measureSpec.starColumnsCount = 0;
        measureSpec.starRowsCount = 0;
    };
    GridLayout.prototype.addToMap = function (child) {
        this.map.set(child, new MeasureSpecs(child));
    };
    GridLayout.prototype.removeFromMap = function (child) {
        this.map.delete(child);
    };
    GridLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = 0;
        var measureHeight = 0;
        var width = grid_layout_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = grid_layout_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = grid_layout_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = grid_layout_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalPaddingsAndMargins = this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalPaddingsAndMargins = this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var infinityWidth = widthMode === grid_layout_common_1.layout.UNSPECIFIED;
        var infinityHeight = heightMode === grid_layout_common_1.layout.UNSPECIFIED;
        this.helper.width = Math.max(0, width - horizontalPaddingsAndMargins);
        this.helper.height = Math.max(0, height - verticalPaddingsAndMargins);
        this.helper.stretchedHorizontally = widthMode === grid_layout_common_1.layout.EXACTLY || (this.horizontalAlignment === "stretch" && !infinityWidth);
        this.helper.stretchedVertically = heightMode === grid_layout_common_1.layout.EXACTLY || (this.verticalAlignment === "stretch" && !infinityHeight);
        this.helper.setInfinityWidth(infinityWidth);
        this.helper.setInfinityHeight(infinityHeight);
        this.helper.clearMeasureSpecs();
        this.helper.init();
        this.eachLayoutChild(function (child, last) {
            var measureSpecs = _this.map.get(child);
            if (!measureSpecs) {
                return;
            }
            _this.updateMeasureSpecs(child, measureSpecs);
            _this.helper.addMeasureSpec(measureSpecs);
        });
        this.helper.measure();
        measureWidth = this.helper.measuredWidth + horizontalPaddingsAndMargins;
        measureHeight = this.helper.measuredHeight + verticalPaddingsAndMargins;
        measureWidth = Math.max(measureWidth, this.effectiveMinWidth);
        measureHeight = Math.max(measureHeight, this.effectiveMinHeight);
        var widthSizeAndState = grid_layout_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightSizeAndState = grid_layout_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthSizeAndState, heightSizeAndState);
    };
    GridLayout.prototype.onLayout = function (left, top, right, bottom) {
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        var insets = this.getSafeAreaInsets();
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        this.columnOffsets.length = 0;
        this.rowOffsets.length = 0;
        this.columnOffsets.push(paddingLeft);
        this.rowOffsets.push(paddingTop);
        var offset = this.columnOffsets[0];
        var roundedOffset = paddingLeft;
        var roundedLength = 0;
        var actualLength = 0;
        for (var i = 0, size = this.helper.columns.length; i < size; i++) {
            var columnGroup = this.helper.columns[i];
            offset += columnGroup.length;
            actualLength = offset - roundedOffset;
            roundedLength = Math.round(actualLength);
            columnGroup.rowOrColumn._actualLength = grid_layout_common_1.layout.round(grid_layout_common_1.layout.toDeviceIndependentPixels(roundedLength));
            roundedOffset += roundedLength;
            this.columnOffsets.push(roundedOffset);
        }
        offset = this.rowOffsets[0];
        roundedOffset = paddingTop;
        roundedLength = 0;
        actualLength = 0;
        for (var i = 0, size = this.helper.rows.length; i < size; i++) {
            var rowGroup = this.helper.rows[i];
            offset += rowGroup.length;
            actualLength = offset - roundedOffset;
            roundedLength = Math.round(actualLength);
            rowGroup.rowOrColumn._actualLength = grid_layout_common_1.layout.round(grid_layout_common_1.layout.toDeviceIndependentPixels(roundedLength));
            roundedOffset += roundedLength;
            this.rowOffsets.push(roundedOffset);
        }
        for (var i = 0, columns = this.helper.columns.length; i < columns; i++) {
            var columnGroup = this.helper.columns[i];
            for (var j = 0, children = columnGroup.children.length; j < children; j++) {
                var measureSpec = columnGroup.children[j];
                var childLeft = this.columnOffsets[measureSpec.getColumnIndex()];
                var childRight = this.columnOffsets[measureSpec.getColumnIndex() + measureSpec.getColumnSpan()];
                var childTop = this.rowOffsets[measureSpec.getRowIndex()];
                var childBottom = this.rowOffsets[measureSpec.getRowIndex() + measureSpec.getRowSpan()];
                grid_layout_common_1.View.layoutChild(this, measureSpec.child, childLeft, childTop, childRight, childBottom);
            }
        }
    };
    return GridLayout;
}(grid_layout_common_1.GridLayoutBase));
exports.GridLayout = GridLayout;
var MeasureSpecs = (function () {
    function MeasureSpecs(child) {
        this._columnSpan = 1;
        this._rowSpan = 1;
        this.pixelWidth = 0;
        this.pixelHeight = 0;
        this.starColumnsCount = 0;
        this.starRowsCount = 0;
        this.autoColumnsCount = 0;
        this.autoRowsCount = 0;
        this.measured = false;
        this.columnIndex = 0;
        this.rowIndex = 0;
        this.child = child;
    }
    MeasureSpecs.prototype.getSpanned = function () {
        return this._columnSpan > 1 || this._rowSpan > 1;
    };
    MeasureSpecs.prototype.getIsStar = function () {
        return this.starRowsCount > 0 || this.starColumnsCount > 0;
    };
    MeasureSpecs.prototype.getColumnSpan = function () {
        return this._columnSpan;
    };
    MeasureSpecs.prototype.getRowSpan = function () {
        return this._rowSpan;
    };
    MeasureSpecs.prototype.setRowSpan = function (value) {
        this._rowSpan = Math.max(1, value);
    };
    MeasureSpecs.prototype.setColumnSpan = function (value) {
        this._columnSpan = Math.max(1, value);
    };
    MeasureSpecs.prototype.getRowIndex = function () {
        return this.rowIndex;
    };
    MeasureSpecs.prototype.getColumnIndex = function () {
        return this.columnIndex;
    };
    MeasureSpecs.prototype.setRowIndex = function (value) {
        this.rowIndex = value;
    };
    MeasureSpecs.prototype.setColumnIndex = function (value) {
        this.columnIndex = value;
    };
    MeasureSpecs.prototype.getRow = function () {
        return this.row;
    };
    MeasureSpecs.prototype.getColumn = function () {
        return this.column;
    };
    MeasureSpecs.prototype.setRow = function (value) {
        this.row = value;
    };
    MeasureSpecs.prototype.setColumn = function (value) {
        this.column = value;
    };
    return MeasureSpecs;
}());
var ItemGroup = (function () {
    function ItemGroup(spec) {
        this.length = 0;
        this.measuredCount = 0;
        this.children = new Array();
        this.measureToFix = 0;
        this.currentMeasureToFixCount = 0;
        this.infinityLength = false;
        this.rowOrColumn = spec;
    }
    ItemGroup.prototype.setIsLengthInfinity = function (infinityLength) {
        this.infinityLength = infinityLength;
    };
    ItemGroup.prototype.init = function (density) {
        this.measuredCount = 0;
        this.currentMeasureToFixCount = 0;
        this.length = this.rowOrColumn.isAbsolute ? this.rowOrColumn.value * density : 0;
    };
    ItemGroup.prototype.getAllMeasured = function () {
        return this.measuredCount === this.children.length;
    };
    ItemGroup.prototype.getCanBeFixed = function () {
        return this.currentMeasureToFixCount === this.measureToFix;
    };
    ItemGroup.prototype.getIsAuto = function () {
        return this.rowOrColumn.isAuto || (this.rowOrColumn.isStar && this.infinityLength);
    };
    ItemGroup.prototype.getIsStar = function () {
        return this.rowOrColumn.isStar && !this.infinityLength;
    };
    ItemGroup.prototype.getIsAbsolute = function () {
        return this.rowOrColumn.isAbsolute;
    };
    return ItemGroup;
}());
var MeasureHelper = (function () {
    function MeasureHelper(grid) {
        this.infinity = grid_layout_common_1.layout.makeMeasureSpec(0, grid_layout_common_1.layout.UNSPECIFIED);
        this.rows = new Array();
        this.columns = new Array();
        this.width = 0;
        this.height = 0;
        this.stretchedHorizontally = false;
        this.stretchedVertically = false;
        this.infinityWidth = false;
        this.infinityHeight = false;
        this.minColumnStarValue = 0;
        this.maxColumnStarValue = 0;
        this.minRowStarValue = 0;
        this.maxRowStarValue = 0;
        this.measuredWidth = 0;
        this.measuredHeight = 0;
        this.fakeRowAdded = false;
        this.fakeColumnAdded = false;
        this.grid = grid;
        this.singleRow = new grid_layout_common_1.ItemSpec();
        this.singleColumn = new grid_layout_common_1.ItemSpec();
        this.singleRowGroup = new ItemGroup(this.singleRow);
        this.singleColumnGroup = new ItemGroup(this.singleColumn);
    }
    MeasureHelper.prototype.setInfinityWidth = function (value) {
        this.infinityWidth = value;
        for (var i = 0, size = this.columns.length; i < size; i++) {
            var columnGroup = this.columns[i];
            columnGroup.setIsLengthInfinity(value);
        }
    };
    MeasureHelper.prototype.setInfinityHeight = function (value) {
        this.infinityHeight = value;
        for (var i = 0, size = this.rows.length; i < size; i++) {
            var rowGroup = this.rows[i];
            rowGroup.setIsLengthInfinity(value);
        }
    };
    MeasureHelper.prototype.addMeasureSpec = function (measureSpec) {
        var size = measureSpec.getColumnIndex() + measureSpec.getColumnSpan();
        for (var i = measureSpec.getColumnIndex(); i < size; i++) {
            var columnGroup = this.columns[i];
            if (columnGroup.getIsAuto()) {
                measureSpec.autoColumnsCount++;
            }
            else if (columnGroup.getIsStar()) {
                measureSpec.starColumnsCount += columnGroup.rowOrColumn.value;
            }
            else if (columnGroup.getIsAbsolute()) {
                measureSpec.pixelWidth += grid_layout_common_1.layout.toDevicePixels(columnGroup.rowOrColumn.value);
            }
        }
        if (measureSpec.autoColumnsCount > 0 && measureSpec.starColumnsCount === 0) {
            for (var i = measureSpec.getColumnIndex(); i < size; i++) {
                var columnGroup = this.columns[i];
                if (columnGroup.getIsAuto()) {
                    columnGroup.measureToFix++;
                }
            }
        }
        size = measureSpec.getRowIndex() + measureSpec.getRowSpan();
        for (var i = measureSpec.getRowIndex(); i < size; i++) {
            var rowGroup = this.rows[i];
            if (rowGroup.getIsAuto()) {
                measureSpec.autoRowsCount++;
            }
            else if (rowGroup.getIsStar()) {
                measureSpec.starRowsCount += rowGroup.rowOrColumn.value;
            }
            else if (rowGroup.getIsAbsolute()) {
                measureSpec.pixelHeight += grid_layout_common_1.layout.toDevicePixels(rowGroup.rowOrColumn.value);
            }
        }
        if (measureSpec.autoRowsCount > 0 && measureSpec.starRowsCount === 0) {
            for (var i = measureSpec.getRowIndex(); i < size; i++) {
                var rowGroup = this.rows[i];
                if (rowGroup.getIsAuto()) {
                    rowGroup.measureToFix++;
                }
            }
        }
        this.columns[measureSpec.getColumnIndex()].children.push(measureSpec);
        this.rows[measureSpec.getRowIndex()].children.push(measureSpec);
    };
    MeasureHelper.prototype.clearMeasureSpecs = function () {
        for (var i = 0, size = this.columns.length; i < size; i++) {
            this.columns[i].children.length = 0;
        }
        for (var i = 0, size = this.rows.length; i < size; i++) {
            this.rows[i].children.length = 0;
        }
    };
    MeasureHelper.initList = function (list) {
        var density = grid_layout_common_1.layout.getDisplayDensity();
        for (var i = 0, size = list.length; i < size; i++) {
            var item = list[i];
            item.init(density);
        }
    };
    MeasureHelper.prototype.init = function () {
        var rows = this.rows.length;
        if (rows === 0) {
            this.singleRowGroup.setIsLengthInfinity(this.infinityHeight);
            this.rows.push(this.singleRowGroup);
            this.fakeRowAdded = true;
        }
        else if (rows > 1 && this.fakeRowAdded) {
            this.rows.splice(0, 1);
            this.fakeRowAdded = false;
        }
        var cols = this.columns.length;
        if (cols === 0) {
            this.fakeColumnAdded = true;
            this.singleColumnGroup.setIsLengthInfinity(this.infinityWidth);
            this.columns.push(this.singleColumnGroup);
        }
        else if (cols > 1 && this.fakeColumnAdded) {
            this.columns.splice(0, 1);
            this.fakeColumnAdded = false;
        }
        MeasureHelper.initList(this.rows);
        MeasureHelper.initList(this.columns);
        this.minColumnStarValue = -1;
        this.minRowStarValue = -1;
        this.maxColumnStarValue = -1;
        this.maxRowStarValue = -1;
    };
    MeasureHelper.prototype.itemMeasured = function (measureSpec, isFakeMeasure) {
        if (!isFakeMeasure) {
            this.columns[measureSpec.getColumnIndex()].measuredCount++;
            this.rows[measureSpec.getRowIndex()].measuredCount++;
            measureSpec.measured = true;
        }
        if (measureSpec.autoColumnsCount > 0 && measureSpec.starColumnsCount === 0) {
            var size = measureSpec.getColumnIndex() + measureSpec.getColumnSpan();
            for (var i = measureSpec.getColumnIndex(); i < size; i++) {
                var columnGroup = this.columns[i];
                if (columnGroup.getIsAuto()) {
                    columnGroup.currentMeasureToFixCount++;
                }
            }
        }
        if (measureSpec.autoRowsCount > 0 && measureSpec.starRowsCount === 0) {
            var size = measureSpec.getRowIndex() + measureSpec.getRowSpan();
            for (var i = measureSpec.getRowIndex(); i < size; i++) {
                var rowGroup = this.rows[i];
                if (rowGroup.getIsAuto()) {
                    rowGroup.currentMeasureToFixCount++;
                }
            }
        }
    };
    MeasureHelper.prototype.fixColumns = function () {
        var currentColumnWidth = 0;
        var columnStarCount = 0;
        var columnCount = this.columns.length;
        for (var i = 0; i < columnCount; i++) {
            var item = this.columns[i];
            if (item.rowOrColumn.isStar) {
                columnStarCount += item.rowOrColumn.value;
            }
            else {
                currentColumnWidth += item.length;
            }
        }
        var widthForStarColumns = Math.max(0, this.width - currentColumnWidth);
        this.maxColumnStarValue = columnStarCount > 0 ? widthForStarColumns / columnStarCount : 0;
        MeasureHelper.updateStarLength(this.columns, this.maxColumnStarValue);
    };
    MeasureHelper.prototype.fixRows = function () {
        var currentRowHeight = 0;
        var rowStarCount = 0;
        var rowCount = this.rows.length;
        for (var i = 0; i < rowCount; i++) {
            var item = this.rows[i];
            if (item.rowOrColumn.isStar) {
                rowStarCount += item.rowOrColumn.value;
            }
            else {
                currentRowHeight += item.length;
            }
        }
        var heightForStarRows = Math.max(0, this.height - currentRowHeight);
        this.maxRowStarValue = rowStarCount > 0 ? heightForStarRows / rowStarCount : 0;
        MeasureHelper.updateStarLength(this.rows, this.maxRowStarValue);
    };
    MeasureHelper.updateStarLength = function (list, starValue) {
        var offset = 0;
        var roundedOffset = 0;
        for (var i = 0, rowCount = list.length; i < rowCount; i++) {
            var item = list[i];
            if (item.getIsStar()) {
                offset += item.rowOrColumn.value * starValue;
                var actualLength = offset - roundedOffset;
                var roundedLength = Math.round(actualLength);
                item.length = roundedLength;
                roundedOffset += roundedLength;
            }
        }
    };
    MeasureHelper.prototype.fakeMeasure = function () {
        for (var i = 0, size = this.columns.length; i < size; i++) {
            var columnGroup = this.columns[i];
            if (columnGroup.getAllMeasured()) {
                continue;
            }
            for (var j = 0, childrenCount = columnGroup.children.length; j < childrenCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (measureSpec.starRowsCount > 0 && measureSpec.autoColumnsCount > 0 && measureSpec.starColumnsCount === 0) {
                    this.measureChild(measureSpec, true);
                }
            }
        }
    };
    MeasureHelper.prototype.measureFixedColumnsNoStarRows = function () {
        for (var i = 0, size = this.columns.length; i < size; i++) {
            var columnGroup = this.columns[i];
            for (var j = 0, childrenCount = columnGroup.children.length; j < childrenCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (measureSpec.starColumnsCount > 0 && measureSpec.starRowsCount === 0) {
                    this.measureChildFixedColumns(measureSpec);
                }
            }
        }
    };
    MeasureHelper.prototype.measureNoStarColumnsFixedRows = function () {
        for (var i = 0, size = this.columns.length; i < size; i++) {
            var columnGroup = this.columns[i];
            for (var j = 0, childrenCount = columnGroup.children.length; j < childrenCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (measureSpec.starRowsCount > 0 && measureSpec.starColumnsCount === 0) {
                    this.measureChildFixedRows(measureSpec);
                }
            }
        }
    };
    MeasureHelper.canFix = function (list) {
        for (var i = 0, size = list.length; i < size; i++) {
            var item = list[i];
            if (!item.getCanBeFixed()) {
                return false;
            }
        }
        return true;
    };
    MeasureHelper.getMeasureLength = function (list) {
        var result = 0;
        for (var i = 0, size = list.length; i < size; i++) {
            var item = list[i];
            result += item.length;
        }
        return result;
    };
    MeasureHelper.prototype.measure = function () {
        var size = this.columns.length;
        for (var i = 0; i < size; i++) {
            var columnGroup = this.columns[i];
            for (var j = 0, childrenCount = columnGroup.children.length; j < childrenCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (measureSpec.getIsStar() || measureSpec.getSpanned()) {
                    continue;
                }
                this.measureChild(measureSpec, false);
            }
        }
        for (var i = 0; i < size; i++) {
            var columnGroup = this.columns[i];
            for (var j = 0, childrenCount = columnGroup.children.length; j < childrenCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (measureSpec.getIsStar() || !measureSpec.getSpanned()) {
                    continue;
                }
                this.measureChild(measureSpec, false);
            }
        }
        var fixColumns = MeasureHelper.canFix(this.columns);
        var fixRows = MeasureHelper.canFix(this.rows);
        if (fixColumns) {
            this.fixColumns();
        }
        if (fixRows) {
            this.fixRows();
        }
        if (!fixColumns && !fixRows) {
            this.fakeMeasure();
            this.fixColumns();
            this.measureFixedColumnsNoStarRows();
            this.fixRows();
        }
        else if (fixColumns && !fixRows) {
            this.measureFixedColumnsNoStarRows();
            this.fixRows();
        }
        else if (!fixColumns && fixRows) {
            this.measureNoStarColumnsFixedRows();
            this.fixColumns();
        }
        size = this.columns.length;
        for (var i = 0; i < size; i++) {
            var columnGroup = this.columns[i];
            for (var j = 0, childCount = columnGroup.children.length; j < childCount; j++) {
                var measureSpec = columnGroup.children[j];
                if (!measureSpec.measured) {
                    this.measureChildFixedColumnsAndRows(measureSpec);
                }
            }
        }
        if (!this.stretchedHorizontally && this.minColumnStarValue !== -1 && this.minColumnStarValue < this.maxColumnStarValue) {
            MeasureHelper.updateStarLength(this.columns, this.minColumnStarValue);
        }
        if (!this.stretchedVertically && this.minRowStarValue !== -1 && this.minRowStarValue < this.maxRowStarValue) {
            MeasureHelper.updateStarLength(this.rows, this.minRowStarValue);
        }
        this.measuredWidth = MeasureHelper.getMeasureLength(this.columns);
        this.measuredHeight = MeasureHelper.getMeasureLength(this.rows);
    };
    MeasureHelper.prototype.measureChild = function (measureSpec, isFakeMeasure) {
        var widthMeasureSpec = (measureSpec.autoColumnsCount > 0) ? this.infinity : grid_layout_common_1.layout.makeMeasureSpec(measureSpec.pixelWidth, grid_layout_common_1.layout.EXACTLY);
        var heightMeasureSpec = (isFakeMeasure || measureSpec.autoRowsCount > 0) ? this.infinity : grid_layout_common_1.layout.makeMeasureSpec(measureSpec.pixelHeight, grid_layout_common_1.layout.EXACTLY);
        var childSize = grid_layout_common_1.View.measureChild(this.grid, measureSpec.child, widthMeasureSpec, heightMeasureSpec);
        var childMeasuredWidth = childSize.measuredWidth;
        var childMeasuredHeight = childSize.measuredHeight;
        var columnSpanEnd = measureSpec.getColumnIndex() + measureSpec.getColumnSpan();
        var rowSpanEnd = measureSpec.getRowIndex() + measureSpec.getRowSpan();
        if (measureSpec.autoColumnsCount > 0) {
            var remainingSpace = childMeasuredWidth;
            for (var i = measureSpec.getColumnIndex(); i < columnSpanEnd; i++) {
                var columnGroup = this.columns[i];
                remainingSpace -= columnGroup.length;
            }
            if (remainingSpace > 0) {
                var growSize = remainingSpace / measureSpec.autoColumnsCount;
                for (var i = measureSpec.getColumnIndex(); i < columnSpanEnd; i++) {
                    var columnGroup = this.columns[i];
                    if (columnGroup.getIsAuto()) {
                        columnGroup.length += growSize;
                    }
                }
            }
        }
        if (!isFakeMeasure && measureSpec.autoRowsCount > 0) {
            var remainingSpace = childMeasuredHeight;
            for (var i = measureSpec.getRowIndex(); i < rowSpanEnd; i++) {
                var rowGroup = this.rows[i];
                remainingSpace -= rowGroup.length;
            }
            if (remainingSpace > 0) {
                var growSize = remainingSpace / measureSpec.autoRowsCount;
                for (var i = measureSpec.getRowIndex(); i < rowSpanEnd; i++) {
                    var rowGroup = this.rows[i];
                    if (rowGroup.getIsAuto()) {
                        rowGroup.length += growSize;
                    }
                }
            }
        }
        this.itemMeasured(measureSpec, isFakeMeasure);
    };
    MeasureHelper.prototype.measureChildFixedColumns = function (measureSpec) {
        var columnIndex = measureSpec.getColumnIndex();
        var columnSpanEnd = columnIndex + measureSpec.getColumnSpan();
        var rowIndex = measureSpec.getRowIndex();
        var rowSpanEnd = rowIndex + measureSpec.getRowSpan();
        var measureWidth = 0;
        var growSize = 0;
        for (var i = columnIndex; i < columnSpanEnd; i++) {
            var columnGroup = this.columns[i];
            measureWidth += columnGroup.length;
        }
        var widthMeasureSpec = grid_layout_common_1.layout.makeMeasureSpec(measureWidth, this.stretchedHorizontally ? grid_layout_common_1.layout.EXACTLY : grid_layout_common_1.layout.AT_MOST);
        var heightMeasureSpec = (measureSpec.autoRowsCount > 0) ? this.infinity : grid_layout_common_1.layout.makeMeasureSpec(measureSpec.pixelHeight, grid_layout_common_1.layout.EXACTLY);
        var childSize = grid_layout_common_1.View.measureChild(this.grid, measureSpec.child, widthMeasureSpec, heightMeasureSpec);
        var childMeasuredWidth = childSize.measuredWidth;
        var childMeasuredHeight = childSize.measuredHeight;
        this.updateMinColumnStarValueIfNeeded(measureSpec, childMeasuredWidth);
        if (measureSpec.autoRowsCount > 0) {
            var remainingSpace = childMeasuredHeight;
            for (var i = rowIndex; i < rowSpanEnd; i++) {
                var rowGroup = this.rows[i];
                remainingSpace -= rowGroup.length;
            }
            if (remainingSpace > 0) {
                growSize = remainingSpace / measureSpec.autoRowsCount;
                for (var i = rowIndex; i < rowSpanEnd; i++) {
                    var rowGroup = this.rows[i];
                    if (rowGroup.getIsAuto()) {
                        rowGroup.length += growSize;
                    }
                }
            }
        }
        this.itemMeasured(measureSpec, false);
    };
    MeasureHelper.prototype.measureChildFixedRows = function (measureSpec) {
        var columnIndex = measureSpec.getColumnIndex();
        var columnSpanEnd = columnIndex + measureSpec.getColumnSpan();
        var rowIndex = measureSpec.getRowIndex();
        var rowSpanEnd = rowIndex + measureSpec.getRowSpan();
        var measureHeight = 0;
        for (var i = rowIndex; i < rowSpanEnd; i++) {
            var rowGroup = this.rows[i];
            measureHeight += rowGroup.length;
        }
        var widthMeasureSpec = (measureSpec.autoColumnsCount > 0) ? this.infinity : grid_layout_common_1.layout.makeMeasureSpec(measureSpec.pixelWidth, grid_layout_common_1.layout.EXACTLY);
        var heightMeasureSpec = grid_layout_common_1.layout.makeMeasureSpec(measureHeight, this.stretchedVertically ? grid_layout_common_1.layout.EXACTLY : grid_layout_common_1.layout.AT_MOST);
        var childSize = grid_layout_common_1.View.measureChild(this.grid, measureSpec.child, widthMeasureSpec, heightMeasureSpec);
        var childMeasuredWidth = childSize.measuredWidth;
        var childMeasuredHeight = childSize.measuredHeight;
        var remainingSpace = 0;
        var growSize = 0;
        if (measureSpec.autoColumnsCount > 0) {
            remainingSpace = childMeasuredWidth;
            for (var i = columnIndex; i < columnSpanEnd; i++) {
                var columnGroup = this.columns[i];
                remainingSpace -= columnGroup.length;
            }
            if (remainingSpace > 0) {
                growSize = remainingSpace / measureSpec.autoColumnsCount;
                for (var i = columnIndex; i < columnSpanEnd; i++) {
                    var columnGroup = this.columns[i];
                    if (columnGroup.getIsAuto()) {
                        columnGroup.length += growSize;
                    }
                }
            }
        }
        this.updateMinRowStarValueIfNeeded(measureSpec, childMeasuredHeight);
        this.itemMeasured(measureSpec, false);
    };
    MeasureHelper.prototype.measureChildFixedColumnsAndRows = function (measureSpec) {
        var columnIndex = measureSpec.getColumnIndex();
        var columnSpanEnd = columnIndex + measureSpec.getColumnSpan();
        var rowIndex = measureSpec.getRowIndex();
        var rowSpanEnd = rowIndex + measureSpec.getRowSpan();
        var measureWidth = 0;
        for (var i = columnIndex; i < columnSpanEnd; i++) {
            var columnGroup = this.columns[i];
            measureWidth += columnGroup.length;
        }
        var measureHeight = 0;
        for (var i = rowIndex; i < rowSpanEnd; i++) {
            var rowGroup = this.rows[i];
            measureHeight += rowGroup.length;
        }
        var widthMeasureSpec = grid_layout_common_1.layout.makeMeasureSpec(measureWidth, (measureSpec.starColumnsCount > 0 && !this.stretchedHorizontally) ? grid_layout_common_1.layout.AT_MOST : grid_layout_common_1.layout.EXACTLY);
        var heightMeasureSpec = grid_layout_common_1.layout.makeMeasureSpec(measureHeight, (measureSpec.starRowsCount > 0 && !this.stretchedVertically) ? grid_layout_common_1.layout.AT_MOST : grid_layout_common_1.layout.EXACTLY);
        var childSize = grid_layout_common_1.View.measureChild(this.grid, measureSpec.child, widthMeasureSpec, heightMeasureSpec);
        var childMeasuredWidth = childSize.measuredWidth;
        var childMeasuredHeight = childSize.measuredHeight;
        this.updateMinColumnStarValueIfNeeded(measureSpec, childMeasuredWidth);
        this.updateMinRowStarValueIfNeeded(measureSpec, childMeasuredHeight);
        this.itemMeasured(measureSpec, false);
    };
    MeasureHelper.prototype.updateMinRowStarValueIfNeeded = function (measureSpec, childMeasuredHeight) {
        if (!this.stretchedVertically && measureSpec.starRowsCount > 0) {
            var remainingSpace = childMeasuredHeight;
            var rowIndex = measureSpec.getRowIndex();
            var rowSpanEnd = rowIndex + measureSpec.getRowSpan();
            for (var i = rowIndex; i < rowSpanEnd; i++) {
                var rowGroup = this.rows[i];
                if (!rowGroup.getIsStar()) {
                    remainingSpace -= rowGroup.length;
                }
            }
            if (remainingSpace > 0) {
                this.minRowStarValue = Math.max(remainingSpace / measureSpec.starRowsCount, this.minRowStarValue);
            }
        }
    };
    MeasureHelper.prototype.updateMinColumnStarValueIfNeeded = function (measureSpec, childMeasuredWidth) {
        if (!this.stretchedHorizontally && measureSpec.starColumnsCount > 0) {
            var remainingSpace = childMeasuredWidth;
            var columnIndex = measureSpec.getColumnIndex();
            var columnSpanEnd = columnIndex + measureSpec.getColumnSpan();
            for (var i = columnIndex; i < columnSpanEnd; i++) {
                var columnGroup = this.columns[i];
                if (!columnGroup.getIsStar()) {
                    remainingSpace -= columnGroup.length;
                }
            }
            if (remainingSpace > 0) {
                this.minColumnStarValue = Math.max(remainingSpace / measureSpec.starColumnsCount, this.minColumnStarValue);
            }
        }
    };
    return MeasureHelper;
}());
//# sourceMappingURL=grid-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var LayoutBaseCommon = (function (_super) {
    __extends(LayoutBaseCommon, _super);
    function LayoutBaseCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._subViews = new Array();
        return _this;
    }
    LayoutBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.addChild(value);
        }
    };
    LayoutBaseCommon.prototype.getChildrenCount = function () {
        return this._subViews.length;
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "_childrenCount", {
        get: function () {
            return this._subViews.length;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype.getChildAt = function (index) {
        return this._subViews[index];
    };
    LayoutBaseCommon.prototype.getChildIndex = function (child) {
        return this._subViews.indexOf(child);
    };
    LayoutBaseCommon.prototype.getChildById = function (id) {
        return view_1.getViewById(this, id);
    };
    LayoutBaseCommon.prototype._registerLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype._unregisterLayoutChild = function (child) {
    };
    LayoutBaseCommon.prototype.addChild = function (child) {
        this._subViews.push(child);
        this._addView(child);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.insertChild = function (child, atIndex) {
        this._subViews.splice(atIndex, 0, child);
        this._addView(child, atIndex);
        this._registerLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChild = function (child) {
        this._removeView(child);
        var index = this._subViews.indexOf(child);
        this._subViews.splice(index, 1);
        this._unregisterLayoutChild(child);
    };
    LayoutBaseCommon.prototype.removeChildren = function () {
        while (this.getChildrenCount() !== 0) {
            this.removeChild(this._subViews[this.getChildrenCount() - 1]);
        }
    };
    Object.defineProperty(LayoutBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(LayoutBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    LayoutBaseCommon.prototype._childIndexToNativeChildIndex = function (index) {
        if (index === undefined) {
            return undefined;
        }
        var result = 0;
        for (var i = 0; i < index && i < this._subViews.length; i++) {
            result += this._subViews[i]._getNativeViewsCount();
        }
        return result;
    };
    LayoutBaseCommon.prototype.eachChildView = function (callback) {
        for (var i = 0, length_1 = this._subViews.length; i < length_1; i++) {
            var retVal = callback(this._subViews[i]);
            if (retVal === false) {
                break;
            }
        }
    };
    LayoutBaseCommon.prototype.eachLayoutChild = function (callback) {
        var lastChild = null;
        this.eachChildView(function (cv) {
            cv._eachLayoutView(function (lv) {
                if (lastChild && !lastChild.isCollapsed) {
                    callback(lastChild, false);
                }
                lastChild = lv;
            });
            return true;
        });
        if (lastChild && !lastChild.isCollapsed) {
            callback(lastChild, true);
        }
    };
    return LayoutBaseCommon;
}(view_1.CustomLayoutView));
exports.LayoutBaseCommon = LayoutBaseCommon;
exports.clipToBoundsProperty = new view_1.Property({ name: "clipToBounds", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.clipToBoundsProperty.register(LayoutBaseCommon);
exports.isPassThroughParentEnabledProperty = new view_1.Property({ name: "isPassThroughParentEnabled", defaultValue: false, valueConverter: view_1.booleanConverter });
exports.isPassThroughParentEnabledProperty.register(LayoutBaseCommon);
//# sourceMappingURL=layout-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/layout-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base-common.js"));
var LayoutBase = (function (_super) {
    __extends(LayoutBase, _super);
    function LayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LayoutBase.prototype.addChild = function (child) {
        _super.prototype.addChild.call(this, child);
        this.requestLayout();
    };
    LayoutBase.prototype.insertChild = function (child, atIndex) {
        _super.prototype.insertChild.call(this, child, atIndex);
        this.requestLayout();
    };
    LayoutBase.prototype.removeChild = function (child) {
        _super.prototype.removeChild.call(this, child);
        this.requestLayout();
    };
    LayoutBase.prototype._setNativeClipToBounds = function () {
        if (this.clipToBounds) {
            this.nativeViewProtected.clipsToBounds = true;
        }
        else {
            _super.prototype._setNativeClipToBounds.call(this);
        }
    };
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.getDefault] = function () {
        return false;
    };
    LayoutBase.prototype[layout_base_common_1.clipToBoundsProperty.setNative] = function (value) {
        this._setNativeClipToBounds();
    };
    LayoutBase.prototype[layout_base_common_1.isPassThroughParentEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.setPassThroughParent(value);
    };
    return LayoutBase;
}(layout_base_common_1.LayoutBaseCommon));
exports.LayoutBase = LayoutBase;
//# sourceMappingURL=layout-base.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var StackLayoutBase = (function (_super) {
    __extends(StackLayoutBase, _super);
    function StackLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StackLayoutBase = __decorate([
        layout_base_1.CSSType("StackLayout")
    ], StackLayoutBase);
    return StackLayoutBase;
}(layout_base_1.LayoutBase));
exports.StackLayoutBase = StackLayoutBase;
StackLayoutBase.prototype.recycleNativeView = "auto";
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "vertical", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(StackLayoutBase);
//# sourceMappingURL=stack-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var stack_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js");
var trace = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout-common.js"));
var StackLayout = (function (_super) {
    __extends(StackLayout, _super);
    function StackLayout() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._totalLength = 0;
        return _this;
    }
    StackLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = 0;
        var measureHeight = 0;
        var width = stack_layout_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = stack_layout_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = stack_layout_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = stack_layout_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var isVertical = this.orientation === "vertical";
        var horizontalPaddingsAndMargins = this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalPaddingsAndMargins = this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var measureSpec;
        var mode = isVertical ? heightMode : widthMode;
        var remainingLength;
        if (mode === stack_layout_common_1.layout.UNSPECIFIED) {
            measureSpec = stack_layout_common_1.layout.UNSPECIFIED;
            remainingLength = 0;
        }
        else {
            measureSpec = stack_layout_common_1.layout.AT_MOST;
            remainingLength = isVertical ? height - verticalPaddingsAndMargins : width - horizontalPaddingsAndMargins;
        }
        var childMeasureSpec;
        if (isVertical) {
            var childWidth = (widthMode === stack_layout_common_1.layout.UNSPECIFIED) ? 0 : width - horizontalPaddingsAndMargins;
            childWidth = Math.max(0, childWidth);
            childMeasureSpec = stack_layout_common_1.layout.makeMeasureSpec(childWidth, widthMode);
        }
        else {
            var childHeight = (heightMode === stack_layout_common_1.layout.UNSPECIFIED) ? 0 : height - verticalPaddingsAndMargins;
            childHeight = Math.max(0, childHeight);
            childMeasureSpec = stack_layout_common_1.layout.makeMeasureSpec(childHeight, heightMode);
        }
        var childSize;
        this.eachLayoutChild(function (child, last) {
            if (isVertical) {
                childSize = stack_layout_common_1.View.measureChild(_this, child, childMeasureSpec, stack_layout_common_1.layout.makeMeasureSpec(remainingLength, measureSpec));
                if (measureSpec === stack_layout_common_1.layout.AT_MOST && _this.isUnsizedScrollableView(child)) {
                    trace.write("Avoid using ListView or ScrollView with no explicit height set inside StackLayout. Doing so might result in poor user interface performance and poor user experience.", trace.categories.Layout, trace.messageType.warn);
                }
                measureWidth = Math.max(measureWidth, childSize.measuredWidth);
                var viewHeight = childSize.measuredHeight;
                measureHeight += viewHeight;
                remainingLength = Math.max(0, remainingLength - viewHeight);
            }
            else {
                childSize = stack_layout_common_1.View.measureChild(_this, child, stack_layout_common_1.layout.makeMeasureSpec(remainingLength, measureSpec), childMeasureSpec);
                measureHeight = Math.max(measureHeight, childSize.measuredHeight);
                var viewWidth = childSize.measuredWidth;
                measureWidth += viewWidth;
                remainingLength = Math.max(0, remainingLength - viewWidth);
            }
        });
        measureWidth += horizontalPaddingsAndMargins;
        measureHeight += verticalPaddingsAndMargins;
        measureWidth = Math.max(measureWidth, this.effectiveMinWidth);
        measureHeight = Math.max(measureHeight, this.effectiveMinHeight);
        this._totalLength = isVertical ? measureHeight : measureWidth;
        var widthAndState = stack_layout_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = stack_layout_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    StackLayout.prototype.onLayout = function (left, top, right, bottom) {
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        var insets = this.getSafeAreaInsets();
        if (this.orientation === "vertical") {
            this.layoutVertical(left, top, right, bottom, insets);
        }
        else {
            this.layoutHorizontal(left, top, right, bottom, insets);
        }
    };
    StackLayout.prototype.layoutVertical = function (left, top, right, bottom, insets) {
        var _this = this;
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childTop;
        var childLeft = paddingLeft;
        var childRight = right - left - paddingRight;
        switch (this.verticalAlignment) {
            case stack_layout_common_1.VerticalAlignment.MIDDLE:
                childTop = (bottom - top - this._totalLength) / 2 + paddingTop - paddingBottom;
                break;
            case stack_layout_common_1.VerticalAlignment.BOTTOM:
                childTop = bottom - top - this._totalLength + paddingTop - paddingBottom;
                break;
            case stack_layout_common_1.VerticalAlignment.TOP:
            case stack_layout_common_1.VerticalAlignment.STRETCH:
            default:
                childTop = paddingTop;
                break;
        }
        this.eachLayoutChild(function (child, last) {
            var childHeight = child.getMeasuredHeight() + child.effectiveMarginTop + child.effectiveMarginBottom;
            stack_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childRight, childTop + childHeight);
            childTop += childHeight;
        });
    };
    StackLayout.prototype.layoutHorizontal = function (left, top, right, bottom, insets) {
        var _this = this;
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childTop = paddingTop;
        var childLeft;
        var childBottom = bottom - top - paddingBottom;
        switch (this.horizontalAlignment) {
            case stack_layout_common_1.HorizontalAlignment.CENTER:
                childLeft = (right - left - this._totalLength) / 2 + paddingLeft - paddingRight;
                break;
            case stack_layout_common_1.HorizontalAlignment.RIGHT:
                childLeft = right - left - this._totalLength + paddingLeft - paddingRight;
                break;
            case stack_layout_common_1.HorizontalAlignment.LEFT:
            case stack_layout_common_1.HorizontalAlignment.STRETCH:
            default:
                childLeft = paddingLeft;
                break;
        }
        this.eachLayoutChild(function (child, last) {
            var childWidth = child.getMeasuredWidth() + child.effectiveMarginLeft + child.effectiveMarginRight;
            stack_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childLeft + childWidth, childBottom);
            childLeft += childWidth;
        });
    };
    StackLayout.prototype.isUnsizedScrollableView = function (child) {
        if (child.height === "auto" && (child.ios instanceof UITableView || child.ios instanceof UIScrollView)) {
            return true;
        }
        return false;
    };
    return StackLayout;
}(stack_layout_common_1.StackLayoutBase));
exports.StackLayout = StackLayout;
//# sourceMappingURL=stack-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var WrapLayoutBase = (function (_super) {
    __extends(WrapLayoutBase, _super);
    function WrapLayoutBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WrapLayoutBase = __decorate([
        layout_base_1.CSSType("WrapLayout")
    ], WrapLayoutBase);
    return WrapLayoutBase;
}(layout_base_1.LayoutBase));
exports.WrapLayoutBase = WrapLayoutBase;
WrapLayoutBase.prototype.recycleNativeView = "auto";
exports.itemWidthProperty = new layout_base_1.Property({
    name: "itemWidth", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemWidth = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemWidthProperty.register(WrapLayoutBase);
exports.itemHeightProperty = new layout_base_1.Property({
    name: "itemHeight", defaultValue: "auto", affectsLayout: layout_base_1.isIOS, valueConverter: function (v) { return layout_base_1.Length.parse(v); },
    valueChanged: function (target, oldValue, newValue) { return target.effectiveItemHeight = layout_base_1.Length.toDevicePixels(newValue, -1); }
});
exports.itemHeightProperty.register(WrapLayoutBase);
var converter = layout_base_1.makeParser(layout_base_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new layout_base_1.Property({ name: "orientation", defaultValue: "horizontal", affectsLayout: layout_base_1.isIOS, valueConverter: converter });
exports.orientationProperty.register(WrapLayoutBase);
//# sourceMappingURL=wrap-layout-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var wrap_layout_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/wrap-layout/wrap-layout-common.js"));
var WrapLayout = (function (_super) {
    __extends(WrapLayout, _super);
    function WrapLayout() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._lengths = new Array();
        return _this;
    }
    WrapLayout.getChildMeasureSpec = function (parentMode, parentLength, itemLength) {
        if (itemLength > 0) {
            return wrap_layout_common_1.layout.makeMeasureSpec(itemLength, wrap_layout_common_1.layout.EXACTLY);
        }
        else if (parentMode === wrap_layout_common_1.layout.UNSPECIFIED) {
            return wrap_layout_common_1.layout.makeMeasureSpec(0, wrap_layout_common_1.layout.UNSPECIFIED);
        }
        else {
            return wrap_layout_common_1.layout.makeMeasureSpec(parentLength, wrap_layout_common_1.layout.AT_MOST);
        }
    };
    WrapLayout.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = 0;
        var measureHeight = 0;
        var width = wrap_layout_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = wrap_layout_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = wrap_layout_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = wrap_layout_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var horizontalPaddingsAndMargins = this.effectivePaddingLeft + this.effectivePaddingRight + this.effectiveBorderLeftWidth + this.effectiveBorderRightWidth;
        var verticalPaddingsAndMargins = this.effectivePaddingTop + this.effectivePaddingBottom + this.effectiveBorderTopWidth + this.effectiveBorderBottomWidth;
        var availableWidth = widthMode === wrap_layout_common_1.layout.UNSPECIFIED ? Number.MAX_VALUE : width - horizontalPaddingsAndMargins;
        var availableHeight = heightMode === wrap_layout_common_1.layout.UNSPECIFIED ? Number.MAX_VALUE : height - verticalPaddingsAndMargins;
        var childWidthMeasureSpec = WrapLayout.getChildMeasureSpec(widthMode, availableWidth, this.effectiveItemWidth);
        var childHeightMeasureSpec = WrapLayout.getChildMeasureSpec(heightMode, availableHeight, this.effectiveItemHeight);
        var remainingWidth = availableWidth;
        var remainingHeight = availableHeight;
        this._lengths.length = 0;
        var rowOrColumn = 0;
        var maxLength = 0;
        var isVertical = this.orientation === "vertical";
        var useItemWidth = this.effectiveItemWidth > 0;
        var useItemHeight = this.effectiveItemHeight > 0;
        var itemWidth = this.effectiveItemWidth;
        var itemHeight = this.effectiveItemHeight;
        this.eachLayoutChild(function (child, last) {
            var desiredSize = wrap_layout_common_1.View.measureChild(_this, child, childWidthMeasureSpec, childHeightMeasureSpec);
            var childMeasuredWidth = useItemWidth ? itemWidth : desiredSize.measuredWidth;
            var childMeasuredHeight = useItemHeight ? itemHeight : desiredSize.measuredHeight;
            var isFirst = _this._lengths.length <= rowOrColumn;
            if (isVertical) {
                if (childMeasuredHeight > remainingHeight) {
                    rowOrColumn++;
                    maxLength = Math.max(maxLength, measureHeight);
                    measureHeight = childMeasuredHeight;
                    remainingHeight = availableHeight - childMeasuredHeight;
                    _this._lengths[isFirst ? rowOrColumn - 1 : rowOrColumn] = childMeasuredWidth;
                }
                else {
                    remainingHeight -= childMeasuredHeight;
                    measureHeight += childMeasuredHeight;
                }
            }
            else {
                if (childMeasuredWidth > remainingWidth) {
                    rowOrColumn++;
                    maxLength = Math.max(maxLength, measureWidth);
                    measureWidth = childMeasuredWidth;
                    remainingWidth = availableWidth - childMeasuredWidth;
                    _this._lengths[isFirst ? rowOrColumn - 1 : rowOrColumn] = childMeasuredHeight;
                }
                else {
                    remainingWidth -= childMeasuredWidth;
                    measureWidth += childMeasuredWidth;
                }
            }
            if (isFirst) {
                _this._lengths[rowOrColumn] = isVertical ? childMeasuredWidth : childMeasuredHeight;
            }
            else {
                _this._lengths[rowOrColumn] = Math.max(_this._lengths[rowOrColumn], isVertical ? childMeasuredWidth : childMeasuredHeight);
            }
        });
        if (isVertical) {
            measureHeight = Math.max(maxLength, measureHeight);
            this._lengths.forEach(function (value, index, array) {
                measureWidth += value;
            });
        }
        else {
            measureWidth = Math.max(maxLength, measureWidth);
            this._lengths.forEach(function (value, index, array) {
                measureHeight += value;
            });
        }
        measureWidth += horizontalPaddingsAndMargins;
        measureHeight += verticalPaddingsAndMargins;
        measureWidth = Math.max(measureWidth, this.effectiveMinWidth);
        measureHeight = Math.max(measureHeight, this.effectiveMinHeight);
        var widthAndState = wrap_layout_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = wrap_layout_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    WrapLayout.prototype.onLayout = function (left, top, right, bottom) {
        var _this = this;
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        var insets = this.getSafeAreaInsets();
        var isVertical = this.orientation === "vertical";
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childLeft = paddingLeft;
        var childTop = paddingTop;
        var childrenHeight = bottom - top - paddingBottom;
        var childrenWidth = right - left - paddingRight;
        var rowOrColumn = 0;
        this.eachLayoutChild(function (child, last) {
            var childHeight = child.getMeasuredHeight() + child.effectiveMarginTop + child.effectiveMarginBottom;
            var childWidth = child.getMeasuredWidth() + child.effectiveMarginLeft + child.effectiveMarginRight;
            var length = _this._lengths[rowOrColumn];
            if (isVertical) {
                childWidth = length;
                childHeight = _this.effectiveItemHeight > 0 ? _this.effectiveItemHeight : childHeight;
                var isFirst = childTop === paddingTop;
                if (childTop + childHeight > childrenHeight && childLeft + childWidth <= childrenWidth) {
                    childTop = paddingTop;
                    if (!isFirst) {
                        childLeft += length;
                    }
                    rowOrColumn++;
                    childWidth = _this._lengths[isFirst ? rowOrColumn - 1 : rowOrColumn];
                }
                if (childLeft < childrenWidth && childTop < childrenHeight) {
                    wrap_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childLeft + childWidth, childTop + childHeight);
                }
                childTop += childHeight;
            }
            else {
                childWidth = _this.effectiveItemWidth > 0 ? _this.effectiveItemWidth : childWidth;
                childHeight = length;
                var isFirst = childLeft === paddingLeft;
                if (childLeft + childWidth > childrenWidth && childTop + childHeight <= childrenHeight) {
                    childLeft = paddingLeft;
                    if (!isFirst) {
                        childTop += length;
                    }
                    rowOrColumn++;
                    childHeight = _this._lengths[isFirst ? rowOrColumn - 1 : rowOrColumn];
                }
                if (childLeft < childrenWidth && childTop < childrenHeight) {
                    wrap_layout_common_1.View.layoutChild(_this, child, childLeft, childTop, childLeft + childWidth, childTop + childHeight);
                }
                childLeft += childWidth;
            }
        });
    };
    return WrapLayout;
}(wrap_layout_common_1.WrapLayoutBase));
exports.WrapLayout = WrapLayout;
//# sourceMappingURL=wrap-layout.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ListPickerBase = (function (_super) {
    __extends(ListPickerBase, _super);
    function ListPickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPickerBase.prototype._getItemAsString = function (index) {
        var items = this.items;
        if (!items) {
            return " ";
        }
        var item = this.isItemsSource ? this.items.getItem(index) : this.items[index];
        return (item === undefined || item === null) ? index + "" : this.parseItem(item);
    };
    ListPickerBase.prototype.parseItem = function (item) {
        return this.textField ? item[this.textField] + "" : item + "";
    };
    ListPickerBase.prototype.updateSelectedValue = function (index) {
        var newVal = null;
        if (index >= 0) {
            var item = this.items[index];
            newVal = this.valueField ? item[this.valueField] : item;
        }
        if (this.selectedValue !== newVal) {
            this.set("selectedValue", newVal);
        }
    };
    ListPickerBase = __decorate([
        view_1.CSSType("ListPicker")
    ], ListPickerBase);
    return ListPickerBase;
}(view_1.View));
exports.ListPickerBase = ListPickerBase;
ListPickerBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueConverter: function (v) { return parseInt(v); },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        target.updateSelectedValue(value);
        return value;
    }
});
exports.selectedIndexProperty.register(ListPickerBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        var getItem = newValue && newValue.getItem;
        target.isItemsSource = typeof getItem === "function";
    }
});
exports.itemsProperty.register(ListPickerBase);
exports.textFieldProperty = new view_1.Property({
    name: "textField",
    defaultValue: ""
});
exports.textFieldProperty.register(ListPickerBase);
exports.valueFieldProperty = new view_1.Property({
    name: "valueField",
    defaultValue: ""
});
exports.valueFieldProperty.register(ListPickerBase);
exports.selectedValueProperty = new view_1.Property({
    name: "selectedValue",
    defaultValue: null
});
exports.selectedValueProperty.register(ListPickerBase);
//# sourceMappingURL=list-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-picker/list-picker.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-picker/list-picker-common.js"));
var ListPicker = (function (_super) {
    __extends(ListPicker, _super);
    function ListPicker() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPicker.prototype.createNativeView = function () {
        return UIPickerView.new();
    };
    ListPicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.dataSource = this._dataSource = ListPickerDataSource.initWithOwner(new WeakRef(this));
        this._delegate = ListPickerDelegateImpl.initWithOwner(new WeakRef(this));
    };
    ListPicker.prototype.disposeNativeView = function () {
        this._dataSource = null;
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(ListPicker.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    ListPicker.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.delegate = this._delegate;
    };
    ListPicker.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    ListPicker.prototype[list_picker_common_1.selectedIndexProperty.setNative] = function (value) {
        if (value >= 0) {
            this.ios.selectRowInComponentAnimated(value, 0, false);
        }
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    ListPicker.prototype[list_picker_common_1.itemsProperty.setNative] = function (value) {
        this.ios.reloadAllComponents();
        list_picker_common_1.selectedIndexProperty.coerce(this);
    };
    ListPicker.prototype[list_picker_common_1.backgroundColorProperty.getDefault] = function () {
        return this.ios.backgroundColor;
    };
    ListPicker.prototype[list_picker_common_1.backgroundColorProperty.setNative] = function (value) {
        this.ios.backgroundColor = value instanceof list_picker_common_1.Color ? value.ios : value;
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.getDefault] = function () {
        return this.ios.tintColor;
    };
    ListPicker.prototype[list_picker_common_1.colorProperty.setNative] = function (value) {
        this.ios.tintColor = value instanceof list_picker_common_1.Color ? value.ios : value;
    };
    __decorate([
        profiling_1.profile
    ], ListPicker.prototype, "onLoaded", null);
    return ListPicker;
}(list_picker_common_1.ListPickerBase));
exports.ListPicker = ListPicker;
var ListPickerDataSource = (function (_super) {
    __extends(ListPickerDataSource, _super);
    function ListPickerDataSource() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPickerDataSource.initWithOwner = function (owner) {
        var dataSource = ListPickerDataSource.new();
        dataSource._owner = owner;
        return dataSource;
    };
    ListPickerDataSource.prototype.numberOfComponentsInPickerView = function (pickerView) {
        return 1;
    };
    ListPickerDataSource.prototype.pickerViewNumberOfRowsInComponent = function (pickerView, component) {
        var owner = this._owner.get();
        return (owner && owner.items) ? owner.items.length : 0;
    };
    ListPickerDataSource.ObjCProtocols = [UIPickerViewDataSource];
    return ListPickerDataSource;
}(NSObject));
var ListPickerDelegateImpl = (function (_super) {
    __extends(ListPickerDelegateImpl, _super);
    function ListPickerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListPickerDelegateImpl.initWithOwner = function (owner) {
        var delegate = ListPickerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    ListPickerDelegateImpl.prototype.pickerViewAttributedTitleForRowForComponent = function (pickerView, row, component) {
        var _a, _b;
        var owner = this._owner.get();
        if (owner) {
            var title = NSAttributedString.alloc().initWithStringAttributes(owner._getItemAsString(row), (_a = {}, _a[NSForegroundColorAttributeName] = pickerView.tintColor, _a));
            return title;
        }
        return NSAttributedString.alloc().initWithStringAttributes(row.toString(), (_b = {}, _b[NSForegroundColorAttributeName] = pickerView.tintColor, _b));
    };
    ListPickerDelegateImpl.prototype.pickerViewDidSelectRowInComponent = function (pickerView, row, component) {
        var owner = this._owner.get();
        if (owner) {
            list_picker_common_1.selectedIndexProperty.nativeValueChange(owner, row);
            owner.updateSelectedValue(row);
        }
    };
    ListPickerDelegateImpl.ObjCProtocols = [UIPickerViewDelegate];
    return ListPickerDelegateImpl;
}(NSObject));
//# sourceMappingURL=list-picker.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var knownMultiTemplates;
(function (knownMultiTemplates) {
    knownMultiTemplates.itemTemplates = "itemTemplates";
})(knownMultiTemplates = exports.knownMultiTemplates || (exports.knownMultiTemplates = {}));
var autoEffectiveRowHeight = -1;
var ListViewBase = (function (_super) {
    __extends(ListViewBase, _super);
    function ListViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._itemIdGenerator = function (_item, index) { return index; };
        _this._itemTemplateSelectorBindable = new label_1.Label();
        _this._defaultTemplate = {
            key: "default",
            createView: function () {
                if (_this.itemTemplate) {
                    return builder_1.parse(_this.itemTemplate, _this);
                }
                return undefined;
            }
        };
        _this._itemTemplatesInternal = new Array(_this._defaultTemplate);
        _this._effectiveRowHeight = autoEffectiveRowHeight;
        return _this;
    }
    Object.defineProperty(ListViewBase.prototype, "separatorColor", {
        get: function () {
            return this.style.separatorColor;
        },
        set: function (value) {
            this.style.separatorColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemTemplateSelector", {
        get: function () {
            return this._itemTemplateSelector;
        },
        set: function (value) {
            var _this = this;
            if (typeof value === "string") {
                this._itemTemplateSelectorBindable.bind({
                    sourceProperty: null,
                    targetProperty: "templateKey",
                    expression: value
                });
                this._itemTemplateSelector = function (item, index, items) {
                    item["$index"] = index;
                    if (_this._itemTemplateSelectorBindable.bindingContext === item) {
                        _this._itemTemplateSelectorBindable.bindingContext = null;
                    }
                    _this._itemTemplateSelectorBindable.bindingContext = item;
                    return _this._itemTemplateSelectorBindable.get("templateKey");
                };
            }
            else if (typeof value === "function") {
                this._itemTemplateSelector = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListViewBase.prototype, "itemIdGenerator", {
        get: function () {
            return this._itemIdGenerator;
        },
        set: function (generatorFn) {
            this._itemIdGenerator = generatorFn;
        },
        enumerable: true,
        configurable: true
    });
    ListViewBase.prototype.refresh = function () {
    };
    ListViewBase.prototype.scrollToIndex = function (index) {
    };
    ListViewBase.prototype.scrollToIndexAnimated = function (index) {
    };
    ListViewBase.prototype._getItemTemplate = function (index) {
        var templateKey = "default";
        if (this.itemTemplateSelector) {
            var dataItem = this._getDataItem(index);
            templateKey = this._itemTemplateSelector(dataItem, index, this.items);
        }
        for (var i = 0, length_1 = this._itemTemplatesInternal.length; i < length_1; i++) {
            if (this._itemTemplatesInternal[i].key === templateKey) {
                return this._itemTemplatesInternal[i];
            }
        }
        return this._itemTemplatesInternal[0];
    };
    ListViewBase.prototype._prepareItem = function (item, index) {
        if (item) {
            item.bindingContext = this._getDataItem(index);
        }
    };
    ListViewBase.prototype._getDataItem = function (index) {
        var thisItems = this.items;
        return thisItems.getItem ? thisItems.getItem(index) : thisItems[index];
    };
    ListViewBase.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    ListViewBase.prototype._onItemsChanged = function (args) {
        this.refresh();
    };
    ListViewBase.prototype._onRowHeightPropertyChanged = function (oldValue, newValue) {
        this.refresh();
    };
    ListViewBase.prototype.isItemAtIndexVisible = function (index) {
        return false;
    };
    ListViewBase.prototype.updateEffectiveRowHeight = function () {
        exports.rowHeightProperty.coerce(this);
    };
    ListViewBase.itemLoadingEvent = "itemLoading";
    ListViewBase.itemTapEvent = "itemTap";
    ListViewBase.loadMoreItemsEvent = "loadMoreItems";
    ListViewBase.knownFunctions = ["itemTemplateSelector", "itemIdGenerator"];
    ListViewBase = __decorate([
        view_1.CSSType("ListView")
    ], ListViewBase);
    return ListViewBase;
}(view_1.ContainerView));
exports.ListViewBase = ListViewBase;
ListViewBase.prototype.recycleNativeView = "auto";
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof view_1.Observable) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof view_1.Observable) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target.refresh();
    }
});
exports.itemsProperty.register(ListViewBase);
exports.itemTemplateProperty = new view_1.Property({
    name: "itemTemplate", valueChanged: function (target) {
        target.refresh();
    }
});
exports.itemTemplateProperty.register(ListViewBase);
exports.itemTemplatesProperty = new view_1.Property({
    name: "itemTemplates", valueConverter: function (value) {
        if (typeof value === "string") {
            return builder_1.parseMultipleTemplates(value);
        }
        return value;
    }
});
exports.itemTemplatesProperty.register(ListViewBase);
var defaultRowHeight = "auto";
exports.rowHeightProperty = new view_1.CoercibleProperty({
    name: "rowHeight", defaultValue: defaultRowHeight, equalityComparer: view_1.Length.equals,
    coerceValue: function (target, value) {
        return target.nativeViewProtected ? value : defaultRowHeight;
    },
    valueChanged: function (target, oldValue, newValue) {
        target._effectiveRowHeight = view_1.Length.toDevicePixels(newValue, autoEffectiveRowHeight);
        target._onRowHeightPropertyChanged(oldValue, newValue);
    }, valueConverter: view_1.Length.parse
});
exports.rowHeightProperty.register(ListViewBase);
exports.iosEstimatedRowHeightProperty = new view_1.Property({
    name: "iosEstimatedRowHeight", valueConverter: function (v) { return view_1.Length.parse(v); }
});
exports.iosEstimatedRowHeightProperty.register(ListViewBase);
exports.separatorColorProperty = new view_1.CssProperty({ name: "separatorColor", cssName: "separator-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.separatorColorProperty.register(view_1.Style);
//# sourceMappingURL=list-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/list-view/list-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var list_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var proxy_view_container_1 = __webpack_require__("../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var trace = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/list-view/list-view-common.js"));
var ITEMLOADING = list_view_common_1.ListViewBase.itemLoadingEvent;
var LOADMOREITEMS = list_view_common_1.ListViewBase.loadMoreItemsEvent;
var ITEMTAP = list_view_common_1.ListViewBase.itemTapEvent;
var DEFAULT_HEIGHT = 44;
var infinity = list_view_common_1.layout.makeMeasureSpec(0, list_view_common_1.layout.UNSPECIFIED);
var ListViewCell = (function (_super) {
    __extends(ListViewCell, _super);
    function ListViewCell() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListViewCell.initWithEmptyBackground = function () {
        var cell = ListViewCell.new();
        cell.backgroundColor = null;
        return cell;
    };
    ListViewCell.prototype.initWithStyleReuseIdentifier = function (style, reuseIdentifier) {
        var cell = _super.prototype.initWithStyleReuseIdentifier.call(this, style, reuseIdentifier);
        cell.backgroundColor = null;
        return cell;
    };
    ListViewCell.prototype.willMoveToSuperview = function (newSuperview) {
        var parent = (this.view ? this.view.parent : null);
        if (parent && !newSuperview) {
            parent._removeContainer(this);
        }
    };
    Object.defineProperty(ListViewCell.prototype, "view", {
        get: function () {
            return this.owner ? this.owner.get() : null;
        },
        enumerable: true,
        configurable: true
    });
    return ListViewCell;
}(UITableViewCell));
function notifyForItemAtIndex(listView, cell, view, eventName, indexPath) {
    var args = { eventName: eventName, object: listView, index: indexPath.row, view: view, ios: cell, android: undefined };
    listView.notify(args);
    return args;
}
var DataSource = (function (_super) {
    __extends(DataSource, _super);
    function DataSource() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DataSource.initWithOwner = function (owner) {
        var dataSource = DataSource.new();
        dataSource._owner = owner;
        return dataSource;
    };
    DataSource.prototype.tableViewNumberOfRowsInSection = function (tableView, section) {
        var owner = this._owner.get();
        return (owner && owner.items) ? owner.items.length : 0;
    };
    DataSource.prototype.tableViewCellForRowAtIndexPath = function (tableView, indexPath) {
        var owner = this._owner.get();
        var cell;
        if (owner) {
            var template = owner._getItemTemplate(indexPath.row);
            cell = (tableView.dequeueReusableCellWithIdentifier(template.key) || ListViewCell.initWithEmptyBackground());
            owner._prepareCell(cell, indexPath);
            var cellView = cell.view;
            if (cellView && cellView.isLayoutRequired) {
                var width = list_view_common_1.layout.getMeasureSpecSize(owner.widthMeasureSpec);
                var rowHeight = owner._effectiveRowHeight;
                var cellHeight = rowHeight > 0 ? rowHeight : owner.getHeight(indexPath.row);
                cellView.iosOverflowSafeAreaEnabled = false;
                list_view_common_1.View.layoutChild(owner, cellView, 0, 0, width, cellHeight);
            }
        }
        else {
            cell = ListViewCell.initWithEmptyBackground();
        }
        return cell;
    };
    DataSource.ObjCProtocols = [UITableViewDataSource];
    return DataSource;
}(NSObject));
var UITableViewDelegateImpl = (function (_super) {
    __extends(UITableViewDelegateImpl, _super);
    function UITableViewDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITableViewDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITableViewDelegateImpl.new();
        delegate._owner = owner;
        delegate._measureCellMap = new Map();
        return delegate;
    };
    UITableViewDelegateImpl.prototype.tableViewWillDisplayCellForRowAtIndexPath = function (tableView, cell, indexPath) {
        var owner = this._owner.get();
        if (owner && (indexPath.row === owner.items.length - 1)) {
            owner.notify({ eventName: LOADMOREITEMS, object: owner });
        }
    };
    UITableViewDelegateImpl.prototype.tableViewWillSelectRowAtIndexPath = function (tableView, indexPath) {
        var cell = tableView.cellForRowAtIndexPath(indexPath);
        var owner = this._owner.get();
        if (owner) {
            notifyForItemAtIndex(owner, cell, cell.view, ITEMTAP, indexPath);
        }
        return indexPath;
    };
    UITableViewDelegateImpl.prototype.tableViewDidSelectRowAtIndexPath = function (tableView, indexPath) {
        tableView.deselectRowAtIndexPathAnimated(indexPath, true);
        return indexPath;
    };
    UITableViewDelegateImpl.prototype.tableViewHeightForRowAtIndexPath = function (tableView, indexPath) {
        var owner = this._owner.get();
        if (!owner) {
            return tableView.estimatedRowHeight;
        }
        var height = owner.getHeight(indexPath.row);
        if (height === undefined) {
            var template = owner._getItemTemplate(indexPath.row);
            var cell = this._measureCellMap.get(template.key);
            if (!cell) {
                cell = tableView.dequeueReusableCellWithIdentifier(template.key) || ListViewCell.initWithEmptyBackground();
                this._measureCellMap.set(template.key, cell);
            }
            height = owner._prepareCell(cell, indexPath);
        }
        return list_view_common_1.layout.toDeviceIndependentPixels(height);
    };
    UITableViewDelegateImpl.ObjCProtocols = [UITableViewDelegate];
    return UITableViewDelegateImpl;
}(NSObject));
var UITableViewRowHeightDelegateImpl = (function (_super) {
    __extends(UITableViewRowHeightDelegateImpl, _super);
    function UITableViewRowHeightDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITableViewRowHeightDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITableViewRowHeightDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UITableViewRowHeightDelegateImpl.prototype.tableViewWillDisplayCellForRowAtIndexPath = function (tableView, cell, indexPath) {
        var owner = this._owner.get();
        if (owner && (indexPath.row === owner.items.length - 1)) {
            owner.notify({ eventName: LOADMOREITEMS, object: owner });
        }
    };
    UITableViewRowHeightDelegateImpl.prototype.tableViewWillSelectRowAtIndexPath = function (tableView, indexPath) {
        var cell = tableView.cellForRowAtIndexPath(indexPath);
        var owner = this._owner.get();
        if (owner) {
            notifyForItemAtIndex(owner, cell, cell.view, ITEMTAP, indexPath);
        }
        return indexPath;
    };
    UITableViewRowHeightDelegateImpl.prototype.tableViewDidSelectRowAtIndexPath = function (tableView, indexPath) {
        tableView.deselectRowAtIndexPathAnimated(indexPath, true);
        return indexPath;
    };
    UITableViewRowHeightDelegateImpl.prototype.tableViewHeightForRowAtIndexPath = function (tableView, indexPath) {
        var owner = this._owner.get();
        if (!owner) {
            return tableView.estimatedRowHeight;
        }
        return list_view_common_1.layout.toDeviceIndependentPixels(owner._effectiveRowHeight);
    };
    UITableViewRowHeightDelegateImpl.ObjCProtocols = [UITableViewDelegate];
    return UITableViewRowHeightDelegateImpl;
}(NSObject));
var ListView = (function (_super) {
    __extends(ListView, _super);
    function ListView() {
        var _this = _super.call(this) || this;
        _this.widthMeasureSpec = 0;
        _this._map = new Map();
        _this._heights = new Array();
        return _this;
    }
    ListView.prototype.createNativeView = function () {
        return UITableView.new();
    };
    ListView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.registerClassForCellReuseIdentifier(ListViewCell.class(), this._defaultTemplate.key);
        nativeView.estimatedRowHeight = DEFAULT_HEIGHT;
        nativeView.rowHeight = UITableViewAutomaticDimension;
        nativeView.dataSource = this._dataSource = DataSource.initWithOwner(new WeakRef(this));
        this._delegate = UITableViewDelegateImpl.initWithOwner(new WeakRef(this));
        this._setNativeClipToBounds();
    };
    ListView.prototype.disposeNativeView = function () {
        this._delegate = null;
        this._dataSource = null;
        _super.prototype.disposeNativeView.call(this);
    };
    ListView.prototype._setNativeClipToBounds = function () {
        this.ios.clipsToBounds = true;
    };
    ListView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this._isDataDirty) {
            this.refresh();
        }
        this.ios.delegate = this._delegate;
    };
    ListView.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(ListView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ListView.prototype, "_childrenCount", {
        get: function () {
            return this._map.size;
        },
        enumerable: true,
        configurable: true
    });
    ListView.prototype.eachChildView = function (callback) {
        this._map.forEach(function (view, key) {
            callback(view);
        });
    };
    ListView.prototype.scrollToIndex = function (index) {
        this._scrollToIndex(index, false);
    };
    ListView.prototype.scrollToIndexAnimated = function (index) {
        this._scrollToIndex(index);
    };
    ListView.prototype._scrollToIndex = function (index, animated) {
        if (animated === void 0) { animated = true; }
        if (!this.ios) {
            return;
        }
        var itemsLength = this.items ? this.items.length : 0;
        if (itemsLength > 0) {
            if (index < 0) {
                index = 0;
            }
            else if (index >= itemsLength) {
                index = itemsLength - 1;
            }
            this.ios.scrollToRowAtIndexPathAtScrollPositionAnimated(NSIndexPath.indexPathForItemInSection(index, 0), 1, animated);
        }
        else if (trace.isEnabled()) {
            trace.write("Cannot scroll listview to index " + index + " when listview items not set", trace.categories.Binding);
        }
    };
    ListView.prototype.refresh = function () {
        this._map.forEach(function (view, nativeView, map) {
            if (!(view.bindingContext instanceof list_view_common_1.Observable)) {
                view.bindingContext = null;
            }
        });
        if (this.isLoaded) {
            this.ios.reloadData();
            this.requestLayout();
            this._isDataDirty = false;
        }
        else {
            this._isDataDirty = true;
        }
    };
    ListView.prototype.isItemAtIndexVisible = function (itemIndex) {
        var indexes = Array.from(this.ios.indexPathsForVisibleRows);
        return indexes.some(function (visIndex) { return visIndex.row === itemIndex; });
    };
    ListView.prototype.getHeight = function (index) {
        return this._heights[index];
    };
    ListView.prototype.setHeight = function (index, value) {
        this._heights[index] = value;
    };
    ListView.prototype._onRowHeightPropertyChanged = function (oldValue, newValue) {
        var value = list_view_common_1.layout.toDeviceIndependentPixels(this._effectiveRowHeight);
        var nativeView = this.ios;
        if (value < 0) {
            nativeView.rowHeight = UITableViewAutomaticDimension;
            nativeView.estimatedRowHeight = DEFAULT_HEIGHT;
            this._delegate = UITableViewDelegateImpl.initWithOwner(new WeakRef(this));
        }
        else {
            nativeView.rowHeight = value;
            nativeView.estimatedRowHeight = value;
            this._delegate = UITableViewRowHeightDelegateImpl.initWithOwner(new WeakRef(this));
        }
        if (this.isLoaded) {
            nativeView.delegate = this._delegate;
        }
        _super.prototype._onRowHeightPropertyChanged.call(this, oldValue, newValue);
    };
    ListView.prototype.requestLayout = function () {
        if (!this._preparingCell) {
            _super.prototype.requestLayout.call(this);
        }
    };
    ListView.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        this.widthMeasureSpec = widthMeasureSpec;
        var changed = this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
        _super.prototype.measure.call(this, widthMeasureSpec, heightMeasureSpec);
        if (changed) {
            this.ios.reloadData();
        }
    };
    ListView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var _this = this;
        _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        this._map.forEach(function (childView, listViewCell) {
            list_view_common_1.View.measureChild(_this, childView, childView._currentWidthMeasureSpec, childView._currentHeightMeasureSpec);
        });
    };
    ListView.prototype.onLayout = function (left, top, right, bottom) {
        var _this = this;
        _super.prototype.onLayout.call(this, left, top, right, bottom);
        this._map.forEach(function (childView, listViewCell) {
            var rowHeight = _this._effectiveRowHeight;
            var cellHeight = rowHeight > 0 ? rowHeight : _this.getHeight(childView._listViewItemIndex);
            if (cellHeight) {
                var width = list_view_common_1.layout.getMeasureSpecSize(_this.widthMeasureSpec);
                childView.iosOverflowSafeAreaEnabled = false;
                list_view_common_1.View.layoutChild(_this, childView, 0, 0, width, cellHeight);
            }
        });
    };
    ListView.prototype._layoutCell = function (cellView, indexPath) {
        if (cellView) {
            var rowHeight = this._effectiveRowHeight;
            var heightMeasureSpec = rowHeight >= 0 ? list_view_common_1.layout.makeMeasureSpec(rowHeight, list_view_common_1.layout.EXACTLY) : infinity;
            var measuredSize = list_view_common_1.View.measureChild(this, cellView, this.widthMeasureSpec, heightMeasureSpec);
            var height = measuredSize.measuredHeight;
            this.setHeight(indexPath.row, height);
            return height;
        }
        return this.ios.estimatedRowHeight;
    };
    ListView.prototype._prepareCell = function (cell, indexPath) {
        var cellHeight;
        try {
            this._preparingCell = true;
            var view = cell.view;
            if (!view) {
                view = this._getItemTemplate(indexPath.row).createView();
            }
            var args = notifyForItemAtIndex(this, cell, view, ITEMLOADING, indexPath);
            view = args.view || this._getDefaultItemContent(indexPath.row);
            if (view instanceof proxy_view_container_1.ProxyViewContainer) {
                var sp = new stack_layout_1.StackLayout();
                sp.addChild(view);
                view = sp;
            }
            if (!cell.view) {
                cell.owner = new WeakRef(view);
            }
            else if (cell.view !== view) {
                this._removeContainer(cell);
                cell.view.nativeViewProtected.removeFromSuperview();
                cell.owner = new WeakRef(view);
            }
            this._prepareItem(view, indexPath.row);
            view._listViewItemIndex = indexPath.row;
            this._map.set(cell, view);
            if (view && !view.parent) {
                this._addView(view);
                cell.contentView.addSubview(view.nativeViewProtected);
            }
            cellHeight = this._layoutCell(view, indexPath);
        }
        finally {
            this._preparingCell = false;
        }
        return cellHeight;
    };
    ListView.prototype._removeContainer = function (cell) {
        var view = cell.view;
        if (!(view.parent instanceof ListView)) {
            this._removeView(view.parent);
        }
        var preparing = this._preparingCell;
        this._preparingCell = true;
        view.parent._removeView(view);
        view._listViewItemIndex = undefined;
        this._preparingCell = preparing;
        this._map.delete(cell);
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.getDefault] = function () {
        return this.ios.separatorColor;
    };
    ListView.prototype[list_view_common_1.separatorColorProperty.setNative] = function (value) {
        this.ios.separatorColor = value instanceof list_view_common_1.Color ? value.ios : value;
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.getDefault] = function () {
        return null;
    };
    ListView.prototype[list_view_common_1.itemTemplatesProperty.setNative] = function (value) {
        this._itemTemplatesInternal = new Array(this._defaultTemplate);
        if (value) {
            for (var i = 0, length_1 = value.length; i < length_1; i++) {
                this.ios.registerClassForCellReuseIdentifier(ListViewCell.class(), value[i].key);
            }
            this._itemTemplatesInternal = this._itemTemplatesInternal.concat(value);
        }
        this.refresh();
    };
    ListView.prototype[list_view_common_1.iosEstimatedRowHeightProperty.getDefault] = function () {
        return DEFAULT_HEIGHT;
    };
    ListView.prototype[list_view_common_1.iosEstimatedRowHeightProperty.setNative] = function (value) {
        var nativeView = this.ios;
        var estimatedHeight = list_view_common_1.Length.toDevicePixels(value, 0);
        nativeView.estimatedRowHeight = estimatedHeight < 0 ? DEFAULT_HEIGHT : estimatedHeight;
    };
    __decorate([
        profiling_1.profile
    ], ListView.prototype, "onLoaded", null);
    return ListView;
}(list_view_common_1.ListViewBase));
exports.ListView = ListView;
//# sourceMappingURL=list-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var action_bar_1 = __webpack_require__("../node_modules/tns-core-modules/ui/action-bar/action-bar.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var PageBase = (function (_super) {
    __extends(PageBase, _super);
    function PageBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PageBase_1 = PageBase;
    Object.defineProperty(PageBase.prototype, "navigationContext", {
        get: function () {
            return this._navigationContext;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "actionBar", {
        get: function () {
            if (!this._actionBar) {
                this.hasActionBar = true;
                this._actionBar = new action_bar_1.ActionBar();
                this._addView(this._actionBar);
            }
            return this._actionBar;
        },
        set: function (value) {
            if (!value) {
                throw new Error("ActionBar cannot be null or undefined.");
            }
            if (this._actionBar !== value) {
                if (this._actionBar) {
                    this._removeView(this._actionBar);
                }
                this.hasActionBar = true;
                this._actionBar = value;
                this._addView(this._actionBar);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "statusBarStyle", {
        get: function () {
            return this.style.statusBarStyle;
        },
        set: function (value) {
            this.style.statusBarStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "androidStatusBarBackground", {
        get: function () {
            return this.style.androidStatusBarBackground;
        },
        set: function (value) {
            this.style.androidStatusBarBackground = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(PageBase.prototype, "page", {
        get: function () {
            return this;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof action_bar_1.ActionBar) {
            this.actionBar = value;
        }
        else {
            _super.prototype._addChildFromBuilder.call(this, name, value);
        }
    };
    PageBase.prototype.getKeyframeAnimationWithName = function (animationName) {
        return this._styleScope.getKeyframeAnimationWithName(animationName);
    };
    Object.defineProperty(PageBase.prototype, "frame", {
        get: function () {
            var frame = this.parent;
            return frame instanceof frame_1.Frame ? frame : undefined;
        },
        enumerable: true,
        configurable: true
    });
    PageBase.prototype.createNavigatedData = function (eventName, isBackNavigation) {
        return {
            eventName: eventName,
            object: this,
            context: this.navigationContext,
            isBackNavigation: isBackNavigation
        };
    };
    PageBase.prototype.onNavigatingTo = function (context, isBackNavigation, bindingContext) {
        this._navigationContext = context;
        if (isBackNavigation && this._styleScope) {
            this._styleScope.ensureSelectors();
            if (!this._cssState.isSelectorsLatestVersionApplied()) {
                this._onCssStateChange();
            }
        }
        if (!isBackNavigation && bindingContext !== undefined && bindingContext !== null) {
            this.bindingContext = bindingContext;
        }
        this.notify(this.createNavigatedData(PageBase_1.navigatingToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedTo = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedToEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatingFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatingFromEvent, isBackNavigation));
    };
    PageBase.prototype.onNavigatedFrom = function (isBackNavigation) {
        this.notify(this.createNavigatedData(PageBase_1.navigatedFromEvent, isBackNavigation));
        this._navigationContext = undefined;
    };
    PageBase.prototype.eachChildView = function (callback) {
        _super.prototype.eachChildView.call(this, callback);
        if (this.actionBar) {
            callback(this.actionBar);
        }
    };
    Object.defineProperty(PageBase.prototype, "_childrenCount", {
        get: function () {
            return (this.content ? 1 : 0) + (this._actionBar ? 1 : 0);
        },
        enumerable: true,
        configurable: true
    });
    var PageBase_1;
    PageBase.navigatingToEvent = "navigatingTo";
    PageBase.navigatedToEvent = "navigatedTo";
    PageBase.navigatingFromEvent = "navigatingFrom";
    PageBase.navigatedFromEvent = "navigatedFrom";
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedTo", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatingFrom", null);
    __decorate([
        profiling_1.profile
    ], PageBase.prototype, "onNavigatedFrom", null);
    PageBase = PageBase_1 = __decorate([
        content_view_1.CSSType("Page")
    ], PageBase);
    return PageBase;
}(content_view_1.ContentView));
exports.PageBase = PageBase;
PageBase.prototype.recycleNativeView = "never";
exports.actionBarHiddenProperty = new content_view_1.Property({ name: "actionBarHidden", affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.actionBarHiddenProperty.register(PageBase);
exports.backgroundSpanUnderStatusBarProperty = new content_view_1.Property({ name: "backgroundSpanUnderStatusBar", defaultValue: false, affectsLayout: content_view_1.isIOS, valueConverter: content_view_1.booleanConverter });
exports.backgroundSpanUnderStatusBarProperty.register(PageBase);
exports.enableSwipeBackNavigationProperty = new content_view_1.Property({ name: "enableSwipeBackNavigation", defaultValue: true, valueConverter: content_view_1.booleanConverter });
exports.enableSwipeBackNavigationProperty.register(PageBase);
exports.statusBarStyleProperty = new content_view_1.CssProperty({ name: "statusBarStyle", cssName: "status-bar-style" });
exports.statusBarStyleProperty.register(content_view_1.Style);
exports.androidStatusBarBackgroundProperty = new content_view_1.CssProperty({
    name: "androidStatusBarBackground", cssName: "android-status-bar-background",
    equalityComparer: content_view_1.Color.equals, valueConverter: function (v) { return new content_view_1.Color(v); }
});
exports.androidStatusBarBackgroundProperty.register(content_view_1.Style);
//# sourceMappingURL=page-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/page/page.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var page_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/page/page-common.js"));
var ENTRY = "_entry";
var DELEGATE = "_delegate";
var TRANSITION = "_transition";
var NON_ANIMATED_TRANSITION = "non-animated";
var majorVersion = utils_1.ios.MajorVersion;
function isBackNavigationTo(page, entry) {
    var frame = page.frame;
    if (!frame) {
        return false;
    }
    var navigationContext = frame._executingContext || { navigationType: frame_common_1.NavigationType.back };
    var isReplace = navigationContext.navigationType === frame_common_1.NavigationType.replace;
    if (isReplace) {
        return false;
    }
    if (frame.navigationQueueIsEmpty()) {
        return true;
    }
    var navigationQueue = frame._navigationQueue;
    for (var i = 0; i < navigationQueue.length; i++) {
        if (navigationQueue[i].entry === entry) {
            return navigationQueue[i].navigationType === frame_common_1.NavigationType.back;
        }
    }
    return false;
}
function isBackNavigationFrom(controller, page) {
    if (!page.frame) {
        return false;
    }
    if (controller.isBackstackCleared || controller.isBackstackSkipped) {
        return false;
    }
    if (controller.navigationController && controller.navigationController.viewControllers.containsObject(controller)) {
        return false;
    }
    return true;
}
var UIViewControllerImpl = (function (_super) {
    __extends(UIViewControllerImpl, _super);
    function UIViewControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIViewControllerImpl.initWithOwner = function (owner) {
        var controller = UIViewControllerImpl.new();
        controller._owner = owner;
        return controller;
    };
    UIViewControllerImpl.prototype.viewDidLoad = function () {
        _super.prototype.viewDidLoad.call(this);
        this.extendedLayoutIncludesOpaqueBars = true;
    };
    UIViewControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        var frame = this.navigationController ? this.navigationController.owner : null;
        var newEntry = this[ENTRY];
        if (!owner._presentedViewController && newEntry && (!frame || frame.currentPage !== owner)) {
            var isBack = isBackNavigationTo(owner, newEntry);
            owner.onNavigatingTo(newEntry.entry.context, isBack, newEntry.entry.bindingContext);
        }
        if (frame) {
            if (!owner.parent) {
                owner._frame = frame;
                if (!frame._styleScope) {
                    owner._updateStyleScope();
                }
                frame._addView(owner);
            }
            else if (owner.parent !== frame) {
                throw new Error("Page is already shown on another frame.");
            }
            frame._updateActionBar(owner);
        }
        view_1.ios.updateAutoAdjustScrollInsets(this, owner);
        if (!owner.isLoaded) {
            owner.callLoaded();
        }
    };
    UIViewControllerImpl.prototype.viewDidAppear = function (animated) {
        _super.prototype.viewDidAppear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        var navigationController = this.navigationController;
        var frame = navigationController ? navigationController.owner : null;
        if (!owner._presentedViewController && frame) {
            var newEntry = this[ENTRY];
            var navigationContext = frame._executingContext || { navigationType: frame_common_1.NavigationType.back };
            var isReplace = navigationContext.navigationType === frame_common_1.NavigationType.replace;
            frame.setCurrent(newEntry, navigationContext.navigationType);
            if (isReplace) {
                var controller = newEntry.resolvedPage.ios;
                if (controller) {
                    var animated_1 = frame._getIsAnimatedNavigation(newEntry.entry);
                    if (animated_1) {
                        controller[TRANSITION] = frame._getNavigationTransition(newEntry.entry);
                    }
                    else {
                        controller[TRANSITION] = { name: NON_ANIMATED_TRANSITION };
                    }
                }
            }
            frame.ios.controller.delegate = this[DELEGATE];
            frame._processNavigationQueue(owner);
            if (frame.canGoBack()) {
                navigationController.interactivePopGestureRecognizer.delegate = navigationController;
                navigationController.interactivePopGestureRecognizer.enabled = owner.enableSwipeBackNavigation;
            }
            else {
                navigationController.interactivePopGestureRecognizer.enabled = false;
            }
        }
        if (!this.presentedViewController) {
            owner._presentedViewController = null;
        }
    };
    UIViewControllerImpl.prototype.viewWillDisappear = function (animated) {
        _super.prototype.viewWillDisappear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        if (!owner._presentedViewController) {
            owner._presentedViewController = this.presentedViewController;
        }
        var frame = owner.frame;
        var tab = this.tabBarController;
        if (owner.onNavigatingFrom && !owner._presentedViewController && !this.presentingViewController && frame && frame.currentPage === owner) {
            var willSelectViewController = tab && tab._willSelectViewController;
            if (!willSelectViewController
                || willSelectViewController === tab.selectedViewController) {
                var isBack = isBackNavigationFrom(this, owner);
                owner.onNavigatingFrom(isBack);
            }
        }
    };
    UIViewControllerImpl.prototype.viewDidDisappear = function (animated) {
        _super.prototype.viewDidDisappear.call(this, animated);
        var page = this._owner.get();
        if (!page || page.modal || page._presentedViewController) {
            return;
        }
        if (page.isLoaded) {
            page.callUnloaded();
        }
    };
    UIViewControllerImpl.prototype.viewWillLayoutSubviews = function () {
        _super.prototype.viewWillLayoutSubviews.call(this);
        var owner = this._owner.get();
        if (owner) {
            view_1.ios.updateConstraints(this, owner);
        }
    };
    UIViewControllerImpl.prototype.viewDidLayoutSubviews = function () {
        _super.prototype.viewDidLayoutSubviews.call(this);
        var owner = this._owner.get();
        if (owner) {
            if (majorVersion >= 11) {
                var frame = owner.parent;
                var frameParent = frame && frame.parent;
                while (frameParent && !frameParent.nativeViewProtected) {
                    frameParent = frameParent.parent;
                }
                if (frameParent) {
                    var parentPageInsetsTop = frameParent.nativeViewProtected.safeAreaInsets.top;
                    var currentInsetsTop = this.view.safeAreaInsets.top;
                    var additionalInsetsTop = Math.max(parentPageInsetsTop - currentInsetsTop, 0);
                    var parentPageInsetsBottom = frameParent.nativeViewProtected.safeAreaInsets.bottom;
                    var currentInsetsBottom = this.view.safeAreaInsets.bottom;
                    var additionalInsetsBottom = Math.max(parentPageInsetsBottom - currentInsetsBottom, 0);
                    if (additionalInsetsTop > 0 || additionalInsetsBottom > 0) {
                        var additionalInsets = new UIEdgeInsets({ top: additionalInsetsTop, left: 0, bottom: additionalInsetsBottom, right: 0 });
                        this.additionalSafeAreaInsets = additionalInsets;
                    }
                }
            }
            view_1.ios.layoutView(this, owner);
        }
    };
    __decorate([
        profiling_1.profile
    ], UIViewControllerImpl.prototype, "viewDidAppear", null);
    __decorate([
        profiling_1.profile
    ], UIViewControllerImpl.prototype, "viewWillDisappear", null);
    __decorate([
        profiling_1.profile
    ], UIViewControllerImpl.prototype, "viewDidDisappear", null);
    return UIViewControllerImpl;
}(UIViewController));
var whiteColor = new page_common_1.Color("white").ios;
var Page = (function (_super) {
    __extends(Page, _super);
    function Page() {
        var _this = _super.call(this) || this;
        var controller = UIViewControllerImpl.initWithOwner(new WeakRef(_this));
        _this.viewController = _this._ios = controller;
        controller.view.backgroundColor = whiteColor;
        return _this;
    }
    Page.prototype.createNativeView = function () {
        return this.viewController.view;
    };
    Object.defineProperty(Page.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Page.prototype, "frame", {
        get: function () {
            return this._frame;
        },
        enumerable: true,
        configurable: true
    });
    Page.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    Page.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    Page.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        if (this.hasActionBar) {
            this.actionBar.update();
        }
    };
    Page.prototype.updateStatusBar = function () {
        this._updateStatusBarStyle(this.statusBarStyle);
    };
    Page.prototype._updateStatusBarStyle = function (value) {
        var frame = this.frame;
        if (this.frame && value) {
            var navigationController = frame.ios.controller;
            var navigationBar = navigationController.navigationBar;
            navigationBar.barStyle = value === "dark" ? 1 : 0;
        }
    };
    Page.prototype._updateEnableSwipeBackNavigation = function (enabled) {
        var navController = this._ios.navigationController;
        if (this.frame && navController && navController.interactivePopGestureRecognizer) {
            enabled = enabled && this.frame.canGoBack();
            navController.interactivePopGestureRecognizer.enabled = enabled;
        }
    };
    Page.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = page_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = page_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = page_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = page_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        if (this.frame && this.frame._getNavBarVisible(this)) {
            var _a = this.actionBar._getActualSize, width_1 = _a.width, height_1 = _a.height;
            var widthSpec = page_common_1.layout.makeMeasureSpec(width_1, page_common_1.layout.EXACTLY);
            var heightSpec = page_common_1.layout.makeMeasureSpec(height_1, page_common_1.layout.EXACTLY);
            page_common_1.View.measureChild(this, this.actionBar, widthSpec, heightSpec);
        }
        var result = page_common_1.View.measureChild(this, this.layoutView, widthMeasureSpec, heightMeasureSpec);
        var measureWidth = Math.max(result.measuredWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(result.measuredHeight, this.effectiveMinHeight);
        var widthAndState = page_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = page_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Page.prototype.onLayout = function (left, top, right, bottom) {
        var _a = this.actionBar._getActualSize, actionBarWidth = _a.width, actionBarHeight = _a.height;
        page_common_1.View.layoutChild(this, this.actionBar, 0, 0, actionBarWidth, actionBarHeight);
        var insets = this.getSafeAreaInsets();
        if (majorVersion <= 10) {
            insets.top = page_common_1.layout.round(page_common_1.layout.toDevicePixels(this.viewController.view.safeAreaLayoutGuide.layoutFrame.origin.y));
        }
        var childLeft = 0 + insets.left;
        var childTop = 0 + insets.top;
        var childRight = right - insets.right;
        var childBottom = bottom - insets.bottom;
        page_common_1.View.layoutChild(this, this.layoutView, childLeft, childTop, childRight, childBottom);
    };
    Page.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (child === this.actionBar) {
            return true;
        }
        var nativeParent = this.nativeViewProtected;
        var nativeChild = child.nativeViewProtected;
        var viewController = child.ios instanceof UIViewController ? child.ios : child.viewController;
        if (viewController) {
            if (this.viewController.presentedViewController === viewController) {
                return true;
            }
            this.viewController.addChildViewController(viewController);
        }
        if (nativeParent && nativeChild) {
            if (typeof atIndex !== "number" || atIndex >= nativeParent.subviews.count) {
                nativeParent.addSubview(nativeChild);
            }
            else {
                nativeParent.insertSubviewAtIndex(nativeChild, atIndex);
            }
            return true;
        }
        return false;
    };
    Page.prototype._removeViewFromNativeVisualTree = function (child) {
        if (child === this.actionBar) {
            return;
        }
        var viewController = child.ios instanceof UIViewController ? child.ios : child.viewController;
        if (viewController) {
            viewController.removeFromParentViewController();
        }
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
    };
    Page.prototype[page_common_1.actionBarHiddenProperty.setNative] = function (value) {
        this._updateEnableSwipeBackNavigation(value);
        invalidateTopmostController(this.viewController);
        var frame = this.frame;
        if (frame) {
            frame._updateActionBar(this, true);
        }
    };
    Page.prototype[page_common_1.statusBarStyleProperty.getDefault] = function () {
        return 0;
    };
    Page.prototype[page_common_1.statusBarStyleProperty.setNative] = function (value) {
        var frame = this.frame;
        if (frame) {
            var navigationBar = frame.ios.controller.navigationBar;
            if (typeof value === "string") {
                navigationBar.barStyle = value === "dark" ? 1 : 0;
            }
            else {
                navigationBar.barStyle = value;
            }
        }
    };
    return Page;
}(page_common_1.PageBase));
exports.Page = Page;
function invalidateTopmostController(controller) {
    if (!controller) {
        return;
    }
    controller.view.setNeedsLayout();
    var presentedViewController = controller.presentedViewController;
    if (presentedViewController) {
        return invalidateTopmostController(presentedViewController);
    }
    var childControllers = controller.childViewControllers;
    var size = controller.childViewControllers.count;
    while (size > 0) {
        var childController = childControllers[--size];
        if (childController instanceof UITabBarController) {
            invalidateTopmostController(childController.selectedViewController);
        }
        else if (childController instanceof UINavigationController) {
            invalidateTopmostController(childController.topViewController);
        }
        else if (childController instanceof UISplitViewController) {
            invalidateTopmostController(childController.viewControllers.lastObject);
        }
        else {
            invalidateTopmostController(childController);
        }
    }
}
//# sourceMappingURL=page.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/placeholder/placeholder.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Placeholder = (function (_super) {
    __extends(Placeholder, _super);
    function Placeholder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Placeholder.prototype.createNativeView = function () {
        var args = { eventName: Placeholder.creatingViewEvent, object: this, view: undefined, context: this._context };
        this.notify(args);
        return args.view;
    };
    Placeholder.creatingViewEvent = "creatingView";
    return Placeholder;
}(view_1.View));
exports.Placeholder = Placeholder;
//# sourceMappingURL=placeholder.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var ProgressBase = (function (_super) {
    __extends(ProgressBase, _super);
    function ProgressBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ProgressBase = __decorate([
        view_1.CSSType("Progress")
    ], ProgressBase);
    return ProgressBase;
}(view_1.View));
exports.ProgressBase = ProgressBase;
ProgressBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value",
    defaultValue: 0,
    coerceValue: function (t, v) {
        return v < 0 ? 0 : Math.min(v, t.maxValue);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.valueProperty.register(ProgressBase);
exports.maxValueProperty = new view_1.Property({
    name: "maxValue",
    defaultValue: 100,
    valueChanged: function (target, oldValue, newValue) {
        exports.valueProperty.coerce(target);
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.maxValueProperty.register(ProgressBase);
//# sourceMappingURL=progress-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/progress/progress.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var progress_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/progress/progress-common.js"));
var Progress = (function (_super) {
    __extends(Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.createNativeView = function () {
        return UIProgressView.new();
    };
    Object.defineProperty(Progress.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Progress.prototype[progress_common_1.valueProperty.getDefault] = function () {
        return 0;
    };
    Progress.prototype[progress_common_1.valueProperty.setNative] = function (value) {
        this.ios.progress = value / this.maxValue;
    };
    Progress.prototype[progress_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Progress.prototype[progress_common_1.maxValueProperty.setNative] = function (value) {
        this.ios.progress = this.value / value;
    };
    Progress.prototype[progress_common_1.colorProperty.getDefault] = function () {
        return this.ios.progressTintColor;
    };
    Progress.prototype[progress_common_1.colorProperty.setNative] = function (value) {
        this.ios.progressTintColor = value instanceof progress_common_1.Color ? value.ios : value;
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.getDefault] = function () {
        return this.ios.trackTintColor;
    };
    Progress.prototype[progress_common_1.backgroundColorProperty.setNative] = function (value) {
        var color = value instanceof progress_common_1.Color ? value.ios : value;
        this.ios.trackTintColor = color;
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Progress.prototype[progress_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Progress;
}(progress_common_1.ProgressBase));
exports.Progress = Progress;
//# sourceMappingURL=progress.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/proxy-view-container/proxy-view-container.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var ProxyViewContainer = (function (_super) {
    __extends(ProxyViewContainer, _super);
    function ProxyViewContainer() {
        var _this = _super.call(this) || this;
        _this.nativeViewProtected = undefined;
        return _this;
    }
    Object.defineProperty(ProxyViewContainer.prototype, "ios", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "android", {
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ProxyViewContainer.prototype, "isLayoutRequested", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    ProxyViewContainer.prototype.createNativeView = function () {
        return undefined;
    };
    ProxyViewContainer.prototype._getNativeViewsCount = function () {
        var result = 0;
        this.eachChildView(function (cv) {
            result += cv._getNativeViewsCount();
            return true;
        });
        return result;
    };
    ProxyViewContainer.prototype._eachLayoutView = function (callback) {
        this.eachChildView(function (cv) {
            if (!cv.isCollapsed) {
                cv._eachLayoutView(callback);
            }
            return true;
        });
    };
    ProxyViewContainer.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ViewContainer._addViewToNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._addViewToNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            var baseIndex = 0;
            var insideIndex = 0;
            if (parent instanceof layout_base_1.LayoutBase) {
                baseIndex = parent._childIndexToNativeChildIndex(parent.getChildIndex(this));
            }
            if (atIndex !== undefined) {
                insideIndex = this._childIndexToNativeChildIndex(atIndex);
            }
            else {
                insideIndex = this._getNativeViewsCount();
            }
            if (layout_base_1.traceEnabled()) {
                layout_base_1.traceWrite("ProxyViewContainer._addViewToNativeVisualTree at: " + atIndex + " base: " + baseIndex + " additional: " + insideIndex, layout_base_1.traceCategories.ViewHierarchy);
            }
            return parent._addViewToNativeVisualTree(child, baseIndex + insideIndex);
        }
        return false;
    };
    ProxyViewContainer.prototype._removeViewFromNativeVisualTree = function (child) {
        if (layout_base_1.traceEnabled()) {
            layout_base_1.traceWrite("ProxyViewContainer._removeViewFromNativeVisualTree for a child " + child + " ViewContainer.parent: " + this.parent, layout_base_1.traceCategories.ViewHierarchy);
        }
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        var parent = this.parent;
        if (parent instanceof layout_base_1.View) {
            return parent._removeViewFromNativeVisualTree(child);
        }
    };
    ProxyViewContainer.prototype._registerLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._registerLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._unregisterLayoutChild = function (child) {
        var parent = this.parent;
        if (parent instanceof layout_base_1.LayoutBase) {
            parent._unregisterLayoutChild(child);
        }
    };
    ProxyViewContainer.prototype._parentChanged = function (oldParent) {
        _super.prototype._parentChanged.call(this, oldParent);
        var addingToParent = this.parent && !oldParent;
        var newLayout = this.parent;
        var oldLayout = oldParent;
        if (addingToParent && newLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                newLayout._registerLayoutChild(child);
                return true;
            });
        }
        else if (oldLayout instanceof layout_base_1.LayoutBase) {
            this.eachLayoutChild(function (child) {
                oldLayout._unregisterLayoutChild(child);
                return true;
            });
        }
    };
    ProxyViewContainer = __decorate([
        layout_base_1.CSSType("ProxyViewContainer")
    ], ProxyViewContainer);
    return ProxyViewContainer;
}(layout_base_1.LayoutBase));
exports.ProxyViewContainer = ProxyViewContainer;
//# sourceMappingURL=proxy-view-container.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/repeater/repeater.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var label_1 = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js");
var layout_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js");
var stack_layout_1 = __webpack_require__("../node_modules/tns-core-modules/ui/layouts/stack-layout/stack-layout.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/layouts/layout-base.js"));
var knownTemplates;
(function (knownTemplates) {
    knownTemplates.itemTemplate = "itemTemplate";
})(knownTemplates = exports.knownTemplates || (exports.knownTemplates = {}));
var Repeater = (function (_super) {
    __extends(Repeater, _super);
    function Repeater() {
        var _this = _super.call(this) || this;
        _this._isDirty = false;
        _this.itemsLayout = new stack_layout_1.StackLayout();
        return _this;
    }
    Repeater.prototype.onLoaded = function () {
        if (this._isDirty) {
            this.refresh();
        }
        _super.prototype.onLoaded.call(this);
    };
    Repeater.prototype._requestRefresh = function () {
        this._isDirty = true;
        if (this.isLoaded) {
            this.refresh();
        }
    };
    Repeater.prototype.refresh = function () {
        if (this.itemsLayout) {
            this.itemsLayout.removeChildren();
        }
        if (!this.items) {
            return;
        }
        var length = this.items.length;
        for (var i = 0; i < length; i++) {
            var viewToAdd = this.itemTemplate ? builder_1.parse(this.itemTemplate, this) : this._getDefaultItemContent(i);
            var dataItem = this._getDataItem(i);
            viewToAdd.bindingContext = dataItem;
            this.itemsLayout.addChild(viewToAdd);
        }
        this._isDirty = false;
    };
    Repeater.prototype._onItemsChanged = function (data) {
        this._requestRefresh();
    };
    Repeater.prototype._getDefaultItemContent = function (index) {
        var lbl = new label_1.Label();
        lbl.bind({
            targetProperty: "text",
            sourceProperty: "$value"
        });
        return lbl;
    };
    Repeater.prototype._getDataItem = function (index) {
        var items = this.items;
        return items.getItem ? items.getItem(index) : this.items[index];
    };
    Object.defineProperty(Repeater.prototype, "_childrenCount", {
        get: function () {
            return this.itemsLayout ? 1 : 0;
        },
        enumerable: true,
        configurable: true
    });
    Repeater.prototype.eachChildView = function (callback) {
        if (this.itemsLayout) {
            callback(this.itemsLayout);
        }
    };
    Repeater.prototype.onLayout = function (left, top, right, bottom) {
        var insets = this.getSafeAreaInsets();
        var paddingLeft = this.effectiveBorderLeftWidth + this.effectivePaddingLeft + insets.left;
        var paddingTop = this.effectiveBorderTopWidth + this.effectivePaddingTop + insets.top;
        var paddingRight = this.effectiveBorderRightWidth + this.effectivePaddingRight + insets.right;
        var paddingBottom = this.effectiveBorderBottomWidth + this.effectivePaddingBottom + insets.bottom;
        var childLeft = paddingLeft;
        var childTop = paddingTop;
        var childRight = right - left - paddingRight;
        var childBottom = bottom - top - paddingBottom;
        layout_base_1.View.layoutChild(this, this.itemsLayout, childLeft, childTop, childRight, childBottom);
    };
    Repeater.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var result = layout_base_1.View.measureChild(this, this.itemsLayout, widthMeasureSpec, heightMeasureSpec);
        var width = layout_base_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = layout_base_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = layout_base_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = layout_base_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = layout_base_1.View.resolveSizeAndState(result.measuredWidth, width, widthMode, 0);
        var heightAndState = layout_base_1.View.resolveSizeAndState(result.measuredHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    __decorate([
        profiling_1.profile
    ], Repeater.prototype, "onLoaded", null);
    Repeater = __decorate([
        layout_base_1.CSSType("Repeater")
    ], Repeater);
    return Repeater;
}(layout_base_1.CustomLayoutView));
exports.Repeater = Repeater;
Repeater.prototype.recycleNativeView = "auto";
exports.itemTemplateProperty = new layout_base_1.Property({
    name: "itemTemplate", affectsLayout: true, valueChanged: function (target) {
        target._requestRefresh();
    }
});
exports.itemTemplateProperty.register(Repeater);
exports.itemsProperty = new layout_base_1.Property({
    name: "items", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.removeWeakEventListener(oldValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        if (newValue instanceof observable_array_1.ObservableArray) {
            weak_event_listener_1.addWeakEventListener(newValue, observable_array_1.ObservableArray.changeEvent, target._onItemsChanged, target);
        }
        target._requestRefresh();
    }
});
exports.itemsProperty.register(Repeater);
exports.itemsLayoutProperty = new layout_base_1.Property({
    name: "itemsLayout", affectsLayout: true, valueChanged: function (target, oldValue, newValue) {
        if (oldValue) {
            target._removeView(oldValue);
            oldValue.removeChildren();
        }
        if (newValue) {
            target._addView(newValue);
        }
        target._requestRefresh();
    }
});
exports.itemsLayoutProperty.register(Repeater);
//# sourceMappingURL=repeater.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var content_view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/content-view/content-view.js"));
var ScrollViewBase = (function (_super) {
    __extends(ScrollViewBase, _super);
    function ScrollViewBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._scrollChangeCount = 0;
        return _this;
    }
    ScrollViewBase_1 = ScrollViewBase;
    ScrollViewBase.prototype.addEventListener = function (arg, callback, thisArg) {
        _super.prototype.addEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount++;
            this.attach();
        }
    };
    ScrollViewBase.prototype.removeEventListener = function (arg, callback, thisArg) {
        _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
        if (arg === ScrollViewBase_1.scrollEvent) {
            this._scrollChangeCount--;
            this.dettach();
        }
    };
    ScrollViewBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.attach();
    };
    ScrollViewBase.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        this.dettach();
    };
    ScrollViewBase.prototype.attach = function () {
        if (this._scrollChangeCount > 0 && this.isLoaded) {
            this.attachNative();
        }
    };
    ScrollViewBase.prototype.dettach = function () {
        if (this._scrollChangeCount === 0 && this.isLoaded) {
            this.dettachNative();
        }
    };
    ScrollViewBase.prototype.attachNative = function () {
    };
    ScrollViewBase.prototype.dettachNative = function () {
    };
    Object.defineProperty(ScrollViewBase.prototype, "horizontalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "verticalOffset", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableWidth", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollViewBase.prototype, "scrollableHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    var ScrollViewBase_1;
    ScrollViewBase.scrollEvent = "scroll";
    __decorate([
        profiling_1.profile
    ], ScrollViewBase.prototype, "onLoaded", null);
    ScrollViewBase = ScrollViewBase_1 = __decorate([
        content_view_1.CSSType("ScrollView")
    ], ScrollViewBase);
    return ScrollViewBase;
}(content_view_1.ContentView));
exports.ScrollViewBase = ScrollViewBase;
var converter = content_view_1.makeParser(content_view_1.makeValidator("horizontal", "vertical"));
exports.orientationProperty = new content_view_1.Property({
    name: "orientation", defaultValue: "vertical", affectsLayout: true,
    valueChanged: function (target, oldValue, newValue) {
        target._onOrientationChanged();
    },
    valueConverter: converter
});
exports.orientationProperty.register(ScrollViewBase);
exports.scrollBarIndicatorVisibleProperty = new content_view_1.Property({
    name: "scrollBarIndicatorVisible", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.scrollBarIndicatorVisibleProperty.register(ScrollViewBase);
exports.isScrollEnabledProperty = new content_view_1.Property({
    name: "isScrollEnabled", defaultValue: true,
    valueConverter: content_view_1.booleanConverter
});
exports.isScrollEnabledProperty.register(ScrollViewBase);
//# sourceMappingURL=scroll-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/scroll-view/scroll-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var scroll_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/scroll-view/scroll-view-common.js"));
var majorVersion = utils_1.ios.MajorVersion;
var UIScrollViewDelegateImpl = (function (_super) {
    __extends(UIScrollViewDelegateImpl, _super);
    function UIScrollViewDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIScrollViewDelegateImpl.initWithOwner = function (owner) {
        var impl = UIScrollViewDelegateImpl.new();
        impl._owner = owner;
        return impl;
    };
    UIScrollViewDelegateImpl.prototype.scrollViewDidScroll = function (sv) {
        var owner = this._owner.get();
        if (owner) {
            owner.notify({
                object: owner,
                eventName: "scroll",
                scrollX: owner.horizontalOffset,
                scrollY: owner.verticalOffset
            });
        }
    };
    UIScrollViewDelegateImpl.ObjCProtocols = [UIScrollViewDelegate];
    return UIScrollViewDelegateImpl;
}(NSObject));
var ScrollView = (function (_super) {
    __extends(ScrollView, _super);
    function ScrollView() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._contentMeasuredWidth = 0;
        _this._contentMeasuredHeight = 0;
        return _this;
    }
    ScrollView.prototype.createNativeView = function () {
        var view = UIScrollView.new();
        return view;
    };
    ScrollView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this.updateScrollBarVisibility(this.scrollBarIndicatorVisible);
        this._setNativeClipToBounds();
    };
    ScrollView.prototype._setNativeClipToBounds = function () {
        this.nativeViewProtected.clipsToBounds = true;
    };
    ScrollView.prototype.attachNative = function () {
        this._delegate = UIScrollViewDelegateImpl.initWithOwner(new WeakRef(this));
        this.nativeViewProtected.delegate = this._delegate;
    };
    ScrollView.prototype.dettachNative = function () {
        this.nativeViewProtected.delegate = null;
    };
    ScrollView.prototype.updateScrollBarVisibility = function (value) {
        if (!this.nativeViewProtected) {
            return;
        }
        if (this.orientation === "horizontal") {
            this.nativeViewProtected.showsHorizontalScrollIndicator = value;
        }
        else {
            this.nativeViewProtected.showsVerticalScrollIndicator = value;
        }
    };
    Object.defineProperty(ScrollView.prototype, "horizontalOffset", {
        get: function () {
            return this.nativeViewProtected ? this.nativeViewProtected.contentOffset.x : 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "verticalOffset", {
        get: function () {
            return this.nativeViewProtected ? this.nativeViewProtected.contentOffset.y : 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableWidth", {
        get: function () {
            if (!this.nativeViewProtected || this.orientation !== "horizontal") {
                return 0;
            }
            return Math.max(0, this.nativeViewProtected.contentSize.width - this.nativeViewProtected.bounds.size.width);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ScrollView.prototype, "scrollableHeight", {
        get: function () {
            if (!this.nativeViewProtected || this.orientation !== "vertical") {
                return 0;
            }
            return Math.max(0, this.nativeViewProtected.contentSize.height - this.nativeViewProtected.bounds.size.height);
        },
        enumerable: true,
        configurable: true
    });
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.getDefault] = function () {
        return this.nativeViewProtected.scrollEnabled;
    };
    ScrollView.prototype[scroll_view_common_1.isScrollEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.scrollEnabled = value;
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.getDefault] = function () {
        return true;
    };
    ScrollView.prototype[scroll_view_common_1.scrollBarIndicatorVisibleProperty.setNative] = function (value) {
        this.updateScrollBarVisibility(value);
    };
    ScrollView.prototype.scrollToVerticalOffset = function (value, animated) {
        if (this.nativeViewProtected && this.orientation === "vertical" && this.isScrollEnabled) {
            var bounds = this.nativeViewProtected.bounds.size;
            this.nativeViewProtected.scrollRectToVisibleAnimated(CGRectMake(0, value, bounds.width, bounds.height), animated);
        }
    };
    ScrollView.prototype.scrollToHorizontalOffset = function (value, animated) {
        if (this.nativeViewProtected && this.orientation === "horizontal" && this.isScrollEnabled) {
            var bounds = this.nativeViewProtected.bounds.size;
            this.nativeViewProtected.scrollRectToVisibleAnimated(CGRectMake(value, 0, bounds.width, bounds.height), animated);
        }
    };
    ScrollView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = scroll_view_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = scroll_view_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = scroll_view_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = scroll_view_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var child = this.layoutView;
        this._contentMeasuredWidth = this.effectiveMinWidth;
        this._contentMeasuredHeight = this.effectiveMinHeight;
        if (child) {
            var childSize = void 0;
            if (this.orientation === "vertical") {
                childSize = scroll_view_common_1.View.measureChild(this, child, widthMeasureSpec, scroll_view_common_1.layout.makeMeasureSpec(0, scroll_view_common_1.layout.UNSPECIFIED));
            }
            else {
                childSize = scroll_view_common_1.View.measureChild(this, child, scroll_view_common_1.layout.makeMeasureSpec(0, scroll_view_common_1.layout.UNSPECIFIED), heightMeasureSpec);
            }
            this._contentMeasuredWidth = Math.max(childSize.measuredWidth, this.effectiveMinWidth);
            this._contentMeasuredHeight = Math.max(childSize.measuredHeight, this.effectiveMinHeight);
        }
        var widthAndState = scroll_view_common_1.View.resolveSizeAndState(this._contentMeasuredWidth, width, widthMode, 0);
        var heightAndState = scroll_view_common_1.View.resolveSizeAndState(this._contentMeasuredHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    ScrollView.prototype.onLayout = function (left, top, right, bottom) {
        var insets = this.getSafeAreaInsets();
        var width = (right - left - insets.right - insets.left);
        var height = (bottom - top - insets.bottom - insets.top);
        var nativeView = this.nativeViewProtected;
        if (majorVersion > 10) {
            nativeView.contentInsetAdjustmentBehavior = 2;
        }
        var scrollWidth = width + insets.left + insets.right;
        var scrollHeight = height + insets.top + insets.bottom;
        if (this.orientation === "horizontal") {
            scrollWidth = Math.max(this._contentMeasuredWidth + insets.left + insets.right, scrollWidth);
            width = Math.max(this._contentMeasuredWidth, width);
        }
        else {
            scrollHeight = Math.max(this._contentMeasuredHeight + insets.top + insets.bottom, scrollHeight);
            height = Math.max(this._contentMeasuredHeight, height);
        }
        nativeView.contentSize = CGSizeMake(scroll_view_common_1.layout.toDeviceIndependentPixels(scrollWidth), scroll_view_common_1.layout.toDeviceIndependentPixels(scrollHeight));
        scroll_view_common_1.View.layoutChild(this, this.layoutView, insets.left, insets.top, insets.left + width, insets.top + height);
    };
    ScrollView.prototype._onOrientationChanged = function () {
        this.updateScrollBarVisibility(this.scrollBarIndicatorVisible);
    };
    return ScrollView;
}(scroll_view_common_1.ScrollViewBase));
exports.ScrollView = ScrollView;
ScrollView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=scroll-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SearchBarBase = (function (_super) {
    __extends(SearchBarBase, _super);
    function SearchBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBarBase.submitEvent = "submit";
    SearchBarBase.clearEvent = "clear";
    SearchBarBase = __decorate([
        view_1.CSSType("SearchBar")
    ], SearchBarBase);
    return SearchBarBase;
}(view_1.View));
exports.SearchBarBase = SearchBarBase;
SearchBarBase.prototype.recycleNativeView = "auto";
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isIOS });
exports.textProperty.register(SearchBarBase);
exports.hintProperty = new view_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(SearchBarBase);
exports.textFieldHintColorProperty = new view_1.Property({ name: "textFieldHintColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldHintColorProperty.register(SearchBarBase);
exports.textFieldBackgroundColorProperty = new view_1.Property({ name: "textFieldBackgroundColor", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.textFieldBackgroundColorProperty.register(SearchBarBase);
//# sourceMappingURL=search-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/search-bar/search-bar.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var search_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/search-bar/search-bar-common.js"));
var majorVersion = utils_1.ios.MajorVersion;
var UISearchBarDelegateImpl = (function (_super) {
    __extends(UISearchBarDelegateImpl, _super);
    function UISearchBarDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UISearchBarDelegateImpl.initWithOwner = function (owner) {
        var delegate = UISearchBarDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UISearchBarDelegateImpl.prototype.searchBarTextDidChange = function (searchBar, searchText) {
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        search_bar_common_1.textProperty.nativeValueChange(owner, searchText);
        if (searchText === "") {
            owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
        }
    };
    UISearchBarDelegateImpl.prototype.searchBarCancelButtonClicked = function (searchBar) {
        searchBar.resignFirstResponder();
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        owner._emit(search_bar_common_1.SearchBarBase.clearEvent);
    };
    UISearchBarDelegateImpl.prototype.searchBarSearchButtonClicked = function (searchBar) {
        searchBar.resignFirstResponder();
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        owner._emit(search_bar_common_1.SearchBarBase.submitEvent);
    };
    UISearchBarDelegateImpl.ObjCProtocols = [UISearchBarDelegate];
    return UISearchBarDelegateImpl;
}(NSObject));
var UISearchBarImpl = (function (_super) {
    __extends(UISearchBarImpl, _super);
    function UISearchBarImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UISearchBarImpl.prototype.sizeThatFits = function (size) {
        if (majorVersion >= 11 && size.width === Number.POSITIVE_INFINITY) {
            size.width = 0;
        }
        return _super.prototype.sizeThatFits.call(this, size);
    };
    return UISearchBarImpl;
}(UISearchBar));
var SearchBar = (function (_super) {
    __extends(SearchBar, _super);
    function SearchBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SearchBar.prototype.createNativeView = function () {
        return UISearchBarImpl.new();
    };
    SearchBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UISearchBarDelegateImpl.initWithOwner(new WeakRef(this));
    };
    SearchBar.prototype.disposeNativeView = function () {
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    SearchBar.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.delegate = this._delegate;
    };
    SearchBar.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    SearchBar.prototype.dismissSoftInput = function () {
        this.ios.resignFirstResponder();
    };
    Object.defineProperty(SearchBar.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SearchBar.prototype, "_textField", {
        get: function () {
            if (!this.__textField) {
                this.__textField = this.ios.valueForKey("searchField");
            }
            return this.__textField;
        },
        enumerable: true,
        configurable: true
    });
    SearchBar.prototype[search_bar_common_1.isEnabledProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (nativeView instanceof UIControl) {
            nativeView.enabled = value;
        }
        var textField = this._textField;
        if (textField) {
            textField.enabled = value;
        }
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.getDefault] = function () {
        return this.ios.barTintColor;
    };
    SearchBar.prototype[search_bar_common_1.backgroundColorProperty.setNative] = function (value) {
        var color = value instanceof search_bar_common_1.Color ? value.ios : value;
        this.ios.barTintColor = color;
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.getDefault] = function () {
        var sf = this._textField;
        if (sf) {
            return sf.textColor;
        }
        return null;
    };
    SearchBar.prototype[search_bar_common_1.colorProperty.setNative] = function (value) {
        var sf = this._textField;
        var color = value instanceof search_bar_common_1.Color ? value.ios : value;
        if (sf) {
            sf.textColor = color;
            sf.tintColor = color;
        }
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.getDefault] = function () {
        var sf = this._textField;
        return sf ? sf.font : null;
    };
    SearchBar.prototype[search_bar_common_1.fontInternalProperty.setNative] = function (value) {
        var sf = this._textField;
        if (sf) {
            sf.font = value instanceof font_1.Font ? value.getUIFont(sf.font) : value;
        }
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    SearchBar.prototype[search_bar_common_1.textProperty.getDefault] = function () {
        return "";
    };
    SearchBar.prototype[search_bar_common_1.textProperty.setNative] = function (value) {
        var text = (value === null || value === undefined) ? "" : value.toString();
        this.ios.text = text;
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.getDefault] = function () {
        return "";
    };
    SearchBar.prototype[search_bar_common_1.hintProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.getDefault] = function () {
        var textField = this._textField;
        if (textField) {
            return textField.backgroundColor;
        }
        return null;
    };
    SearchBar.prototype[search_bar_common_1.textFieldBackgroundColorProperty.setNative] = function (value) {
        var color = value instanceof search_bar_common_1.Color ? value.ios : value;
        var textField = this._textField;
        if (textField) {
            textField.backgroundColor = color;
        }
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.getDefault] = function () {
        return null;
    };
    SearchBar.prototype[search_bar_common_1.textFieldHintColorProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    SearchBar.prototype._updateAttributedPlaceholder = function () {
        var stringValue = this.hint;
        if (stringValue === null || stringValue === void 0) {
            stringValue = "";
        }
        else {
            stringValue = stringValue + "";
        }
        if (stringValue === "") {
            stringValue = " ";
        }
        var attributes = {};
        if (this.textFieldHintColor) {
            attributes[NSForegroundColorAttributeName] = this.textFieldHintColor.ios;
        }
        var attributedPlaceholder = NSAttributedString.alloc().initWithStringAttributes(stringValue, attributes);
        this._textField.attributedPlaceholder = attributedPlaceholder;
    };
    return SearchBar;
}(search_bar_common_1.SearchBarBase));
exports.SearchBar = SearchBar;
//# sourceMappingURL=search-bar.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var SegmentedBarItemBase = (function (_super) {
    __extends(SegmentedBarItemBase, _super);
    function SegmentedBarItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(SegmentedBarItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            var strValue = (value !== null && value !== undefined) ? value.toString() : "";
            if (this._title !== strValue) {
                this._title = strValue;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarItemBase = __decorate([
        view_1.CSSType("SegmentedBarItem")
    ], SegmentedBarItemBase);
    return SegmentedBarItemBase;
}(view_1.ViewBase));
exports.SegmentedBarItemBase = SegmentedBarItemBase;
var SegmentedBarBase = (function (_super) {
    __extends(SegmentedBarBase, _super);
    function SegmentedBarBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(SegmentedBarBase.prototype, "selectedBackgroundColor", {
        get: function () {
            return this.style.selectedBackgroundColor;
        },
        set: function (value) {
            this.style.selectedBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBarBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    SegmentedBarBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "SegmentedBarItem") {
            var item = value;
            var items = this.items;
            if (!items) {
                items = new Array();
                items.push(item);
                this.items = items;
            }
            else {
                items.push(item);
                this._addView(item);
            }
            if (this.nativeViewProtected) {
                this[exports.itemsProperty.setNative](items);
            }
        }
    };
    SegmentedBarBase.prototype.onItemsChanged = function (oldItems, newItems) {
        if (oldItems) {
            for (var i = 0, count = oldItems.length; i < count; i++) {
                this._removeView(oldItems[i]);
            }
        }
        if (newItems) {
            for (var i = 0, count = newItems.length; i < count; i++) {
                this._addView(newItems[i]);
            }
        }
    };
    SegmentedBarBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    SegmentedBarBase.selectedIndexChangedEvent = "selectedIndexChanged";
    SegmentedBarBase = __decorate([
        view_1.CSSType("SegmentedBar")
    ], SegmentedBarBase);
    return SegmentedBarBase;
}(view_1.View));
exports.SegmentedBarBase = SegmentedBarBase;
SegmentedBarBase.prototype.recycleNativeView = "auto";
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1,
    valueChanged: function (target, oldValue, newValue) {
        target.notify({ eventName: SegmentedBarBase.selectedIndexChangedEvent, object: target, oldIndex: oldValue, newIndex: newValue });
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(SegmentedBarBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(SegmentedBarBase);
exports.selectedBackgroundColorProperty = new view_1.InheritedCssProperty({ name: "selectedBackgroundColor", cssName: "selected-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedBackgroundColorProperty.register(view_1.Style);
//# sourceMappingURL=segmented-bar-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var segmented_bar_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/segmented-bar/segmented-bar-common.js"));
var SegmentedBarItem = (function (_super) {
    __extends(SegmentedBarItem, _super);
    function SegmentedBarItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBarItem.prototype._update = function () {
        var parent = this.parent;
        if (parent) {
            var tabIndex = parent.items.indexOf(this);
            var title = this.title;
            title = (title === null || title === undefined) ? "" : title;
            parent.ios.setTitleForSegmentAtIndex(title, tabIndex);
        }
    };
    return SegmentedBarItem;
}(segmented_bar_common_1.SegmentedBarItemBase));
exports.SegmentedBarItem = SegmentedBarItem;
var SegmentedBar = (function (_super) {
    __extends(SegmentedBar, _super);
    function SegmentedBar() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SegmentedBar.prototype.createNativeView = function () {
        return UISegmentedControl.new();
    };
    SegmentedBar.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._selectionHandler = SelectionHandlerImpl.initWithOwner(new WeakRef(this));
        this.nativeViewProtected.addTargetActionForControlEvents(this._selectionHandler, "selected", 4096);
    };
    SegmentedBar.prototype.disposeNativeView = function () {
        this._selectionHandler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(SegmentedBar.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.getDefault] = function () {
        return -1;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedIndexProperty.setNative] = function (value) {
        this.ios.selectedSegmentIndex = value;
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    SegmentedBar.prototype[segmented_bar_common_1.itemsProperty.setNative] = function (value) {
        var segmentedControl = this.ios;
        segmentedControl.removeAllSegments();
        var newItems = value;
        if (newItems && newItems.length) {
            newItems.forEach(function (item, index, arr) {
                var title = item.title;
                title = (title === null || title === undefined) ? "" : title;
                segmentedControl.insertSegmentWithTitleAtIndexAnimated(title, index, false);
            });
        }
        segmented_bar_common_1.selectedIndexProperty.coerce(this);
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.getDefault] = function () {
        return this.ios.tintColor;
    };
    SegmentedBar.prototype[segmented_bar_common_1.selectedBackgroundColorProperty.setNative] = function (value) {
        var color = value instanceof segmented_bar_common_1.Color ? value.ios : value;
        this.ios.tintColor = color;
    };
    SegmentedBar.prototype[segmented_bar_common_1.colorProperty.getDefault] = function () {
        return null;
    };
    SegmentedBar.prototype[segmented_bar_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof segmented_bar_common_1.Color ? value.ios : value;
        var bar = this.ios;
        var currentAttrs = bar.titleTextAttributesForState(0);
        var attrs = currentAttrs ? currentAttrs.mutableCopy() : NSMutableDictionary.new();
        attrs.setValueForKey(color, NSForegroundColorAttributeName);
        bar.setTitleTextAttributesForState(attrs, 0);
    };
    SegmentedBar.prototype[segmented_bar_common_1.fontInternalProperty.getDefault] = function () {
        return null;
    };
    SegmentedBar.prototype[segmented_bar_common_1.fontInternalProperty.setNative] = function (value) {
        var font = value ? value.getUIFont(UIFont.systemFontOfSize(UIFont.labelFontSize)) : null;
        var bar = this.ios;
        var currentAttrs = bar.titleTextAttributesForState(0);
        var attrs = currentAttrs ? currentAttrs.mutableCopy() : NSMutableDictionary.new();
        attrs.setValueForKey(font, NSFontAttributeName);
        bar.setTitleTextAttributesForState(attrs, 0);
    };
    return SegmentedBar;
}(segmented_bar_common_1.SegmentedBarBase));
exports.SegmentedBar = SegmentedBar;
var SelectionHandlerImpl = (function (_super) {
    __extends(SelectionHandlerImpl, _super);
    function SelectionHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionHandlerImpl.initWithOwner = function (owner) {
        var handler = SelectionHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    SelectionHandlerImpl.prototype.selected = function (sender) {
        var owner = this._owner.get();
        if (owner) {
            owner.selectedIndex = sender.selectedSegmentIndex;
        }
    };
    SelectionHandlerImpl.ObjCExposedMethods = {
        "selected": { returns: interop.types.void, params: [UISegmentedControl] }
    };
    return SelectionHandlerImpl;
}(NSObject));
//# sourceMappingURL=segmented-bar.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SliderBase = (function (_super) {
    __extends(SliderBase, _super);
    function SliderBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SliderBase = __decorate([
        view_1.CSSType("Slider")
    ], SliderBase);
    return SliderBase;
}(view_1.View));
exports.SliderBase = SliderBase;
SliderBase.prototype.recycleNativeView = "auto";
exports.valueProperty = new view_1.CoercibleProperty({
    name: "value", defaultValue: 0, coerceValue: function (target, value) {
        value = Math.max(value, target.minValue);
        value = Math.min(value, target.maxValue);
        return value;
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.valueProperty.register(SliderBase);
exports.minValueProperty = new view_1.Property({
    name: "minValue", defaultValue: 0, valueChanged: function (target, oldValue, newValue) {
        exports.maxValueProperty.coerce(target);
        exports.valueProperty.coerce(target);
    }, valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.minValueProperty.register(SliderBase);
exports.maxValueProperty = new view_1.CoercibleProperty({
    name: "maxValue", defaultValue: 100, coerceValue: function (target, value) {
        var minValue = target.minValue;
        if (value < minValue) {
            value = minValue;
        }
        return value;
    },
    valueChanged: function (target, oldValue, newValue) { return exports.valueProperty.coerce(target); },
    valueConverter: function (v) { return view_1.isIOS ? parseFloat(v) : parseInt(v); }
});
exports.maxValueProperty.register(SliderBase);
//# sourceMappingURL=slider-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/slider/slider.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var slider_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/slider/slider-common.js"));
var SliderChangeHandlerImpl = (function (_super) {
    __extends(SliderChangeHandlerImpl, _super);
    function SliderChangeHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SliderChangeHandlerImpl.initWithOwner = function (owner) {
        var handler = SliderChangeHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    SliderChangeHandlerImpl.prototype.sliderValueChanged = function (sender) {
        var owner = this._owner.get();
        if (owner) {
            slider_common_1.valueProperty.nativeValueChange(owner, sender.value);
        }
    };
    SliderChangeHandlerImpl.ObjCExposedMethods = {
        "sliderValueChanged": { returns: interop.types.void, params: [UISlider] }
    };
    return SliderChangeHandlerImpl;
}(NSObject));
var Slider = (function (_super) {
    __extends(Slider, _super);
    function Slider() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Slider.prototype.createNativeView = function () {
        return UISlider.new();
    };
    Slider.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        nativeView.minimumValue = 0;
        nativeView.maximumValue = this.maxValue;
        this._changeHandler = SliderChangeHandlerImpl.initWithOwner(new WeakRef(this));
        nativeView.addTargetActionForControlEvents(this._changeHandler, "sliderValueChanged", 4096);
    };
    Slider.prototype.disposeNativeView = function () {
        this._changeHandler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Slider.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Slider.prototype[slider_common_1.valueProperty.getDefault] = function () {
        return 0;
    };
    Slider.prototype[slider_common_1.valueProperty.setNative] = function (value) {
        this.ios.value = value;
    };
    Slider.prototype[slider_common_1.minValueProperty.getDefault] = function () {
        return 0;
    };
    Slider.prototype[slider_common_1.minValueProperty.setNative] = function (value) {
        this.ios.minimumValue = value;
    };
    Slider.prototype[slider_common_1.maxValueProperty.getDefault] = function () {
        return 100;
    };
    Slider.prototype[slider_common_1.maxValueProperty.setNative] = function (value) {
        this.ios.maximumValue = value;
    };
    Slider.prototype[slider_common_1.colorProperty.getDefault] = function () {
        return this.ios.thumbTintColor;
    };
    Slider.prototype[slider_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof slider_common_1.Color ? value.ios : value;
        this.ios.thumbTintColor = color;
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.getDefault] = function () {
        return this.ios.minimumTrackTintColor;
    };
    Slider.prototype[slider_common_1.backgroundColorProperty.setNative] = function (value) {
        var color = value instanceof slider_common_1.Color ? value.ios : value;
        this.ios.minimumTrackTintColor = color;
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Slider.prototype[slider_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    return Slider;
}(slider_common_1.SliderBase));
exports.Slider = Slider;
//# sourceMappingURL=slider.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var Background = (function () {
    function Background() {
        this.borderTopWidth = 0;
        this.borderRightWidth = 0;
        this.borderBottomWidth = 0;
        this.borderLeftWidth = 0;
        this.borderTopLeftRadius = 0;
        this.borderTopRightRadius = 0;
        this.borderBottomLeftRadius = 0;
        this.borderBottomRightRadius = 0;
    }
    Background.prototype.clone = function () {
        var clone = new Background();
        clone.color = this.color;
        clone.image = this.image;
        clone.repeat = this.repeat;
        clone.position = this.position;
        clone.size = this.size;
        clone.borderTopColor = this.borderTopColor;
        clone.borderRightColor = this.borderRightColor;
        clone.borderBottomColor = this.borderBottomColor;
        clone.borderLeftColor = this.borderLeftColor;
        clone.borderTopWidth = this.borderTopWidth;
        clone.borderRightWidth = this.borderRightWidth;
        clone.borderBottomWidth = this.borderBottomWidth;
        clone.borderLeftWidth = this.borderLeftWidth;
        clone.borderTopLeftRadius = this.borderTopLeftRadius;
        clone.borderTopRightRadius = this.borderTopRightRadius;
        clone.borderBottomRightRadius = this.borderBottomRightRadius;
        clone.borderBottomLeftRadius = this.borderBottomLeftRadius;
        clone.clipPath = this.clipPath;
        return clone;
    };
    Background.prototype.withColor = function (value) {
        var clone = this.clone();
        clone.color = value;
        return clone;
    };
    Background.prototype.withImage = function (value) {
        var clone = this.clone();
        clone.image = value;
        return clone;
    };
    Background.prototype.withRepeat = function (value) {
        var clone = this.clone();
        clone.repeat = value;
        return clone;
    };
    Background.prototype.withPosition = function (value) {
        var clone = this.clone();
        clone.position = value;
        return clone;
    };
    Background.prototype.withSize = function (value) {
        var clone = this.clone();
        clone.size = value;
        return clone;
    };
    Background.prototype.withBorderTopColor = function (value) {
        var clone = this.clone();
        clone.borderTopColor = value;
        return clone;
    };
    Background.prototype.withBorderRightColor = function (value) {
        var clone = this.clone();
        clone.borderRightColor = value;
        return clone;
    };
    Background.prototype.withBorderBottomColor = function (value) {
        var clone = this.clone();
        clone.borderBottomColor = value;
        return clone;
    };
    Background.prototype.withBorderLeftColor = function (value) {
        var clone = this.clone();
        clone.borderLeftColor = value;
        return clone;
    };
    Background.prototype.withBorderTopWidth = function (value) {
        var clone = this.clone();
        clone.borderTopWidth = value;
        return clone;
    };
    Background.prototype.withBorderRightWidth = function (value) {
        var clone = this.clone();
        clone.borderRightWidth = value;
        return clone;
    };
    Background.prototype.withBorderBottomWidth = function (value) {
        var clone = this.clone();
        clone.borderBottomWidth = value;
        return clone;
    };
    Background.prototype.withBorderLeftWidth = function (value) {
        var clone = this.clone();
        clone.borderLeftWidth = value;
        return clone;
    };
    Background.prototype.withBorderTopLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderTopLeftRadius = value;
        return clone;
    };
    Background.prototype.withBorderTopRightRadius = function (value) {
        var clone = this.clone();
        clone.borderTopRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomRightRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomLeftRadius = value;
        return clone;
    };
    Background.prototype.withClipPath = function (value) {
        var clone = this.clone();
        clone.clipPath = value;
        return clone;
    };
    Background.prototype.isEmpty = function () {
        return !this.color
            && !this.image
            && !this.hasBorderWidth()
            && !this.hasBorderRadius()
            && !this.clipPath;
    };
    Background.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        var imagesEqual = false;
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            imagesEqual = linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            imagesEqual = value1.image === value2.image;
        }
        return color_1.Color.equals(value1.color, value2.color)
            && imagesEqual
            && value1.position === value2.position
            && value1.repeat === value2.repeat
            && value1.size === value2.size
            && color_1.Color.equals(value1.borderTopColor, value2.borderTopColor)
            && color_1.Color.equals(value1.borderRightColor, value2.borderRightColor)
            && color_1.Color.equals(value1.borderBottomColor, value2.borderBottomColor)
            && color_1.Color.equals(value1.borderLeftColor, value2.borderLeftColor)
            && value1.borderTopWidth === value2.borderTopWidth
            && value1.borderRightWidth === value2.borderRightWidth
            && value1.borderBottomWidth === value2.borderBottomWidth
            && value1.borderLeftWidth === value2.borderLeftWidth
            && value1.borderTopLeftRadius === value2.borderTopLeftRadius
            && value1.borderTopRightRadius === value2.borderTopRightRadius
            && value1.borderBottomRightRadius === value2.borderBottomRightRadius
            && value1.borderBottomLeftRadius === value2.borderBottomLeftRadius
            && value1.clipPath === value2.clipPath;
    };
    Background.prototype.hasBorderColor = function () {
        return !!this.borderTopColor || !!this.borderRightColor || !!this.borderBottomColor || !!this.borderLeftColor;
    };
    Background.prototype.hasBorderWidth = function () {
        return this.borderTopWidth > 0
            || this.borderRightWidth > 0
            || this.borderBottomWidth > 0
            || this.borderLeftWidth > 0;
    };
    Background.prototype.hasBorderRadius = function () {
        return this.borderTopLeftRadius > 0
            || this.borderTopRightRadius > 0
            || this.borderBottomRightRadius > 0
            || this.borderBottomLeftRadius > 0;
    };
    Background.prototype.hasUniformBorderColor = function () {
        return color_1.Color.equals(this.borderTopColor, this.borderRightColor)
            && color_1.Color.equals(this.borderTopColor, this.borderBottomColor)
            && color_1.Color.equals(this.borderTopColor, this.borderLeftColor);
    };
    Background.prototype.hasUniformBorderWidth = function () {
        return this.borderTopWidth === this.borderRightWidth
            && this.borderTopWidth === this.borderBottomWidth
            && this.borderTopWidth === this.borderLeftWidth;
    };
    Background.prototype.hasUniformBorderRadius = function () {
        return this.borderTopLeftRadius === this.borderTopRightRadius
            && this.borderTopLeftRadius === this.borderBottomRightRadius
            && this.borderTopLeftRadius === this.borderBottomLeftRadius;
    };
    Background.prototype.hasUniformBorder = function () {
        return this.hasUniformBorderColor()
            && this.hasUniformBorderWidth()
            && this.hasUniformBorderRadius();
    };
    Background.prototype.getUniformBorderColor = function () {
        if (this.hasUniformBorderColor()) {
            return this.borderTopColor;
        }
        return undefined;
    };
    Background.prototype.getUniformBorderWidth = function () {
        if (this.hasUniformBorderWidth()) {
            return this.borderTopWidth;
        }
        return 0;
    };
    Background.prototype.getUniformBorderRadius = function () {
        if (this.hasUniformBorderRadius()) {
            return this.borderTopLeftRadius;
        }
        return 0;
    };
    Background.prototype.toString = function () {
        return "isEmpty: " + this.isEmpty() + "; color: " + this.color + "; image: " + this.image + "; repeat: " + this.repeat + "; position: " + this.position + "; size: " + this.size + "; borderTopColor: " + this.borderTopColor + "; borderRightColor: " + this.borderRightColor + "; borderBottomColor: " + this.borderBottomColor + "; borderLeftColor: " + this.borderLeftColor + "; borderTopWidth: " + this.borderTopWidth + "; borderRightWidth: " + this.borderRightWidth + "; borderBottomWidth: " + this.borderBottomWidth + "; borderLeftWidth: " + this.borderLeftWidth + "; borderTopLeftRadius: " + this.borderTopLeftRadius + "; borderTopRightRadius: " + this.borderTopRightRadius + "; borderBottomRightRadius: " + this.borderBottomRightRadius + "; borderBottomLeftRadius: " + this.borderBottomLeftRadius + "; clipPath: " + this.clipPath + ";";
    };
    Background.default = new Background();
    return Background;
}());
exports.Background = Background;
//# sourceMappingURL=background-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var css_value_1 = __webpack_require__("../node_modules/tns-core-modules/css-value/index.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/background-common.js"));
var clearCGColor = UIColor.clearColor.CGColor;
var symbolUrl = Symbol("backgroundImageUrl");
var ios;
(function (ios) {
    function createBackgroundUIColor(view, callback, flip) {
        var background = view.style.backgroundInternal;
        var nativeView = view.nativeViewProtected;
        if (nativeView.hasNonUniformBorder) {
            unsubscribeFromScrollNotifications(view);
            clearNonUniformBorders(nativeView);
        }
        clearGradient(nativeView);
        if (background.image instanceof linear_gradient_1.LinearGradient) {
            drawGradient(nativeView, background.image);
        }
        var hasNonUniformBorderWidths = background.hasBorderWidth() && !background.hasUniformBorder();
        var hasNonUniformBorderRadiuses = background.hasBorderRadius() && !background.hasUniformBorderRadius();
        if (background.hasUniformBorderColor() && (hasNonUniformBorderWidths || hasNonUniformBorderRadiuses)) {
            drawUniformColorNonUniformBorders(nativeView, background);
            subscribeForScrollNotifications(view);
        }
        else if (background.hasUniformBorder()) {
            var layer = nativeView.layer;
            var borderColor = background.getUniformBorderColor();
            layer.borderColor = !borderColor ? undefined : borderColor.ios.CGColor;
            layer.borderWidth = utils_1.layout.toDeviceIndependentPixels(background.getUniformBorderWidth());
            var renderSize = view.getActualSize() || { width: 0, height: 0 };
            var cornerRadius = utils_1.layout.toDeviceIndependentPixels(background.getUniformBorderRadius());
            layer.cornerRadius = Math.min(Math.min(renderSize.width / 2, renderSize.height / 2), cornerRadius);
        }
        else {
            drawNoRadiusNonUniformBorders(nativeView, background);
            subscribeForScrollNotifications(view);
        }
        if (background.clipPath) {
            drawClipPath(nativeView, background);
        }
        if (!background.image || background.image instanceof linear_gradient_1.LinearGradient) {
            var uiColor = background.color ? background.color.ios : undefined;
            callback(uiColor);
        }
        else {
            setUIColorFromImage(view, nativeView, callback, flip);
        }
    }
    ios.createBackgroundUIColor = createBackgroundUIColor;
})(ios = exports.ios || (exports.ios = {}));
function onScroll(args) {
    var view = args.object;
    var nativeView = view.nativeViewProtected;
    if (nativeView instanceof UIScrollView) {
        adjustLayersForScrollView(nativeView);
    }
}
function adjustLayersForScrollView(nativeView) {
    var layer = nativeView.borderLayer;
    if (layer instanceof CALayer) {
        CATransaction.begin();
        CATransaction.setValueForKey(kCFBooleanTrue, kCATransactionDisableActions);
        var offset = nativeView.contentOffset;
        var transform = { a: 1, b: 0, c: 0, d: 1, tx: offset.x, ty: offset.y };
        layer.setAffineTransform(transform);
        if (nativeView.layer.mask) {
            nativeView.layer.mask.setAffineTransform(transform);
        }
        CATransaction.commit();
    }
}
function unsubscribeFromScrollNotifications(view) {
    if (view.nativeViewProtected instanceof UIScrollView) {
        view.off("scroll", onScroll);
    }
}
function subscribeForScrollNotifications(view) {
    if (view.nativeViewProtected instanceof UIScrollView) {
        view.on("scroll", onScroll);
        adjustLayersForScrollView(view.nativeViewProtected);
    }
}
function clearNonUniformBorders(nativeView) {
    if (nativeView.borderLayer) {
        nativeView.borderLayer.removeFromSuperlayer();
    }
    if (nativeView.hasBorderMask) {
        nativeView.layer.mask = nativeView.borderOriginalMask;
        nativeView.hasBorderMask = false;
        nativeView.borderOriginalMask = null;
    }
    if (nativeView.topBorderLayer) {
        nativeView.topBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.rightBorderLayer) {
        nativeView.rightBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.bottomBorderLayer) {
        nativeView.bottomBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.leftBorderLayer) {
        nativeView.leftBorderLayer.removeFromSuperlayer();
    }
}
var pattern = /url\(('|")(.*?)\1\)/;
function setUIColorFromImage(view, nativeView, callback, flip) {
    var frame = nativeView.frame;
    var boundsWidth = view.scaleX ? frame.size.width / view.scaleX : frame.size.width;
    var boundsHeight = view.scaleY ? frame.size.height / view.scaleY : frame.size.height;
    if (!boundsWidth || !boundsHeight) {
        return undefined;
    }
    var style = view.style;
    var background = style.backgroundInternal;
    var imageUri = background.image;
    if (imageUri) {
        var match = imageUri.match(pattern);
        if (match && match[2]) {
            imageUri = match[2];
        }
    }
    var bitmap;
    if (utils_1.isDataURI(imageUri)) {
        var base64Data = imageUri.split(",")[1];
        if (base64Data !== undefined) {
            var imageSource = image_source_1.fromBase64(base64Data);
            bitmap = imageSource && imageSource.ios;
        }
    }
    else if (utils_1.isFileOrResourcePath(imageUri)) {
        var imageSource = image_source_1.fromFileOrResource(imageUri);
        bitmap = imageSource && imageSource.ios;
    }
    else if (imageUri.indexOf("http") !== -1) {
        style[symbolUrl] = imageUri;
        image_source_1.fromUrl(imageUri).then(function (r) {
            if (style && style[symbolUrl] === imageUri) {
                uiColorFromImage(r.ios, view, callback, flip);
            }
        });
    }
    uiColorFromImage(bitmap, view, callback, flip);
}
function parsePosition(pos) {
    var values = css_value_1.parse(pos);
    if (values.length === 2) {
        return { x: values[0], y: values[1] };
    }
    if (values.length === 1 && values[0].type === "ident") {
        var val = values[0].string.toLocaleLowerCase();
        var center = { type: "ident", string: "center" };
        if (val === "left" || val === "right") {
            return { x: values[0], y: center };
        }
        else if (val === "top" || val === "bottom") {
            return { x: center, y: values[0] };
        }
        else if (val === "center") {
            return { x: center, y: center };
        }
    }
    return null;
}
function getDrawParams(image, background, width, height) {
    if (!image) {
        return null;
    }
    var res = {
        repeatX: true,
        repeatY: true,
        posX: 0,
        posY: 0,
    };
    if (background.repeat) {
        switch (background.repeat.toLowerCase()) {
            case "no-repeat":
                res.repeatX = false;
                res.repeatY = false;
                break;
            case "repeat-x":
                res.repeatY = false;
                break;
            case "repeat-y":
                res.repeatX = false;
                break;
        }
    }
    var imageSize = image.size;
    var imageWidth = imageSize.width;
    var imageHeight = imageSize.height;
    var size = background.size;
    if (size) {
        var values = css_value_1.parse(size);
        if (values.length === 2) {
            var vx = values[0];
            var vy = values[1];
            if (vx.unit === "%" && vy.unit === "%") {
                imageWidth = width * vx.value / 100;
                imageHeight = height * vy.value / 100;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
            else if (vx.type === "number" && vy.type === "number" &&
                ((vx.unit === "px" && vy.unit === "px") || (vx.unit === "" && vy.unit === ""))) {
                imageWidth = vx.value;
                imageHeight = vy.value;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
        }
        else if (values.length === 1 && values[0].type === "ident") {
            var scale = 0;
            if (values[0].string === "cover") {
                scale = Math.max(width / imageWidth, height / imageHeight);
            }
            else if (values[0].string === "contain") {
                scale = Math.min(width / imageWidth, height / imageHeight);
            }
            if (scale > 0) {
                imageWidth *= scale;
                imageHeight *= scale;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
        }
    }
    var position = background.position;
    if (position) {
        var v = parsePosition(position);
        if (v) {
            var spaceX = width - imageWidth;
            var spaceY = height - imageHeight;
            if (v.x.unit === "%" && v.y.unit === "%") {
                res.posX = spaceX * v.x.value / 100;
                res.posY = spaceY * v.y.value / 100;
            }
            else if (v.x.type === "number" && v.y.type === "number" &&
                ((v.x.unit === "px" && v.y.unit === "px") || (v.x.unit === "" && v.y.unit === ""))) {
                res.posX = v.x.value;
                res.posY = v.y.value;
            }
            else if (v.x.type === "ident" && v.y.type === "ident") {
                if (v.x.string.toLowerCase() === "center") {
                    res.posX = spaceX / 2;
                }
                else if (v.x.string.toLowerCase() === "right") {
                    res.posX = spaceX;
                }
                if (v.y.string.toLowerCase() === "center") {
                    res.posY = spaceY / 2;
                }
                else if (v.y.string.toLowerCase() === "bottom") {
                    res.posY = spaceY;
                }
            }
        }
    }
    return res;
}
function uiColorFromImage(img, view, callback, flip) {
    var background = view.style.backgroundInternal;
    if (!img) {
        callback(background.color && background.color.ios);
        return;
    }
    var nativeView = view.nativeViewProtected;
    var frame = nativeView.frame;
    var boundsWidth = view.scaleX ? frame.size.width / view.scaleX : frame.size.width;
    var boundsHeight = view.scaleY ? frame.size.height / view.scaleY : frame.size.height;
    var params = getDrawParams(img, background, boundsWidth, boundsHeight);
    if (params.sizeX > 0 && params.sizeY > 0) {
        var resizeRect = CGRectMake(0, 0, params.sizeX, params.sizeY);
        UIGraphicsBeginImageContextWithOptions(resizeRect.size, false, 0.0);
        img.drawInRect(resizeRect);
        img = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    }
    UIGraphicsBeginImageContextWithOptions(CGSizeFromString("{" + boundsWidth + "," + boundsHeight + "}"), false, 0.0);
    var context = UIGraphicsGetCurrentContext();
    if (background.color && background.color.ios) {
        CGContextSetFillColorWithColor(context, background.color.ios.CGColor);
        CGContextFillRect(context, CGRectMake(0, 0, boundsWidth, boundsHeight));
    }
    if (!params.repeatX && !params.repeatY) {
        img.drawAtPoint(CGPointMake(params.posX, params.posY));
    }
    else {
        var w = params.repeatX ? boundsWidth : img.size.width;
        var h = params.repeatY ? boundsHeight : img.size.height;
        CGContextSetPatternPhase(context, CGSizeMake(params.posX, params.posY));
        params.posX = params.repeatX ? 0 : params.posX;
        params.posY = params.repeatY ? 0 : params.posY;
        var patternRect = CGRectMake(params.posX, params.posY, w, h);
        img.drawAsPatternInRect(patternRect);
    }
    var bkgImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    if (flip) {
        var flippedImage = _flipImage(bkgImage);
        callback(UIColor.alloc().initWithPatternImage(flippedImage));
    }
    else {
        callback(UIColor.alloc().initWithPatternImage(bkgImage));
    }
}
function _flipImage(originalImage) {
    UIGraphicsBeginImageContextWithOptions(originalImage.size, false, 0.0);
    var context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    CGContextTranslateCTM(context, 0.0, originalImage.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);
    originalImage.drawInRect(CGRectMake(0, 0, originalImage.size.width, originalImage.size.height));
    CGContextRestoreGState(context);
    var flippedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return flippedImage;
}
function cssValueToDeviceIndependentPixels(source, total) {
    source = source.trim();
    if (source.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(source.replace("px", "")));
    }
    else if (source.indexOf("%") !== -1 && total > 0) {
        return (parseFloat(source.replace("%", "")) / 100) * total;
    }
    else {
        return parseFloat(source);
    }
}
function drawUniformColorNonUniformBorders(nativeView, background) {
    var layer = nativeView.layer;
    layer.backgroundColor = undefined;
    layer.borderColor = undefined;
    layer.borderWidth = 0;
    layer.cornerRadius = 0;
    var _a = layer.bounds.size, width = _a.width, height = _a.height;
    var _b = layer.bounds.origin, x = _b.x, y = _b.y;
    var left = x;
    var top = y;
    var right = x + width;
    var bottom = y + height;
    var min = Math.min, max = Math.max;
    var borderTopWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderTopWidth));
    var borderRightWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderRightWidth));
    var borderBottomWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderBottomWidth));
    var borderLeftWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderLeftWidth));
    var borderVWidth = borderTopWidth + borderBottomWidth;
    var borderHWidth = borderLeftWidth + borderRightWidth;
    var cappedBorderTopWidth = borderTopWidth && borderTopWidth * min(1, height / borderVWidth);
    var cappedBorderRightWidth = borderRightWidth && borderRightWidth * min(1, width / borderHWidth);
    var cappedBorderBottomWidth = borderBottomWidth && borderBottomWidth * min(1, height / borderVWidth);
    var cappedBorderLeftWidth = borderLeftWidth && borderLeftWidth * min(1, width / borderHWidth);
    var outerTopLeftRadius = utils_1.layout.toDeviceIndependentPixels(background.borderTopLeftRadius);
    var outerTopRightRadius = utils_1.layout.toDeviceIndependentPixels(background.borderTopRightRadius);
    var outerBottomRightRadius = utils_1.layout.toDeviceIndependentPixels(background.borderBottomRightRadius);
    var outerBottomLeftRadius = utils_1.layout.toDeviceIndependentPixels(background.borderBottomLeftRadius);
    var topRadii = outerTopLeftRadius + outerTopRightRadius;
    var rightRadii = outerTopRightRadius + outerBottomRightRadius;
    var bottomRadii = outerBottomRightRadius + outerBottomLeftRadius;
    var leftRadii = outerBottomLeftRadius + outerTopLeftRadius;
    function capRadius(a, b, c) {
        return a && Math.min(a, Math.min(b, c));
    }
    var cappedOuterTopLeftRadius = capRadius(outerTopLeftRadius, outerTopLeftRadius / topRadii * width, outerTopLeftRadius / leftRadii * height);
    var cappedOuterTopRightRadius = capRadius(outerTopRightRadius, outerTopRightRadius / topRadii * width, outerTopRightRadius / rightRadii * height);
    var cappedOuterBottomRightRadius = capRadius(outerBottomRightRadius, outerBottomRightRadius / bottomRadii * width, outerBottomRightRadius / rightRadii * height);
    var cappedOuterBottomLeftRadius = capRadius(outerBottomLeftRadius, outerBottomLeftRadius / bottomRadii * width, outerBottomLeftRadius / leftRadii * height);
    var clipPath = CGPathCreateMutable();
    CGPathMoveToPoint(clipPath, null, left + cappedOuterTopLeftRadius, top);
    CGPathAddArcToPoint(clipPath, null, right, top, right, top + cappedOuterTopRightRadius, cappedOuterTopRightRadius);
    CGPathAddArcToPoint(clipPath, null, right, bottom, right - cappedOuterBottomRightRadius, bottom, cappedOuterBottomRightRadius);
    CGPathAddArcToPoint(clipPath, null, left, bottom, left, bottom - cappedOuterBottomLeftRadius, cappedOuterBottomLeftRadius);
    CGPathAddArcToPoint(clipPath, null, left, top, left + cappedOuterTopLeftRadius, top, cappedOuterTopLeftRadius);
    CGPathCloseSubpath(clipPath);
    nativeView.borderOriginalMask = layer.mask;
    var clipShapeLayer = CAShapeLayer.layer();
    clipShapeLayer.path = clipPath;
    layer.mask = clipShapeLayer;
    nativeView.hasBorderMask = true;
    if (cappedBorderLeftWidth > 0 || cappedBorderTopWidth > 0 || cappedBorderRightWidth > 0 || cappedBorderBottomWidth > 0) {
        var borderPath = CGPathCreateMutable();
        CGPathAddRect(borderPath, null, CGRectMake(left, top, width, height));
        if (cappedBorderTopWidth > 0 || cappedBorderLeftWidth > 0) {
            CGPathMoveToPoint(borderPath, null, left + cappedOuterTopLeftRadius, top + cappedBorderTopWidth);
        }
        else {
            CGPathMoveToPoint(borderPath, null, left, top);
        }
        if (cappedBorderTopWidth > 0 || cappedBorderRightWidth > 0) {
            var innerTopRightWRadius = max(0, cappedOuterTopRightRadius - cappedBorderRightWidth);
            var innerTopRightHRadius = max(0, cappedOuterTopRightRadius - cappedBorderTopWidth);
            var innerTopRightMaxRadius = max(innerTopRightWRadius, innerTopRightHRadius);
            var innerTopRightTransform = CGAffineTransformMake(innerTopRightMaxRadius && innerTopRightWRadius / innerTopRightMaxRadius, 0, 0, innerTopRightMaxRadius && innerTopRightHRadius / innerTopRightMaxRadius, right - cappedBorderRightWidth - innerTopRightWRadius, top + cappedBorderTopWidth + innerTopRightHRadius);
            CGPathAddArc(borderPath, innerTopRightTransform, 0, 0, innerTopRightMaxRadius, Math.PI * 3 / 2, 0, false);
        }
        else {
            CGPathMoveToPoint(borderPath, null, right, top);
        }
        if (cappedBorderBottomWidth > 0 || cappedBorderRightWidth > 0) {
            var innerBottomRightWRadius = max(0, cappedOuterBottomRightRadius - cappedBorderRightWidth);
            var innerBottomRightHRadius = max(0, cappedOuterBottomRightRadius - cappedBorderBottomWidth);
            var innerBottomRightMaxRadius = max(innerBottomRightWRadius, innerBottomRightHRadius);
            var innerBottomRightTransform = CGAffineTransformMake(innerBottomRightMaxRadius && innerBottomRightWRadius / innerBottomRightMaxRadius, 0, 0, innerBottomRightMaxRadius && innerBottomRightHRadius / innerBottomRightMaxRadius, right - cappedBorderRightWidth - innerBottomRightWRadius, bottom - cappedBorderBottomWidth - innerBottomRightHRadius);
            CGPathAddArc(borderPath, innerBottomRightTransform, 0, 0, innerBottomRightMaxRadius, 0, Math.PI / 2, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, right, bottom);
        }
        if (cappedBorderBottomWidth > 0 || cappedBorderLeftWidth > 0) {
            var innerBottomLeftWRadius = max(0, cappedOuterBottomLeftRadius - cappedBorderLeftWidth);
            var innerBottomLeftHRadius = max(0, cappedOuterBottomLeftRadius - cappedBorderBottomWidth);
            var innerBottomLeftMaxRadius = max(innerBottomLeftWRadius, innerBottomLeftHRadius);
            var innerBottomLeftTransform = CGAffineTransformMake(innerBottomLeftMaxRadius && innerBottomLeftWRadius / innerBottomLeftMaxRadius, 0, 0, innerBottomLeftMaxRadius && innerBottomLeftHRadius / innerBottomLeftMaxRadius, left + cappedBorderLeftWidth + innerBottomLeftWRadius, bottom - cappedBorderBottomWidth - innerBottomLeftHRadius);
            CGPathAddArc(borderPath, innerBottomLeftTransform, 0, 0, innerBottomLeftMaxRadius, Math.PI / 2, Math.PI, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, left, bottom);
        }
        if (cappedBorderTopWidth > 0 || cappedBorderLeftWidth > 0) {
            var innerTopLeftWRadius = max(0, cappedOuterTopLeftRadius - cappedBorderLeftWidth);
            var innerTopLeftHRadius = max(0, cappedOuterTopLeftRadius - cappedBorderTopWidth);
            var innerTopLeftMaxRadius = max(innerTopLeftWRadius, innerTopLeftHRadius);
            var innerTopLeftTransform = CGAffineTransformMake(innerTopLeftMaxRadius && innerTopLeftWRadius / innerTopLeftMaxRadius, 0, 0, innerTopLeftMaxRadius && innerTopLeftHRadius / innerTopLeftMaxRadius, left + cappedBorderLeftWidth + innerTopLeftWRadius, top + cappedBorderTopWidth + innerTopLeftHRadius);
            CGPathAddArc(borderPath, innerTopLeftTransform, 0, 0, innerTopLeftMaxRadius, Math.PI, Math.PI * 3 / 2, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, left, top);
        }
        CGPathCloseSubpath(borderPath);
        var borderLayer = CAShapeLayer.layer();
        borderLayer.fillColor = background.borderTopColor && background.borderTopColor.ios.CGColor || UIColor.blackColor.CGColor;
        borderLayer.fillRule = kCAFillRuleEvenOdd;
        borderLayer.path = borderPath;
        layer.addSublayer(borderLayer);
        nativeView.borderLayer = borderLayer;
    }
    nativeView.hasNonUniformBorder = true;
}
function drawNoRadiusNonUniformBorders(nativeView, background) {
    var borderLayer = CALayer.layer();
    nativeView.layer.addSublayer(borderLayer);
    nativeView.borderLayer = borderLayer;
    borderLayer.borderColor = undefined;
    borderLayer.borderWidth = 0;
    borderLayer.cornerRadius = 0;
    var layerBounds = nativeView.layer.bounds;
    var layerOrigin = layerBounds.origin;
    var layerSize = layerBounds.size;
    var nativeViewLayerBounds = {
        left: layerOrigin.x,
        top: layerOrigin.y,
        bottom: layerSize.height,
        right: layerSize.width
    };
    var top = utils_1.layout.toDeviceIndependentPixels(background.borderTopWidth);
    var right = utils_1.layout.toDeviceIndependentPixels(background.borderRightWidth);
    var bottom = utils_1.layout.toDeviceIndependentPixels(background.borderBottomWidth);
    var left = utils_1.layout.toDeviceIndependentPixels(background.borderLeftWidth);
    var lto = { x: nativeViewLayerBounds.left, y: nativeViewLayerBounds.top };
    var lti = { x: nativeViewLayerBounds.left + left, y: nativeViewLayerBounds.top + top };
    var rto = { x: nativeViewLayerBounds.right, y: nativeViewLayerBounds.top };
    var rti = { x: nativeViewLayerBounds.right - right, y: nativeViewLayerBounds.top + top };
    var rbo = { x: nativeViewLayerBounds.right, y: nativeViewLayerBounds.bottom };
    var rbi = { x: nativeViewLayerBounds.right - right, y: nativeViewLayerBounds.bottom - bottom };
    var lbo = { x: nativeViewLayerBounds.left, y: nativeViewLayerBounds.bottom };
    var lbi = { x: nativeViewLayerBounds.left + left, y: nativeViewLayerBounds.bottom - bottom };
    var hasNonUniformBorder;
    var borderTopColor = background.borderTopColor;
    if (top > 0 && borderTopColor && borderTopColor.ios) {
        var topBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(topBorderPath, null, lto.x, lto.y);
        CGPathAddLineToPoint(topBorderPath, null, rto.x, rto.y);
        CGPathAddLineToPoint(topBorderPath, null, rti.x, rti.y);
        CGPathAddLineToPoint(topBorderPath, null, lti.x, lti.y);
        CGPathAddLineToPoint(topBorderPath, null, lto.x, lto.y);
        var topBorderLayer = CAShapeLayer.layer();
        topBorderLayer.fillColor = background.borderTopColor.ios.CGColor;
        topBorderLayer.path = topBorderPath;
        borderLayer.addSublayer(topBorderLayer);
        nativeView.topBorderLayer = topBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderRightColor = background.borderRightColor;
    if (right > 0 && borderRightColor && borderRightColor.ios) {
        var rightBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(rightBorderPath, null, rto.x, rto.y);
        CGPathAddLineToPoint(rightBorderPath, null, rbo.x, rbo.y);
        CGPathAddLineToPoint(rightBorderPath, null, rbi.x, rbi.y);
        CGPathAddLineToPoint(rightBorderPath, null, rti.x, rti.y);
        CGPathAddLineToPoint(rightBorderPath, null, rto.x, rto.y);
        var rightBorderLayer = CAShapeLayer.layer();
        rightBorderLayer.fillColor = background.borderRightColor.ios.CGColor;
        rightBorderLayer.path = rightBorderPath;
        borderLayer.addSublayer(rightBorderLayer);
        nativeView.rightBorderLayer = rightBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderBottomColor = background.borderBottomColor;
    if (bottom > 0 && borderBottomColor && borderBottomColor.ios) {
        var bottomBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(bottomBorderPath, null, rbo.x, rbo.y);
        CGPathAddLineToPoint(bottomBorderPath, null, lbo.x, lbo.y);
        CGPathAddLineToPoint(bottomBorderPath, null, lbi.x, lbi.y);
        CGPathAddLineToPoint(bottomBorderPath, null, rbi.x, rbi.y);
        CGPathAddLineToPoint(bottomBorderPath, null, rbo.x, rbo.y);
        var bottomBorderLayer = CAShapeLayer.layer();
        bottomBorderLayer.fillColor = background.borderBottomColor.ios.CGColor;
        bottomBorderLayer.path = bottomBorderPath;
        borderLayer.addSublayer(bottomBorderLayer);
        nativeView.bottomBorderLayer = bottomBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderLeftColor = background.borderLeftColor;
    if (left > 0 && borderLeftColor && borderLeftColor.ios) {
        var leftBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(leftBorderPath, null, lbo.x, lbo.y);
        CGPathAddLineToPoint(leftBorderPath, null, lto.x, lto.y);
        CGPathAddLineToPoint(leftBorderPath, null, lti.x, lti.y);
        CGPathAddLineToPoint(leftBorderPath, null, lbi.x, lbi.y);
        CGPathAddLineToPoint(leftBorderPath, null, lbo.x, lbo.y);
        var leftBorderLayer = CAShapeLayer.layer();
        leftBorderLayer.fillColor = background.borderLeftColor.ios.CGColor;
        leftBorderLayer.path = leftBorderPath;
        borderLayer.addSublayer(leftBorderLayer);
        nativeView.leftBorderLayer = leftBorderLayer;
        hasNonUniformBorder = true;
    }
    nativeView.hasNonUniformBorder = hasNonUniformBorder;
}
function drawGradient(nativeView, gradient) {
    var gradientLayer = CAGradientLayer.layer();
    gradientLayer.frame = nativeView.bounds;
    nativeView.gradientLayer = gradientLayer;
    var iosColors = NSMutableArray.alloc().initWithCapacity(gradient.colorStops.length);
    var iosStops = NSMutableArray.alloc().initWithCapacity(gradient.colorStops.length);
    var hasStops = false;
    gradient.colorStops.forEach(function (stop) {
        iosColors.addObject(stop.color.ios.CGColor);
        if (stop.offset) {
            iosStops.addObject(stop.offset.value);
            hasStops = true;
        }
    });
    gradientLayer.colors = iosColors;
    if (hasStops) {
        gradientLayer.locations = iosStops;
    }
    var alpha = gradient.angle / (Math.PI * 2);
    var startX = Math.pow(Math.sin(Math.PI * (alpha + 0.75)), 2);
    var startY = Math.pow(Math.sin(Math.PI * (alpha + 0.5)), 2);
    var endX = Math.pow(Math.sin(Math.PI * (alpha + 0.25)), 2);
    var endY = Math.pow(Math.sin(Math.PI * alpha), 2);
    gradientLayer.startPoint = { x: startX, y: startY };
    gradientLayer.endPoint = { x: endX, y: endY };
    nativeView.layer.insertSublayerAtIndex(gradientLayer, 0);
}
function clearGradient(nativeView) {
    if (nativeView.gradientLayer) {
        nativeView.gradientLayer.removeFromSuperlayer();
    }
}
function drawClipPath(nativeView, background) {
    var layer = nativeView.layer;
    var layerBounds = layer.bounds;
    var layerOrigin = layerBounds.origin;
    var layerSize = layerBounds.size;
    var bounds = {
        left: layerOrigin.x,
        top: layerOrigin.y,
        bottom: layerSize.height,
        right: layerSize.width
    };
    if (bounds.right === 0 || bounds.bottom === 0) {
        return;
    }
    var path;
    var clipPath = background.clipPath;
    var functionName = clipPath.substring(0, clipPath.indexOf("("));
    var value = clipPath.replace(functionName + "(", "").replace(")", "");
    switch (functionName) {
        case "rect":
            path = rectPath(value, bounds);
            break;
        case "inset":
            path = insetPath(value, bounds);
            break;
        case "circle":
            path = circlePath(value, bounds);
            break;
        case "ellipse":
            path = ellipsePath(value, bounds);
            break;
        case "polygon":
            path = polygonPath(value, bounds);
            break;
    }
    if (path) {
        var shape = CAShapeLayer.layer();
        shape.path = path;
        layer.mask = shape;
        nativeView.clipsToBounds = true;
        var borderWidth = background.getUniformBorderWidth();
        var borderColor = background.getUniformBorderColor();
        if (borderWidth > 0 && borderColor instanceof color_1.Color) {
            var borderLayer = CAShapeLayer.layer();
            borderLayer.path = path;
            borderLayer.lineWidth = borderWidth * 2;
            borderLayer.strokeColor = borderColor.ios.CGColor;
            borderLayer.fillColor = clearCGColor;
            borderLayer.frame = nativeView.bounds;
            layer.borderColor = undefined;
            layer.borderWidth = 0;
            layer.addSublayer(borderLayer);
        }
    }
}
function rectPath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var top = cssValueToDeviceIndependentPixels(arr[0], bounds.top);
    var right = cssValueToDeviceIndependentPixels(arr[1], bounds.right);
    var bottom = cssValueToDeviceIndependentPixels(arr[2], bounds.bottom);
    var left = cssValueToDeviceIndependentPixels(arr[3], bounds.left);
    return UIBezierPath.bezierPathWithRect(CGRectMake(left, top, right - left, bottom - top)).CGPath;
}
function insetPath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var topString;
    var rightString;
    var bottomString;
    var leftString;
    if (arr.length === 1) {
        topString = rightString = bottomString = leftString = arr[0];
    }
    else if (arr.length === 2) {
        topString = bottomString = arr[0];
        rightString = leftString = arr[1];
    }
    else if (arr.length === 3) {
        topString = arr[0];
        rightString = leftString = arr[1];
        bottomString = arr[2];
    }
    else if (arr.length === 4) {
        topString = arr[0];
        rightString = arr[1];
        bottomString = arr[2];
        leftString = arr[3];
    }
    var top = cssValueToDeviceIndependentPixels(topString, bounds.bottom);
    var right = cssValueToDeviceIndependentPixels("100%", bounds.right) - cssValueToDeviceIndependentPixels(rightString, bounds.right);
    var bottom = cssValueToDeviceIndependentPixels("100%", bounds.bottom) - cssValueToDeviceIndependentPixels(bottomString, bounds.bottom);
    var left = cssValueToDeviceIndependentPixels(leftString, bounds.right);
    return UIBezierPath.bezierPathWithRect(CGRectMake(left, top, right - left, bottom - top)).CGPath;
}
function circlePath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var radius = cssValueToDeviceIndependentPixels(arr[0], (bounds.right > bounds.bottom ? bounds.bottom : bounds.right) / 2);
    var y = cssValueToDeviceIndependentPixels(arr[2], bounds.bottom);
    var x = cssValueToDeviceIndependentPixels(arr[3], bounds.right);
    return UIBezierPath.bezierPathWithArcCenterRadiusStartAngleEndAngleClockwise(CGPointMake(x, y), radius, 0, 360, true).CGPath;
}
function ellipsePath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var rX = cssValueToDeviceIndependentPixels(arr[0], bounds.right);
    var rY = cssValueToDeviceIndependentPixels(arr[1], bounds.bottom);
    var cX = cssValueToDeviceIndependentPixels(arr[3], bounds.right);
    var cY = cssValueToDeviceIndependentPixels(arr[4], bounds.bottom);
    var left = cX - rX;
    var top = cY - rY;
    var width = rX * 2;
    var height = rY * 2;
    return UIBezierPath.bezierPathWithOvalInRect(CGRectMake(left, top, width, height)).CGPath;
}
function polygonPath(value, bounds) {
    var path = CGPathCreateMutable();
    var firstPoint;
    var arr = value.split(/[,]+/);
    for (var i = 0; i < arr.length; i++) {
        var xy = arr[i].trim().split(/[\s]+/);
        var point = {
            x: cssValueToDeviceIndependentPixels(xy[0], bounds.right),
            y: cssValueToDeviceIndependentPixels(xy[1], bounds.bottom)
        };
        if (!firstPoint) {
            firstPoint = point;
            CGPathMoveToPoint(path, null, point.x, point.y);
        }
        CGPathAddLineToPoint(path, null, point.x, point.y);
    }
    CGPathAddLineToPoint(path, null, firstPoint.x, firstPoint.y);
    return path;
}
//# sourceMappingURL=background.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/converters.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var STYLE_CURVE_MAP = Object.freeze({
    "ease": enums_1.AnimationCurve.ease,
    "linear": enums_1.AnimationCurve.linear,
    "ease-in": enums_1.AnimationCurve.easeIn,
    "ease-out": enums_1.AnimationCurve.easeOut,
    "ease-in-out": enums_1.AnimationCurve.easeInOut,
    "spring": enums_1.AnimationCurve.spring,
});
function timeConverter(value) {
    var result = parseFloat(value);
    if (value.indexOf("ms") === -1) {
        result = result * 1000;
    }
    return Math.max(0.0, result);
}
exports.timeConverter = timeConverter;
function animationTimingFunctionConverter(value) {
    return value ?
        STYLE_CURVE_MAP[value] || parseCubicBezierCurve(value) :
        enums_1.AnimationCurve.ease;
}
exports.animationTimingFunctionConverter = animationTimingFunctionConverter;
function parseCubicBezierCurve(value) {
    var coordsString = /\((.*?)\)/.exec(value);
    var coords = coordsString && coordsString[1]
        .split(",")
        .map(stringToBezieCoords);
    if (value.startsWith("cubic-bezier") &&
        coordsString &&
        coords.length === 4) {
        var _a = coords.slice(), x1 = _a[0], x2 = _a[1], y1_1 = _a[2], y2 = _a[3];
        return enums_1.AnimationCurve.cubicBezier(x1, x2, y1_1, y2);
    }
    else {
        throw new Error("Invalid value for animation: " + value);
    }
}
function stringToBezieCoords(value) {
    var result = parseFloat(value);
    if (result < 0) {
        return 0;
    }
    else if (result > 1) {
        return 1;
    }
    return result;
}
//# sourceMappingURL=converters.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-animation-parser.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var keyframe_animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
var converters_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/converters.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var ANIMATION_PROPERTY_HANDLERS = Object.freeze({
    "animation-name": function (info, value) { return info.name = value; },
    "animation-duration": function (info, value) { return info.duration = converters_1.timeConverter(value); },
    "animation-delay": function (info, value) { return info.delay = converters_1.timeConverter(value); },
    "animation-timing-function": function (info, value) { return info.curve = converters_1.animationTimingFunctionConverter(value); },
    "animation-iteration-count": function (info, value) { return info.iterations = value === "infinite" ? Number.MAX_VALUE : parseFloat(value); },
    "animation-direction": function (info, value) { return info.isReverse = value === "reverse"; },
    "animation-fill-mode": function (info, value) { return info.isForwards = value === "forwards"; }
});
var CssAnimationParser = (function () {
    function CssAnimationParser() {
    }
    CssAnimationParser.keyframeAnimationsFromCSSDeclarations = function (declarations) {
        if (declarations === null || declarations === undefined) {
            return undefined;
        }
        var animations = new Array();
        var animationInfo = undefined;
        declarations.forEach(function (_a) {
            var property = _a.property, value = _a.value;
            if (property === "animation") {
                keyframeAnimationsFromCSSProperty(value, animations);
            }
            else {
                var propertyHandler = ANIMATION_PROPERTY_HANDLERS[property];
                if (propertyHandler) {
                    if (animationInfo === undefined) {
                        animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
                        animations.push(animationInfo);
                    }
                    propertyHandler(animationInfo, value);
                }
            }
        });
        return animations.length === 0 ? undefined : animations;
    };
    CssAnimationParser.keyframesArrayFromCSS = function (keyframes) {
        var parsedKeyframes = new Array();
        for (var _i = 0, keyframes_1 = keyframes; _i < keyframes_1.length; _i++) {
            var keyframe = keyframes_1[_i];
            var declarations = parseKeyframeDeclarations(keyframe.declarations);
            for (var _a = 0, _b = keyframe.values; _a < _b.length; _a++) {
                var time_1 = _b[_a];
                if (time_1 === "from") {
                    time_1 = 0;
                }
                else if (time_1 === "to") {
                    time_1 = 1;
                }
                else {
                    time_1 = parseFloat(time_1) / 100;
                    if (time_1 < 0) {
                        time_1 = 0;
                    }
                    if (time_1 > 100) {
                        time_1 = 100;
                    }
                }
                var current = parsedKeyframes[time_1];
                if (current === undefined) {
                    current = {};
                    current.duration = time_1;
                    parsedKeyframes[time_1] = current;
                }
                for (var _c = 0, _d = keyframe.declarations; _c < _d.length; _c++) {
                    var declaration = _d[_c];
                    if (declaration.property === "animation-timing-function") {
                        current.curve = converters_1.animationTimingFunctionConverter(declaration.value);
                    }
                }
                current.declarations = declarations;
            }
        }
        var array = new Array();
        for (var parsedKeyframe in parsedKeyframes) {
            array.push(parsedKeyframes[parsedKeyframe]);
        }
        array.sort(function (a, b) { return a.duration - b.duration; });
        return array;
    };
    return CssAnimationParser;
}());
exports.CssAnimationParser = CssAnimationParser;
function keyframeAnimationsFromCSSProperty(value, animations) {
    if (typeof value === "string") {
        var values = value.split(/[,]+/);
        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {
            var parsedValue = values_1[_i];
            var animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
            var arr = parsedValue.trim().split(/[ ]+/);
            if (arr.length > 0) {
                animationInfo.name = arr[0];
            }
            if (arr.length > 1) {
                animationInfo.duration = converters_1.timeConverter(arr[1]);
            }
            if (arr.length > 2) {
                animationInfo.curve = converters_1.animationTimingFunctionConverter(arr[2]);
            }
            if (arr.length > 3) {
                animationInfo.delay = converters_1.timeConverter(arr[3]);
            }
            if (arr.length > 4) {
                animationInfo.iterations = parseInt(arr[4]);
            }
            if (arr.length > 5) {
                animationInfo.isReverse = arr[4] === "reverse";
            }
            if (arr.length > 6) {
                animationInfo.isForwards = arr[5] === "forwards";
            }
            if (arr.length > 7) {
                throw new Error("Invalid value for animation: " + value);
            }
            animations.push(animationInfo);
        }
    }
}
function parseKeyframeDeclarations(unparsedKeyframeDeclarations) {
    var declarations = unparsedKeyframeDeclarations
        .reduce(function (declarations, _a) {
        var unparsedProperty = _a.property, unparsedValue = _a.value;
        var property = properties_1.CssAnimationProperty._getByCssName(unparsedProperty);
        if (typeof unparsedProperty === "string" && property && property._valueConverter) {
            declarations[property.name] = property._valueConverter(unparsedValue);
        }
        else if (typeof unparsedValue === "string" && unparsedProperty === "transform") {
            var transformations = style_properties_1.transformConverter(unparsedValue);
            Object.assign(declarations, transformations);
        }
        return declarations;
    }, {});
    return Object.keys(declarations).map(function (property) { return ({ property: property, value: declarations[property] }); });
}
exports.parseKeyframeDeclarations = parseKeyframeDeclarations;
//# sourceMappingURL=css-animation-parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var Match;
(function (Match) {
    Match.Dynamic = true;
    Match.Static = false;
})(Match || (Match = {}));
function getNodeDirectSibling(node) {
    if (!node.parent || !node.parent.getChildIndex || !node.parent.getChildAt) {
        return null;
    }
    var nodeIndex = node.parent.getChildIndex(node);
    if (nodeIndex === 0) {
        return null;
    }
    return node.parent.getChildAt(nodeIndex - 1);
}
function SelectorProperties(specificity, rarity, dynamic) {
    if (dynamic === void 0) { dynamic = false; }
    return function (cls) {
        cls.prototype.specificity = specificity;
        cls.prototype.rarity = rarity;
        cls.prototype.combinator = undefined;
        cls.prototype.dynamic = dynamic;
        return cls;
    };
}
var SelectorCore = (function () {
    function SelectorCore() {
    }
    SelectorCore.prototype.lookupSort = function (sorter, base) { sorter.sortAsUniversal(base || this); };
    SelectorCore = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], SelectorCore);
    return SelectorCore;
}());
exports.SelectorCore = SelectorCore;
var SimpleSelector = (function (_super) {
    __extends(SimpleSelector, _super);
    function SimpleSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SimpleSelector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        else if (this.mayMatch(node)) {
            this.trackChanges(node, map);
            return true;
        }
        return false;
    };
    SimpleSelector.prototype.mayMatch = function (node) { return this.match(node); };
    SimpleSelector.prototype.trackChanges = function (node, map) {
    };
    return SimpleSelector;
}(SelectorCore));
exports.SimpleSelector = SimpleSelector;
function wrap(text) {
    return text ? " " + text + " " : "";
}
var InvalidSelector = (function (_super) {
    __extends(InvalidSelector, _super);
    function InvalidSelector(e) {
        var _this = _super.call(this) || this;
        _this.e = e;
        return _this;
    }
    InvalidSelector.prototype.toString = function () { return "<error: " + this.e + ">"; };
    InvalidSelector.prototype.match = function (node) { return false; };
    InvalidSelector.prototype.lookupSort = function (sorter, base) {
    };
    InvalidSelector = __decorate([
        SelectorProperties(0, 4, Match.Static)
    ], InvalidSelector);
    return InvalidSelector;
}(SimpleSelector));
exports.InvalidSelector = InvalidSelector;
var UniversalSelector = (function (_super) {
    __extends(UniversalSelector, _super);
    function UniversalSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UniversalSelector.prototype.toString = function () { return "*" + wrap(this.combinator); };
    UniversalSelector.prototype.match = function (node) { return true; };
    UniversalSelector = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], UniversalSelector);
    return UniversalSelector;
}(SimpleSelector));
exports.UniversalSelector = UniversalSelector;
var IdSelector = (function (_super) {
    __extends(IdSelector, _super);
    function IdSelector(id) {
        var _this = _super.call(this) || this;
        _this.id = id;
        return _this;
    }
    IdSelector.prototype.toString = function () { return "#" + this.id + wrap(this.combinator); };
    IdSelector.prototype.match = function (node) { return node.id === this.id; };
    IdSelector.prototype.lookupSort = function (sorter, base) { sorter.sortById(this.id, base || this); };
    IdSelector = __decorate([
        SelectorProperties(65536, 3, Match.Static)
    ], IdSelector);
    return IdSelector;
}(SimpleSelector));
exports.IdSelector = IdSelector;
var TypeSelector = (function (_super) {
    __extends(TypeSelector, _super);
    function TypeSelector(cssType) {
        var _this = _super.call(this) || this;
        _this.cssType = cssType;
        return _this;
    }
    TypeSelector.prototype.toString = function () { return "" + this.cssType + wrap(this.combinator); };
    TypeSelector.prototype.match = function (node) { return node.cssType === this.cssType; };
    TypeSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByType(this.cssType, base || this); };
    TypeSelector = __decorate([
        SelectorProperties(1, 1, Match.Static)
    ], TypeSelector);
    return TypeSelector;
}(SimpleSelector));
exports.TypeSelector = TypeSelector;
var ClassSelector = (function (_super) {
    __extends(ClassSelector, _super);
    function ClassSelector(cssClass) {
        var _this = _super.call(this) || this;
        _this.cssClass = cssClass;
        return _this;
    }
    ClassSelector.prototype.toString = function () { return "." + this.cssClass + wrap(this.combinator); };
    ClassSelector.prototype.match = function (node) { return node.cssClasses && node.cssClasses.has(this.cssClass); };
    ClassSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByClass(this.cssClass, base || this); };
    ClassSelector = __decorate([
        SelectorProperties(256, 2, Match.Static)
    ], ClassSelector);
    return ClassSelector;
}(SimpleSelector));
exports.ClassSelector = ClassSelector;
var AttributeSelector = (function (_super) {
    __extends(AttributeSelector, _super);
    function AttributeSelector(attribute, test, value) {
        var _this = _super.call(this) || this;
        _this.attribute = attribute;
        _this.test = test;
        _this.value = value;
        if (!test) {
            _this.match = function (node) { return !types_1.isNullOrUndefined(node[attribute]); };
            return _this;
        }
        if (!value) {
            _this.match = function (node) { return false; };
        }
        var escapedValue = utils_common_1.escapeRegexSymbols(value);
        var regexp = null;
        switch (test) {
            case "^=":
                regexp = new RegExp("^" + escapedValue);
                break;
            case "$=":
                regexp = new RegExp(escapedValue + "$");
                break;
            case "*=":
                regexp = new RegExp(escapedValue);
                break;
            case "=":
                regexp = new RegExp("^" + escapedValue + "$");
                break;
            case "~=":
                if (/\s/.test(value)) {
                    _this.match = function (node) { return false; };
                    return _this;
                }
                regexp = new RegExp("(^|\\s)" + escapedValue + "(\\s|$)");
                break;
            case "|=":
                regexp = new RegExp("^" + escapedValue + "(-|$)");
                break;
        }
        if (regexp) {
            _this.match = function (node) { return regexp.test(node[attribute] + ""); };
            return _this;
        }
        else {
            _this.match = function (node) { return false; };
            return _this;
        }
    }
    AttributeSelector.prototype.toString = function () { return "[" + this.attribute + wrap(this.test) + ((this.test && this.value) || "") + "]" + wrap(this.combinator); };
    AttributeSelector.prototype.match = function (node) { return false; };
    AttributeSelector.prototype.mayMatch = function (node) { return true; };
    AttributeSelector.prototype.trackChanges = function (node, map) { map.addAttribute(node, this.attribute); };
    AttributeSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], AttributeSelector);
    return AttributeSelector;
}(SimpleSelector));
exports.AttributeSelector = AttributeSelector;
var PseudoClassSelector = (function (_super) {
    __extends(PseudoClassSelector, _super);
    function PseudoClassSelector(cssPseudoClass) {
        var _this = _super.call(this) || this;
        _this.cssPseudoClass = cssPseudoClass;
        return _this;
    }
    PseudoClassSelector.prototype.toString = function () { return ":" + this.cssPseudoClass + wrap(this.combinator); };
    PseudoClassSelector.prototype.match = function (node) { return node.cssPseudoClasses && node.cssPseudoClasses.has(this.cssPseudoClass); };
    PseudoClassSelector.prototype.mayMatch = function (node) { return true; };
    PseudoClassSelector.prototype.trackChanges = function (node, map) { map.addPseudoClass(node, this.cssPseudoClass); };
    PseudoClassSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], PseudoClassSelector);
    return PseudoClassSelector;
}(SimpleSelector));
exports.PseudoClassSelector = PseudoClassSelector;
var SimpleSelectorSequence = (function (_super) {
    __extends(SimpleSelectorSequence, _super);
    function SimpleSelectorSequence(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.head = _this.selectors.reduce(function (prev, curr) { return !prev || (curr.rarity > prev.rarity) ? curr : prev; }, null);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    SimpleSelectorSequence.prototype.toString = function () { return "" + this.selectors.join("") + wrap(this.combinator); };
    SimpleSelectorSequence.prototype.match = function (node) { return this.selectors.every(function (sel) { return sel.match(node); }); };
    SimpleSelectorSequence.prototype.mayMatch = function (node) {
        return this.selectors.every(function (sel) { return sel.mayMatch(node); });
    };
    SimpleSelectorSequence.prototype.trackChanges = function (node, map) {
        this.selectors.forEach(function (sel) { return sel.trackChanges(node, map); });
    };
    SimpleSelectorSequence.prototype.lookupSort = function (sorter, base) {
        this.head.lookupSort(sorter, base || this);
    };
    return SimpleSelectorSequence;
}(SimpleSelector));
exports.SimpleSelectorSequence = SimpleSelectorSequence;
var Selector = (function (_super) {
    __extends(Selector, _super);
    function Selector(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        var supportedCombinator = [undefined, " ", ">", "+"];
        var siblingGroup;
        var lastGroup;
        var groups = [];
        selectors.reverse().forEach(function (sel) {
            if (supportedCombinator.indexOf(sel.combinator) === -1) {
                throw new Error("Unsupported combinator \"" + sel.combinator + "\".");
            }
            if (sel.combinator === undefined || sel.combinator === " ") {
                groups.push(lastGroup = [siblingGroup = []]);
            }
            if (sel.combinator === ">") {
                lastGroup.push(siblingGroup = []);
            }
            siblingGroup.push(sel);
        });
        _this.groups = groups.map(function (g) {
            return new Selector.ChildGroup(g.map(function (sg) {
                return new Selector.SiblingGroup(sg);
            }));
        });
        _this.last = selectors[0];
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    Selector.prototype.toString = function () { return this.selectors.join(""); };
    Selector.prototype.match = function (node) {
        return this.groups.every(function (group, i) {
            if (i === 0) {
                node = group.match(node);
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    if (node = group.match(ancestor)) {
                        return true;
                    }
                }
                return false;
            }
        });
    };
    Selector.prototype.lookupSort = function (sorter, base) {
        this.last.lookupSort(sorter, this);
    };
    Selector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        var bounds = [];
        var mayMatch = this.groups.every(function (group, i) {
            if (i === 0) {
                var nextNode = group.mayMatch(node);
                bounds.push({ left: node, right: node });
                node = nextNode;
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    var nextNode = group.mayMatch(ancestor);
                    if (nextNode) {
                        bounds.push({ left: ancestor, right: null });
                        node = nextNode;
                        return true;
                    }
                }
                return false;
            }
        });
        if (!mayMatch) {
            return false;
        }
        if (!map) {
            return mayMatch;
        }
        for (var i = 0; i < this.groups.length; i++) {
            var group_1 = this.groups[i];
            if (!group_1.dynamic) {
                continue;
            }
            var bound = bounds[i];
            var node_1 = bound.left;
            do {
                if (group_1.mayMatch(node_1)) {
                    group_1.trackChanges(node_1, map);
                }
            } while ((node_1 !== bound.right) && (node_1 = node_1.parent));
        }
        return mayMatch;
    };
    return Selector;
}(SelectorCore));
exports.Selector = Selector;
(function (Selector) {
    var ChildGroup = (function () {
        function ChildGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        ChildGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.match(node); }) ? node : null;
        };
        ChildGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.mayMatch(node); }) ? node : null;
        };
        ChildGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = node.parent) && sel.trackChanges(node, map); });
        };
        return ChildGroup;
    }());
    Selector.ChildGroup = ChildGroup;
    var SiblingGroup = (function () {
        function SiblingGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        SiblingGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.match(node); }) ? node : null;
        };
        SiblingGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.mayMatch(node); }) ? node : null;
        };
        SiblingGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.trackChanges(node, map); });
        };
        return SiblingGroup;
    }());
    Selector.SiblingGroup = SiblingGroup;
})(Selector = exports.Selector || (exports.Selector = {}));
exports.Selector = Selector;
var RuleSet = (function () {
    function RuleSet(selectors, declarations) {
        var _this = this;
        this.selectors = selectors;
        this.declarations = declarations;
        this.selectors.forEach(function (sel) { return sel.ruleset = _this; });
    }
    RuleSet.prototype.toString = function () { return this.selectors.join(", ") + " {" + this.declarations.map(function (d, i) { return "" + (i === 0 ? " " : "") + d.property + ": " + d.value; }).join("; ") + " }"; };
    RuleSet.prototype.lookupSort = function (sorter) { this.selectors.forEach(function (sel) { return sel.lookupSort(sorter); }); };
    return RuleSet;
}());
exports.RuleSet = RuleSet;
function fromAstNodes(astRules) {
    return astRules.filter(isRule).map(function (rule) {
        var declarations = rule.declarations.filter(isDeclaration).map(createDeclaration);
        var selectors = rule.selectors.map(createSelector);
        var ruleset = new RuleSet(selectors, declarations);
        return ruleset;
    });
}
exports.fromAstNodes = fromAstNodes;
function createDeclaration(decl) {
    return { property: decl.property.toLowerCase(), value: decl.value };
}
function createSimpleSelectorFromAst(ast) {
    switch (ast.type) {
        case "*": return new UniversalSelector();
        case "#": return new IdSelector(ast.identifier);
        case "": return new TypeSelector(ast.identifier.replace(/-/, "").toLowerCase());
        case ".": return new ClassSelector(ast.identifier);
        case ":": return new PseudoClassSelector(ast.identifier);
        case "[]": return ast.test ? new AttributeSelector(ast.property, ast.test, ast.value) : new AttributeSelector(ast.property);
    }
}
function createSimpleSelectorSequenceFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty simple selector sequence."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorFromAst(ast[0]);
    }
    else {
        return new SimpleSelectorSequence(ast.map(createSimpleSelectorFromAst));
    }
}
function createSelectorFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty selector."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorSequenceFromAst(ast[0][0]);
    }
    else {
        var simpleSelectorSequences = [];
        var simpleSelectorSequence = void 0;
        var combinator = void 0;
        for (var i = 0; i < ast.length; i++) {
            simpleSelectorSequence = createSimpleSelectorSequenceFromAst(ast[i][0]);
            combinator = ast[i][1];
            if (combinator) {
                simpleSelectorSequence.combinator = combinator;
            }
            simpleSelectorSequences.push(simpleSelectorSequence);
        }
        return new Selector(simpleSelectorSequences);
    }
}
function createSelector(sel) {
    try {
        var parsedSelector = parser.parseSelector(sel);
        if (!parsedSelector) {
            return new InvalidSelector(new Error("Empty selector"));
        }
        return createSelectorFromAst(parsedSelector.value);
    }
    catch (e) {
        return new InvalidSelector(e);
    }
}
exports.createSelector = createSelector;
function isRule(node) {
    return node.type === "rule";
}
function isDeclaration(node) {
    return node.type === "declaration";
}
var SelectorsMap = (function () {
    function SelectorsMap(rulesets) {
        var _this = this;
        this.id = {};
        this.class = {};
        this.type = {};
        this.universal = [];
        this.position = 0;
        rulesets.forEach(function (rule) { return rule.lookupSort(_this); });
    }
    SelectorsMap.prototype.query = function (node) {
        var _this = this;
        var selectorClasses = [
            this.universal,
            this.id[node.id],
            this.type[node.cssType]
        ];
        if (node.cssClasses) {
            node.cssClasses.forEach(function (c) { return selectorClasses.push(_this.class[c]); });
        }
        var selectors = selectorClasses
            .filter(function (arr) { return !!arr; })
            .reduce(function (cur, next) { return cur.concat(next); }, []);
        var selectorsMatch = new SelectorsMatch();
        selectorsMatch.selectors = selectors
            .filter(function (sel) { return sel.sel.accumulateChanges(node, selectorsMatch); })
            .sort(function (a, b) { return a.sel.specificity - b.sel.specificity || a.pos - b.pos; })
            .map(function (docSel) { return docSel.sel; });
        return selectorsMatch;
    };
    SelectorsMap.prototype.sortById = function (id, sel) { this.addToMap(this.id, id, sel); };
    SelectorsMap.prototype.sortByClass = function (cssClass, sel) {
        this.addToMap(this.class, cssClass, sel);
    };
    SelectorsMap.prototype.sortByType = function (cssType, sel) {
        this.addToMap(this.type, cssType, sel);
    };
    SelectorsMap.prototype.sortAsUniversal = function (sel) { this.universal.push(this.makeDocSelector(sel)); };
    SelectorsMap.prototype.addToMap = function (map, head, sel) {
        this.position++;
        var list = map[head];
        if (list) {
            list.push(this.makeDocSelector(sel));
        }
        else {
            map[head] = [this.makeDocSelector(sel)];
        }
    };
    SelectorsMap.prototype.makeDocSelector = function (sel) {
        return { sel: sel, pos: this.position++ };
    };
    return SelectorsMap;
}());
exports.SelectorsMap = SelectorsMap;
var SelectorsMatch = (function () {
    function SelectorsMatch() {
        this.changeMap = new Map();
    }
    SelectorsMatch.prototype.addAttribute = function (node, attribute) {
        var deps = this.properties(node);
        if (!deps.attributes) {
            deps.attributes = new Set();
        }
        deps.attributes.add(attribute);
    };
    SelectorsMatch.prototype.addPseudoClass = function (node, pseudoClass) {
        var deps = this.properties(node);
        if (!deps.pseudoClasses) {
            deps.pseudoClasses = new Set();
        }
        deps.pseudoClasses.add(pseudoClass);
    };
    SelectorsMatch.prototype.properties = function (node) {
        var set = this.changeMap.get(node);
        if (!set) {
            this.changeMap.set(node, set = {});
        }
        return set;
    };
    return SelectorsMatch;
}());
exports.SelectorsMatch = SelectorsMatch;
//# sourceMappingURL=css-selector.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var Font = (function () {
    function Font(fontFamily, fontSize, fontStyle, fontWeight) {
        this.fontFamily = fontFamily;
        this.fontSize = fontSize;
        this.fontStyle = fontStyle;
        this.fontWeight = fontWeight;
    }
    Object.defineProperty(Font.prototype, "isItalic", {
        get: function () {
            return this.fontStyle === FontStyle.ITALIC;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Font.prototype, "isBold", {
        get: function () {
            return this.fontWeight === FontWeight.SEMI_BOLD ||
                this.fontWeight === FontWeight.BOLD ||
                this.fontWeight === "700" ||
                this.fontWeight === FontWeight.EXTRA_BOLD ||
                this.fontWeight === FontWeight.BLACK;
        },
        enumerable: true,
        configurable: true
    });
    Font.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.fontFamily === value2.fontFamily &&
            value1.fontSize === value2.fontSize &&
            value1.fontStyle === value2.fontStyle &&
            value1.fontWeight === value2.fontWeight;
    };
    Font.default = undefined;
    return Font;
}());
exports.Font = Font;
var FontStyle;
(function (FontStyle) {
    FontStyle.NORMAL = "normal";
    FontStyle.ITALIC = "italic";
    FontStyle.isValid = properties_1.makeValidator(FontStyle.NORMAL, FontStyle.ITALIC);
    FontStyle.parse = properties_1.makeParser(FontStyle.isValid);
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.THIN = "100";
    FontWeight.EXTRA_LIGHT = "200";
    FontWeight.LIGHT = "300";
    FontWeight.NORMAL = "normal";
    FontWeight.MEDIUM = "500";
    FontWeight.SEMI_BOLD = "600";
    FontWeight.BOLD = "bold";
    FontWeight.EXTRA_BOLD = "800";
    FontWeight.BLACK = "900";
    FontWeight.isValid = properties_1.makeValidator(FontWeight.THIN, FontWeight.EXTRA_LIGHT, FontWeight.LIGHT, FontWeight.NORMAL, "400", FontWeight.MEDIUM, FontWeight.SEMI_BOLD, FontWeight.BOLD, "700", FontWeight.EXTRA_BOLD, FontWeight.BLACK);
    FontWeight.parse = properties_1.makeParser(FontWeight.isValid);
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
function parseFontFamily(value) {
    var result = new Array();
    if (!value) {
        return result;
    }
    var split = value.split(",");
    for (var i = 0; i < split.length; i++) {
        var str = split[i].trim().replace(/['"]+/g, "");
        if (str) {
            result.push(str);
        }
    }
    return result;
}
exports.parseFontFamily = parseFontFamily;
var genericFontFamilies;
(function (genericFontFamilies) {
    genericFontFamilies.serif = "serif";
    genericFontFamilies.sansSerif = "sans-serif";
    genericFontFamilies.monospace = "monospace";
    genericFontFamilies.system = "system";
})(genericFontFamilies = exports.genericFontFamilies || (exports.genericFontFamilies = {}));
var styles = new Set();
[
    FontStyle.NORMAL,
    FontStyle.ITALIC
].forEach(function (val, i, a) { return styles.add(val); });
var weights = new Set();
[
    FontWeight.THIN,
    FontWeight.EXTRA_LIGHT,
    FontWeight.LIGHT,
    FontWeight.NORMAL,
    "400",
    FontWeight.MEDIUM,
    FontWeight.SEMI_BOLD,
    FontWeight.BOLD,
    "700",
    FontWeight.EXTRA_BOLD,
    FontWeight.BLACK
].forEach(function (val, i, a) { return weights.add(val); });
function parseFont(fontValue) {
    var result = {
        fontStyle: "normal",
        fontVariant: "normal",
        fontWeight: "normal"
    };
    var parts = fontValue.split(/\s+/);
    var part;
    while (part = parts.shift()) {
        if (part === "normal") {
        }
        else if (part === "small-caps") {
            result.fontVariant = part;
        }
        else if (styles.has(part)) {
            result.fontStyle = part;
        }
        else if (weights.has(part)) {
            result.fontWeight = part;
        }
        else if (!result.fontSize) {
            var sizes = part.split("/");
            result.fontSize = sizes[0];
            result.lineHeight = sizes.length > 1 ? sizes[1] : undefined;
        }
        else {
            result.fontFamily = part;
            if (parts.length) {
                result.fontFamily += " " + parts.join(" ");
            }
            break;
        }
    }
    return result;
}
exports.parseFont = parseFont;
//# sourceMappingURL=font-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js"));
var EMULATE_OBLIQUE = true;
var OBLIQUE_TRANSFORM = CGAffineTransformMake(1, 0, 0.2, 1, 0, 0);
var DEFAULT_SERIF = "Times New Roman";
var DEFAULT_MONOSPACE = "Courier New";
var SUPPORT_FONT_WEIGHTS = parseFloat(platform_1.device.osVersion) >= 10.0;
var Font = (function (_super) {
    __extends(Font, _super);
    function Font(family, size, style, weight) {
        return _super.call(this, family, size, style, weight) || this;
    }
    Font.prototype.withFontFamily = function (family) {
        return new Font(family, this.fontSize, this.fontStyle, this.fontWeight);
    };
    Font.prototype.withFontStyle = function (style) {
        return new Font(this.fontFamily, this.fontSize, style, this.fontWeight);
    };
    Font.prototype.withFontWeight = function (weight) {
        return new Font(this.fontFamily, this.fontSize, this.fontStyle, weight);
    };
    Font.prototype.withFontSize = function (size) {
        return new Font(this.fontFamily, size, this.fontStyle, this.fontWeight);
    };
    Font.prototype.getUIFont = function (defaultFont) {
        if (!this._uiFont) {
            this._uiFont = createUIFont(this, defaultFont);
        }
        return this._uiFont;
    };
    Font.prototype.getAndroidTypeface = function () {
        return undefined;
    };
    Font.default = new Font(undefined, undefined, font_common_1.FontStyle.NORMAL, font_common_1.FontWeight.NORMAL);
    return Font;
}(font_common_1.Font));
exports.Font = Font;
function getFontFamilyRespectingGenericFonts(fontFamily) {
    if (!fontFamily) {
        return fontFamily;
    }
    switch (fontFamily.toLowerCase()) {
        case font_common_1.genericFontFamilies.serif:
            return DEFAULT_SERIF;
        case font_common_1.genericFontFamilies.monospace:
            return DEFAULT_MONOSPACE;
        default:
            return fontFamily;
    }
}
function shouldUseSystemFont(fontFamily) {
    return !fontFamily ||
        fontFamily === font_common_1.genericFontFamilies.sansSerif ||
        fontFamily === font_common_1.genericFontFamilies.system;
}
function getNativeFontWeight(fontWeight) {
    switch (fontWeight) {
        case font_common_1.FontWeight.THIN:
            return UIFontWeightUltraLight;
        case font_common_1.FontWeight.EXTRA_LIGHT:
            return UIFontWeightThin;
        case font_common_1.FontWeight.LIGHT:
            return UIFontWeightLight;
        case font_common_1.FontWeight.NORMAL:
        case "400":
        case undefined:
        case null:
            return UIFontWeightRegular;
        case font_common_1.FontWeight.MEDIUM:
            return UIFontWeightMedium;
        case font_common_1.FontWeight.SEMI_BOLD:
            return UIFontWeightSemibold;
        case font_common_1.FontWeight.BOLD:
        case "700":
            return UIFontWeightBold;
        case font_common_1.FontWeight.EXTRA_BOLD:
            return UIFontWeightHeavy;
        case font_common_1.FontWeight.BLACK:
            return UIFontWeightBlack;
        default:
            throw new Error("Invalid font weight: \"" + fontWeight + "\"");
    }
}
function getSystemFont(size, nativeWeight, italic, symbolicTraits) {
    var result = UIFont.systemFontOfSizeWeight(size, nativeWeight);
    if (italic) {
        var descriptor = result.fontDescriptor.fontDescriptorWithSymbolicTraits(symbolicTraits);
        result = UIFont.fontWithDescriptorSize(descriptor, size);
    }
    return result;
}
function createUIFont(font, defaultFont) {
    var _a, _b;
    var result;
    var size = font.fontSize || defaultFont.pointSize;
    var nativeWeight = getNativeFontWeight(font.fontWeight);
    var fontFamilies = font_common_1.parseFontFamily(font.fontFamily);
    var symbolicTraits = 0;
    if (font.isBold) {
        symbolicTraits |= 2;
    }
    if (font.isItalic) {
        symbolicTraits |= 1;
    }
    var fontDescriptorTraits = (_a = {},
        _a[UIFontSymbolicTrait] = symbolicTraits,
        _a);
    if (SUPPORT_FONT_WEIGHTS) {
        fontDescriptorTraits[UIFontWeightTrait] = nativeWeight;
    }
    for (var i = 0; i < fontFamilies.length; i++) {
        var fontFamily = getFontFamilyRespectingGenericFonts(fontFamilies[i]);
        if (shouldUseSystemFont(fontFamily)) {
            result = getSystemFont(size, nativeWeight, font.isItalic, symbolicTraits);
            break;
        }
        else {
            var fontAttributes = (_b = {},
                _b[UIFontDescriptorFamilyAttribute] = fontFamily,
                _b[UIFontDescriptorTraitsAttribute] = fontDescriptorTraits,
                _b);
            var descriptor = UIFontDescriptor.fontDescriptorWithFontAttributes(fontAttributes);
            result = UIFont.fontWithDescriptorSize(descriptor, size);
            var actualItalic = result.fontDescriptor.symbolicTraits & 1;
            if (font.isItalic && !actualItalic && EMULATE_OBLIQUE) {
                descriptor = descriptor.fontDescriptorWithMatrix(OBLIQUE_TRANSFORM);
                result = UIFont.fontWithDescriptorSize(descriptor, size);
            }
            if (result.familyName === fontFamily) {
                break;
            }
            else {
                result = null;
            }
        }
    }
    if (!result) {
        result = getSystemFont(size, nativeWeight, font.isItalic, symbolicTraits);
    }
    return result;
}
var ios;
(function (ios) {
    function registerFont(fontFile) {
        var filePath = fs.path.join(fs.knownFolders.currentApp().path, "fonts", fontFile);
        if (!fs.File.exists(filePath)) {
            filePath = fs.path.join(fs.knownFolders.currentApp().path, fontFile);
        }
        var fontData = NSFileManager.defaultManager.contentsAtPath(filePath);
        if (!fontData) {
            throw new Error("Could not load font from: " + fontFile);
        }
        var provider = CGDataProviderCreateWithCFData(fontData);
        var font = CGFontCreateWithDataProvider(provider);
        if (!font) {
            throw new Error("Could not load font from: " + fontFile);
        }
        var error = new interop.Reference();
        if (!CTFontManagerRegisterGraphicsFont(font, error)) {
            if (trace_1.isEnabled()) {
                trace_1.write("Error occur while registering font: " + CFErrorCopyDescription(error.value), trace_1.categories.Error, trace_1.messageType.error);
            }
        }
    }
    ios.registerFont = registerFont;
})(ios = exports.ios || (exports.ios = {}));
function registerFontsInFolder(fontsFolderPath) {
    var fontsFolder = fs.Folder.fromPath(fontsFolderPath);
    fontsFolder.eachEntity(function (fileEntity) {
        if (fs.Folder.exists(fs.path.join(fontsFolderPath, fileEntity.name))) {
            return true;
        }
        if (fileEntity instanceof fs.File &&
            (fileEntity.extension === ".ttf" || fileEntity.extension === ".otf")) {
            ios.registerFont(fileEntity.name);
        }
        return true;
    });
}
function registerCustomFonts() {
    var appDir = fs.knownFolders.currentApp().path;
    var fontsDir = fs.path.join(appDir, "fonts");
    if (fs.Folder.exists(fontsDir)) {
        registerFontsInFolder(fontsDir);
    }
}
registerCustomFonts();
//# sourceMappingURL=font.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/linear-gradient.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var LinearGradient = (function () {
    function LinearGradient() {
    }
    LinearGradient.parse = function (value) {
        var result = new LinearGradient();
        result.angle = value.angle;
        result.colorStops = value.colors.map(function (color) {
            var offset = color.offset || null;
            var offsetUnit;
            if (offset && offset.unit === "%") {
                offsetUnit = {
                    unit: "%",
                    value: offset.value
                };
            }
            return {
                color: new color_1.Color(color.argb),
                offset: offsetUnit
            };
        });
        return result;
    };
    LinearGradient.equals = function (first, second) {
        if (!first && !second) {
            return true;
        }
        else if (!first || !second) {
            return false;
        }
        if (first.angle !== second.angle) {
            return false;
        }
        if (first.colorStops.length !== second.colorStops.length) {
            return false;
        }
        for (var i = 0; i < first.colorStops.length; i++) {
            var firstStop = first.colorStops[i];
            var secondStop = second.colorStops[i];
            if (firstStop.offset !== secondStop.offset) {
                return false;
            }
            if (!color_1.Color.equals(firstStop.color, secondStop.color)) {
                return false;
            }
        }
        return true;
    };
    return LinearGradient;
}());
exports.LinearGradient = LinearGradient;
//# sourceMappingURL=linear-gradient.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
var matrix_1 = __webpack_require__("../node_modules/tns-core-modules/matrix/matrix.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
function equalsCommon(a, b) {
    if (a == "auto") {
        return b == "auto";
    }
    if (typeof a === "number") {
        if (b == "auto") {
            return false;
        }
        if (typeof b === "number") {
            return a == b;
        }
        if (!b) {
            return false;
        }
        return b.unit == "dip" && a == b.value;
    }
    if (b == "auto") {
        return false;
    }
    if (typeof b === "number") {
        return a ? (a.unit == "dip" && a.value == b) : false;
    }
    if (!a || !b) {
        return false;
    }
    return a.value == b.value && a.unit == b.unit;
}
function convertToStringCommon(length) {
    if (length == "auto") {
        return "auto";
    }
    if (typeof length === "number") {
        return length.toString();
    }
    var val = length.value;
    if (length.unit === "%") {
        val *= 100;
    }
    return val + length.unit;
}
function toDevicePixelsCommon(length, auto, parentAvailableWidth) {
    if (auto === void 0) { auto = Number.NaN; }
    if (parentAvailableWidth === void 0) { parentAvailableWidth = Number.NaN; }
    if (length == "auto") {
        return auto;
    }
    if (typeof length === "number") {
        return utils_1.layout.round(utils_1.layout.toDevicePixels(length));
    }
    if (!length) {
        return auto;
    }
    switch (length.unit) {
        case "px":
            return utils_1.layout.round(length.value);
        case "%":
            return utils_1.layout.round(parentAvailableWidth * length.value);
        case "dip":
        default:
            return utils_1.layout.round(utils_1.layout.toDevicePixels(length.value));
    }
}
var PercentLength;
(function (PercentLength) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            var percentIndex = stringValue.indexOf("%");
            if (percentIndex !== -1) {
                var value = void 0;
                if (percentIndex !== (stringValue.length - 1) || percentIndex === 0) {
                    value = Number.NaN;
                }
                else {
                    value = parseFloat(stringValue.substring(0, stringValue.length - 1).trim()) / 100;
                }
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "%", value: value };
            }
            else if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    PercentLength.parse = parse;
    PercentLength.equals = equalsCommon;
    PercentLength.toDevicePixels = toDevicePixelsCommon;
    PercentLength.convertToString = convertToStringCommon;
})(PercentLength = exports.PercentLength || (exports.PercentLength = {}));
var Length;
(function (Length) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    Length.parse = parse;
    Length.equals = equalsCommon;
    Length.toDevicePixels = toDevicePixelsCommon;
    Length.convertToString = convertToStringCommon;
})(Length = exports.Length || (exports.Length = {}));
exports.zeroLength = { value: 0, unit: "px" };
exports.minWidthProperty = new properties_1.CssProperty({
    name: "minWidth", cssName: "min-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinWidth = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minWidthProperty.register(properties_1.Style);
exports.minHeightProperty = new properties_1.CssProperty({
    name: "minHeight", cssName: "min-height", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinHeight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minHeightProperty.register(properties_1.Style);
exports.widthProperty = new properties_1.CssAnimationProperty({
    name: "width", cssName: "width", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse
});
exports.widthProperty.register(properties_1.Style);
exports.heightProperty = new properties_1.CssAnimationProperty({
    name: "height", cssName: "height", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse,
});
exports.heightProperty.register(properties_1.Style);
var marginProperty = new properties_1.ShorthandProperty({
    name: "margin", cssName: "margin",
    getter: function () {
        if (PercentLength.equals(this.marginTop, this.marginRight) &&
            PercentLength.equals(this.marginTop, this.marginBottom) &&
            PercentLength.equals(this.marginTop, this.marginLeft)) {
            return this.marginTop;
        }
        return PercentLength.convertToString(this.marginTop) + " " + PercentLength.convertToString(this.marginRight) + " " + PercentLength.convertToString(this.marginBottom) + " " + PercentLength.convertToString(this.marginLeft);
    },
    converter: convertToMargins
});
marginProperty.register(properties_1.Style);
exports.marginLeftProperty = new properties_1.CssProperty({ name: "marginLeft", cssName: "margin-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginLeftProperty.register(properties_1.Style);
exports.marginRightProperty = new properties_1.CssProperty({ name: "marginRight", cssName: "margin-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginRightProperty.register(properties_1.Style);
exports.marginTopProperty = new properties_1.CssProperty({ name: "marginTop", cssName: "margin-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginTopProperty.register(properties_1.Style);
exports.marginBottomProperty = new properties_1.CssProperty({ name: "marginBottom", cssName: "margin-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginBottomProperty.register(properties_1.Style);
var paddingProperty = new properties_1.ShorthandProperty({
    name: "padding", cssName: "padding",
    getter: function () {
        if (Length.equals(this.paddingTop, this.paddingRight) &&
            Length.equals(this.paddingTop, this.paddingBottom) &&
            Length.equals(this.paddingTop, this.paddingLeft)) {
            return this.paddingTop;
        }
        return Length.convertToString(this.paddingTop) + " " + Length.convertToString(this.paddingRight) + " " + Length.convertToString(this.paddingBottom) + " " + Length.convertToString(this.paddingLeft);
    },
    converter: convertToPaddings
});
paddingProperty.register(properties_1.Style);
exports.paddingLeftProperty = new properties_1.CssProperty({
    name: "paddingLeft", cssName: "padding-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingLeft = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingLeftProperty.register(properties_1.Style);
exports.paddingRightProperty = new properties_1.CssProperty({
    name: "paddingRight", cssName: "padding-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingRight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingRightProperty.register(properties_1.Style);
exports.paddingTopProperty = new properties_1.CssProperty({
    name: "paddingTop", cssName: "padding-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingTop = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingTopProperty.register(properties_1.Style);
exports.paddingBottomProperty = new properties_1.CssProperty({
    name: "paddingBottom", cssName: "padding-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingBottom = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingBottomProperty.register(properties_1.Style);
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.LEFT = "left";
    HorizontalAlignment.CENTER = "center";
    HorizontalAlignment.RIGHT = "right";
    HorizontalAlignment.STRETCH = "stretch";
    HorizontalAlignment.isValid = properties_1.makeValidator(HorizontalAlignment.LEFT, HorizontalAlignment.CENTER, HorizontalAlignment.RIGHT, HorizontalAlignment.STRETCH);
    HorizontalAlignment.parse = properties_1.makeParser(HorizontalAlignment.isValid);
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
exports.horizontalAlignmentProperty = new properties_1.CssProperty({ name: "horizontalAlignment", cssName: "horizontal-align", defaultValue: HorizontalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: HorizontalAlignment.parse });
exports.horizontalAlignmentProperty.register(properties_1.Style);
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.TOP = "top";
    VerticalAlignment.MIDDLE = "middle";
    VerticalAlignment.BOTTOM = "bottom";
    VerticalAlignment.STRETCH = "stretch";
    VerticalAlignment.isValid = properties_1.makeValidator(VerticalAlignment.TOP, VerticalAlignment.MIDDLE, VerticalAlignment.BOTTOM, VerticalAlignment.STRETCH);
    VerticalAlignment.parse = function (value) { return value.toLowerCase() === "center" ? VerticalAlignment.MIDDLE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(VerticalAlignment.isValid);
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
exports.verticalAlignmentProperty = new properties_1.CssProperty({ name: "verticalAlignment", cssName: "vertical-align", defaultValue: VerticalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: VerticalAlignment.parse });
exports.verticalAlignmentProperty.register(properties_1.Style);
function parseThickness(value) {
    if (typeof value === "string") {
        var arr = value.split(/[ ,]+/);
        var top_1;
        var right = void 0;
        var bottom = void 0;
        var left = void 0;
        if (arr.length === 1) {
            top_1 = arr[0];
            right = arr[0];
            bottom = arr[0];
            left = arr[0];
        }
        else if (arr.length === 2) {
            top_1 = arr[0];
            bottom = arr[0];
            right = arr[1];
            left = arr[1];
        }
        else if (arr.length === 3) {
            top_1 = arr[0];
            right = arr[1];
            left = arr[1];
            bottom = arr[2];
        }
        else if (arr.length === 4) {
            top_1 = arr[0];
            right = arr[1];
            bottom = arr[2];
            left = arr[3];
        }
        else {
            throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
        }
        return {
            top: top_1,
            right: right,
            bottom: bottom,
            left: left
        };
    }
    else {
        return value;
    }
}
function convertToMargins(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.marginTopProperty, PercentLength.parse(thickness.top)],
            [exports.marginRightProperty, PercentLength.parse(thickness.right)],
            [exports.marginBottomProperty, PercentLength.parse(thickness.bottom)],
            [exports.marginLeftProperty, PercentLength.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.marginTopProperty, value],
            [exports.marginRightProperty, value],
            [exports.marginBottomProperty, value],
            [exports.marginLeftProperty, value]
        ];
    }
}
function convertToPaddings(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.paddingTopProperty, Length.parse(thickness.top)],
            [exports.paddingRightProperty, Length.parse(thickness.right)],
            [exports.paddingBottomProperty, Length.parse(thickness.bottom)],
            [exports.paddingLeftProperty, Length.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.paddingTopProperty, value],
            [exports.paddingRightProperty, value],
            [exports.paddingBottomProperty, value],
            [exports.paddingLeftProperty, value]
        ];
    }
}
exports.rotateProperty = new properties_1.CssAnimationProperty({ name: "rotate", cssName: "rotate", defaultValue: 0, valueConverter: parseFloat });
exports.rotateProperty.register(properties_1.Style);
exports.scaleXProperty = new properties_1.CssAnimationProperty({ name: "scaleX", cssName: "scaleX", defaultValue: 1, valueConverter: parseFloat });
exports.scaleXProperty.register(properties_1.Style);
exports.scaleYProperty = new properties_1.CssAnimationProperty({ name: "scaleY", cssName: "scaleY", defaultValue: 1, valueConverter: parseFloat });
exports.scaleYProperty.register(properties_1.Style);
function parseDIPs(value) {
    if (value.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(value.replace("px", "").trim()));
    }
    else {
        return parseFloat(value.replace("dip", "").trim());
    }
}
exports.translateXProperty = new properties_1.CssAnimationProperty({ name: "translateX", cssName: "translateX", defaultValue: 0, valueConverter: parseDIPs });
exports.translateXProperty.register(properties_1.Style);
exports.translateYProperty = new properties_1.CssAnimationProperty({ name: "translateY", cssName: "translateY", defaultValue: 0, valueConverter: parseDIPs });
exports.translateYProperty.register(properties_1.Style);
var transformProperty = new properties_1.ShorthandProperty({
    name: "transform", cssName: "transform",
    getter: function () {
        var scaleX = this.scaleX;
        var scaleY = this.scaleY;
        var translateX = this.translateX;
        var translateY = this.translateY;
        var rotate = this.rotate;
        var result = "";
        if (translateX !== 0 || translateY !== 0) {
            result += "translate(" + translateX + ", " + translateY + ") ";
        }
        if (scaleX !== 1 || scaleY !== 1) {
            result += "scale(" + scaleX + ", " + scaleY + ") ";
        }
        if (rotate !== 0) {
            result += "rotate (" + rotate + ")";
        }
        return result.trim();
    },
    converter: convertToTransform
});
transformProperty.register(properties_1.Style);
var IDENTITY_TRANSFORMATION = {
    translate: { x: 0, y: 0 },
    rotate: 0,
    scale: { x: 1, y: 1 },
};
var TRANSFORM_SPLITTER = new RegExp(/\s*(.+?)\((.*?)\)/g);
var TRANSFORMATIONS = Object.freeze([
    "rotate",
    "translate",
    "translate3d",
    "translateX",
    "translateY",
    "scale",
    "scale3d",
    "scaleX",
    "scaleY",
]);
var STYLE_TRANSFORMATION_MAP = Object.freeze({
    "scale": function (value) { return ({ property: "scale", value: value }); },
    "scale3d": function (value) { return ({ property: "scale", value: value }); },
    "scaleX": function (_a) {
        var x = _a.x;
        return ({ property: "scale", value: { x: x, y: IDENTITY_TRANSFORMATION.scale.y } });
    },
    "scaleY": function (_a) {
        var y = _a.y;
        return ({ property: "scale", value: { y: y, x: IDENTITY_TRANSFORMATION.scale.x } });
    },
    "translate": function (value) { return ({ property: "translate", value: value }); },
    "translate3d": function (value) { return ({ property: "translate", value: value }); },
    "translateX": function (_a) {
        var x = _a.x;
        return ({ property: "translate", value: { x: x, y: IDENTITY_TRANSFORMATION.translate.y } });
    },
    "translateY": function (_a) {
        var y = _a.y;
        return ({ property: "translate", value: { y: y, x: IDENTITY_TRANSFORMATION.translate.x } });
    },
    "rotate": function (value) { return ({ property: "rotate", value: value }); },
});
function convertToTransform(value) {
    if (value === properties_1.unsetValue) {
        value = "none";
    }
    var _a = transformConverter(value), translate = _a.translate, rotate = _a.rotate, scale = _a.scale;
    return [
        [exports.translateXProperty, translate.x],
        [exports.translateYProperty, translate.y],
        [exports.scaleXProperty, scale.x],
        [exports.scaleYProperty, scale.y],
        [exports.rotateProperty, rotate],
    ];
}
function transformConverter(text) {
    var transformations = parseTransformString(text);
    if (text === "none" || text === "" || !transformations.length) {
        return IDENTITY_TRANSFORMATION;
    }
    var usedTransforms = transformations.map(function (t) { return t.property; });
    if (!utils_1.hasDuplicates(usedTransforms)) {
        var fullTransformations_1 = __assign({}, IDENTITY_TRANSFORMATION);
        transformations.forEach(function (transform) {
            fullTransformations_1[transform.property] = transform.value;
        });
        return fullTransformations_1;
    }
    var affineMatrix = transformations
        .map(matrix_1.getTransformMatrix)
        .reduce(matrix_1.multiplyAffine2d);
    var cssMatrix = matrix_1.matrixArrayToCssMatrix(affineMatrix);
    return matrix_1.decompose2DTransformMatrix(cssMatrix);
}
exports.transformConverter = transformConverter;
function parseTransformString(text) {
    var matches = [];
    var match;
    while ((match = TRANSFORM_SPLITTER.exec(text)) !== null) {
        var property = match[1];
        var value = convertTransformValue(property, match[2]);
        if (TRANSFORMATIONS.indexOf(property) !== -1) {
            matches.push(normalizeTransformation({ property: property, value: value }));
        }
    }
    return matches;
}
function normalizeTransformation(_a) {
    var property = _a.property, value = _a.value;
    return STYLE_TRANSFORMATION_MAP[property](value);
}
function convertTransformValue(property, stringValue) {
    var _a = stringValue.split(",").map(parseFloat), x = _a[0], _b = _a[1], y = _b === void 0 ? x : _b;
    if (property === "rotate") {
        return stringValue.slice(-3) === "rad" ? number_utils_1.radiansToDegrees(x) : x;
    }
    return { x: x, y: y };
}
var backgroundProperty = new properties_1.ShorthandProperty({
    name: "background", cssName: "background",
    getter: function () {
        return this.backgroundColor + " " + this.backgroundImage + " " + this.backgroundRepeat + " " + this.backgroundPosition;
    },
    converter: convertToBackgrounds
});
backgroundProperty.register(properties_1.Style);
exports.backgroundInternalProperty = new properties_1.CssProperty({
    name: "backgroundInternal",
    cssName: "_backgroundInternal",
    defaultValue: background_1.Background.default
});
exports.backgroundInternalProperty.register(properties_1.Style);
exports.backgroundImageProperty = new properties_1.CssProperty({
    name: "backgroundImage", cssName: "background-image", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withImage(newValue);
        target.backgroundInternal = background;
    },
    equalityComparer: function (value1, value2) {
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            return linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            return value1 === value2;
        }
    },
    valueConverter: function (value) {
        if (typeof value === "string") {
            var parsed = parser.parseBackground(value);
            if (parsed) {
                var background = parsed.value;
                value = (typeof background.image === "object") ? linear_gradient_1.LinearGradient.parse(background.image) : value;
            }
        }
        return value;
    }
});
exports.backgroundImageProperty.register(properties_1.Style);
exports.backgroundColorProperty = new properties_1.CssAnimationProperty({
    name: "backgroundColor", cssName: "background-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.backgroundColorProperty.register(properties_1.Style);
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.REPEAT = "repeat";
    BackgroundRepeat.REPEAT_X = "repeat-x";
    BackgroundRepeat.REPEAT_Y = "repeat-y";
    BackgroundRepeat.NO_REPEAT = "no-repeat";
    BackgroundRepeat.isValid = properties_1.makeValidator(BackgroundRepeat.REPEAT, BackgroundRepeat.REPEAT_X, BackgroundRepeat.REPEAT_Y, BackgroundRepeat.NO_REPEAT);
    BackgroundRepeat.parse = properties_1.makeParser(BackgroundRepeat.isValid);
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
exports.backgroundRepeatProperty = new properties_1.CssProperty({
    name: "backgroundRepeat", cssName: "background-repeat", valueConverter: BackgroundRepeat.parse,
    valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withRepeat(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundRepeatProperty.register(properties_1.Style);
exports.backgroundSizeProperty = new properties_1.CssProperty({
    name: "backgroundSize", cssName: "background-size", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withSize(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundSizeProperty.register(properties_1.Style);
exports.backgroundPositionProperty = new properties_1.CssProperty({
    name: "backgroundPosition", cssName: "background-position", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withPosition(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundPositionProperty.register(properties_1.Style);
function convertToBackgrounds(value) {
    if (typeof value === "string") {
        var backgrounds = parser.parseBackground(value).value;
        var backgroundColor = backgrounds.color ? new color_1.Color(backgrounds.color) : properties_1.unsetValue;
        var backgroundImage = void 0;
        if (typeof backgrounds.image === "object" && backgrounds.image) {
            backgroundImage = linear_gradient_1.LinearGradient.parse(backgrounds.image);
        }
        else {
            backgroundImage = backgrounds.image || properties_1.unsetValue;
        }
        var backgroundRepeat = backgrounds.repeat || properties_1.unsetValue;
        var backgroundPosition = backgrounds.position ? backgrounds.position.text : properties_1.unsetValue;
        return [
            [exports.backgroundColorProperty, backgroundColor],
            [exports.backgroundImageProperty, backgroundImage],
            [exports.backgroundRepeatProperty, backgroundRepeat],
            [exports.backgroundPositionProperty, backgroundPosition]
        ];
    }
    else {
        return [
            [exports.backgroundColorProperty, properties_1.unsetValue],
            [exports.backgroundImageProperty, properties_1.unsetValue],
            [exports.backgroundRepeatProperty, properties_1.unsetValue],
            [exports.backgroundPositionProperty, properties_1.unsetValue]
        ];
    }
}
function parseBorderColor(value) {
    var result = { top: undefined, right: undefined, bottom: undefined, left: undefined };
    if (value.indexOf("rgb") === 0) {
        result.top = result.right = result.bottom = result.left = new color_1.Color(value);
        return result;
    }
    var arr = value.split(/[ ,]+/);
    if (arr.length === 1) {
        var arr0 = new color_1.Color(arr[0]);
        result.top = arr0;
        result.right = arr0;
        result.bottom = arr0;
        result.left = arr0;
    }
    else if (arr.length === 2) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr0;
        result.left = arr1;
    }
    else if (arr.length === 3) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr1;
    }
    else if (arr.length === 4) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        var arr3 = new color_1.Color(arr[3]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr3;
    }
    else {
        throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
    }
    return result;
}
var borderColorProperty = new properties_1.ShorthandProperty({
    name: "borderColor", cssName: "border-color",
    getter: function () {
        if (color_1.Color.equals(this.borderTopColor, this.borderRightColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderBottomColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderLeftColor)) {
            return this.borderTopColor;
        }
        else {
            return this.borderTopColor + " " + this.borderRightColor + " " + this.borderBottomColor + " " + this.borderLeftColor;
        }
    },
    converter: function (value) {
        if (typeof value === "string") {
            var fourColors = parseBorderColor(value);
            return [
                [exports.borderTopColorProperty, fourColors.top],
                [exports.borderRightColorProperty, fourColors.right],
                [exports.borderBottomColorProperty, fourColors.bottom],
                [exports.borderLeftColorProperty, fourColors.left]
            ];
        }
        else {
            return [
                [exports.borderTopColorProperty, value],
                [exports.borderRightColorProperty, value],
                [exports.borderBottomColorProperty, value],
                [exports.borderLeftColorProperty, value]
            ];
        }
    }
});
borderColorProperty.register(properties_1.Style);
exports.borderTopColorProperty = new properties_1.CssProperty({
    name: "borderTopColor", cssName: "border-top-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderTopColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderTopColorProperty.register(properties_1.Style);
exports.borderRightColorProperty = new properties_1.CssProperty({
    name: "borderRightColor", cssName: "border-right-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderRightColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderRightColorProperty.register(properties_1.Style);
exports.borderBottomColorProperty = new properties_1.CssProperty({
    name: "borderBottomColor", cssName: "border-bottom-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderBottomColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderBottomColorProperty.register(properties_1.Style);
exports.borderLeftColorProperty = new properties_1.CssProperty({
    name: "borderLeftColor", cssName: "border-left-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderLeftColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderLeftColorProperty.register(properties_1.Style);
var borderWidthProperty = new properties_1.ShorthandProperty({
    name: "borderWidth", cssName: "border-width",
    getter: function () {
        if (Length.equals(this.borderTopWidth, this.borderRightWidth) &&
            Length.equals(this.borderTopWidth, this.borderBottomWidth) &&
            Length.equals(this.borderTopWidth, this.borderLeftWidth)) {
            return this.borderTopWidth;
        }
        else {
            return Length.convertToString(this.borderTopWidth) + " " + Length.convertToString(this.borderRightWidth) + " " + Length.convertToString(this.borderBottomWidth) + " " + Length.convertToString(this.borderLeftWidth);
        }
    },
    converter: function (value) {
        if (typeof value === "string" && value !== "auto") {
            var borderWidths = parseThickness(value);
            return [
                [exports.borderTopWidthProperty, borderWidths.top],
                [exports.borderRightWidthProperty, borderWidths.right],
                [exports.borderBottomWidthProperty, borderWidths.bottom],
                [exports.borderLeftWidthProperty, borderWidths.left]
            ];
        }
        else {
            return [
                [exports.borderTopWidthProperty, value],
                [exports.borderRightWidthProperty, value],
                [exports.borderBottomWidthProperty, value],
                [exports.borderLeftWidthProperty, value]
            ];
        }
    }
});
borderWidthProperty.register(properties_1.Style);
exports.borderTopWidthProperty = new properties_1.CssProperty({
    name: "borderTopWidth", cssName: "border-top-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderTopWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderTopWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopWidthProperty.register(properties_1.Style);
exports.borderRightWidthProperty = new properties_1.CssProperty({
    name: "borderRightWidth", cssName: "border-right-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-right-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderRightWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderRightWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderRightWidthProperty.register(properties_1.Style);
exports.borderBottomWidthProperty = new properties_1.CssProperty({
    name: "borderBottomWidth", cssName: "border-bottom-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderBottomWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderBottomWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomWidthProperty.register(properties_1.Style);
exports.borderLeftWidthProperty = new properties_1.CssProperty({
    name: "borderLeftWidth", cssName: "border-left-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-left-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderLeftWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderLeftWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderLeftWidthProperty.register(properties_1.Style);
var borderRadiusProperty = new properties_1.ShorthandProperty({
    name: "borderRadius", cssName: "border-radius",
    getter: function () {
        if (Length.equals(this.borderTopLeftRadius, this.borderTopRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomLeftRadius)) {
            return this.borderTopLeftRadius;
        }
        return Length.convertToString(this.borderTopLeftRadius) + " " + Length.convertToString(this.borderTopRightRadius) + " " + Length.convertToString(this.borderBottomRightRadius) + " " + Length.convertToString(this.borderBottomLeftRadius);
    },
    converter: function (value) {
        if (typeof value === "string") {
            var borderRadius = parseThickness(value);
            return [
                [exports.borderTopLeftRadiusProperty, borderRadius.top],
                [exports.borderTopRightRadiusProperty, borderRadius.right],
                [exports.borderBottomRightRadiusProperty, borderRadius.bottom],
                [exports.borderBottomLeftRadiusProperty, borderRadius.left]
            ];
        }
        else {
            return [
                [exports.borderTopLeftRadiusProperty, value],
                [exports.borderTopRightRadiusProperty, value],
                [exports.borderBottomRightRadiusProperty, value],
                [exports.borderBottomLeftRadiusProperty, value]
            ];
        }
    }
});
borderRadiusProperty.register(properties_1.Style);
exports.borderTopLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderTopLeftRadius", cssName: "border-top-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopLeftRadiusProperty.register(properties_1.Style);
exports.borderTopRightRadiusProperty = new properties_1.CssProperty({
    name: "borderTopRightRadius", cssName: "border-top-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopRightRadiusProperty.register(properties_1.Style);
exports.borderBottomRightRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomRightRadius", cssName: "border-bottom-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomRightRadiusProperty.register(properties_1.Style);
exports.borderBottomLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomLeftRadius", cssName: "border-bottom-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomLeftRadiusProperty.register(properties_1.Style);
function isNonNegativeFiniteNumber(value) {
    return isFinite(value) && !isNaN(value) && value >= 0;
}
var supportedPaths = ["rect", "circle", "ellipse", "polygon", "inset"];
function isClipPathValid(value) {
    if (!value) {
        return true;
    }
    var functionName = value.substring(0, value.indexOf("(")).trim();
    return supportedPaths.indexOf(functionName) !== -1;
}
exports.clipPathProperty = new properties_1.CssProperty({
    name: "clipPath", cssName: "clip-path", valueChanged: function (target, oldValue, newValue) {
        if (!isClipPathValid(newValue)) {
            throw new Error("clip-path is not valid.");
        }
        var background = target.backgroundInternal.withClipPath(newValue);
        target.backgroundInternal = background;
    }
});
exports.clipPathProperty.register(properties_1.Style);
function isFloatValueConverter(value) {
    var newValue = parseFloat(value);
    if (isNaN(newValue)) {
        throw new Error("Invalid value: " + newValue);
    }
    return newValue;
}
exports.zIndexProperty = new properties_1.CssProperty({ name: "zIndex", cssName: "z-index", valueConverter: isFloatValueConverter });
exports.zIndexProperty.register(properties_1.Style);
function opacityConverter(value) {
    var newValue = parseFloat(value);
    if (!isNaN(newValue) && 0 <= newValue && newValue <= 1) {
        return newValue;
    }
    throw new Error("Opacity should be between [0, 1]. Value: " + newValue);
}
exports.opacityProperty = new properties_1.CssAnimationProperty({ name: "opacity", cssName: "opacity", defaultValue: 1, valueConverter: opacityConverter });
exports.opacityProperty.register(properties_1.Style);
exports.colorProperty = new properties_1.InheritedCssProperty({ name: "color", cssName: "color", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.colorProperty.register(properties_1.Style);
exports.fontInternalProperty = new properties_1.CssProperty({ name: "fontInternal", cssName: "_fontInternal", defaultValue: font_1.Font.default });
exports.fontInternalProperty.register(properties_1.Style);
exports.fontFamilyProperty = new properties_1.InheritedCssProperty({
    name: "fontFamily", cssName: "font-family", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontFamily !== newValue) {
            var newFont = currentFont.withFontFamily(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontFamilyProperty.register(properties_1.Style);
exports.fontSizeProperty = new properties_1.InheritedCssProperty({
    name: "fontSize", cssName: "font-size", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontSize !== newValue) {
            var newFont = currentFont.withFontSize(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    },
    valueConverter: function (v) { return parseFloat(v); }
});
exports.fontSizeProperty.register(properties_1.Style);
exports.fontStyleProperty = new properties_1.InheritedCssProperty({
    name: "fontStyle", cssName: "font-style", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontStyle.NORMAL, valueConverter: font_1.FontStyle.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontStyle !== newValue) {
            var newFont = currentFont.withFontStyle(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontStyleProperty.register(properties_1.Style);
exports.fontWeightProperty = new properties_1.InheritedCssProperty({
    name: "fontWeight", cssName: "font-weight", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontWeight.NORMAL, valueConverter: font_1.FontWeight.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontWeight !== newValue) {
            var newFont = currentFont.withFontWeight(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontWeightProperty.register(properties_1.Style);
var fontProperty = new properties_1.ShorthandProperty({
    name: "font", cssName: "font",
    getter: function () {
        return this.fontStyle + " " + this.fontWeight + " " + this.fontSize + " " + this.fontFamily;
    },
    converter: function (value) {
        if (value === properties_1.unsetValue) {
            return [
                [exports.fontStyleProperty, properties_1.unsetValue],
                [exports.fontWeightProperty, properties_1.unsetValue],
                [exports.fontSizeProperty, properties_1.unsetValue],
                [exports.fontFamilyProperty, properties_1.unsetValue]
            ];
        }
        else {
            var font = font_1.parseFont(value);
            var fontSize = parseFloat(font.fontSize);
            return [
                [exports.fontStyleProperty, font.fontStyle],
                [exports.fontWeightProperty, font.fontWeight],
                [exports.fontSizeProperty, fontSize],
                [exports.fontFamilyProperty, font.fontFamily]
            ];
        }
    }
});
fontProperty.register(properties_1.Style);
var Visibility;
(function (Visibility) {
    Visibility.VISIBLE = "visible";
    Visibility.HIDDEN = "hidden";
    Visibility.COLLAPSE = "collapse";
    Visibility.isValid = properties_1.makeValidator(Visibility.VISIBLE, Visibility.HIDDEN, Visibility.COLLAPSE);
    Visibility.parse = function (value) { return value.toLowerCase() === "collapsed" ? Visibility.COLLAPSE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(Visibility.isValid);
})(Visibility = exports.Visibility || (exports.Visibility = {}));
exports.visibilityProperty = new properties_1.CssProperty({
    name: "visibility", cssName: "visibility", defaultValue: Visibility.VISIBLE, affectsLayout: platform_1.isIOS, valueConverter: Visibility.parse, valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.isCollapsed = (newValue === Visibility.COLLAPSE);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }
});
exports.visibilityProperty.register(properties_1.Style);
exports.androidElevationProperty = new properties_1.CssProperty({ name: "androidElevation", cssName: "android-elevation", valueConverter: parseFloat });
exports.androidElevationProperty.register(properties_1.Style);
exports.androidDynamicElevationOffsetProperty = new properties_1.CssProperty({ name: "androidDynamicElevationOffset", cssName: "android-dynamic-elevation-offset", valueConverter: parseFloat });
exports.androidDynamicElevationOffsetProperty.register(properties_1.Style);
//# sourceMappingURL=style-properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-scope.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var css_1 = __webpack_require__("../node_modules/tns-core-modules/css/index.js");
var parser_1 = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var css_selector_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var keyframeAnimationModule;
function ensureKeyframeAnimationModule() {
    if (!keyframeAnimationModule) {
        keyframeAnimationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
    }
}
var cssAnimationParserModule;
function ensureCssAnimationParserModule() {
    if (!cssAnimationParserModule) {
        cssAnimationParserModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-animation-parser.js");
    }
}
var parser = "rework";
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.cssParser === "nativescript") {
        parser = "nativescript";
    }
}
catch (e) {
}
function mergeCssSelectors() {
    applicationCssSelectors = applicationSelectors.slice();
    applicationCssSelectors.push.apply(applicationCssSelectors, applicationAdditionalSelectors);
    applicationCssSelectorVersion++;
}
exports.mergeCssSelectors = mergeCssSelectors;
var applicationCssSelectors = [];
var applicationCssSelectorVersion = 0;
var applicationSelectors = [];
var applicationAdditionalSelectors = [];
var applicationKeyframes = {};
var animationsSymbol = Symbol("animations");
var pattern = /('|")(.*?)\1/;
var CSSSource = (function () {
    function CSSSource(_ast, _url, _file, _keyframes, _source) {
        this._ast = _ast;
        this._url = _url;
        this._file = _file;
        this._keyframes = _keyframes;
        this._source = _source;
        this._selectors = [];
        this.parse();
    }
    CSSSource.fromURI = function (uri, keyframes) {
        var appRelativeUri = CSSSource.pathRelativeToApp(uri);
        try {
            var cssOrAst = global.loadModule(appRelativeUri, true);
            if (cssOrAst) {
                if (typeof cssOrAst === "string") {
                    return CSSSource.fromSource(cssOrAst, keyframes, appRelativeUri);
                }
                else if (typeof cssOrAst === "object" && cssOrAst.type === "stylesheet" && cssOrAst.stylesheet && cssOrAst.stylesheet.rules) {
                    return CSSSource.fromAST(cssOrAst, keyframes, appRelativeUri);
                }
                else {
                    return CSSSource.fromSource(cssOrAst.toString(), keyframes, appRelativeUri);
                }
            }
        }
        catch (e) {
        }
        return CSSSource.fromFile(appRelativeUri, keyframes);
    };
    CSSSource.pathRelativeToApp = function (uri) {
        if (!uri.startsWith("/")) {
            return uri;
        }
        var appPath = file_system_1.knownFolders.currentApp().path;
        if (!uri.startsWith(appPath)) {
            trace_1.write(uri + " does not start with " + appPath, trace_1.categories.Error, trace_1.messageType.error);
            return uri;
        }
        var relativeUri = "." + uri.substr(appPath.length);
        return relativeUri;
    };
    CSSSource.fromFile = function (url, keyframes) {
        var cssFileUrl = url.replace(/\..\w+$/, ".css");
        if (cssFileUrl !== url) {
            var cssFile = CSSSource.resolveCSSPathFromURL(cssFileUrl);
            if (cssFile) {
                return new CSSSource(undefined, url, cssFile, keyframes, undefined);
            }
        }
        var file = CSSSource.resolveCSSPathFromURL(url);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.fromFileImport = function (url, keyframes, importSource) {
        var file = CSSSource.resolveCSSPathFromURL(url, importSource);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.resolveCSSPathFromURL = function (url, importSource) {
        var app = file_system_1.knownFolders.currentApp().path;
        var file = resolveFileNameFromUrl(url, app, file_system_1.File.exists, importSource);
        return file;
    };
    CSSSource.fromSource = function (source, keyframes, url) {
        return new CSSSource(undefined, url, undefined, keyframes, source);
    };
    CSSSource.fromAST = function (ast, keyframes, url) {
        return new CSSSource(ast, url, undefined, keyframes, undefined);
    };
    Object.defineProperty(CSSSource.prototype, "selectors", {
        get: function () { return this._selectors; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CSSSource.prototype, "source", {
        get: function () { return this._source; },
        enumerable: true,
        configurable: true
    });
    CSSSource.prototype.load = function () {
        var file = file_system_1.File.fromPath(this._file);
        this._source = file.readTextSync();
    };
    CSSSource.prototype.parse = function () {
        try {
            if (!this._ast) {
                if (!this._source && this._file) {
                    this.load();
                }
                if (this._source && this.source !== "[object Object]") {
                    this.parseCSSAst();
                }
            }
            if (this._ast) {
                this.createSelectors();
            }
            else {
                this._selectors = [];
            }
        }
        catch (e) {
            trace_1.write("Css styling failed: " + e, trace_1.categories.Error, trace_1.messageType.error);
            this._selectors = [];
        }
    };
    CSSSource.prototype.parseCSSAst = function () {
        if (this._source) {
            switch (parser) {
                case "nativescript":
                    var cssparser = new parser_1.CSS3Parser(this._source);
                    var stylesheet = cssparser.parseAStylesheet();
                    var cssNS = new parser_1.CSSNativeScript();
                    this._ast = cssNS.parseStylesheet(stylesheet);
                    return;
                case "rework":
                    this._ast = css_1.parse(this._source, { source: this._file });
                    return;
            }
        }
    };
    CSSSource.prototype.createSelectors = function () {
        if (this._ast) {
            this._selectors = this.createSelectorsFromImports().concat(this.createSelectorsFromSyntaxTree());
        }
    };
    CSSSource.prototype.createSelectorsFromImports = function () {
        var _this = this;
        var imports = this._ast["stylesheet"]["rules"].filter(function (r) { return r.type === "import"; });
        var urlFromImportObject = function (importObject) {
            var importItem = importObject["import"];
            var urlMatch = importItem && importItem.match(pattern);
            return urlMatch && urlMatch[2];
        };
        var sourceFromImportObject = function (importObject) {
            return importObject["position"] && importObject["position"]["source"];
        };
        var toUrlSourcePair = function (importObject) { return ({
            url: urlFromImportObject(importObject),
            source: sourceFromImportObject(importObject),
        }); };
        var getCssFile = function (_a) {
            var url = _a.url, source = _a.source;
            return source ?
                CSSSource.fromFileImport(url, _this._keyframes, source) :
                CSSSource.fromURI(url, _this._keyframes);
        };
        var cssFiles = imports
            .map(toUrlSourcePair)
            .filter(function (_a) {
            var url = _a.url;
            return !!url;
        })
            .map(getCssFile);
        var selectors = cssFiles.map(function (file) { return (file && file.selectors) || []; });
        return selectors.reduce(function (acc, val) { return acc.concat(val); }, []);
    };
    CSSSource.prototype.createSelectorsFromSyntaxTree = function () {
        var _this = this;
        var nodes = this._ast.stylesheet.rules;
        nodes.filter(isKeyframe).forEach(function (node) { return _this._keyframes[node.name] = node; });
        var rulesets = css_selector_1.fromAstNodes(nodes);
        if (rulesets && rulesets.length) {
            ensureCssAnimationParserModule();
            rulesets.forEach(function (rule) {
                rule[animationsSymbol] = cssAnimationParserModule.CssAnimationParser
                    .keyframeAnimationsFromCSSDeclarations(rule.declarations);
            });
        }
        return rulesets;
    };
    CSSSource.prototype.toString = function () {
        return this._file || this._url || "(in-memory)";
    };
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "load", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parse", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parseCSSAst", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "createSelectors", null);
    __decorate([
        profiling_1.profile
    ], CSSSource, "resolveCSSPathFromURL", null);
    return CSSSource;
}());
function removeTaggedAdditionalCSS(tag) {
    var changed = false;
    for (var i = 0; i < applicationAdditionalSelectors.length; i++) {
        if (applicationAdditionalSelectors[i].tag === tag) {
            applicationAdditionalSelectors.splice(i, 1);
            i--;
            changed = true;
        }
    }
    if (changed) {
        mergeCssSelectors();
    }
    return changed;
}
exports.removeTaggedAdditionalCSS = removeTaggedAdditionalCSS;
function addTaggedAdditionalCSS(cssText, tag) {
    var parsed = CSSSource.fromSource(cssText, applicationKeyframes, undefined).selectors;
    var changed = false;
    if (parsed && parsed.length) {
        changed = true;
        if (tag != null) {
            for (var i = 0; i < parsed.length; i++) {
                parsed[i].tag = tag;
            }
        }
        applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
        mergeCssSelectors();
    }
    return changed;
}
exports.addTaggedAdditionalCSS = addTaggedAdditionalCSS;
var onCssChanged = profiling_1.profile("\"style-scope\".onCssChanged", function (args) {
    if (args.cssText) {
        var parsed = CSSSource.fromSource(args.cssText, applicationKeyframes, args.cssFile).selectors;
        if (parsed) {
            applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
            mergeCssSelectors();
        }
    }
    else if (args.cssFile) {
        loadCss(args.cssFile);
    }
});
function onLiveSync(args) {
    loadCss(applicationCommon.getCssFileName());
}
var loadCss = profiling_1.profile("\"style-scope\".loadCss", function (cssFile) {
    if (!cssFile) {
        return undefined;
    }
    var result = CSSSource.fromURI(cssFile, applicationKeyframes).selectors;
    if (result.length > 0) {
        applicationSelectors = result;
        mergeCssSelectors();
    }
});
applicationCommon.on("cssChanged", onCssChanged);
applicationCommon.on("livesync", onLiveSync);
exports.loadAppCSS = profiling_1.profile("\"style-scope\".loadAppCSS", function (args) {
    loadCss(args.cssFile);
    applicationCommon.off("loadAppCss", exports.loadAppCSS);
});
if (applicationCommon.hasLaunched()) {
    exports.loadAppCSS({ eventName: "loadAppCss", object: applicationCommon, cssFile: applicationCommon.getCssFileName() });
}
else {
    applicationCommon.on("loadAppCss", exports.loadAppCSS);
}
var CssState = (function () {
    function CssState(viewRef) {
        var _this = this;
        this.viewRef = viewRef;
        this._onDynamicStateChangeHandler = function () { return _this.updateDynamicState(); };
    }
    CssState.prototype.onChange = function () {
        var view = this.viewRef.get();
        if (view && view.isLoaded) {
            this.unsubscribeFromDynamicUpdates();
            this.updateMatch();
            this.subscribeForDynamicUpdates();
            this.updateDynamicState();
        }
        else {
            this._matchInvalid = true;
        }
    };
    CssState.prototype.isSelectorsLatestVersionApplied = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("isSelectorsLatestVersionApplied returns default value \"false\" because \"this.viewRef\" cleared.", trace_1.categories.Style, trace_1.messageType.warn);
            return false;
        }
        return this.viewRef.get()._styleScope._getSelectorsVersion() === this._appliedSelectorsVersion;
    };
    CssState.prototype.onLoaded = function () {
        if (this._matchInvalid) {
            this.updateMatch();
        }
        this.subscribeForDynamicUpdates();
        this.updateDynamicState();
    };
    CssState.prototype.onUnloaded = function () {
        this.unsubscribeFromDynamicUpdates();
    };
    CssState.prototype.updateMatch = function () {
        var view = this.viewRef.get();
        if (view && view._styleScope) {
            this._match = view._styleScope.matchSelectors(view);
            this._appliedSelectorsVersion = view._styleScope._getSelectorsVersion();
        }
        else {
            this._match = CssState.emptyMatch;
        }
        this._matchInvalid = false;
    };
    CssState.prototype.updateDynamicState = function () {
        var _this = this;
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("updateDynamicState not executed to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var matchingSelectors = this._match.selectors.filter(function (sel) { return sel.dynamic ? sel.match(view) : true; });
        view._batchUpdate(function () {
            _this.stopKeyframeAnimations();
            _this.setPropertyValues(matchingSelectors);
            _this.playKeyframeAnimations(matchingSelectors);
        });
    };
    CssState.prototype.playKeyframeAnimations = function (matchingSelectors) {
        var animations = [];
        matchingSelectors.forEach(function (selector) {
            var ruleAnimations = selector.ruleset[animationsSymbol];
            if (ruleAnimations) {
                ensureKeyframeAnimationModule();
                for (var _i = 0, ruleAnimations_1 = ruleAnimations; _i < ruleAnimations_1.length; _i++) {
                    var animationInfo = ruleAnimations_1[_i];
                    var animation = keyframeAnimationModule.KeyframeAnimation.keyframeAnimationFromInfo(animationInfo);
                    if (animation) {
                        animations.push(animation);
                    }
                }
            }
        });
        if (this._playsKeyframeAnimations = animations.length > 0) {
            var view_1 = this.viewRef.get();
            if (!view_1) {
                trace_1.write("KeyframeAnimations cannot play because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            animations.map(function (animation) { return animation.play(view_1); });
            Object.freeze(animations);
            this._appliedAnimations = animations;
        }
    };
    CssState.prototype.stopKeyframeAnimations = function () {
        if (!this._playsKeyframeAnimations) {
            return;
        }
        this._appliedAnimations
            .filter(function (animation) { return animation.isPlaying; })
            .forEach(function (animation) { return animation.cancel(); });
        this._appliedAnimations = CssState.emptyAnimationArray;
        var view = this.viewRef.get();
        if (view) {
            view.style["keyframe:rotate"] = properties_1.unsetValue;
            view.style["keyframe:scaleX"] = properties_1.unsetValue;
            view.style["keyframe:scaleY"] = properties_1.unsetValue;
            view.style["keyframe:translateX"] = properties_1.unsetValue;
            view.style["keyframe:translateY"] = properties_1.unsetValue;
            view.style["keyframe:backgroundColor"] = properties_1.unsetValue;
            view.style["keyframe:opacity"] = properties_1.unsetValue;
        }
        else {
            trace_1.write("KeyframeAnimations cannot be stopped because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
        }
        this._playsKeyframeAnimations = false;
    };
    CssState.prototype.setPropertyValues = function (matchingSelectors) {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write(matchingSelectors + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var newPropertyValues = new view.style.PropertyBag();
        matchingSelectors.forEach(function (selector) {
            return selector.ruleset.declarations.forEach(function (declaration) {
                return newPropertyValues[declaration.property] = declaration.value;
            });
        });
        Object.freeze(newPropertyValues);
        var oldProperties = this._appliedPropertyValues;
        for (var key in oldProperties) {
            if (!(key in newPropertyValues)) {
                if (key in view.style) {
                    view.style["css:" + key] = properties_1.unsetValue;
                }
                else {
                }
            }
        }
        for (var property in newPropertyValues) {
            if (oldProperties && property in oldProperties && oldProperties[property] === newPropertyValues[property]) {
                continue;
            }
            var value = newPropertyValues[property];
            try {
                if (property in view.style) {
                    view.style["css:" + property] = value;
                }
                else {
                    var camelCasedProperty = property.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase(); });
                    view[camelCasedProperty] = value;
                }
            }
            catch (e) {
                trace_1.write("Failed to apply property [" + property + "] with value [" + value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        this._appliedPropertyValues = newPropertyValues;
    };
    CssState.prototype.subscribeForDynamicUpdates = function () {
        var _this = this;
        var changeMap = this._match.changeMap;
        changeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.addEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.addEventListener(":" + pseudoClass, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](+1);
                    }
                });
            }
        });
        this._appliedChangeMap = changeMap;
    };
    CssState.prototype.unsubscribeFromDynamicUpdates = function () {
        var _this = this;
        this._appliedChangeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.removeEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.removeEventListener(eventName, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](-1);
                    }
                });
            }
        });
        this._appliedChangeMap = CssState.emptyChangeMap;
    };
    CssState.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of CssState cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + "._cssState";
    };
    CssState.emptyChangeMap = Object.freeze(new Map());
    CssState.emptyPropertyBag = Object.freeze({});
    CssState.emptyAnimationArray = Object.freeze([]);
    CssState.emptyMatch = { selectors: [], changeMap: new Map() };
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateMatch", null);
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateDynamicState", null);
    return CssState;
}());
exports.CssState = CssState;
CssState.prototype._appliedChangeMap = CssState.emptyChangeMap;
CssState.prototype._appliedPropertyValues = CssState.emptyPropertyBag;
CssState.prototype._appliedAnimations = CssState.emptyAnimationArray;
CssState.prototype._matchInvalid = true;
var StyleScope = (function () {
    function StyleScope() {
        this._css = "";
        this._localCssSelectors = [];
        this._localCssSelectorVersion = 0;
        this._localCssSelectorsAppliedVersion = 0;
        this._applicationCssSelectorsAppliedVersion = 0;
        this._keyframes = new Map();
    }
    Object.defineProperty(StyleScope.prototype, "css", {
        get: function () {
            return this._css;
        },
        set: function (value) {
            this.setCss(value);
        },
        enumerable: true,
        configurable: true
    });
    StyleScope.prototype.addCss = function (cssString, cssFileName) {
        this.appendCss(cssString, cssFileName);
    };
    StyleScope.prototype.addCssFile = function (cssFileName) {
        this.appendCss(null, cssFileName);
    };
    StyleScope.prototype.changeCssFile = function (cssFileName) {
        if (!cssFileName) {
            return;
        }
        var cssSelectors = CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = cssSelectors.source;
        this._localCssSelectors = cssSelectors.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.setCss = function (cssString, cssFileName) {
        this._css = cssString;
        var cssFile = CSSSource.fromSource(cssString, this._keyframes, cssFileName);
        this._localCssSelectors = cssFile.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.appendCss = function (cssString, cssFileName) {
        if (!cssString && !cssFileName) {
            return;
        }
        var parsedCssSelectors = cssString ? CSSSource.fromSource(cssString, this._keyframes, cssFileName) : CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = this._css + parsedCssSelectors.source;
        this._localCssSelectors.push.apply(this._localCssSelectors, parsedCssSelectors.selectors);
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.getKeyframeAnimationWithName = function (animationName) {
        var cssKeyframes = this._keyframes[animationName];
        if (!cssKeyframes) {
            return;
        }
        ensureKeyframeAnimationModule();
        var animation = new keyframeAnimationModule.KeyframeAnimationInfo();
        ensureCssAnimationParserModule();
        animation.keyframes = cssAnimationParserModule
            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframes.keyframes);
        return animation;
    };
    StyleScope.prototype.ensureSelectors = function () {
        if (!this.isApplicationCssSelectorsLatestVersionApplied() ||
            !this.isLocalCssSelectorsLatestVersionApplied() ||
            !this._mergedCssSelectors) {
            this._createSelectors();
        }
        return this._getSelectorsVersion();
    };
    StyleScope.prototype.isApplicationCssSelectorsLatestVersionApplied = function () {
        return this._applicationCssSelectorsAppliedVersion === applicationCssSelectorVersion;
    };
    StyleScope.prototype.isLocalCssSelectorsLatestVersionApplied = function () {
        return this._localCssSelectorsAppliedVersion === this._localCssSelectorVersion;
    };
    StyleScope.prototype._createSelectors = function () {
        var toMerge = [];
        toMerge.push(applicationCssSelectors);
        this._applicationCssSelectorsAppliedVersion = applicationCssSelectorVersion;
        toMerge.push(this._localCssSelectors);
        this._localCssSelectorsAppliedVersion = this._localCssSelectorVersion;
        for (var keyframe in applicationKeyframes) {
            this._keyframes[keyframe] = applicationKeyframes[keyframe];
        }
        if (toMerge.length > 0) {
            this._mergedCssSelectors = toMerge.filter(function (m) { return !!m; }).reduce(function (merged, next) { return merged.concat(next); }, []);
            this._applyKeyframesOnSelectors();
            this._selectors = new css_selector_1.SelectorsMap(this._mergedCssSelectors);
        }
    };
    StyleScope.prototype.matchSelectors = function (view) {
        this.ensureSelectors();
        return this._selectors.query(view);
    };
    StyleScope.prototype.query = function (node) {
        this.ensureSelectors();
        return this._selectors.query(node).selectors;
    };
    StyleScope.prototype._getSelectorsVersion = function () {
        return 100000 * this._applicationCssSelectorsAppliedVersion + this._localCssSelectorsAppliedVersion;
    };
    StyleScope.prototype._applyKeyframesOnSelectors = function () {
        for (var i = this._mergedCssSelectors.length - 1; i >= 0; i--) {
            var ruleset = this._mergedCssSelectors[i];
            var animations = ruleset[animationsSymbol];
            if (animations !== undefined && animations.length) {
                ensureCssAnimationParserModule();
                for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {
                    var animation = animations_1[_i];
                    var cssKeyframe = this._keyframes[animation.name];
                    if (cssKeyframe !== undefined) {
                        animation.keyframes = cssAnimationParserModule
                            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframe.keyframes);
                    }
                }
            }
        }
    };
    StyleScope.prototype.getAnimations = function (ruleset) {
        return ruleset[animationsSymbol];
    };
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "setCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "appendCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "_createSelectors", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "matchSelectors", null);
    return StyleScope;
}());
exports.StyleScope = StyleScope;
function resolveFileNameFromUrl(url, appDirectory, fileExists, importSource) {
    var fileName = typeof url === "string" ? url.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = fileName.replace("~/", "");
    }
    var isAbsolutePath = fileName.indexOf("/") === 0;
    var absolutePath = isAbsolutePath ? fileName : file_system_1.path.join(appDirectory, fileName);
    if (fileExists(absolutePath)) {
        return absolutePath;
    }
    if (!isAbsolutePath) {
        if (fileName[0] === "~" && fileName[1] !== "/" && fileName[1] !== "\"") {
            fileName = fileName.substr(1);
        }
        if (importSource) {
            var importFile = resolveFilePathFromImport(importSource, fileName);
            if (fileExists(importFile)) {
                return importFile;
            }
        }
        var external_1 = file_system_1.path.join(appDirectory, "tns_modules", fileName);
        if (fileExists(external_1)) {
            return external_1;
        }
    }
    return null;
}
exports.resolveFileNameFromUrl = resolveFileNameFromUrl;
function resolveFilePathFromImport(importSource, fileName) {
    var importSourceParts = importSource.split(file_system_1.path.separator);
    var fileNameParts = fileName.split(file_system_1.path.separator)
        .filter(function (p) { return !isCurrentDirectory(p); });
    importSourceParts.pop();
    fileNameParts.forEach(function (p) { return isParentDirectory(p) ? importSourceParts.pop() : importSourceParts.push(p); });
    return importSourceParts.join(file_system_1.path.separator);
}
exports.applyInlineStyle = profiling_1.profile(function applyInlineStyle(view, styleStr) {
    var localStyle = "local { " + styleStr + " }";
    var inlineRuleSet = CSSSource.fromSource(localStyle, new Map()).selectors;
    var style = view.style;
    inlineRuleSet[0].declarations.forEach(function (d) {
        var name = d.property;
        try {
            if (name in style) {
                style[name] = d.value;
            }
            else {
                view[name] = d.value;
            }
        }
        catch (e) {
            trace_1.write("Failed to apply property [" + d.property + "] with value [" + d.value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
    });
});
function isCurrentDirectory(uriPart) {
    return uriPart === ".";
}
function isParentDirectory(uriPart) {
    return uriPart === "..";
}
function isKeyframe(node) {
    return node.type === "keyframes";
}
//# sourceMappingURL=style-scope.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style/style.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var Style = (function (_super) {
    __extends(Style, _super);
    function Style(ownerView) {
        var _this = _super.call(this) || this;
        if (ownerView.constructor.toString().indexOf("[native code]") !== -1) {
            _this.viewRef = ownerView;
        }
        else {
            _this.viewRef = new WeakRef(ownerView);
        }
        return _this;
    }
    Style.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of Style cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + ".style";
    };
    Object.defineProperty(Style.prototype, "view", {
        get: function () {
            if (this.viewRef) {
                return this.viewRef.get();
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    return Style;
}(observable_1.Observable));
exports.Style = Style;
Style.prototype.PropertyBag = (function () {
    function class_1() {
    }
    return class_1;
}());
//# sourceMappingURL=style.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var SwitchBase = (function (_super) {
    __extends(SwitchBase, _super);
    function SwitchBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SwitchBase.prototype._onCheckedPropertyChanged = function (newValue) {
    };
    SwitchBase.checkedChangeEvent = "checkedChange";
    SwitchBase = __decorate([
        view_1.CSSType("Switch")
    ], SwitchBase);
    return SwitchBase;
}(view_1.View));
exports.SwitchBase = SwitchBase;
SwitchBase.prototype.recycleNativeView = "auto";
function onCheckedPropertyChanged(switchBase, oldValue, newValue) {
    switchBase._onCheckedPropertyChanged(newValue);
}
exports.checkedProperty = new view_1.Property({ name: "checked", defaultValue: false, valueConverter: view_1.booleanConverter, valueChanged: onCheckedPropertyChanged });
exports.checkedProperty.register(SwitchBase);
exports.offBackgroundColorProperty = new view_1.Property({ name: "offBackgroundColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.offBackgroundColorProperty.register(SwitchBase);
//# sourceMappingURL=switch-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/switch/switch.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var switch_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/switch/switch-common.js"));
var SwitchChangeHandlerImpl = (function (_super) {
    __extends(SwitchChangeHandlerImpl, _super);
    function SwitchChangeHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SwitchChangeHandlerImpl.initWithOwner = function (owner) {
        var handler = SwitchChangeHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    SwitchChangeHandlerImpl.prototype.valueChanged = function (sender) {
        var owner = this._owner.get();
        if (owner) {
            switch_common_1.checkedProperty.nativeValueChange(owner, sender.on);
        }
    };
    SwitchChangeHandlerImpl.ObjCExposedMethods = {
        "valueChanged": { returns: interop.types.void, params: [UISwitch] }
    };
    return SwitchChangeHandlerImpl;
}(NSObject));
var zeroSize = { width: 0, height: 0 };
var Switch = (function (_super) {
    __extends(Switch, _super);
    function Switch() {
        var _this = _super.call(this) || this;
        _this.width = 51;
        _this.height = 31;
        return _this;
    }
    Switch.prototype.createNativeView = function () {
        return UISwitch.new();
    };
    Switch.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        this._handler = SwitchChangeHandlerImpl.initWithOwner(new WeakRef(this));
        nativeView.addTargetActionForControlEvents(this._handler, "valueChanged", 4096);
    };
    Switch.prototype.disposeNativeView = function () {
        this._handler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Switch.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Switch.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var nativeSize = this.nativeViewProtected.sizeThatFits(zeroSize);
        this.width = nativeSize.width;
        this.height = nativeSize.height;
        var widthAndState = Switch.resolveSizeAndState(switch_common_1.layout.toDevicePixels(nativeSize.width), switch_common_1.layout.toDevicePixels(51), switch_common_1.layout.EXACTLY, 0);
        var heightAndState = Switch.resolveSizeAndState(switch_common_1.layout.toDevicePixels(nativeSize.height), switch_common_1.layout.toDevicePixels(31), switch_common_1.layout.EXACTLY, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Switch.prototype[switch_common_1.checkedProperty.getDefault] = function () {
        return false;
    };
    Switch.prototype[switch_common_1.checkedProperty.setNative] = function (value) {
        this.nativeViewProtected.on = value;
    };
    Switch.prototype[switch_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.thumbTintColor;
    };
    Switch.prototype[switch_common_1.colorProperty.setNative] = function (value) {
        this.nativeViewProtected.thumbTintColor = value instanceof switch_common_1.Color ? value.ios : value;
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.getDefault] = function () {
        return this.nativeViewProtected.onTintColor;
    };
    Switch.prototype[switch_common_1.backgroundColorProperty.setNative] = function (value) {
        this.nativeViewProtected.onTintColor = value instanceof switch_common_1.Color ? value.ios : value;
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    Switch.prototype[switch_common_1.backgroundInternalProperty.setNative] = function (value) {
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.getDefault] = function () {
        return this.nativeViewProtected.backgroundColor;
    };
    Switch.prototype[switch_common_1.offBackgroundColorProperty.setNative] = function (value) {
        var nativeValue = value instanceof switch_common_1.Color ? value.ios : value;
        this.nativeViewProtected.tintColor = nativeValue;
        this.nativeViewProtected.backgroundColor = nativeValue;
        this.nativeViewProtected.layer.cornerRadius = this.nativeViewProtected.frame.size.height / 2;
    };
    return Switch;
}(switch_common_1.SwitchBase));
exports.Switch = Switch;
//# sourceMappingURL=switch.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
exports.traceCategory = "TabView";
var TabContentItemBase = (function (_super) {
    __extends(TabContentItemBase, _super);
    function TabContentItemBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabContentItemBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.view = value;
        }
    };
    Object.defineProperty(TabContentItemBase.prototype, "view", {
        get: function () {
            return this._view;
        },
        set: function (value) {
            if (this._view !== value) {
                if (this._view) {
                    throw new Error("Changing the view of an already loaded TabContentItem is not currently supported.");
                }
                this._view = value;
                this._addView(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    TabContentItemBase.prototype.eachChild = function (callback) {
        var view = this._view;
        if (view) {
            callback(view);
        }
    };
    TabContentItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabContentItemBase = __decorate([
        view_1.CSSType("TabContentItem")
    ], TabContentItemBase);
    return TabContentItemBase;
}(view_1.ViewBase));
exports.TabContentItemBase = TabContentItemBase;
//# sourceMappingURL=tab-content-item-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_content_item_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item-common.js"));
var TabContentItem = (function (_super) {
    __extends(TabContentItem, _super);
    function TabContentItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabContentItem.prototype.setViewController = function (controller, nativeView) {
        this.__controller = controller;
        this.setNativeView(nativeView);
    };
    TabContentItem.prototype.disposeNativeView = function () {
        this.__controller = undefined;
        this.setNativeView(undefined);
    };
    return TabContentItem;
}(tab_content_item_common_1.TabContentItemBase));
exports.TabContentItem = TabContentItem;
//# sourceMappingURL=tab-content-item.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabNavigationBase = (function (_super) {
    __extends(TabNavigationBase, _super);
    function TabNavigationBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabNavigationBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabNavigationBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabContentItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
        else if (name === "TabStrip") {
            this.tabStrip = value;
            this._addView(value);
        }
    };
    Object.defineProperty(TabNavigationBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].view : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabNavigationBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabNavigationBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
        var tabStrip = this.tabStrip;
        if (tabStrip) {
            callback(tabStrip);
        }
    };
    TabNavigationBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.view);
            });
        }
    };
    TabNavigationBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.view) {
                    throw new Error("TabContentItem must have a view.");
                }
                _this._addView(item);
            });
        }
    };
    TabNavigationBase.prototype.onTabStripChanged = function (oldTabStrip, newTabStrip) {
        var _this = this;
        if (oldTabStrip && oldTabStrip.items && oldTabStrip.items.length) {
            oldTabStrip.items.forEach(function (item) { return _this._removeView(item); });
        }
        if (newTabStrip && newTabStrip.items && newTabStrip.items.length) {
            newTabStrip.items.forEach(function (item) {
                _this._addView(item);
            });
        }
    };
    TabNavigationBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabNavigationBase.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    TabNavigationBase.prototype.getTabBarBackgroundColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarBackgroundColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarFontInternal = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarFontInternal = function (value) {
    };
    TabNavigationBase.prototype.getTabBarTextTransform = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarTextTransform = function (value) {
    };
    TabNavigationBase.prototype.getTabBarHighlightColor = function () {
    };
    TabNavigationBase.prototype.setTabBarHighlightColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarColor = function () {
        return null;
    };
    TabNavigationBase.prototype.setTabBarColor = function (value) {
    };
    TabNavigationBase.prototype.getTabBarItemBackgroundColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemBackgroundColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemColor = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemColor = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontSize = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontSize = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemFontInternal = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemFontInternal = function (tabStripItem, value) {
    };
    TabNavigationBase.prototype.getTabBarItemTextTransform = function (tabStripItem) {
        return null;
    };
    TabNavigationBase.prototype.setTabBarItemTextTransform = function (tabStripItem, value) {
    };
    TabNavigationBase.selectedIndexChangedEvent = "selectedIndexChanged";
    return TabNavigationBase;
}(view_1.View));
exports.TabNavigationBase = TabNavigationBase;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabNavigationBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabNavigationBase);
exports.tabStripProperty = new view_1.Property({
    name: "tabStrip", valueChanged: function (target, oldValue, newValue) {
        target.onTabStripChanged(oldValue, newValue);
    }
});
exports.tabStripProperty.register(TabNavigationBase);
//# sourceMappingURL=tab-navigation-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabStripItem = (function (_super) {
    __extends(TabStripItem, _super);
    function TabStripItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStripItem_1 = TabStripItem;
    TabStripItem.prototype._addChildFromBuilder = function (name, value) {
        if (name === "Image") {
            this.image = value;
            this.iconSource = value.src;
            this._addView(value);
        }
        if (name === "Label") {
            this.label = value;
            this.title = value.text;
            this._addView(value);
        }
    };
    TabStripItem.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    TabStripItem.prototype._updateTabStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            this._highlightedHandler = this._highlightedHandler || (function () {
                _this._goToVisualState("highlighted");
            });
            this._normalHandler = this._normalHandler || (function () {
                _this._goToVisualState("normal");
            });
            this.on(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.on(TabStripItem_1.unselectEvent, this._normalHandler);
            var parent_1 = this.parent;
            var tabStripParent = parent_1 && parent_1.parent;
            if (this.index === tabStripParent.selectedIndex) {
                this._goToVisualState("highlighted");
            }
        }
        else {
            this.off(TabStripItem_1.selectEvent, this._highlightedHandler);
            this.off(TabStripItem_1.unselectEvent, this._normalHandler);
        }
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarBackgroundColor();
    };
    TabStripItem.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemBackgroundColor(this, value);
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStripItem.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    TabStripItem.prototype[view_1.colorProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarItemColor(this);
    };
    TabStripItem.prototype[view_1.colorProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemColor(this, value);
    };
    TabStripItem.prototype[view_1.fontSizeProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarItemFontSize(this);
    };
    TabStripItem.prototype[view_1.fontSizeProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemFontSize(this, value);
    };
    TabStripItem.prototype[view_1.fontInternalProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarItemFontInternal(this);
    };
    TabStripItem.prototype[view_1.fontInternalProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemFontInternal(this, value);
    };
    TabStripItem.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.getTabBarItemTextTransform(this);
    };
    TabStripItem.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var parent = this.parent;
        var tabStripParent = parent && parent.parent;
        return tabStripParent && tabStripParent.setTabBarItemTextTransform(this, value);
    };
    var TabStripItem_1;
    TabStripItem.tapEvent = "tap";
    TabStripItem.selectEvent = "select";
    TabStripItem.unselectEvent = "unselect";
    __decorate([
        view_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], TabStripItem.prototype, "_updateTabStateChangeHandler", null);
    TabStripItem = TabStripItem_1 = __decorate([
        view_1.CSSType("TabStripItem")
    ], TabStripItem);
    return TabStripItem;
}(view_1.View));
exports.TabStripItem = TabStripItem;
//# sourceMappingURL=tab-strip-item.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
exports.traceCategory = "TabView";
exports.highlightColorProperty = new view_1.Property({ name: "highlightColor", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
var TabStrip = (function (_super) {
    __extends(TabStrip, _super);
    function TabStrip() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabStrip.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabStrip.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabStrip.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabStripItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
        }
    };
    TabStrip.prototype[view_1.backgroundColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarBackgroundColor();
    };
    TabStrip.prototype[view_1.backgroundColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarBackgroundColor(value);
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.getDefault] = function () {
        return null;
    };
    TabStrip.prototype[view_1.backgroundInternalProperty.setNative] = function (value) {
    };
    TabStrip.prototype[view_1.colorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarColor();
    };
    TabStrip.prototype[view_1.colorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarColor(value);
    };
    TabStrip.prototype[view_1.fontInternalProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarFontInternal();
    };
    TabStrip.prototype[view_1.fontInternalProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarFontInternal(value);
    };
    TabStrip.prototype[text_base_1.textTransformProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarTextTransform();
    };
    TabStrip.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarTextTransform(value);
    };
    TabStrip.prototype[exports.highlightColorProperty.getDefault] = function () {
        var parent = this.parent;
        return parent && parent.getTabBarHighlightColor();
    };
    TabStrip.prototype[exports.highlightColorProperty.setNative] = function (value) {
        var parent = this.parent;
        return parent && parent.setTabBarHighlightColor(value);
    };
    TabStrip = __decorate([
        view_1.CSSType("TabStrip")
    ], TabStrip);
    return TabStrip;
}(view_1.View));
exports.TabStrip = TabStrip;
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabStrip);
exports.highlightColorProperty.register(TabStrip);
//# sourceMappingURL=tab-strip.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.traceCategory = "TabView";
var TabViewItemBase = (function (_super) {
    __extends(TabViewItemBase, _super);
    function TabViewItemBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._title = "";
        return _this;
    }
    Object.defineProperty(TabViewItemBase.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof view_1.View) {
            this.view = value;
        }
    };
    Object.defineProperty(TabViewItemBase.prototype, "title", {
        get: function () {
            return this._title;
        },
        set: function (value) {
            if (this._title !== value) {
                this._title = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "view", {
        get: function () {
            return this._view;
        },
        set: function (value) {
            if (this._view !== value) {
                if (this._view) {
                    throw new Error("Changing the view of an already loaded TabViewItem is not currently supported.");
                }
                this._view = value;
                this._addView(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewItemBase.prototype, "iconSource", {
        get: function () {
            return this._iconSource;
        },
        set: function (value) {
            if (this._iconSource !== value) {
                this._iconSource = value;
                this._update();
            }
        },
        enumerable: true,
        configurable: true
    });
    TabViewItemBase.prototype.eachChild = function (callback) {
        var view = this._view;
        if (view) {
            callback(view);
        }
    };
    TabViewItemBase.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            if (this.canBeLoaded) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabViewItemBase = __decorate([
        view_1.CSSType("TabViewItem")
    ], TabViewItemBase);
    return TabViewItemBase;
}(view_1.ViewBase));
exports.TabViewItemBase = TabViewItemBase;
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabViewBase = (function (_super) {
    __extends(TabViewBase, _super);
    function TabViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabViewBase_1 = TabViewBase;
    Object.defineProperty(TabViewBase.prototype, "androidSelectedTabHighlightColor", {
        get: function () {
            return this.style.androidSelectedTabHighlightColor;
        },
        set: function (value) {
            this.style.androidSelectedTabHighlightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextFontSize", {
        get: function () {
            return this.style.tabTextFontSize;
        },
        set: function (value) {
            this.style.tabTextFontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabTextColor", {
        get: function () {
            return this.style.tabTextColor;
        },
        set: function (value) {
            this.style.tabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "tabBackgroundColor", {
        get: function () {
            return this.style.tabBackgroundColor;
        },
        set: function (value) {
            this.style.tabBackgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "selectedTabTextColor", {
        get: function () {
            return this.style.selectedTabTextColor;
        },
        set: function (value) {
            this.style.selectedTabTextColor = value;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype._addArrayFromBuilder = function (name, value) {
        if (name === "items") {
            this.items = value;
        }
    };
    TabViewBase.prototype._addChildFromBuilder = function (name, value) {
        if (name === "TabViewItem") {
            if (!this.items) {
                this.items = new Array();
            }
            this.items.push(value);
            this._addView(value);
            exports.selectedIndexProperty.coerce(this);
        }
    };
    Object.defineProperty(TabViewBase.prototype, "_selectedView", {
        get: function () {
            var selectedIndex = this.selectedIndex;
            return selectedIndex > -1 ? this.items[selectedIndex].view : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TabViewBase.prototype, "_childrenCount", {
        get: function () {
            var items = this.items;
            return items ? items.length : 0;
        },
        enumerable: true,
        configurable: true
    });
    TabViewBase.prototype.eachChild = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item);
            });
        }
    };
    TabViewBase.prototype.eachChildView = function (callback) {
        var items = this.items;
        if (items) {
            items.forEach(function (item, i) {
                callback(item.view);
            });
        }
    };
    TabViewBase.prototype.onItemsChanged = function (oldItems, newItems) {
        var _this = this;
        if (oldItems) {
            oldItems.forEach(function (item) { return _this._removeView(item); });
        }
        if (newItems) {
            newItems.forEach(function (item) {
                if (!item.view) {
                    throw new Error("TabViewItem must have a view.");
                }
                _this._addView(item);
            });
        }
    };
    TabViewBase.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        this.notify({ eventName: TabViewBase_1.selectedIndexChangedEvent, object: this, oldIndex: oldIndex, newIndex: newIndex });
    };
    var TabViewBase_1;
    TabViewBase.selectedIndexChangedEvent = "selectedIndexChanged";
    TabViewBase = TabViewBase_1 = __decorate([
        view_1.CSSType("TabView")
    ], TabViewBase);
    return TabViewBase;
}(view_1.View));
exports.TabViewBase = TabViewBase;
function traceMissingIcon(icon) {
    view_1.traceWrite("Could not load tab bar icon: " + icon, view_1.traceCategories.Error, view_1.traceMessageType.error);
}
exports.traceMissingIcon = traceMissingIcon;
exports.selectedIndexProperty = new view_1.CoercibleProperty({
    name: "selectedIndex", defaultValue: -1, affectsLayout: view_1.isIOS,
    valueChanged: function (target, oldValue, newValue) {
        target.onSelectedIndexChanged(oldValue, newValue);
    },
    coerceValue: function (target, value) {
        var items = target.items;
        if (items) {
            var max = items.length - 1;
            if (value < 0) {
                value = 0;
            }
            if (value > max) {
                value = max;
            }
        }
        else {
            value = -1;
        }
        return value;
    },
    valueConverter: function (v) { return parseInt(v); }
});
exports.selectedIndexProperty.register(TabViewBase);
exports.itemsProperty = new view_1.Property({
    name: "items", valueChanged: function (target, oldValue, newValue) {
        target.onItemsChanged(oldValue, newValue);
    }
});
exports.itemsProperty.register(TabViewBase);
exports.iosIconRenderingModeProperty = new view_1.Property({ name: "iosIconRenderingMode", defaultValue: "automatic" });
exports.iosIconRenderingModeProperty.register(TabViewBase);
exports.androidOffscreenTabLimitProperty = new view_1.Property({
    name: "androidOffscreenTabLimit", defaultValue: 1, affectsLayout: view_1.isIOS,
    valueConverter: function (v) { return parseInt(v); }
});
exports.androidOffscreenTabLimitProperty.register(TabViewBase);
exports.androidTabsPositionProperty = new view_1.Property({ name: "androidTabsPosition", defaultValue: "top" });
exports.androidTabsPositionProperty.register(TabViewBase);
exports.androidSwipeEnabledProperty = new view_1.Property({ name: "androidSwipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter });
exports.androidSwipeEnabledProperty.register(TabViewBase);
exports.tabTextFontSizeProperty = new view_1.CssProperty({ name: "tabTextFontSize", cssName: "tab-text-font-size", valueConverter: function (v) { return parseFloat(v); } });
exports.tabTextFontSizeProperty.register(view_1.Style);
exports.tabTextColorProperty = new view_1.CssProperty({ name: "tabTextColor", cssName: "tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabTextColorProperty.register(view_1.Style);
exports.tabBackgroundColorProperty = new view_1.CssProperty({ name: "tabBackgroundColor", cssName: "tab-background-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.tabBackgroundColorProperty.register(view_1.Style);
exports.selectedTabTextColorProperty = new view_1.CssProperty({ name: "selectedTabTextColor", cssName: "selected-tab-text-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.selectedTabTextColorProperty.register(view_1.Style);
exports.androidSelectedTabHighlightColorProperty = new view_1.CssProperty({ name: "androidSelectedTabHighlightColor", cssName: "android-selected-tab-highlight-color", equalityComparer: view_1.Color.equals, valueConverter: function (v) { return new view_1.Color(v); } });
exports.androidSelectedTabHighlightColorProperty.register(view_1.Style);
//# sourceMappingURL=tab-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tab-view/tab-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var tab_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-view/tab-view-common.js"));
var majorVersion = utils_1.ios.MajorVersion;
var isPhone = platform_1.device.deviceType === "Phone";
var UITabBarControllerImpl = (function (_super) {
    __extends(UITabBarControllerImpl, _super);
    function UITabBarControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITabBarControllerImpl.initWithOwner = function (owner) {
        var handler = UITabBarControllerImpl.new();
        handler._owner = owner;
        return handler;
    };
    UITabBarControllerImpl.prototype.viewDidLoad = function () {
        _super.prototype.viewDidLoad.call(this);
        this.extendedLayoutIncludesOpaqueBars = true;
    };
    UITabBarControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        view_1.ios.updateAutoAdjustScrollInsets(this, owner);
        if (!owner.parent) {
            owner.callLoaded();
        }
    };
    UITabBarControllerImpl.prototype.viewDidDisappear = function (animated) {
        _super.prototype.viewDidDisappear.call(this, animated);
        var owner = this._owner.get();
        if (owner && !owner.parent && owner.isLoaded && !this.presentedViewController) {
            owner.callUnloaded();
        }
    };
    UITabBarControllerImpl.prototype.viewWillTransitionToSizeWithTransitionCoordinator = function (size, coordinator) {
        var _this = this;
        _super.prototype.viewWillTransitionToSizeWithTransitionCoordinator.call(this, size, coordinator);
        UIViewControllerTransitionCoordinator.prototype.animateAlongsideTransitionCompletion
            .call(coordinator, null, function () {
            var owner = _this._owner.get();
            if (owner && owner.items) {
                owner.items.forEach(function (tabItem) { return tabItem._updateTitleAndIconPositions(); });
            }
        });
    };
    __decorate([
        profiling_1.profile
    ], UITabBarControllerImpl.prototype, "viewWillAppear", null);
    __decorate([
        profiling_1.profile
    ], UITabBarControllerImpl.prototype, "viewDidDisappear", null);
    return UITabBarControllerImpl;
}(UITabBarController));
var UITabBarControllerDelegateImpl = (function (_super) {
    __extends(UITabBarControllerDelegateImpl, _super);
    function UITabBarControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITabBarControllerDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITabBarControllerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UITabBarControllerDelegateImpl.prototype.tabBarControllerShouldSelectViewController = function (tabBarController, viewController) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView.delegate.SHOULD_select(" + tabBarController + ", " + viewController + ");", tab_view_common_1.traceCategories.Debug);
        }
        var owner = this._owner.get();
        if (owner) {
            var backToMoreWillBeVisible = false;
            owner._handleTwoNavigationBars(backToMoreWillBeVisible);
        }
        if (tabBarController.selectedViewController === viewController) {
            return false;
        }
        tabBarController._willSelectViewController = viewController;
        return true;
    };
    UITabBarControllerDelegateImpl.prototype.tabBarControllerDidSelectViewController = function (tabBarController, viewController) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView.delegate.DID_select(" + tabBarController + ", " + viewController + ");", tab_view_common_1.traceCategories.Debug);
        }
        var owner = this._owner.get();
        if (owner) {
            owner._onViewControllerShown(viewController);
        }
        tabBarController._willSelectViewController = undefined;
    };
    UITabBarControllerDelegateImpl.ObjCProtocols = [UITabBarControllerDelegate];
    return UITabBarControllerDelegateImpl;
}(NSObject));
var UINavigationControllerDelegateImpl = (function (_super) {
    __extends(UINavigationControllerDelegateImpl, _super);
    function UINavigationControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerDelegateImpl.initWithOwner = function (owner) {
        var delegate = UINavigationControllerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UINavigationControllerDelegateImpl.prototype.navigationControllerWillShowViewControllerAnimated = function (navigationController, viewController, animated) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView.moreNavigationController.WILL_show(" + navigationController + ", " + viewController + ", " + animated + ");", tab_view_common_1.traceCategories.Debug);
        }
        var owner = this._owner.get();
        if (owner) {
            var backToMoreWillBeVisible = owner._ios.viewControllers.containsObject(viewController);
            owner._handleTwoNavigationBars(backToMoreWillBeVisible);
        }
    };
    UINavigationControllerDelegateImpl.prototype.navigationControllerDidShowViewControllerAnimated = function (navigationController, viewController, animated) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView.moreNavigationController.DID_show(" + navigationController + ", " + viewController + ", " + animated + ");", tab_view_common_1.traceCategories.Debug);
        }
        navigationController.navigationBar.topItem.rightBarButtonItem = null;
        var owner = this._owner.get();
        if (owner) {
            owner._onViewControllerShown(viewController);
        }
    };
    UINavigationControllerDelegateImpl.ObjCProtocols = [UINavigationControllerDelegate];
    return UINavigationControllerDelegateImpl;
}(NSObject));
function updateTitleAndIconPositions(tabItem, tabBarItem, controller) {
    if (!tabItem || !tabBarItem) {
        return;
    }
    var orientation = controller.interfaceOrientation;
    var isPortrait = orientation !== 4 && orientation !== 3;
    var isIconAboveTitle = (majorVersion < 11) || (isPhone && isPortrait);
    if (!tabItem.iconSource) {
        if (isIconAboveTitle) {
            tabBarItem.titlePositionAdjustment = { horizontal: 0, vertical: -20 };
        }
        else {
            tabBarItem.titlePositionAdjustment = { horizontal: 0, vertical: 0 };
        }
    }
    if (!tabItem.title) {
        if (isIconAboveTitle) {
            tabBarItem.imageInsets = new UIEdgeInsets({ top: 6, left: 0, bottom: -6, right: 0 });
        }
        else {
            tabBarItem.imageInsets = new UIEdgeInsets({ top: 0, left: 0, bottom: 0, right: 0 });
        }
    }
}
var TabViewItem = (function (_super) {
    __extends(TabViewItem, _super);
    function TabViewItem() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabViewItem.prototype.setViewController = function (controller, nativeView) {
        this.__controller = controller;
        this.setNativeView(nativeView);
    };
    TabViewItem.prototype.disposeNativeView = function () {
        this.__controller = undefined;
        this.setNativeView(undefined);
    };
    TabViewItem.prototype.loadView = function (view) {
        var tabView = this.parent;
        if (tabView && tabView.items) {
            var index_1 = tabView.items.indexOf(this);
            if (index_1 === tabView.selectedIndex) {
                _super.prototype.loadView.call(this, view);
            }
        }
    };
    TabViewItem.prototype._update = function () {
        var parent = this.parent;
        var controller = this.__controller;
        if (parent && controller) {
            var icon = parent._getIcon(this.iconSource);
            var index_2 = parent.items.indexOf(this);
            var title = text_base_1.getTransformedText(this.title, this.style.textTransform);
            var tabBarItem = UITabBarItem.alloc().initWithTitleImageTag(title, icon, index_2);
            updateTitleAndIconPositions(this, tabBarItem, controller);
            var states = getTitleAttributesForStates(parent);
            applyStatesToItem(tabBarItem, states);
            controller.tabBarItem = tabBarItem;
        }
    };
    TabViewItem.prototype._updateTitleAndIconPositions = function () {
        if (!this.__controller || !this.__controller.tabBarItem) {
            return;
        }
        updateTitleAndIconPositions(this, this.__controller.tabBarItem, this.__controller);
    };
    TabViewItem.prototype[text_base_1.textTransformProperty.setNative] = function (value) {
        this._update();
    };
    return TabViewItem;
}(tab_view_common_1.TabViewItemBase));
exports.TabViewItem = TabViewItem;
var TabView = (function (_super) {
    __extends(TabView, _super);
    function TabView() {
        var _this = _super.call(this) || this;
        _this._iconsCache = {};
        _this.viewController = _this._ios = UITabBarControllerImpl.initWithOwner(new WeakRef(_this));
        _this.nativeViewProtected = _this._ios.view;
        return _this;
    }
    TabView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UITabBarControllerDelegateImpl.initWithOwner(new WeakRef(this));
        this._moreNavigationControllerDelegate = UINavigationControllerDelegateImpl.initWithOwner(new WeakRef(this));
    };
    TabView.prototype.disposeNativeView = function () {
        this._delegate = null;
        this._moreNavigationControllerDelegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TabView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        var selectedIndex = this.selectedIndex;
        var selectedView = this.items && this.items[selectedIndex] && this.items[selectedIndex].view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        this._ios.delegate = this._delegate;
    };
    TabView.prototype.onUnloaded = function () {
        this._ios.delegate = null;
        this._ios.moreNavigationController.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(TabView.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    TabView.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    TabView.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    TabView.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        var items = this.items;
        if (!items) {
            return;
        }
        var oldItem = items[oldIndex];
        if (oldItem) {
            oldItem.unloadView(oldItem.view);
        }
        var newItem = items[newIndex];
        if (newItem && this.isLoaded) {
            var selectedView = items[newIndex].view;
            if (selectedView instanceof frame_1.Frame) {
                selectedView._pushInFrameStackRecursive();
            }
            newItem.loadView(newItem.view);
        }
        _super.prototype.onSelectedIndexChanged.call(this, oldIndex, newIndex);
    };
    TabView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = tab_view_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = tab_view_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = tab_view_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = tab_view_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = tab_view_common_1.View.resolveSizeAndState(width, width, widthMode, 0);
        var heightAndState = tab_view_common_1.View.resolveSizeAndState(height, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    TabView.prototype._onViewControllerShown = function (viewController) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView._onViewControllerShown(" + viewController + ");", tab_view_common_1.traceCategories.Debug);
        }
        if (this._ios.viewControllers && this._ios.viewControllers.containsObject(viewController)) {
            this.selectedIndex = this._ios.viewControllers.indexOfObject(viewController);
        }
        else {
            if (tab_view_common_1.traceEnabled()) {
                tab_view_common_1.traceWrite("TabView._onViewControllerShown: viewController is not one of our viewControllers", tab_view_common_1.traceCategories.Debug);
            }
        }
    };
    TabView.prototype._handleTwoNavigationBars = function (backToMoreWillBeVisible) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView._handleTwoNavigationBars(backToMoreWillBeVisible: " + backToMoreWillBeVisible + ")", tab_view_common_1.traceCategories.Debug);
        }
        var page = this.page || this._selectedView.page || this._selectedView.currentPage;
        if (!page || !page.frame) {
            return;
        }
        var actionBarVisible = page.frame._getNavBarVisible(page);
        if (backToMoreWillBeVisible && actionBarVisible) {
            page.frame.ios._disableNavBarAnimation = true;
            page.actionBarHidden = true;
            page.frame.ios._disableNavBarAnimation = false;
            this._actionBarHiddenByTabView = true;
            if (tab_view_common_1.traceEnabled()) {
                tab_view_common_1.traceWrite("TabView hid action bar", tab_view_common_1.traceCategories.Debug);
            }
            return;
        }
        if (!backToMoreWillBeVisible && this._actionBarHiddenByTabView) {
            page.frame.ios._disableNavBarAnimation = true;
            page.actionBarHidden = false;
            page.frame.ios._disableNavBarAnimation = false;
            this._actionBarHiddenByTabView = undefined;
            if (tab_view_common_1.traceEnabled()) {
                tab_view_common_1.traceWrite("TabView restored action bar", tab_view_common_1.traceCategories.Debug);
            }
            return;
        }
    };
    TabView.prototype.getViewController = function (item) {
        var newController = item.view ? item.view.viewController : null;
        if (newController) {
            item.setViewController(newController, newController.view);
            return newController;
        }
        if (item.view.ios instanceof UIViewController) {
            newController = item.view.ios;
            item.setViewController(newController, newController.view);
        }
        else if (item.view.ios && item.view.ios.controller instanceof UIViewController) {
            newController = item.view.ios.controller;
            item.setViewController(newController, newController.view);
        }
        else {
            newController = view_1.ios.UILayoutViewController.initWithOwner(new WeakRef(item.view));
            newController.view.addSubview(item.view.nativeViewProtected);
            item.view.viewController = newController;
            item.setViewController(newController, item.view.nativeViewProtected);
        }
        return newController;
    };
    TabView.prototype.setViewControllers = function (items) {
        var _this = this;
        var length = items ? items.length : 0;
        if (length === 0) {
            this._ios.viewControllers = null;
            return;
        }
        var controllers = NSMutableArray.alloc().initWithCapacity(length);
        var states = getTitleAttributesForStates(this);
        items.forEach(function (item, i) {
            var controller = _this.getViewController(item);
            var icon = _this._getIcon(item.iconSource);
            var tabBarItem = UITabBarItem.alloc().initWithTitleImageTag((item.title || ""), icon, i);
            updateTitleAndIconPositions(item, tabBarItem, controller);
            applyStatesToItem(tabBarItem, states);
            controller.tabBarItem = tabBarItem;
            controllers.addObject(controller);
            item.canBeLoaded = true;
        });
        this._ios.viewControllers = controllers;
        this._ios.customizableViewControllers = null;
        this._ios.moreNavigationController.delegate = this._moreNavigationControllerDelegate;
    };
    TabView.prototype._getIconRenderingMode = function () {
        switch (this.iosIconRenderingMode) {
            case "alwaysOriginal":
                return 1;
            case "alwaysTemplate":
                return 2;
            case "automatic":
            default:
                return 0;
        }
    };
    TabView.prototype._getIcon = function (iconSource) {
        if (!iconSource) {
            return null;
        }
        var image = this._iconsCache[iconSource];
        if (!image) {
            var is = image_source_1.fromFileOrResource(iconSource);
            if (is && is.ios) {
                var originalRenderedImage = is.ios.imageWithRenderingMode(this._getIconRenderingMode());
                this._iconsCache[iconSource] = originalRenderedImage;
                image = originalRenderedImage;
            }
            else {
                tab_view_common_1.traceMissingIcon(iconSource);
            }
        }
        return image;
    };
    TabView.prototype._updateIOSTabBarColorsAndFonts = function () {
        if (!this.items) {
            return;
        }
        var tabBar = this.ios.tabBar;
        var states = getTitleAttributesForStates(this);
        for (var i = 0; i < tabBar.items.count; i++) {
            applyStatesToItem(tabBar.items[i], states);
        }
    };
    TabView.prototype[tab_view_common_1.selectedIndexProperty.setNative] = function (value) {
        if (tab_view_common_1.traceEnabled()) {
            tab_view_common_1.traceWrite("TabView._onSelectedIndexPropertyChangedSetNativeValue(" + value + ")", tab_view_common_1.traceCategories.Debug);
        }
        if (value > -1) {
            this._ios._willSelectViewController = this._ios.viewControllers[value];
            this._ios.selectedIndex = value;
        }
    };
    TabView.prototype[tab_view_common_1.itemsProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.itemsProperty.setNative] = function (value) {
        this.setViewControllers(value);
        tab_view_common_1.selectedIndexProperty.coerce(this);
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.tabTextFontSizeProperty.setNative] = function (value) {
        this._updateIOSTabBarColorsAndFonts();
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.tabTextColorProperty.setNative] = function (value) {
        this._updateIOSTabBarColorsAndFonts();
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.getDefault] = function () {
        return this._ios.tabBar.barTintColor;
    };
    TabView.prototype[tab_view_common_1.tabBackgroundColorProperty.setNative] = function (value) {
        this._ios.tabBar.barTintColor = value instanceof tab_view_common_1.Color ? value.ios : value;
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.getDefault] = function () {
        return this._ios.tabBar.tintColor;
    };
    TabView.prototype[tab_view_common_1.selectedTabTextColorProperty.setNative] = function (value) {
        this._ios.tabBar.tintColor = value instanceof tab_view_common_1.Color ? value.ios : value;
        this._updateIOSTabBarColorsAndFonts();
    };
    TabView.prototype[tab_view_common_1.fontInternalProperty.getDefault] = function () {
        return null;
    };
    TabView.prototype[tab_view_common_1.fontInternalProperty.setNative] = function (value) {
        this._updateIOSTabBarColorsAndFonts();
    };
    TabView.prototype[tab_view_common_1.iosIconRenderingModeProperty.getDefault] = function () {
        return "automatic";
    };
    TabView.prototype[tab_view_common_1.iosIconRenderingModeProperty.setNative] = function (value) {
        this._iconsCache = {};
        var items = this.items;
        if (items && items.length) {
            for (var i = 0, length_1 = items.length; i < length_1; i++) {
                var item = items[i];
                if (item.iconSource) {
                    item._update();
                }
            }
        }
    };
    __decorate([
        profiling_1.profile
    ], TabView.prototype, "onLoaded", null);
    return TabView;
}(tab_view_common_1.TabViewBase));
exports.TabView = TabView;
function getTitleAttributesForStates(tabView) {
    var _a, _b;
    var result = {};
    var defaultTabItemFontSize = 10;
    var tabItemFontSize = tabView.style.tabTextFontSize || defaultTabItemFontSize;
    var font = tabView.style.fontInternal.getUIFont(UIFont.systemFontOfSize(tabItemFontSize));
    var tabItemTextColor = tabView.style.tabTextColor;
    var textColor = tabItemTextColor instanceof tab_view_common_1.Color ? tabItemTextColor.ios : null;
    result.normalState = (_a = {}, _a[NSFontAttributeName] = font, _a);
    if (textColor) {
        result.normalState[UITextAttributeTextColor] = textColor;
    }
    var tabSelectedItemTextColor = tabView.style.selectedTabTextColor;
    var selectedTextColor = tabSelectedItemTextColor instanceof tab_view_common_1.Color ? tabSelectedItemTextColor.ios : null;
    result.selectedState = (_b = {}, _b[NSFontAttributeName] = font, _b);
    if (selectedTextColor) {
        result.selectedState[UITextAttributeTextColor] = selectedTextColor;
    }
    return result;
}
function applyStatesToItem(item, states) {
    item.setTitleTextAttributesForState(states.normalState, 0);
    item.setTitleTextAttributesForState(states.selectedState, 4);
}
//# sourceMappingURL=tab-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-content-item/tab-content-item.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip/tab-strip.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-strip-item/tab-strip-item.js"));
exports.traceCategory = "TabView";
var knownCollections;
(function (knownCollections) {
    knownCollections.items = "items";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var TabsBase = (function (_super) {
    __extends(TabsBase, _super);
    function TabsBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabsBase = __decorate([
        view_1.CSSType("Tabs")
    ], TabsBase);
    return TabsBase;
}(tab_navigation_base_1.TabNavigationBase));
exports.TabsBase = TabsBase;
exports.swipeEnabledProperty = new properties_1.Property({
    name: "swipeEnabled", defaultValue: true, valueConverter: view_1.booleanConverter
});
exports.swipeEnabledProperty.register(TabsBase);
exports.offscreenTabLimitProperty = new properties_1.Property({
    name: "offscreenTabLimit", defaultValue: 1, valueConverter: function (v) { return parseInt(v); }
});
exports.offscreenTabLimitProperty.register(TabsBase);
exports.tabsPositionProperty = new properties_1.Property({ name: "tabsPosition", defaultValue: "top" });
exports.tabsPositionProperty.register(TabsBase);
//# sourceMappingURL=tabs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/tabs/tabs.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var tab_navigation_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tab-navigation-base/tab-navigation-base/tab-navigation-base.js");
var tabs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/tabs/tabs-common.js"));
var MDCTabBarDelegateImpl = (function (_super) {
    __extends(MDCTabBarDelegateImpl, _super);
    function MDCTabBarDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MDCTabBarDelegateImpl.initWithOwner = function (owner) {
        var delegate = MDCTabBarDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    MDCTabBarDelegateImpl.prototype.tabBarShouldSelectItem = function (tabBar, item) {
        var owner = this._owner.get();
        var shouldSelectItem = owner._canSelectItem;
        var selectedIndex = owner.tabBarItems.indexOf(item);
        if (owner.selectedIndex !== selectedIndex) {
            owner._canSelectItem = false;
        }
        return shouldSelectItem;
    };
    MDCTabBarDelegateImpl.prototype.tabBarWillSelectItem = function (tabBar, item) {
    };
    MDCTabBarDelegateImpl.prototype.tabBarDidSelectItem = function (tabBar, selectedItem) {
        var owner = this._owner.get();
        var tabBarItems = owner.tabBarItems;
        var selectedIndex = tabBarItems.indexOf(selectedItem);
        owner.selectedIndex = selectedIndex;
    };
    MDCTabBarDelegateImpl.ObjCProtocols = [MDCTabBarDelegate];
    return MDCTabBarDelegateImpl;
}(NSObject));
var UIPageViewControllerImpl = (function (_super) {
    __extends(UIPageViewControllerImpl, _super);
    function UIPageViewControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIPageViewControllerImpl.initWithOwner = function (owner) {
        var handler = UIPageViewControllerImpl.alloc().initWithTransitionStyleNavigationOrientationOptions(1, 0, null);
        handler._owner = owner;
        return handler;
    };
    UIPageViewControllerImpl.prototype.viewDidLoad = function () {
        var owner = this._owner.get();
        var tabBarItems = owner.tabBarItems;
        var tabBar = MDCTabBar.alloc().initWithFrame(this.view.bounds);
        if (tabBarItems && tabBarItems.length) {
            tabBar.items = NSArray.arrayWithArray(tabBarItems);
        }
        tabBar.delegate = this.tabBarDelegate = MDCTabBarDelegateImpl.initWithOwner(new WeakRef(owner));
        tabBar.tintColor = UIColor.blueColor;
        tabBar.barTintColor = UIColor.whiteColor;
        tabBar.setTitleColorForState(UIColor.blackColor, 0);
        tabBar.setTitleColorForState(UIColor.blackColor, 1);
        tabBar.autoresizingMask = 2 | 32;
        tabBar.alignment = 0;
        tabBar.sizeToFit();
        this.tabBar = tabBar;
        this.view.addSubview(tabBar);
    };
    UIPageViewControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        if (!owner.isLoaded) {
            owner.callLoaded();
        }
    };
    UIPageViewControllerImpl.prototype.viewDidLayoutSubviews = function () {
        _super.prototype.viewDidLayoutSubviews.call(this);
        var owner = this._owner.get();
        var tabsPosition = owner.tabsPosition;
        var tabBarTop = this.view.safeAreaInsets.top;
        var tabBarHeight = this.tabBar.frame.size.height;
        var scrollViewTop = this.tabBar.frame.size.height;
        var scrollViewHeight = this.view.bounds.size.height - this.tabBar.frame.size.height + this.view.safeAreaInsets.bottom;
        if (tabsPosition === "bottom") {
            tabBarTop = this.view.frame.size.height - this.tabBar.frame.size.height - this.view.safeAreaInsets.bottom;
            scrollViewTop = this.view.frame.origin.y;
            scrollViewHeight = this.view.frame.size.height - this.view.safeAreaInsets.bottom;
        }
        this.tabBar.frame = CGRectMake(this.view.safeAreaInsets.left, tabBarTop, this.tabBar.frame.size.width, tabBarHeight);
        var subViews = this.view.subviews;
        var scrollView = null;
        var mdcBar = null;
        for (var i = 0; i < subViews.count; i++) {
            var view = subViews[i];
            if (view instanceof UIScrollView) {
                scrollView = view;
            }
            if (view instanceof MDCTabBar) {
                mdcBar = view;
            }
        }
        if (scrollView) {
            this.scrollView = scrollView;
            if (!owner.swipeEnabled) {
                scrollView.scrollEnabled = false;
            }
            scrollView.frame = CGRectMake(this.view.safeAreaInsets.left, scrollViewTop, this.view.bounds.size.width, scrollViewHeight);
        }
    };
    return UIPageViewControllerImpl;
}(UIPageViewController));
var UIPageViewControllerDataSourceImpl = (function (_super) {
    __extends(UIPageViewControllerDataSourceImpl, _super);
    function UIPageViewControllerDataSourceImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIPageViewControllerDataSourceImpl.initWithOwner = function (owner) {
        var dataSource = UIPageViewControllerDataSourceImpl.new();
        dataSource._owner = owner;
        return dataSource;
    };
    UIPageViewControllerDataSourceImpl.prototype.pageViewControllerViewControllerBeforeViewController = function (pageViewController, viewController) {
        var owner = this._owner.get();
        var selectedIndex = owner.selectedIndex;
        if (selectedIndex === 0) {
            return null;
        }
        selectedIndex--;
        var prevItem = owner.items[selectedIndex];
        var prevViewController = prevItem.__controller;
        prevItem.canBeLoaded = true;
        return prevViewController;
    };
    UIPageViewControllerDataSourceImpl.prototype.pageViewControllerViewControllerAfterViewController = function (pageViewController, viewController) {
        var owner = this._owner.get();
        var selectedIndex = owner.selectedIndex;
        if (selectedIndex === owner.items.length - 1) {
            return null;
        }
        selectedIndex++;
        var nextItem = owner.items[selectedIndex];
        var nextViewController = nextItem.__controller;
        nextItem.canBeLoaded = true;
        return nextViewController;
    };
    UIPageViewControllerDataSourceImpl.prototype.presentationCountForPageViewController = function (pageViewController) {
        return 0;
    };
    UIPageViewControllerDataSourceImpl.prototype.presentationIndexForPageViewController = function (pageViewController) {
        return 0;
    };
    UIPageViewControllerDataSourceImpl.ObjCProtocols = [UIPageViewControllerDataSource];
    return UIPageViewControllerDataSourceImpl;
}(NSObject));
var UIPageViewControllerDelegateImpl = (function (_super) {
    __extends(UIPageViewControllerDelegateImpl, _super);
    function UIPageViewControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIPageViewControllerDelegateImpl.initWithOwner = function (owner) {
        var delegate = UIPageViewControllerDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UIPageViewControllerDelegateImpl.prototype.pageViewControllerWillTransitionToViewControllers = function (pageViewController, viewControllers) {
    };
    UIPageViewControllerDelegateImpl.prototype.pageViewControllerDidFinishAnimatingPreviousViewControllersTransitionCompleted = function (pageViewController, didFinishAnimating, previousViewControllers, transitionCompleted) {
        if (!transitionCompleted) {
            return;
        }
        var owner = this._owner.get();
        var ownerViewControllers = owner.viewControllers;
        var selectedIndex = owner.selectedIndex;
        var nextViewController = pageViewController.viewControllers[0];
        var nextViewControllerIndex = ownerViewControllers.indexOf(nextViewController);
        if (selectedIndex !== nextViewControllerIndex) {
            owner.selectedIndex = nextViewControllerIndex;
            owner._canSelectItem = true;
        }
    };
    UIPageViewControllerDelegateImpl.ObjCProtocols = [UIPageViewControllerDelegate];
    return UIPageViewControllerDelegateImpl;
}(NSObject));
function iterateIndexRange(index, eps, lastIndex, callback) {
    var rangeStart = Math.max(0, index - eps);
    var rangeEnd = Math.min(index + eps, lastIndex);
    for (var i = rangeStart; i <= rangeEnd; i++) {
        callback(i);
    }
}
var Tabs = (function (_super) {
    __extends(Tabs, _super);
    function Tabs() {
        var _this = _super.call(this) || this;
        _this._iconsCache = {};
        _this.viewController = _this._ios = UIPageViewControllerImpl.initWithOwner(new WeakRef(_this));
        _this.nativeViewProtected = _this._ios.view;
        return _this;
    }
    Tabs.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._dataSource = UIPageViewControllerDataSourceImpl.initWithOwner(new WeakRef(this));
        this._delegate = UIPageViewControllerDelegateImpl.initWithOwner(new WeakRef(this));
    };
    Tabs.prototype.disposeNativeView = function () {
        this._dataSource = null;
        this._delegate = null;
        this._ios.tabBarDelegate = null;
        this._ios.tabBar = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Tabs.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        var selectedIndex = this.selectedIndex;
        var selectedView = this.items && this.items[selectedIndex] && this.items[selectedIndex].view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        this._ios.dataSource = this._dataSource;
        this._ios.delegate = this._delegate;
    };
    Tabs.prototype.onUnloaded = function () {
        this._ios.dataSource = null;
        this._ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(Tabs.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    Tabs.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    Tabs.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    Tabs.prototype.onSelectedIndexChanged = function (oldIndex, newIndex) {
        var items = this.items;
        if (!items) {
            return;
        }
        this._loadUnloadTabItems(newIndex);
        _super.prototype.onSelectedIndexChanged.call(this, oldIndex, newIndex);
    };
    Tabs.prototype._loadUnloadTabItems = function (newIndex) {
        var _this = this;
        var items = this.items;
        var lastIndex = this.items.length - 1;
        var offsideItems = this.offscreenTabLimit;
        var toUnload = [];
        var toLoad = [];
        iterateIndexRange(newIndex, offsideItems, lastIndex, function (i) { return toLoad.push(i); });
        items.forEach(function (item, i) {
            var indexOfI = toLoad.indexOf(i);
            if (indexOfI < 0) {
                toUnload.push(i);
            }
        });
        toUnload.forEach(function (index) {
            var item = items[index];
            if (items[index]) {
                item.unloadView(item.view);
            }
        });
        var newItem = items[newIndex];
        var selectedView = newItem && newItem.view;
        if (selectedView instanceof frame_1.Frame) {
            selectedView._pushInFrameStackRecursive();
        }
        toLoad.forEach(function (index) {
            var item = items[index];
            if (_this.isLoaded && items[index]) {
                item.canBeLoaded = true;
                item.loadView(item.view);
            }
        });
    };
    Tabs.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = utils_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = utils_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = utils_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = utils_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = view_1.View.resolveSizeAndState(width, width, widthMode, 0);
        var heightAndState = view_1.View.resolveSizeAndState(height, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Tabs.prototype._onViewControllerShown = function (viewController) {
        if (this._ios.viewControllers && this._ios.viewControllers.containsObject(viewController)) {
            this.selectedIndex = this._ios.viewControllers.indexOfObject(viewController);
        }
        else {
        }
    };
    Tabs.prototype.getViewController = function (item) {
        var newController = item.view ? item.view.viewController : null;
        if (newController) {
            item.setViewController(newController, newController.view);
            return newController;
        }
        if (item.view.ios instanceof UIViewController) {
            newController = item.view.ios;
            item.setViewController(newController, newController.view);
        }
        else if (item.view.ios && item.view.ios.controller instanceof UIViewController) {
            newController = item.view.ios.controller;
            item.setViewController(newController, newController.view);
        }
        else {
            newController = view_1.ios.UILayoutViewController.initWithOwner(new WeakRef(item.view));
            newController.view.addSubview(item.view.nativeViewProtected);
            item.view.viewController = newController;
            item.setViewController(newController, item.view.nativeViewProtected);
        }
        return newController;
    };
    Tabs.prototype.setViewControllers = function (items) {
        var _this = this;
        var length = items ? items.length : 0;
        if (length === 0) {
            return;
        }
        var viewControllers = [];
        items.forEach(function (item) {
            var controller = _this.getViewController(item);
            viewControllers.push(controller);
        });
        this.viewControllers = viewControllers;
        iterateIndexRange(this.selectedIndex, 1, this.items.length, function (index) {
            items[index].canBeLoaded = true;
        });
    };
    Tabs.prototype.setTabStripItems = function (items) {
        var _this = this;
        var tabBarItems = [];
        items.forEach(function (item, i) {
            item.index = i;
            var tabBarItem = _this.createTabBarItem(item, i);
            tabBarItems.push(tabBarItem);
            item.setNativeView(tabBarItem);
        });
        this.tabBarItems = tabBarItems;
        if (this.viewController && this.viewController.tabBar) {
            this.viewController.tabBar.itemAppearance = this._getTabBarItemAppearance();
            this.viewController.tabBar.items = NSArray.arrayWithArray(tabBarItems);
            this.viewController.tabBar.sizeToFit();
            this.tabStrip.setNativeView(this.viewController.tabBar);
        }
    };
    Tabs.prototype.createTabBarItem = function (item, index) {
        var image;
        var title;
        image = this._getIcon(item);
        title = item.label ? item.label.text : item.title;
        if (!this.tabStrip._hasImage) {
            this.tabStrip._hasImage = !!image;
        }
        if (!this.tabStrip._hasTitle) {
            this.tabStrip._hasTitle = !!title;
        }
        var tabBarItem = UITabBarItem.alloc().initWithTitleImageTag(title, image, index);
        return tabBarItem;
    };
    Tabs.prototype._getTabBarItemAppearance = function () {
        var itemAppearance;
        if (this.tabStrip._hasImage && this.tabStrip._hasTitle) {
            itemAppearance = 2;
        }
        else if (this.tabStrip._hasImage) {
            itemAppearance = 1;
        }
        else {
            itemAppearance = 0;
        }
        return itemAppearance;
    };
    Tabs.prototype._getIconRenderingMode = function () {
        return 1;
    };
    Tabs.prototype._getIcon = function (tabStripItem) {
        var iconSource = tabStripItem.image ? tabStripItem.image.src : tabStripItem.iconSource;
        if (!iconSource) {
            return null;
        }
        var image = this._iconsCache[iconSource];
        if (!image) {
            var is = new image_source_1.ImageSource;
            if (utils_1.isFontIconURI(iconSource)) {
                var fontIconCode = iconSource.split("//")[1];
                var font = tabStripItem.style.fontInternal;
                var color = tabStripItem.style.color;
                is = image_source_1.fromFontIconCode(fontIconCode, font, color);
            }
            else {
                is = image_source_1.fromFileOrResource(iconSource);
            }
            if (is && is.ios) {
                var originalRenderedImage = is.ios.imageWithRenderingMode(this._getIconRenderingMode());
                this._iconsCache[iconSource] = originalRenderedImage;
                image = originalRenderedImage;
            }
            else {
            }
        }
        return image;
    };
    Tabs.prototype.getTabBarBackgroundColor = function () {
        return this._ios.tabBar.barTintColor;
    };
    Tabs.prototype.setTabBarBackgroundColor = function (value) {
        this._ios.tabBar.barTintColor = value instanceof color_1.Color ? value.ios : value;
    };
    Tabs.prototype.getTabBarFontInternal = function () {
        return this._ios.tabBar.unselectedItemTitleFont;
    };
    Tabs.prototype.setTabBarFontInternal = function (value) {
        var defaultTabItemFontSize = 10;
        var tabItemFontSize = this.tabStrip.style.fontSize || defaultTabItemFontSize;
        var font = this.tabStrip.style.fontInternal.getUIFont(UIFont.systemFontOfSize(tabItemFontSize));
        this._ios.tabBar.unselectedItemTitleFont = font;
        this._ios.tabBar.selectedItemTitleFont = font;
    };
    Tabs.prototype.getTabBarTextTransform = function () {
        return null;
    };
    Tabs.prototype.setTabBarTextTransform = function (value) {
        if (value === "none") {
            this._ios.tabBar.titleTextTransform = 1;
        }
        else if (value === "uppercase") {
            this._ios.tabBar.titleTextTransform = 2;
        }
    };
    Tabs.prototype.getTabBarColor = function () {
        return this._ios.tabBar.titleColorForState(0);
    };
    Tabs.prototype.setTabBarColor = function (value) {
        var nativeColor = value instanceof color_1.Color ? value.ios : value;
        this._ios.tabBar.setTitleColorForState(nativeColor, 0);
        this._ios.tabBar.setTitleColorForState(nativeColor, 1);
    };
    Tabs.prototype.getTabBarHighlightColor = function () {
        return this._ios.tabBar.tintColor;
    };
    Tabs.prototype.setTabBarHighlightColor = function (value) {
        var nativeColor = value instanceof color_1.Color ? value.ios : value;
        this._ios.tabBar.tintColor = nativeColor;
    };
    Tabs.prototype[tab_navigation_base_1.selectedIndexProperty.setNative] = function (value) {
        var that = this;
        if (value > -1) {
            var item = this.items[value];
            var controllers = NSMutableArray.alloc().initWithCapacity(1);
            var itemController = item.__controller;
            controllers.addObject(itemController);
            var navigationDirection = 0;
            if (this._currentNativeSelectedIndex && this._currentNativeSelectedIndex > value) {
                navigationDirection = 1;
            }
            this._currentNativeSelectedIndex = value;
            this.viewController.setViewControllersDirectionAnimatedCompletion(controllers, navigationDirection, true, function (finished) {
                if (finished) {
                    that._canSelectItem = true;
                }
            });
            if (this.tabBarItems && this.tabBarItems.length && this.viewController && this.viewController.tabBar) {
                this.viewController.tabBar.setSelectedItemAnimated(this.tabBarItems[value], true);
            }
        }
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.itemsProperty.setNative] = function (value) {
        this.setViewControllers(value);
        tab_navigation_base_1.selectedIndexProperty.coerce(this);
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.getDefault] = function () {
        return null;
    };
    Tabs.prototype[tab_navigation_base_1.tabStripProperty.setNative] = function (value) {
        this.setTabStripItems(value.items);
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.getDefault] = function () {
        return true;
    };
    Tabs.prototype[tabs_common_1.swipeEnabledProperty.setNative] = function (value) {
        if (this.viewController && this.viewController.scrollView) {
            this.viewController.scrollView.scrollEnabled = value;
        }
    };
    return Tabs;
}(tabs_common_1.TabsBase));
exports.Tabs = Tabs;
//# sourceMappingURL=tabs.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var formatted_string_1 = __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js");
exports.FormattedString = formatted_string_1.FormattedString;
exports.Span = formatted_string_1.Span;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var CHILD_SPAN = "Span";
var CHILD_FORMATTED_TEXT = "formattedText";
var CHILD_FORMATTED_STRING = "FormattedString";
var TextBaseCommon = (function (_super) {
    __extends(TextBaseCommon, _super);
    function TextBaseCommon() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TextBaseCommon.prototype, "nativeTextViewProtected", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "letterSpacing", {
        get: function () {
            return this.style.letterSpacing;
        },
        set: function (value) {
            this.style.letterSpacing = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "lineHeight", {
        get: function () {
            return this.style.lineHeight;
        },
        set: function (value) {
            this.style.lineHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textAlignment", {
        get: function () {
            return this.style.textAlignment;
        },
        set: function (value) {
            this.style.textAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "whiteSpace", {
        get: function () {
            return this.style.whiteSpace;
        },
        set: function (value) {
            this.style.whiteSpace = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    TextBaseCommon.prototype._onFormattedTextContentsChanged = function (data) {
        if (this.nativeViewProtected) {
            this[exports.formattedTextProperty.setNative](data.value);
        }
    };
    TextBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (name === CHILD_SPAN) {
            if (!this.formattedText) {
                var formattedText = new formatted_string_1.FormattedString();
                formattedText.spans.push(value);
                this.formattedText = formattedText;
            }
            else {
                this.formattedText.spans.push(value);
            }
        }
        else if (name === CHILD_FORMATTED_TEXT || name === CHILD_FORMATTED_STRING) {
            this.formattedText = value;
        }
    };
    TextBaseCommon.prototype._requestLayoutOnTextChanged = function () {
        this.requestLayout();
    };
    TextBaseCommon.prototype.eachChild = function (callback) {
        var text = this.formattedText;
        if (text) {
            callback(text);
        }
    };
    TextBaseCommon.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
    };
    return TextBaseCommon;
}(view_1.View));
exports.TextBaseCommon = TextBaseCommon;
TextBaseCommon.prototype._isSingleLine = false;
function isBold(fontWeight) {
    return fontWeight === "bold" || fontWeight === "700" || fontWeight === "800" || fontWeight === "900";
}
exports.isBold = isBold;
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isAndroid });
exports.textProperty.register(TextBaseCommon);
exports.formattedTextProperty = new view_1.Property({ name: "formattedText", affectsLayout: true, valueChanged: onFormattedTextPropertyChanged });
exports.formattedTextProperty.register(TextBaseCommon);
function onFormattedTextPropertyChanged(textBase, oldValue, newValue) {
    if (oldValue) {
        oldValue.off(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
        textBase._removeView(oldValue);
    }
    if (newValue) {
        var oldParent = newValue.parent;
        if (oldParent) {
            oldParent._removeView(newValue);
        }
        textBase._addView(newValue);
        newValue.on(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
    }
}
var textAlignmentConverter = view_1.makeParser(view_1.makeValidator("initial", "left", "center", "right"));
exports.textAlignmentProperty = new view_1.InheritedCssProperty({ name: "textAlignment", cssName: "text-align", defaultValue: "initial", valueConverter: textAlignmentConverter });
exports.textAlignmentProperty.register(view_1.Style);
var textTransformConverter = view_1.makeParser(view_1.makeValidator("initial", "none", "capitalize", "uppercase", "lowercase"));
exports.textTransformProperty = new view_1.CssProperty({ name: "textTransform", cssName: "text-transform", defaultValue: "initial", valueConverter: textTransformConverter });
exports.textTransformProperty.register(view_1.Style);
var whiteSpaceConverter = view_1.makeParser(view_1.makeValidator("initial", "normal", "nowrap"));
exports.whiteSpaceProperty = new view_1.CssProperty({ name: "whiteSpace", cssName: "white-space", defaultValue: "initial", affectsLayout: view_1.isIOS, valueConverter: whiteSpaceConverter });
exports.whiteSpaceProperty.register(view_1.Style);
var textDecorationConverter = view_1.makeParser(view_1.makeValidator("none", "underline", "line-through", "underline line-through"));
exports.textDecorationProperty = new view_1.CssProperty({ name: "textDecoration", cssName: "text-decoration", defaultValue: "none", valueConverter: textDecorationConverter });
exports.textDecorationProperty.register(view_1.Style);
exports.letterSpacingProperty = new view_1.CssProperty({ name: "letterSpacing", cssName: "letter-spacing", defaultValue: 0, affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.letterSpacingProperty.register(view_1.Style);
exports.lineHeightProperty = new view_1.CssProperty({ name: "lineHeight", cssName: "line-height", affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.lineHeightProperty.register(view_1.Style);
exports.resetSymbol = Symbol("textPropertyDefault");
//# sourceMappingURL=text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js"));
var TextBase = (function (_super) {
    __extends(TextBase, _super);
    function TextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBase.prototype[text_base_common_1.textProperty.getDefault] = function () {
        return text_base_common_1.resetSymbol;
    };
    TextBase.prototype[text_base_common_1.textProperty.setNative] = function (value) {
        var reset = value === text_base_common_1.resetSymbol;
        if (!reset && this.formattedText) {
            return;
        }
        this._setNativeText(reset);
        this._requestLayoutOnTextChanged();
    };
    TextBase.prototype[text_base_common_1.formattedTextProperty.setNative] = function (value) {
        this._setNativeText();
        text_base_common_1.textProperty.nativeValueChange(this, !value ? "" : value.toString());
        this._requestLayoutOnTextChanged();
    };
    TextBase.prototype[text_base_common_1.colorProperty.getDefault] = function () {
        var nativeView = this.nativeTextViewProtected;
        if (nativeView instanceof UIButton) {
            return nativeView.titleColorForState(0);
        }
        else {
            return nativeView.textColor;
        }
    };
    TextBase.prototype[text_base_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof text_base_common_1.Color ? value.ios : value;
        var nativeView = this.nativeTextViewProtected;
        if (nativeView instanceof UIButton) {
            nativeView.setTitleColorForState(color, 0);
            nativeView.titleLabel.textColor = color;
        }
        else {
            nativeView.textColor = color;
        }
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.getDefault] = function () {
        var nativeView = this.nativeTextViewProtected;
        nativeView = nativeView instanceof UIButton ? nativeView.titleLabel : nativeView;
        return nativeView.font;
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.setNative] = function (value) {
        if (!(value instanceof font_1.Font) || !this.formattedText) {
            var nativeView = this.nativeTextViewProtected;
            nativeView = nativeView instanceof UIButton ? nativeView.titleLabel : nativeView;
            var font = value instanceof font_1.Font ? value.getUIFont(nativeView.font) : value;
            nativeView.font = font;
        }
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "initial":
            case "left":
                nativeView.textAlignment = 0;
                break;
            case "center":
                nativeView.textAlignment = 1;
                break;
            case "right":
                nativeView.textAlignment = 2;
                break;
        }
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.textTransformProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
        if (reset) {
            var nativeView = this.nativeTextViewProtected;
            if (nativeView instanceof UIButton) {
                nativeView.setAttributedTitleForState(null, 0);
                nativeView.setTitleForState(null, 0);
            }
            else {
                nativeView.attributedText = null;
                nativeView.text = null;
            }
            return;
        }
        if (this.formattedText) {
            this.setFormattedTextDecorationAndTransform();
        }
        else {
            this.setTextDecorationAndTransform();
        }
    };
    TextBase.prototype.setFormattedTextDecorationAndTransform = function () {
        var attrText = this.createNSMutableAttributedString(this.formattedText);
        if (this.letterSpacing !== 0) {
            attrText.addAttributeValueRange(NSKernAttributeName, this.letterSpacing * this.nativeTextViewProtected.font.pointSize, { location: 0, length: attrText.length });
        }
        if (this.style.lineHeight) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.lineSpacing = this.lineHeight;
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            if (this.nativeTextViewProtected instanceof UILabel) {
                paragraphStyle.lineBreakMode = this.nativeTextViewProtected.lineBreakMode;
            }
            attrText.addAttributeValueRange(NSParagraphStyleAttributeName, paragraphStyle, { location: 0, length: attrText.length });
        }
        else if (this.nativeTextViewProtected instanceof UITextView) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            attrText.addAttributeValueRange(NSParagraphStyleAttributeName, paragraphStyle, { location: 0, length: attrText.length });
        }
        if (this.nativeTextViewProtected instanceof UIButton) {
            this.nativeTextViewProtected.setAttributedTitleForState(attrText, 0);
        }
        else {
            this.nativeTextViewProtected.attributedText = attrText;
        }
    };
    TextBase.prototype.setTextDecorationAndTransform = function () {
        var style = this.style;
        var dict = new Map();
        switch (style.textDecoration) {
            case "none":
                break;
            case "underline":
                dict.set(NSUnderlineStyleAttributeName, 1);
                break;
            case "line-through":
                dict.set(NSStrikethroughStyleAttributeName, 1);
                break;
            case "underline line-through":
                dict.set(NSUnderlineStyleAttributeName, 1);
                dict.set(NSStrikethroughStyleAttributeName, 1);
                break;
            default:
                throw new Error("Invalid text decoration value: " + style.textDecoration + ". Valid values are: 'none', 'underline', 'line-through', 'underline line-through'.");
        }
        if (style.letterSpacing !== 0) {
            dict.set(NSKernAttributeName, style.letterSpacing * this.nativeTextViewProtected.font.pointSize);
        }
        var isTextView = this.nativeTextViewProtected instanceof UITextView;
        if (style.lineHeight) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.lineSpacing = style.lineHeight;
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            if (this.nativeTextViewProtected instanceof UILabel) {
                paragraphStyle.lineBreakMode = this.nativeTextViewProtected.lineBreakMode;
            }
            dict.set(NSParagraphStyleAttributeName, paragraphStyle);
        }
        else if (isTextView) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            dict.set(NSParagraphStyleAttributeName, paragraphStyle);
        }
        if (style.color && (dict.size > 0 || isTextView)) {
            dict.set(NSForegroundColorAttributeName, style.color.ios);
        }
        var text = this.text;
        var string = (text === undefined || text === null) ? "" : text.toString();
        var source = getTransformedText(string, this.textTransform);
        if (dict.size > 0 || isTextView) {
            if (isTextView) {
                dict.set(NSFontAttributeName, this.nativeTextViewProtected.font);
            }
            var result = NSMutableAttributedString.alloc().initWithString(source);
            result.setAttributesRange(dict, { location: 0, length: source.length });
            if (this.nativeTextViewProtected instanceof UIButton) {
                this.nativeTextViewProtected.setAttributedTitleForState(result, 0);
            }
            else {
                this.nativeTextViewProtected.attributedText = result;
            }
        }
        else {
            if (this.nativeTextViewProtected instanceof UIButton) {
                this.nativeTextViewProtected.setAttributedTitleForState(null, 0);
                this.nativeTextViewProtected.setTitleForState(source, 0);
            }
            else {
                this.nativeTextViewProtected.attributedText = undefined;
                this.nativeTextViewProtected.text = source;
            }
        }
    };
    TextBase.prototype.createNSMutableAttributedString = function (formattedString) {
        var mas = NSMutableAttributedString.alloc().init();
        if (formattedString && formattedString.parent) {
            for (var i = 0, spanStart = 0, length_1 = formattedString.spans.length; i < length_1; i++) {
                var span = formattedString.spans.getItem(i);
                var text = span.text;
                var textTransform = formattedString.parent.textTransform;
                var spanText = (text === null || text === undefined) ? "" : text.toString();
                if (textTransform !== "none" && textTransform !== "initial") {
                    spanText = getTransformedText(spanText, textTransform);
                }
                var nsAttributedString = this.createMutableStringForSpan(span, spanText);
                mas.insertAttributedStringAtIndex(nsAttributedString, spanStart);
                spanStart += spanText.length;
            }
        }
        return mas;
    };
    TextBase.prototype.createMutableStringForSpan = function (span, text) {
        var viewFont = this.nativeTextViewProtected.font;
        var attrDict = {};
        var style = span.style;
        var bold = text_base_common_1.isBold(style.fontWeight);
        var italic = style.fontStyle === "italic";
        var fontFamily = span.fontFamily;
        var fontSize = span.fontSize;
        if (bold || italic || fontFamily || fontSize) {
            var font = new font_1.Font(style.fontFamily, style.fontSize, style.fontStyle, style.fontWeight);
            var iosFont = font.getUIFont(viewFont);
            attrDict[NSFontAttributeName] = iosFont;
        }
        var color = span.color;
        if (color) {
            attrDict[NSForegroundColorAttributeName] = color.ios;
        }
        var backgroundColor = (style.backgroundColor
            || span.parent.backgroundColor
            || span.parent.parent.backgroundColor);
        if (backgroundColor) {
            attrDict[NSBackgroundColorAttributeName] = backgroundColor.ios;
        }
        var valueSource;
        if (text_base_common_1.textDecorationProperty.isSet(style)) {
            valueSource = style;
        }
        else if (text_base_common_1.textDecorationProperty.isSet(span.parent.style)) {
            valueSource = span.parent.style;
        }
        else if (text_base_common_1.textDecorationProperty.isSet(span.parent.parent.style)) {
            valueSource = span.parent.parent.style;
        }
        if (valueSource) {
            var textDecorations = valueSource.textDecoration;
            var underline_1 = textDecorations.indexOf("underline") !== -1;
            if (underline_1) {
                attrDict[NSUnderlineStyleAttributeName] = underline_1;
            }
            var strikethrough = textDecorations.indexOf("line-through") !== -1;
            if (strikethrough) {
                attrDict[NSStrikethroughStyleAttributeName] = strikethrough;
            }
        }
        return NSMutableAttributedString.alloc().initWithStringAttributes(text, attrDict);
    };
    return TextBase;
}(text_base_common_1.TextBaseCommon));
exports.TextBase = TextBase;
function getTransformedText(text, textTransform) {
    if (!text || !types_1.isString(text)) {
        return "";
    }
    switch (textTransform) {
        case "uppercase":
            return NSStringFromNSAttributedString(text).uppercaseString;
        case "lowercase":
            return NSStringFromNSAttributedString(text).lowercaseString;
        case "capitalize":
            return NSStringFromNSAttributedString(text).capitalizedString;
        default:
            return text;
    }
}
exports.getTransformedText = getTransformedText;
function NSStringFromNSAttributedString(source) {
    return NSString.stringWithString(source instanceof NSAttributedString && source.string || source);
}
//# sourceMappingURL=text-base.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js"));
var TextFieldBase = (function (_super) {
    __extends(TextFieldBase, _super);
    function TextFieldBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldBase.returnPressEvent = "returnPress";
    TextFieldBase = __decorate([
        editable_text_base_1.CSSType("TextField")
    ], TextFieldBase);
    return TextFieldBase;
}(editable_text_base_1.EditableTextBase));
exports.TextFieldBase = TextFieldBase;
TextFieldBase.prototype.recycleNativeView = "auto";
exports.secureProperty = new editable_text_base_1.Property({ name: "secure", defaultValue: false, valueConverter: editable_text_base_1.booleanConverter });
exports.secureProperty.register(TextFieldBase);
//# sourceMappingURL=text-field-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_field_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js"));
var zeroLength = {
    value: 0,
    unit: "px"
};
var UITextFieldDelegateImpl = (function (_super) {
    __extends(UITextFieldDelegateImpl, _super);
    function UITextFieldDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITextFieldDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITextFieldDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldBeginEditing = function (textField) {
        this.firstEdit = true;
        var owner = this._owner.get();
        if (owner) {
            return owner.editable;
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldDidBeginEditing = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            owner.notify({ eventName: TextField.focusEvent, object: owner });
        }
    };
    UITextFieldDelegateImpl.prototype.textFieldDidEndEditing = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            if (owner.updateTextTrigger === "focusLost") {
                text_field_common_1.textProperty.nativeValueChange(owner, textField.text);
            }
            owner.dismissSoftInput();
        }
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldClear = function (textField) {
        this.firstEdit = false;
        var owner = this._owner.get();
        if (owner) {
            text_field_common_1.textProperty.nativeValueChange(owner, "");
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldReturn = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            owner.dismissSoftInput();
            owner.notify({ eventName: TextField.returnPressEvent, object: owner });
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldChangeCharactersInRangeReplacementString = function (textField, range, replacementString) {
        var owner = this._owner.get();
        if (owner) {
            var delta = replacementString.length - range.length;
            if (delta > 0) {
                if (textField.text.length + delta > owner.maxLength) {
                    return false;
                }
            }
            if (owner.updateTextTrigger === "textChanged") {
                if (textField.secureTextEntry && this.firstEdit) {
                    text_field_common_1.textProperty.nativeValueChange(owner, replacementString);
                }
                else {
                    if (range.location <= textField.text.length) {
                        var newText = NSString.stringWithString(textField.text).stringByReplacingCharactersInRangeWithString(range, replacementString);
                        text_field_common_1.textProperty.nativeValueChange(owner, newText);
                    }
                }
            }
            if (owner.formattedText) {
                text_field_common_1._updateCharactersInRangeReplacementString(owner.formattedText, range.location, range.length, replacementString);
            }
        }
        this.firstEdit = false;
        return true;
    };
    UITextFieldDelegateImpl.ObjCProtocols = [UITextFieldDelegate];
    return UITextFieldDelegateImpl;
}(NSObject));
var UITextFieldImpl = (function (_super) {
    __extends(UITextFieldImpl, _super);
    function UITextFieldImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITextFieldImpl.initWithOwner = function (owner) {
        var handler = UITextFieldImpl.new();
        handler._owner = owner;
        return handler;
    };
    UITextFieldImpl.prototype._getTextRectForBounds = function (bounds) {
        var owner = this._owner ? this._owner.get() : null;
        if (!owner) {
            return bounds;
        }
        var size = bounds.size;
        var x = text_field_common_1.layout.toDeviceIndependentPixels(owner.effectiveBorderLeftWidth + owner.effectivePaddingLeft);
        var y = text_field_common_1.layout.toDeviceIndependentPixels(owner.effectiveBorderTopWidth + owner.effectivePaddingTop);
        var width = text_field_common_1.layout.toDeviceIndependentPixels(text_field_common_1.layout.toDevicePixels(size.width) - (owner.effectiveBorderLeftWidth + owner.effectivePaddingLeft + owner.effectivePaddingRight + owner.effectiveBorderRightWidth));
        var height = text_field_common_1.layout.toDeviceIndependentPixels(text_field_common_1.layout.toDevicePixels(size.height) - (owner.effectiveBorderTopWidth + owner.effectivePaddingTop + owner.effectivePaddingBottom + owner.effectiveBorderBottomWidth));
        return CGRectMake(x, y, width, height);
    };
    UITextFieldImpl.prototype.textRectForBounds = function (bounds) {
        return this._getTextRectForBounds(bounds);
    };
    UITextFieldImpl.prototype.editingRectForBounds = function (bounds) {
        return this._getTextRectForBounds(bounds);
    };
    return UITextFieldImpl;
}(UITextField));
var TextField = (function (_super) {
    __extends(TextField, _super);
    function TextField() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextField.prototype.createNativeView = function () {
        return UITextFieldImpl.initWithOwner(new WeakRef(this));
    };
    TextField.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UITextFieldDelegateImpl.initWithOwner(new WeakRef(this));
    };
    TextField.prototype.disposeNativeView = function () {
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TextField.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.delegate = this._delegate;
    };
    TextField.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(TextField.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    TextField.prototype[text_field_common_1.hintProperty.getDefault] = function () {
        return this.nativeTextViewProtected.placeholder;
    };
    TextField.prototype[text_field_common_1.hintProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    TextField.prototype[text_field_common_1.secureProperty.getDefault] = function () {
        return this.nativeTextViewProtected.secureTextEntry;
    };
    TextField.prototype[text_field_common_1.secureProperty.setNative] = function (value) {
        this.nativeTextViewProtected.secureTextEntry = value;
    };
    TextField.prototype[text_field_common_1.colorProperty.getDefault] = function () {
        return {
            textColor: this.nativeTextViewProtected.textColor,
            tintColor: this.nativeTextViewProtected.tintColor
        };
    };
    TextField.prototype[text_field_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof text_field_common_1.Color) {
            var color = value instanceof text_field_common_1.Color ? value.ios : value;
            this.nativeTextViewProtected.textColor = color;
            this.nativeTextViewProtected.tintColor = color;
        }
        else {
            this.nativeTextViewProtected.textColor = value.textColor;
            this.nativeTextViewProtected.tintColor = value.tintColor;
        }
    };
    TextField.prototype[text_field_common_1.placeholderColorProperty.getDefault] = function () {
        return null;
    };
    TextField.prototype[text_field_common_1.placeholderColorProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    TextField.prototype._updateAttributedPlaceholder = function () {
        var stringValue = this.hint;
        if (stringValue === null || stringValue === void 0) {
            stringValue = "";
        }
        else {
            stringValue = stringValue + "";
        }
        if (stringValue === "") {
            stringValue = " ";
        }
        var attributes = {};
        if (this.style.placeholderColor) {
            attributes[NSForegroundColorAttributeName] = this.style.placeholderColor.ios;
        }
        var attributedPlaceholder = NSAttributedString.alloc().initWithStringAttributes(stringValue, attributes);
        this.nativeTextViewProtected.attributedPlaceholder = attributedPlaceholder;
    };
    TextField.prototype[text_field_common_1.paddingTopProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingTopProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingRightProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingRightProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingBottomProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingBottomProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingLeftProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingLeftProperty.setNative] = function (value) {
    };
    __decorate([
        profiling_1.profile
    ], TextField.prototype, "onLoaded", null);
    return TextField;
}(text_field_common_1.TextFieldBase));
exports.TextField = TextField;
//# sourceMappingURL=text-field.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-view/text-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js"));
var UITextViewDelegateImpl = (function (_super) {
    __extends(UITextViewDelegateImpl, _super);
    function UITextViewDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITextViewDelegateImpl.initWithOwner = function (owner) {
        var impl = UITextViewDelegateImpl.new();
        impl._owner = owner;
        return impl;
    };
    UITextViewDelegateImpl.prototype.textViewShouldBeginEditing = function (textView) {
        var owner = this._owner.get();
        if (owner) {
            owner.showText();
        }
        return true;
    };
    UITextViewDelegateImpl.prototype.textViewDidBeginEditing = function (textView) {
        var owner = this._owner.get();
        if (owner) {
            owner._isEditing = true;
            owner.notify({ eventName: TextView.focusEvent, object: owner });
        }
    };
    UITextViewDelegateImpl.prototype.textViewDidEndEditing = function (textView) {
        var owner = this._owner.get();
        if (owner) {
            if (owner.updateTextTrigger === "focusLost") {
                editable_text_base_1.textProperty.nativeValueChange(owner, textView.text);
            }
            owner._isEditing = false;
            owner.dismissSoftInput();
            owner._refreshHintState(owner.hint, textView.text);
        }
    };
    UITextViewDelegateImpl.prototype.textViewDidChange = function (textView) {
        var owner = this._owner.get();
        if (owner) {
            if (owner.updateTextTrigger === "textChanged") {
                editable_text_base_1.textProperty.nativeValueChange(owner, textView.text);
            }
            owner.requestLayout();
        }
    };
    UITextViewDelegateImpl.prototype.textViewShouldChangeTextInRangeReplacementText = function (textView, range, replacementString) {
        var owner = this._owner.get();
        if (owner) {
            var delta = replacementString.length - range.length;
            if (delta > 0) {
                if (textView.text.length + delta > owner.maxLength) {
                    return false;
                }
            }
            if (owner.formattedText) {
                editable_text_base_1._updateCharactersInRangeReplacementString(owner.formattedText, range.location, range.length, replacementString);
            }
        }
        return true;
    };
    UITextViewDelegateImpl.prototype.scrollViewDidScroll = function (sv) {
        var owner = this._owner.get();
        if (owner) {
            var contentOffset = owner.nativeViewProtected.contentOffset;
            owner.notify({
                object: owner,
                eventName: "scroll",
                scrollX: contentOffset.x,
                scrollY: contentOffset.y
            });
        }
    };
    UITextViewDelegateImpl.ObjCProtocols = [UITextViewDelegate];
    return UITextViewDelegateImpl;
}(NSObject));
var NoScrollAnimationUITextView = (function (_super) {
    __extends(NoScrollAnimationUITextView, _super);
    function NoScrollAnimationUITextView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NoScrollAnimationUITextView.prototype.setContentOffsetAnimated = function (contentOffset, animated) {
        _super.prototype.setContentOffsetAnimated.call(this, contentOffset, false);
    };
    return NoScrollAnimationUITextView;
}(UITextView));
var TextView = (function (_super) {
    __extends(TextView, _super);
    function TextView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextView.prototype.createNativeView = function () {
        var textView = NoScrollAnimationUITextView.new();
        if (!textView.font) {
            textView.font = UIFont.systemFontOfSize(12);
        }
        return textView;
    };
    TextView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UITextViewDelegateImpl.initWithOwner(new WeakRef(this));
    };
    TextView.prototype.disposeNativeView = function () {
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TextView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.delegate = this._delegate;
    };
    TextView.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(TextView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    TextView.prototype._refreshHintState = function (hint, text) {
        if (this.formattedText) {
            return;
        }
        if (text !== null && text !== undefined && text !== "") {
            this.showText();
        }
        else if (!this._isEditing && hint !== null && hint !== undefined && hint !== "") {
            this.showHint(hint);
        }
        else {
            this._isShowingHint = false;
            this.nativeTextViewProtected.text = "";
        }
    };
    TextView.prototype._refreshColor = function () {
        if (this._isShowingHint) {
            var placeholderColor = this.style.placeholderColor;
            var color = this.style.color;
            if (placeholderColor) {
                this.nativeTextViewProtected.textColor = placeholderColor.ios;
            }
            else if (color) {
                this.nativeTextViewProtected.textColor = color.ios.colorWithAlphaComponent(0.22);
            }
            else {
                this.nativeTextViewProtected.textColor = UIColor.blackColor.colorWithAlphaComponent(0.22);
            }
        }
        else {
            var color = this.style.color;
            if (color) {
                this.nativeTextViewProtected.textColor = color.ios;
                this.nativeTextViewProtected.tintColor = color.ios;
            }
            else {
                this.nativeTextViewProtected.textColor = null;
                this.nativeTextViewProtected.tintColor = null;
            }
        }
    };
    TextView.prototype.showHint = function (hint) {
        var nativeView = this.nativeTextViewProtected;
        this._isShowingHint = true;
        this._refreshColor();
        var hintAsString = (hint === null || hint === undefined) ? "" : hint.toString();
        nativeView.text = hintAsString;
    };
    TextView.prototype.showText = function () {
        this._isShowingHint = false;
        this._refreshColor();
        this._setNativeText();
        this.requestLayout();
    };
    TextView.prototype[editable_text_base_1.textProperty.getDefault] = function () {
        return "";
    };
    TextView.prototype[editable_text_base_1.textProperty.setNative] = function (value) {
        this._refreshHintState(this.hint, value);
    };
    TextView.prototype[editable_text_base_1.hintProperty.getDefault] = function () {
        return "";
    };
    TextView.prototype[editable_text_base_1.hintProperty.setNative] = function (value) {
        this._refreshHintState(value, this.text);
    };
    TextView.prototype[editable_text_base_1.editableProperty.getDefault] = function () {
        return this.nativeTextViewProtected.editable;
    };
    TextView.prototype[editable_text_base_1.editableProperty.setNative] = function (value) {
        this.nativeTextViewProtected.editable = value;
    };
    TextView.prototype[editable_text_base_1.colorProperty.setNative] = function (color) {
        this._refreshColor();
    };
    TextView.prototype[editable_text_base_1.placeholderColorProperty.setNative] = function (value) {
        this._refreshColor();
    };
    TextView.prototype[editable_text_base_1.borderTopWidthProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.top,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.borderTopWidthProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var top = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeTextViewProtected.textContainerInset = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    TextView.prototype[editable_text_base_1.borderRightWidthProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.right,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.borderRightWidthProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var right = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    TextView.prototype[editable_text_base_1.borderBottomWidthProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.bottom,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.borderBottomWidthProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var bottom = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    TextView.prototype[editable_text_base_1.borderLeftWidthProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.left,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.borderLeftWidthProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var left = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    TextView.prototype[editable_text_base_1.paddingTopProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.top,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.paddingTopProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var top = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeTextViewProtected.textContainerInset = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    TextView.prototype[editable_text_base_1.paddingRightProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.right,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.paddingRightProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var right = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    TextView.prototype[editable_text_base_1.paddingBottomProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.bottom,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.paddingBottomProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var bottom = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    TextView.prototype[editable_text_base_1.paddingLeftProperty.getDefault] = function () {
        return {
            value: this.nativeTextViewProtected.textContainerInset.left,
            unit: "px"
        };
    };
    TextView.prototype[editable_text_base_1.paddingLeftProperty.setNative] = function (value) {
        var inset = this.nativeTextViewProtected.textContainerInset;
        var left = editable_text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeTextViewProtected.textContainerInset = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    __decorate([
        profiling_1.profile
    ], TextView.prototype, "onLoaded", null);
    TextView = __decorate([
        editable_text_base_1.CSSType("TextView")
    ], TextView);
    return TextView;
}(editable_text_base_1.EditableTextBase));
exports.TextView = TextView;
TextView.prototype.recycleNativeView = "auto";
//# sourceMappingURL=text-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var dateComparer = function (x, y) { return (x <= y && x >= y); };
function getValidTime(picker, hour, minute) {
    if (picker.minuteInterval > 1) {
        var minuteFloor = minute - (minute % picker.minuteInterval);
        minute = minuteFloor + (minute === minuteFloor + 1 ? picker.minuteInterval : 0);
        if (minute === 60) {
            hour++;
            minute = 0;
        }
    }
    var time = { hour: hour, minute: minute };
    if (!isLessThanMaxTime(picker, hour, minute)) {
        time = { hour: picker.maxHour, minute: picker.maxMinute };
    }
    if (!isGreaterThanMinTime(picker, hour, minute)) {
        time = { hour: picker.minHour, minute: picker.minMinute };
    }
    return time;
}
exports.getValidTime = getValidTime;
function isValidTime(picker) {
    return isGreaterThanMinTime(picker) && isLessThanMaxTime(picker);
}
function isHourValid(value) {
    return typeof value === "number" && value >= 0 && value <= 23;
}
function isMinuteValid(value) {
    return typeof value === "number" && value >= 0 && value <= 59;
}
function isMinuteIntervalValid(value) {
    return typeof value === "number" && value >= 1 && value <= 30 && 60 % value === 0;
}
function getMinutes(hour) {
    return hour * 60;
}
function isDefined(value) {
    return value !== undefined;
}
exports.isDefined = isDefined;
function isGreaterThanMinTime(picker, hour, minute) {
    if (picker.minHour === undefined || picker.minMinute === undefined) {
        return true;
    }
    return getMinutes(hour !== undefined ? hour : picker.hour) + (minute !== undefined ? minute : picker.minute) >= getMinutes(picker.minHour) + picker.minMinute;
}
function isLessThanMaxTime(picker, hour, minute) {
    if (!isDefined(picker.maxHour) || !isDefined(picker.maxMinute)) {
        return true;
    }
    return getMinutes(isDefined(hour) ? hour : picker.hour) + (isDefined(minute) ? minute : picker.minute) <= getMinutes(picker.maxHour) + picker.maxMinute;
}
function toString(value) {
    if (value instanceof Date) {
        return value + "";
    }
    return value < 10 ? "0" + value : "" + value;
}
function getMinMaxTimeErrorMessage(picker) {
    return "Min time: (" + toString(picker.minHour) + ":" + toString(picker.minMinute) + "), max time: (" + toString(picker.maxHour) + ":" + toString(picker.maxMinute) + ")";
}
function getErrorMessage(picker, propertyName, newValue) {
    return propertyName + " property value (" + toString(newValue) + ":" + toString(picker.minute) + ") is not valid. " + getMinMaxTimeErrorMessage(picker) + ".";
}
var TimePickerBase = (function (_super) {
    __extends(TimePickerBase, _super);
    function TimePickerBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimePickerBase = __decorate([
        view_1.CSSType("TimePicker")
    ], TimePickerBase);
    return TimePickerBase;
}(view_1.View));
exports.TimePickerBase = TimePickerBase;
TimePickerBase.prototype.recycleNativeView = "auto";
exports.minHourProperty = new view_1.Property({
    name: "minHour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minHourProperty.register(TimePickerBase);
exports.maxHourProperty = new view_1.Property({
    name: "maxHour", defaultValue: 23, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxHour", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxHourProperty.register(TimePickerBase);
exports.minMinuteProperty = new view_1.Property({
    name: "minMinute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minMinuteProperty.register(TimePickerBase);
exports.maxMinuteProperty = new view_1.Property({
    name: "maxMinute", defaultValue: 59, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "maxMinute", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.maxMinuteProperty.register(TimePickerBase);
exports.minuteIntervalProperty = new view_1.Property({
    name: "minuteInterval", defaultValue: 1, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteIntervalValid(newValue)) {
            throw new Error(getErrorMessage(picker, "minuteInterval", newValue));
        }
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteIntervalProperty.register(TimePickerBase);
exports.minuteProperty = new view_1.Property({
    name: "minute", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isMinuteValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "minute", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.minuteProperty.register(TimePickerBase);
exports.hourProperty = new view_1.Property({
    name: "hour", defaultValue: 0, valueChanged: function (picker, oldValue, newValue) {
        if (!isHourValid(newValue) || !isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "Hour", newValue));
        }
        picker.time = new Date(0, 0, 0, picker.hour, picker.minute);
    }, valueConverter: function (v) { return parseInt(v); }
});
exports.hourProperty.register(TimePickerBase);
exports.timeProperty = new view_1.Property({
    name: "time", defaultValue: new Date(), equalityComparer: dateComparer,
    valueChanged: function (picker, oldValue, newValue) {
        if (!isValidTime(picker)) {
            throw new Error(getErrorMessage(picker, "time", newValue));
        }
        picker.hour = newValue.getHours();
        picker.minute = newValue.getMinutes();
    }
});
exports.timeProperty.register(TimePickerBase);
//# sourceMappingURL=time-picker-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/time-picker/time-picker.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var time_picker_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/time-picker/time-picker-common.js"));
function getDate(hour, minute) {
    var components = NSDateComponents.alloc().init();
    components.hour = hour;
    components.minute = minute;
    return NSCalendar.currentCalendar.dateFromComponents(components);
}
function getComponents(date) {
    return NSCalendar.currentCalendar.componentsFromDate(32 | 64, date);
}
var TimePicker = (function (_super) {
    __extends(TimePicker, _super);
    function TimePicker() {
        var _this = _super.call(this) || this;
        var components = getComponents(NSDate.date());
        _this.hour = components.hour;
        _this.minute = components.minute;
        return _this;
    }
    TimePicker.prototype.createNativeView = function () {
        var picker = UIDatePicker.new();
        picker.datePickerMode = 0;
        return picker;
    };
    TimePicker.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._changeHandler = UITimePickerChangeHandlerImpl.initWithOwner(new WeakRef(this));
        this.nativeViewProtected.addTargetActionForControlEvents(this._changeHandler, "valueChanged", 4096);
    };
    TimePicker.prototype.disposeNativeView = function () {
        this._changeHandler = null;
        _super.prototype.initNativeView.call(this);
    };
    Object.defineProperty(TimePicker.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    TimePicker.prototype[time_picker_common_1.timeProperty.getDefault] = function () {
        return this.nativeViewProtected.date;
    };
    TimePicker.prototype[time_picker_common_1.timeProperty.setNative] = function (value) {
        this.nativeViewProtected.date = getDate(this.hour, this.minute);
    };
    TimePicker.prototype[time_picker_common_1.minuteProperty.getDefault] = function () {
        return this.nativeViewProtected.date.getMinutes();
    };
    TimePicker.prototype[time_picker_common_1.minuteProperty.setNative] = function (value) {
        this.nativeViewProtected.date = getDate(this.hour, value);
    };
    TimePicker.prototype[time_picker_common_1.hourProperty.getDefault] = function () {
        return this.nativeViewProtected.date.getHours();
    };
    TimePicker.prototype[time_picker_common_1.hourProperty.setNative] = function (value) {
        this.nativeViewProtected.date = getDate(value, this.minute);
    };
    TimePicker.prototype[time_picker_common_1.minHourProperty.getDefault] = function () {
        return this.nativeViewProtected.minimumDate ? this.nativeViewProtected.minimumDate.getHours() : 0;
    };
    TimePicker.prototype[time_picker_common_1.minHourProperty.setNative] = function (value) {
        this.nativeViewProtected.minimumDate = getDate(value, this.minute);
    };
    TimePicker.prototype[time_picker_common_1.maxHourProperty.getDefault] = function () {
        return this.nativeViewProtected.maximumDate ? this.nativeViewProtected.maximumDate.getHours() : 24;
    };
    TimePicker.prototype[time_picker_common_1.maxHourProperty.setNative] = function (value) {
        this.nativeViewProtected.maximumDate = getDate(value, this.minute);
    };
    TimePicker.prototype[time_picker_common_1.minMinuteProperty.getDefault] = function () {
        return this.nativeViewProtected.minimumDate ? this.nativeViewProtected.minimumDate.getMinutes() : 0;
    };
    TimePicker.prototype[time_picker_common_1.minMinuteProperty.setNative] = function (value) {
        this.nativeViewProtected.minimumDate = getDate(this.hour, value);
    };
    TimePicker.prototype[time_picker_common_1.maxMinuteProperty.getDefault] = function () {
        return this.nativeViewProtected.maximumDate ? this.nativeViewProtected.maximumDate.getMinutes() : 60;
    };
    TimePicker.prototype[time_picker_common_1.maxMinuteProperty.setNative] = function (value) {
        this.nativeViewProtected.maximumDate = getDate(this.hour, value);
    };
    TimePicker.prototype[time_picker_common_1.minuteIntervalProperty.getDefault] = function () {
        return this.nativeViewProtected.minuteInterval;
    };
    TimePicker.prototype[time_picker_common_1.minuteIntervalProperty.setNative] = function (value) {
        this.nativeViewProtected.minuteInterval = value;
    };
    TimePicker.prototype[time_picker_common_1.colorProperty.getDefault] = function () {
        return this.nativeViewProtected.valueForKey("textColor");
    };
    TimePicker.prototype[time_picker_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof time_picker_common_1.Color ? value.ios : value;
        this.nativeViewProtected.setValueForKey(color, "textColor");
    };
    return TimePicker;
}(time_picker_common_1.TimePickerBase));
exports.TimePicker = TimePicker;
var UITimePickerChangeHandlerImpl = (function (_super) {
    __extends(UITimePickerChangeHandlerImpl, _super);
    function UITimePickerChangeHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITimePickerChangeHandlerImpl.initWithOwner = function (owner) {
        var handler = UITimePickerChangeHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    UITimePickerChangeHandlerImpl.prototype.valueChanged = function (sender) {
        var owner = this._owner.get();
        if (!owner) {
            return;
        }
        var components = getComponents(sender.date);
        var timeChanged = false;
        if (components.hour !== owner.hour) {
            time_picker_common_1.hourProperty.nativeValueChange(owner, components.hour);
            timeChanged = true;
        }
        if (components.minute !== owner.minute) {
            time_picker_common_1.minuteProperty.nativeValueChange(owner, components.minute);
            timeChanged = true;
        }
        if (timeChanged) {
            time_picker_common_1.timeProperty.nativeValueChange(owner, new Date(0, 0, 0, components.hour, components.minute));
        }
    };
    UITimePickerChangeHandlerImpl.ObjCExposedMethods = {
        "valueChanged": { returns: interop.types.void, params: [UIDatePicker] }
    };
    return UITimePickerChangeHandlerImpl;
}(NSObject));
//# sourceMappingURL=time-picker.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/fade-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FadeTransition = (function (_super) {
    __extends(FadeTransition, _super);
    function FadeTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    FadeTransition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        var originalToViewAlpha = toView.alpha;
        var originalFromViewAlpha = fromView.alpha;
        toView.alpha = 0.0;
        fromView.alpha = 1.0;
        switch (operation) {
            case 1:
                containerView.insertSubviewAboveSubview(toView, fromView);
                break;
            case 2:
                containerView.insertSubviewBelowSubview(toView, fromView);
                break;
        }
        var duration = this.getDuration();
        var curve = this.getCurve();
        UIView.animateWithDurationAnimationsCompletion(duration, function () {
            UIView.setAnimationCurve(curve);
            toView.alpha = 1.0;
            fromView.alpha = 0.0;
        }, function (finished) {
            toView.alpha = originalToViewAlpha;
            fromView.alpha = originalFromViewAlpha;
            completion(finished);
        });
    };
    return FadeTransition;
}(transition_1.Transition));
exports.FadeTransition = FadeTransition;
//# sourceMappingURL=fade-transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/slide-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var screenWidth = platform_1.screen.mainScreen.widthDIPs;
var screenHeight = platform_1.screen.mainScreen.heightDIPs;
var leftEdge = CGAffineTransformMakeTranslation(-screenWidth, 0);
var rightEdge = CGAffineTransformMakeTranslation(screenWidth, 0);
var topEdge = CGAffineTransformMakeTranslation(0, -screenHeight);
var bottomEdge = CGAffineTransformMakeTranslation(0, screenHeight);
var SlideTransition = (function (_super) {
    __extends(SlideTransition, _super);
    function SlideTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    SlideTransition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        var originalToViewTransform = toView.transform;
        var originalFromViewTransform = fromView.transform;
        var fromViewEndTransform;
        var toViewBeginTransform;
        var push = (operation === 1);
        switch (this._direction) {
            case "left":
                toViewBeginTransform = push ? rightEdge : leftEdge;
                fromViewEndTransform = push ? leftEdge : rightEdge;
                break;
            case "right":
                toViewBeginTransform = push ? leftEdge : rightEdge;
                fromViewEndTransform = push ? rightEdge : leftEdge;
                break;
            case "top":
                toViewBeginTransform = push ? bottomEdge : topEdge;
                fromViewEndTransform = push ? topEdge : bottomEdge;
                break;
            case "bottom":
                toViewBeginTransform = push ? topEdge : bottomEdge;
                fromViewEndTransform = push ? bottomEdge : topEdge;
                break;
        }
        toView.transform = toViewBeginTransform;
        fromView.transform = CGAffineTransformIdentity;
        switch (operation) {
            case 1:
                containerView.insertSubviewAboveSubview(toView, fromView);
                break;
            case 2:
                containerView.insertSubviewBelowSubview(toView, fromView);
                break;
        }
        var duration = this.getDuration();
        var curve = this.getCurve();
        UIView.animateWithDurationAnimationsCompletion(duration, function () {
            UIView.setAnimationCurve(curve);
            toView.transform = CGAffineTransformIdentity;
            fromView.transform = fromViewEndTransform;
        }, function (finished) {
            toView.transform = originalToViewTransform;
            fromView.transform = originalFromViewTransform;
            completion(finished);
        });
    };
    return SlideTransition;
}(transition_1.Transition));
exports.SlideTransition = SlideTransition;
//# sourceMappingURL=slide-transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/transition.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var transitionId = 0;
var Transition = (function () {
    function Transition(duration, curve) {
        if (curve === void 0) { curve = 0; }
        this._duration = duration ? (duration / 1000) : 0.35;
        this._curve = curve;
        this._id = transitionId++;
    }
    Transition.prototype.getDuration = function () {
        return this._duration;
    };
    Transition.prototype.getCurve = function () {
        return this._curve;
    };
    Transition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.createAndroidAnimator = function (transitionType) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.toString = function () {
        return "Transition@" + this._id;
    };
    return Transition;
}());
exports.Transition = Transition;
//# sourceMappingURL=transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
exports.File = file_system_1.File;
exports.knownFolders = file_system_1.knownFolders;
exports.path = file_system_1.path;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
exports.srcProperty = new view_1.Property({ name: "src" });
var WebViewBase = (function (_super) {
    __extends(WebViewBase, _super);
    function WebViewBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebViewBase_1 = WebViewBase;
    WebViewBase.prototype._onLoadFinished = function (url, error) {
        var args = {
            eventName: WebViewBase_1.loadFinishedEvent,
            object: this,
            url: url,
            navigationType: undefined,
            error: error
        };
        this.notify(args);
    };
    WebViewBase.prototype._onLoadStarted = function (url, navigationType) {
        var args = {
            eventName: WebViewBase_1.loadStartedEvent,
            object: this,
            url: url,
            navigationType: navigationType,
            error: undefined
        };
        this.notify(args);
    };
    Object.defineProperty(WebViewBase.prototype, "canGoBack", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebViewBase.prototype, "canGoForward", {
        get: function () {
            throw new Error("This member is abstract.");
        },
        enumerable: true,
        configurable: true
    });
    WebViewBase.prototype[exports.srcProperty.getDefault] = function () {
        return "";
    };
    WebViewBase.prototype[exports.srcProperty.setNative] = function (src) {
        this.stopLoading();
        if (src.indexOf("~/") === 0) {
            src = "file:///" + file_system_1.knownFolders.currentApp().path + "/" + src.substr(2);
        }
        else if (src.indexOf("/") === 0) {
            src = "file://" + src;
        }
        if (src.toLowerCase().indexOf("file:///") === 0) {
            src = encodeURI(src);
        }
        if (src.toLowerCase().indexOf("http://") === 0 ||
            src.toLowerCase().indexOf("https://") === 0 ||
            src.toLowerCase().indexOf("file:///") === 0) {
            this._loadUrl(src);
        }
        else {
            this._loadData(src);
        }
    };
    var WebViewBase_1;
    WebViewBase.loadStartedEvent = "loadStarted";
    WebViewBase.loadFinishedEvent = "loadFinished";
    WebViewBase = WebViewBase_1 = __decorate([
        view_1.CSSType("WebView")
    ], WebViewBase);
    return WebViewBase;
}(view_1.ContainerView));
exports.WebViewBase = WebViewBase;
exports.srcProperty.register(WebViewBase);
//# sourceMappingURL=web-view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/web-view/web-view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var web_view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/web-view/web-view-common.js"));
var WKNavigationDelegateImpl = (function (_super) {
    __extends(WKNavigationDelegateImpl, _super);
    function WKNavigationDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WKNavigationDelegateImpl.initWithOwner = function (owner) {
        var handler = WKNavigationDelegateImpl.new();
        handler._owner = owner;
        return handler;
    };
    WKNavigationDelegateImpl.prototype.webViewDecidePolicyForNavigationActionDecisionHandler = function (webView, navigationAction, decisionHandler) {
        var owner = this._owner.get();
        if (owner && navigationAction.request.URL) {
            var navType = "other";
            switch (navigationAction.navigationType) {
                case 0:
                    navType = "linkClicked";
                    break;
                case 1:
                    navType = "formSubmitted";
                    break;
                case 2:
                    navType = "backForward";
                    break;
                case 3:
                    navType = "reload";
                    break;
                case 4:
                    navType = "formResubmitted";
                    break;
            }
            decisionHandler(1);
            if (web_view_common_1.traceEnabled()) {
                web_view_common_1.traceWrite("WKNavigationDelegateClass.webViewDecidePolicyForNavigationActionDecisionHandler(" + navigationAction.request.URL.absoluteString + ", " + navigationAction.navigationType + ")", web_view_common_1.traceCategories.Debug);
            }
            owner._onLoadStarted(navigationAction.request.URL.absoluteString, navType);
        }
    };
    WKNavigationDelegateImpl.prototype.webViewDidStartProvisionalNavigation = function (webView, navigation) {
        if (web_view_common_1.traceEnabled()) {
            web_view_common_1.traceWrite("WKNavigationDelegateClass.webViewDidStartProvisionalNavigation(" + webView.URL + ")", web_view_common_1.traceCategories.Debug);
        }
    };
    WKNavigationDelegateImpl.prototype.webViewDidFinishNavigation = function (webView, navigation) {
        if (web_view_common_1.traceEnabled()) {
            web_view_common_1.traceWrite("WKNavigationDelegateClass.webViewDidFinishNavigation(" + webView.URL + ")", web_view_common_1.traceCategories.Debug);
        }
        var owner = this._owner.get();
        if (owner) {
            var src = owner.src;
            if (webView.URL) {
                src = webView.URL.absoluteString;
            }
            owner._onLoadFinished(src);
        }
    };
    WKNavigationDelegateImpl.prototype.webViewDidFailNavigationWithError = function (webView, navigation, error) {
        var owner = this._owner.get();
        if (owner) {
            var src = owner.src;
            if (webView.URL) {
                src = webView.URL.absoluteString;
            }
            if (web_view_common_1.traceEnabled()) {
                web_view_common_1.traceWrite("WKNavigationDelegateClass.webViewDidFailNavigationWithError(" + error.localizedDescription + ")", web_view_common_1.traceCategories.Debug);
            }
            owner._onLoadFinished(src, error.localizedDescription);
        }
    };
    WKNavigationDelegateImpl.prototype.webViewDidFailProvisionalNavigationWithError = function (webView, navigation, error) {
        var owner = this._owner.get();
        if (owner) {
            var src = owner.src;
            if (webView.URL) {
                src = webView.URL.absoluteString;
            }
            if (web_view_common_1.traceEnabled()) {
                web_view_common_1.traceWrite("WKNavigationDelegateClass.webViewDidFailProvisionalNavigationWithError(" + error.localizedDescription + ")", web_view_common_1.traceCategories.Debug);
            }
            owner._onLoadFinished(src, error.localizedDescription);
        }
    };
    WKNavigationDelegateImpl.ObjCProtocols = [WKNavigationDelegate];
    return WKNavigationDelegateImpl;
}(NSObject));
var WebView = (function (_super) {
    __extends(WebView, _super);
    function WebView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WebView.prototype.createNativeView = function () {
        var jScript = "var meta = document.createElement('meta'); meta.setAttribute('name', 'viewport'); meta.setAttribute('content', 'initial-scale=1.0'); document.getElementsByTagName('head')[0].appendChild(meta);";
        var wkUScript = WKUserScript.alloc().initWithSourceInjectionTimeForMainFrameOnly(jScript, 1, true);
        var wkUController = WKUserContentController.new();
        wkUController.addUserScript(wkUScript);
        var configuration = WKWebViewConfiguration.new();
        configuration.userContentController = wkUController;
        configuration.preferences.setValueForKey(true, "allowFileAccessFromFileURLs");
        return new WKWebView({
            frame: CGRectZero,
            configuration: configuration
        });
    };
    WebView.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = WKNavigationDelegateImpl.initWithOwner(new WeakRef(this));
    };
    WebView.prototype.disposeNativeView = function () {
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    WebView.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.navigationDelegate = this._delegate;
    };
    WebView.prototype.onUnloaded = function () {
        this.ios.navigationDelegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(WebView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.stopLoading = function () {
        this.ios.stopLoading();
    };
    WebView.prototype._loadUrl = function (src) {
        if (src.startsWith("file:///")) {
            var cachePath = src.substring(0, src.lastIndexOf("/"));
            this.ios.loadFileURLAllowingReadAccessToURL(NSURL.URLWithString(src), NSURL.URLWithString(cachePath));
        }
        else {
            this.ios.loadRequest(NSURLRequest.requestWithURL(NSURL.URLWithString(src)));
        }
    };
    WebView.prototype._loadData = function (content) {
        this.ios.loadHTMLStringBaseURL(content, NSURL.alloc().initWithString("file:///" + web_view_common_1.knownFolders.currentApp().path + "/"));
    };
    Object.defineProperty(WebView.prototype, "canGoBack", {
        get: function () {
            return this.ios.canGoBack;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(WebView.prototype, "canGoForward", {
        get: function () {
            return this.ios.canGoForward;
        },
        enumerable: true,
        configurable: true
    });
    WebView.prototype.goBack = function () {
        this.ios.goBack();
    };
    WebView.prototype.goForward = function () {
        this.ios.goForward();
    };
    WebView.prototype.reload = function () {
        this.ios.reload();
    };
    __decorate([
        profiling_1.profile
    ], WebView.prototype, "onLoaded", null);
    return WebView;
}(web_view_common_1.WebViewBase));
exports.WebView = WebView;
//# sourceMappingURL=web-view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/debug.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.debug = true;
var applicationRootPath;
function ensureAppRootPath() {
    if (!applicationRootPath) {
        applicationRootPath = file_system_1.knownFolders.currentApp().path;
        applicationRootPath = applicationRootPath.substr(0, applicationRootPath.length - "app/".length);
    }
}
var Source = (function () {
    function Source(uri, line, column) {
        ensureAppRootPath();
        if (uri.length > applicationRootPath.length && uri.substr(0, applicationRootPath.length) === applicationRootPath) {
            this._uri = "file://" + uri.substr(applicationRootPath.length);
        }
        else {
            this._uri = uri;
        }
        this._line = line;
        this._column = column;
    }
    Object.defineProperty(Source.prototype, "uri", {
        get: function () { return this._uri; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "line", {
        get: function () { return this._line; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "column", {
        get: function () { return this._column; },
        enumerable: true,
        configurable: true
    });
    Source.prototype.toString = function () {
        return this._uri + ":" + this._line + ":" + this._column;
    };
    Source.get = function (object) {
        return object[Source._source];
    };
    Source.set = function (object, src) {
        object[Source._source] = src;
    };
    Source._source = Symbol("source");
    return Source;
}());
exports.Source = Source;
var ScopeError = (function (_super) {
    __extends(ScopeError, _super);
    function ScopeError(inner, message) {
        var _this = this;
        var formattedMessage;
        if (message && inner.message) {
            formattedMessage = message + "\n > " + inner.message.replace("\n", "\n  ");
        }
        else {
            formattedMessage = message || inner.message || undefined;
        }
        _this = _super.call(this, formattedMessage) || this;
        _this.stack = platform_1.isAndroid ? "Error: " + _this.message + "\n" + inner.stack.substr(inner.stack.indexOf("\n") + 1) : inner.stack;
        _this.message = formattedMessage;
        return _this;
    }
    return ScopeError;
}(Error));
exports.ScopeError = ScopeError;
var SourceError = (function (_super) {
    __extends(SourceError, _super);
    function SourceError(child, source, message) {
        return _super.call(this, child, message ? message + " @" + source + "" : source + "") || this;
    }
    return SourceError;
}(ScopeError));
exports.SourceError = SourceError;
//# sourceMappingURL=debug.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/mainthread-helper.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function dispatchToMainThread(func) {
    NSOperationQueue.mainQueue.addOperationWithBlock(func);
}
exports.dispatchToMainThread = dispatchToMainThread;
function isMainThread() {
    return NSThread.isMainThread;
}
exports.isMainThread = isMainThread;
//# sourceMappingURL=mainthread-helper.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/number-utils.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var epsilon = 1E-05;
function areClose(value1, value2) {
    return (Math.abs(value1 - value2) < epsilon);
}
exports.areClose = areClose;
function greaterThanOrClose(value1, value2) {
    return (value1 > value2) || areClose(value1, value2);
}
exports.greaterThanOrClose = greaterThanOrClose;
function greaterThan(value1, value2) {
    return (value1 > value2) && !areClose(value1, value2);
}
exports.greaterThan = greaterThan;
function lessThan(value1, value2) {
    return (value1 < value2) && !areClose(value1, value2);
}
exports.lessThan = lessThan;
function isZero(value) {
    return (Math.abs(value) < epsilon);
}
exports.isZero = isZero;
function greaterThanZero(value) {
    return value > 0;
}
exports.greaterThanZero = greaterThanZero;
function notNegative(value) {
    return value >= 0;
}
exports.notNegative = notNegative;
exports.radiansToDegrees = function (a) { return a * (180 / Math.PI); };
exports.degreesToRadians = function (a) { return a * (Math.PI / 180); };
//# sourceMappingURL=number-utils.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/types.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function isString(value) {
    return typeof value === "string" || value instanceof String;
}
exports.isString = isString;
function isNumber(value) {
    return typeof value === "number" || value instanceof Number;
}
exports.isNumber = isNumber;
function isBoolean(value) {
    return typeof value === "boolean" || value instanceof Boolean;
}
exports.isBoolean = isBoolean;
function isFunction(value) {
    if (!value) {
        return false;
    }
    return typeof value === "function";
}
exports.isFunction = isFunction;
function isObject(value) {
    if (!value) {
        return false;
    }
    return typeof value === "object";
}
exports.isObject = isObject;
function isUndefined(value) {
    return value === undefined;
}
exports.isUndefined = isUndefined;
function isDefined(value) {
    return typeof value !== "undefined";
}
exports.isDefined = isDefined;
function isNullOrUndefined(value) {
    return value === undefined || value === null;
}
exports.isNullOrUndefined = isNullOrUndefined;
function verifyCallback(value) {
    if (value && !isFunction(value)) {
        throw new TypeError("Callback must be a valid function.");
    }
}
exports.verifyCallback = verifyCallback;
var classInfosMap = new Map();
var funcNameRegex = /function ([_a-zA-Z0-9]{1,})\(/;
function getClass(object) {
    return getClassInfo(object).name;
}
exports.getClass = getClass;
function getClassInfo(object) {
    var constructor = object.constructor;
    var result = classInfosMap.get(constructor);
    if (!result) {
        result = new ClassInfo(constructor);
        classInfosMap.set(constructor, result);
    }
    return result;
}
exports.getClassInfo = getClassInfo;
function getBaseClasses(object) {
    var result = [];
    var info = getClassInfo(object);
    while (info) {
        result.push(info.name);
        info = info.baseClassInfo;
    }
    return result;
}
exports.getBaseClasses = getBaseClasses;
var ClassInfo = (function () {
    function ClassInfo(typeCosntructor) {
        this._typeCosntructor = typeCosntructor;
    }
    Object.defineProperty(ClassInfo.prototype, "name", {
        get: function () {
            if (!this._name) {
                var results = (funcNameRegex).exec(this._typeCosntructor.toString());
                this._name = (results && results.length > 1) ? results[1] : "";
            }
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClassInfo.prototype, "baseClassInfo", {
        get: function () {
            if (isUndefined(this._baseClassInfo)) {
                this._baseClassInfo = ClassInfo._getBase(this);
                if (this._baseClassInfo && this._baseClassInfo.name === this.name) {
                    this._baseClassInfo = ClassInfo._getBase(this._baseClassInfo);
                }
            }
            return this._baseClassInfo;
        },
        enumerable: true,
        configurable: true
    });
    ClassInfo._getBase = function (info) {
        var result = null;
        var constructorProto = info._typeCosntructor.prototype;
        if (constructorProto.__proto__) {
            result = getClassInfo(constructorProto.__proto__);
        }
        return result;
    };
    return ClassInfo;
}());
exports.ClassInfo = ClassInfo;
function toUIString(obj) {
    return isNullOrUndefined(obj) ? "" : obj + "";
}
exports.toUIString = toUIString;
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var mainthread_helper_1 = __webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js"));
exports.RESOURCE_PREFIX = "res://";
exports.FILE_PREFIX = "file:///";
function escapeRegexSymbols(source) {
    var escapeRegex = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;
    return source.replace(escapeRegex, "\\$&");
}
exports.escapeRegexSymbols = escapeRegexSymbols;
function convertString(value) {
    var result;
    if (!types.isString(value) || value.trim() === "") {
        result = value;
    }
    else {
        var valueAsNumber = +value;
        if (!isNaN(valueAsNumber)) {
            result = valueAsNumber;
        }
        else if (value && (value.toLowerCase() === "true" || value.toLowerCase() === "false")) {
            result = value.toLowerCase() === "true" ? true : false;
        }
        else {
            result = value;
        }
    }
    return result;
}
exports.convertString = convertString;
function getModuleName(path) {
    var moduleName = path.replace("./", "");
    return module_name_sanitizer_1.sanitizeModuleName(moduleName);
}
exports.getModuleName = getModuleName;
var layoutCommon;
(function (layoutCommon) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    layoutCommon.UNSPECIFIED = 0 << MODE_SHIFT;
    layoutCommon.EXACTLY = 1 << MODE_SHIFT;
    layoutCommon.AT_MOST = 2 << MODE_SHIFT;
    layoutCommon.MEASURED_HEIGHT_STATE_SHIFT = 0x00000010;
    layoutCommon.MEASURED_STATE_TOO_SMALL = 0x01000000;
    layoutCommon.MEASURED_STATE_MASK = 0xff000000;
    layoutCommon.MEASURED_SIZE_MASK = 0x00ffffff;
    function getMode(mode) {
        switch (mode) {
            case layoutCommon.EXACTLY:
                return "Exact";
            case layoutCommon.AT_MOST:
                return "AtMost";
            default:
                return "Unspecified";
        }
    }
    layoutCommon.getMode = getMode;
    function getMeasureSpecMode(spec) {
        return (spec & MODE_MASK);
    }
    layoutCommon.getMeasureSpecMode = getMeasureSpecMode;
    function getMeasureSpecSize(spec) {
        return (spec & ~MODE_MASK);
    }
    layoutCommon.getMeasureSpecSize = getMeasureSpecSize;
    function measureSpecToString(measureSpec) {
        var mode = getMeasureSpecMode(measureSpec);
        var size = getMeasureSpecSize(measureSpec);
        var text = "MeasureSpec: ";
        if (mode === layoutCommon.UNSPECIFIED) {
            text += "UNSPECIFIED ";
        }
        else if (mode === layoutCommon.EXACTLY) {
            text += "EXACTLY ";
        }
        else if (mode === layoutCommon.AT_MOST) {
            text += "AT_MOST ";
        }
        text += size;
        return text;
    }
    layoutCommon.measureSpecToString = measureSpecToString;
    function round(value) {
        var res = Math.floor(value + 0.5);
        if (res !== 0) {
            return res;
        }
        else if (value === 0) {
            return 0;
        }
        else if (value > 0) {
            return 1;
        }
        return -1;
    }
    layoutCommon.round = round;
})(layoutCommon = exports.layoutCommon || (exports.layoutCommon = {}));
function isFileOrResourcePath(path) {
    if (!types.isString(path)) {
        return false;
    }
    return path.indexOf("~/") === 0 ||
        path.indexOf("/") === 0 ||
        path.indexOf(exports.RESOURCE_PREFIX) === 0;
}
exports.isFileOrResourcePath = isFileOrResourcePath;
function isFontIconURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split("//")[0];
    return firstSegment && firstSegment.indexOf("font:") === 0;
}
exports.isFontIconURI = isFontIconURI;
function isDataURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split(",")[0];
    return firstSegment && firstSegment.indexOf("data:") === 0 && firstSegment.indexOf("base64") >= 0;
}
exports.isDataURI = isDataURI;
function mergeSort(arr, compareFunc) {
    if (arr.length < 2) {
        return arr;
    }
    var middle = arr.length / 2;
    var left = arr.slice(0, middle);
    var right = arr.slice(middle, arr.length);
    return merge(mergeSort(left, compareFunc), mergeSort(right, compareFunc), compareFunc);
}
exports.mergeSort = mergeSort;
function merge(left, right, compareFunc) {
    var result = [];
    while (left.length && right.length) {
        if (compareFunc(left[0], right[0]) <= 0) {
            result.push(left.shift());
        }
        else {
            result.push(right.shift());
        }
    }
    while (left.length) {
        result.push(left.shift());
    }
    while (right.length) {
        result.push(right.shift());
    }
    return result;
}
exports.merge = merge;
function hasDuplicates(arr) {
    return arr.length !== eliminateDuplicates(arr).length;
}
exports.hasDuplicates = hasDuplicates;
function eliminateDuplicates(arr) {
    return Array.from(new Set(arr));
}
exports.eliminateDuplicates = eliminateDuplicates;
function executeOnMainThread(func) {
    if (mainthread_helper_1.isMainThread()) {
        return func();
    }
    else {
        mainthread_helper_1.dispatchToMainThread(func);
    }
}
exports.executeOnMainThread = executeOnMainThread;
function mainThreadify(func) {
    return function () {
        var _this = this;
        var argsToPass = arguments;
        executeOnMainThread(function () { return func.apply(_this, argsToPass); });
    };
}
exports.mainThreadify = mainThreadify;
//# sourceMappingURL=utils-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js"));
var mainScreenScale;
function isOrientationLandscape(orientation) {
    return orientation === 3 || orientation === 4;
}
var layout;
(function (layout) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    function makeMeasureSpec(size, mode) {
        return (Math.round(Math.max(0, size)) & ~MODE_MASK) | (mode & MODE_MASK);
    }
    layout.makeMeasureSpec = makeMeasureSpec;
    function getDisplayDensity() {
        return mainScreenScale;
    }
    layout.getDisplayDensity = getDisplayDensity;
    function toDevicePixels(value) {
        return value * mainScreenScale;
    }
    layout.toDevicePixels = toDevicePixels;
    function toDeviceIndependentPixels(value) {
        return value / mainScreenScale;
    }
    layout.toDeviceIndependentPixels = toDeviceIndependentPixels;
    function measureNativeView(nativeView, width, widthMode, height, heightMode) {
        var view = nativeView;
        var nativeSize = view.sizeThatFits({
            width: widthMode === 0 ? Number.POSITIVE_INFINITY : toDeviceIndependentPixels(width),
            height: heightMode === 0 ? Number.POSITIVE_INFINITY : toDeviceIndependentPixels(height)
        });
        nativeSize.width = utils_common_1.layoutCommon.round(toDevicePixels(nativeSize.width));
        nativeSize.height = utils_common_1.layoutCommon.round(toDevicePixels(nativeSize.height));
        return nativeSize;
    }
    layout.measureNativeView = measureNativeView;
})(layout = exports.layout || (exports.layout = {}));
Object.assign(layout, utils_common_1.layoutCommon);
var ios;
(function (ios) {
    function getter(_this, property) {
        console.log("utils.ios.getter() is deprecated; use the respective native property instead");
        if (typeof property === "function") {
            return property.call(_this);
        }
        else {
            return property;
        }
    }
    ios.getter = getter;
    var collections;
    (function (collections) {
        function jsArrayToNSArray(str) {
            return NSArray.arrayWithArray(str);
        }
        collections.jsArrayToNSArray = jsArrayToNSArray;
        function nsArrayToJSArray(a) {
            var arr = [];
            if (a !== undefined) {
                var count = a.count;
                for (var i = 0; i < count; i++) {
                    arr.push(a.objectAtIndex(i));
                }
            }
            return arr;
        }
        collections.nsArrayToJSArray = nsArrayToJSArray;
    })(collections = ios.collections || (ios.collections = {}));
    function isLandscape() {
        var device = UIDevice.currentDevice;
        var statusBarOrientation = UIApplication.sharedApplication.statusBarOrientation;
        var isStatusBarOrientationLandscape = isOrientationLandscape(statusBarOrientation);
        return isOrientationLandscape(device.orientation) || isStatusBarOrientationLandscape;
    }
    ios.isLandscape = isLandscape;
    ios.MajorVersion = NSString.stringWithString(UIDevice.currentDevice.systemVersion).intValue;
    function openFile(filePath) {
        try {
            var appPath = getCurrentAppPath();
            var path = filePath.replace("~", appPath);
            var controller = UIDocumentInteractionController.interactionControllerWithURL(NSURL.fileURLWithPath(path));
            controller.delegate = new UIDocumentInteractionControllerDelegateImpl();
            return controller.presentPreviewAnimated(true);
        }
        catch (e) {
            trace_1.write("Error in openFile", trace_1.categories.Error, trace_1.messageType.error);
        }
        return false;
    }
    ios.openFile = openFile;
    function getCurrentAppPath() {
        var currentDir = __dirname;
        var tnsModulesIndex = currentDir.indexOf("/tns_modules");
        var appPath = currentDir;
        if (tnsModulesIndex !== -1) {
            appPath = currentDir.substring(0, tnsModulesIndex);
        }
        return appPath;
    }
    ios.getCurrentAppPath = getCurrentAppPath;
    function joinPaths() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        if (!paths || paths.length === 0) {
            return "";
        }
        return NSString.stringWithString(NSString.pathWithComponents(paths)).stringByStandardizingPath;
    }
    ios.joinPaths = joinPaths;
    function getVisibleViewController(rootViewController) {
        if (rootViewController.presentedViewController) {
            return getVisibleViewController(rootViewController.presentedViewController);
        }
        if (rootViewController.isKindOfClass(UINavigationController.class())) {
            return getVisibleViewController(rootViewController.visibleViewController);
        }
        if (rootViewController.isKindOfClass(UITabBarController.class())) {
            return getVisibleViewController(rootViewController);
        }
        return rootViewController;
    }
    ios.getVisibleViewController = getVisibleViewController;
})(ios = exports.ios || (exports.ios = {}));
function GC() {
    __collect();
}
exports.GC = GC;
function releaseNativeObject(object) {
    __releaseNativeCounterpart(object);
}
exports.releaseNativeObject = releaseNativeObject;
function openUrl(location) {
    try {
        var url = NSURL.URLWithString(location.trim());
        if (UIApplication.sharedApplication.canOpenURL(url)) {
            return UIApplication.sharedApplication.openURL(url);
        }
    }
    catch (e) {
        trace_1.write("Error in OpenURL", trace_1.categories.Error, trace_1.messageType.error);
    }
    return false;
}
exports.openUrl = openUrl;
var UIDocumentInteractionControllerDelegateImpl = (function (_super) {
    __extends(UIDocumentInteractionControllerDelegateImpl, _super);
    function UIDocumentInteractionControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIDocumentInteractionControllerDelegateImpl.prototype.getViewController = function () {
        var app = UIApplication.sharedApplication;
        return app.keyWindow.rootViewController;
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerViewControllerForPreview = function (controller) {
        return this.getViewController();
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerViewForPreview = function (controller) {
        return this.getViewController().view;
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerRectForPreview = function (controller) {
        return this.getViewController().view.frame;
    };
    UIDocumentInteractionControllerDelegateImpl.ObjCProtocols = [UIDocumentInteractionControllerDelegate];
    return UIDocumentInteractionControllerDelegateImpl;
}(NSObject));
mainScreenScale = UIScreen.mainScreen.scale;
//# sourceMappingURL=utils.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xhr/xhr.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var XMLHttpRequestResponseType;
(function (XMLHttpRequestResponseType) {
    XMLHttpRequestResponseType.empty = "";
    XMLHttpRequestResponseType.text = "text";
    XMLHttpRequestResponseType.json = "json";
})(XMLHttpRequestResponseType || (XMLHttpRequestResponseType = {}));
var XMLHttpRequest = (function () {
    function XMLHttpRequest() {
        this.UNSENT = 0;
        this.OPENED = 1;
        this.HEADERS_RECEIVED = 2;
        this.LOADING = 3;
        this.DONE = 4;
        this._responseType = "";
        this.textTypes = [
            "text/plain",
            "application/xml",
            "application/rss+xml",
            "text/html",
            "text/xml"
        ];
        this._listeners = new Map();
        this._readyState = this.UNSENT;
    }
    XMLHttpRequest.prototype.open = function (method, url, async, user, password) {
        if (types.isString(method) && types.isString(url)) {
            this._options = { url: url, method: method };
            this._options.headers = {};
            if (types.isString(user)) {
                this._options.headers["user"] = user;
            }
            if (types.isString(password)) {
                this._options.headers["password"] = password;
            }
            this._setReadyState(this.OPENED);
        }
    };
    XMLHttpRequest.prototype.abort = function () {
        this._errorFlag = true;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._readyState === this.DONE) {
            this._readyState = this.UNSENT;
        }
        else {
            this._setReadyState(this.DONE);
        }
    };
    XMLHttpRequest.prototype.send = function (data) {
        var _this = this;
        this._errorFlag = false;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (types.isDefined(this._options)) {
            if (types.isString(data) && this._options.method !== "GET") {
                this._options.content = data;
            }
            else if (data instanceof FormData) {
                this._options.content = data.toString();
            }
            http.request(this._options).then(function (r) {
                if (!_this._errorFlag) {
                    _this._loadResponse(r);
                }
            }).catch(function (e) {
                _this._errorFlag = true;
                _this._setReadyState(_this.DONE, e);
            });
        }
    };
    XMLHttpRequest.prototype._loadResponse = function (r) {
        this._status = r.statusCode;
        this._response = r.content.raw + "";
        this._headers = r.headers;
        this._setReadyState(this.HEADERS_RECEIVED);
        this._setReadyState(this.LOADING);
        this._setResponseType();
        this._responseTextReader = function () { return r.content.toString(); };
        this._addToStringOnResponse();
        if (this.responseType === XMLHttpRequestResponseType.json) {
            this._response = JSON.parse(this.responseText);
        }
        else if (this.responseType === XMLHttpRequestResponseType.text) {
            this._response = this.responseText;
        }
        this._setReadyState(this.DONE);
    };
    XMLHttpRequest.prototype._addToStringOnResponse = function () {
        var _this = this;
        if (types.isObject(this.response)) {
            Object.defineProperty(this._response, "toString", {
                configurable: true,
                enumerable: false,
                writable: true,
                value: function () { return _this.responseText; }
            });
        }
    };
    XMLHttpRequest.prototype.isTextContentType = function (contentType) {
        var result = false;
        for (var i = 0; i < this.textTypes.length; i++) {
            if (contentType.toLowerCase().indexOf(this.textTypes[i]) >= 0) {
                result = true;
                break;
            }
        }
        return result;
    };
    XMLHttpRequest.prototype._setResponseType = function () {
        var header = this.getResponseHeader("Content-Type");
        var contentType = header && header.toLowerCase();
        if (contentType) {
            if (contentType.indexOf("application/json") >= 0 || contentType.indexOf("+json") >= 0) {
                this.responseType = XMLHttpRequestResponseType.json;
            }
            else if (this.isTextContentType(contentType)) {
                this.responseType = XMLHttpRequestResponseType.text;
            }
        }
        else {
            this.responseType = XMLHttpRequestResponseType.text;
        }
    };
    XMLHttpRequest.prototype.addEventListener = function (eventName, handler) {
        if (eventName !== "load" && eventName !== "error" && eventName !== "progress") {
            throw new Error("Event not supported: " + eventName);
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.push(handler);
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.removeEventListener = function (eventName, toDetach) {
        var handlers = this._listeners.get(eventName) || [];
        handlers = handlers.filter(function (handler) { return handler !== toDetach; });
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.emitEvent = function (eventName) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.forEach(function (handler) {
            handler.apply(void 0, args);
        });
    };
    XMLHttpRequest.prototype.setRequestHeader = function (header, value) {
        if (types.isDefined(this._options) && types.isString(header) && types.isString(value)) {
            this._options.headers[header] = value;
        }
    };
    XMLHttpRequest.prototype.getAllResponseHeaders = function () {
        if (this._readyState < 2 || this._errorFlag) {
            return "";
        }
        var result = "";
        for (var i in this._headers) {
            result += i + ": " + this._headers[i] + "\r\n";
        }
        return result.substr(0, result.length - 2);
    };
    XMLHttpRequest.prototype.getResponseHeader = function (header) {
        if (types.isString(header) && this._readyState > 1
            && this._headers
            && !this._errorFlag) {
            header = header.toLowerCase();
            for (var i in this._headers) {
                if (i.toLowerCase() === header) {
                    return this._headers[i];
                }
            }
        }
        return null;
    };
    XMLHttpRequest.prototype.overrideMimeType = function (mime) {
    };
    Object.defineProperty(XMLHttpRequest.prototype, "readyState", {
        get: function () {
            return this._readyState;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "responseType", {
        get: function () {
            return this._responseType;
        },
        set: function (value) {
            if (value === XMLHttpRequestResponseType.empty || value in XMLHttpRequestResponseType) {
                this._responseType = value;
            }
            else {
                throw new Error("Response type of '" + value + "' not supported.");
            }
        },
        enumerable: true,
        configurable: true
    });
    XMLHttpRequest.prototype._setReadyState = function (value, error) {
        if (this._readyState !== value) {
            this._readyState = value;
            if (types.isFunction(this.onreadystatechange)) {
                this.onreadystatechange();
            }
        }
        if (this._readyState === this.DONE) {
            if (this._errorFlag) {
                if (types.isFunction(this.onerror)) {
                    this.onerror(error);
                }
                this.emitEvent("error", error);
            }
            else {
                if (types.isFunction(this.onload)) {
                    this.onload();
                }
                this.emitEvent("load");
            }
        }
    };
    Object.defineProperty(XMLHttpRequest.prototype, "responseText", {
        get: function () {
            if (types.isFunction(this._responseTextReader)) {
                return this._responseTextReader();
            }
            return "";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "response", {
        get: function () {
            return this._response;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "statusText", {
        get: function () {
            if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._errorFlag) {
                return "";
            }
            return statuses[this._status];
        },
        enumerable: true,
        configurable: true
    });
    return XMLHttpRequest;
}());
exports.XMLHttpRequest = XMLHttpRequest;
var statuses = {
    100: "Continue",
    101: "Switching Protocols",
    200: "OK",
    201: "Created",
    202: "Accepted",
    203: "Non - Authoritative Information",
    204: "No Content",
    205: "Reset Content",
    206: "Partial Content",
    300: "Multiple Choices",
    301: "Moved Permanently",
    302: "Found",
    303: "See Other",
    304: "Not Modified",
    305: "Use Proxy",
    307: "Temporary Redirect",
    400: "Bad Request",
    401: "Unauthorized",
    402: "Payment Required",
    403: "Forbidden",
    404: "Not Found",
    405: "Method Not Allowed",
    406: "Not Acceptable",
    407: "Proxy Authentication Required",
    408: "Request Timeout",
    409: "Conflict",
    410: "Gone",
    411: "Length Required",
    412: "Precondition Failed",
    413: "Request Entity Too Large",
    414: "Request - URI Too Long",
    415: "Unsupported Media Type",
    416: "Requested Range Not Satisfiable",
    417: "Expectation Failed",
    500: "Internal Server Error",
    501: "Not Implemented",
    502: "Bad Gateway",
    503: "Service Unavailable",
    504: "Gateway Timeout",
    505: "HTTP Version Not Supported"
};
var FormData = (function () {
    function FormData() {
        this._data = new Map();
    }
    FormData.prototype.append = function (name, value) {
        this._data.set(name, value);
    };
    FormData.prototype.toString = function () {
        var arr = new Array();
        this._data.forEach(function (value, name, map) {
            arr.push(encodeURIComponent(name) + "=" + encodeURIComponent(value));
        });
        return arr.join("&");
    };
    return FormData;
}());
exports.FormData = FormData;
//# sourceMappingURL=xhr.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xml/xml.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var easysax = __webpack_require__("../node_modules/tns-core-modules/js-libs/easysax/easysax.js");
var ParserEventType = (function () {
    function ParserEventType() {
    }
    ParserEventType.StartElement = "StartElement";
    ParserEventType.EndElement = "EndElement";
    ParserEventType.Text = "Text";
    ParserEventType.CDATA = "CDATA";
    ParserEventType.Comment = "Comment";
    return ParserEventType;
}());
exports.ParserEventType = ParserEventType;
var ParserEvent = (function () {
    function ParserEvent(eventType, position, prefix, namespace, elementName, attributes, data) {
        this._eventType = eventType;
        this._position = position;
        this._prefix = prefix;
        this._namespace = namespace;
        this._elementName = elementName;
        this._attributes = attributes;
        this._data = data;
    }
    ParserEvent.prototype.toString = function () {
        return JSON.stringify({
            eventType: this.eventType,
            position: this.position,
            prefix: this.prefix,
            namespace: this.namespace,
            elementName: this.elementName,
            attributes: this.attributes,
            data: this.data
        });
    };
    Object.defineProperty(ParserEvent.prototype, "eventType", {
        get: function () {
            return this._eventType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "position", {
        get: function () {
            return this._position;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "prefix", {
        get: function () {
            return this._prefix;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "namespace", {
        get: function () {
            return this._namespace;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "elementName", {
        get: function () {
            return this._elementName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "attributes", {
        get: function () {
            return this._attributes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "data", {
        get: function () {
            return this._data;
        },
        enumerable: true,
        configurable: true
    });
    return ParserEvent;
}());
exports.ParserEvent = ParserEvent;
var _ampCodes;
var _entitySearchRegEx = /&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig;
function _generateAmpMap() {
    var objCodes = { Tab: 9, NewLine: 10, excl: 33, quot: 34, QUOT: 34, num: 35, dollar: 36, percent: 37, amp: 38, AMP: 38, apos: 39, lpar: 40, rpar: 41, ast: 42, midast: 42, plus: 43, comma: 44, period: 46, sol: 47, colon: 58, semi: 59, lt: 60, LT: 60, equals: 61, gt: 62, GT: 62, quest: 63, commat: 64, lsqb: 91, lbrack: 91, bsol: 92, rsqb: 92, rbrack: 92, Hat: 94, lowbar: 95, grave: 96, DiacriticalGrave: 96, lcub: 123, lbrace: 123, verbar: 124, vert: 124, VerticalLine: 124, rcub: 125, rbrace: 125, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, brkbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, hibar: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Dstrok: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, fnof: 402, imped: 437, gacute: 501, jmath: 567, circ: 710, caron: 711, Hacek: 711, breve: 728, Breve: 728, dot: 729, DiacriticalDot: 729, ring: 730, ogon: 731, tilde: 732, DiacriticalTilde: 732, dblac: 733, DiacriticalDoubleAcute: 733, DownBreve: 785, UnderBar: 818, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, epsiv: 949, varepsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigmav: 962, varsigma: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetav: 977, vartheta: 977, thetasym: 977, Upsi: 978, upsih: 978, straightphi: 981, piv: 982, varpi: 982, Gammad: 988, gammad: 989, digamma: 989, kappav: 1008, varkappa: 1008, rhov: 1009, varrho: 1009, epsi: 1013, straightepsilon: 1013, bepsi: 1014, backepsilon: 1014, euro: 8364, trade: 8482, TRADE: 8482, forall: 8704, part: 8706, larr: 8592, rarr: 8593, hyphen: 8208, dash: 8208, ndash: 8211, mdash: 8212, horbar: 8213, Vert: 8214, Verbar: 8214, lsquo: 8216, OpenCurlyQuote: 8216, rsquo: 8217, rsquor: 8217, CloseCurlyQuote: 8217, lsquor: 8218, sbquo: 8218, ldquo: 8220, OpenCurlyDoubleQuote: 8220, rdquo: 8221, rdquor: 8221, CloseCurlyDoubleQuote: 8221, ldquor: 8222, bdquo: 8222, dagger: 8224, Dagger: 8225, ddagger: 8225, bull: 8226, bullet: 8226, nldr: 8229, hellip: 8230, mldr: 8230, hybull: 8259, tdot: 8411, TripleDot: 8411, DotDot: 8412, star: 9734, phone: 9742, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830, female: 9792, male: 9794, check: 10003, checkmark: 10003, cross: 10007, VerticalSeparator: 10072, EmptySmallSquare: 9723, FilledSmallSquare: 9724, starf: 9733, bigstar: 9733, square: 9633, squ: 9633, Square: 9633 };
    var ampCodes = new Map();
    for (var key in objCodes) {
        if (objCodes.hasOwnProperty(key)) {
            ampCodes.set(key, objCodes[key]);
        }
    }
    return ampCodes;
}
if (global.__snapshot) {
    _ampCodes = _generateAmpMap();
}
function _HandleAmpEntities(found, decimalValue, hexValue, wordValue) {
    if (wordValue) {
        if (!_ampCodes) {
            _ampCodes = _generateAmpMap();
        }
        var res = _ampCodes.get(wordValue);
        if (res) {
            return String.fromCharCode(res);
        }
        return found;
    }
    if (decimalValue) {
        return String.fromCharCode(parseInt(decimalValue, 10));
    }
    return String.fromCharCode(parseInt(hexValue, 16));
}
var XmlParser = (function () {
    function XmlParser(onEvent, onError, processNamespaces) {
        this._processNamespaces = processNamespaces;
        this._parser = new easysax.EasySAXParser();
        var that = this;
        this._parser.on("startNode", function (elem, attr, uq, tagend, str, pos) {
            var attributes = attr();
            if (attributes === true) {
                attributes = undefined;
            }
            if (attributes) {
                for (var key in attributes) {
                    if (attributes.hasOwnProperty(key)) {
                        attributes[key] = XmlParser._dereferenceEntities(attributes[key]);
                    }
                }
            }
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var stackEntry = XmlParser._getNamespacesStackEntry(attributes);
                that._namespaceStack.push(stackEntry);
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.StartElement, pos(), prefix, namespace, name, attributes, undefined));
        });
        this._parser.on("textNode", function (text, uq, pos) {
            var data = uq(XmlParser._dereferenceEntities(text));
            onEvent(new ParserEvent(ParserEventType.Text, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("endNode", function (elem, uq, tagstart, str, pos) {
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.EndElement, pos(), prefix, namespace, name, undefined, undefined));
            if (that._processNamespaces) {
                that._namespaceStack.pop();
            }
        });
        this._parser.on("cdata", function (data, res, pos) {
            onEvent(new ParserEvent(ParserEventType.CDATA, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("comment", function (text, uq, pos) {
            onEvent(new ParserEvent(ParserEventType.Comment, pos(), undefined, undefined, undefined, undefined, text));
        });
        if (onError) {
            this._parser.on("error", function (msg, pos) {
                onError(new Error(msg), pos());
            });
        }
    }
    Object.defineProperty(XmlParser.prototype, "angularSyntax", {
        get: function () {
            return this._parser.angularSyntax;
        },
        set: function (value) {
            this._parser.angularSyntax = value;
        },
        enumerable: true,
        configurable: true
    });
    XmlParser.prototype.parse = function (xmlString) {
        if (this._processNamespaces) {
            this._namespaceStack = [];
        }
        this._parser.parse(xmlString);
    };
    XmlParser._getNamespacesStackEntry = function (attributes) {
        var stackEntry = {};
        if (!attributes) {
            return stackEntry;
        }
        var attributeName;
        var namespacePrefix;
        for (var key in attributes) {
            if (!attributes.hasOwnProperty(key)) {
                continue;
            }
            attributeName = key;
            if (attributeName.indexOf("xmlns") !== 0) {
                continue;
            }
            namespacePrefix = "";
            if (attributeName.indexOf(":") !== -1) {
                namespacePrefix = attributeName.split(":")[1];
            }
            stackEntry[namespacePrefix] = attributes[key];
        }
        return stackEntry;
    };
    XmlParser.prototype._resolveNamespace = function (fullName) {
        var result = { prefix: undefined, namespace: undefined, name: undefined };
        result.prefix = "";
        if (fullName.indexOf(":") !== -1) {
            var split = fullName.split(":");
            result.prefix = split[0];
            result.name = split[1];
        }
        else {
            result.name = fullName;
        }
        var stackEntry;
        for (var i = this._namespaceStack.length - 1; i >= 0; i--) {
            stackEntry = this._namespaceStack[i];
            for (var key in stackEntry) {
                if (!stackEntry.hasOwnProperty(key)) {
                    continue;
                }
                if (result.prefix === key) {
                    result.namespace = stackEntry[key];
                    return result;
                }
            }
        }
        return result;
    };
    XmlParser._dereferenceEntities = function (s) {
        s = String(s);
        if (s.length > 3 && s.indexOf("&") !== -1) {
            s = s.replace(_entitySearchRegEx, _HandleAmpEntities);
        }
        return s;
    };
    return XmlParser;
}());
exports.XmlParser = XmlParser;
//# sourceMappingURL=xml.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/nativescript-dev-webpack/node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tslib/tslib.es6.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2htci9obXItdXBkYXRlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2htci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9ob3QuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svbG9hZC1hcHBsaWNhdGlvbi1jc3MtYW5ndWxhci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9sb2FkLWFwcGxpY2F0aW9uLWNzcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYnVuZGxlLWVudHJ5LXBvaW50cy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3IvY29sb3ItY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jb2xvci9jb2xvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3Iva25vd24tY29sb3JzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jb25zb2xlL2NvbnNvbGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy12YWx1ZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jc3MvbGliL3BhcnNlL2luZGV4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jc3MvcGFyc2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kYXRhL29ic2VydmFibGUtYXJyYXkvb2JzZXJ2YWJsZS1hcnJheS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGF0YS9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RlYnVnZ2VyL0luc3BlY3RvckJhY2tlbmRDb21tYW5kcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGVidWdnZXIvZGVidWdnZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RlYnVnZ2VyL2RldnRvb2xzLWVsZW1lbnRzLmNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGVidWdnZXIvZGV2dG9vbHMtZWxlbWVudHMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RlYnVnZ2VyL2RvbS1ub2RlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci93ZWJpbnNwZWN0b3ItY3NzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci93ZWJpbnNwZWN0b3ItZG9tLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci93ZWJpbnNwZWN0b3ItbmV0d29yay5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZmV0Y2gvZmV0Y2guanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZpbGUtc3lzdGVtL2ZpbGUtc3lzdGVtLWFjY2Vzcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZmlsZS1zeXN0ZW0vZmlsZS1zeXN0ZW0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvZ2xvYmFscy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZ2xvYmFscy9yZWdpc3Rlci1tb2R1bGUtaGVscGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZ2xvYmFscy90cy1oZWxwZXJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9odHRwL2h0dHAtcmVxdWVzdC9odHRwLXJlcXVlc3QtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9odHRwL2h0dHAtcmVxdWVzdC9odHRwLXJlcXVlc3QuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2h0dHAvaHR0cC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaW1hZ2UtYXNzZXQvaW1hZ2UtYXNzZXQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9pbWFnZS1hc3NldC9pbWFnZS1hc3NldC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaW1hZ2Utc291cmNlL2ltYWdlLXNvdXJjZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaW5zcGVjdG9yX21vZHVsZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2pzLWxpYnMvZWFzeXNheC9lYXN5c2F4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL2VzcHJpbWEvZXNwcmltYS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvanMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zL3BhdGgtcGFyc2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL3BvbHltZXItZXhwcmVzc2lvbnMvcG9seW1lci1leHByZXNzaW9ucy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbWF0cml4L21hdHJpeC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbW9kdWxlLW5hbWUtcmVzb2x2ZXIvbW9kdWxlLW5hbWUtcmVzb2x2ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL21vZHVsZS1uYW1lLXJlc29sdmVyL25vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9tb2R1bGUtbmFtZS1yZXNvbHZlci9xdWFsaWZpZXItbWF0Y2hlci9xdWFsaWZpZXItbWF0Y2hlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvcGxhdGZvcm0vcGxhdGZvcm0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3Byb2ZpbGluZy9wcm9maWxpbmcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RleHQvZm9ybWF0dGVkLXN0cmluZy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdGV4dC9zcGFuLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90ZXh0L3RleHQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RpbWVyL3RpbWVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90cmFjZS90cmFjZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aW9uLWJhci9hY3Rpb24tYmFyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aW9uLWJhci9hY3Rpb24tYmFyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9hY3Rpdml0eS1pbmRpY2F0b3IvYWN0aXZpdHktaW5kaWNhdG9yLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYWN0aXZpdHktaW5kaWNhdG9yL2FjdGl2aXR5LWluZGljYXRvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYW5pbWF0aW9uL2FuaW1hdGlvbi1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2JvcmRlci9ib3JkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2JvdHRvbS1uYXZpZ2F0aW9uL2JvdHRvbS1uYXZpZ2F0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL2JpbmRpbmctYnVpbGRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnVpbGRlci9idWlsZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL2NvbXBvbmVudC1idWlsZGVyL2NvbXBvbmVudC1idWlsZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL21vZHVsZS1uYW1lLXNhbml0aXplci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnV0dG9uL2J1dHRvbi1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1dHRvbi9idXR0b24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvbnRlbnQtdmlldy9jb250ZW50LXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvYmluZGFibGUvYmluZGFibGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvY29udHJvbC1zdGF0ZS1jaGFuZ2UvY29udHJvbC1zdGF0ZS1jaGFuZ2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvcHJvcGVydGllcy9wcm9wZXJ0aWVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3ZpZXctYmFzZS92aWV3LWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvdmlldy92aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS92aWV3L3ZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvd2Vhay1ldmVudC1saXN0ZW5lci93ZWFrLWV2ZW50LWxpc3RlbmVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2RhdGUtcGlja2VyL2RhdGUtcGlja2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kaWFsb2dzL2RpYWxvZ3MtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9kaWFsb2dzL2RpYWxvZ3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2VkaXRhYmxlLXRleHQtYmFzZS9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9lZGl0YWJsZS10ZXh0LWJhc2UvZWRpdGFibGUtdGV4dC1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9lbnVtcy9lbnVtcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhZ21lbnQudHJhbnNpdGlvbnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2ZyYW1lLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUtc3RhY2suanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2ZyYW1lL2ZyYW1lLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9nZXN0dXJlcy9nZXN0dXJlcy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2dlc3R1cmVzL2dlc3R1cmVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9odG1sLXZpZXcvaHRtbC12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvaHRtbC12aWV3L2h0bWwtdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvaW1hZ2UvaW1hZ2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9pbWFnZS9pbWFnZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGFiZWwvbGFiZWwuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0L2Fic29sdXRlLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0L2Fic29sdXRlLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9kb2NrLWxheW91dC9kb2NrLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZG9jay1sYXlvdXQvZG9jay1sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvZmxleGJveC1sYXlvdXQvZmxleGJveC1sYXlvdXQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2ZsZXhib3gtbGF5b3V0L2ZsZXhib3gtbGF5b3V0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9sYXlvdXRzL2dyaWQtbGF5b3V0L2dyaWQtbGF5b3V0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9ncmlkLWxheW91dC9ncmlkLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy9sYXlvdXQtYmFzZS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvbGF5b3V0LWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvc3RhY2stbGF5b3V0L3N0YWNrLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvc3RhY2stbGF5b3V0L3N0YWNrLWxheW91dC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGF5b3V0cy93cmFwLWxheW91dC93cmFwLWxheW91dC1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xheW91dHMvd3JhcC1sYXlvdXQvd3JhcC1sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xpc3QtcGlja2VyL2xpc3QtcGlja2VyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvbGlzdC1waWNrZXIvbGlzdC1waWNrZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xpc3Qtdmlldy9saXN0LXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9saXN0LXZpZXcvbGlzdC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wYWdlL3BhZ2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wYWdlL3BhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3BsYWNlaG9sZGVyL3BsYWNlaG9sZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wcm9ncmVzcy9wcm9ncmVzcy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Byb2dyZXNzL3Byb2dyZXNzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9wcm94eS12aWV3LWNvbnRhaW5lci9wcm94eS12aWV3LWNvbnRhaW5lci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvcmVwZWF0ZXIvcmVwZWF0ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3Njcm9sbC12aWV3L3Njcm9sbC12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2Nyb2xsLXZpZXcvc2Nyb2xsLXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3NlYXJjaC1iYXIvc2VhcmNoLWJhci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3NlYXJjaC1iYXIvc2VhcmNoLWJhci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VnbWVudGVkLWJhci9zZWdtZW50ZWQtYmFyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2VnbWVudGVkLWJhci9zZWdtZW50ZWQtYmFyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zbGlkZXIvc2xpZGVyLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc2xpZGVyL3NsaWRlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9iYWNrZ3JvdW5kLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9iYWNrZ3JvdW5kLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2NvbnZlcnRlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY3NzLWFuaW1hdGlvbi1wYXJzZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY3NzLXNlbGVjdG9yL2Nzcy1zZWxlY3Rvci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9mb250LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9mb250LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2xpbmVhci1ncmFkaWVudC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlLXNjb3BlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlL3N0eWxlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zd2l0Y2gvc3dpdGNoLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3dpdGNoL3N3aXRjaC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItY29udGVudC1pdGVtL3RhYi1jb250ZW50LWl0ZW0tY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW0vdGFiLWNvbnRlbnQtaXRlbS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1uYXZpZ2F0aW9uLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW0vdGFiLXN0cmlwLWl0ZW0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwL3RhYi1zdHJpcC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFiLXZpZXcvdGFiLXZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90YWItdmlldy90YWItdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFicy90YWJzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGFicy90YWJzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWJhc2UvdGV4dC1iYXNlLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1iYXNlL3RleHQtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1maWVsZC90ZXh0LWZpZWxkLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdGV4dC1maWVsZC90ZXh0LWZpZWxkLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LXZpZXcvdGV4dC12aWV3LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90aW1lLXBpY2tlci90aW1lLXBpY2tlci1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RpbWUtcGlja2VyL3RpbWUtcGlja2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL2ZhZGUtdHJhbnNpdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvdHJhbnNpdGlvbi9zbGlkZS10cmFuc2l0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL3RyYW5zaXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3dlYi12aWV3L3dlYi12aWV3LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvd2ViLXZpZXcvd2ViLXZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL2RlYnVnLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy9tYWludGhyZWFkLWhlbHBlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvbnVtYmVyLXV0aWxzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy90eXBlcy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvdXRpbHMtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMveGhyL3hoci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMveG1sL3htbC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsZ0JBQWdCO0FBQ25ELElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvQkFBb0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELGNBQWM7O0FBRWxFO0FBQ0E7Ozs7Ozs7OztBQzNFQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQzs7Ozs7Ozs7QUNWQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQSxpQzs7Ozs7OztBQ0pBO0FBQ0E7QUFDQSx1Q0FBdUMsVUFBVSxHQUFHLFFBQVE7QUFDNUQsdUNBQXVDLFVBQVUsR0FBRyxRQUFRO0FBQzVELHlDQUF5QyxVQUFVLEdBQUcsUUFBUTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0RBQW9ELElBQUk7QUFDeEQsS0FBSztBQUNMO0FBQ0E7QUFDQSx5REFBeUQsSUFBSTtBQUM3RCxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNEQUFzRCxjQUFjLElBQUksVUFBVTtBQUNsRjtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxvQ0FBb0MsU0FBUztBQUM3QztBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQSxtQ0FBbUMsU0FBUztBQUM1Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsUUFBUTtBQUNuRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLDhFQUE4RSxZQUFZO0FBQzFGOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLFlBQVk7QUFDbkY7QUFDQSxxQkFBcUI7QUFDckIsb0RBQW9ELHlCQUF5QjtBQUM3RTtBQUNBLGlCQUFpQjtBQUNqQixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELFFBQVE7QUFDOUQ7QUFDQSxhQUFhO0FBQ2Isa0RBQWtELHlCQUF5QjtBQUMzRTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0EsQ0FBQyxRQUVEOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5RUFBeUUsWUFBWTtBQUNyRjtBQUNBLFNBQVM7QUFDVDtBQUNBLDBEQUEwRCxPQUFPLE1BQU0sUUFBUTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQyxLQUFLO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QztBQUNBLEtBQUs7QUFDTDs7Ozs7Ozs7QUN2S0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOzs7Ozs7Ozs7QUNOQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7Ozs7Ozs7QUNQQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0Qzs7QUFFNUM7Ozs7Ozs7O0FDbkJBLDRGQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHFDQUFxQztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UseURBQXlELEVBQUU7QUFDM0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw2REFBNkQ7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixrRUFBa0U7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix5REFBeUQ7QUFDNUU7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLCtGQUErRjtBQUNsSDtBQUNBO0FBQ0EsbUJBQW1CLG9FQUFvRTtBQUN2RjtBQUNBLDhDOzs7Ozs7OztBQ3JHQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDJFQUEyRTtBQUNoSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx3RkFBd0Y7QUFDN0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0VBQXdFO0FBQzdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxtR0FBbUc7QUFDeEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGdHQUFnRztBQUNySTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMscUdBQXFHO0FBQzFJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBLDZDQUE2QyxvQkFBb0I7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLG9CQUFvQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkM7Ozs7Ozs7O0FDelZBO0FBQ0E7QUFDQSxnRUFBZ0UseUZBQXlDLEVBQUU7QUFDM0csb0RBQW9ELDZFQUE2QixFQUFFO0FBQ25GLHdEQUF3RCw0RkFBaUMsRUFBRTtBQUMzRixnRUFBZ0UsNEdBQXlDLEVBQUU7QUFDM0csb0RBQW9ELG9GQUE2QixFQUFFO0FBQ25GLCtEQUErRCwwR0FBd0MsRUFBRTtBQUN6RyxvREFBb0Qsb0ZBQTZCLEVBQUU7QUFDbkYsMERBQTBELGdHQUFtQyxFQUFFO0FBQy9GLHlEQUF5RCw4RkFBa0MsRUFBRTtBQUM3RixtREFBbUQsa0ZBQTRCLEVBQUU7QUFDakYsdURBQXVELDBGQUFnQyxFQUFFO0FBQ3pGLG1EQUFtRCxrRkFBNEIsRUFBRTtBQUNqRixtREFBbUQsa0ZBQTRCLEVBQUU7QUFDakYscUVBQXFFLDhHQUE4QyxFQUFFO0FBQ3JILGlFQUFpRSxzR0FBMEMsRUFBRTtBQUM3RyxpRUFBaUUsc0dBQTBDLEVBQUU7QUFDN0csa0VBQWtFLHdHQUEyQyxFQUFFO0FBQy9HLG9FQUFvRSw0R0FBNkMsRUFBRTtBQUNuSCxpRUFBaUUsc0dBQTBDLEVBQUU7QUFDN0cseURBQXlELDhGQUFrQyxFQUFFO0FBQzdGLGtEQUFrRCxnRkFBMkIsRUFBRTtBQUMvRSx5REFBeUQsOEZBQWtDLEVBQUU7QUFDN0Ysc0RBQXNELHdGQUErQixFQUFFO0FBQ3ZGLGtFQUFrRSxnSEFBMkMsRUFBRTtBQUMvRyxzREFBc0Qsd0ZBQStCLEVBQUU7QUFDdkYseURBQXlELDhGQUFrQyxFQUFFO0FBQzdGLHdEQUF3RCw0RkFBaUMsRUFBRTtBQUMzRiwyREFBMkQsa0dBQW9DLEVBQUU7QUFDakcsb0RBQW9ELG9GQUE2QixFQUFFO0FBQ25GLG9EQUFvRCxvRkFBNkIsRUFBRTtBQUNuRixzREFBc0Qsd0ZBQStCLEVBQUU7QUFDdkYsMkVBQTJFLDhHQUFvRCxFQUFFO0FBQ2pJLGdGQUFnRix3SEFBeUQsRUFBRTtBQUMzSSxrRkFBa0YsNEhBQTJELEVBQUU7QUFDL0ksa0RBQWtELGdGQUEyQixFQUFFO0FBQy9FLHNEQUFzRCx3RkFBK0IsRUFBRTtBQUN2Rix3REFBd0QsNEZBQWlDLEVBQUU7QUFDM0YsdURBQXVELDBGQUFnQyxFQUFFO0FBQ3pGLHlEQUF5RCw4RkFBa0MsRUFBRTtBQUM3Rix1REFBdUQsMEZBQWdDLEVBQUU7QUFDekY7QUFDQSwrQzs7Ozs7Ozs7QUMzQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLEVBQUUsZUFBZSxFQUFFLGVBQWUsRUFBRTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIseUNBQXlDLEVBQUU7QUFDckU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQix5Q0FBeUMsRUFBRTtBQUNyRTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLHlDQUF5QyxFQUFFO0FBQ3JFO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwwQkFBMEIseUNBQXlDLEVBQUU7QUFDckU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7OztBQ2pNQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBLHFDOzs7Ozs7O0FDcEJBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7OztBQ2xLQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG1DOzs7Ozs7OztBQ3hCQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7Ozs7OztBQ2hIQTs7Ozs7Ozs7QUNBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CO0FBQ3BCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esc0VBQXNFOztBQUV0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSxjQUFjOztBQUVkO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEseUNBQXlDO0FBQ3pDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsMENBQTBDO0FBQzFDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvREFBb0Q7O0FBRXBEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxREFBcUQ7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtQ0FBbUM7O0FBRW5DO0FBQ0E7O0FBRUEsbURBQW1EOztBQUVuRDs7QUFFQSxvREFBb0Q7O0FBRXBEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsK0NBQStDOztBQUUvQzs7QUFFQSxnREFBZ0Q7O0FBRWhEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdDQUFnQzs7QUFFaEM7QUFDQTs7QUFFQSxnREFBZ0Q7O0FBRWhEOztBQUVBLGlEQUFpRDs7QUFFakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0RBQXNELElBQUk7QUFDMUQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLCtDQUErQztBQUMvQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsZ0RBQWdEOztBQUVoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0QztBQUM1Qzs7QUFFQTtBQUNBOztBQUVBLG1EQUFtRDs7QUFFbkQ7O0FBRUEsb0RBQW9EOztBQUVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvREFBb0Q7QUFDcEQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFEQUFxRDs7QUFFckQ7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQSwrQ0FBK0MsSUFBSTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQywyQkFBMkIsRUFBRTtBQUM5RCxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBOzs7Ozs7OztBQ3psQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxzQ0FBc0MsRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFO0FBQ3hFO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsT0FBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsaURBQWlEO0FBQ2xEO0FBQ0EsNkJBQTZCLHNDQUFzQztBQUNuRTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDLDZCQUE2QixzQ0FBc0M7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDLDZCQUE2QixzQ0FBc0M7QUFDbkU7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGlDQUFpQywyQkFBMkI7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsVUFBVSxxREFBcUQsRUFBRSxFQUFFO0FBQzFHLHVDQUF1QyxVQUFVLHFDQUFxQyxFQUFFLEVBQUU7QUFDMUYseUNBQXlDLFVBQVUsc0RBQXNELEVBQUUsRUFBRTtBQUM3Ryx5Q0FBeUMsVUFBVSxvREFBb0QsRUFBRTtBQUN6RztBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLGFBQWEsRUFBRTtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0Qyw2QkFBNkIsc0NBQXNDO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGlDQUFpQyw4Q0FBOEM7QUFDbkc7QUFDQTtBQUNBLG9CQUFvQixpQ0FBaUMsa0NBQWtDO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0Qyw2QkFBNkIscUNBQXFDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGlDQUFpQywyQkFBMkI7QUFDcEY7QUFDQTtBQUNBLHdCQUF3QixpQ0FBaUMsZ0RBQWdEO0FBQ3pHO0FBQ0E7QUFDQSx3QkFBd0IsaUNBQWlDLGdEQUFnRDtBQUN6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQ0FBaUMsS0FBSywyQ0FBMkMsTUFBTSwyQ0FBMkMsRUFBRTtBQUM1SjtBQUNBO0FBQ0Esd0JBQXdCLGlDQUFpQyxLQUFLLDJDQUEyQyxlQUFlO0FBQ3hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBLHlCQUF5QixNQUFNO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUNBQWlDLDBDQUEwQztBQUMzRjtBQUNBLFlBQVksaUNBQWlDLG9CQUFvQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpQ0FBaUMsK0JBQStCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxpQ0FBaUMsWUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixXQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUNBQWlDLDZEQUE2RDtBQUM5RztBQUNBLFlBQVksaUNBQWlDLGlDQUFpQztBQUM5RTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLFdBQVc7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLElBQUk7QUFDMUUsc0VBQXNFLElBQUk7QUFDMUU7QUFDQTtBQUNBLHVFQUF1RSxJQUFJLCtDQUErQyxJQUFJO0FBQzlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQixtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLCtFQUErRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxLQUFLO0FBQ25CO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsOEJBQThCLEVBQUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDJDQUEyQyxFQUFFO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsb0NBQW9DO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQSx1Q0FBdUMsd0RBQXdEO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix3REFBd0Q7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGtDOzs7Ozs7O0FDNXZDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsT0FBTztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELE9BQU87QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixRQUFRO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0Qzs7Ozs7OztBQ2hNQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbURBQW1EO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxPQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsT0FBTztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsUUFBUTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsT0FBTztBQUNqRDtBQUNBLHlCQUF5QixtQ0FBbUM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsK0JBQStCLG1CQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0M7Ozs7Ozs7QUM1TkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQSw2QkFBNkIsa0RBQWtEO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsK0NBQStDLDJCQUEyQixFQUFFO0FBQzdIO0FBQ0E7QUFDQSxpREFBaUQsNENBQTRDLHVEQUF1RCxFQUFFO0FBQ3RKO0FBQ0E7QUFDQSxpREFBaUQsK0NBQStDLHVEQUF1RCxFQUFFO0FBQ3pKO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsdURBQXVELEVBQUU7QUFDMUc7QUFDQTtBQUNBLGlEQUFpRCwrQ0FBK0MsNk5BQTZOLEVBQUU7QUFDL1Q7QUFDQTtBQUNBLGlEQUFpRCxzREFBc0QseUhBQXlILEVBQUU7QUFDbE87QUFDQTtBQUNBLGlEQUFpRCxxREFBcUQscURBQXFELEVBQUU7QUFDN0o7QUFDQTtBQUNBLGlEQUFpRCx5Q0FBeUMsMkRBQTJELEVBQUU7QUFDdko7QUFDQTtBQUNBLGlEQUFpRCwyQ0FBMkMsRUFBRTtBQUM5RjtBQUNBO0FBQ0EsaURBQWlELGlEQUFpRCxtQkFBbUIsRUFBRTtBQUN2SDtBQUNBO0FBQ0EsaURBQWlELDREQUE0RCwyQ0FBMkMsRUFBRTtBQUMxSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELHlEQUF5RCxxQkFBcUIsRUFBRTtBQUNqSTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyxzRUFBc0U7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDhDQUE4QyxxQkFBcUIsRUFBRTtBQUN0SDtBQUNBO0FBQ0EsaURBQWlELDJEQUEyRCxpQkFBaUIsRUFBRTtBQUMvSDtBQUNBO0FBQ0EsaURBQWlELGtEQUFrRCxFQUFFO0FBQ3JHO0FBQ0E7QUFDQSxpREFBaUQsOENBQThDLHVFQUF1RSxFQUFFO0FBQ3hLO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsbURBQW1ELHlCQUF5QixFQUFFO0FBQy9IO0FBQ0E7QUFDQSxpREFBaUQsNkNBQTZDLHlCQUF5QixFQUFFO0FBQ3pIO0FBQ0E7QUFDQSxpREFBaUQsNkNBQTZDLGlCQUFpQixFQUFFO0FBQ2pIO0FBQ0E7QUFDQSxpREFBaUQsNENBQTRDLHFCQUFxQixFQUFFO0FBQ3BIO0FBQ0E7QUFDQSxpREFBaUQsa0RBQWtELHFCQUFxQixFQUFFO0FBQzFIO0FBQ0E7QUFDQSxpREFBaUQsa0RBQWtELHFCQUFxQixFQUFFO0FBQzFIO0FBQ0E7QUFDQSxpREFBaUQsdURBQXVELHFDQUFxQyxFQUFFO0FBQy9JO0FBQ0E7QUFDQSxpREFBaUQsOERBQThELHFCQUFxQixFQUFFO0FBQ3RJO0FBQ0E7QUFDQSxpREFBaUQsc0RBQXNELHFCQUFxQixFQUFFO0FBQzlIO0FBQ0E7QUFDQSxpREFBaUQsc0RBQXNELEVBQUU7QUFDekc7QUFDQTtBQUNBLGlEQUFpRCw2Q0FBNkMseUJBQXlCLEVBQUU7QUFDekg7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtREFBbUQsdU5BQXVOLEVBQUU7QUFDN1Q7QUFDQTtBQUNBLGlEQUFpRCx3REFBd0QseUJBQXlCLEVBQUU7QUFDcEk7QUFDQTtBQUNBLGlEQUFpRCxrREFBa0QsK0hBQStILEVBQUU7QUFDcE87QUFDQTtBQUNBLGlEQUFpRCw4Q0FBOEMsbUhBQW1ILEVBQUU7QUFDcE47QUFDQTtBQUNBLGlEQUFpRCxpREFBaUQsK0VBQStFLEVBQUU7QUFDbkw7QUFDQTtBQUNBLGlEQUFpRCwrQ0FBK0MsK0ZBQStGLEVBQUU7QUFDak07QUFDQTtBQUNBLGlEQUFpRCw4REFBOEQscUtBQXFLLEVBQUU7QUFDdFI7QUFDQTtBQUNBLGlEQUFpRCxtRUFBbUUscUVBQXFFLEVBQUU7QUFDM0w7QUFDQTtBQUNBLGlEQUFpRCxvRUFBb0UsdUVBQXVFLEVBQUU7QUFDOUw7QUFDQTtBQUNBLGlEQUFpRCxrREFBa0QscUNBQXFDLEVBQUU7QUFDMUk7QUFDQTtBQUNBLGlEQUFpRCxpREFBaUQsaURBQWlELEVBQUU7QUFDcko7QUFDQTtBQUNBLGlEQUFpRCx3REFBd0QsdUVBQXVFLEVBQUU7QUFDbEw7QUFDQTtBQUNBLGlEQUFpRCxxREFBcUQsK0VBQStFLEVBQUU7QUFDdkw7QUFDQTtBQUNBLGlEQUFpRCxvREFBb0QsdUVBQXVFLEVBQUU7QUFDOUs7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUMsc0VBQXNFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCw4Q0FBOEMsRUFBRTtBQUNqRztBQUNBO0FBQ0EsaURBQWlELDJDQUEyQyx1Q0FBdUMsRUFBRTtBQUNySTtBQUNBO0FBQ0EsaURBQWlELCtDQUErQyxpREFBaUQsRUFBRTtBQUNuSjtBQUNBO0FBQ0EsaURBQWlELDhDQUE4QyxpQ0FBaUMsRUFBRTtBQUNsSTtBQUNBO0FBQ0EsaURBQWlELG9EQUFvRCxxQkFBcUIsRUFBRTtBQUM1SDtBQUNBO0FBQ0EsaURBQWlELG1EQUFtRCxtREFBbUQsRUFBRTtBQUN6SjtBQUNBO0FBQ0EsaURBQWlELG1EQUFtRCxxREFBcUQsRUFBRTtBQUMzSjtBQUNBO0FBQ0EsaURBQWlELCtDQUErQywrRUFBK0UsRUFBRTtBQUNqTDtBQUNBO0FBQ0EsaURBQWlELDhDQUE4QyxpREFBaUQsRUFBRTtBQUNsSjtBQUNBO0FBQ0EsaURBQWlELDhDQUE4QyxpQ0FBaUMsRUFBRTtBQUNsSTtBQUNBO0FBQ0EsaURBQWlELDhDQUE4QyxxQ0FBcUMsRUFBRTtBQUN0STtBQUNBO0FBQ0EsaURBQWlELGdEQUFnRCx1REFBdUQsRUFBRTtBQUMxSjtBQUNBO0FBQ0EsaURBQWlELGtEQUFrRCwyREFBMkQsRUFBRTtBQUNoSztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQywwREFBMEQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELHNEQUFzRCxFQUFFO0FBQ3pHO0FBQ0E7QUFDQSxpREFBaUQsMkNBQTJDLEVBQUU7QUFDOUY7QUFDQTtBQUNBLGlEQUFpRCwrQ0FBK0MsK0JBQStCLEVBQUU7QUFDakk7QUFDQTtBQUNBLGlEQUFpRCw2Q0FBNkMsbUJBQW1CLEVBQUU7QUFDbkg7QUFDQTtBQUNBLGlEQUFpRCwrQ0FBK0MsK0JBQStCLEVBQUU7QUFDakk7QUFDQTtBQUNBLGlEQUFpRCxnREFBZ0QsMkRBQTJELEVBQUU7QUFDOUo7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUMsMERBQTBEO0FBQzNELHdEOzs7Ozs7O0FDalFBLDRGQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsbUVBQW1FO0FBQ3BFLG9DOzs7Ozs7OztBQzNIQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0EsZ0NBQWdDLDRGQUF5QztBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxvRDs7Ozs7OztBQ2hGQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUQ7Ozs7Ozs7QUNyQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixzQ0FBc0M7QUFDOUQ7QUFDQSxrREFBa0QsNkhBQWdGLEVBQUU7QUFDcEksNkNBQTZDLGtIQUEwRCxFQUFFO0FBQ3pHLGlEQUFpRCxzSEFBOEQsRUFBRTtBQUNqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxxREFBcUQsRUFBRTtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsMkJBQTJCLEVBQUU7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxxQkFBcUIsRUFBRTtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esb0M7Ozs7Ozs7QUM3TEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGdEOzs7Ozs7O0FDOURBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxnRDs7Ozs7OztBQzFFQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUpBQW1KLGlCQUFpQjtBQUNwSztBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiwyREFBMkQsYUFBYSxtRUFBbUUsc0RBQXNEO0FBQ2hPO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxvRDs7Ozs7OztBQ2pOQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBLENBQUMsSTs7Ozs7Ozs7QUMvVUQsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHFCQUFxQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUJBQWlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esa0Q7Ozs7Ozs7QUM1VUEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIseUNBQXlDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxrREFBa0Q7QUFDdkQsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDJDQUEyQztBQUM1Qyx1Qzs7Ozs7OztBQy9sQkEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLCtFQUF5QixFQUFFO0FBQ3ZFLGlEQUFpRCxzRkFBOEIsRUFBRTtBQUNqRiwwQ0FBMEMsMkVBQXVCLEVBQUU7QUFDbkUsNENBQTRDLCtFQUF5QixFQUFFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCwyREFBMkQ7QUFDNUc7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix1QkFBdUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsdUJBQXVCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQzs7Ozs7Ozs7QUN4SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUNBQWlDO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsbUJBQW1CO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0NBQXNDLGVBQWUsRUFBRSxFQUFFO0FBQ3hGLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0EsaURBQWlELGdCQUFnQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRDs7Ozs7Ozs7QUNsR0EsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLGdCQUFnQjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQzs7Ozs7Ozs7QUN2QkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0M7Ozs7Ozs7QUNoQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDJGQUEyRjtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCx1Q0FBdUMsRUFBRTtBQUNwRyx5REFBeUQsa0RBQWtELEVBQUU7QUFDN0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckMsaUNBQWlDO0FBQ2pDLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Qzs7Ozs7OztBQ3RNQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCwwQkFBMEI7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZ0JBQWdCLGtCQUFrQixFQUFFO0FBQzdDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCwwQkFBMEI7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZ0JBQWdCLGtCQUFrQixFQUFFO0FBQzdDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCwwQkFBMEI7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDBCQUEwQjtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxnQkFBZ0Isa0JBQWtCLEVBQUU7QUFDN0MsS0FBSztBQUNMO0FBQ0E7QUFDQSxnQzs7Ozs7OztBQ25FQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDOzs7Ozs7O0FDNURBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UscUNBQXFDO0FBQzdHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwyQzs7Ozs7OztBQ3pFQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixlQUFlO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDOzs7Ozs7O0FDNVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEOzs7Ozs7O0FDTkE7QUFDQTtBQUNBOztBQUVBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7OztBQUdIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxHQUFHOzs7QUFHSDtBQUNBO0FBQ0EsR0FBRzs7QUFFSCx1Q0FBdUMsRUFBRTtBQUN6Qyx3Q0FBd0MsRUFBRTs7QUFFMUM7QUFDQSxpQkFBaUIsSUFBSTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBOzs7QUFHQSx1QkFBdUI7QUFDdkIsd0JBQXdCO0FBQ3hCLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRDtBQUNwRCw0REFBNEQ7QUFDNUQsd0RBQXdEO0FBQ3hELDBEQUEwRDtBQUMxRCxvREFBb0Q7O0FBRXBELDRDQUE0QywwQkFBMEI7QUFDdEUsOENBQThDLDJCQUEyQixPQUFPO0FBQ2hGLGdEQUFnRCw0QkFBNEIsT0FBTztBQUNuRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlCQUF5Qjs7QUFFekI7O0FBRUE7O0FBRUEsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsOEJBQThCO0FBQ3pELDJCQUEyQiw4QkFBOEI7QUFDekQsNkJBQTZCLGdDQUFnQzs7QUFFN0Q7QUFDQSxtQ0FBbUMsMEJBQTBCLFFBQVE7QUFDckU7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUyxPQUFPO0FBQ2hCOztBQUVBLHlDQUF5QztBQUN6QztBQUNBOztBQUVBO0FBQ0E7QUFDQSwwRkFBMEY7QUFDMUYseUNBQXlDO0FBQ3pDOztBQUVBLHNCQUFzQixPQUFPLE9BQU87QUFDcEM7O0FBRUE7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0EsYUFBYSxxQkFBcUI7QUFDbEM7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDOztBQUVBOztBQUVBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDJCQUEyQjtBQUMzQjs7QUFFQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQSxpQkFBaUIsT0FBTztBQUN4QixpREFBaUQ7QUFDakQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEsb0JBQW9CO0FBQ3BCLGNBQWM7O0FBRWQsK0JBQStCO0FBQy9CO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBOztBQUVBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0Esb0NBQW9DO0FBQ3BDOzs7QUFHQTtBQUNBOztBQUVBLHlDQUF5QyxPQUFPO0FBQ2hEOztBQUVBO0FBQ0Esd0JBQXdCO0FBQ3hCLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHVDQUF1QztBQUN2QztBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBLHVCQUF1Qjs7QUFFdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSx1QkFBdUI7QUFDdkI7QUFDQSw4REFBOEQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSx5REFBeUQ7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxTQUFTO0FBQ1QsMkJBQTJCO0FBQzNCO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNCQUFzQixNQUFNO0FBQzVCO0FBQ0E7O0FBRUEsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBLG9DQUFvQztBQUNwQywwQkFBMEI7QUFDMUI7QUFDQSxhQUFhO0FBQ2IsbUNBQW1DLGdCQUFnQjtBQUNuRDtBQUNBOztBQUVBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7O0FBRUEsNkJBQTZCOztBQUU3QiwyQ0FBMkM7QUFDM0MsdUJBQXVCO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsT0FBTztBQUN4Qjs7QUFFQSxpREFBaUQ7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsU0FBUztBQUNULDhDQUE4QztBQUM5Qzs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvQ0FBb0MsT0FBTztBQUMzQzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsZ0RBQWdEO0FBQ2hEO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQjtBQUNqQjtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixrQ0FBa0M7QUFDbEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSw4Q0FBOEM7O0FBRTlDLHVCQUF1QjtBQUN2QjtBQUNBOztBQUVBO0FBQ0Esb0RBQW9ELHlCQUF5QjtBQUM3RTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7OztBQzd3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxzQ0FBc0M7QUFDdEM7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0EsMkJBQTJCO0FBQzNCLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUI7QUFDckI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYiw2QkFBNkI7QUFDN0I7QUFDQTs7QUFFQTtBQUNBLHlCQUF5QjtBQUN6Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0EseUJBQXlCO0FBQ3pCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7O0FBRUEscURBQXFEO0FBQ3JEO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxpQkFBaUI7O0FBRWpCLHdCQUF3QjtBQUN4Qjs7QUFFQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBOztBQUVBLGlCQUFpQjs7QUFFakI7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVMsa0JBQWtCO0FBQzNCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCx5QkFBeUI7QUFDekIsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrQjs7Ozs7Ozs7QUNqaENEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxxQ0FBcUM7QUFDckMsa0JBQWtCLFlBQVksRUFBRTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQjs7QUFFbkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBVztBQUNYOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSx1QkFBdUIsaUJBQWlCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0JBQXdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSw0Q0FBNEMsMkJBQTJCO0FBQ3ZFO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCLHFCQUFxQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBLG1FQUFtRTs7QUFFbkU7Ozs7Ozs7O0FDeFlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDJCQUEyQixzQkFBc0I7QUFDakQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsK0JBQStCLGdDQUFnQzs7QUFFL0Q7QUFDQSwyQkFBMkIsV0FBVyxFQUFFO0FBQ3hDLDJCQUEyQixXQUFXLEVBQUU7QUFDeEMsMkJBQTJCLFdBQVc7QUFDdEM7O0FBRUE7QUFDQSw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLDhCQUE4QixjQUFjLEVBQUU7QUFDOUMsOEJBQThCLGNBQWMsRUFBRTtBQUM5Qyw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLDhCQUE4QixjQUFjLEVBQUU7QUFDOUMsOEJBQThCLGNBQWMsRUFBRTtBQUM5Qyw4QkFBOEIsY0FBYyxFQUFFO0FBQzlDLCtCQUErQixlQUFlLEVBQUU7QUFDaEQsK0JBQStCLGVBQWUsRUFBRTtBQUNoRCwrQkFBK0IsZUFBZSxFQUFFO0FBQ2hELCtCQUErQixlQUFlLEVBQUU7QUFDaEQsZ0NBQWdDLGdCQUFnQixFQUFFO0FBQ2xELGdDQUFnQyxnQkFBZ0IsRUFBRTtBQUNsRCwrQkFBK0IsZUFBZSxFQUFFO0FBQ2hELCtCQUErQixlQUFlLEVBQUU7QUFDaEQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLDJCQUEyQixxQkFBcUI7QUFDaEQ7O0FBRUE7QUFDQTtBQUNBLCtCQUErQixxQkFBcUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBLDJCQUEyQix1QkFBdUI7QUFDbEQ7O0FBRUE7QUFDQTtBQUNBLCtCQUErQix1QkFBdUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSwrQkFBK0I7O0FBRS9CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseUJBQXlCO0FBQ3BEO0FBQ0E7O0FBRUE7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsbUNBQW1DOztBQUVuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQyxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbURBQW1EO0FBQ2xFO0FBQ0EsZUFBZSx1REFBdUQ7QUFDdEU7QUFDQSxlQUFlLHlEQUF5RDtBQUN4RTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxDQUFDLGtCOzs7Ozs7O0FDemhCRCw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDOzs7Ozs7O0FDekVBLDRGQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxrREFBa0Q7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQywwRUFBMEUsRUFBRTtBQUN2SDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QscUJBQXFCLEVBQUU7QUFDdkU7QUFDQTtBQUNBLENBQUM7QUFDRCxnRDs7Ozs7Ozs7QUNyRUEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDRCQUE0QjtBQUMvRDtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsa0NBQWtDLEVBQUU7QUFDN0YsNkNBQTZDLGtDQUFrQyxFQUFFO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLHNDQUFzQyxFQUFFO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxzQkFBc0IsRUFBRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQSxzRDs7Ozs7Ozs7QUNwRkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdDQUFnQztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkM7Ozs7Ozs7QUMxSEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGlEQUFpRDtBQUNsRDtBQUNBO0FBQ0Esd0M7Ozs7Ozs7QUNuS0EsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLFVBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLFVBQVU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsOENBQThDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtQkFBbUI7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQzs7Ozs7Ozs7QUNqUkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsK0VBQStFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxzREFBc0QsY0FBYztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiwwQkFBMEI7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDhCQUE4QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsb0JBQW9CLEVBQUU7QUFDdkU7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDRDOzs7Ozs7O0FDbktBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGdDOzs7Ozs7O0FDaEdBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHVEQUF1RDtBQUN4RCxvQzs7Ozs7OztBQ1ZBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGtCQUFrQjtBQUNwRDtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0M7QUFDQTtBQUNBLDhCQUE4QixxQ0FBcUM7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxrQkFBa0I7QUFDcEQ7QUFDQSxvQkFBb0IsdUJBQXVCO0FBQzNDO0FBQ0E7QUFDQSw4QkFBOEIscUNBQXFDO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUM7Ozs7Ozs7QUMxRUEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixxQkFBcUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHFCQUFxQjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLDRCQUE0QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdFQUFnRTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUM7Ozs7Ozs7QUNwTkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsa0JBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHNEQUFzRDtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDREQUE0RCwrREFBK0Q7QUFDM0g7QUFDQSw0Q0FBNEMsOERBQThEO0FBQzFHO0FBQ0EsNENBQTRDLDRDQUE0QztBQUN4RjtBQUNBLGtEQUFrRCxpRkFBaUY7QUFDbkk7QUFDQSw0Q0FBNEMsNkVBQTZFO0FBQ3pIO0FBQ0EsNkM7Ozs7Ozs7QUN2VEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQixTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsa0JBQWtCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRCxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMEM7Ozs7Ozs7QUM5WUE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsNENBQTRDLDZFQUE2RTtBQUN6SDtBQUNBLHFEOzs7Ozs7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGtEOzs7Ozs7O0FDcERBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGNBQWM7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0Qzs7Ozs7OztBQ3BPQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFlBQVk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFlBQVk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixZQUFZO0FBQ3RDO0FBQ0E7QUFDQSwyTUFBMk07QUFDM007QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRkFBcUY7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Qzs7Ozs7Ozs7QUNqaUJBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLGNBQWM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxrQkFBa0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLGFBQWE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQywyQ0FBMkMsb0JBQW9CLEVBQUUsRUFBRTtBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsZ0JBQWdCO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxRQUFRO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGlEQUFpRCxFQUFFO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywyQ0FBMkMsRUFBRTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDhDOzs7Ozs7O0FDL1BBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGtDOzs7Ozs7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCx3Q0FBd0M7QUFDL0Y7QUFDQTtBQUNBLHVEQUF1RCx1Q0FBdUM7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUQ7Ozs7Ozs7QUNyZEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixtQkFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsMEJBQTBCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGtCQUFrQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkM7Ozs7Ozs7QUNuTEEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx3QkFBd0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsNEJBQTRCO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLG9CQUFvQixFQUFFO0FBQ3BEO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQkFBK0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyx3QkFBd0I7QUFDekIsbUM7Ozs7Ozs7O0FDdGhCQSw0RkFBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDJCQUEyQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDJEQUEyRCw0Q0FBNEMsRUFBRTtBQUN6RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrQkFBa0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQywrQkFBK0I7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkM7Ozs7Ozs7O0FDektBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0EscUNBQXFDLHdCQUF3QjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEOzs7Ozs7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSx5Qzs7Ozs7OztBQ2hDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Qsc0M7Ozs7Ozs7QUMvTkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0Esd0M7Ozs7Ozs7QUMzRkEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELGtCQUFrQjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2REFBNkQsc0JBQXNCO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsOENBQThDO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsY0FBYztBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixzQkFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGlCQUFpQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCwwQkFBMEI7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseUJBQXlCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esb0M7Ozs7Ozs7O0FDbmZBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9EOzs7Ozs7O0FDM0RBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVCQUF1QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnQ0FBZ0MsRUFBRTtBQUNuRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG9HQUFvRztBQUN0STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCw0QkFBNEIsRUFBRSxnQkFBZ0IscUJBQXFCLEVBQUU7QUFDdEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxtR0FBbUc7QUFDeEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELGdCQUFnQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELGdCQUFnQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLHFDQUFxQztBQUMxRztBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5Q0FBeUM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHdDQUF3QztBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwwQ0FBMEM7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsdUJBQXVCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx1QkFBdUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVCQUF1QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVCQUF1QjtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUscUNBQXFDO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHdDQUF3QztBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx1QkFBdUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUseUNBQXlDO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1GQUFtRiw0Q0FBNEM7QUFDL0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHVCQUF1QjtBQUMzQztBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsdUJBQXVCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLHlDQUF5Qyx1QkFBdUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxnQ0FBZ0M7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQzs7Ozs7OztBQ3hvQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxvQ0FBb0M7QUFDdkU7QUFDQTtBQUNBLG1DQUFtQyxrQ0FBa0M7QUFDckU7QUFDQSxvQ0FBb0Msa0JBQWtCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzQkFBc0I7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtDQUFrQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0NBQWtDO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHlCQUF5QixFQUFFO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSwyQkFBMkIsRUFBRTtBQUMxRztBQUNBO0FBQ0EscUJBQXFCLDZDQUE2QztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBDQUEwQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsK0JBQStCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLHlCQUF5QjtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCx1QkFBdUIsRUFBRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxnREFBZ0QsZ0VBQWdFLGlDQUFpQyxFQUFFLEVBQUU7QUFDcko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUM7Ozs7Ozs7QUMzd0JBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsOEJBQThCLEVBQUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHVCQUF1QjtBQUMzQztBQUNBO0FBQ0EsMERBQTBELGdCQUFnQixFQUFFO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QywyQkFBMkIsRUFBRTtBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxrREFBa0Q7QUFDdEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLG1CQUFtQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDRCQUE0QjtBQUM3RixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsdUJBQXVCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpQkFBaUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbU9BQW1PO0FBQ25PO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxrQ0FBa0MsRUFBRTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qyw4QkFBOEI7QUFDckUsd0NBQXdDLGtCQUFrQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDJEQUEyRCx5QkFBeUI7QUFDcEY7QUFDQSxvREFBb0QsbUVBQW1FLHNCQUFzQixFQUFFLEVBQUU7QUFDako7QUFDQSxvREFBb0QsbUVBQW1FLHNCQUFzQixFQUFFLEVBQUU7QUFDako7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHFFQUFxRSxxR0FBcUc7QUFDMUs7QUFDQSxnRUFBZ0UsaUdBQWlHO0FBQ2pLO0FBQ0EsZ0ZBQWdGLHVHQUF1RztBQUN2TDtBQUNBLHVDOzs7Ozs7O0FDaG1DQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGlCQUFpQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxxREFBcUQ7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLHdDQUF3QyxFQUFFO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUsOEVBQThFO0FBQ25KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUMsd0NBQXdDO0FBQ3pDLG9DOzs7Ozs7O0FDaDFCQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsa0NBQWtDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsUUFBUTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsa0NBQWtDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsUUFBUTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0M7Ozs7Ozs7QUN6SEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLDJCQUEyQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxvQkFBb0IsRUFBRTtBQUN4RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0JBQW9CLEVBQUU7QUFDeEQsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG9CQUFvQixFQUFFO0FBQ3hELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxvQkFBb0IsRUFBRTtBQUN4RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0JBQW9CLEVBQUU7QUFDeEQsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0JBQW9CLEVBQUU7QUFDeEQsQ0FBQztBQUNEO0FBQ0EsOEM7Ozs7Ozs7QUN6REE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLENBQUM7QUFDRCwyQzs7Ozs7OztBQ2xIQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywwREFBMEQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxxRkFBcUY7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQzs7Ozs7OztBQy9IQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0Usc0ZBQXNGO0FBQzFKO0FBQ0EsK0VBQStFLFdBQVcsRUFBRTtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsbUlBQW1JO0FBQ3ZNO0FBQ0EsZ0ZBQWdGLFlBQVksRUFBRTtBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsVUFBVSxvQ0FBb0MsRUFBRSxFQUFFO0FBQ2xJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsdUJBQXVCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtSEFBbUg7QUFDbkg7QUFDQTtBQUNBO0FBQ0EsdUhBQXVIO0FBQ3ZIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsNEJBQTRCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHVDOzs7Ozs7O0FDblJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyx3Q0FBd0M7QUFDbkYsMENBQTBDLHVDQUF1QztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZ0VBQWdFLG1JQUFtSSxpQ0FBaUMsRUFBRSxFQUFFO0FBQ3hPO0FBQ0E7QUFDQSx5REFBeUQsOERBQThEO0FBQ3ZIO0FBQ0E7QUFDQSwwREFBMEQsZ0VBQWdFO0FBQzFIO0FBQ0EscURBQXFELHFGQUFxRjtBQUMxSTtBQUNBLDhEQUE4RCx5REFBeUQ7QUFDdkg7QUFDQTtBQUNBLG1FQUFtRSw2R0FBNkc7QUFDaEw7QUFDQSx3REFBd0Qsb0VBQW9FO0FBQzVIO0FBQ0EsaURBQWlELGlDQUFpQztBQUNsRjtBQUNBLHNEQUFzRCxzRkFBc0Y7QUFDNUk7QUFDQSxxRDs7Ozs7OztBQ2pEQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsc0RBQXNEO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELGNBQWM7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrRDs7Ozs7OztBQzNMQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsbUVBQW1FO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzRUFBc0U7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsc0VBQXNFO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlFQUF5RTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnRUFBZ0U7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0ZBQWtGO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0ZBQXdGO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0ZBQWtGO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsb0RBQW9EO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0ZBQWtGO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx1REFBdUQ7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywyQ0FBMkM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxpR0FBaUc7QUFDbEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsb0dBQW9HO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlIQUF5SDtBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywwR0FBMEc7QUFDM0c7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhGQUE4RjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnRUFBZ0U7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBEQUEwRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw2REFBNkQ7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMseUVBQXlFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUUsaUM7Ozs7Ozs7QUMzTEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsb0dBQW9HO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0Q7Ozs7Ozs7QUNyRkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLDhCQUE4QixFQUFFO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELDhCQUE4QixFQUFFO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCwwQ0FBMEMsRUFBRTtBQUN2RztBQUNBLGtGQUFrRixnREFBZ0QsRUFBRTtBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0ZBQStGO0FBQy9GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0dBQWdHO0FBQ2hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDBCQUEwQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDRCQUE0QjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsZ0NBQWdDO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSwyREFBMkQsb0NBQW9DLEVBQUU7QUFDakc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkRBQTJELGlGQUFpRjtBQUM1STtBQUNBLHdDOzs7Ozs7O0FDM2tCQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUM7Ozs7Ozs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0hBQXdIO0FBQ3hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMEJBQTBCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEhBQTBIO0FBQzFIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlLQUFpSztBQUNqSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0hBQW9IO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlIQUFpSDtBQUNqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCxnQ0FBZ0M7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0REFBNEQ7QUFDM0YsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1SUFBdUk7QUFDdkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3SUFBd0k7QUFDeEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4R0FBOEc7QUFDOUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3SUFBd0k7QUFDeEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCxxQzs7Ozs7OztBQ3hpQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLG1FQUFtRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtGQUFrRjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlFQUF5RTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdFQUFnRTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGlCQUFpQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkM7Ozs7Ozs7QUMzSUE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGlCQUFpQixFQUFFO0FBQ25ELGdDQUFnQyxpQkFBaUIsRUFBRTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsaUJBQWlCO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHdDOzs7Ozs7O0FDL2FBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDRDQUE0QyxzREFBc0Q7QUFDbEc7QUFDQSw0Qzs7Ozs7OztBQ3BCQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3SUFBd0k7QUFDeEk7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHlDOzs7Ozs7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLG1EQUFtRCxzQkFBc0I7QUFDekU7QUFDQSwyQ0FBMkMsY0FBYztBQUN6RDtBQUNBLGdEQUFnRCx5Q0FBeUM7QUFDekY7QUFDQSxpREFBaUQsa0ZBQWtGO0FBQ25JO0FBQ0EsK0NBQStDLDBFQUEwRTtBQUN6SDtBQUNBLDZEQUE2RCxvSEFBb0gsZ0NBQWdDLEVBQUUsRUFBRTtBQUNyTjtBQUNBLG9EQUFvRCxzQ0FBc0Msd0JBQXdCLHVDQUF1QztBQUN6SjtBQUNBLG1EQUFtRCxxQ0FBcUMsd0JBQXdCLHVDQUF1QztBQUN2SjtBQUNBLHdDOzs7Ozs7O0FDdkpBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxxQzs7Ozs7OztBQ2xJQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsOEJBQThCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxxQzs7Ozs7OztBQ3ZNQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxnQ0FBZ0Msc0NBQXNDO0FBQzNFLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdDQUFnQyxzQ0FBc0M7QUFDM0UsQ0FBQztBQUNEO0FBQ0Esa0Q7Ozs7Ozs7QUNoRUE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLCtDOzs7Ozs7O0FDekRBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDhDOzs7Ozs7O0FDaERBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkM7Ozs7Ozs7QUMxSEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsdURBQXVEO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMseUVBQXlFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLENBQUMsK0VBQStFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDhDQUE4QztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx1REFBdUQ7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHlFQUF5RTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsMERBQTBEO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLCtEQUErRCw2SkFBNko7QUFDNU47QUFDQSwwREFBMEQscUlBQXFJO0FBQy9MO0FBQ0EsZ0VBQWdFLHdLQUF3SztBQUN4TztBQUNBLDREQUE0RCxxSkFBcUo7QUFDak47QUFDQSw4REFBOEQsNkpBQTZKO0FBQzNOO0FBQ0EsdURBQXVELG9HQUFvRztBQUMzSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMERBQTBELGtIQUFrSDtBQUM1SztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsNERBQTRELDBIQUEwSDtBQUN0TDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0VBQWdFLGlIQUFpSDtBQUNqTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMkRBQTJELDBHQUEwRztBQUNySztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxpRDs7Ozs7OztBQ3ZXQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsbUJBQW1CLEVBQUU7QUFDL0M7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQixrQkFBa0IsRUFBRTtBQUM5QztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLG9CQUFvQixFQUFFO0FBQ2hEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwwQkFBMEIscUJBQXFCLEVBQUU7QUFDakQ7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQix1QkFBdUIsRUFBRTtBQUNuRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLHdCQUF3QixFQUFFO0FBQ3BEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwwQkFBMEIsd0JBQXdCLEVBQUU7QUFDcEQ7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQiw0QkFBNEIsRUFBRTtBQUN4RDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLDhCQUE4QixFQUFFO0FBQzFEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyx1QkFBdUIsRUFBRTtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGdCQUFnQjtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGdCQUFnQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixnQkFBZ0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHVDQUF1QztBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdCQUF3QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0JBQXdCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0ZBQW9GLG1CQUFtQjtBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1GQUFtRixrQkFBa0I7QUFDckc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLGtCQUFrQjtBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQix3QkFBd0I7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSx5Q0FBeUMsRUFBRTtBQUMzRztBQUNBO0FBQ0EsZ0VBQWdFLGtDQUFrQyxFQUFFO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHdCQUF3QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix3QkFBd0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzRUFBc0U7QUFDdkU7QUFDQSw4Qzs7Ozs7OztBQzl0Q0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsY0FBYztBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxRQUFRO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsUUFBUTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsMkJBQTJCLEVBQUU7QUFDdEYsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsOEJBQThCLEVBQUU7QUFDekYsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsa0NBQWtDLGlDQUFpQztBQUNuRSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0MsaUNBQWlDO0FBQ25FLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGtDQUFrQyxpQ0FBaUM7QUFDbkUsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsa0NBQWtDLGlDQUFpQztBQUNuRSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsbUVBQW1FO0FBQ3BFLDhDOzs7Ozs7O0FDaldBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELFVBQVU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELFVBQVU7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxhQUFhO0FBQzFFO0FBQ0EsbUVBQW1FLGNBQWM7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsVUFBVTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsVUFBVTtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsVUFBVTtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsVUFBVTtBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxVQUFVO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxVQUFVO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELFVBQVU7QUFDN0Q7QUFDQTtBQUNBLGdEQUFnRCxVQUFVO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCxVQUFVO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsVUFBVTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGlCQUFpQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixjQUFjO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxjQUFjO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsVUFBVTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RSxtQkFBbUI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxVQUFVO0FBQzdEO0FBQ0Esd0VBQXdFLG1CQUFtQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELFVBQVU7QUFDN0Q7QUFDQSx3RUFBd0UsbUJBQW1CO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixVQUFVO0FBQ2pDO0FBQ0Esd0VBQXdFLG1CQUFtQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixVQUFVO0FBQ2pDO0FBQ0Esd0VBQXdFLG1CQUFtQjtBQUMzRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsVUFBVTtBQUNqQztBQUNBLHFFQUFxRSxnQkFBZ0I7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsbUJBQW1CO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsbUJBQW1CO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxnQkFBZ0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCxnQkFBZ0I7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUJBQW1CO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0JBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsZ0JBQWdCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QixnQkFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG1CQUFtQjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLG1CQUFtQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtQkFBbUI7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsZ0JBQWdCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0JBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxtQkFBbUI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQzs7Ozs7OztBQ252QkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0NBQXdDO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsY0FBYztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxvREFBb0Qsb0ZBQW9GO0FBQ3hJO0FBQ0Esa0VBQWtFLG1HQUFtRztBQUNySztBQUNBLDhDOzs7Ozs7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkM7Ozs7Ozs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsK0dBQStHO0FBQ3pLO0FBQ0EsK0M7Ozs7Ozs7QUNyQkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDRDOzs7Ozs7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsK0dBQStHLHNDQUFzQyxFQUFFO0FBQ3ZKLHlEQUF5RCxzRkFBc0Y7QUFDL0ksQ0FBQztBQUNEO0FBQ0E7QUFDQSxnSEFBZ0gsc0NBQXNDLEVBQUU7QUFDeEoseURBQXlELHVGQUF1RjtBQUNoSixDQUFDO0FBQ0Q7QUFDQTtBQUNBLDBEQUEwRCxpSEFBaUg7QUFDM0s7QUFDQSw4Qzs7Ozs7OztBQy9CQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwyQzs7Ozs7OztBQ3BLQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG9CQUFvQixFQUFFO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsOEM7Ozs7Ozs7QUNuRkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUhBQWlIO0FBQ2pIO0FBQ0E7QUFDQSwyRkFBMkY7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsMkM7Ozs7Ozs7QUMzSEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx3RkFBd0Y7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxjQUFjO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxjQUFjO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0EsaUVBQWlFLCtCQUErQjtBQUNoRyxDQUFDO0FBQ0Q7QUFDQSx5REFBeUQsMEhBQTBILDRCQUE0QixFQUFFLEVBQUU7QUFDbk47QUFDQSw0Qzs7Ozs7OztBQzlMQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwwQ0FBMEM7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLDBDQUEwQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpQkFBaUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxtQ0FBbUMsRUFBRTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsY0FBYztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSx5Qzs7Ozs7OztBQzdhQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLCtEQUErRCxnSEFBZ0g7QUFDL0s7QUFDQSw0RUFBNEUsa0pBQWtKO0FBQzlOO0FBQ0EseUVBQXlFLHlHQUF5RztBQUNsTDtBQUNBLGlFQUFpRSxzREFBc0Q7QUFDdkg7QUFDQTtBQUNBO0FBQ0EsaUZBQWlGLG9DQUFvQztBQUNySCxDQUFDO0FBQ0Q7QUFDQSx1Qzs7Ozs7OztBQzlLQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RDtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDRCQUE0QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDhFQUE4RTtBQUMvSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0M7Ozs7Ozs7QUMxWEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHVDOzs7Ozs7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsa0NBQWtDLG9CQUFvQjtBQUN0RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGtDQUFrQyxvQkFBb0I7QUFDdEQsQ0FBQztBQUNEO0FBQ0EsMkM7Ozs7Ozs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHdDOzs7Ozs7O0FDdERBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZ0Q7Ozs7Ozs7QUN4SEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMseUVBQXlFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFlBQVk7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9DOzs7Ozs7O0FDOUlBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsOEM7Ozs7Ozs7QUM3R0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsMkM7Ozs7Ozs7QUNuTEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDRDQUE0Qyw4REFBOEQ7QUFDMUc7QUFDQSw0Q0FBNEMsaUNBQWlDO0FBQzdFO0FBQ0EsMERBQTBELGtHQUFrRyw0QkFBNEIsRUFBRSxFQUFFO0FBQzVMO0FBQ0EsZ0VBQWdFLHdHQUF3Ryw0QkFBNEIsRUFBRSxFQUFFO0FBQ3hNO0FBQ0EsNkM7Ozs7Ozs7QUM1QkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7O0FDOU1BO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELFdBQVc7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0QsV0FBVztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixnSEFBZ0g7QUFDdkksS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msb0JBQW9CO0FBQ3RELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkVBQTJFLDZJQUE2SSw0QkFBNEIsRUFBRSxFQUFFO0FBQ3hQO0FBQ0EsZ0Q7Ozs7Ozs7QUN2SUE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsQ0FBQztBQUNELDZDOzs7Ozs7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdDQUFnQyxtREFBbUQ7QUFDeEYsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdDQUFnQyxtREFBbUQ7QUFDeEYsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wseURBQXlELDZDQUE2QyxFQUFFO0FBQ3hHLGtDQUFrQyxtREFBbUQ7QUFDckYsQ0FBQztBQUNEO0FBQ0EseUM7Ozs7Ozs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHNDOzs7Ozs7O0FDOUZBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCwyQkFBMkIsMkJBQTJCLDZCQUE2QixpQ0FBaUMseUJBQXlCLDZDQUE2QyxpREFBaUQsbURBQW1ELCtDQUErQyw2Q0FBNkMsaURBQWlELG1EQUFtRCwrQ0FBK0MsdURBQXVELHlEQUF5RCwrREFBK0QsNkRBQTZELGlDQUFpQztBQUMxMEI7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsNkM7Ozs7Ozs7QUNsT0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0NBQXdDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCx5Q0FBeUM7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmLGVBQWU7QUFDZixlQUFlO0FBQ2YsZUFBZTtBQUNmLGVBQWU7QUFDZixlQUFlO0FBQ2YsZUFBZTtBQUNmLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEMsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnQkFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDOzs7Ozs7O0FDM3JCQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDOzs7Ozs7O0FDakRBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsMEJBQTBCLEVBQUU7QUFDMUUsa0RBQWtELDBEQUEwRCxFQUFFO0FBQzlHLCtDQUErQyx1REFBdUQsRUFBRTtBQUN4Ryx5REFBeUQsMEVBQTBFLEVBQUU7QUFDckkseURBQXlELHNGQUFzRixFQUFFO0FBQ2pKLG1EQUFtRCw2Q0FBNkMsRUFBRTtBQUNsRyxtREFBbUQsK0NBQStDO0FBQ2xHLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQseUJBQXlCO0FBQzFFO0FBQ0E7QUFDQSxrREFBa0QsZ0JBQWdCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGdCQUFnQjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0NBQWdDLEVBQUU7QUFDdEU7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLHNCQUFzQjtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxJQUFJO0FBQ1QsOERBQThELFVBQVUsb0RBQW9ELEVBQUUsRUFBRTtBQUNoSTtBQUNBO0FBQ0EsZ0Q7Ozs7Ozs7QUM1SUEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNCQUFzQjtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLGlCQUFpQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLHNDQUFzQztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCx5QkFBeUI7QUFDbEY7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Qsa0NBQWtDO0FBQ3hGLHVEQUF1RCxjQUFjO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBd0Qsb0NBQW9DO0FBQzVGLHlEQUF5RCxhQUFhO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsOENBQThDO0FBQy9GLGtEQUFrRCw0QkFBNEI7QUFDOUUsK0RBQStELHdDQUF3QztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGtEQUFrRDtBQUNyRyxvREFBb0Qsc0NBQXNDO0FBQzFGLGlFQUFpRSwrQ0FBK0M7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxvREFBb0Q7QUFDeEcscURBQXFELDhEQUE4RDtBQUNuSCxrRUFBa0UsaURBQWlEO0FBQ25IO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxvREFBb0Q7QUFDL0Y7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLGNBQWM7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELGNBQWM7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLDBDQUEwQztBQUNyRjtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsY0FBYztBQUN6RDtBQUNBO0FBQ0E7QUFDQSx3REFBd0QsaUhBQWlIO0FBQ3pLLHlEQUF5RCxjQUFjO0FBQ3ZFLDREQUE0RCxhQUFhO0FBQ3pFLHFFQUFxRSx3Q0FBd0M7QUFDN0c7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCwwREFBMEQ7QUFDcEgsMkRBQTJELGdGQUFnRjtBQUMzSSw4REFBOEQsYUFBYTtBQUMzRSx1RUFBdUUsK0NBQStDO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSw4QkFBOEIsRUFBRTtBQUNsRyxtRUFBbUUsMkRBQTJELEVBQUU7QUFDaEksdURBQXVELG9CQUFvQixFQUFFO0FBQzdFO0FBQ0E7QUFDQSw2REFBNkQsNkRBQTZEO0FBQzFILDhEQUE4RCw2Q0FBNkMsd0JBQXdCLEVBQUUsRUFBRTtBQUN2STtBQUNBLG9EQUFvRCwyQkFBMkIsRUFBRTtBQUNqRjtBQUNBO0FBQ0EsK0NBQStDLG9DQUFvQyxFQUFFO0FBQ3JGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQSxrRUFBa0UsOEJBQThCLEVBQUU7QUFDbEcsdURBQXVELG9CQUFvQixFQUFFO0FBQzdFO0FBQ0E7QUFDQSwrQ0FBK0MsZ0NBQWdDO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsMEJBQTBCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsOEJBQThCO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsd0JBQXdCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsb0JBQW9CLEVBQUU7QUFDaEY7QUFDQTtBQUNBLDJEQUEyRCxtRUFBbUUsRUFBRTtBQUNoSTtBQUNBO0FBQ0EsMkRBQTJELHNFQUFzRSxFQUFFO0FBQ25JO0FBQ0E7QUFDQSxzREFBc0QsNkVBQTZFLEVBQUU7QUFDckk7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxvQkFBb0IsRUFBRTtBQUNoRjtBQUNBO0FBQ0EsMkRBQTJELGdGQUFnRixFQUFFO0FBQzdJO0FBQ0E7QUFDQSwyREFBMkQsbUZBQW1GLEVBQUU7QUFDaEo7QUFDQTtBQUNBLHNEQUFzRCw0RkFBNEYsRUFBRTtBQUNwSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQyx1REFBdUQ7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLDRCQUE0QixFQUFFO0FBQzdFO0FBQ0EsOENBQThDLHVDQUF1QywyQ0FBMkMsZ0VBQWdFLEVBQUUsU0FBUyxTQUFTLEVBQUU7QUFDdE4sc0RBQXNELHdDQUF3QywrQkFBK0IsRUFBRSxFQUFFO0FBQ2pJO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsZ0JBQWdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLCtCQUErQixFQUFFO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCw2Q0FBNkMsRUFBRTtBQUNqRztBQUNBO0FBQ0Esb0NBQW9DLGNBQWMsRUFBRTtBQUNwRCwwQ0FBMEMseUJBQXlCLEVBQUU7QUFDckU7QUFDQTtBQUNBLG9DQUFvQyx3REFBd0QsRUFBRTtBQUM5RixtQ0FBbUMsK0RBQStELEVBQUU7QUFDcEcsb0NBQW9DLG1CQUFtQixFQUFFO0FBQ3pEO0FBQ0E7QUFDQSwwREFBMEQsaUNBQWlDO0FBQzNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxnREFBZ0Q7QUFDN0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esd0M7Ozs7Ozs7QUNuaUJBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDBEQUEwRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNkRBQTZEO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixrQkFBa0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0ZBQXdGO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHdCQUF3QixFQUFFO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLHlCQUF5QixFQUFFO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDOzs7Ozs7O0FDN0lBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHlCQUF5QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0NBQXdDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0M7Ozs7Ozs7QUNsTUEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsNkJBQTZCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDJDOzs7Ozs7O0FDcERBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLG1CQUFtQjtBQUM3QywwQ0FBMEMsbUNBQW1DO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxzRUFBc0U7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxpREFBaUQ7QUFDbEQsc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkRBQTJELHNMQUFzTDtBQUNqUDtBQUNBLDREQUE0RCx3TEFBd0w7QUFDcFA7QUFDQSwwREFBMEQsb0xBQW9MO0FBQzlPO0FBQ0EsNkRBQTZELDBMQUEwTDtBQUN2UDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHdGQUF3RjtBQUN6RixvRUFBb0Usa0xBQWtMO0FBQ3RQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QseUZBQXlGO0FBQ3pJO0FBQ0EsQ0FBQyxrRkFBa0Y7QUFDbkYsa0VBQWtFLDBLQUEwSztBQUM1TztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsaUZBQWlGO0FBQ2pKO0FBQ0EsZ0VBQWdFLGlGQUFpRjtBQUNqSjtBQUNBLGdFQUFnRSxpRkFBaUY7QUFDako7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0VBQW9FLHdGQUF3RjtBQUM1SjtBQUNBLG9FQUFvRSx3RkFBd0Y7QUFDNUo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsZ0JBQWdCLGFBQWE7QUFDN0I7QUFDQSxZQUFZLGFBQWE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixVQUFVLGtDQUFrQyxFQUFFLEVBQUU7QUFDL0UsaUNBQWlDLFVBQVUsa0NBQWtDLEVBQUUsRUFBRTtBQUNqRjtBQUNBO0FBQ0EsaUJBQWlCLDRCQUE0QiwyQ0FBMkMsRUFBRTtBQUMxRixLQUFLO0FBQ0w7QUFDQTtBQUNBLGlCQUFpQiw0QkFBNEIsMkNBQTJDLEVBQUU7QUFDMUYsS0FBSztBQUNMLG1DQUFtQyxVQUFVLHNDQUFzQyxFQUFFLEVBQUU7QUFDdkYscUNBQXFDLFVBQVUsc0NBQXNDLEVBQUUsRUFBRTtBQUN6RjtBQUNBO0FBQ0EsaUJBQWlCLGdDQUFnQywrQ0FBK0MsRUFBRTtBQUNsRyxLQUFLO0FBQ0w7QUFDQTtBQUNBLGlCQUFpQixnQ0FBZ0MsK0NBQStDLEVBQUU7QUFDbEcsS0FBSztBQUNMLGdDQUFnQyxVQUFVLG1DQUFtQyxFQUFFLEVBQUU7QUFDakYsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCxtQkFBbUIsRUFBRTtBQUNoRjtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELG1DQUFtQztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyw0RUFBNEUsaUNBQWlDO0FBQ2xILENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsNEVBQTRFO0FBQ25JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUseUZBQXlGO0FBQzFKO0FBQ0EsK0RBQStELHdHQUF3Ryw2QkFBNkIsRUFBRSxFQUFFO0FBQ3hNO0FBQ0EsNkRBQTZELG9GQUFvRjtBQUNqSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msc0JBQXNCO0FBQ3hELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyx1RkFBdUY7QUFDaEk7QUFDQSxDQUFDLDZEQUE2RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLGlFQUFpRSxxRkFBcUY7QUFDdEo7QUFDQSw4RUFBOEUsaUhBQWlIO0FBQy9MO0FBQ0EsNEM7Ozs7Ozs7QUMzaUNBLDRGQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix3QkFBd0IsRUFBRTtBQUNwRDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLHFCQUFxQixFQUFFO0FBQ2pEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELHFCQUFxQjtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEVBQTRFLDRCQUE0QixFQUFFO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBLFNBQVMsRUFBRTtBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxzREFBc0QsdUNBQXVDLEVBQUU7QUFDL0YscURBQXFELHdCQUF3QixFQUFFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBELDJDQUEyQyxFQUFFO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsbUJBQW1CLDJDQUEyQztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsbUJBQW1CO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSx3QkFBd0Isa0dBQWtHO0FBQzFIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsbUNBQW1DO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLDZDQUE2QyxFQUFFO0FBQzVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLDhCQUE4QjtBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsK0JBQStCLEVBQUU7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLDRCQUE0QixFQUFFO0FBQ3hFLDJDQUEyQywyQkFBMkIsRUFBRTtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5RkFBeUYsMkJBQTJCLEVBQUU7QUFDdEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsWUFBWSxFQUFFLGtDQUFrQyw0QkFBNEIsRUFBRTtBQUNsSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxRQUFRO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDBCQUEwQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsK0JBQStCLEVBQUU7QUFDL0Q7QUFDQSx3Q0FBd0MsbUZBQW1GLEVBQUU7QUFDN0g7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDOzs7Ozs7OztBQ2x0QkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELGlDOzs7Ozs7O0FDekNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHdIQUF3SDtBQUN2SztBQUNBLDBEQUEwRCxtR0FBbUcsNkJBQTZCLEVBQUUsRUFBRTtBQUM5TDtBQUNBLHlDOzs7Ozs7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxzQzs7Ozs7OztBQ25HQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG1EOzs7Ozs7O0FDakRBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZ0Q7Ozs7Ozs7QUN0QkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGdDQUFnQyxFQUFFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsZ0NBQWdDLEVBQUU7QUFDekY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLCtHQUErRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msb0JBQW9CO0FBQ3RELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwrQzs7Ozs7OztBQ3RMQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7O0FDMUhBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELCtGQUErRiw2QkFBNkIsRUFBRSxFQUFFO0FBQ3RMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0REFBNEQsMERBQTBEO0FBQ3RIO0FBQ0E7QUFDQSxxQzs7Ozs7OztBQ3ZGQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsK0VBQStFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGdDQUFnQyxFQUFFO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiwyR0FBMkc7QUFDaEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0Msb0JBQW9CO0FBQ3RELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsNERBQTRELDBEQUEwRDtBQUN0SDtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0JBQW9CO0FBQ3RELENBQUM7QUFDRDtBQUNBLDJEQUEyRCxtREFBbUQ7QUFDOUc7QUFDQSwyREFBMkQsMkZBQTJGO0FBQ3RKO0FBQ0EsMERBQTBELHVGQUF1RixzQkFBc0IsRUFBRSxFQUFFO0FBQzNLO0FBQ0EsdURBQXVELHVIQUF1SCw0QkFBNEIsRUFBRSxFQUFFO0FBQzlNO0FBQ0EsNkRBQTZELG1JQUFtSSw0QkFBNEIsRUFBRSxFQUFFO0FBQ2hPO0FBQ0EsK0RBQStELHdJQUF3SSw0QkFBNEIsRUFBRSxFQUFFO0FBQ3ZPO0FBQ0EsMkVBQTJFLGlLQUFpSyw0QkFBNEIsRUFBRSxFQUFFO0FBQzVRO0FBQ0EsMkM7Ozs7Ozs7QUN0UkE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCwrQ0FBK0MsRUFBRTtBQUN6RztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJIQUEySDtBQUMzSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0hBQXdIO0FBQ3hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2SkFBNko7QUFDN0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEpBQTRKO0FBQzVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCx3Q0FBd0M7QUFDL0Y7QUFDQTtBQUNBLHVEQUF1RCx1Q0FBdUM7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3QkFBd0I7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELGNBQWM7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7OztBQ3BmQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsOEVBQThFLG9CQUFvQjtBQUNsRyxDQUFDO0FBQ0Q7QUFDQSwwREFBMEQsNENBQTRDO0FBQ3RHO0FBQ0EsdUM7Ozs7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsb0JBQW9CO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixlQUFlO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHVCQUF1QixFQUFFO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9DOzs7Ozs7O0FDbmZBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGVBQWU7QUFDOUM7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsa0VBQWtFO0FBQzlHO0FBQ0EscURBQXFELDJGQUEyRjtBQUNoSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnSEFBZ0g7QUFDakw7QUFDQTtBQUNBLHdEQUF3RCxvSEFBb0g7QUFDNUs7QUFDQTtBQUNBLHFEQUFxRCx3SUFBd0k7QUFDN0w7QUFDQTtBQUNBLHlEQUF5RCxvSEFBb0g7QUFDN0s7QUFDQSx3REFBd0QsK0hBQStILHNCQUFzQixFQUFFLEVBQUU7QUFDak47QUFDQSxxREFBcUQsd0dBQXdHLHNCQUFzQixFQUFFLEVBQUU7QUFDdkw7QUFDQTtBQUNBLDRDOzs7Ozs7O0FDelBBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZUFBZTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9JQUFvSSx1Q0FBdUM7QUFDM0s7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRGQUE0Rix1Q0FBdUM7QUFDbkk7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RkFBNEYsdUNBQXVDO0FBQ25JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMscUNBQXFDO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1GQUFtRixjQUFjO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Qzs7Ozs7OztBQ2pTQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDREQUE0RCw2RkFBNkY7QUFDeko7QUFDQSw2Qzs7Ozs7OztBQ3JCQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpREFBaUQ7QUFDM0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix1REFBdUQ7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwQzs7Ozs7OztBQ3RPQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsZ0RBQWdEO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRDtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSx5Qzs7Ozs7OztBQzlTQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0Esb0NBQW9DLDJCQUEyQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxnQ0FBZ0Msb0JBQW9CO0FBQ3pELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdDQUFnQyxvQkFBb0I7QUFDekQsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssZ0NBQWdDLG9CQUFvQjtBQUN6RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxnQ0FBZ0Msb0JBQW9CO0FBQ3pELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLGdDQUFnQyxvQkFBb0I7QUFDekQsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxnQ0FBZ0Msb0JBQW9CO0FBQ3pELENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssZ0NBQWdDLG9CQUFvQjtBQUN6RCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw4Qzs7Ozs7OztBQ3RKQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBLENBQUM7QUFDRCwyQzs7Ozs7OztBQ3pJQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLCtDOzs7Ozs7O0FDbkNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZ0Q7Ozs7Ozs7QUNqRUEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLFdBQVc7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDBDOzs7Ozs7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxjQUFjO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDJDOzs7Ozs7O0FDcEZBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsdUNBQXVDLG1EQUFtRCw0REFBNEQ7QUFDdk47QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHdDOzs7Ozs7O0FDakxBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsa0JBQWtCLEVBQUU7QUFDOUM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQixtQkFBbUIsRUFBRTtBQUMvQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsMEJBQTBCLHFCQUFxQixFQUFFO0FBQ2pEO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxpQzs7Ozs7OztBQzlFQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUQ7Ozs7Ozs7QUNUQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLDRCQUE0QjtBQUNyRSx5Q0FBeUMsNEJBQTRCO0FBQ3JFLHdDOzs7Ozs7O0FDaENBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxHQUFHO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDOzs7Ozs7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLEVBQUU7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsbUVBQW1FO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxzQ0FBc0MsRUFBRTtBQUNqRjtBQUNBO0FBQ0E7QUFDQSx3Qzs7Ozs7OztBQ3JMQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGlEQUFpRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsV0FBVztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLHdEQUF3RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx3Q0FBd0M7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLHFDOzs7Ozs7O0FDOUtBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnRUFBZ0U7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELDZCQUE2QjtBQUM3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywyQkFBMkI7QUFDL0QsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDJCQUEyQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVELDZCQUE2QixFQUFFO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsK0I7Ozs7Ozs7QUNuVUEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxrQ0FBa0MsMEJBQTBCLFFBQVE7QUFDcEU7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCxRQUFRO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLCtCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzdQQTtBQUFBO0FBQ0E7QUFDQSwrREFBK0Q7QUFDL0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsVUFBVSxnQkFBZ0Isc0NBQXNDLGlCQUFpQixFQUFFO0FBQ25GLHlCQUF5Qix1REFBdUQ7QUFDaEY7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsbUJBQW1CLHNCQUFzQjtBQUN6QztBQUNBOztBQUVBO0FBQ0E7QUFDQSxnREFBZ0QsT0FBTztBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNERBQTRELGNBQWM7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsUUFBUTtBQUNwRDtBQUNBOztBQUVBO0FBQ0EsbUNBQW1DLG9DQUFvQztBQUN2RTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1DQUFtQyxNQUFNLDZCQUE2QixFQUFFLFlBQVksV0FBVyxFQUFFO0FBQ2pHLGtDQUFrQyxNQUFNLGlDQUFpQyxFQUFFLFlBQVksV0FBVyxFQUFFO0FBQ3BHLCtCQUErQixpRUFBaUUsdUJBQXVCLEVBQUUsNEJBQTRCO0FBQ3JKO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0EsYUFBYSw2QkFBNkIsMEJBQTBCLGFBQWEsRUFBRSxxQkFBcUI7QUFDeEcsZ0JBQWdCLHFEQUFxRCxvRUFBb0UsYUFBYSxFQUFFO0FBQ3hKLHNCQUFzQixzQkFBc0IscUJBQXFCLEdBQUc7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDLGtDQUFrQyxTQUFTO0FBQzNDLGtDQUFrQyxXQUFXLFVBQVU7QUFDdkQseUNBQXlDLGNBQWM7QUFDdkQ7QUFDQSw2R0FBNkcsT0FBTyxVQUFVO0FBQzlILGdGQUFnRixpQkFBaUIsT0FBTztBQUN4Ryx3REFBd0QsZ0JBQWdCLFFBQVEsT0FBTztBQUN2Riw4Q0FBOEMsZ0JBQWdCLGdCQUFnQixPQUFPO0FBQ3JGO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxTQUFTLFlBQVksYUFBYSxPQUFPLEVBQUUsVUFBVSxXQUFXO0FBQ2hFLG1DQUFtQyxTQUFTO0FBQzVDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsTUFBTSxnQkFBZ0I7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsc0JBQXNCO0FBQ3ZDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRCQUE0QixzQkFBc0I7QUFDbEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaURBQWlELFFBQVE7QUFDekQsd0NBQXdDLFFBQVE7QUFDaEQsd0RBQXdELFFBQVE7QUFDaEU7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsc0ZBQXNGLGFBQWEsRUFBRTtBQUN0SCxzQkFBc0IsZ0NBQWdDLHFDQUFxQywwQ0FBMEMsRUFBRSxFQUFFLEdBQUc7QUFDNUksMkJBQTJCLE1BQU0sZUFBZSxFQUFFLFlBQVksb0JBQW9CLEVBQUU7QUFDcEYsc0JBQXNCLG9HQUFvRztBQUMxSCw2QkFBNkIsdUJBQXVCO0FBQ3BELDRCQUE0Qix3QkFBd0I7QUFDcEQsMkJBQTJCLHlEQUF5RDtBQUNwRjs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCLDRDQUE0QyxTQUFTLEVBQUUscURBQXFELGFBQWEsRUFBRTtBQUM1SSx5QkFBeUIsNkJBQTZCLG9CQUFvQixnREFBZ0QsZ0JBQWdCLEVBQUUsS0FBSztBQUNqSjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyR0FBMkcsc0ZBQXNGLGFBQWEsRUFBRTtBQUNoTixzQkFBc0IsOEJBQThCLGdEQUFnRCx1REFBdUQsRUFBRSxFQUFFLEdBQUc7QUFDbEssNENBQTRDLHNDQUFzQyxVQUFVLG9CQUFvQixFQUFFLEVBQUUsVUFBVTtBQUM5SDs7QUFFQTtBQUNBLGdDQUFnQyx1Q0FBdUMsYUFBYSxFQUFFLEVBQUUsT0FBTyxrQkFBa0I7QUFDakg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRDQUE0QztBQUM1QyIsImZpbGUiOiJ2ZW5kb3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXG4qL1xuLy8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odXNlU291cmNlTWFwKSB7XG5cdHZhciBsaXN0ID0gW107XG5cblx0Ly8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xuXHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHR2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblx0XHRcdGlmKGl0ZW1bMl0pIHtcblx0XHRcdFx0cmV0dXJuIFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgY29udGVudCArIFwifVwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGNvbnRlbnQ7XG5cdFx0XHR9XG5cdFx0fSkuam9pbihcIlwiKTtcblx0fTtcblxuXHQvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuXHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XG5cdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXG5cdFx0XHRtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCBcIlwiXV07XG5cdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGlkID0gdGhpc1tpXVswXTtcblx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcblx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuXHRcdH1cblx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XG5cdFx0XHQvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXG5cdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xuXHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cblx0XHRcdC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xuXHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IG1lZGlhUXVlcnk7XG5cdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XG5cdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cdHJldHVybiBsaXN0O1xufTtcblxuZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcblx0dmFyIGNvbnRlbnQgPSBpdGVtWzFdIHx8ICcnO1xuXHR2YXIgY3NzTWFwcGluZyA9IGl0ZW1bM107XG5cdGlmICghY3NzTWFwcGluZykge1xuXHRcdHJldHVybiBjb250ZW50O1xuXHR9XG5cblx0aWYgKHVzZVNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuXHRcdHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG5cdFx0XHRyZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gW2NvbnRlbnRdLmNvbmNhdChzb3VyY2VVUkxzKS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKCdcXG4nKTtcblx0fVxuXG5cdHJldHVybiBbY29udGVudF0uam9pbignXFxuJyk7XG59XG5cbi8vIEFkYXB0ZWQgZnJvbSBjb252ZXJ0LXNvdXJjZS1tYXAgKE1JVClcbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG5cdHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpO1xuXHR2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuXG5cdHJldHVybiAnLyojICcgKyBkYXRhICsgJyAqLyc7XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IGhvdCA9IHJlcXVpcmUoXCIuLi9ob3RcIik7XG5jb25zdCBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcInRucy1jb3JlLW1vZHVsZXMvZmlsZS1zeXN0ZW1cIik7XG5mdW5jdGlvbiBobXJVcGRhdGUoKSB7XG4gICAgY29uc3QgYXBwbGljYXRpb25GaWxlcyA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKTtcbiAgICBjb25zdCBsYXRlc3RIYXNoID0gX193ZWJwYWNrX3JlcXVpcmVfX1tcImhcIl0oKTtcbiAgICByZXR1cm4gaG90KGxhdGVzdEhhc2gsIGZpbGVuYW1lID0+IGFwcGxpY2F0aW9uRmlsZXMuZ2V0RmlsZShmaWxlbmFtZSkpO1xufVxuZXhwb3J0cy5obXJVcGRhdGUgPSBobXJVcGRhdGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1obXItdXBkYXRlLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGhtcl91cGRhdGVfMSA9IHJlcXVpcmUoXCIuL2htci11cGRhdGVcIik7XG5leHBvcnRzLmhtclVwZGF0ZSA9IGhtcl91cGRhdGVfMS5obXJVcGRhdGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJjb25zdCBobXJQcmVmaXggPSAnSE1SOic7XG5jb25zdCBsb2cgPSB7XG4gICAgaW5mbzogKG1lc3NhZ2UpID0+IGNvbnNvbGUuaW5mbyhgJHtobXJQcmVmaXh9ICR7bWVzc2FnZX1gKSxcbiAgICB3YXJuOiAobWVzc2FnZSkgPT4gY29uc29sZS53YXJuKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxuICAgIGVycm9yOiAobWVzc2FnZSkgPT4gY29uc29sZS5lcnJvcihgJHtobXJQcmVmaXh9ICR7bWVzc2FnZX1gKSxcbn07XG5jb25zdCByZWZyZXNoID0gJ0FwcGxpY2F0aW9uIG5lZWRzIHRvIGJlIHJlc3RhcnRlZCBpbiBvcmRlciB0byBhcHBseSB0aGUgY2hhbmdlcy4nO1xuY29uc3QgaG90T3B0aW9ucyA9IHtcbiAgICBpZ25vcmVVbmFjY2VwdGVkOiBmYWxzZSxcbiAgICBpZ25vcmVEZWNsaW5lZDogZmFsc2UsXG4gICAgaWdub3JlRXJyb3JlZDogZmFsc2UsXG4gICAgb25VbmFjY2VwdGVkKGRhdGEpIHtcbiAgICAgICAgY29uc3QgY2hhaW4gPSBbXS5jb25jYXQoZGF0YS5jaGFpbik7XG4gICAgICAgIGNvbnN0IGxhc3QgPSBjaGFpbltjaGFpbi5sZW5ndGggLSAxXTtcblxuICAgICAgICBpZiAobGFzdCA9PT0gMCkge1xuICAgICAgICAgICAgY2hhaW4ucG9wKCk7XG4gICAgICAgIH1cblxuICAgICAgICBsb2cud2FybihgSWdub3JlZCBhbiB1cGRhdGUgdG8gdW5hY2NlcHRlZCBtb2R1bGU6IGApO1xuICAgICAgICBjaGFpbi5mb3JFYWNoKG1vZCA9PiBsb2cud2FybihgICAgICAgICAg4p6tICR7bW9kfWApKTtcbiAgICB9LFxuICAgIG9uRGVjbGluZWQoZGF0YSkge1xuICAgICAgICBsb2cud2FybihgSWdub3JlZCBhbiB1cGRhdGUgdG8gZGVjbGluZWQgbW9kdWxlOmApO1xuICAgICAgICBkYXRhLmNoYWluLmZvckVhY2gobW9kID0+IGxvZy53YXJuKGAgICAgICAgICDinq0gJHttb2R9YCkpO1xuICAgIH0sXG4gICAgb25FcnJvcmVkKGRhdGEpIHtcbiAgICAgICAgbG9nLndhcm4oXG4gICAgICAgICAgICBgSWdub3JlZCBhbiBlcnJvciB3aGlsZSB1cGRhdGluZyBtb2R1bGUgJHtkYXRhLm1vZHVsZUlkfSA8JHtkYXRhLnR5cGV9PmBcbiAgICAgICAgKTtcbiAgICAgICAgbG9nLndhcm4oZGF0YS5lcnJvcik7XG4gICAgfSxcbn07XG5cbmxldCBuZXh0SGFzaDtcbmxldCBjdXJyZW50SGFzaDtcblxuZnVuY3Rpb24gdXBUb0RhdGUoKSB7XG4gICAgcmV0dXJuIG5leHRIYXNoLmluZGV4T2YoX193ZWJwYWNrX2hhc2hfXykgPj0gMDtcbn1cblxuZnVuY3Rpb24gcmVzdWx0KG1vZHVsZXMsIGFwcGxpZWRNb2R1bGVzKSB7XG4gICAgY29uc3QgdW5hY2NlcHRlZCA9IG1vZHVsZXMuZmlsdGVyKFxuICAgICAgICAobW9kdWxlSWQpID0+IGFwcGxpZWRNb2R1bGVzICYmIGFwcGxpZWRNb2R1bGVzLmluZGV4T2YobW9kdWxlSWQpIDwgMFxuICAgICk7XG5cbiAgICBpZiAodW5hY2NlcHRlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGxvZy53YXJuKCdUaGUgZm9sbG93aW5nIG1vZHVsZXMgY291bGQgbm90IGJlIHVwZGF0ZWQ6Jyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiB1bmFjY2VwdGVkKSB7XG4gICAgICAgICAgICBsb2cud2FybihgICAgICAgICAgIOKmuyAke21vZHVsZUlkfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCEoYXBwbGllZE1vZHVsZXMgfHwgW10pLmxlbmd0aCkge1xuICAgICAgICBsb2cuaW5mbygnTm8gTW9kdWxlcyBVcGRhdGVkLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5pbmZvKCdUaGUgZm9sbG93aW5nIG1vZHVsZXMgd2VyZSB1cGRhdGVkOicpO1xuXG4gICAgICAgIGZvciAoY29uc3QgbW9kdWxlSWQgb2YgYXBwbGllZE1vZHVsZXMpIHtcbiAgICAgICAgICAgIGxvZy5pbmZvKGAgICAgICAgICDihrsgJHttb2R1bGVJZH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG51bWJlcklkcyA9IGFwcGxpZWRNb2R1bGVzLmV2ZXJ5KFxuICAgICAgICAgICAgKG1vZHVsZUlkKSA9PiB0eXBlb2YgbW9kdWxlSWQgPT09ICdudW1iZXInXG4gICAgICAgICk7XG4gICAgICAgIGlmIChudW1iZXJJZHMpIHtcbiAgICAgICAgICAgIGxvZy5pbmZvKFxuICAgICAgICAgICAgICAgICdQbGVhc2UgY29uc2lkZXIgdXNpbmcgdGhlIE5hbWVkTW9kdWxlc1BsdWdpbiBmb3IgbW9kdWxlIG5hbWVzLidcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoZWNrKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gbW9kdWxlLmhvdFxuICAgICAgICAuY2hlY2soKVxuICAgICAgICAudGhlbigobW9kdWxlcykgPT4ge1xuICAgICAgICAgICAgaWYgKCFtb2R1bGVzKSB7XG4gICAgICAgICAgICAgICAgbG9nLndhcm4oXG4gICAgICAgICAgICAgICAgICAgIGBDYW5ub3QgZmluZCB1cGRhdGUuICR7cmVmcmVzaH1gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZS5ob3RcbiAgICAgICAgICAgICAgICAuYXBwbHkoaG90T3B0aW9ucylcbiAgICAgICAgICAgICAgICAudGhlbigoYXBwbGllZE1vZHVsZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRDaGVjaztcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1cFRvRGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q2hlY2sgPSBjaGVjayhvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdChtb2R1bGVzLCBhcHBsaWVkTW9kdWxlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwVG9EYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCBtb2RpZnkgbWVzc2FnZSAtIENMSSBkZXBlbmRzIG9uIHRoaXMgZXhhY3QgY29udGVudCB0byBkZXRlcm1pbmUgaG1yIG9wZXJhdGlvbiBzdGF0dXMuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cuaW5mbyhgU3VjY2Vzc2Z1bGx5IGFwcGxpZWQgdXBkYXRlIHdpdGggaG1yIGhhc2ggJHtjdXJyZW50SGFzaH0uIEFwcCBpcyB1cCB0byBkYXRlLmApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHRDaGVjayB8fCBudWxsO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gbW9kdWxlLmhvdC5zdGF0dXMoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFsnYWJvcnQnLCAnZmFpbCddLmluZGV4T2Yoc3RhdHVzKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEbyBub3QgbW9kaWZ5IG1lc3NhZ2UgLSBDTEkgZGVwZW5kcyBvbiB0aGlzIGV4YWN0IGNvbnRlbnQgdG8gZGV0ZXJtaW5lIGhtciBvcGVyYXRpb24gc3RhdHVzLlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmVycm9yKGBDYW5ub3QgYXBwbHkgdXBkYXRlIHdpdGggaG1yIGhhc2ggJHtjdXJyZW50SGFzaH0uYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyLnN0YWNrKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcihgVXBkYXRlIGZhaWxlZDogJHtlcnIubWVzc2FnZSB8fCBlcnIuc3RhY2t9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IG1vZHVsZS5ob3Quc3RhdHVzKCk7XG4gICAgICAgICAgICBpZiAoWydhYm9ydCcsICdmYWlsJ10uaW5kZXhPZihzdGF0dXMpID49IDApIHtcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoYENhbm5vdCBjaGVjayBmb3IgdXBkYXRlLiAke3JlZnJlc2h9YCk7XG4gICAgICAgICAgICAgICAgbG9nLmVycm9yKGVyci5tZXNzYWdlIHx8IGVyci5zdGFjayk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvZy5lcnJvcihgVXBkYXRlIGNoZWNrIGZhaWxlZDogJHtlcnIubWVzc2FnZSB8fCBlcnIuc3RhY2t9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xufVxuXG5pZiAobW9kdWxlLmhvdCkge1xuICAgIGxvZy5pbmZvKCdIb3QgTW9kdWxlIFJlcGxhY2VtZW50IEVuYWJsZWQuIFdhaXRpbmcgZm9yIHNpZ25hbC4nKTtcbn0gZWxzZSB7XG4gICAgbG9nLmVycm9yKCdIb3QgTW9kdWxlIFJlcGxhY2VtZW50IGlzIGRpc2FibGVkLicpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGUobGF0ZXN0SGFzaCwgb3B0aW9ucykge1xuICAgIG5leHRIYXNoID0gbGF0ZXN0SGFzaDtcbiAgICBpZiAoIXVwVG9EYXRlKCkpIHtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gbW9kdWxlLmhvdC5zdGF0dXMoKTtcblxuICAgICAgICBpZiAoc3RhdHVzID09PSAnaWRsZScpIHtcbiAgICAgICAgICAgIC8vRG8gbm90IG1vZGlmeSBtZXNzYWdlIC0gQ0xJIGRlcGVuZHMgb24gdGhpcyBleGFjdCBjb250ZW50IHRvIGRldGVybWluZSBobXIgb3BlcmF0aW9uIHN0YXR1cy5cbiAgICAgICAgICAgIGxvZy5pbmZvKGBDaGVja2luZyBmb3IgdXBkYXRlcyB0byB0aGUgYnVuZGxlIHdpdGggaG1yIGhhc2ggJHtjdXJyZW50SGFzaH0uYCk7XG4gICAgICAgICAgICByZXR1cm4gY2hlY2sob3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSBpZiAoWydhYm9ydCcsICdmYWlsJ10uaW5kZXhPZihzdGF0dXMpID49IDApIHtcbiAgICAgICAgICAgIGxvZy53YXJuKFxuICAgICAgICAgICAgICAgIGBDYW5ub3QgYXBwbHkgdXBkYXRlLiBBIHByZXZpb3VzIHVwZGF0ZSAke3N0YXR1c31lZC4gJHtyZWZyZXNofWBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5mdW5jdGlvbiBnZXROZXh0SGFzaChoYXNoLCBnZXRGaWxlQ29udGVudCkge1xuICAgIGNvbnN0IGZpbGUgPSBnZXRGaWxlQ29udGVudChgJHtoYXNofS5ob3QtdXBkYXRlLmpzb25gKTtcbiAgICByZXR1cm4gZmlsZS5yZWFkVGV4dCgpLnRoZW4oaG90VXBkYXRlQ29udGVudCA9PiB7XG4gICAgICAgIGlmIChob3RVcGRhdGVDb250ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBtYW5pZmVzdCA9IEpTT04ucGFyc2UoaG90VXBkYXRlQ29udGVudCk7XG4gICAgICAgICAgICBjb25zdCBuZXdIYXNoID0gbWFuaWZlc3QuaDtcbiAgICAgICAgICAgIHJldHVybiBnZXROZXh0SGFzaChuZXdIYXNoLCBnZXRGaWxlQ29udGVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGhhc2gpO1xuICAgICAgICB9XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4gUHJvbWlzZS5yZWplY3QoZXJyb3IpKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjaGVja1N0YXRlKGluaXRpYWxIYXNoLCBnZXRGaWxlQ29udGVudCkge1xuICAgIGN1cnJlbnRIYXNoID0gaW5pdGlhbEhhc2g7XG4gICAgcmV0dXJuIGdldE5leHRIYXNoKGluaXRpYWxIYXNoLCBnZXRGaWxlQ29udGVudCkudGhlbihuZXh0SGFzaCA9PiB7XG4gICAgICAgIGlmIChuZXh0SGFzaCAhPSBpbml0aWFsSGFzaCkge1xuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZShuZXh0SGFzaCwge30pO1xuICAgICAgICB9XG4gICAgfSlcbn1cbiIsImNvbnN0IGxvYWRDc3MgPSByZXF1aXJlKFwiLi9sb2FkLWFwcGxpY2F0aW9uLWNzc1wiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgICBsb2FkQ3NzKGZ1bmN0aW9uKCkge1xuICAgICAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCIuL2FwcC5jc3NcIiwgKCkgPT4gcmVxdWlyZShcIn4vYXBwXCIpKTtcbiAgICB9KTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxvYWRNb2R1bGVGbikge1xuICAgIGNvbnN0IGFwcGxpY2F0aW9uID0gcmVxdWlyZShcInRucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb25cIik7XG4gICAgcmVxdWlyZShcInRucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9zdHlsZS1zY29wZVwiKTtcblxuICAgIGxvYWRNb2R1bGVGbigpO1xuXG4gICAgYXBwbGljYXRpb24ubG9hZEFwcENzcygpO1xufVxuIiwidmFyIGc7XG5cbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXG5nID0gKGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcztcbn0pKCk7XG5cbnRyeSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxuXHRnID0gZyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xufSBjYXRjaCAoZSkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbn1cblxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3Ncbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cblxubW9kdWxlLmV4cG9ydHMgPSBnO1xuIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xucmVxdWlyZShcImdsb2JhbHNcIik7XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbmV4cG9ydHMuT2JzZXJ2YWJsZSA9IG9ic2VydmFibGVfMS5PYnNlcnZhYmxlO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uL3Byb2ZpbGluZ1wiKTtcbnZhciBldmVudHMgPSBuZXcgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUoKTtcbnZhciBsYXVuY2hlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2V0TGF1bmNoZWQoKSB7XG4gICAgbGF1bmNoZWQgPSB0cnVlO1xuICAgIGV2ZW50cy5vZmYoXCJsYXVuY2hcIiwgc2V0TGF1bmNoZWQpO1xufVxuZXZlbnRzLm9uKFwibGF1bmNoXCIsIHNldExhdW5jaGVkKTtcbmlmIChwcm9maWxpbmdfMS5sZXZlbCgpID4gMCkge1xuICAgIGV2ZW50cy5vbihcImRpc3BsYXllZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHByb2ZpbGluZ18xLnVwdGltZSgpO1xuICAgICAgICB2YXIgZW5kID0gcHJvZmlsaW5nXzEudGltZSgpO1xuICAgICAgICB2YXIgc3RhcnQgPSBlbmQgLSBkdXJhdGlvbjtcbiAgICAgICAgcHJvZmlsaW5nXzEudHJhY2UoXCJEaXNwbGF5ZWQgaW4gXCIgKyBkdXJhdGlvbi50b0ZpeGVkKDIpICsgXCJtc1wiLCBzdGFydCwgZW5kKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGhhc0xhdW5jaGVkKCkge1xuICAgIHJldHVybiBsYXVuY2hlZDtcbn1cbmV4cG9ydHMuaGFzTGF1bmNoZWQgPSBoYXNMYXVuY2hlZDtcbmV4cG9ydHMubGF1bmNoRXZlbnQgPSBcImxhdW5jaFwiO1xuZXhwb3J0cy5zdXNwZW5kRXZlbnQgPSBcInN1c3BlbmRcIjtcbmV4cG9ydHMuZGlzcGxheWVkRXZlbnQgPSBcImRpc3BsYXllZFwiO1xuZXhwb3J0cy5yZXN1bWVFdmVudCA9IFwicmVzdW1lXCI7XG5leHBvcnRzLmV4aXRFdmVudCA9IFwiZXhpdFwiO1xuZXhwb3J0cy5sb3dNZW1vcnlFdmVudCA9IFwibG93TWVtb3J5XCI7XG5leHBvcnRzLnVuY2F1Z2h0RXJyb3JFdmVudCA9IFwidW5jYXVnaHRFcnJvclwiO1xuZXhwb3J0cy5kaXNjYXJkZWRFcnJvckV2ZW50ID0gXCJkaXNjYXJkZWRFcnJvclwiO1xuZXhwb3J0cy5vcmllbnRhdGlvbkNoYW5nZWRFdmVudCA9IFwib3JpZW50YXRpb25DaGFuZ2VkXCI7XG52YXIgY3NzRmlsZSA9IFwiLi9hcHAuY3NzXCI7XG52YXIgcmVzb3VyY2VzID0ge307XG5mdW5jdGlvbiBnZXRSZXNvdXJjZXMoKSB7XG4gICAgcmV0dXJuIHJlc291cmNlcztcbn1cbmV4cG9ydHMuZ2V0UmVzb3VyY2VzID0gZ2V0UmVzb3VyY2VzO1xuZnVuY3Rpb24gc2V0UmVzb3VyY2VzKHJlcykge1xuICAgIHJlc291cmNlcyA9IHJlcztcbn1cbmV4cG9ydHMuc2V0UmVzb3VyY2VzID0gc2V0UmVzb3VyY2VzO1xuZXhwb3J0cy5hbmRyb2lkID0gdW5kZWZpbmVkO1xuZXhwb3J0cy5pb3MgPSB1bmRlZmluZWQ7XG5leHBvcnRzLm9uID0gZXZlbnRzLm9uLmJpbmQoZXZlbnRzKTtcbmV4cG9ydHMub2ZmID0gZXZlbnRzLm9mZi5iaW5kKGV2ZW50cyk7XG5leHBvcnRzLm5vdGlmeSA9IGV2ZW50cy5ub3RpZnkuYmluZChldmVudHMpO1xuZXhwb3J0cy5oYXNMaXN0ZW5lcnMgPSBldmVudHMuaGFzTGlzdGVuZXJzLmJpbmQoZXZlbnRzKTtcbnZhciBhcHA7XG5mdW5jdGlvbiBzZXRBcHBsaWNhdGlvbihpbnN0YW5jZSkge1xuICAgIGFwcCA9IGluc3RhbmNlO1xufVxuZXhwb3J0cy5zZXRBcHBsaWNhdGlvbiA9IHNldEFwcGxpY2F0aW9uO1xuZnVuY3Rpb24gbGl2ZXN5bmMocm9vdFZpZXcsIGNvbnRleHQpIHtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBcImxpdmVzeW5jXCIsIG9iamVjdDogYXBwIH0pO1xuICAgIHZhciBsaXZlU3luY0NvcmUgPSBnbG9iYWwuX19vbkxpdmVTeW5jQ29yZTtcbiAgICB2YXIgcmVhcHBseUFwcFN0eWxlcyA9IGZhbHNlO1xuICAgIGlmIChjb250ZXh0ICYmIGNvbnRleHQucGF0aCkge1xuICAgICAgICB2YXIgc3R5bGVFeHRlbnNpb25zID0gW1wiY3NzXCIsIFwic2Nzc1wiXTtcbiAgICAgICAgdmFyIGFwcFN0eWxlc0Z1bGxGaWxlTmFtZSA9IGdldENzc0ZpbGVOYW1lKCk7XG4gICAgICAgIHZhciBhcHBTdHlsZXNGaWxlTmFtZV8xID0gYXBwU3R5bGVzRnVsbEZpbGVOYW1lLnN1YnN0cmluZygwLCBhcHBTdHlsZXNGdWxsRmlsZU5hbWUubGFzdEluZGV4T2YoXCIuXCIpICsgMSk7XG4gICAgICAgIHJlYXBwbHlBcHBTdHlsZXMgPSBzdHlsZUV4dGVuc2lvbnMuc29tZShmdW5jdGlvbiAoZXh0KSB7IHJldHVybiBjb250ZXh0LnBhdGggPT09IGFwcFN0eWxlc0ZpbGVOYW1lXzEuY29uY2F0KGV4dCk7IH0pO1xuICAgIH1cbiAgICBpZiAocmVhcHBseUFwcFN0eWxlcyAmJiByb290Vmlldykge1xuICAgICAgICByb290Vmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChsaXZlU3luY0NvcmUpIHtcbiAgICAgICAgbGl2ZVN5bmNDb3JlKGNvbnRleHQpO1xuICAgIH1cbn1cbmV4cG9ydHMubGl2ZXN5bmMgPSBsaXZlc3luYztcbmZ1bmN0aW9uIHNldENzc0ZpbGVOYW1lKGNzc0ZpbGVOYW1lKSB7XG4gICAgY3NzRmlsZSA9IGNzc0ZpbGVOYW1lO1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IFwiY3NzQ2hhbmdlZFwiLCBvYmplY3Q6IGFwcCwgY3NzRmlsZTogY3NzRmlsZU5hbWUgfSk7XG59XG5leHBvcnRzLnNldENzc0ZpbGVOYW1lID0gc2V0Q3NzRmlsZU5hbWU7XG5mdW5jdGlvbiBnZXRDc3NGaWxlTmFtZSgpIHtcbiAgICByZXR1cm4gY3NzRmlsZTtcbn1cbmV4cG9ydHMuZ2V0Q3NzRmlsZU5hbWUgPSBnZXRDc3NGaWxlTmFtZTtcbmZ1bmN0aW9uIGxvYWRBcHBDc3MoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJsb2FkQXBwQ3NzXCIsIG9iamVjdDogYXBwLCBjc3NGaWxlOiBnZXRDc3NGaWxlTmFtZSgpIH0pO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgZmlsZSBcIiArIGdldENzc0ZpbGVOYW1lKCkgKyBcIiBjb3VsZG4ndCBiZSBsb2FkZWQhIFwiICtcbiAgICAgICAgICAgIFwiWW91IG1heSBuZWVkIHRvIHJlZ2lzdGVyIGl0IGluc2lkZSAuL2FwcC92ZW5kb3IudHMuXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMubG9hZEFwcENzcyA9IGxvYWRBcHBDc3M7XG5mdW5jdGlvbiBhZGRDc3MoY3NzVGV4dCkge1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IFwiY3NzQ2hhbmdlZFwiLCBvYmplY3Q6IGFwcCwgY3NzVGV4dDogY3NzVGV4dCB9KTtcbn1cbmV4cG9ydHMuYWRkQ3NzID0gYWRkQ3NzO1xuZ2xvYmFsLl9fb25VbmNhdWdodEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogZXhwb3J0cy51bmNhdWdodEVycm9yRXZlbnQsIG9iamVjdDogYXBwLCBhbmRyb2lkOiBlcnJvciwgaW9zOiBlcnJvciwgZXJyb3I6IGVycm9yIH0pO1xufTtcbmdsb2JhbC5fX29uRGlzY2FyZGVkRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBleHBvcnRzLmRpc2NhcmRlZEVycm9yRXZlbnQsIG9iamVjdDogYXBwLCBlcnJvcjogZXJyb3IgfSk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYXBwbGljYXRpb25fY29tbW9uXzEgPSByZXF1aXJlKFwiLi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hcHBsaWNhdGlvbi1jb21tb25cIikpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi91aS9idWlsZGVyXCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi91aS9jb3JlL3ZpZXdcIik7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuLi91aS9mcmFtZVwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uL3Byb2ZpbGluZ1wiKTtcbnZhciBnZXRWaXNpYmxlVmlld0NvbnRyb2xsZXIgPSB1dGlsc18xLmlvcy5nZXRWaXNpYmxlVmlld0NvbnRyb2xsZXI7XG52YXIgUmVzcG9uZGVyID0gVUlSZXNwb25kZXIuZXh0ZW5kKHtcbiAgICBnZXQgd2luZG93KCkge1xuICAgICAgICByZXR1cm4gaW9zQXBwID8gaW9zQXBwLndpbmRvdyA6IHVuZGVmaW5lZDtcbiAgICB9LFxuICAgIHNldCB3aW5kb3coc2V0V2luZG93KSB7XG4gICAgfVxufSwge1xuICAgIHByb3RvY29sczogW1VJQXBwbGljYXRpb25EZWxlZ2F0ZV1cbn0pO1xudmFyIE5vdGlmaWNhdGlvbk9ic2VydmVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTm90aWZpY2F0aW9uT2JzZXJ2ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uT2JzZXJ2ZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTm90aWZpY2F0aW9uT2JzZXJ2ZXIuaW5pdFdpdGhDYWxsYmFjayA9IGZ1bmN0aW9uIChvblJlY2VpdmVDYWxsYmFjaykge1xuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfc3VwZXIubmV3LmNhbGwodGhpcyk7XG4gICAgICAgIG9ic2VydmVyLl9vblJlY2VpdmVDYWxsYmFjayA9IG9uUmVjZWl2ZUNhbGxiYWNrO1xuICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gICAgfTtcbiAgICBOb3RpZmljYXRpb25PYnNlcnZlci5wcm90b3R5cGUub25SZWNlaXZlID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB0aGlzLl9vblJlY2VpdmVDYWxsYmFjayhub3RpZmljYXRpb24pO1xuICAgIH07XG4gICAgTm90aWZpY2F0aW9uT2JzZXJ2ZXIuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcIm9uUmVjZWl2ZVwiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbTlNOb3RpZmljYXRpb25dIH1cbiAgICB9O1xuICAgIHJldHVybiBOb3RpZmljYXRpb25PYnNlcnZlcjtcbn0oTlNPYmplY3QpKTtcbnZhciBkaXNwbGF5ZWRPbmNlID0gZmFsc2U7XG52YXIgZGlzcGxheWVkTGlua1RhcmdldDtcbnZhciBkaXNwbGF5ZWRMaW5rO1xudmFyIENBRGlzcGxheUxpbmtUYXJnZXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDQURpc3BsYXlMaW5rVGFyZ2V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENBRGlzcGxheUxpbmtUYXJnZXQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQ0FEaXNwbGF5TGlua1RhcmdldC5wcm90b3R5cGUub25EaXNwbGF5ZWQgPSBmdW5jdGlvbiAobGluaykge1xuICAgICAgICBsaW5rLmludmFsaWRhdGUoKTtcbiAgICAgICAgdmFyIGlvcyA9IFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb247XG4gICAgICAgIHZhciBvYmplY3QgPSBpb3NBcHA7XG4gICAgICAgIGRpc3BsYXllZE9uY2UgPSB0cnVlO1xuICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLmRpc3BsYXllZEV2ZW50LCBvYmplY3Q6IG9iamVjdCwgaW9zOiBpb3MgfSk7XG4gICAgICAgIGRpc3BsYXllZExpbmtUYXJnZXQgPSBudWxsO1xuICAgICAgICBkaXNwbGF5ZWRMaW5rID0gbnVsbDtcbiAgICB9O1xuICAgIENBRGlzcGxheUxpbmtUYXJnZXQuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcIm9uRGlzcGxheWVkXCI6IHsgcmV0dXJuczogaW50ZXJvcC50eXBlcy52b2lkLCBwYXJhbXM6IFtDQURpc3BsYXlMaW5rXSB9XG4gICAgfTtcbiAgICByZXR1cm4gQ0FEaXNwbGF5TGlua1RhcmdldDtcbn0oTlNPYmplY3QpKTtcbnZhciBJT1NBcHBsaWNhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSU9TQXBwbGljYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRPcmllbnRhdGlvbiA9IFVJRGV2aWNlLmN1cnJlbnREZXZpY2Uub3JpZW50YXRpb247XG4gICAgICAgIHRoaXMuX29ic2VydmVycyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLmFkZE5vdGlmaWNhdGlvbk9ic2VydmVyKFVJQXBwbGljYXRpb25EaWRGaW5pc2hMYXVuY2hpbmdOb3RpZmljYXRpb24sIHRoaXMuZGlkRmluaXNoTGF1bmNoaW5nV2l0aE9wdGlvbnMuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYWRkTm90aWZpY2F0aW9uT2JzZXJ2ZXIoVUlBcHBsaWNhdGlvbkRpZEJlY29tZUFjdGl2ZU5vdGlmaWNhdGlvbiwgdGhpcy5kaWRCZWNvbWVBY3RpdmUuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYWRkTm90aWZpY2F0aW9uT2JzZXJ2ZXIoVUlBcHBsaWNhdGlvbkRpZEVudGVyQmFja2dyb3VuZE5vdGlmaWNhdGlvbiwgdGhpcy5kaWRFbnRlckJhY2tncm91bmQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYWRkTm90aWZpY2F0aW9uT2JzZXJ2ZXIoVUlBcHBsaWNhdGlvbldpbGxUZXJtaW5hdGVOb3RpZmljYXRpb24sIHRoaXMud2lsbFRlcm1pbmF0ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25PYnNlcnZlcihVSUFwcGxpY2F0aW9uRGlkUmVjZWl2ZU1lbW9yeVdhcm5pbmdOb3RpZmljYXRpb24sIHRoaXMuZGlkUmVjZWl2ZU1lbW9yeVdhcm5pbmcuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuYWRkTm90aWZpY2F0aW9uT2JzZXJ2ZXIoVUlEZXZpY2VPcmllbnRhdGlvbkRpZENoYW5nZU5vdGlmaWNhdGlvbiwgdGhpcy5vcmllbnRhdGlvbkRpZENoYW5nZS5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJyb290Q29udHJvbGxlclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpbmRvdy5yb290Vmlld0NvbnRyb2xsZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUsIFwibmF0aXZlQXBwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJ3aW5kb3dcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93aW5kb3c7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUsIFwiZGVsZWdhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZWxlZ2F0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kZWxlZ2F0ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLCBcInJvb3RWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5hZGROb3RpZmljYXRpb25PYnNlcnZlciA9IGZ1bmN0aW9uIChub3RpZmljYXRpb25OYW1lLCBvblJlY2VpdmVDYWxsYmFjaykge1xuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBOb3RpZmljYXRpb25PYnNlcnZlci5pbml0V2l0aENhbGxiYWNrKG9uUmVjZWl2ZUNhbGxiYWNrKTtcbiAgICAgICAgTlNOb3RpZmljYXRpb25DZW50ZXIuZGVmYXVsdENlbnRlci5hZGRPYnNlcnZlclNlbGVjdG9yTmFtZU9iamVjdChvYnNlcnZlciwgXCJvblJlY2VpdmVcIiwgbm90aWZpY2F0aW9uTmFtZSwgbnVsbCk7XG4gICAgICAgIHRoaXMuX29ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyO1xuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLnJlbW92ZU5vdGlmaWNhdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKG9ic2VydmVyLCBub3RpZmljYXRpb25OYW1lKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX29ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKTtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgTlNOb3RpZmljYXRpb25DZW50ZXIuZGVmYXVsdENlbnRlci5yZW1vdmVPYnNlcnZlck5hbWVPYmplY3Qob2JzZXJ2ZXIsIG5vdGlmaWNhdGlvbk5hbWUsIG51bGwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUuZGlkRmluaXNoTGF1bmNoaW5nV2l0aE9wdGlvbnMgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGlmICghZGlzcGxheWVkT25jZSkge1xuICAgICAgICAgICAgZGlzcGxheWVkTGlua1RhcmdldCA9IENBRGlzcGxheUxpbmtUYXJnZXQubmV3KCk7XG4gICAgICAgICAgICBkaXNwbGF5ZWRMaW5rID0gQ0FEaXNwbGF5TGluay5kaXNwbGF5TGlua1dpdGhUYXJnZXRTZWxlY3RvcihkaXNwbGF5ZWRMaW5rVGFyZ2V0LCBcIm9uRGlzcGxheWVkXCIpO1xuICAgICAgICAgICAgZGlzcGxheWVkTGluay5hZGRUb1J1bkxvb3BGb3JNb2RlKE5TUnVuTG9vcC5tYWluUnVuTG9vcCwgTlNEZWZhdWx0UnVuTG9vcE1vZGUpO1xuICAgICAgICAgICAgZGlzcGxheWVkTGluay5hZGRUb1J1bkxvb3BGb3JNb2RlKE5TUnVuTG9vcC5tYWluUnVuTG9vcCwgVUlUcmFja2luZ1J1bkxvb3BNb2RlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl93aW5kb3cgPSBVSVdpbmRvdy5hbGxvYygpLmluaXRXaXRoRnJhbWUoVUlTY3JlZW4ubWFpblNjcmVlbi5ib3VuZHMpO1xuICAgICAgICB0aGlzLl93aW5kb3cuYmFja2dyb3VuZENvbG9yID0gVUlDb2xvci53aGl0ZUNvbG9yO1xuICAgICAgICB0aGlzLm5vdGlmeUFwcFN0YXJ0ZWQobm90aWZpY2F0aW9uKTtcbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5ub3RpZnlBcHBTdGFydGVkID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEubGF1bmNoRXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBpb3M6IG5vdGlmaWNhdGlvbiAmJiBub3RpZmljYXRpb24udXNlckluZm8gJiYgbm90aWZpY2F0aW9uLnVzZXJJbmZvLm9iamVjdEZvcktleShcIlVJQXBwbGljYXRpb25MYXVuY2hPcHRpb25zTG9jYWxOb3RpZmljYXRpb25LZXlcIikgfHwgbnVsbFxuICAgICAgICB9O1xuICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoYXJncyk7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJsb2FkQXBwQ3NzXCIsIG9iamVjdDogdGhpcywgY3NzRmlsZTogYXBwbGljYXRpb25fY29tbW9uXzEuZ2V0Q3NzRmlsZU5hbWUoKSB9KTtcbiAgICAgICAgaWYgKHRoaXMuX3dpbmRvdykge1xuICAgICAgICAgICAgdGhpcy5zZXRXaW5kb3dDb250ZW50KGFyZ3Mucm9vdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl93aW5kb3cgPSBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uLmRlbGVnYXRlLndpbmRvdztcbiAgICAgICAgfVxuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLmRpZEJlY29tZUFjdGl2ZSA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgdmFyIGlvcyA9IFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb247XG4gICAgICAgIHZhciBvYmplY3QgPSB0aGlzO1xuICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLnJlc3VtZUV2ZW50LCBvYmplY3Q6IG9iamVjdCwgaW9zOiBpb3MgfSk7XG4gICAgICAgIHZhciByb290VmlldyA9IHRoaXMuX3Jvb3RWaWV3O1xuICAgICAgICBpZiAocm9vdFZpZXcgJiYgIXJvb3RWaWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICByb290Vmlldy5jYWxsTG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5kaWRFbnRlckJhY2tncm91bmQgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEuc3VzcGVuZEV2ZW50LCBvYmplY3Q6IHRoaXMsIGlvczogVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbiB9KTtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyAmJiByb290Vmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcm9vdFZpZXcuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS53aWxsVGVybWluYXRlID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoeyBldmVudE5hbWU6IGFwcGxpY2F0aW9uX2NvbW1vbl8xLmV4aXRFdmVudCwgb2JqZWN0OiB0aGlzLCBpb3M6IFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb24gfSk7XG4gICAgICAgIHZhciByb290VmlldyA9IHRoaXMuX3Jvb3RWaWV3O1xuICAgICAgICBpZiAocm9vdFZpZXcgJiYgcm9vdFZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3LmNhbGxVbmxvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUuZGlkUmVjZWl2ZU1lbW9yeVdhcm5pbmcgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEubG93TWVtb3J5RXZlbnQsIG9iamVjdDogdGhpcywgaW9zOiBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uIH0pO1xuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLm9yaWVudGF0aW9uRGlkQ2hhbmdlID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB2YXIgb3JpZW50YXRpb24gPSBVSURldmljZS5jdXJyZW50RGV2aWNlLm9yaWVudGF0aW9uO1xuICAgICAgICBpZiAodGhpcy5fY3VycmVudE9yaWVudGF0aW9uICE9PSBvcmllbnRhdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudE9yaWVudGF0aW9uID0gb3JpZW50YXRpb247XG4gICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB2b2lkIDA7XG4gICAgICAgICAgICBzd2l0Y2ggKG9yaWVudGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcImxhbmRzY2FwZVwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IFwicG9ydHJhaXRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBcInVua25vd25cIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5ub3RpZnkoe1xuICAgICAgICAgICAgICAgIGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEub3JpZW50YXRpb25DaGFuZ2VkRXZlbnQsXG4gICAgICAgICAgICAgICAgaW9zOiB0aGlzLFxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdWYWx1ZSxcbiAgICAgICAgICAgICAgICBvYmplY3Q6IHRoaXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUuX29uTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICB2YXIgaXNBcHBSb290TW9kdWxlQ2hhbmdlZCA9IGNvbnRleHQgJiYgY29udGV4dC5wYXRoICYmIGNvbnRleHQucGF0aC5pbmNsdWRlcyhnZXRNYWluRW50cnkoKS5tb2R1bGVOYW1lKSAmJiBjb250ZXh0LnR5cGUgIT09IFwic3R5bGVcIjtcbiAgICAgICAgaWYgKGlzQXBwUm9vdE1vZHVsZUNoYW5nZWQgfHwgKHRoaXMuX3Jvb3RWaWV3ICYmICF0aGlzLl9yb290Vmlldy5fb25MaXZlc3luYyhjb250ZXh0KSkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0V2luZG93Q29udGVudCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2V0V2luZG93Q29udGVudCA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh0aGlzLl9yb290Vmlldykge1xuICAgICAgICAgICAgdGhpcy5fcm9vdFZpZXcuX29uUm9vdFZpZXdSZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByb290VmlldyA9IGNyZWF0ZVJvb3RWaWV3KHZpZXcpO1xuICAgICAgICB2YXIgY29udHJvbGxlciA9IGdldFZpZXdDb250cm9sbGVyKHJvb3RWaWV3KTtcbiAgICAgICAgdGhpcy5fcm9vdFZpZXcgPSByb290VmlldztcbiAgICAgICAgaWYgKGNyZWF0ZVJvb3RGcmFtZS52YWx1ZSkge1xuICAgICAgICAgICAgcm9vdFZpZXcuX3NldHVwVUkoe30pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcm9vdFZpZXcuX3NldHVwQXNSb290Vmlldyh7fSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0Vmlld0NvbnRyb2xsZXJWaWV3KHJvb3RWaWV3KTtcbiAgICAgICAgdmFyIGhhdmVDb250cm9sbGVyID0gdGhpcy5fd2luZG93LnJvb3RWaWV3Q29udHJvbGxlciAhPT0gbnVsbDtcbiAgICAgICAgdGhpcy5fd2luZG93LnJvb3RWaWV3Q29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gICAgICAgIGlmICghaGF2ZUNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX3dpbmRvdy5tYWtlS2V5QW5kVmlzaWJsZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJkaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9uc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJkaWRCZWNvbWVBY3RpdmVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIElPU0FwcGxpY2F0aW9uO1xufSgpKTtcbnZhciBpb3NBcHAgPSBuZXcgSU9TQXBwbGljYXRpb24oKTtcbmV4cG9ydHMuaW9zID0gaW9zQXBwO1xuYXBwbGljYXRpb25fY29tbW9uXzEuc2V0QXBwbGljYXRpb24oaW9zQXBwKTtcbmdsb2JhbC5fX29uTGl2ZVN5bmNDb3JlID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICBpb3NBcHAuX29uTGl2ZXN5bmMoY29udGV4dCk7XG59O1xudmFyIG1haW5FbnRyeTtcbmZ1bmN0aW9uIGNyZWF0ZVJvb3RWaWV3KHYpIHtcbiAgICB2YXIgcm9vdFZpZXcgPSB2O1xuICAgIGlmICghcm9vdFZpZXcpIHtcbiAgICAgICAgaWYgKCFtYWluRW50cnkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1haW4gZW50cnkgaXMgbWlzc2luZy4gQXBwIGNhbm5vdCBiZSBzdGFydGVkLiBWZXJpZnkgYXBwIGJvb3RzdHJhcC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoY3JlYXRlUm9vdEZyYW1lLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gcm9vdFZpZXcgPSBuZXcgZnJhbWVfMS5GcmFtZSgpO1xuICAgICAgICAgICAgICAgIGZyYW1lLm5hdmlnYXRlKG1haW5FbnRyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByb290VmlldyA9IGJ1aWxkZXJfMS5jcmVhdGVWaWV3RnJvbUVudHJ5KG1haW5FbnRyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJvb3RWaWV3O1xufVxuZnVuY3Rpb24gZ2V0TWFpbkVudHJ5KCkge1xuICAgIHJldHVybiBtYWluRW50cnk7XG59XG5leHBvcnRzLmdldE1haW5FbnRyeSA9IGdldE1haW5FbnRyeTtcbmZ1bmN0aW9uIGdldFJvb3RWaWV3KCkge1xuICAgIHJldHVybiBpb3NBcHAucm9vdFZpZXc7XG59XG5leHBvcnRzLmdldFJvb3RWaWV3ID0gZ2V0Um9vdFZpZXc7XG52YXIgY3JlYXRlUm9vdEZyYW1lID0geyB2YWx1ZTogdHJ1ZSB9O1xudmFyIHN0YXJ0ZWQgPSBmYWxzZTtcbmZ1bmN0aW9uIF9zdGFydChlbnRyeSkge1xuICAgIG1haW5FbnRyeSA9IHR5cGVvZiBlbnRyeSA9PT0gXCJzdHJpbmdcIiA/IHsgbW9kdWxlTmFtZTogZW50cnkgfSA6IGVudHJ5O1xuICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgIGlmICghaW9zQXBwLm5hdGl2ZUFwcCkge1xuICAgICAgICBVSUFwcGxpY2F0aW9uTWFpbigwLCBudWxsLCBudWxsLCBpb3NBcHAgJiYgaW9zQXBwLmRlbGVnYXRlID8gTlNTdHJpbmdGcm9tQ2xhc3MoaW9zQXBwLmRlbGVnYXRlKSA6IE5TU3RyaW5nRnJvbUNsYXNzKFJlc3BvbmRlcikpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gY3JlYXRlUm9vdFZpZXcoKTtcbiAgICAgICAgaWYgKHJvb3RWaWV3KSB7XG4gICAgICAgICAgICB2YXIgd2luZG93XzEgPSBpb3NBcHAubmF0aXZlQXBwLmtleVdpbmRvdyB8fCAoaW9zQXBwLm5hdGl2ZUFwcC53aW5kb3dzLmNvdW50ID4gMCAmJiBpb3NBcHAubmF0aXZlQXBwLndpbmRvd3NbMF0pO1xuICAgICAgICAgICAgaWYgKHdpbmRvd18xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvb3RDb250cm9sbGVyID0gd2luZG93XzEucm9vdFZpZXdDb250cm9sbGVyO1xuICAgICAgICAgICAgICAgIGlmIChyb290Q29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udHJvbGxlciA9IGdldFZpZXdDb250cm9sbGVyKHJvb3RWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgcm9vdFZpZXcuX3NldHVwQXNSb290Vmlldyh7fSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbWJlZGRlckRlbGVnYXRlID0gTmF0aXZlU2NyaXB0RW1iZWRkZXIuc2hhcmVkSW5zdGFuY2UoKS5kZWxlZ2F0ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVtYmVkZGVyRGVsZWdhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkZGVyRGVsZWdhdGUucHJlc2VudE5hdGl2ZVNjcmlwdEFwcChjb250cm9sbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2aXNpYmxlVkMgPSBnZXRWaXNpYmxlVmlld0NvbnRyb2xsZXIocm9vdENvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZVZDLnByZXNlbnRWaWV3Q29udHJvbGxlckFuaW1hdGVkQ29tcGxldGlvbihjb250cm9sbGVyLCB0cnVlLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpb3NBcHAubm90aWZ5QXBwU3RhcnRlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuX3N0YXJ0ID0gX3N0YXJ0O1xuZnVuY3Rpb24gcnVuKGVudHJ5KSB7XG4gICAgY3JlYXRlUm9vdEZyYW1lLnZhbHVlID0gZmFsc2U7XG4gICAgX3N0YXJ0KGVudHJ5KTtcbn1cbmV4cG9ydHMucnVuID0gcnVuO1xuZnVuY3Rpb24gX3Jlc2V0Um9vdFZpZXcoZW50cnkpIHtcbiAgICBjcmVhdGVSb290RnJhbWUudmFsdWUgPSBmYWxzZTtcbiAgICBtYWluRW50cnkgPSB0eXBlb2YgZW50cnkgPT09IFwic3RyaW5nXCIgPyB7IG1vZHVsZU5hbWU6IGVudHJ5IH0gOiBlbnRyeTtcbiAgICBpb3NBcHAuc2V0V2luZG93Q29udGVudCgpO1xufVxuZXhwb3J0cy5fcmVzZXRSb290VmlldyA9IF9yZXNldFJvb3RWaWV3O1xuZnVuY3Rpb24gZ2V0TmF0aXZlQXBwbGljYXRpb24oKSB7XG4gICAgcmV0dXJuIGlvc0FwcC5uYXRpdmVBcHA7XG59XG5leHBvcnRzLmdldE5hdGl2ZUFwcGxpY2F0aW9uID0gZ2V0TmF0aXZlQXBwbGljYXRpb247XG5mdW5jdGlvbiBnZXRWaWV3Q29udHJvbGxlcih2aWV3KSB7XG4gICAgdmFyIHZpZXdDb250cm9sbGVyID0gdmlldy52aWV3Q29udHJvbGxlciB8fCB2aWV3LmlvcztcbiAgICBpZiAodmlld0NvbnRyb2xsZXIgaW5zdGFuY2VvZiBVSVZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiB2aWV3Q29udHJvbGxlcjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZpZXdDb250cm9sbGVyID0gdmlld18xLmlvcy5VSUxheW91dFZpZXdDb250cm9sbGVyLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodmlldykpO1xuICAgICAgICB2aWV3LnZpZXdDb250cm9sbGVyID0gdmlld0NvbnRyb2xsZXI7XG4gICAgICAgIHJldHVybiB2aWV3Q29udHJvbGxlcjtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRWaWV3Q29udHJvbGxlclZpZXcodmlldykge1xuICAgIHZhciB2aWV3Q29udHJvbGxlciA9IHZpZXcudmlld0NvbnRyb2xsZXIgfHwgdmlldy5pb3M7XG4gICAgdmFyIG5hdGl2ZVZpZXcgPSB2aWV3LmlvcyB8fCB2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgaWYgKCFuYXRpdmVWaWV3IHx8ICF2aWV3Q29udHJvbGxlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSb290IHNob3VsZCBiZSBlaXRoZXIgVUlWaWV3Q29udHJvbGxlciBvciBVSVZpZXdcIik7XG4gICAgfVxuICAgIGlmICh2aWV3Q29udHJvbGxlciBpbnN0YW5jZW9mIHZpZXdfMS5pb3MuVUlMYXlvdXRWaWV3Q29udHJvbGxlcikge1xuICAgICAgICB2aWV3Q29udHJvbGxlci52aWV3LmFkZFN1YnZpZXcobmF0aXZlVmlldyk7XG4gICAgfVxufVxuZ2xvYmFsLl9fb25MaXZlU3luYyA9IGZ1bmN0aW9uIF9fb25MaXZlU3luYyhjb250ZXh0KSB7XG4gICAgaWYgKCFzdGFydGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJvb3RWaWV3ID0gZ2V0Um9vdFZpZXcoKTtcbiAgICBhcHBsaWNhdGlvbl9jb21tb25fMS5saXZlc3luYyhyb290VmlldywgY29udGV4dCk7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbGljYXRpb24uaW9zLmpzLm1hcCIsImlmIChnbG9iYWwuVE5TX1dFQlBBQ0spIHtcbiAgICByZXF1aXJlKFwiZ2xvYmFsc1wiKTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ0ZXh0L2Zvcm1hdHRlZC1zdHJpbmdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInRleHQvZm9ybWF0dGVkLXN0cmluZ1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGV4dC9zcGFuXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ0ZXh0L3NwYW5cIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2FjdGlvbi1iYXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2FjdGlvbi1iYXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2FjdGl2aXR5LWluZGljYXRvclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvYWN0aXZpdHktaW5kaWNhdG9yXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9ib3JkZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2JvcmRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvYm90dG9tLW5hdmlnYXRpb25cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2JvdHRvbS1uYXZpZ2F0aW9uXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9idXR0b25cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2J1dHRvblwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvY29udGVudC12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9jb250ZW50LXZpZXdcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2RhdGUtcGlja2VyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9kYXRlLXBpY2tlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvZnJhbWVcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2ZyYW1lXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9odG1sLXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2h0bWwtdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvaW1hZ2VcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2ltYWdlXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYWJlbFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvbGFiZWxcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2xheW91dHMvYWJzb2x1dGUtbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9sYXlvdXRzL2Fic29sdXRlLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9kb2NrLWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvbGF5b3V0cy9kb2NrLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9ncmlkLWxheW91dFwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvbGF5b3V0cy9ncmlkLWxheW91dFwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvbGF5b3V0cy9zdGFjay1sYXlvdXRcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2xheW91dHMvc3RhY2stbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYXlvdXRzL2ZsZXhib3gtbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9sYXlvdXRzL2ZsZXhib3gtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9sYXlvdXRzL3dyYXAtbGF5b3V0XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9sYXlvdXRzL3dyYXAtbGF5b3V0XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9saXN0LXBpY2tlclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvbGlzdC1waWNrZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3BhZ2VcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3BhZ2VcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3BsYWNlaG9sZGVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9wbGFjZWhvbGRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvcHJvZ3Jlc3NcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3Byb2dyZXNzXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9wcm94eS12aWV3LWNvbnRhaW5lclwiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvcHJveHktdmlldy1jb250YWluZXJcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3JlcGVhdGVyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9yZXBlYXRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvc2Nyb2xsLXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3Njcm9sbC12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zZWFyY2gtYmFyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9zZWFyY2gtYmFyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zZWdtZW50ZWQtYmFyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9zZWdtZW50ZWQtYmFyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9zbGlkZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3NsaWRlclwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvc3dpdGNoXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS9zd2l0Y2hcIik7IH0pO1xuICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL3RhYi12aWV3XCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS90YWItdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW1cIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGFic1wiLCBmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwidWkvdGFic1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvd2ViLXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3dlYi12aWV3XCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90ZXh0LWZpZWxkXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ1aS90ZXh0LWZpZWxkXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS90ZXh0LXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3RleHQtdmlld1wiKTsgfSk7XG4gICAgZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidWkvdGltZS1waWNrZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL3RpbWUtcGlja2VyXCIpOyB9KTtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUoXCJ1aS9saXN0LXZpZXdcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2xpc3Qtdmlld1wiKTsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1idW5kbGUtZW50cnktcG9pbnRzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi91dGlscy90eXBlc1wiKTtcbnZhciBrbm93bkNvbG9ycyA9IHJlcXVpcmUoXCIuL2tub3duLWNvbG9yc1wiKTtcbnZhciBTSEFSUCA9IFwiI1wiO1xudmFyIEhFWF9SRUdFWCA9IC8oXiNbMC05QS1GXXs2fSQpfCheI1swLTlBLUZdezN9JCl8KF4jWzAtOUEtRl17OH0kKS9pO1xudmFyIENvbG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb2xvcigpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHZhciBhcmcgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcoYXJnKSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1JnYk9yUmdiYShhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSBhcmdiRnJvbVJnYk9yUmdiYShhcmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrbm93bkNvbG9ycy5pc0tub3duTmFtZShhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZXggPSBrbm93bkNvbG9ycy5nZXRLbm93bkNvbG9yKGFyZyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25hbWUgPSBhcmc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSB0aGlzLl9hcmdiRnJvbVN0cmluZyhoZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChIRVhfUkVHRVgudGVzdChhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZXggPSB0aGlzLl9ub3JtYWxpemVIZXgoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IHRoaXMuX2FyZ2JGcm9tU3RyaW5nKGhleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNvbG9yOiBcIiArIGFyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZXMuaXNOdW1iZXIoYXJnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FyZ2IgPSBhcmcgPj4+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxIG9yIDQgY29uc3RydWN0b3IgcGFyYW1ldGVycy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgdGhpcy5fYXJnYiA9IChhcmd1bWVudHNbMF0gJiAweEZGKSAqIDB4MDEwMDAwMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbMV0gJiAweEZGKSAqIDB4MDAwMTAwMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbMl0gJiAweEZGKSAqIDB4MDAwMDAxMDBcbiAgICAgICAgICAgICAgICArIChhcmd1bWVudHNbM10gJiAweEZGKSAqIDB4MDAwMDAwMDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxIG9yIDQgY29uc3RydWN0b3IgcGFyYW1ldGVycy5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJhXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDEwMDAwMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMTAwMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJnXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMDAxMDApICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJiXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAodGhpcy5fYXJnYiAvIDB4MDAwMDAwMDEpICYgMHhGRjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJhcmdiXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXJnYjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJoZXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmEgPT09IDB4RkYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFwiI1wiICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5yKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuZykgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLmIpKS50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcIiNcIiArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYSkgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLnIpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5nKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYikpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENvbG9yLnByb3RvdHlwZS5fYXJnYkZyb21TdHJpbmcgPSBmdW5jdGlvbiAoaGV4KSB7XG4gICAgICAgIGlmIChoZXguY2hhckF0KDApID09PSBcIiNcIikge1xuICAgICAgICAgICAgaGV4ID0gaGV4LnN1YnN0cigxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgaGV4ID0gaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIGhleCA9IGhleFswXSArIGhleFswXSArIGhleFsxXSArIGhleFsxXSArIGhleFsyXSArIGhleFsyXSArIGhleFszXSArIGhleFszXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW50VmFsID0gcGFyc2VJbnQoaGV4LCAxNik7XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSA2KSB7XG4gICAgICAgICAgICBpbnRWYWwgPSAoaW50VmFsICYgMHgwMEZGRkZGRikgKyAweEZGMDAwMDAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnRWYWw7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAmJiB0aGlzLmFyZ2IgPT09IHZhbHVlLmFyZ2I7XG4gICAgfTtcbiAgICBDb2xvci5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKCF2YWx1ZTEgJiYgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZTEgfHwgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTEuZXF1YWxzKHZhbHVlMik7XG4gICAgfTtcbiAgICBDb2xvci5pc1ZhbGlkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlcy5pc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgfHwgdmFsdWUgaW5zdGFuY2VvZiBDb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0eXBlcy5pc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoa25vd25Db2xvcnMuaXNLbm93bk5hbWUodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSEVYX1JFR0VYLnRlc3QodmFsdWUpIHx8IGlzUmdiT3JSZ2JhKHZhbHVlKTtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5fY29tcG9uZW50VG9IZXggPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XG4gICAgICAgIHZhciBoZXggPSBjb21wb25lbnQudG9TdHJpbmcoMTYpO1xuICAgICAgICBpZiAoaGV4Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgaGV4ID0gXCIwXCIgKyBoZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhleDtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5fbm9ybWFsaXplSGV4ID0gZnVuY3Rpb24gKGhleFN0cikge1xuICAgICAgICBpZiAoaGV4U3RyLmNoYXJBdCgwKSA9PT0gU0hBUlAgJiYgaGV4U3RyLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgaGV4U3RyID0gaGV4U3RyLmNoYXJBdCgwKVxuICAgICAgICAgICAgICAgICsgaGV4U3RyLmNoYXJBdCgxKSArIGhleFN0ci5jaGFyQXQoMSlcbiAgICAgICAgICAgICAgICArIGhleFN0ci5jaGFyQXQoMikgKyBoZXhTdHIuY2hhckF0KDIpXG4gICAgICAgICAgICAgICAgKyBoZXhTdHIuY2hhckF0KDMpICsgaGV4U3RyLmNoYXJBdCgzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGV4U3RyO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oZXg7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sb3I7XG59KCkpO1xuZXhwb3J0cy5Db2xvciA9IENvbG9yO1xuZnVuY3Rpb24gaXNSZ2JPclJnYmEodmFsdWUpIHtcbiAgICB2YXIgdG9Mb3dlciA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuICh0b0xvd2VyLmluZGV4T2YoXCJyZ2IoXCIpID09PSAwIHx8IHRvTG93ZXIuaW5kZXhPZihcInJnYmEoXCIpID09PSAwKSAmJiB0b0xvd2VyLmluZGV4T2YoXCIpXCIpID09PSAodG9Mb3dlci5sZW5ndGggLSAxKTtcbn1cbmZ1bmN0aW9uIGFyZ2JGcm9tUmdiT3JSZ2JhKHZhbHVlKSB7XG4gICAgdmFyIHRvTG93ZXIgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciBwYXJ0cyA9IHRvTG93ZXIucmVwbGFjZShcInJnYmEoXCIsIFwiXCIpLnJlcGxhY2UoXCJyZ2IoXCIsIFwiXCIpLnJlcGxhY2UoXCIpXCIsIFwiXCIpLnRyaW0oKS5zcGxpdChcIixcIik7XG4gICAgdmFyIHIgPSAyNTU7XG4gICAgdmFyIGcgPSAyNTU7XG4gICAgdmFyIGIgPSAyNTU7XG4gICAgdmFyIGEgPSAyNTU7XG4gICAgaWYgKHBhcnRzWzBdKSB7XG4gICAgICAgIHIgPSBwYXJzZUludChwYXJ0c1swXS50cmltKCkpO1xuICAgIH1cbiAgICBpZiAocGFydHNbMV0pIHtcbiAgICAgICAgZyA9IHBhcnNlSW50KHBhcnRzWzFdLnRyaW0oKSk7XG4gICAgfVxuICAgIGlmIChwYXJ0c1syXSkge1xuICAgICAgICBiID0gcGFyc2VJbnQocGFydHNbMl0udHJpbSgpKTtcbiAgICB9XG4gICAgaWYgKHBhcnRzWzNdKSB7XG4gICAgICAgIGEgPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQocGFydHNbM10udHJpbSgpKSAqIDI1NSk7XG4gICAgfVxuICAgIHJldHVybiAoYSAmIDB4RkYpICogMHgwMTAwMDAwMFxuICAgICAgICArIChyICYgMHhGRikgKiAweDAwMDEwMDAwXG4gICAgICAgICsgKGcgJiAweEZGKSAqIDB4MDAwMDAxMDBcbiAgICAgICAgKyAoYiAmIDB4RkYpICogMHgwMDAwMDAwMTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbG9yLWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29tbW9uID0gcmVxdWlyZShcIi4vY29sb3ItY29tbW9uXCIpO1xudmFyIENvbG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ29sb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29sb3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5faW9zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9zID0gVUlDb2xvci5hbGxvYygpLmluaXRXaXRoUmVkR3JlZW5CbHVlQWxwaGEodGhpcy5yIC8gMjU1LCB0aGlzLmcgLyAyNTUsIHRoaXMuYiAvIDI1NSwgdGhpcy5hIC8gMjU1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBDb2xvcjtcbn0oY29tbW9uLkNvbG9yKSk7XG5leHBvcnRzLkNvbG9yID0gQ29sb3I7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xvci5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIF9hbGxDb2xvcnMgPSB7fTtcbmZ1bmN0aW9uIHJlZ2lzdGVyQ29sb3IobmFtZSwgdmFsdWUpIHtcbiAgICBfYWxsQ29sb3JzW25hbWUudG9Mb3dlckNhc2UoKV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gdmFsdWU7XG59XG5mdW5jdGlvbiBpc0tub3duTmFtZShuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBuYW1lLnRvTG93ZXJDYXNlKCkgaW4gX2FsbENvbG9ycztcbn1cbmV4cG9ydHMuaXNLbm93bk5hbWUgPSBpc0tub3duTmFtZTtcbmZ1bmN0aW9uIGdldEtub3duQ29sb3IobmFtZSkge1xuICAgIGlmICghbmFtZSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gX2FsbENvbG9yc1tuYW1lLnRvTG93ZXJDYXNlKCldO1xufVxuZXhwb3J0cy5nZXRLbm93bkNvbG9yID0gZ2V0S25vd25Db2xvcjtcbmV4cG9ydHMuVHJhbnNwYXJlbnQgPSByZWdpc3RlckNvbG9yKFwiVHJhbnNwYXJlbnRcIiwgXCIjMDAwMDAwMDBcIik7XG5leHBvcnRzLkFsaWNlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJBbGljZUJsdWVcIiwgXCIjRjBGOEZGXCIpO1xuZXhwb3J0cy5BbnRpcXVlV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiQW50aXF1ZVdoaXRlXCIsIFwiI0ZBRUJEN1wiKTtcbmV4cG9ydHMuQXF1YSA9IHJlZ2lzdGVyQ29sb3IoXCJBcXVhXCIsIFwiIzAwRkZGRlwiKTtcbmV4cG9ydHMuQXF1YW1hcmluZSA9IHJlZ2lzdGVyQ29sb3IoXCJBcXVhbWFyaW5lXCIsIFwiIzdGRkZENFwiKTtcbmV4cG9ydHMuQXp1cmUgPSByZWdpc3RlckNvbG9yKFwiQXp1cmVcIiwgXCIjRjBGRkZGXCIpO1xuZXhwb3J0cy5CZWlnZSA9IHJlZ2lzdGVyQ29sb3IoXCJCZWlnZVwiLCBcIiNGNUY1RENcIik7XG5leHBvcnRzLkJpc3F1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJCaXNxdWVcIiwgXCIjRkZFNEM0XCIpO1xuZXhwb3J0cy5CbGFjayA9IHJlZ2lzdGVyQ29sb3IoXCJCbGFja1wiLCBcIiMwMDAwMDBcIik7XG5leHBvcnRzLkJsYW5jaGVkQWxtb25kID0gcmVnaXN0ZXJDb2xvcihcIkJsYW5jaGVkQWxtb25kXCIsIFwiI0ZGRUJDRFwiKTtcbmV4cG9ydHMuQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJCbHVlXCIsIFwiIzAwMDBGRlwiKTtcbmV4cG9ydHMuQmx1ZVZpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJCbHVlVmlvbGV0XCIsIFwiIzhBMkJFMlwiKTtcbmV4cG9ydHMuQnJvd24gPSByZWdpc3RlckNvbG9yKFwiQnJvd25cIiwgXCIjQTUyQTJBXCIpO1xuZXhwb3J0cy5CdXJseVdvb2QgPSByZWdpc3RlckNvbG9yKFwiQnVybHlXb29kXCIsIFwiI0RFQjg4N1wiKTtcbmV4cG9ydHMuQ2FkZXRCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkNhZGV0Qmx1ZVwiLCBcIiM1RjlFQTBcIik7XG5leHBvcnRzLkNoYXJ0cmV1c2UgPSByZWdpc3RlckNvbG9yKFwiQ2hhcnRyZXVzZVwiLCBcIiM3RkZGMDBcIik7XG5leHBvcnRzLkNob2NvbGF0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJDaG9jb2xhdGVcIiwgXCIjRDI2OTFFXCIpO1xuZXhwb3J0cy5Db3JhbCA9IHJlZ2lzdGVyQ29sb3IoXCJDb3JhbFwiLCBcIiNGRjdGNTBcIik7XG5leHBvcnRzLkNvcm5mbG93ZXJCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkNvcm5mbG93ZXJCbHVlXCIsIFwiIzY0OTVFRFwiKTtcbmV4cG9ydHMuQ29ybnNpbGsgPSByZWdpc3RlckNvbG9yKFwiQ29ybnNpbGtcIiwgXCIjRkZGOERDXCIpO1xuZXhwb3J0cy5Dcmltc29uID0gcmVnaXN0ZXJDb2xvcihcIkNyaW1zb25cIiwgXCIjREMxNDNDXCIpO1xuZXhwb3J0cy5DeWFuID0gcmVnaXN0ZXJDb2xvcihcIkN5YW5cIiwgXCIjMDBGRkZGXCIpO1xuZXhwb3J0cy5EYXJrQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrQmx1ZVwiLCBcIiMwMDAwOEJcIik7XG5leHBvcnRzLkRhcmtDeWFuID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtDeWFuXCIsIFwiIzAwOEI4QlwiKTtcbmV4cG9ydHMuRGFya0dvbGRlblJvZCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrR29sZGVuUm9kXCIsIFwiI0I4ODYwQlwiKTtcbmV4cG9ydHMuRGFya0dyYXkgPSByZWdpc3RlckNvbG9yKFwiRGFya0dyYXlcIiwgXCIjQTlBOUE5XCIpO1xuZXhwb3J0cy5EYXJrR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya0dyZWVuXCIsIFwiIzAwNjQwMFwiKTtcbmV4cG9ydHMuRGFya0toYWtpID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtLaGFraVwiLCBcIiNCREI3NkJcIik7XG5leHBvcnRzLkRhcmtNYWdlbnRhID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtNYWdlbnRhXCIsIFwiIzhCMDA4QlwiKTtcbmV4cG9ydHMuRGFya09saXZlR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya09saXZlR3JlZW5cIiwgXCIjNTU2QjJGXCIpO1xuZXhwb3J0cy5EYXJrT3JhbmdlID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtPcmFuZ2VcIiwgXCIjRkY4QzAwXCIpO1xuZXhwb3J0cy5EYXJrT3JjaGlkID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtPcmNoaWRcIiwgXCIjOTkzMkNDXCIpO1xuZXhwb3J0cy5EYXJrUmVkID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtSZWRcIiwgXCIjOEIwMDAwXCIpO1xuZXhwb3J0cy5EYXJrU2FsbW9uID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtTYWxtb25cIiwgXCIjRTk5NjdBXCIpO1xuZXhwb3J0cy5EYXJrU2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRGFya1NlYUdyZWVuXCIsIFwiIzhGQkM4RlwiKTtcbmV4cG9ydHMuRGFya1NsYXRlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2xhdGVCbHVlXCIsIFwiIzQ4M0Q4QlwiKTtcbmV4cG9ydHMuRGFya1NsYXRlR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2xhdGVHcmF5XCIsIFwiIzJGNEY0RlwiKTtcbmV4cG9ydHMuRGFya1R1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrVHVycXVvaXNlXCIsIFwiIzAwQ0VEMVwiKTtcbmV4cG9ydHMuRGFya1Zpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrVmlvbGV0XCIsIFwiIzk0MDBEM1wiKTtcbmV4cG9ydHMuRGVlcFBpbmsgPSByZWdpc3RlckNvbG9yKFwiRGVlcFBpbmtcIiwgXCIjRkYxNDkzXCIpO1xuZXhwb3J0cy5EZWVwU2t5Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEZWVwU2t5Qmx1ZVwiLCBcIiMwMEJGRkZcIik7XG5leHBvcnRzLkRpbUdyYXkgPSByZWdpc3RlckNvbG9yKFwiRGltR3JheVwiLCBcIiM2OTY5NjlcIik7XG5leHBvcnRzLkRvZGdlckJsdWUgPSByZWdpc3RlckNvbG9yKFwiRG9kZ2VyQmx1ZVwiLCBcIiMxRTkwRkZcIik7XG5leHBvcnRzLkZpcmVCcmljayA9IHJlZ2lzdGVyQ29sb3IoXCJGaXJlQnJpY2tcIiwgXCIjQjIyMjIyXCIpO1xuZXhwb3J0cy5GbG9yYWxXaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJGbG9yYWxXaGl0ZVwiLCBcIiNGRkZBRjBcIik7XG5leHBvcnRzLkZvcmVzdEdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkZvcmVzdEdyZWVuXCIsIFwiIzIyOEIyMlwiKTtcbmV4cG9ydHMuRnVjaHNpYSA9IHJlZ2lzdGVyQ29sb3IoXCJGdWNoc2lhXCIsIFwiI0ZGMDBGRlwiKTtcbmV4cG9ydHMuR2FpbnNib3JvID0gcmVnaXN0ZXJDb2xvcihcIkdhaW5zYm9yb1wiLCBcIiNEQ0RDRENcIik7XG5leHBvcnRzLkdob3N0V2hpdGUgPSByZWdpc3RlckNvbG9yKFwiR2hvc3RXaGl0ZVwiLCBcIiNGOEY4RkZcIik7XG5leHBvcnRzLkdvbGQgPSByZWdpc3RlckNvbG9yKFwiR29sZFwiLCBcIiNGRkQ3MDBcIik7XG5leHBvcnRzLkdvbGRlblJvZCA9IHJlZ2lzdGVyQ29sb3IoXCJHb2xkZW5Sb2RcIiwgXCIjREFBNTIwXCIpO1xuZXhwb3J0cy5HcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkdyYXlcIiwgXCIjODA4MDgwXCIpO1xuZXhwb3J0cy5HcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJHcmVlblwiLCBcIiMwMDgwMDBcIik7XG5leHBvcnRzLkdyZWVuWWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIkdyZWVuWWVsbG93XCIsIFwiI0FERkYyRlwiKTtcbmV4cG9ydHMuSG9uZXlEZXcgPSByZWdpc3RlckNvbG9yKFwiSG9uZXlEZXdcIiwgXCIjRjBGRkYwXCIpO1xuZXhwb3J0cy5Ib3RQaW5rID0gcmVnaXN0ZXJDb2xvcihcIkhvdFBpbmtcIiwgXCIjRkY2OUI0XCIpO1xuZXhwb3J0cy5JbmRpYW5SZWQgPSByZWdpc3RlckNvbG9yKFwiSW5kaWFuUmVkXCIsIFwiI0NENUM1Q1wiKTtcbmV4cG9ydHMuSW5kaWdvID0gcmVnaXN0ZXJDb2xvcihcIkluZGlnb1wiLCBcIiM0QjAwODJcIik7XG5leHBvcnRzLkl2b3J5ID0gcmVnaXN0ZXJDb2xvcihcIkl2b3J5XCIsIFwiI0ZGRkZGMFwiKTtcbmV4cG9ydHMuS2hha2kgPSByZWdpc3RlckNvbG9yKFwiS2hha2lcIiwgXCIjRjBFNjhDXCIpO1xuZXhwb3J0cy5MYXZlbmRlciA9IHJlZ2lzdGVyQ29sb3IoXCJMYXZlbmRlclwiLCBcIiNFNkU2RkFcIik7XG5leHBvcnRzLkxhdmVuZGVyQmx1c2ggPSByZWdpc3RlckNvbG9yKFwiTGF2ZW5kZXJCbHVzaFwiLCBcIiNGRkYwRjVcIik7XG5leHBvcnRzLkxhd25HcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJMYXduR3JlZW5cIiwgXCIjN0NGQzAwXCIpO1xuZXhwb3J0cy5MZW1vbkNoaWZmb24gPSByZWdpc3RlckNvbG9yKFwiTGVtb25DaGlmZm9uXCIsIFwiI0ZGRkFDRFwiKTtcbmV4cG9ydHMuTGlnaHRCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0Qmx1ZVwiLCBcIiNBREQ4RTZcIik7XG5leHBvcnRzLkxpZ2h0Q29yYWwgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRDb3JhbFwiLCBcIiNGMDgwODBcIik7XG5leHBvcnRzLkxpZ2h0Q3lhbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEN5YW5cIiwgXCIjRTBGRkZGXCIpO1xuZXhwb3J0cy5MaWdodEdvbGRlblJvZFllbGxvdyA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEdvbGRlblJvZFllbGxvd1wiLCBcIiNGQUZBRDJcIik7XG5leHBvcnRzLkxpZ2h0R3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodEdyYXlcIiwgXCIjRDNEM0QzXCIpO1xuZXhwb3J0cy5MaWdodEdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0R3JlZW5cIiwgXCIjOTBFRTkwXCIpO1xuZXhwb3J0cy5MaWdodFBpbmsgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRQaW5rXCIsIFwiI0ZGQjZDMVwiKTtcbmV4cG9ydHMuTGlnaHRTYWxtb24gPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTYWxtb25cIiwgXCIjRkZBMDdBXCIpO1xuZXhwb3J0cy5MaWdodFNlYUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U2VhR3JlZW5cIiwgXCIjMjBCMkFBXCIpO1xuZXhwb3J0cy5MaWdodFNreUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTa3lCbHVlXCIsIFwiIzg3Q0VGQVwiKTtcbmV4cG9ydHMuTGlnaHRTbGF0ZUdyYXkgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTbGF0ZUdyYXlcIiwgXCIjNzc4ODk5XCIpO1xuZXhwb3J0cy5MaWdodFN0ZWVsQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFN0ZWVsQmx1ZVwiLCBcIiNCMEM0REVcIik7XG5leHBvcnRzLkxpZ2h0WWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0WWVsbG93XCIsIFwiI0ZGRkZFMFwiKTtcbmV4cG9ydHMuTGltZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaW1lXCIsIFwiIzAwRkYwMFwiKTtcbmV4cG9ydHMuTGltZUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxpbWVHcmVlblwiLCBcIiMzMkNEMzJcIik7XG5leHBvcnRzLkxpbmVuID0gcmVnaXN0ZXJDb2xvcihcIkxpbmVuXCIsIFwiI0ZBRjBFNlwiKTtcbmV4cG9ydHMuTWFnZW50YSA9IHJlZ2lzdGVyQ29sb3IoXCJNYWdlbnRhXCIsIFwiI0ZGMDBGRlwiKTtcbmV4cG9ydHMuTWFyb29uID0gcmVnaXN0ZXJDb2xvcihcIk1hcm9vblwiLCBcIiM4MDAwMDBcIik7XG5leHBvcnRzLk1lZGl1bUFxdWFNYXJpbmUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtQXF1YU1hcmluZVwiLCBcIiM2NkNEQUFcIik7XG5leHBvcnRzLk1lZGl1bUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtQmx1ZVwiLCBcIiMwMDAwQ0RcIik7XG5leHBvcnRzLk1lZGl1bU9yY2hpZCA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1PcmNoaWRcIiwgXCIjQkE1NUQzXCIpO1xuZXhwb3J0cy5NZWRpdW1QdXJwbGUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtUHVycGxlXCIsIFwiIzkzNzBEQlwiKTtcbmV4cG9ydHMuTWVkaXVtU2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU2VhR3JlZW5cIiwgXCIjM0NCMzcxXCIpO1xuZXhwb3J0cy5NZWRpdW1TbGF0ZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU2xhdGVCbHVlXCIsIFwiIzdCNjhFRVwiKTtcbmV4cG9ydHMuTWVkaXVtU3ByaW5nR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtU3ByaW5nR3JlZW5cIiwgXCIjMDBGQTlBXCIpO1xuZXhwb3J0cy5NZWRpdW1UdXJxdW9pc2UgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtVHVycXVvaXNlXCIsIFwiIzQ4RDFDQ1wiKTtcbmV4cG9ydHMuTWVkaXVtVmlvbGV0UmVkID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bVZpb2xldFJlZFwiLCBcIiNDNzE1ODVcIik7XG5leHBvcnRzLk1pZG5pZ2h0Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJNaWRuaWdodEJsdWVcIiwgXCIjMTkxOTcwXCIpO1xuZXhwb3J0cy5NaW50Q3JlYW0gPSByZWdpc3RlckNvbG9yKFwiTWludENyZWFtXCIsIFwiI0Y1RkZGQVwiKTtcbmV4cG9ydHMuTWlzdHlSb3NlID0gcmVnaXN0ZXJDb2xvcihcIk1pc3R5Um9zZVwiLCBcIiNGRkU0RTFcIik7XG5leHBvcnRzLk1vY2Nhc2luID0gcmVnaXN0ZXJDb2xvcihcIk1vY2Nhc2luXCIsIFwiI0ZGRTRCNVwiKTtcbmV4cG9ydHMuTmF2YWpvV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiTmF2YWpvV2hpdGVcIiwgXCIjRkZERUFEXCIpO1xuZXhwb3J0cy5OYXZ5ID0gcmVnaXN0ZXJDb2xvcihcIk5hdnlcIiwgXCIjMDAwMDgwXCIpO1xuZXhwb3J0cy5PbGRMYWNlID0gcmVnaXN0ZXJDb2xvcihcIk9sZExhY2VcIiwgXCIjRkRGNUU2XCIpO1xuZXhwb3J0cy5PbGl2ZSA9IHJlZ2lzdGVyQ29sb3IoXCJPbGl2ZVwiLCBcIiM4MDgwMDBcIik7XG5leHBvcnRzLk9saXZlRHJhYiA9IHJlZ2lzdGVyQ29sb3IoXCJPbGl2ZURyYWJcIiwgXCIjNkI4RTIzXCIpO1xuZXhwb3J0cy5PcmFuZ2UgPSByZWdpc3RlckNvbG9yKFwiT3JhbmdlXCIsIFwiI0ZGQTUwMFwiKTtcbmV4cG9ydHMuT3JhbmdlUmVkID0gcmVnaXN0ZXJDb2xvcihcIk9yYW5nZVJlZFwiLCBcIiNGRjQ1MDBcIik7XG5leHBvcnRzLk9yY2hpZCA9IHJlZ2lzdGVyQ29sb3IoXCJPcmNoaWRcIiwgXCIjREE3MEQ2XCIpO1xuZXhwb3J0cy5QYWxlR29sZGVuUm9kID0gcmVnaXN0ZXJDb2xvcihcIlBhbGVHb2xkZW5Sb2RcIiwgXCIjRUVFOEFBXCIpO1xuZXhwb3J0cy5QYWxlR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiUGFsZUdyZWVuXCIsIFwiIzk4RkI5OFwiKTtcbmV4cG9ydHMuUGFsZVR1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlVHVycXVvaXNlXCIsIFwiI0FGRUVFRVwiKTtcbmV4cG9ydHMuUGFsZVZpb2xldFJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlVmlvbGV0UmVkXCIsIFwiI0RCNzA5M1wiKTtcbmV4cG9ydHMuUGFwYXlhV2hpcCA9IHJlZ2lzdGVyQ29sb3IoXCJQYXBheWFXaGlwXCIsIFwiI0ZGRUZENVwiKTtcbmV4cG9ydHMuUGVhY2hQdWZmID0gcmVnaXN0ZXJDb2xvcihcIlBlYWNoUHVmZlwiLCBcIiNGRkRBQjlcIik7XG5leHBvcnRzLlBlcnUgPSByZWdpc3RlckNvbG9yKFwiUGVydVwiLCBcIiNDRDg1M0ZcIik7XG5leHBvcnRzLlBpbmsgPSByZWdpc3RlckNvbG9yKFwiUGlua1wiLCBcIiNGRkMwQ0JcIik7XG5leHBvcnRzLlBsdW0gPSByZWdpc3RlckNvbG9yKFwiUGx1bVwiLCBcIiNEREEwRERcIik7XG5leHBvcnRzLlBvd2RlckJsdWUgPSByZWdpc3RlckNvbG9yKFwiUG93ZGVyQmx1ZVwiLCBcIiNCMEUwRTZcIik7XG5leHBvcnRzLlB1cnBsZSA9IHJlZ2lzdGVyQ29sb3IoXCJQdXJwbGVcIiwgXCIjODAwMDgwXCIpO1xuZXhwb3J0cy5SZWJlY2NhUHVycGxlID0gcmVnaXN0ZXJDb2xvcihcIlJlYmVjY2FQdXJwbGVcIiwgXCIjNjYzMzk5XCIpO1xuZXhwb3J0cy5SZWQgPSByZWdpc3RlckNvbG9yKFwiUmVkXCIsIFwiI0ZGMDAwMFwiKTtcbmV4cG9ydHMuUm9zeUJyb3duID0gcmVnaXN0ZXJDb2xvcihcIlJvc3lCcm93blwiLCBcIiNCQzhGOEZcIik7XG5leHBvcnRzLlJveWFsQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJSb3lhbEJsdWVcIiwgXCIjNDE2OUUxXCIpO1xuZXhwb3J0cy5TYWRkbGVCcm93biA9IHJlZ2lzdGVyQ29sb3IoXCJTYWRkbGVCcm93blwiLCBcIiM4QjQ1MTNcIik7XG5leHBvcnRzLlNhbG1vbiA9IHJlZ2lzdGVyQ29sb3IoXCJTYWxtb25cIiwgXCIjRkE4MDcyXCIpO1xuZXhwb3J0cy5TYW5keUJyb3duID0gcmVnaXN0ZXJDb2xvcihcIlNhbmR5QnJvd25cIiwgXCIjRjRBNDYwXCIpO1xuZXhwb3J0cy5TZWFHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJTZWFHcmVlblwiLCBcIiMyRThCNTdcIik7XG5leHBvcnRzLlNlYVNoZWxsID0gcmVnaXN0ZXJDb2xvcihcIlNlYVNoZWxsXCIsIFwiI0ZGRjVFRVwiKTtcbmV4cG9ydHMuU2llbm5hID0gcmVnaXN0ZXJDb2xvcihcIlNpZW5uYVwiLCBcIiNBMDUyMkRcIik7XG5leHBvcnRzLlNpbHZlciA9IHJlZ2lzdGVyQ29sb3IoXCJTaWx2ZXJcIiwgXCIjQzBDMEMwXCIpO1xuZXhwb3J0cy5Ta3lCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlNreUJsdWVcIiwgXCIjODdDRUVCXCIpO1xuZXhwb3J0cy5TbGF0ZUJsdWUgPSByZWdpc3RlckNvbG9yKFwiU2xhdGVCbHVlXCIsIFwiIzZBNUFDRFwiKTtcbmV4cG9ydHMuU2xhdGVHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIlNsYXRlR3JheVwiLCBcIiM3MDgwOTBcIik7XG5leHBvcnRzLlNub3cgPSByZWdpc3RlckNvbG9yKFwiU25vd1wiLCBcIiNGRkZBRkFcIik7XG5leHBvcnRzLlNwcmluZ0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlNwcmluZ0dyZWVuXCIsIFwiIzAwRkY3RlwiKTtcbmV4cG9ydHMuU3RlZWxCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlN0ZWVsQmx1ZVwiLCBcIiM0NjgyQjRcIik7XG5leHBvcnRzLlRhbiA9IHJlZ2lzdGVyQ29sb3IoXCJUYW5cIiwgXCIjRDJCNDhDXCIpO1xuZXhwb3J0cy5UZWFsID0gcmVnaXN0ZXJDb2xvcihcIlRlYWxcIiwgXCIjMDA4MDgwXCIpO1xuZXhwb3J0cy5UaGlzdGxlID0gcmVnaXN0ZXJDb2xvcihcIlRoaXN0bGVcIiwgXCIjRDhCRkQ4XCIpO1xuZXhwb3J0cy5Ub21hdG8gPSByZWdpc3RlckNvbG9yKFwiVG9tYXRvXCIsIFwiI0ZGNjM0N1wiKTtcbmV4cG9ydHMuVHVycXVvaXNlID0gcmVnaXN0ZXJDb2xvcihcIlR1cnF1b2lzZVwiLCBcIiM0MEUwRDBcIik7XG5leHBvcnRzLlZpb2xldCA9IHJlZ2lzdGVyQ29sb3IoXCJWaW9sZXRcIiwgXCIjRUU4MkVFXCIpO1xuZXhwb3J0cy5XaGVhdCA9IHJlZ2lzdGVyQ29sb3IoXCJXaGVhdFwiLCBcIiNGNURFQjNcIik7XG5leHBvcnRzLldoaXRlID0gcmVnaXN0ZXJDb2xvcihcIldoaXRlXCIsIFwiI0ZGRkZGRlwiKTtcbmV4cG9ydHMuV2hpdGVTbW9rZSA9IHJlZ2lzdGVyQ29sb3IoXCJXaGl0ZVNtb2tlXCIsIFwiI0Y1RjVGNVwiKTtcbmV4cG9ydHMuWWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIlllbGxvd1wiLCBcIiNGRkZGMDBcIik7XG5leHBvcnRzLlllbGxvd0dyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlllbGxvd0dyZWVuXCIsIFwiIzlBQ0QzMlwiKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtub3duLWNvbG9ycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ29uc29sZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29uc29sZSgpIHtcbiAgICB9XG4gICAgQ29uc29sZS5wcm90b3R5cGUudGltZSA9IGZ1bmN0aW9uIChyZXBvcnROYW1lKSB7XG4gICAgfTtcbiAgICBDb25zb2xlLnByb3RvdHlwZS50aW1lRW5kID0gZnVuY3Rpb24gKHJlcG9ydE5hbWUpIHtcbiAgICB9O1xuICAgIENvbnNvbGUucHJvdG90eXBlLmFzc2VydCA9IGZ1bmN0aW9uICh0ZXN0LCBtZXNzYWdlKSB7XG4gICAgfTtcbiAgICBDb25zb2xlLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB9O1xuICAgIENvbnNvbGUucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB9O1xuICAgIENvbnNvbGUucHJvdG90eXBlLnRyYWNlID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUuZGlyID0gZnVuY3Rpb24gKG9iaikge1xuICAgIH07XG4gICAgcmV0dXJuIENvbnNvbGU7XG59KCkpO1xuZXhwb3J0cy5Db25zb2xlID0gQ29uc29sZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnNvbGUuanMubWFwIiwiXG5leHBvcnRzLnBhcnNlID0gcGFyc2U7XG5cbmZ1bmN0aW9uIHBhcnNlKHN0cikge1xuICByZXR1cm4gbmV3IFBhcnNlcihzdHIpLnBhcnNlKCk7XG59XG5cbmZ1bmN0aW9uIFBhcnNlcihzdHIpIHtcbiAgdGhpcy5zdHIgPSBzdHI7XG59XG5cblBhcnNlci5wcm90b3R5cGUuc2tpcCA9IGZ1bmN0aW9uKG0pe1xuICB0aGlzLnN0ciA9IHRoaXMuc3RyLnNsaWNlKG1bMF0ubGVuZ3RoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuY29tbWEgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eLCAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHsgdHlwZTogJ2NvbW1hJywgc3RyaW5nOiAnLCcgfTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuaWRlbnQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKFtcXHctXSspICovLmV4ZWModGhpcy5zdHIpO1xuICBpZiAoIW0pIHJldHVybjtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdpZGVudCcsXG4gICAgc3RyaW5nOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuaW50ID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXigoWy1cXCtdP1xcZCspKFxcUyspPykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHZhciBuID0gfn5tWzJdO1xuICB2YXIgdSA9IG1bM107XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICBzdHJpbmc6IG1bMV0sXG4gICAgdW5pdDogdSB8fCAnJyxcbiAgICB2YWx1ZTogblxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLmZsb2F0ID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXigoKD86Wy1cXCtdP1xcZCspP1xcLlxcZCspKFxcUyspPykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHZhciBuID0gcGFyc2VGbG9hdChtWzJdKTtcbiAgdmFyIHUgPSBtWzNdO1xuXG4gIHJldHVybiB7XG4gICAgdHlwZTogJ251bWJlcicsXG4gICAgc3RyaW5nOiBtWzFdLFxuICAgIHVuaXQ6IHUgfHwgJycsXG4gICAgdmFsdWU6IG5cbiAgfVxufTtcblxuUGFyc2VyLnByb3RvdHlwZS5udW1iZXIgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gdGhpcy5mbG9hdCgpIHx8IHRoaXMuaW50KCk7XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLmRvdWJsZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL15cIihbXlwiXSopXCIgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuIG07XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBxdW90ZTogJ1wiJyxcbiAgICBzdHJpbmc6ICdcIicgKyBtWzFdICsgJ1wiJyxcbiAgICB2YWx1ZTogbVsxXVxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnNpbmdsZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14nKFteJ10qKScgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuIG07XG4gIHRoaXMuc2tpcChtKTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICBxdW90ZTogXCInXCIsXG4gICAgc3RyaW5nOiBcIidcIiArIG1bMV0gKyBcIidcIixcbiAgICB2YWx1ZTogbVsxXVxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnN0cmluZyA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLnNpbmdsZSgpIHx8IHRoaXMuZG91YmxlKCk7XG59O1xuXG5cblBhcnNlci5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbigpe1xuICByZXR1cm4gdGhpcy5udW1iZXIoKVxuICAgIHx8IHRoaXMuaWRlbnQoKVxuICAgIHx8IHRoaXMuc3RyaW5nKClcbiAgICB8fCB0aGlzLmNvbW1hKCk7XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24oKXtcbiAgdmFyIHZhbHMgPSBbXTtcblxuICB3aGlsZSAodGhpcy5zdHIubGVuZ3RoKSB7XG4gICAgdmFyIG9iaiA9IHRoaXMudmFsdWUoKTtcbiAgICBpZiAoIW9iaikgdGhyb3cgbmV3IEVycm9yKCdmYWlsZWQgdG8gcGFyc2UgbmVhciBgJyArIHRoaXMuc3RyLnNsaWNlKDAsIDEwKSArICcuLi5gJyk7XG4gICAgdmFscy5wdXNoKG9iaik7XG4gIH1cblxuICByZXR1cm4gdmFscztcbn07XG4iLCJleHBvcnRzLnBhcnNlID0gcmVxdWlyZSgnLi9saWIvcGFyc2UnKTtcbiIsIi8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL2dyYW1tYXIuaHRtbFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3Zpc2lvbm1lZGlhL2Nzcy1wYXJzZS9wdWxsLzQ5I2lzc3VlY29tbWVudC0zMDA4ODAyN1xudmFyIGNvbW1lbnRyZSA9IC9cXC9cXCpbXipdKlxcKisoW14vKl1bXipdKlxcKispKlxcLy9nXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oY3NzLCBvcHRpb25zKXtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgLyoqXG4gICAqIFBvc2l0aW9uYWwuXG4gICAqL1xuXG4gIHZhciBsaW5lbm8gPSAxO1xuICB2YXIgY29sdW1uID0gMTtcblxuICAvKipcbiAgICogVXBkYXRlIGxpbmVubyBhbmQgY29sdW1uIGJhc2VkIG9uIGBzdHJgLlxuICAgKi9cblxuICBmdW5jdGlvbiB1cGRhdGVQb3NpdGlvbihzdHIpIHtcbiAgICB2YXIgbGluZXMgPSBzdHIubWF0Y2goL1xcbi9nKTtcbiAgICBpZiAobGluZXMpIGxpbmVubyArPSBsaW5lcy5sZW5ndGg7XG4gICAgdmFyIGkgPSBzdHIubGFzdEluZGV4T2YoJ1xcbicpO1xuICAgIGNvbHVtbiA9IH5pID8gc3RyLmxlbmd0aCAtIGkgOiBjb2x1bW4gKyBzdHIubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hcmsgcG9zaXRpb24gYW5kIHBhdGNoIGBub2RlLnBvc2l0aW9uYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gcG9zaXRpb24oKSB7XG4gICAgdmFyIHN0YXJ0ID0geyBsaW5lOiBsaW5lbm8sIGNvbHVtbjogY29sdW1uIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uKG5vZGUpe1xuICAgICAgbm9kZS5wb3NpdGlvbiA9IG5ldyBQb3NpdGlvbihzdGFydCk7XG4gICAgICB3aGl0ZXNwYWNlKCk7XG4gICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3JlIHBvc2l0aW9uIGluZm9ybWF0aW9uIGZvciBhIG5vZGVcbiAgICovXG5cbiAgZnVuY3Rpb24gUG9zaXRpb24oc3RhcnQpIHtcbiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gICAgdGhpcy5lbmQgPSB7IGxpbmU6IGxpbmVubywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICB0aGlzLnNvdXJjZSA9IG9wdGlvbnMuc291cmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIE5vbi1lbnVtZXJhYmxlIHNvdXJjZSBzdHJpbmdcbiAgICovXG5cbiAgUG9zaXRpb24ucHJvdG90eXBlLmNvbnRlbnQgPSBjc3M7XG5cbiAgLyoqXG4gICAqIEVycm9yIGBtc2dgLlxuICAgKi9cblxuICB2YXIgZXJyb3JzTGlzdCA9IFtdO1xuXG4gIGZ1bmN0aW9uIGVycm9yKG1zZykge1xuICAgIHZhciBlcnIgPSBuZXcgRXJyb3Iob3B0aW9ucy5zb3VyY2UgKyAnOicgKyBsaW5lbm8gKyAnOicgKyBjb2x1bW4gKyAnOiAnICsgbXNnKTtcbiAgICBlcnIucmVhc29uID0gbXNnO1xuICAgIGVyci5maWxlbmFtZSA9IG9wdGlvbnMuc291cmNlO1xuICAgIGVyci5saW5lID0gbGluZW5vO1xuICAgIGVyci5jb2x1bW4gPSBjb2x1bW47XG4gICAgZXJyLnNvdXJjZSA9IGNzcztcblxuICAgIGlmIChvcHRpb25zLnNpbGVudCkge1xuICAgICAgZXJyb3JzTGlzdC5wdXNoKGVycik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Ugc3R5bGVzaGVldC5cbiAgICovXG5cbiAgZnVuY3Rpb24gc3R5bGVzaGVldCgpIHtcbiAgICB2YXIgcnVsZXNMaXN0ID0gcnVsZXMoKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnc3R5bGVzaGVldCcsXG4gICAgICBzdHlsZXNoZWV0OiB7XG4gICAgICAgIHJ1bGVzOiBydWxlc0xpc3QsXG4gICAgICAgIHBhcnNpbmdFcnJvcnM6IGVycm9yc0xpc3RcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW5pbmcgYnJhY2UuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgcmV0dXJuIG1hdGNoKC9ee1xccyovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zaW5nIGJyYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICByZXR1cm4gbWF0Y2goL159Lyk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcnVsZXNldC5cbiAgICovXG5cbiAgZnVuY3Rpb24gcnVsZXMoKSB7XG4gICAgdmFyIG5vZGU7XG4gICAgdmFyIHJ1bGVzID0gW107XG4gICAgd2hpdGVzcGFjZSgpO1xuICAgIGNvbW1lbnRzKHJ1bGVzKTtcbiAgICB3aGlsZSAoY3NzLmxlbmd0aCAmJiBjc3MuY2hhckF0KDApICE9ICd9JyAmJiAobm9kZSA9IGF0cnVsZSgpIHx8IHJ1bGUoKSkpIHtcbiAgICAgIGlmIChub2RlICE9PSBmYWxzZSkge1xuICAgICAgICBydWxlcy5wdXNoKG5vZGUpO1xuICAgICAgICBjb21tZW50cyhydWxlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBydWxlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBNYXRjaCBgcmVgIGFuZCByZXR1cm4gY2FwdHVyZXMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIG1hdGNoKHJlKSB7XG4gICAgdmFyIG0gPSByZS5leGVjKGNzcyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG4gICAgdmFyIHN0ciA9IG1bMF07XG4gICAgdXBkYXRlUG9zaXRpb24oc3RyKTtcbiAgICBjc3MgPSBjc3Muc2xpY2Uoc3RyLmxlbmd0aCk7XG4gICAgcmV0dXJuIG07XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Ugd2hpdGVzcGFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gd2hpdGVzcGFjZSgpIHtcbiAgICBtYXRjaCgvXlxccyovKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBjb21tZW50cztcbiAgICovXG5cbiAgZnVuY3Rpb24gY29tbWVudHMocnVsZXMpIHtcbiAgICB2YXIgYztcbiAgICBydWxlcyA9IHJ1bGVzIHx8IFtdO1xuICAgIHdoaWxlIChjID0gY29tbWVudCgpKSB7XG4gICAgICBpZiAoYyAhPT0gZmFsc2UpIHtcbiAgICAgICAgcnVsZXMucHVzaChjKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJ1bGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNvbW1lbnQuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNvbW1lbnQoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgaWYgKCcvJyAhPSBjc3MuY2hhckF0KDApIHx8ICcqJyAhPSBjc3MuY2hhckF0KDEpKSByZXR1cm47XG5cbiAgICB2YXIgaSA9IDI7XG4gICAgd2hpbGUgKFwiXCIgIT0gY3NzLmNoYXJBdChpKSAmJiAoJyonICE9IGNzcy5jaGFyQXQoaSkgfHwgJy8nICE9IGNzcy5jaGFyQXQoaSArIDEpKSkgKytpO1xuICAgIGkgKz0gMjtcblxuICAgIGlmIChcIlwiID09PSBjc3MuY2hhckF0KGktMSkpIHtcbiAgICAgIHJldHVybiBlcnJvcignRW5kIG9mIGNvbW1lbnQgbWlzc2luZycpO1xuICAgIH1cblxuICAgIHZhciBzdHIgPSBjc3Muc2xpY2UoMiwgaSAtIDIpO1xuICAgIGNvbHVtbiArPSAyO1xuICAgIHVwZGF0ZVBvc2l0aW9uKHN0cik7XG4gICAgY3NzID0gY3NzLnNsaWNlKGkpO1xuICAgIGNvbHVtbiArPSAyO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnY29tbWVudCcsXG4gICAgICBjb21tZW50OiBzdHJcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzZWxlY3Rvci5cbiAgICovXG5cbiAgZnVuY3Rpb24gc2VsZWN0b3IoKSB7XG4gICAgdmFyIG0gPSBtYXRjaCgvXihbXntdKykvKTtcbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICAvKiBAZml4IFJlbW92ZSBhbGwgY29tbWVudHMgZnJvbSBzZWxlY3RvcnNcbiAgICAgKiBodHRwOi8vb3N0ZXJtaWxsZXIub3JnL2ZpbmRjb21tZW50Lmh0bWwgKi9cbiAgICByZXR1cm4gdHJpbShtWzBdKVxuICAgICAgLnJlcGxhY2UoL1xcL1xcKihbXipdfFtcXHJcXG5dfChcXCorKFteKi9dfFtcXHJcXG5dKSkpKlxcKlxcLysvZywgJycpXG4gICAgICAucmVwbGFjZSgvXCIoPzpcXFxcXCJ8W15cIl0pKlwifCcoPzpcXFxcJ3xbXiddKSonL2csIGZ1bmN0aW9uKG0pIHtcbiAgICAgICAgcmV0dXJuIG0ucmVwbGFjZSgvLC9nLCAnXFx1MjAwQycpO1xuICAgICAgfSlcbiAgICAgIC5zcGxpdCgvXFxzKig/IVteKF0qXFwpKSxcXHMqLylcbiAgICAgIC5tYXAoZnVuY3Rpb24ocykge1xuICAgICAgICByZXR1cm4gcy5yZXBsYWNlKC9cXHUyMDBDL2csICcsJyk7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkZWNsYXJhdGlvbi5cbiAgICovXG5cbiAgZnVuY3Rpb24gZGVjbGFyYXRpb24oKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG5cbiAgICAvLyBwcm9wXG4gICAgdmFyIHByb3AgPSBtYXRjaCgvXihcXCo/Wy0jXFwvXFwqXFxcXFxcd10rKFxcW1swLTlhLXpfLV0rXFxdKT8pXFxzKi8pO1xuICAgIGlmICghcHJvcCkgcmV0dXJuO1xuICAgIHByb3AgPSB0cmltKHByb3BbMF0pO1xuXG4gICAgLy8gOlxuICAgIGlmICghbWF0Y2goL146XFxzKi8pKSByZXR1cm4gZXJyb3IoXCJwcm9wZXJ0eSBtaXNzaW5nICc6J1wiKTtcblxuICAgIC8vIHZhbFxuICAgIHZhciB2YWwgPSBtYXRjaCgvXigoPzonKD86XFxcXCd8LikqPyd8XCIoPzpcXFxcXCJ8LikqP1wifFxcKFteXFwpXSo/XFwpfFtefTtdKSspLyk7XG5cbiAgICB2YXIgcmV0ID0gcG9zKHtcbiAgICAgIHR5cGU6ICdkZWNsYXJhdGlvbicsXG4gICAgICBwcm9wZXJ0eTogcHJvcC5yZXBsYWNlKGNvbW1lbnRyZSwgJycpLFxuICAgICAgdmFsdWU6IHZhbCA/IHRyaW0odmFsWzBdKS5yZXBsYWNlKGNvbW1lbnRyZSwgJycpIDogJydcbiAgICB9KTtcblxuICAgIC8vIDtcbiAgICBtYXRjaCgvXls7XFxzXSovKTtcblxuICAgIHJldHVybiByZXQ7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgZGVjbGFyYXRpb25zLlxuICAgKi9cblxuICBmdW5jdGlvbiBkZWNsYXJhdGlvbnMoKSB7XG4gICAgdmFyIGRlY2xzID0gW107XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwibWlzc2luZyAneydcIik7XG4gICAgY29tbWVudHMoZGVjbHMpO1xuXG4gICAgLy8gZGVjbGFyYXRpb25zXG4gICAgdmFyIGRlY2w7XG4gICAgd2hpbGUgKGRlY2wgPSBkZWNsYXJhdGlvbigpKSB7XG4gICAgICBpZiAoZGVjbCAhPT0gZmFsc2UpIHtcbiAgICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgICAgY29tbWVudHMoZGVjbHMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwibWlzc2luZyAnfSdcIik7XG4gICAgcmV0dXJuIGRlY2xzO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGtleWZyYW1lLlxuICAgKi9cblxuICBmdW5jdGlvbiBrZXlmcmFtZSgpIHtcbiAgICB2YXIgbTtcbiAgICB2YXIgdmFscyA9IFtdO1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuXG4gICAgd2hpbGUgKG0gPSBtYXRjaCgvXigoXFxkK1xcLlxcZCt8XFwuXFxkK3xcXGQrKSU/fFthLXpdKylcXHMqLykpIHtcbiAgICAgIHZhbHMucHVzaChtWzFdKTtcbiAgICAgIG1hdGNoKC9eLFxccyovKTtcbiAgICB9XG5cbiAgICBpZiAoIXZhbHMubGVuZ3RoKSByZXR1cm47XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdrZXlmcmFtZScsXG4gICAgICB2YWx1ZXM6IHZhbHMsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xhcmF0aW9ucygpXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Uga2V5ZnJhbWVzLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGtleWZyYW1lcygpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQChbLVxcd10rKT9rZXlmcmFtZXNcXHMqLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgdmVuZG9yID0gbVsxXTtcblxuICAgIC8vIGlkZW50aWZpZXJcbiAgICB2YXIgbSA9IG1hdGNoKC9eKFstXFx3XSspXFxzKi8pO1xuICAgIGlmICghbSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nIG5hbWVcIik7XG4gICAgdmFyIG5hbWUgPSBtWzFdO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBrZXlmcmFtZXMgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgZnJhbWU7XG4gICAgdmFyIGZyYW1lcyA9IGNvbW1lbnRzKCk7XG4gICAgd2hpbGUgKGZyYW1lID0ga2V5ZnJhbWUoKSkge1xuICAgICAgZnJhbWVzLnB1c2goZnJhbWUpO1xuICAgICAgZnJhbWVzID0gZnJhbWVzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBrZXlmcmFtZXMgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdrZXlmcmFtZXMnLFxuICAgICAgbmFtZTogbmFtZSxcbiAgICAgIHZlbmRvcjogdmVuZG9yLFxuICAgICAga2V5ZnJhbWVzOiBmcmFtZXNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzdXBwb3J0cy5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRzdXBwb3J0cygpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQHN1cHBvcnRzICooW157XSspLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgc3VwcG9ydHMgPSB0cmltKG1bMV0pO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBzdXBwb3J0cyBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBzdHlsZSA9IGNvbW1lbnRzKCkuY29uY2F0KHJ1bGVzKCkpO1xuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJAc3VwcG9ydHMgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdzdXBwb3J0cycsXG4gICAgICBzdXBwb3J0czogc3VwcG9ydHMsXG4gICAgICBydWxlczogc3R5bGVcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBob3N0LlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGhvc3QoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBob3N0XFxzKi8pO1xuXG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGhvc3QgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGhvc3QgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdob3N0JyxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIG1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdG1lZGlhKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AbWVkaWEgKihbXntdKykvKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciBtZWRpYSA9IHRyaW0obVsxXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQG1lZGlhIG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBtZWRpYSBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ21lZGlhJyxcbiAgICAgIG1lZGlhOiBtZWRpYSxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cblxuICAvKipcbiAgICogUGFyc2UgY3VzdG9tLW1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGN1c3RvbW1lZGlhKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AY3VzdG9tLW1lZGlhXFxzKygtLVteXFxzXSspXFxzKihbXns7XSspOy8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnY3VzdG9tLW1lZGlhJyxcbiAgICAgIG5hbWU6IHRyaW0obVsxXSksXG4gICAgICBtZWRpYTogdHJpbShtWzJdKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHBhZ2VkIG1lZGlhLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdHBhZ2UoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBwYWdlICovKTtcbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIHZhciBzZWwgPSBzZWxlY3RvcigpIHx8IFtdO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBwYWdlIG1pc3NpbmcgJ3snXCIpO1xuICAgIHZhciBkZWNscyA9IGNvbW1lbnRzKCk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGRlY2xzLnB1c2goZGVjbCk7XG4gICAgICBkZWNscyA9IGRlY2xzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBwYWdlIG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAncGFnZScsXG4gICAgICBzZWxlY3RvcnM6IHNlbCxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbHNcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkb2N1bWVudC5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRkb2N1bWVudCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQChbLVxcd10rKT9kb2N1bWVudCAqKFtee10rKS8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgdmFyIHZlbmRvciA9IHRyaW0obVsxXSk7XG4gICAgdmFyIGRvYyA9IHRyaW0obVsyXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGRvY3VtZW50IG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBkb2N1bWVudCBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2RvY3VtZW50JyxcbiAgICAgIGRvY3VtZW50OiBkb2MsXG4gICAgICB2ZW5kb3I6IHZlbmRvcixcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGZvbnQtZmFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRmb250ZmFjZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQGZvbnQtZmFjZVxccyovKTtcbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAZm9udC1mYWNlIG1pc3NpbmcgJ3snXCIpO1xuICAgIHZhciBkZWNscyA9IGNvbW1lbnRzKCk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGRlY2xzLnB1c2goZGVjbCk7XG4gICAgICBkZWNscyA9IGRlY2xzLmNvbmNhdChjb21tZW50cygpKTtcbiAgICB9XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBmb250LWZhY2UgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdmb250LWZhY2UnLFxuICAgICAgZGVjbGFyYXRpb25zOiBkZWNsc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGltcG9ydFxuICAgKi9cblxuICB2YXIgYXRpbXBvcnQgPSBfY29tcGlsZUF0cnVsZSgnaW1wb3J0Jyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNoYXJzZXRcbiAgICovXG5cbiAgdmFyIGF0Y2hhcnNldCA9IF9jb21waWxlQXRydWxlKCdjaGFyc2V0Jyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIG5hbWVzcGFjZVxuICAgKi9cblxuICB2YXIgYXRuYW1lc3BhY2UgPSBfY29tcGlsZUF0cnVsZSgnbmFtZXNwYWNlJyk7XG5cbiAgLyoqXG4gICAqIFBhcnNlIG5vbi1ibG9jayBhdC1ydWxlc1xuICAgKi9cblxuXG4gIGZ1bmN0aW9uIF9jb21waWxlQXRydWxlKG5hbWUpIHtcbiAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKCdeQCcgKyBuYW1lICsgJ1xcXFxzKihbXjtdKyk7Jyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgICB2YXIgbSA9IG1hdGNoKHJlKTtcbiAgICAgIGlmICghbSkgcmV0dXJuO1xuICAgICAgdmFyIHJldCA9IHsgdHlwZTogbmFtZSB9O1xuICAgICAgcmV0W25hbWVdID0gbVsxXS50cmltKCk7XG4gICAgICByZXR1cm4gcG9zKHJldCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGF0IHJ1bGUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0cnVsZSgpIHtcbiAgICBpZiAoY3NzWzBdICE9ICdAJykgcmV0dXJuO1xuXG4gICAgcmV0dXJuIGF0a2V5ZnJhbWVzKClcbiAgICAgIHx8IGF0bWVkaWEoKVxuICAgICAgfHwgYXRjdXN0b21tZWRpYSgpXG4gICAgICB8fCBhdHN1cHBvcnRzKClcbiAgICAgIHx8IGF0aW1wb3J0KClcbiAgICAgIHx8IGF0Y2hhcnNldCgpXG4gICAgICB8fCBhdG5hbWVzcGFjZSgpXG4gICAgICB8fCBhdGRvY3VtZW50KClcbiAgICAgIHx8IGF0cGFnZSgpXG4gICAgICB8fCBhdGhvc3QoKVxuICAgICAgfHwgYXRmb250ZmFjZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHJ1bGUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHJ1bGUoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIHNlbCA9IHNlbGVjdG9yKCk7XG5cbiAgICBpZiAoIXNlbCkgcmV0dXJuIGVycm9yKCdzZWxlY3RvciBtaXNzaW5nJyk7XG4gICAgY29tbWVudHMoKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ3J1bGUnLFxuICAgICAgc2VsZWN0b3JzOiBzZWwsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xhcmF0aW9ucygpXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYWRkUGFyZW50KHN0eWxlc2hlZXQoKSk7XG59O1xuXG4vKipcbiAqIFRyaW0gYHN0cmAuXG4gKi9cblxuZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgcmV0dXJuIHN0ciA/IHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykgOiAnJztcbn1cblxuLyoqXG4gKiBBZGRzIG5vbi1lbnVtZXJhYmxlIHBhcmVudCBub2RlIHJlZmVyZW5jZSB0byBlYWNoIG5vZGUuXG4gKi9cblxuZnVuY3Rpb24gYWRkUGFyZW50KG9iaiwgcGFyZW50KSB7XG4gIHZhciBpc05vZGUgPSBvYmogJiYgdHlwZW9mIG9iai50eXBlID09PSAnc3RyaW5nJztcbiAgdmFyIGNoaWxkUGFyZW50ID0gaXNOb2RlID8gb2JqIDogcGFyZW50O1xuXG4gIGZvciAodmFyIGsgaW4gb2JqKSB7XG4gICAgdmFyIHZhbHVlID0gb2JqW2tdO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgdmFsdWUuZm9yRWFjaChmdW5jdGlvbih2KSB7IGFkZFBhcmVudCh2LCBjaGlsZFBhcmVudCk7IH0pO1xuICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgYWRkUGFyZW50KHZhbHVlLCBjaGlsZFBhcmVudCk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGlzTm9kZSkge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosICdwYXJlbnQnLCB7XG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgdmFsdWU6IHBhcmVudCB8fCBudWxsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHVybFJlZ0V4ID0gL1xccyp1cmxcXCgoPzooJ3xcIikoW15cXDFdKilcXDF8KFteXFwpXSopKVxcKVxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZVVSTCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVybFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSB1cmxSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gdXJsUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IHJlc3VsdFsyXSB8fCByZXN1bHRbM107XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlVVJMID0gcGFyc2VVUkw7XG52YXIgaGV4Q29sb3JSZWdFeCA9IC9cXHMqIygoPzpbMC05QS1GXXs4fSl8KD86WzAtOUEtRl17Nn0pfCg/OlswLTlBLUZdezN9KSlcXHMqL2dpeTtcbmZ1bmN0aW9uIHBhcnNlSGV4Q29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBoZXhDb2xvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBoZXhDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBoZXhDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgaGV4ID0gcmVzdWx0WzFdO1xuICAgIHZhciBhcmdiO1xuICAgIGlmIChoZXgubGVuZ3RoID09PSA4KSB7XG4gICAgICAgIGFyZ2IgPSBwYXJzZUludChcIjB4XCIgKyBoZXgpO1xuICAgIH1cbiAgICBlbHNlIGlmIChoZXgubGVuZ3RoID09PSA2KSB7XG4gICAgICAgIGFyZ2IgPSBwYXJzZUludChcIjB4RkZcIiArIGhleCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhGRlwiICsgaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IGFyZ2IgfTtcbn1cbmV4cG9ydHMucGFyc2VIZXhDb2xvciA9IHBhcnNlSGV4Q29sb3I7XG5mdW5jdGlvbiByZ2JhVG9BcmdiTnVtYmVyKHIsIGcsIGIsIGEpIHtcbiAgICBpZiAoYSA9PT0gdm9pZCAwKSB7IGEgPSAxOyB9XG4gICAgaWYgKHIgPj0gMCAmJiByIDw9IDI1NSAmJiBnID49IDAgJiYgZyA8PSAyNTUgJiYgYiA+PSAwICYmIGIgPD0gMjU1ICYmIGEgPj0gMCAmJiBhIDw9IDEpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJvdW5kKGEgKiAweEZGKSAqIDB4MDEwMDAwMDApICsgKHIgKiAweDAxMDAwMCkgKyAoZyAqIDB4MDAwMTAwKSArIChiICogMHgwMDAwMDEpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxudmFyIHJnYkNvbG9yUmVnRXggPSAvXFxzKihyZ2JcXChcXHMqKFxcZCopXFxzKixcXHMqKFxcZCopXFxzKixcXHMqKFxcZCopXFxzKlxcKSkvZ3k7XG5mdW5jdGlvbiBwYXJzZVJHQkNvbG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgcmdiQ29sb3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gcmdiQ29sb3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gcmdiQ29sb3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzFdICYmIHJnYmFUb0FyZ2JOdW1iZXIocGFyc2VJbnQocmVzdWx0WzJdKSwgcGFyc2VJbnQocmVzdWx0WzNdKSwgcGFyc2VJbnQocmVzdWx0WzRdKSk7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlUkdCQ29sb3IgPSBwYXJzZVJHQkNvbG9yO1xudmFyIHJnYmFDb2xvclJlZ0V4ID0gL1xccyoocmdiYVxcKFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooWzAxXT9cXC4/XFxkKilcXHMqXFwpKS9neTtcbmZ1bmN0aW9uIHBhcnNlUkdCQUNvbG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgcmdiYUNvbG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHJnYmFDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSByZ2JhQ29sb3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmdiYVRvQXJnYk51bWJlcihwYXJzZUludChyZXN1bHRbMl0pLCBwYXJzZUludChyZXN1bHRbM10pLCBwYXJzZUludChyZXN1bHRbNF0pLCBwYXJzZUZsb2F0KHJlc3VsdFs1XSkpO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVJHQkFDb2xvciA9IHBhcnNlUkdCQUNvbG9yO1xudmFyIGNvbG9ycztcbihmdW5jdGlvbiAoY29sb3JzKSB7XG4gICAgY29sb3JzW2NvbG9yc1tcInRyYW5zcGFyZW50XCJdID0gMF0gPSBcInRyYW5zcGFyZW50XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImFsaWNlYmx1ZVwiXSA9IDQyOTM5ODI0NjNdID0gXCJhbGljZWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYW50aXF1ZXdoaXRlXCJdID0gNDI5NDYzNDQ1NV0gPSBcImFudGlxdWV3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhcXVhXCJdID0gNDI3ODI1NTYxNV0gPSBcImFxdWFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYXF1YW1hcmluZVwiXSA9IDQyODY1Nzg2NDRdID0gXCJhcXVhbWFyaW5lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImF6dXJlXCJdID0gNDI5Mzk4NDI1NV0gPSBcImF6dXJlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJlaWdlXCJdID0gNDI5NDMwOTM0MF0gPSBcImJlaWdlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJpc3F1ZVwiXSA9IDQyOTQ5NjAzMjRdID0gXCJiaXNxdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmxhY2tcIl0gPSA0Mjc4MTkwMDgwXSA9IFwiYmxhY2tcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmxhbmNoZWRhbG1vbmRcIl0gPSA0Mjk0OTYyMTI1XSA9IFwiYmxhbmNoZWRhbG1vbmRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmx1ZVwiXSA9IDQyNzgxOTAzMzVdID0gXCJibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJsdWV2aW9sZXRcIl0gPSA0Mjg3MjQ1MjgyXSA9IFwiYmx1ZXZpb2xldFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJicm93blwiXSA9IDQyODkwMTQzMTRdID0gXCJicm93blwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJidXJseXdvb2RcIl0gPSA0MjkyNzg2MzExXSA9IFwiYnVybHl3b29kXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImNhZGV0Ymx1ZVwiXSA9IDQyODQ0NTY2MDhdID0gXCJjYWRldGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2hhcnRyZXVzZVwiXSA9IDQyODY1Nzg0MzJdID0gXCJjaGFydHJldXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImNob2NvbGF0ZVwiXSA9IDQyOTE5Nzk1NTBdID0gXCJjaG9jb2xhdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29yYWxcIl0gPSA0Mjk0OTM0MzUyXSA9IFwiY29yYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29ybmZsb3dlcmJsdWVcIl0gPSA0Mjg0NzgyMDYxXSA9IFwiY29ybmZsb3dlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY29ybnNpbGtcIl0gPSA0Mjk0OTY1NDY4XSA9IFwiY29ybnNpbGtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY3JpbXNvblwiXSA9IDQyOTI2MTMxODBdID0gXCJjcmltc29uXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImN5YW5cIl0gPSA0Mjc4MjU1NjE1XSA9IFwiY3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrYmx1ZVwiXSA9IDQyNzgxOTAyMTldID0gXCJkYXJrYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrY3lhblwiXSA9IDQyNzgyMjU4MDNdID0gXCJkYXJrY3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ29sZGVucm9kXCJdID0gNDI5MDI4MzAxOV0gPSBcImRhcmtnb2xkZW5yb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya2dyYXlcIl0gPSA0Mjg5MzA5MDk3XSA9IFwiZGFya2dyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya2dyZWVuXCJdID0gNDI3ODIxNTY4MF0gPSBcImRhcmtncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JleVwiXSA9IDQyODkzMDkwOTddID0gXCJkYXJrZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJra2hha2lcIl0gPSA0MjkwNjIzMzM5XSA9IFwiZGFya2toYWtpXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmttYWdlbnRhXCJdID0gNDI4NzI5OTcyM10gPSBcImRhcmttYWdlbnRhXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvbGl2ZWdyZWVuXCJdID0gNDI4Mzc4ODA3OV0gPSBcImRhcmtvbGl2ZWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvcmFuZ2VcIl0gPSA0Mjk0OTM3NjAwXSA9IFwiZGFya29yYW5nZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrb3JjaGlkXCJdID0gNDI4ODIzMDA5Ml0gPSBcImRhcmtvcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3JlZFwiXSA9IDQyODcyOTk1ODRdID0gXCJkYXJrcmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzYWxtb25cIl0gPSA0MjkzNDk4NDkwXSA9IFwiZGFya3NhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2VhZ3JlZW5cIl0gPSA0Mjg3NjA5OTk5XSA9IFwiZGFya3NlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzbGF0ZWJsdWVcIl0gPSA0MjgyOTI0NDI3XSA9IFwiZGFya3NsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2xhdGVncmF5XCJdID0gNDI4MTI5MDU3NV0gPSBcImRhcmtzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NsYXRlZ3JleVwiXSA9IDQyODEyOTA1NzVdID0gXCJkYXJrc2xhdGVncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmt0dXJxdW9pc2VcIl0gPSA0Mjc4MjQzMDI1XSA9IFwiZGFya3R1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrdmlvbGV0XCJdID0gNDI4Nzg4OTYxOV0gPSBcImRhcmt2aW9sZXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGVlcHBpbmtcIl0gPSA0Mjk0OTA3MDI3XSA9IFwiZGVlcHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGVlcHNreWJsdWVcIl0gPSA0Mjc4MjM5MjMxXSA9IFwiZGVlcHNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGltZ3JheVwiXSA9IDQyODUwOTgzNDVdID0gXCJkaW1ncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRpbWdyZXlcIl0gPSA0Mjg1MDk4MzQ1XSA9IFwiZGltZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkb2RnZXJibHVlXCJdID0gNDI4MDE5MzI3OV0gPSBcImRvZGdlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZmlyZWJyaWNrXCJdID0gNDI4OTg2NDIyNl0gPSBcImZpcmVicmlja1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmbG9yYWx3aGl0ZVwiXSA9IDQyOTQ5NjYwMDBdID0gXCJmbG9yYWx3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmb3Jlc3RncmVlblwiXSA9IDQyODA0NTM5MjJdID0gXCJmb3Jlc3RncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmdWNoc2lhXCJdID0gNDI5NDkwMjAxNV0gPSBcImZ1Y2hzaWFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ2FpbnNib3JvXCJdID0gNDI5MjY2NDU0MF0gPSBcImdhaW5zYm9yb1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnaG9zdHdoaXRlXCJdID0gNDI5NDUwNjc1MV0gPSBcImdob3N0d2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ29sZFwiXSA9IDQyOTQ5NTY4MDBdID0gXCJnb2xkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdvbGRlbnJvZFwiXSA9IDQyOTI1MTkyMDBdID0gXCJnb2xkZW5yb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JheVwiXSA9IDQyODY2MTE1ODRdID0gXCJncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZWVuXCJdID0gNDI3ODIyMjg0OF0gPSBcImdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZWVueWVsbG93XCJdID0gNDI4OTU5MzEzNV0gPSBcImdyZWVueWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdyZXlcIl0gPSA0Mjg2NjExNTg0XSA9IFwiZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJob25leWRld1wiXSA9IDQyOTM5ODQyNDBdID0gXCJob25leWRld1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJob3RwaW5rXCJdID0gNDI5NDkyODgyMF0gPSBcImhvdHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiaW5kaWFucmVkXCJdID0gNDI5MTY0ODYwNF0gPSBcImluZGlhbnJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJpbmRpZ29cIl0gPSA0MjgzMTA1NDEwXSA9IFwiaW5kaWdvXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIml2b3J5XCJdID0gNDI5NDk2NzI4MF0gPSBcIml2b3J5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImtoYWtpXCJdID0gNDI5Mzk3Nzc0MF0gPSBcImtoYWtpXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhdmVuZGVyXCJdID0gNDI5MzMyMjQ5MF0gPSBcImxhdmVuZGVyXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhdmVuZGVyYmx1c2hcIl0gPSA0Mjk0OTYzNDQ1XSA9IFwibGF2ZW5kZXJibHVzaFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsYXduZ3JlZW5cIl0gPSA0Mjg2MzgxMDU2XSA9IFwibGF3bmdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxlbW9uY2hpZmZvblwiXSA9IDQyOTQ5NjU5NjVdID0gXCJsZW1vbmNoaWZmb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRibHVlXCJdID0gNDI4OTU4MzMzNF0gPSBcImxpZ2h0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGNvcmFsXCJdID0gNDI5Mzk1MTYxNl0gPSBcImxpZ2h0Y29yYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRjeWFuXCJdID0gNDI5MjkzNTY3OV0gPSBcImxpZ2h0Y3lhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdvbGRlbnJvZHllbGxvd1wiXSA9IDQyOTQ2MzgyOTBdID0gXCJsaWdodGdvbGRlbnJvZHllbGxvd1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdyYXlcIl0gPSA0MjkyMDcyNDAzXSA9IFwibGlnaHRncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JlZW5cIl0gPSA0Mjg3Njg4MzM2XSA9IFwibGlnaHRncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGdyZXlcIl0gPSA0MjkyMDcyNDAzXSA9IFwibGlnaHRncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0cGlua1wiXSA9IDQyOTQ5NDg1NDVdID0gXCJsaWdodHBpbmtcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzYWxtb25cIl0gPSA0Mjk0OTQyODQyXSA9IFwibGlnaHRzYWxtb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzZWFncmVlblwiXSA9IDQyODAzMzI5NzBdID0gXCJsaWdodHNlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0c2t5Ymx1ZVwiXSA9IDQyODcwOTA0MjZdID0gXCJsaWdodHNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzbGF0ZWdyYXlcIl0gPSA0Mjg2MDIzODMzXSA9IFwibGlnaHRzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzbGF0ZWdyZXlcIl0gPSA0Mjg2MDIzODMzXSA9IFwibGlnaHRzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRzdGVlbGJsdWVcIl0gPSA0Mjg5Nzc0ODE0XSA9IFwibGlnaHRzdGVlbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHR5ZWxsb3dcIl0gPSA0Mjk0OTY3MjY0XSA9IFwibGlnaHR5ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGltZVwiXSA9IDQyNzgyNTUzNjBdID0gXCJsaW1lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpbWVncmVlblwiXSA9IDQyODE1MTk0MTBdID0gXCJsaW1lZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGluZW5cIl0gPSA0Mjk0NjM1NzUwXSA9IFwibGluZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWFnZW50YVwiXSA9IDQyOTQ5MDIwMTVdID0gXCJtYWdlbnRhXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1hcm9vblwiXSA9IDQyODY1Nzg2ODhdID0gXCJtYXJvb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtYXF1YW1hcmluZVwiXSA9IDQyODQ5Mjc0MDJdID0gXCJtZWRpdW1hcXVhbWFyaW5lXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bWJsdWVcIl0gPSA0Mjc4MTkwMjg1XSA9IFwibWVkaXVtYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1vcmNoaWRcIl0gPSA0MjkwNDAxNzQ3XSA9IFwibWVkaXVtb3JjaGlkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXB1cnBsZVwiXSA9IDQyODc4NTI3NjNdID0gXCJtZWRpdW1wdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtc2VhZ3JlZW5cIl0gPSA0MjgyMTY4MTc3XSA9IFwibWVkaXVtc2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtc2xhdGVibHVlXCJdID0gNDI4NjI3Nzg3MF0gPSBcIm1lZGl1bXNsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zcHJpbmdncmVlblwiXSA9IDQyNzgyNTQyMzRdID0gXCJtZWRpdW1zcHJpbmdncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW10dXJxdW9pc2VcIl0gPSA0MjgyOTYyMzgwXSA9IFwibWVkaXVtdHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXZpb2xldHJlZFwiXSA9IDQyOTEyMzcyNTNdID0gXCJtZWRpdW12aW9sZXRyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWlkbmlnaHRibHVlXCJdID0gNDI3OTgzNDk5Ml0gPSBcIm1pZG5pZ2h0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtaW50Y3JlYW1cIl0gPSA0Mjk0MzExOTMwXSA9IFwibWludGNyZWFtXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1pc3R5cm9zZVwiXSA9IDQyOTQ5NjAzNTNdID0gXCJtaXN0eXJvc2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibW9jY2FzaW5cIl0gPSA0Mjk0OTYwMzA5XSA9IFwibW9jY2FzaW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibmF2YWpvd2hpdGVcIl0gPSA0Mjk0OTU4NzY1XSA9IFwibmF2YWpvd2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibmF2eVwiXSA9IDQyNzgxOTAyMDhdID0gXCJuYXZ5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9sZGxhY2VcIl0gPSA0Mjk0ODMzNjM4XSA9IFwib2xkbGFjZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvbGl2ZVwiXSA9IDQyODY2MTE0NTZdID0gXCJvbGl2ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvbGl2ZWRyYWJcIl0gPSA0Mjg1MjM4ODE5XSA9IFwib2xpdmVkcmFiXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9yYW5nZVwiXSA9IDQyOTQ5NDQwMDBdID0gXCJvcmFuZ2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib3JhbmdlcmVkXCJdID0gNDI5NDkxOTQyNF0gPSBcIm9yYW5nZXJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvcmNoaWRcIl0gPSA0MjkyNTA1ODE0XSA9IFwib3JjaGlkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGVnb2xkZW5yb2RcIl0gPSA0MjkzODQ3MjEwXSA9IFwicGFsZWdvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYWxlZ3JlZW5cIl0gPSA0Mjg4MjE1OTYwXSA9IFwicGFsZWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGV0dXJxdW9pc2VcIl0gPSA0Mjg5NzIwMDQ2XSA9IFwicGFsZXR1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYWxldmlvbGV0cmVkXCJdID0gNDI5MjU3MTI4M10gPSBcInBhbGV2aW9sZXRyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFwYXlhd2hpcFwiXSA9IDQyOTQ5NjMxNTddID0gXCJwYXBheWF3aGlwXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBlYWNocHVmZlwiXSA9IDQyOTQ5NTc3NTNdID0gXCJwZWFjaHB1ZmZcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGVydVwiXSA9IDQyOTE2NTkwNzFdID0gXCJwZXJ1XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBpbmtcIl0gPSA0Mjk0OTUxMTE1XSA9IFwicGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwbHVtXCJdID0gNDI5MjcxNDcxN10gPSBcInBsdW1cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicG93ZGVyYmx1ZVwiXSA9IDQyODk3ODE5OTBdID0gXCJwb3dkZXJibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInB1cnBsZVwiXSA9IDQyODY1Nzg4MTZdID0gXCJwdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicmViZWNjYXB1cnBsZVwiXSA9IDQyODQ4ODc5NjFdID0gXCJyZWJlY2NhcHVycGxlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInJlZFwiXSA9IDQyOTQ5MDE3NjBdID0gXCJyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicm9zeWJyb3duXCJdID0gNDI5MDU0NzU5OV0gPSBcInJvc3licm93blwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyb3lhbGJsdWVcIl0gPSA0MjgyNDc3MDI1XSA9IFwicm95YWxibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNhZGRsZWJyb3duXCJdID0gNDI4NzMxNzI2N10gPSBcInNhZGRsZWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNhbG1vblwiXSA9IDQyOTQ2MDY5NjJdID0gXCJzYWxtb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FuZHlicm93blwiXSA9IDQyOTQyMjI5NDRdID0gXCJzYW5keWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNlYWdyZWVuXCJdID0gNDI4MTI0MDQwN10gPSBcInNlYWdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNlYXNoZWxsXCJdID0gNDI5NDk2NDcxOF0gPSBcInNlYXNoZWxsXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNpZW5uYVwiXSA9IDQyODg2OTY4NzddID0gXCJzaWVubmFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2lsdmVyXCJdID0gNDI5MDgyMjMzNl0gPSBcInNpbHZlclwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJza3libHVlXCJdID0gNDI4NzA5MDQxMV0gPSBcInNreWJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2xhdGVibHVlXCJdID0gNDI4NTE2MDE0MV0gPSBcInNsYXRlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbGF0ZWdyYXlcIl0gPSA0Mjg1NTYzMDI0XSA9IFwic2xhdGVncmF5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNsYXRlZ3JleVwiXSA9IDQyODU1NjMwMjRdID0gXCJzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic25vd1wiXSA9IDQyOTQ5NjYwMTBdID0gXCJzbm93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNwcmluZ2dyZWVuXCJdID0gNDI3ODI1NTQ4N10gPSBcInNwcmluZ2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInN0ZWVsYmx1ZVwiXSA9IDQyODI4MTEwNjBdID0gXCJzdGVlbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widGFuXCJdID0gNDI5MTk5ODg2MF0gPSBcInRhblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0ZWFsXCJdID0gNDI3ODIyMjk3Nl0gPSBcInRlYWxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widGhpc3RsZVwiXSA9IDQyOTIzOTQ5NjhdID0gXCJ0aGlzdGxlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInRvbWF0b1wiXSA9IDQyOTQ5MjcxNzVdID0gXCJ0b21hdG9cIjtcbiAgICBjb2xvcnNbY29sb3JzW1widHVycXVvaXNlXCJdID0gNDI4MjQ0MTkzNl0gPSBcInR1cnF1b2lzZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ2aW9sZXRcIl0gPSA0MjkzODIxMTY2XSA9IFwidmlvbGV0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoZWF0XCJdID0gNDI5NDMwMzQxMV0gPSBcIndoZWF0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoaXRlXCJdID0gNDI5NDk2NzI5NV0gPSBcIndoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIndoaXRlc21va2VcIl0gPSA0Mjk0MzA5MzY1XSA9IFwid2hpdGVzbW9rZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ5ZWxsb3dcIl0gPSA0Mjk0OTY3MDQwXSA9IFwieWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInllbGxvd2dyZWVuXCJdID0gNDI4ODMzNTE1NF0gPSBcInllbGxvd2dyZWVuXCI7XG59KShjb2xvcnMgPSBleHBvcnRzLmNvbG9ycyB8fCAoZXhwb3J0cy5jb2xvcnMgPSB7fSkpO1xuZnVuY3Rpb24gcGFyc2VDb2xvcktleXdvcmQodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHZhbHVlLCBzdGFydCk7IH1cbiAgICBpZiAoa2V5d29yZCAmJiBrZXl3b3JkLnZhbHVlIGluIGNvbG9ycykge1xuICAgICAgICB2YXIgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZV8xID0gY29sb3JzW2tleXdvcmQudmFsdWVdO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWVfMSB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VDb2xvcktleXdvcmQgPSBwYXJzZUNvbG9yS2V5d29yZDtcbmZ1bmN0aW9uIHBhcnNlQ29sb3IodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHZhbHVlLCBzdGFydCk7IH1cbiAgICByZXR1cm4gcGFyc2VIZXhDb2xvcih2YWx1ZSwgc3RhcnQpIHx8IHBhcnNlQ29sb3JLZXl3b3JkKHZhbHVlLCBzdGFydCwga2V5d29yZCkgfHwgcGFyc2VSR0JDb2xvcih2YWx1ZSwgc3RhcnQpIHx8IHBhcnNlUkdCQUNvbG9yKHZhbHVlLCBzdGFydCk7XG59XG5leHBvcnRzLnBhcnNlQ29sb3IgPSBwYXJzZUNvbG9yO1xudmFyIGtleXdvcmRSZWdFeCA9IC9cXHMqKFthLXpdW1xcd1xcLV0qKVxccyovZ2l5O1xuZnVuY3Rpb24gcGFyc2VLZXl3b3JkKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAga2V5d29yZFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBrZXl3b3JkUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGtleXdvcmRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzFdO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxudmFyIGJhY2tncm91bmRSZXBlYXRLZXl3b3JkcyA9IG5ldyBTZXQoW1wicmVwZWF0XCIsIFwicmVwZWF0LXhcIiwgXCJyZXBlYXQteVwiLCBcIm5vLXJlcGVhdFwiXSk7XG5mdW5jdGlvbiBwYXJzZVJlcGVhdCh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRSZXBlYXRLZXl3b3Jkcy5oYXMoa2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgdmFyIGVuZCA9IGtleXdvcmQuZW5kO1xuICAgICAgICB2YXIgdmFsdWVfMiA9IGtleXdvcmQudmFsdWU7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV8yIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5wYXJzZVJlcGVhdCA9IHBhcnNlUmVwZWF0O1xudmFyIHVuaXRSZWdFeCA9IC9cXHMqKFtcXCtcXC1dPyg/OlxcZCtcXC5cXGQrfFxcZCt8XFwuXFxkKykoPzpbZUVdW1xcK1xcLV0/XFxkKyk/KShbYS16QS1aXSt8JSk/XFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlVW5pdCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVuaXRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gdW5pdFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSB1bml0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQocmVzdWx0WzFdKTtcbiAgICB2YXIgdW5pdCA9IHJlc3VsdFsyXSB8fCBcImRpcFwiO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHZhbHVlOiB2YWx1ZSwgdW5pdDogdW5pdCB9IH07XG59XG5leHBvcnRzLnBhcnNlVW5pdCA9IHBhcnNlVW5pdDtcbmZ1bmN0aW9uIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdmFyIHVuaXRSZXN1bHQgPSBwYXJzZVVuaXQodGV4dCwgc3RhcnQpO1xuICAgIGlmICh1bml0UmVzdWx0KSB7XG4gICAgICAgIHZhciBzdGFydF8xID0gdW5pdFJlc3VsdC5zdGFydCwgZW5kID0gdW5pdFJlc3VsdC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZSA9IHVuaXRSZXN1bHQudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZS51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgdmFsdWUudmFsdWUgLz0gMTAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF2YWx1ZS51bml0KSB7XG4gICAgICAgICAgICB2YWx1ZS51bml0ID0gXCJkaXBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZS51bml0ID09PSBcInB4XCIgfHwgdmFsdWUudW5pdCA9PT0gXCJkaXBcIikge1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0XzEsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGg7XG52YXIgYW5nbGVVbml0c1RvUmFkTWFwID0ge1xuICAgIFwiZGVnXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCBkZWcpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiBkZWcgLyAxODAgKiBNYXRoLlBJIH0pOyB9LFxuICAgIFwicmFkXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCByYWQpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiByYWQgfSk7IH0sXG4gICAgXCJncmFkXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCBncmFkKSB7IHJldHVybiAoeyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogZ3JhZCAvIDIwMCAqIE1hdGguUEkgfSk7IH0sXG4gICAgXCJ0dXJuXCI6IGZ1bmN0aW9uIChzdGFydCwgZW5kLCB0dXJuKSB7IHJldHVybiAoeyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdHVybiAqIE1hdGguUEkgKiAyIH0pOyB9XG59O1xuZnVuY3Rpb24gcGFyc2VBbmdsZSh2YWx1ZSwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgYW5nbGVSZXN1bHQgPSBwYXJzZVVuaXQodmFsdWUsIHN0YXJ0KTtcbiAgICBpZiAoYW5nbGVSZXN1bHQpIHtcbiAgICAgICAgdmFyIHN0YXJ0XzIgPSBhbmdsZVJlc3VsdC5zdGFydCwgZW5kID0gYW5nbGVSZXN1bHQuZW5kLCB2YWx1ZV8zID0gYW5nbGVSZXN1bHQudmFsdWU7XG4gICAgICAgIHJldHVybiAoYW5nbGVVbml0c1RvUmFkTWFwW3ZhbHVlXzMudW5pdF0gfHwgKGZ1bmN0aW9uIChfLCBfXywgX19fKSB7IHJldHVybiBudWxsOyB9KSkoc3RhcnRfMiwgZW5kLCB2YWx1ZV8zLnZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlQW5nbGUgPSBwYXJzZUFuZ2xlO1xudmFyIGJhY2tncm91bmRTaXplS2V5d29yZHMgPSBuZXcgU2V0KFtcImF1dG9cIiwgXCJjb250YWluXCIsIFwiY292ZXJcIl0pO1xuZnVuY3Rpb24gcGFyc2VCYWNrZ3JvdW5kU2l6ZSh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICBpZiAoa2V5d29yZCAmJiBiYWNrZ3JvdW5kU2l6ZUtleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIHZhbHVlXzQgPSBrZXl3b3JkLnZhbHVlO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWVfNCB9O1xuICAgIH1cbiAgICB2YXIgZmlyc3RMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh2YWx1ZSwgZW5kKTtcbiAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgZW5kID0gZmlyc3RMZW5ndGguZW5kO1xuICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodmFsdWUsIGZpcnN0TGVuZ3RoLmVuZCk7XG4gICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IHNlY29uZExlbmd0aC5lbmQ7XG4gICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiBmaXJzdExlbmd0aC52YWx1ZSwgeTogc2Vjb25kTGVuZ3RoLnZhbHVlIH0gfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZpcnN0TGVuZ3RoLnZhbHVlLCB5OiBcImF1dG9cIiB9IH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlQmFja2dyb3VuZFNpemUgPSBwYXJzZUJhY2tncm91bmRTaXplO1xudmFyIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzID0gT2JqZWN0LmZyZWV6ZShuZXcgU2V0KFtcImxlZnRcIiwgXCJyaWdodFwiLCBcInRvcFwiLCBcImJvdHRvbVwiLCBcImNlbnRlclwiXSkpO1xudmFyIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uID0ge1xuICAgIFwibGVmdFwiOiBcInhcIixcbiAgICBcInJpZ2h0XCI6IFwieFwiLFxuICAgIFwiY2VudGVyXCI6IFwiY2VudGVyXCIsXG4gICAgXCJ0b3BcIjogXCJ5XCIsXG4gICAgXCJib3R0b21cIjogXCJ5XCJcbn07XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmRQb3NpdGlvbih0ZXh0LCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh0ZXh0LCBzdGFydCk7IH1cbiAgICBmdW5jdGlvbiBmb3JtYXRIKGFsaWduLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKGFsaWduLnZhbHVlID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjZW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC52YWx1ZS52YWx1ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgYWxpZ246IGFsaWduLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlnbi52YWx1ZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9ybWF0VihhbGlnbiwgb2Zmc2V0KSB7XG4gICAgICAgIGlmIChhbGlnbi52YWx1ZSA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgcmV0dXJuIFwiY2VudGVyXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9mZnNldCAmJiBvZmZzZXQudmFsdWUudmFsdWUgIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB7IGFsaWduOiBhbGlnbi52YWx1ZSwgb2Zmc2V0OiBvZmZzZXQudmFsdWUgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWxpZ24udmFsdWU7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICBpZiAoa2V5d29yZCAmJiBiYWNrZ3JvdW5kUG9zaXRpb25LZXl3b3Jkcy5oYXMoa2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciBmaXJzdERpcmVjdGlvbiA9IGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uW2tleXdvcmQudmFsdWVdO1xuICAgICAgICB2YXIgZmlyc3RMZW5ndGggPSBmaXJzdERpcmVjdGlvbiAhPT0gXCJjZW50ZXJcIiAmJiBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IGZpcnN0TGVuZ3RoLmVuZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Vjb25kS2V5d29yZCA9IHBhcnNlS2V5d29yZCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoc2Vjb25kS2V5d29yZCAmJiBiYWNrZ3JvdW5kUG9zaXRpb25LZXl3b3Jkcy5oYXMoc2Vjb25kS2V5d29yZC52YWx1ZSkpIHtcbiAgICAgICAgICAgIGVuZCA9IHNlY29uZEtleXdvcmQuZW5kO1xuICAgICAgICAgICAgdmFyIHNlY29uZERpcmVjdGlvbiA9IGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzRGlyZWN0aW9uW3NlY29uZEtleXdvcmQuZW5kXTtcbiAgICAgICAgICAgIGlmIChmaXJzdERpcmVjdGlvbiA9PT0gc2Vjb25kRGlyZWN0aW9uICYmIGZpcnN0RGlyZWN0aW9uICE9PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gc2Vjb25kRGlyZWN0aW9uICE9PSBcImNlbnRlclwiICYmIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgICAgICAgICBpZiAoc2Vjb25kTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZW5kID0gc2Vjb25kTGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgoZmlyc3REaXJlY3Rpb24gPT09IHNlY29uZERpcmVjdGlvbiAmJiBzZWNvbmREaXJlY3Rpb24gPT09IFwiY2VudGVyXCIpIHx8IChmaXJzdERpcmVjdGlvbiA9PT0gXCJ4XCIgfHwgc2Vjb25kRGlyZWN0aW9uID09PSBcInlcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogZm9ybWF0SChrZXl3b3JkLCBmaXJzdExlbmd0aCksXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiBmb3JtYXRWKHNlY29uZEtleXdvcmQsIHNlY29uZExlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IGZvcm1hdEgoc2Vjb25kS2V5d29yZCwgc2Vjb25kTGVuZ3RoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvcm1hdFYoa2V5d29yZCwgZmlyc3RMZW5ndGgpLFxuICAgICAgICAgICAgICAgICAgICB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAoZmlyc3REaXJlY3Rpb24gPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiBcImNlbnRlclwiLCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGZpcnN0RGlyZWN0aW9uID09PSBcInhcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZvcm1hdEgoa2V5d29yZCwgZmlyc3RMZW5ndGgpLCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IFwiY2VudGVyXCIsIHk6IGZvcm1hdFYoa2V5d29yZCwgZmlyc3RMZW5ndGgpIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIGZpcnN0TGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKGZpcnN0TGVuZ3RoKSB7XG4gICAgICAgICAgICBlbmQgPSBmaXJzdExlbmd0aC5lbmQ7XG4gICAgICAgICAgICB2YXIgc2Vjb25kTGVuZ3RoID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzZWNvbmRMZW5ndGguZW5kO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IHsgYWxpZ246IFwibGVmdFwiLCBvZmZzZXQ6IGZpcnN0TGVuZ3RoLnZhbHVlIH0sIHk6IHsgYWxpZ246IFwidG9wXCIsIG9mZnNldDogc2Vjb25kTGVuZ3RoLnZhbHVlIH0gfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogeyBhbGlnbjogXCJsZWZ0XCIsIG9mZnNldDogZmlyc3RMZW5ndGgudmFsdWUgfSwgeTogXCJjZW50ZXJcIiB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kUG9zaXRpb24gPSBwYXJzZUJhY2tncm91bmRQb3NpdGlvbjtcbnZhciBkaXJlY3Rpb25SZWdFeCA9IC9cXHMqdG9cXHMqKGxlZnR8cmlnaHR8dG9wfGJvdHRvbSlcXHMqKGxlZnR8cmlnaHR8dG9wfGJvdHRvbSk/XFxzKi9neTtcbnZhciBzaWRlRGlyZWN0aW9ucyA9IHtcbiAgICB0b3A6IE1hdGguUEkgKiAwIC8gMixcbiAgICByaWdodDogTWF0aC5QSSAqIDEgLyAyLFxuICAgIGJvdHRvbTogTWF0aC5QSSAqIDIgLyAyLFxuICAgIGxlZnQ6IE1hdGguUEkgKiAzIC8gMlxufTtcbnZhciBjb3JuZXJEaXJlY3Rpb25zID0ge1xuICAgIHRvcDoge1xuICAgICAgICByaWdodDogTWF0aC5QSSAqIDEgLyA0LFxuICAgICAgICBsZWZ0OiBNYXRoLlBJICogNyAvIDRcbiAgICB9LFxuICAgIHJpZ2h0OiB7XG4gICAgICAgIHRvcDogTWF0aC5QSSAqIDEgLyA0LFxuICAgICAgICBib3R0b206IE1hdGguUEkgKiAzIC8gNFxuICAgIH0sXG4gICAgYm90dG9tOiB7XG4gICAgICAgIHJpZ2h0OiBNYXRoLlBJICogMyAvIDQsXG4gICAgICAgIGxlZnQ6IE1hdGguUEkgKiA1IC8gNFxuICAgIH0sXG4gICAgbGVmdDoge1xuICAgICAgICB0b3A6IE1hdGguUEkgKiA3IC8gNCxcbiAgICAgICAgYm90dG9tOiBNYXRoLlBJICogNSAvIDRcbiAgICB9XG59O1xuZnVuY3Rpb24gcGFyc2VEaXJlY3Rpb24odGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBkaXJlY3Rpb25SZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gZGlyZWN0aW9uUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGRpcmVjdGlvblJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgZmlyc3REaXJlY3Rpb24gPSByZXN1bHRbMV07XG4gICAgaWYgKHJlc3VsdFsyXSkge1xuICAgICAgICB2YXIgc2Vjb25kRGlyZWN0aW9uID0gcmVzdWx0WzJdO1xuICAgICAgICB2YXIgdmFsdWUgPSBjb3JuZXJEaXJlY3Rpb25zW2ZpcnN0RGlyZWN0aW9uXVtzZWNvbmREaXJlY3Rpb25dO1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHNpZGVEaXJlY3Rpb25zW2ZpcnN0RGlyZWN0aW9uXSB9O1xuICAgIH1cbn1cbnZhciBvcGVuaW5nQnJhY2tldFJlZ0V4ID0gL1xccypcXChcXHMqL2d5O1xudmFyIGNsb3NpbmdCcmFja2V0UmVnRXggPSAvXFxzKlxcKVxccyovZ3k7XG52YXIgY2xvc2luZ0JyYWNrZXRPckNvbW1hUmVnRXggPSAvXFxzKihcXCl8LClcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VBcmd1bWVudHNMaXN0KHRleHQsIHN0YXJ0LCBhcmd1bWVudCkge1xuICAgIG9wZW5pbmdCcmFja2V0UmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIG9wZW5pbmdCcmFja2V0ID0gb3BlbmluZ0JyYWNrZXRSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghb3BlbmluZ0JyYWNrZXQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBvcGVuaW5nQnJhY2tldFJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSBbXTtcbiAgICBjbG9zaW5nQnJhY2tldFJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICB2YXIgY2xvc2luZ0JyYWNrZXQgPSBjbG9zaW5nQnJhY2tldFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKGNsb3NpbmdCcmFja2V0KSB7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBmb3IgKHZhciBpbmRleF8xID0gMDsgdHJ1ZTsgaW5kZXhfMSsrKSB7XG4gICAgICAgIHZhciBhcmcgPSBhcmd1bWVudCh0ZXh0LCBlbmQsIGluZGV4XzEpO1xuICAgICAgICBpZiAoIWFyZykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZW5kID0gYXJnLmVuZDtcbiAgICAgICAgdmFsdWUucHVzaChhcmcpO1xuICAgICAgICBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5sYXN0SW5kZXggPSBlbmQ7XG4gICAgICAgIHZhciBjbG9zaW5nQnJhY2tldE9yQ29tbWEgPSBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5leGVjKHRleHQpO1xuICAgICAgICBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hKSB7XG4gICAgICAgICAgICBlbmQgPSBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgICAgICBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hWzFdID09PSBcIixcIikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2xvc2luZ0JyYWNrZXRPckNvbW1hWzFdID09PSBcIilcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUNvbG9yU3RvcCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3IodGV4dCwgc3RhcnQpO1xuICAgIGlmICghY29sb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBjb2xvci5lbmQ7XG4gICAgdmFyIG9mZnNldCA9IHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgaWYgKG9mZnNldCkge1xuICAgICAgICBlbmQgPSBvZmZzZXQuZW5kO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhcmdiOiBjb2xvci52YWx1ZSwgb2Zmc2V0OiBvZmZzZXQudmFsdWUgfSB9O1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhcmdiOiBjb2xvci52YWx1ZSB9IH07XG59XG5leHBvcnRzLnBhcnNlQ29sb3JTdG9wID0gcGFyc2VDb2xvclN0b3A7XG52YXIgbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4ID0gL1xccypsaW5lYXItZ3JhZGllbnRcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VMaW5lYXJHcmFkaWVudCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGxpbmVhckdyYWRpZW50U3RhcnRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgbGdzID0gbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFsZ3MpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBhbmdsZSA9IE1hdGguUEk7XG4gICAgdmFyIGNvbG9ycyA9IFtdO1xuICAgIHZhciBwYXJzZWRBcmdzID0gcGFyc2VBcmd1bWVudHNMaXN0KHRleHQsIGVuZCwgZnVuY3Rpb24gKHRleHQsIHN0YXJ0LCBpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBhbmdsZUFyZyA9IHBhcnNlQW5nbGUodGV4dCwgc3RhcnQpIHx8IHBhcnNlRGlyZWN0aW9uKHRleHQsIHN0YXJ0KTtcbiAgICAgICAgICAgIGlmIChhbmdsZUFyZykge1xuICAgICAgICAgICAgICAgIGFuZ2xlID0gYW5nbGVBcmcudmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFuZ2xlQXJnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xvclN0b3AgPSBwYXJzZUNvbG9yU3RvcCh0ZXh0LCBzdGFydCk7XG4gICAgICAgIGlmIChjb2xvclN0b3ApIHtcbiAgICAgICAgICAgIGNvbG9ycy5wdXNoKGNvbG9yU3RvcC52YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gY29sb3JTdG9wO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0pO1xuICAgIGlmICghcGFyc2VkQXJncykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZW5kID0gcGFyc2VkQXJncy5lbmQ7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgYW5nbGU6IGFuZ2xlLCBjb2xvcnM6IGNvbG9ycyB9IH07XG59XG5leHBvcnRzLnBhcnNlTGluZWFyR3JhZGllbnQgPSBwYXJzZUxpbmVhckdyYWRpZW50O1xudmFyIHNsYXNoUmVnRXggPSAvXFxzKihcXC8pXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlU2xhc2godGV4dCwgc3RhcnQpIHtcbiAgICBzbGFzaFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciBzbGFzaCA9IHNsYXNoUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXNsYXNoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gc2xhc2hSZWdFeC5sYXN0SW5kZXg7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IFwiL1wiIH07XG59XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmQodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgdmFsdWUgPSB7fTtcbiAgICB2YXIgZW5kID0gc3RhcnQ7XG4gICAgd2hpbGUgKGVuZCA8IHRleHQubGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIGVuZCk7XG4gICAgICAgIHZhciBjb2xvciA9IHBhcnNlQ29sb3IodGV4dCwgZW5kLCBrZXl3b3JkKTtcbiAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICB2YWx1ZS5jb2xvciA9IGNvbG9yLnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gY29sb3IuZW5kO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlcGVhdCA9IHBhcnNlUmVwZWF0KHRleHQsIGVuZCwga2V5d29yZCk7XG4gICAgICAgIGlmIChyZXBlYXQpIHtcbiAgICAgICAgICAgIHZhbHVlLnJlcGVhdCA9IHJlcGVhdC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHJlcGVhdC5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcG9zaXRpb24gPSBwYXJzZUJhY2tncm91bmRQb3NpdGlvbih0ZXh0LCBlbmQsIGtleXdvcmQpO1xuICAgICAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHBvc2l0aW9uLnZhbHVlLnRleHQgPSB0ZXh0LnN1YnN0cmluZyhwb3NpdGlvbi5zdGFydCwgcG9zaXRpb24uZW5kKTtcbiAgICAgICAgICAgIHZhbHVlLnBvc2l0aW9uID0gcG9zaXRpb24udmFsdWU7XG4gICAgICAgICAgICBlbmQgPSBwb3NpdGlvbi5lbmQ7XG4gICAgICAgICAgICB2YXIgc2xhc2ggPSBwYXJzZVNsYXNoKHRleHQsIGVuZCk7XG4gICAgICAgICAgICBpZiAoc2xhc2gpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzbGFzaC5lbmQ7XG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBwYXJzZUJhY2tncm91bmRTaXplKHRleHQsIGVuZCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YWx1ZS5zaXplID0gc2l6ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICBlbmQgPSBzaXplLmVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB1cmwgPSBwYXJzZVVSTCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAodXJsKSB7XG4gICAgICAgICAgICB2YWx1ZS5pbWFnZSA9IHVybC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHVybC5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZ3JhZGllbnQgPSBwYXJzZUxpbmVhckdyYWRpZW50KHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChncmFkaWVudCkge1xuICAgICAgICAgICAgdmFsdWUuaW1hZ2UgPSBncmFkaWVudC52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IGdyYWRpZW50LmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kID0gcGFyc2VCYWNrZ3JvdW5kO1xudmFyIHVuaXZlcnNhbFNlbGVjdG9yUmVnRXggPSAvXFwqL2d5O1xuZnVuY3Rpb24gcGFyc2VVbml2ZXJzYWxTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHVuaXZlcnNhbFNlbGVjdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHVuaXZlcnNhbFNlbGVjdG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHVuaXZlcnNhbFNlbGVjdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHR5cGU6IFwiKlwiIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VVbml2ZXJzYWxTZWxlY3RvciA9IHBhcnNlVW5pdmVyc2FsU2VsZWN0b3I7XG52YXIgc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXggPSAvKCN8XFwufDp8XFxiKShbXy1cXHddW18tXFx3XFxkXSopL2d5O1xuZnVuY3Rpb24gcGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHNpbXBsZUlkZW50aWZpZXJTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdHlwZSA9IHJlc3VsdFsxXTtcbiAgICB2YXIgaWRlbnRpZmllciA9IHJlc3VsdFsyXTtcbiAgICB2YXIgdmFsdWUgPSB7IHR5cGU6IHR5cGUsIGlkZW50aWZpZXI6IGlkZW50aWZpZXIgfTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3IgPSBwYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3RvcjtcbnZhciBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4ID0gL1xcW1xccyooW18tXFx3XVtfLVxcd1xcZF0qKVxccyooPzooPXxcXF49fFxcJD18XFwqPXxcXH49fFxcfD0pXFxzKig/OihbXy1cXHddW18tXFx3XFxkXSopfFwiKCg/OlteXFxcXFwiXXxcXFxcKD86XCJ8bnxyfGZ8XFxcXHwwLTlhLWYpKSopXCJ8JygoPzpbXlxcXFwnXXxcXFxcKD86J3xufHJ8ZnxcXFxcfDAtOWEtZikpKiknKVxccyopP1xcXS9neTtcbmZ1bmN0aW9uIHBhcnNlQXR0cmlidXRlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBhdHRyaWJ1dGVTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgcHJvcGVydHkgPSByZXN1bHRbMV07XG4gICAgaWYgKHJlc3VsdFsyXSkge1xuICAgICAgICB2YXIgdGVzdF8xID0gcmVzdWx0WzJdO1xuICAgICAgICB2YXIgdmFsdWUgPSByZXN1bHRbM10gfHwgcmVzdWx0WzRdIHx8IHJlc3VsdFs1XTtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCJbXVwiLCBwcm9wZXJ0eTogcHJvcGVydHksIHRlc3Q6IHRlc3RfMSwgdmFsdWU6IHZhbHVlIH0gfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCJbXVwiLCBwcm9wZXJ0eTogcHJvcGVydHkgfSB9O1xufVxuZXhwb3J0cy5wYXJzZUF0dHJpYnV0ZVNlbGVjdG9yID0gcGFyc2VBdHRyaWJ1dGVTZWxlY3RvcjtcbmZ1bmN0aW9uIHBhcnNlU2ltcGxlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZXR1cm4gcGFyc2VVbml2ZXJzYWxTZWxlY3Rvcih0ZXh0LCBzdGFydCkgfHxcbiAgICAgICAgcGFyc2VTaW1wbGVJZGVudGlmaWVyU2VsZWN0b3IodGV4dCwgc3RhcnQpIHx8XG4gICAgICAgIHBhcnNlQXR0cmlidXRlU2VsZWN0b3IodGV4dCwgc3RhcnQpO1xufVxuZXhwb3J0cy5wYXJzZVNpbXBsZVNlbGVjdG9yID0gcGFyc2VTaW1wbGVTZWxlY3RvcjtcbmZ1bmN0aW9uIHBhcnNlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSh0ZXh0LCBzdGFydCkge1xuICAgIHZhciBzaW1wbGVTZWxlY3RvciA9IHBhcnNlU2ltcGxlU2VsZWN0b3IodGV4dCwgc3RhcnQpO1xuICAgIGlmICghc2ltcGxlU2VsZWN0b3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzaW1wbGVTZWxlY3Rvci5lbmQ7XG4gICAgdmFyIHZhbHVlID0gW107XG4gICAgd2hpbGUgKHNpbXBsZVNlbGVjdG9yKSB7XG4gICAgICAgIHZhbHVlLnB1c2goc2ltcGxlU2VsZWN0b3IudmFsdWUpO1xuICAgICAgICBlbmQgPSBzaW1wbGVTZWxlY3Rvci5lbmQ7XG4gICAgICAgIHNpbXBsZVNlbGVjdG9yID0gcGFyc2VTaW1wbGVTZWxlY3Rvcih0ZXh0LCBlbmQpO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gcGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlO1xudmFyIGNvbWJpbmF0b3JSZWdFeCA9IC9cXHMqKFxcK3x+fD4pP1xccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUNvbWJpbmF0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBjb21iaW5hdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGNvbWJpbmF0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gY29tYmluYXRvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV0gfHwgXCIgXCI7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlQ29tYmluYXRvciA9IHBhcnNlQ29tYmluYXRvcjtcbnZhciB3aGl0ZVNwYWNlUmVnRXggPSAvXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlU2VsZWN0b3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgZW5kID0gc3RhcnQ7XG4gICAgd2hpdGVTcGFjZVJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICB2YXIgbGVhZGluZ1doaXRlU3BhY2UgPSB3aGl0ZVNwYWNlUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAobGVhZGluZ1doaXRlU3BhY2UpIHtcbiAgICAgICAgZW5kID0gd2hpdGVTcGFjZVJlZ0V4Lmxhc3RJbmRleDtcbiAgICB9XG4gICAgdmFyIHZhbHVlID0gW107XG4gICAgdmFyIGNvbWJpbmF0b3I7XG4gICAgdmFyIGV4cGVjdFNpbXBsZVNlbGVjdG9yID0gdHJ1ZTtcbiAgICB2YXIgcGFpcjtcbiAgICBkbyB7XG4gICAgICAgIHZhciBzaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gcGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlKHRleHQsIGVuZCk7XG4gICAgICAgIGlmICghc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSkge1xuICAgICAgICAgICAgaWYgKGV4cGVjdFNpbXBsZVNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbmQgPSBzaW1wbGVTZWxlY3RvclNlcXVlbmNlLmVuZDtcbiAgICAgICAgaWYgKGNvbWJpbmF0b3IpIHtcbiAgICAgICAgICAgIHBhaXJbMV0gPSBjb21iaW5hdG9yLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHBhaXIgPSBbc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS52YWx1ZSwgdW5kZWZpbmVkXTtcbiAgICAgICAgdmFsdWUucHVzaChwYWlyKTtcbiAgICAgICAgY29tYmluYXRvciA9IHBhcnNlQ29tYmluYXRvcih0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoY29tYmluYXRvcikge1xuICAgICAgICAgICAgZW5kID0gY29tYmluYXRvci5lbmQ7XG4gICAgICAgIH1cbiAgICAgICAgZXhwZWN0U2ltcGxlU2VsZWN0b3IgPSBjb21iaW5hdG9yICYmIGNvbWJpbmF0b3IudmFsdWUgIT09IFwiIFwiO1xuICAgIH0gd2hpbGUgKGNvbWJpbmF0b3IpO1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVNlbGVjdG9yID0gcGFyc2VTZWxlY3RvcjtcbnZhciB3aGl0ZXNwYWNlUmVnRXggPSAvW1xcc1xcdFxcblxcclxcZl0qL2d5bTtcbnZhciBzaW5nbGVRdW90ZVN0cmluZ1JlZ0V4ID0gLycoKD86W15cXG5cXHJcXGZcXCddfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkqKSg6Pyd8JCkvZ3ltO1xudmFyIGRvdWJsZVF1b3RlU3RyaW5nUmVnRXggPSAvXCIoKD86W15cXG5cXHJcXGZcXFwiXXxcXFxcKD86XFwkfFxcbnxbMC05YS1mQS1GXXsxLDZ9XFxzPykpKikoOj9cInwkKS9neW07XG52YXIgY29tbWVudFJlZ0V4ID0gLyhcXC9cXCooPzpbXlxcKl18XFwqW15cXC9dKSpcXCpcXC8pL2d5bTtcbnZhciBudW1iZXJSZWdFeCA9IC9bXFwrXFwtXT8oPzpcXGQrXFwuXFxkK3xcXGQrfFxcLlxcZCspKD86W2VFXVtcXCtcXC1dP1xcZCspPy9neW07XG52YXIgbmFtZVJlZ0V4ID0gLy0/KD86KD86W2EtekEtWl9dfFteXFx4MDAtXFx4N0ZdfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkoPzpbYS16QS1aXzAtOVxcLV0qfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkqKS9neW07XG52YXIgQ1NTM1BhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ1NTM1BhcnNlcih0ZXh0KSB7XG4gICAgICAgIHRoaXMudGV4dCA9IHRleHQ7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSAwO1xuICAgIH1cbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS50b2tlbml6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgICB2YXIgaW5wdXRUb2tlbjtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICAgICAgdG9rZW5zLnB1c2goaW5wdXRUb2tlbik7XG4gICAgICAgIH0gd2hpbGUgKGlucHV0VG9rZW4pO1xuICAgICAgICByZXR1cm4gdG9rZW5zO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVjb25zdW1lZElucHV0VG9rZW4pIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLnJlY29uc3VtZWRJbnB1dFRva2VuO1xuICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbiA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICAgIGNhc2UgXCJcXFwiXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCInXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIoXCI6XG4gICAgICAgICAgICBjYXNlIFwiKVwiOlxuICAgICAgICAgICAgY2FzZSBcIixcIjpcbiAgICAgICAgICAgIGNhc2UgXCI6XCI6XG4gICAgICAgICAgICBjYXNlIFwiO1wiOlxuICAgICAgICAgICAgY2FzZSBcIltcIjpcbiAgICAgICAgICAgIGNhc2UgXCJdXCI6XG4gICAgICAgICAgICBjYXNlIFwie1wiOlxuICAgICAgICAgICAgY2FzZSBcIn1cIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoYXI7XG4gICAgICAgICAgICBjYXNlIFwiI1wiOiByZXR1cm4gdGhpcy5jb25zdW1lQUhhc2hUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcdFwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcblwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcclwiOlxuICAgICAgICAgICAgY2FzZSBcIlxcZlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBV2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgY2FzZSBcIkBcIjogcmV0dXJuIHRoaXMuY29uc3VtZUF0S2V5d29yZCgpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiXFxcXFwiOiByZXR1cm4gdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiMFwiOlxuICAgICAgICAgICAgY2FzZSBcIjFcIjpcbiAgICAgICAgICAgIGNhc2UgXCIyXCI6XG4gICAgICAgICAgICBjYXNlIFwiM1wiOlxuICAgICAgICAgICAgY2FzZSBcIjRcIjpcbiAgICAgICAgICAgIGNhc2UgXCI1XCI6XG4gICAgICAgICAgICBjYXNlIFwiNlwiOlxuICAgICAgICAgICAgY2FzZSBcIjdcIjpcbiAgICAgICAgICAgIGNhc2UgXCI4XCI6XG4gICAgICAgICAgICBjYXNlIFwiOVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBTnVtZXJpY1Rva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwidVwiOlxuICAgICAgICAgICAgY2FzZSBcIlVcIjpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKyAxXSA9PT0gXCIrXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXJkQ2hhciA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMl07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlyZENoYXIgPj0gXCIwXCIgJiYgdGhpcmRDaGFyIDw9IFwiOVwiIHx8IHRoaXJkQ2hhciA9PT0gXCI/XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuaWNvZGUgdG9rZW5zIG5vdCBzdXBwb3J0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBbklkZW50TGlrZVRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIkXCI6XG4gICAgICAgICAgICBjYXNlIFwiKlwiOlxuICAgICAgICAgICAgY2FzZSBcIl5cIjpcbiAgICAgICAgICAgIGNhc2UgXCJ8XCI6XG4gICAgICAgICAgICBjYXNlIFwiflwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBTWF0Y2hUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiLVwiOiByZXR1cm4gdGhpcy5jb25zdW1lQU51bWVyaWNUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVDREMoKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIitcIjpcbiAgICAgICAgICAgIGNhc2UgXCIuXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFOdW1lcmljVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIi9cIjogcmV0dXJuIHRoaXMuY29uc3VtZUFDb21tZW50KCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCI8XCI6IHJldHVybiB0aGlzLmNvbnN1bWVDRE8oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSB1bmRlZmluZWQ6IHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBRGVsaW1Ub2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogMiwgdGV4dDogdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrK10gfTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBV2hpdGVzcGFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgd2hpdGVzcGFjZVJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHdoaXRlc3BhY2VSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSB3aGl0ZXNwYWNlUmVnRXgubGFzdEluZGV4O1xuICAgICAgICByZXR1cm4gXCIgXCI7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUhhc2hUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICB2YXIgaGFzaE5hbWUgPSB0aGlzLmNvbnN1bWVBTmFtZSgpO1xuICAgICAgICBpZiAoaGFzaE5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDEyLCB0ZXh0OiBcIiNcIiArIGhhc2hOYW1lLnRleHQgfTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LS07XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUNETyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dC5zdWJzdHIodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCwgNCkgPT09IFwiPCEtLVwiKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICs9IDQ7XG4gICAgICAgICAgICByZXR1cm4gXCI8IS0tXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQ0RDID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0LnN1YnN0cih0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LCAzKSA9PT0gXCItLT5cIikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArPSAzO1xuICAgICAgICAgICAgcmV0dXJuIFwiLS0+XCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQU1hdGNoVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArIDFdID09PSBcIj1cIikge1xuICAgICAgICAgICAgdmFyIHRva2VuID0gdGhpcy50ZXh0LnN1YnN0cih0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LCAyKTtcbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKz0gMjtcbiAgICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTnVtZXJpY1Rva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBudW1iZXJSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICB2YXIgcmVzdWx0ID0gbnVtYmVyUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IG51bWJlclJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSA9PT0gXCIlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDQsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDUsIHRleHQ6IHJlc3VsdFswXSArIG5hbWUudGV4dCB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDMsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdID09PSBcIihcIikge1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgaWYgKG5hbWUudGV4dC50b0xvd2VyQ2FzZSgpID09PSBcInVybFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFVUkxUb2tlbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogOCwgbmFtZTogbmFtZS50ZXh0LCB0ZXh0OiBuYW1lLnRleHQgKyBcIihcIiB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFTdHJpbmdUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoYXIgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChjaGFyID09PSBcIidcIikge1xuICAgICAgICAgICAgc2luZ2xlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgcmVzdWx0ID0gc2luZ2xlUXVvdGVTdHJpbmdSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IHNpbmdsZVF1b3RlU3RyaW5nUmVnRXgubGFzdEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNoYXIgPT09IFwiXFxcIlwiKSB7XG4gICAgICAgICAgICBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICByZXN1bHQgPSBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gZG91YmxlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogMSwgdGV4dDogcmVzdWx0WzBdIH07XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVVSTFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4IC0gMyAtIDE7XG4gICAgICAgIHZhciB1cmxUb2tlbiA9IHsgdHlwZTogNywgdGV4dDogdW5kZWZpbmVkIH07XG4gICAgICAgIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgIGlmICh0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID49IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV4dElucHV0Q29kZVBvaW50ID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdO1xuICAgICAgICBpZiAobmV4dElucHV0Q29kZVBvaW50ID09PSBcIlxcXCJcIiB8fCBuZXh0SW5wdXRDb2RlUG9pbnQgPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICB2YXIgc3RyaW5nVG9rZW4gPSB0aGlzLmNvbnN1bWVBU3RyaW5nVG9rZW4oKTtcbiAgICAgICAgICAgIHVybFRva2VuLnRleHQgPSBzdHJpbmdUb2tlbi50ZXh0O1xuICAgICAgICAgICAgdGhpcy5jb25zdW1lQVdoaXRlc3BhY2UoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiKVwiIHx8IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPj0gdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgICAgICB1cmxUb2tlbi50ZXh0ID0gdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCwgZW5kKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA8IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBjaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrK107XG4gICAgICAgICAgICBzd2l0Y2ggKGNoYXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiKVwiOiByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICAgICAgY2FzZSBcIiBcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFx0XCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcblwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXHJcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxmXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiKVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJsVG9rZW47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXFwiXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcJ1wiOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxcXFwiOlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFc2NhcGluZyBub3QgeWV0IHN1cHBvcnRlZCFcIik7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdXJsVG9rZW4udGV4dCArPSBjaGFyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTmFtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbmFtZVJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHZhciByZXN1bHQgPSBuYW1lUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IG5hbWVSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIHJldHVybiB7IHR5cGU6IDYsIHRleHQ6IHJlc3VsdFswXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUF0S2V5d29yZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICB2YXIgbmFtZSA9IHRoaXMuY29uc3VtZUFOYW1lKCk7XG4gICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiAxMSwgdGV4dDogbmFtZS50ZXh0IH07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleC0tO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBQ29tbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMV0gPT09IFwiKlwiKSB7XG4gICAgICAgICAgICBjb21tZW50UmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBjb21tZW50UmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBjb21tZW50UmVnRXgubGFzdEluZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4gPSBmdW5jdGlvbiAoY3VycmVudElucHV0VG9rZW4pIHtcbiAgICAgICAgdGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbiA9IGN1cnJlbnRJbnB1dFRva2VuO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUucGFyc2VBU3R5bGVzaGVldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy50b3BMZXZlbEZsYWcgPSB0cnVlO1xuICAgICAgICB2YXIgc3R5bGVzaGVldCA9IHtcbiAgICAgICAgICAgIHJ1bGVzOiB0aGlzLmNvbnN1bWVBTGlzdE9mUnVsZXMoKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3R5bGVzaGVldDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTGlzdE9mUnVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBydWxlcyA9IFtdO1xuICAgICAgICB2YXIgaW5wdXRUb2tlbjtcbiAgICAgICAgd2hpbGUgKGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKSkge1xuICAgICAgICAgICAgc3dpdGNoIChpbnB1dFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIiBcIjogY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSBcIjwhLS1cIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiLS0+XCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvcExldmVsRmxhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0UnVsZSA9IHRoaXMuY29uc3VtZUFuQXRSdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdFJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bGVzLnB1c2goYXRSdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dFRva2VuLnR5cGUgPT09IDExKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICB2YXIgYXRSdWxlID0gdGhpcy5jb25zdW1lQW5BdFJ1bGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoYXRSdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bGVzLnB1c2goYXRSdWxlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgdmFyIHF1YWxpZmllZFJ1bGUgPSB0aGlzLmNvbnN1bWVBUXVhbGlmaWVkUnVsZSgpO1xuICAgICAgICAgICAgaWYgKHF1YWxpZmllZFJ1bGUpIHtcbiAgICAgICAgICAgICAgICBydWxlcy5wdXNoKHF1YWxpZmllZFJ1bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBydWxlcztcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBbkF0UnVsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKTtcbiAgICAgICAgdmFyIGF0UnVsZSA9IHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXQtcnVsZVwiLFxuICAgICAgICAgICAgbmFtZTogaW5wdXRUb2tlbi50ZXh0LFxuICAgICAgICAgICAgcHJlbHVkZTogW10sXG4gICAgICAgICAgICBibG9jazogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHdoaWxlIChpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCkpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjtcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpbnB1dFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgIGF0UnVsZS5ibG9jayA9IHRoaXMuY29uc3VtZUFTaW1wbGVCbG9jayhpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5wdXRUb2tlbi50eXBlID09PSA5ICYmIGlucHV0VG9rZW4uYXNzb2NpYXRlZFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgIGF0UnVsZS5ibG9jayA9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0UnVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5jb25zdW1lQUNvbXBvbmVudFZhbHVlKCk7XG4gICAgICAgICAgICBpZiAoY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgYXRSdWxlLnByZWx1ZGUucHVzaChjb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVF1YWxpZmllZFJ1bGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBxdWFsaWZpZWRSdWxlID0ge1xuICAgICAgICAgICAgdHlwZTogXCJxdWFsaWZpZWQtcnVsZVwiLFxuICAgICAgICAgICAgcHJlbHVkZTogW10sXG4gICAgICAgICAgICBibG9jazogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHZhciBpbnB1dFRva2VuO1xuICAgICAgICB3aGlsZSAoaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCJ7XCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmxvY2sgPSB0aGlzLmNvbnN1bWVBU2ltcGxlQmxvY2soaW5wdXRUb2tlbik7XG4gICAgICAgICAgICAgICAgcXVhbGlmaWVkUnVsZS5ibG9jayA9IGJsb2NrO1xuICAgICAgICAgICAgICAgIHJldHVybiBxdWFsaWZpZWRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5wdXRUb2tlbi50eXBlID09PSA5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNpbXBsZUJsb2NrID0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICBpZiAoc2ltcGxlQmxvY2suYXNzb2NpYXRlZFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgICAgICBxdWFsaWZpZWRSdWxlLmJsb2NrID0gc2ltcGxlQmxvY2s7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBxdWFsaWZpZWRSdWxlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50VmFsdWUgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHF1YWxpZmllZFJ1bGUucHJlbHVkZS5wdXNoKGNvbXBvbmVudFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCk7XG4gICAgICAgIHN3aXRjaCAoaW5wdXRUb2tlbikge1xuICAgICAgICAgICAgY2FzZSBcIntcIjpcbiAgICAgICAgICAgIGNhc2UgXCJbXCI6XG4gICAgICAgICAgICBjYXNlIFwiKFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQVNpbXBsZUJsb2NrKGlucHV0VG9rZW4pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJvYmplY3RcIiAmJiBpbnB1dFRva2VuLnR5cGUgPT09IDgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBRnVuY3Rpb24oaW5wdXRUb2tlbi5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5wdXRUb2tlbjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBU2ltcGxlQmxvY2sgPSBmdW5jdGlvbiAoYXNzb2NpYXRlZFRva2VuKSB7XG4gICAgICAgIHZhciBlbmRpYW5Ub2tlbiA9IHtcbiAgICAgICAgICAgIFwiW1wiOiBcIl1cIixcbiAgICAgICAgICAgIFwie1wiOiBcIn1cIixcbiAgICAgICAgICAgIFwiKFwiOiBcIilcIlxuICAgICAgICB9W2Fzc29jaWF0ZWRUb2tlbl07XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggLSAxO1xuICAgICAgICB2YXIgYmxvY2sgPSB7XG4gICAgICAgICAgICB0eXBlOiA5LFxuICAgICAgICAgICAgdGV4dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgYXNzb2NpYXRlZFRva2VuOiBhc3NvY2lhdGVkVG9rZW4sXG4gICAgICAgICAgICB2YWx1ZXM6IFtdXG4gICAgICAgIH07XG4gICAgICAgIHZhciBuZXh0SW5wdXRUb2tlbjtcbiAgICAgICAgd2hpbGUgKG5leHRJbnB1dFRva2VuID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdKSB7XG4gICAgICAgICAgICBpZiAobmV4dElucHV0VG9rZW4gPT09IGVuZGlhblRva2VuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgICAgIGJsb2NrLnRleHQgPSB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBibG9jaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuY29uc3VtZUFDb21wb25lbnRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgYmxvY2sudmFsdWVzLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJsb2NrLnRleHQgPSB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0KTtcbiAgICAgICAgcmV0dXJuIGJsb2NrO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFGdW5jdGlvbiA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHZhciBmdW5jVG9rZW4gPSB7IHR5cGU6IDE0LCBuYW1lOiBuYW1lLCB0ZXh0OiB1bmRlZmluZWQsIGNvbXBvbmVudHM6IFtdIH07XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID49IHRoaXMudGV4dC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmdW5jVG9rZW4udGV4dCA9IG5hbWUgKyBcIihcIiArIHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jVG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmV4dElucHV0VG9rZW4gPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgICAgICBzd2l0Y2ggKG5leHRJbnB1dFRva2VuKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcIilcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgZnVuY1Rva2VuLnRleHQgPSBuYW1lICsgXCIoXCIgKyB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY1Rva2VuO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY1Rva2VuLmNvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKHRydWUpO1xuICAgIH07XG4gICAgcmV0dXJuIENTUzNQYXJzZXI7XG59KCkpO1xuZXhwb3J0cy5DU1MzUGFyc2VyID0gQ1NTM1BhcnNlcjtcbnZhciBDU1NOYXRpdmVTY3JpcHQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENTU05hdGl2ZVNjcmlwdCgpIHtcbiAgICB9XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVN0eWxlc2hlZXQgPSBmdW5jdGlvbiAoc3R5bGVzaGVldCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogXCJzdHlsZXNoZWV0XCIsXG4gICAgICAgICAgICBzdHlsZXNoZWV0OiB7XG4gICAgICAgICAgICAgICAgcnVsZXM6IHRoaXMucGFyc2VSdWxlcyhzdHlsZXNoZWV0LnJ1bGVzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wYXJzZVJ1bGVzID0gZnVuY3Rpb24gKHJ1bGVzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBydWxlcy5tYXAoZnVuY3Rpb24gKHJ1bGUpIHsgcmV0dXJuIF90aGlzLnBhcnNlUnVsZShydWxlKTsgfSk7XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIGlmIChydWxlLnR5cGUgPT09IFwiYXQtcnVsZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZUF0UnVsZShydWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChydWxlLnR5cGUgPT09IFwicXVhbGlmaWVkLXJ1bGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VRdWFsaWZpZWRSdWxlKHJ1bGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlQXRSdWxlID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgaWYgKHJ1bGUubmFtZSA9PT0gXCJpbXBvcnRcIikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbXBvcnQ6IHJ1bGUucHJlbHVkZS5tYXAoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIHR5cGVvZiBtID09PSBcInN0cmluZ1wiID8gbSA6IG0udGV4dDsgfSkuam9pbihcIlwiKS50cmltKCksXG4gICAgICAgICAgICAgICAgdHlwZTogXCJpbXBvcnRcIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlUXVhbGlmaWVkUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBcInJ1bGVcIixcbiAgICAgICAgICAgIHNlbGVjdG9yczogdGhpcy5wcmVsdWRlVG9TZWxlY3RvcnNTdHJpbmdBcnJheShydWxlLnByZWx1ZGUpLFxuICAgICAgICAgICAgZGVjbGFyYXRpb25zOiB0aGlzLnJ1bGVCbG9ja1RvRGVjbGFyYXRpb25zKHJ1bGUuYmxvY2sudmFsdWVzKVxuICAgICAgICB9O1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5ydWxlQmxvY2tUb0RlY2xhcmF0aW9ucyA9IGZ1bmN0aW9uIChkZWNsYXJhdGlvbnNJbnB1dFRva2Vucykge1xuICAgICAgICB2YXIgZGVjbGFyYXRpb25zID0gW107XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IFwiXCI7XG4gICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgICAgIHZhciByZWFkaW5nID0gXCJwcm9wZXJ0eVwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRlY2xhcmF0aW9uc0lucHV0VG9rZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRUb2tlbiA9IGRlY2xhcmF0aW9uc0lucHV0VG9rZW5zW2ldO1xuICAgICAgICAgICAgaWYgKHJlYWRpbmcgPT09IFwicHJvcGVydHlcIikge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjpcIikge1xuICAgICAgICAgICAgICAgICAgICByZWFkaW5nID0gXCJ2YWx1ZVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXRUb2tlbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSArPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgKz0gaW5wdXRUb2tlbi50ZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIjtcIikge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IHByb3BlcnR5LnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5wdXNoKHsgdHlwZTogXCJkZWNsYXJhdGlvblwiLCBwcm9wZXJ0eTogcHJvcGVydHksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHkgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBcInByb3BlcnR5XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSArPSBpbnB1dFRva2VuLnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkudHJpbSgpO1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgaWYgKHByb3BlcnR5IHx8IHZhbHVlKSB7XG4gICAgICAgICAgICBkZWNsYXJhdGlvbnMucHVzaCh7IHR5cGU6IFwiZGVjbGFyYXRpb25cIiwgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY2xhcmF0aW9ucztcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucHJlbHVkZVRvU2VsZWN0b3JzU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAocHJlbHVkZSkge1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gW107XG4gICAgICAgIHZhciBzZWxlY3RvciA9IFwiXCI7XG4gICAgICAgIHByZWx1ZGUuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRUb2tlbikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwiLFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0b3JzLnB1c2goc2VsZWN0b3IudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciArPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3IgKz0gaW5wdXRUb2tlbi50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICBzZWxlY3RvcnMucHVzaChzZWxlY3Rvci50cmltKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RvcnM7XG4gICAgfTtcbiAgICByZXR1cm4gQ1NTTmF0aXZlU2NyaXB0O1xufSgpKTtcbmV4cG9ydHMuQ1NTTmF0aXZlU2NyaXB0ID0gQ1NTTmF0aXZlU2NyaXB0O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFyc2VyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBvYnNlcnZhYmxlID0gcmVxdWlyZShcIi4uL29ic2VydmFibGVcIik7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgQ2hhbmdlVHlwZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2hhbmdlVHlwZSgpIHtcbiAgICB9XG4gICAgQ2hhbmdlVHlwZS5BZGQgPSBcImFkZFwiO1xuICAgIENoYW5nZVR5cGUuRGVsZXRlID0gXCJkZWxldGVcIjtcbiAgICBDaGFuZ2VUeXBlLlVwZGF0ZSA9IFwidXBkYXRlXCI7XG4gICAgQ2hhbmdlVHlwZS5TcGxpY2UgPSBcInNwbGljZVwiO1xuICAgIHJldHVybiBDaGFuZ2VUeXBlO1xufSgpKTtcbmV4cG9ydHMuQ2hhbmdlVHlwZSA9IENoYW5nZVR5cGU7XG52YXIgQ0hBTkdFID0gXCJjaGFuZ2VcIjtcbnZhciBPYnNlcnZhYmxlQXJyYXkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhPYnNlcnZhYmxlQXJyYXksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZUFycmF5KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSAmJiBBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgICAgIF90aGlzLl9hcnJheSA9IGFyZ3VtZW50c1swXS5zbGljZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMuX2FycmF5ID0gQXJyYXkuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBfdGhpcy5fYWRkQXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IF90aGlzLFxuICAgICAgICAgICAgYWN0aW9uOiBDaGFuZ2VUeXBlLkFkZCxcbiAgICAgICAgICAgIGluZGV4OiBudWxsLFxuICAgICAgICAgICAgcmVtb3ZlZDogbmV3IEFycmF5KCksXG4gICAgICAgICAgICBhZGRlZENvdW50OiAxXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9kZWxldGVBcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBDSEFOR0UsIG9iamVjdDogX3RoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuRGVsZXRlLFxuICAgICAgICAgICAgaW5kZXg6IG51bGwsXG4gICAgICAgICAgICByZW1vdmVkOiBudWxsLFxuICAgICAgICAgICAgYWRkZWRDb3VudDogMFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXlbaW5kZXhdO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zZXRJdGVtID0gZnVuY3Rpb24gKGluZGV4LCB2YWx1ZSkge1xuICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzLl9hcnJheVtpbmRleF07XG4gICAgICAgIHRoaXMuX2FycmF5W2luZGV4XSA9IHZhbHVlO1xuICAgICAgICB0aGlzLm5vdGlmeSh7XG4gICAgICAgICAgICBldmVudE5hbWU6IENIQU5HRSwgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgYWN0aW9uOiBDaGFuZ2VUeXBlLlVwZGF0ZSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIHJlbW92ZWQ6IFtvbGRWYWx1ZV0sXG4gICAgICAgICAgICBhZGRlZENvdW50OiAxXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUsIFwibGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVzLmlzTnVtYmVyKHZhbHVlKSAmJiB0aGlzLl9hcnJheSAmJiB0aGlzLl9hcnJheS5sZW5ndGggIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UodmFsdWUsIHRoaXMuX2FycmF5Lmxlbmd0aCAtIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnRvU3RyaW5nKCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkudG9Mb2NhbGVTdHJpbmcoKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9hZGRBcmdzLmluZGV4ID0gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkuY29uY2F0LmFwcGx5KHRoaXMuX2FycmF5LCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5qb2luID0gZnVuY3Rpb24gKHNlcGFyYXRvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuam9pbihzZXBhcmF0b3IpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5wb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUFyZ3MuaW5kZXggPSB0aGlzLl9hcnJheS5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkucG9wKCk7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUFyZ3MucmVtb3ZlZCA9IFtyZXN1bHRdO1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9kZWxldGVBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuaW5kZXggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gc291cmNlLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FycmF5LnB1c2goc291cmNlW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2FycmF5LnB1c2guYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYWRkQXJncy5hZGRlZENvdW50ID0gdGhpcy5fYXJyYXkubGVuZ3RoIC0gdGhpcy5fYWRkQXJncy5pbmRleDtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fYWRkQXJncyk7XG4gICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5fbm90aWZ5TGVuZ3RoQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGVuZ3RoQ2hhbmdlZERhdGEgPSB0aGlzLl9jcmVhdGVQcm9wZXJ0eUNoYW5nZURhdGEoXCJsZW5ndGhcIiwgdGhpcy5fYXJyYXkubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5ub3RpZnkobGVuZ3RoQ2hhbmdlZERhdGEpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkucmV2ZXJzZSgpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zaGlmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2FycmF5LnNoaWZ0KCk7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUFyZ3MuaW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9kZWxldGVBcmdzLnJlbW92ZWQgPSBbcmVzdWx0XTtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fZGVsZXRlQXJncyk7XG4gICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5zbGljZShzdGFydCwgZW5kKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc29ydCA9IGZ1bmN0aW9uIChjb21wYXJlRm4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnNvcnQoY29tcGFyZUZuKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuc3BsaWNlID0gZnVuY3Rpb24gKHN0YXJ0LCBkZWxldGVDb3VudCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkuc3BsaWNlLmFwcGx5KHRoaXMuX2FycmF5LCBhcmd1bWVudHMpO1xuICAgICAgICB0aGlzLm5vdGlmeSh7XG4gICAgICAgICAgICBldmVudE5hbWU6IENIQU5HRSwgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgYWN0aW9uOiBDaGFuZ2VUeXBlLlNwbGljZSxcbiAgICAgICAgICAgIGluZGV4OiBzdGFydCxcbiAgICAgICAgICAgIHJlbW92ZWQ6IHJlc3VsdCxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IHRoaXMuX2FycmF5Lmxlbmd0aCArIHJlc3VsdC5sZW5ndGggLSBsZW5ndGhcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLl9hcnJheS5sZW5ndGggIT09IGxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUudW5zaGlmdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2FycmF5LnVuc2hpZnQuYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuaW5kZXggPSAwO1xuICAgICAgICB0aGlzLl9hZGRBcmdzLmFkZGVkQ291bnQgPSByZXN1bHQgLSBsZW5ndGg7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2FkZEFyZ3MpO1xuICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChzZWFyY2hFbGVtZW50LCBmcm9tSW5kZXgpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gZnJvbUluZGV4ID8gZnJvbUluZGV4IDogMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IGluZGV4LCBsID0gdGhpcy5fYXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYXJyYXlbaV0gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmxhc3RJbmRleE9mID0gZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuICAgICAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggPyBmcm9tSW5kZXggOiB0aGlzLl9hcnJheS5sZW5ndGggLSAxO1xuICAgICAgICBmb3IgKHZhciBpID0gaW5kZXg7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYXJyYXlbaV0gPT09IHNlYXJjaEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmV2ZXJ5ID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIHRoaXNBcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LmV2ZXJ5KGNhbGxiYWNrZm4sIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zb21lID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIHRoaXNBcmcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnNvbWUoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICB0aGlzLl9hcnJheS5mb3JFYWNoKGNhbGxiYWNrZm4sIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkubWFwKGNhbGxiYWNrZm4sIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuZmlsdGVyKGNhbGxiYWNrZm4sIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpbml0aWFsVmFsdWUgIT09IHVuZGVmaW5lZCA/IHRoaXMuX2FycmF5LnJlZHVjZShjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIDogdGhpcy5fYXJyYXkucmVkdWNlKGNhbGxiYWNrZm4pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxWYWx1ZSAhPT0gdW5kZWZpbmVkID8gdGhpcy5fYXJyYXkucmVkdWNlUmlnaHQoY2FsbGJhY2tmbiwgaW5pdGlhbFZhbHVlKSA6IHRoaXMuX2FycmF5LnJlZHVjZVJpZ2h0KGNhbGxiYWNrZm4pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LmNoYW5nZUV2ZW50ID0gQ0hBTkdFO1xuICAgIHJldHVybiBPYnNlcnZhYmxlQXJyYXk7XG59KG9ic2VydmFibGUuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5PYnNlcnZhYmxlQXJyYXkgPSBPYnNlcnZhYmxlQXJyYXk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLWFycmF5LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBfd3JhcHBlZEluZGV4ID0gMDtcbnZhciBXcmFwcGVkVmFsdWUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdyYXBwZWRWYWx1ZSh3cmFwcGVkKSB7XG4gICAgICAgIHRoaXMud3JhcHBlZCA9IHdyYXBwZWQ7XG4gICAgfVxuICAgIFdyYXBwZWRWYWx1ZS51bndyYXAgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSBpbnN0YW5jZW9mIFdyYXBwZWRWYWx1ZSkgPyB2YWx1ZS53cmFwcGVkIDogdmFsdWU7XG4gICAgfTtcbiAgICBXcmFwcGVkVmFsdWUud3JhcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgdyA9IF93cmFwcGVkVmFsdWVzW193cmFwcGVkSW5kZXgrKyAlIDVdO1xuICAgICAgICB3LndyYXBwZWQgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHc7XG4gICAgfTtcbiAgICByZXR1cm4gV3JhcHBlZFZhbHVlO1xufSgpKTtcbmV4cG9ydHMuV3JhcHBlZFZhbHVlID0gV3JhcHBlZFZhbHVlO1xudmFyIF93cmFwcGVkVmFsdWVzID0gW1xuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbCksXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpLFxuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbCksXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKVxuXTtcbnZhciBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xuICAgICAgICB0aGlzLl9vYnNlcnZlcnMgPSB7fTtcbiAgICB9XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbbmFtZV07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG9sZFZhbHVlID0gdGhpc1tuYW1lXTtcbiAgICAgICAgaWYgKHRoaXNbbmFtZV0gPT09IHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gV3JhcHBlZFZhbHVlLnVud3JhcCh2YWx1ZSk7XG4gICAgICAgIHRoaXNbbmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShuYW1lLCBuZXdWYWx1ZSwgb2xkVmFsdWUpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbiAoZXZlbnQsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIHZhciBsaXN0ID0gdGhpcy5fZ2V0RXZlbnRMaXN0KGV2ZW50LCB0cnVlKTtcbiAgICAgICAgbGlzdC5wdXNoKHsgY2FsbGJhY2s6IGNhbGxiYWNrLCB0aGlzQXJnOiB0aGlzQXJnLCBvbmNlOiB0cnVlIH0pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnROYW1lcyAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV2ZW50cyBuYW1lKHMpIG11c3QgYmUgc3RyaW5nLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYWxsYmFjayBtdXN0IGJlIGZ1bmN0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXZlbnRzID0gZXZlbnROYW1lcy5zcGxpdChcIixcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGV2ZW50XzEgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXRFdmVudExpc3QoZXZlbnRfMSwgdHJ1ZSk7XG4gICAgICAgICAgICBsaXN0LnB1c2goe1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICAgICAgICAgICAgICB0aGlzQXJnOiB0aGlzQXJnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBpZiAodHlwZW9mIGV2ZW50TmFtZXMgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFdmVudHMgbmFtZShzKSBtdXN0IGJlIHN0cmluZy5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2FsbGJhY2sgbXVzdCBiZSBmdW5jdGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV2ZW50cyA9IGV2ZW50TmFtZXMuc3BsaXQoXCIsXCIpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGV2ZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudF8yID0gZXZlbnRzW2ldLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fZ2V0RXZlbnRMaXN0KGV2ZW50XzIsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBpZiAobGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXhfMSA9IHRoaXMuX2luZGV4T2ZMaXN0ZW5lcihsaXN0LCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleF8xID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Quc3BsaWNlKGluZGV4XzEsIDEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX29ic2VydmVyc1tldmVudF8yXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyc1tldmVudF8yXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50XzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5fb2JzZXJ2ZXJzW2RhdGEuZXZlbnROYW1lXTtcbiAgICAgICAgaWYgKCFvYnNlcnZlcnMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gb2JzZXJ2ZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgZW50cnkgPSBvYnNlcnZlcnNbaV07XG4gICAgICAgICAgICBpZiAoZW50cnkub25jZSkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW50cnkudGhpc0FyZykge1xuICAgICAgICAgICAgICAgIGVudHJ5LmNhbGxiYWNrLmFwcGx5KGVudHJ5LnRoaXNBcmcsIFtkYXRhXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRyeS5jYWxsYmFjayhkYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubm90aWZ5UHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2NyZWF0ZVByb3BlcnR5Q2hhbmdlRGF0YShuYW1lLCB2YWx1ZSwgb2xkVmFsdWUpKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmhhc0xpc3RlbmVycyA9IGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50TmFtZSBpbiB0aGlzLl9vYnNlcnZlcnM7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5fY3JlYXRlUHJvcGVydHlDaGFuZ2VEYXRhID0gZnVuY3Rpb24gKHByb3BlcnR5TmFtZSwgdmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHJldHVybiB7IGV2ZW50TmFtZTogT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCBvYmplY3Q6IHRoaXMsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2VtaXQgPSBmdW5jdGlvbiAoZXZlbnROYW1lcykge1xuICAgICAgICB2YXIgZXZlbnRzID0gZXZlbnROYW1lcy5zcGxpdChcIixcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGV2ZW50XzMgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IGV2ZW50XzMsIG9iamVjdDogdGhpcyB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2dldEV2ZW50TGlzdCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNyZWF0ZUlmTmVlZGVkKSB7XG4gICAgICAgIGlmICghZXZlbnROYW1lKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXZlbnROYW1lIG11c3QgYmUgdmFsaWQgc3RyaW5nLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX29ic2VydmVyc1tldmVudE5hbWVdO1xuICAgICAgICBpZiAoIWxpc3QgJiYgY3JlYXRlSWZOZWVkZWQpIHtcbiAgICAgICAgICAgIGxpc3QgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmVyc1tldmVudE5hbWVdID0gbGlzdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9pbmRleE9mTGlzdGVuZXIgPSBmdW5jdGlvbiAobGlzdCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZW50cnkgPSBsaXN0W2ldO1xuICAgICAgICAgICAgaWYgKHRoaXNBcmcpIHtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuY2FsbGJhY2sgPT09IGNhbGxiYWNrICYmIGVudHJ5LnRoaXNBcmcgPT09IHRoaXNBcmcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LmNhbGxiYWNrID09PSBjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50ID0gXCJwcm9wZXJ0eUNoYW5nZVwiO1xuICAgIHJldHVybiBPYnNlcnZhYmxlO1xufSgpKTtcbmV4cG9ydHMuT2JzZXJ2YWJsZSA9IE9ic2VydmFibGU7XG52YXIgT2JzZXJ2YWJsZUZyb21PYmplY3QgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhPYnNlcnZhYmxlRnJvbU9iamVjdCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlRnJvbU9iamVjdCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9tYXAgPSB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYnNlcnZhYmxlRnJvbU9iamVjdC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcFtuYW1lXTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVGcm9tT2JqZWN0LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHRoaXMuX21hcFtuYW1lXTtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3VmFsdWUgPSBXcmFwcGVkVmFsdWUudW53cmFwKHZhbHVlKTtcbiAgICAgICAgdGhpcy5fbWFwW25hbWVdID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UobmFtZSwgbmV3VmFsdWUsIGN1cnJlbnRWYWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZUZyb21PYmplY3Q7XG59KE9ic2VydmFibGUpKTtcbmZ1bmN0aW9uIGRlZmluZU5ld1Byb3BlcnR5KHRhcmdldCwgcHJvcGVydHlOYW1lKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHlOYW1lLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5fbWFwW3Byb3BlcnR5TmFtZV07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0YXJnZXQuc2V0KHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGFkZFByb3BlcnRpZXNGcm9tT2JqZWN0KG9ic2VydmFibGUsIHNvdXJjZSwgcmVjdXJzaXZlKSB7XG4gICAgaWYgKHJlY3Vyc2l2ZSA9PT0gdm9pZCAwKSB7IHJlY3Vyc2l2ZSA9IGZhbHNlOyB9XG4gICAgT2JqZWN0LmtleXMoc291cmNlKS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHNvdXJjZVtwcm9wXTtcbiAgICAgICAgaWYgKHJlY3Vyc2l2ZVxuICAgICAgICAgICAgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpXG4gICAgICAgICAgICAmJiB2YWx1ZVxuICAgICAgICAgICAgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiXG4gICAgICAgICAgICAmJiAhKHZhbHVlIGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkpIHtcbiAgICAgICAgICAgIHZhbHVlID0gZnJvbU9iamVjdFJlY3Vyc2l2ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVmaW5lTmV3UHJvcGVydHkob2JzZXJ2YWJsZSwgcHJvcCk7XG4gICAgICAgIG9ic2VydmFibGUuc2V0KHByb3AsIHZhbHVlKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGZyb21PYmplY3Qoc291cmNlKSB7XG4gICAgdmFyIG9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZUZyb21PYmplY3QoKTtcbiAgICBhZGRQcm9wZXJ0aWVzRnJvbU9iamVjdChvYnNlcnZhYmxlLCBzb3VyY2UsIGZhbHNlKTtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbn1cbmV4cG9ydHMuZnJvbU9iamVjdCA9IGZyb21PYmplY3Q7XG5mdW5jdGlvbiBmcm9tT2JqZWN0UmVjdXJzaXZlKHNvdXJjZSkge1xuICAgIHZhciBvYnNlcnZhYmxlID0gbmV3IE9ic2VydmFibGVGcm9tT2JqZWN0KCk7XG4gICAgYWRkUHJvcGVydGllc0Zyb21PYmplY3Qob2JzZXJ2YWJsZSwgc291cmNlLCB0cnVlKTtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbn1cbmV4cG9ydHMuZnJvbU9iamVjdFJlY3Vyc2l2ZSA9IGZyb21PYmplY3RSZWN1cnNpdmU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIERvbWFpbkRpc3BhdGNoZXIoZG9tYWluKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChrbGFzcykgeyByZXR1cm4gX19yZWdpc3RlckRvbWFpbkRpc3BhdGNoZXIoZG9tYWluLCBrbGFzcyk7IH07XG59XG5leHBvcnRzLkRvbWFpbkRpc3BhdGNoZXIgPSBEb21haW5EaXNwYXRjaGVyO1xudmFyIEhlYXBEb21haW47XG4oZnVuY3Rpb24gKEhlYXBEb21haW4pIHtcbiAgICB2YXIgSGVhcEZyb250ZW5kID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSGVhcEZyb250ZW5kKCkge1xuICAgICAgICB9XG4gICAgICAgIEhlYXBGcm9udGVuZC5wcm90b3R5cGUuZ2FyYmFnZUNvbGxlY3RlZCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiSGVhcC5nYXJiYWdlQ29sbGVjdGVkXCIsIFwicGFyYW1zXCI6IHsgXCJjb2xsZWN0aW9uXCI6IGNvbGxlY3Rpb24gfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIEhlYXBGcm9udGVuZC5wcm90b3R5cGUudHJhY2tpbmdTdGFydCA9IGZ1bmN0aW9uICh0aW1lc3RhbXAsIHNuYXBzaG90RGF0YSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkhlYXAudHJhY2tpbmdTdGFydFwiLCBcInBhcmFtc1wiOiB7IFwidGltZXN0YW1wXCI6IHRpbWVzdGFtcCwgXCJzbmFwc2hvdERhdGFcIjogc25hcHNob3REYXRhIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBIZWFwRnJvbnRlbmQucHJvdG90eXBlLnRyYWNraW5nQ29tcGxldGUgPSBmdW5jdGlvbiAodGltZXN0YW1wLCBzbmFwc2hvdERhdGEpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJIZWFwLnRyYWNraW5nQ29tcGxldGVcIiwgXCJwYXJhbXNcIjogeyBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwic25hcHNob3REYXRhXCI6IHNuYXBzaG90RGF0YSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEhlYXBGcm9udGVuZDtcbiAgICB9KCkpO1xuICAgIEhlYXBEb21haW4uSGVhcEZyb250ZW5kID0gSGVhcEZyb250ZW5kO1xufSkoSGVhcERvbWFpbiA9IGV4cG9ydHMuSGVhcERvbWFpbiB8fCAoZXhwb3J0cy5IZWFwRG9tYWluID0ge30pKTtcbnZhciBEZWJ1Z2dlckRvbWFpbjtcbihmdW5jdGlvbiAoRGVidWdnZXJEb21haW4pIHtcbiAgICB2YXIgRGVidWdnZXJGcm9udGVuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIERlYnVnZ2VyRnJvbnRlbmQoKSB7XG4gICAgICAgIH1cbiAgICAgICAgRGVidWdnZXJGcm9udGVuZC5wcm90b3R5cGUuZ2xvYmFsT2JqZWN0Q2xlYXJlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJEZWJ1Z2dlci5nbG9iYWxPYmplY3RDbGVhcmVkXCIsIFwicGFyYW1zXCI6IHt9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGVidWdnZXJGcm9udGVuZC5wcm90b3R5cGUuc2NyaXB0UGFyc2VkID0gZnVuY3Rpb24gKHNjcmlwdElkLCB1cmwsIHN0YXJ0TGluZSwgc3RhcnRDb2x1bW4sIGVuZExpbmUsIGVuZENvbHVtbiwgaXNDb250ZW50U2NyaXB0LCBzb3VyY2VVUkwsIHNvdXJjZU1hcFVSTCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRlYnVnZ2VyLnNjcmlwdFBhcnNlZFwiLCBcInBhcmFtc1wiOiB7IFwic2NyaXB0SWRcIjogc2NyaXB0SWQsIFwidXJsXCI6IHVybCwgXCJzdGFydExpbmVcIjogc3RhcnRMaW5lLCBcInN0YXJ0Q29sdW1uXCI6IHN0YXJ0Q29sdW1uLCBcImVuZExpbmVcIjogZW5kTGluZSwgXCJlbmRDb2x1bW5cIjogZW5kQ29sdW1uLCBcImlzQ29udGVudFNjcmlwdFwiOiBpc0NvbnRlbnRTY3JpcHQsIFwic291cmNlVVJMXCI6IHNvdXJjZVVSTCwgXCJzb3VyY2VNYXBVUkxcIjogc291cmNlTWFwVVJMIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBEZWJ1Z2dlckZyb250ZW5kLnByb3RvdHlwZS5zY3JpcHRGYWlsZWRUb1BhcnNlID0gZnVuY3Rpb24gKHVybCwgc2NyaXB0U291cmNlLCBzdGFydExpbmUsIGVycm9yTGluZSwgZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiRGVidWdnZXIuc2NyaXB0RmFpbGVkVG9QYXJzZVwiLCBcInBhcmFtc1wiOiB7IFwidXJsXCI6IHVybCwgXCJzY3JpcHRTb3VyY2VcIjogc2NyaXB0U291cmNlLCBcInN0YXJ0TGluZVwiOiBzdGFydExpbmUsIFwiZXJyb3JMaW5lXCI6IGVycm9yTGluZSwgXCJlcnJvck1lc3NhZ2VcIjogZXJyb3JNZXNzYWdlIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBEZWJ1Z2dlckZyb250ZW5kLnByb3RvdHlwZS5icmVha3BvaW50UmVzb2x2ZWQgPSBmdW5jdGlvbiAoYnJlYWtwb2ludElkLCBsb2NhdGlvbikge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRlYnVnZ2VyLmJyZWFrcG9pbnRSZXNvbHZlZFwiLCBcInBhcmFtc1wiOiB7IFwiYnJlYWtwb2ludElkXCI6IGJyZWFrcG9pbnRJZCwgXCJsb2NhdGlvblwiOiBsb2NhdGlvbiB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGVidWdnZXJGcm9udGVuZC5wcm90b3R5cGUucGF1c2VkID0gZnVuY3Rpb24gKGNhbGxGcmFtZXMsIHJlYXNvbiwgZGF0YSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRlYnVnZ2VyLnBhdXNlZFwiLCBcInBhcmFtc1wiOiB7IFwiY2FsbEZyYW1lc1wiOiBjYWxsRnJhbWVzLCBcInJlYXNvblwiOiByZWFzb24sIFwiZGF0YVwiOiBkYXRhIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBEZWJ1Z2dlckZyb250ZW5kLnByb3RvdHlwZS5yZXN1bWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRlYnVnZ2VyLnJlc3VtZWRcIiwgXCJwYXJhbXNcIjoge30gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBEZWJ1Z2dlckZyb250ZW5kLnByb3RvdHlwZS5kaWRTYW1wbGVQcm9iZSA9IGZ1bmN0aW9uIChzYW1wbGUpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJEZWJ1Z2dlci5kaWRTYW1wbGVQcm9iZVwiLCBcInBhcmFtc1wiOiB7IFwic2FtcGxlXCI6IHNhbXBsZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgRGVidWdnZXJGcm9udGVuZC5wcm90b3R5cGUucGxheUJyZWFrcG9pbnRBY3Rpb25Tb3VuZCA9IGZ1bmN0aW9uIChicmVha3BvaW50QWN0aW9uSWQpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJEZWJ1Z2dlci5wbGF5QnJlYWtwb2ludEFjdGlvblNvdW5kXCIsIFwicGFyYW1zXCI6IHsgXCJicmVha3BvaW50QWN0aW9uSWRcIjogYnJlYWtwb2ludEFjdGlvbklkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRGVidWdnZXJGcm9udGVuZDtcbiAgICB9KCkpO1xuICAgIERlYnVnZ2VyRG9tYWluLkRlYnVnZ2VyRnJvbnRlbmQgPSBEZWJ1Z2dlckZyb250ZW5kO1xufSkoRGVidWdnZXJEb21haW4gPSBleHBvcnRzLkRlYnVnZ2VyRG9tYWluIHx8IChleHBvcnRzLkRlYnVnZ2VyRG9tYWluID0ge30pKTtcbnZhciBSdW50aW1lRG9tYWluO1xuKGZ1bmN0aW9uIChSdW50aW1lRG9tYWluKSB7XG4gICAgdmFyIFJ1bnRpbWVGcm9udGVuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFJ1bnRpbWVGcm9udGVuZCgpIHtcbiAgICAgICAgfVxuICAgICAgICBSdW50aW1lRnJvbnRlbmQucHJvdG90eXBlLmV4ZWN1dGlvbkNvbnRleHRDcmVhdGVkID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJSdW50aW1lLmV4ZWN1dGlvbkNvbnRleHRDcmVhdGVkXCIsIFwicGFyYW1zXCI6IHsgXCJjb250ZXh0XCI6IGNvbnRleHQgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBSdW50aW1lRnJvbnRlbmQ7XG4gICAgfSgpKTtcbiAgICBSdW50aW1lRG9tYWluLlJ1bnRpbWVGcm9udGVuZCA9IFJ1bnRpbWVGcm9udGVuZDtcbn0pKFJ1bnRpbWVEb21haW4gPSBleHBvcnRzLlJ1bnRpbWVEb21haW4gfHwgKGV4cG9ydHMuUnVudGltZURvbWFpbiA9IHt9KSk7XG52YXIgQ29uc29sZURvbWFpbjtcbihmdW5jdGlvbiAoQ29uc29sZURvbWFpbikge1xuICAgIHZhciBDb25zb2xlRnJvbnRlbmQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDb25zb2xlRnJvbnRlbmQoKSB7XG4gICAgICAgIH1cbiAgICAgICAgQ29uc29sZUZyb250ZW5kLnByb3RvdHlwZS5tZXNzYWdlQWRkZWQgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkNvbnNvbGUubWVzc2FnZUFkZGVkXCIsIFwicGFyYW1zXCI6IHsgXCJtZXNzYWdlXCI6IG1lc3NhZ2UgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIENvbnNvbGVGcm9udGVuZC5wcm90b3R5cGUubWVzc2FnZVJlcGVhdENvdW50VXBkYXRlZCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkNvbnNvbGUubWVzc2FnZVJlcGVhdENvdW50VXBkYXRlZFwiLCBcInBhcmFtc1wiOiB7IFwiY291bnRcIjogY291bnQgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIENvbnNvbGVGcm9udGVuZC5wcm90b3R5cGUubWVzc2FnZXNDbGVhcmVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkNvbnNvbGUubWVzc2FnZXNDbGVhcmVkXCIsIFwicGFyYW1zXCI6IHt9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29uc29sZUZyb250ZW5kLnByb3RvdHlwZS5oZWFwU25hcHNob3QgPSBmdW5jdGlvbiAodGltZXN0YW1wLCBzbmFwc2hvdERhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiQ29uc29sZS5oZWFwU25hcHNob3RcIiwgXCJwYXJhbXNcIjogeyBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwic25hcHNob3REYXRhXCI6IHNuYXBzaG90RGF0YSwgXCJ0aXRsZVwiOiB0aXRsZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIENvbnNvbGVGcm9udGVuZDtcbiAgICB9KCkpO1xuICAgIENvbnNvbGVEb21haW4uQ29uc29sZUZyb250ZW5kID0gQ29uc29sZUZyb250ZW5kO1xufSkoQ29uc29sZURvbWFpbiA9IGV4cG9ydHMuQ29uc29sZURvbWFpbiB8fCAoZXhwb3J0cy5Db25zb2xlRG9tYWluID0ge30pKTtcbnZhciBQYWdlRG9tYWluO1xuKGZ1bmN0aW9uIChQYWdlRG9tYWluKSB7XG4gICAgdmFyIFBhZ2VGcm9udGVuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFBhZ2VGcm9udGVuZCgpIHtcbiAgICAgICAgfVxuICAgICAgICBQYWdlRnJvbnRlbmQucHJvdG90eXBlLmRvbUNvbnRlbnRFdmVudEZpcmVkID0gZnVuY3Rpb24gKHRpbWVzdGFtcCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZG9tQ29udGVudEV2ZW50RmlyZWRcIiwgXCJwYXJhbXNcIjogeyBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIFBhZ2VGcm9udGVuZC5wcm90b3R5cGUubG9hZEV2ZW50RmlyZWQgPSBmdW5jdGlvbiAodGltZXN0YW1wKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiUGFnZS5sb2FkRXZlbnRGaXJlZFwiLCBcInBhcmFtc1wiOiB7IFwidGltZXN0YW1wXCI6IHRpbWVzdGFtcCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgUGFnZUZyb250ZW5kLnByb3RvdHlwZS5mcmFtZU5hdmlnYXRlZCA9IGZ1bmN0aW9uIChmcmFtZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZnJhbWVOYXZpZ2F0ZWRcIiwgXCJwYXJhbXNcIjogeyBcImZyYW1lXCI6IGZyYW1lIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBQYWdlRnJvbnRlbmQucHJvdG90eXBlLmZyYW1lRGV0YWNoZWQgPSBmdW5jdGlvbiAoZnJhbWVJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZnJhbWVEZXRhY2hlZFwiLCBcInBhcmFtc1wiOiB7IFwiZnJhbWVJZFwiOiBmcmFtZUlkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBQYWdlRnJvbnRlbmQucHJvdG90eXBlLmZyYW1lU3RhcnRlZExvYWRpbmcgPSBmdW5jdGlvbiAoZnJhbWVJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZnJhbWVTdGFydGVkTG9hZGluZ1wiLCBcInBhcmFtc1wiOiB7IFwiZnJhbWVJZFwiOiBmcmFtZUlkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBQYWdlRnJvbnRlbmQucHJvdG90eXBlLmZyYW1lU3RvcHBlZExvYWRpbmcgPSBmdW5jdGlvbiAoZnJhbWVJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZnJhbWVTdG9wcGVkTG9hZGluZ1wiLCBcInBhcmFtc1wiOiB7IFwiZnJhbWVJZFwiOiBmcmFtZUlkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBQYWdlRnJvbnRlbmQucHJvdG90eXBlLmZyYW1lU2NoZWR1bGVkTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChmcmFtZUlkLCBkZWxheSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuZnJhbWVTY2hlZHVsZWROYXZpZ2F0aW9uXCIsIFwicGFyYW1zXCI6IHsgXCJmcmFtZUlkXCI6IGZyYW1lSWQsIFwiZGVsYXlcIjogZGVsYXkgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIFBhZ2VGcm9udGVuZC5wcm90b3R5cGUuZnJhbWVDbGVhcmVkU2NoZWR1bGVkTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChmcmFtZUlkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiUGFnZS5mcmFtZUNsZWFyZWRTY2hlZHVsZWROYXZpZ2F0aW9uXCIsIFwicGFyYW1zXCI6IHsgXCJmcmFtZUlkXCI6IGZyYW1lSWQgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIFBhZ2VGcm9udGVuZC5wcm90b3R5cGUuamF2YXNjcmlwdERpYWxvZ09wZW5pbmcgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuamF2YXNjcmlwdERpYWxvZ09wZW5pbmdcIiwgXCJwYXJhbXNcIjogeyBcIm1lc3NhZ2VcIjogbWVzc2FnZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgUGFnZUZyb250ZW5kLnByb3RvdHlwZS5qYXZhc2NyaXB0RGlhbG9nQ2xvc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIlBhZ2UuamF2YXNjcmlwdERpYWxvZ0Nsb3NlZFwiLCBcInBhcmFtc1wiOiB7fSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIFBhZ2VGcm9udGVuZC5wcm90b3R5cGUuc2NyaXB0c0VuYWJsZWQgPSBmdW5jdGlvbiAoaXNFbmFibGVkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiUGFnZS5zY3JpcHRzRW5hYmxlZFwiLCBcInBhcmFtc1wiOiB7IFwiaXNFbmFibGVkXCI6IGlzRW5hYmxlZCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFBhZ2VGcm9udGVuZDtcbiAgICB9KCkpO1xuICAgIFBhZ2VEb21haW4uUGFnZUZyb250ZW5kID0gUGFnZUZyb250ZW5kO1xufSkoUGFnZURvbWFpbiA9IGV4cG9ydHMuUGFnZURvbWFpbiB8fCAoZXhwb3J0cy5QYWdlRG9tYWluID0ge30pKTtcbnZhciBOZXR3b3JrRG9tYWluO1xuKGZ1bmN0aW9uIChOZXR3b3JrRG9tYWluKSB7XG4gICAgdmFyIE5ldHdvcmtGcm9udGVuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIE5ldHdvcmtGcm9udGVuZCgpIHtcbiAgICAgICAgfVxuICAgICAgICBOZXR3b3JrRnJvbnRlbmQucHJvdG90eXBlLnJlcXVlc3RXaWxsQmVTZW50ID0gZnVuY3Rpb24gKHJlcXVlc3RJZCwgZnJhbWVJZCwgbG9hZGVySWQsIGRvY3VtZW50VVJMLCByZXF1ZXN0LCB0aW1lc3RhbXAsIGluaXRpYXRvciwgcmVkaXJlY3RSZXNwb25zZSwgdHlwZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIk5ldHdvcmsucmVxdWVzdFdpbGxCZVNlbnRcIiwgXCJwYXJhbXNcIjogeyBcInJlcXVlc3RJZFwiOiByZXF1ZXN0SWQsIFwiZnJhbWVJZFwiOiBmcmFtZUlkLCBcImxvYWRlcklkXCI6IGxvYWRlcklkLCBcImRvY3VtZW50VVJMXCI6IGRvY3VtZW50VVJMLCBcInJlcXVlc3RcIjogcmVxdWVzdCwgXCJ0aW1lc3RhbXBcIjogdGltZXN0YW1wLCBcImluaXRpYXRvclwiOiBpbml0aWF0b3IsIFwicmVkaXJlY3RSZXNwb25zZVwiOiByZWRpcmVjdFJlc3BvbnNlLCBcInR5cGVcIjogdHlwZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS5yZXF1ZXN0U2VydmVkRnJvbUNhY2hlID0gZnVuY3Rpb24gKHJlcXVlc3RJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIk5ldHdvcmsucmVxdWVzdFNlcnZlZEZyb21DYWNoZVwiLCBcInBhcmFtc1wiOiB7IFwicmVxdWVzdElkXCI6IHJlcXVlc3RJZCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS5yZXNwb25zZVJlY2VpdmVkID0gZnVuY3Rpb24gKHJlcXVlc3RJZCwgZnJhbWVJZCwgbG9hZGVySWQsIHRpbWVzdGFtcCwgdHlwZSwgcmVzcG9uc2UpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLnJlc3BvbnNlUmVjZWl2ZWRcIiwgXCJwYXJhbXNcIjogeyBcInJlcXVlc3RJZFwiOiByZXF1ZXN0SWQsIFwiZnJhbWVJZFwiOiBmcmFtZUlkLCBcImxvYWRlcklkXCI6IGxvYWRlcklkLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwidHlwZVwiOiB0eXBlLCBcInJlc3BvbnNlXCI6IHJlc3BvbnNlIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBOZXR3b3JrRnJvbnRlbmQucHJvdG90eXBlLmRhdGFSZWNlaXZlZCA9IGZ1bmN0aW9uIChyZXF1ZXN0SWQsIHRpbWVzdGFtcCwgZGF0YUxlbmd0aCwgZW5jb2RlZERhdGFMZW5ndGgpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLmRhdGFSZWNlaXZlZFwiLCBcInBhcmFtc1wiOiB7IFwicmVxdWVzdElkXCI6IHJlcXVlc3RJZCwgXCJ0aW1lc3RhbXBcIjogdGltZXN0YW1wLCBcImRhdGFMZW5ndGhcIjogZGF0YUxlbmd0aCwgXCJlbmNvZGVkRGF0YUxlbmd0aFwiOiBlbmNvZGVkRGF0YUxlbmd0aCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS5sb2FkaW5nRmluaXNoZWQgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB0aW1lc3RhbXAsIHNvdXJjZU1hcFVSTCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIk5ldHdvcmsubG9hZGluZ0ZpbmlzaGVkXCIsIFwicGFyYW1zXCI6IHsgXCJyZXF1ZXN0SWRcIjogcmVxdWVzdElkLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwic291cmNlTWFwVVJMXCI6IHNvdXJjZU1hcFVSTCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS5sb2FkaW5nRmFpbGVkID0gZnVuY3Rpb24gKHJlcXVlc3RJZCwgdGltZXN0YW1wLCBlcnJvclRleHQsIGNhbmNlbGVkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiTmV0d29yay5sb2FkaW5nRmFpbGVkXCIsIFwicGFyYW1zXCI6IHsgXCJyZXF1ZXN0SWRcIjogcmVxdWVzdElkLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwiZXJyb3JUZXh0XCI6IGVycm9yVGV4dCwgXCJjYW5jZWxlZFwiOiBjYW5jZWxlZCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS5yZXF1ZXN0U2VydmVkRnJvbU1lbW9yeUNhY2hlID0gZnVuY3Rpb24gKHJlcXVlc3RJZCwgZnJhbWVJZCwgbG9hZGVySWQsIGRvY3VtZW50VVJMLCB0aW1lc3RhbXAsIGluaXRpYXRvciwgcmVzb3VyY2UpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLnJlcXVlc3RTZXJ2ZWRGcm9tTWVtb3J5Q2FjaGVcIiwgXCJwYXJhbXNcIjogeyBcInJlcXVlc3RJZFwiOiByZXF1ZXN0SWQsIFwiZnJhbWVJZFwiOiBmcmFtZUlkLCBcImxvYWRlcklkXCI6IGxvYWRlcklkLCBcImRvY3VtZW50VVJMXCI6IGRvY3VtZW50VVJMLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwiaW5pdGlhdG9yXCI6IGluaXRpYXRvciwgXCJyZXNvdXJjZVwiOiByZXNvdXJjZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS53ZWJTb2NrZXRXaWxsU2VuZEhhbmRzaGFrZVJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB0aW1lc3RhbXAsIHJlcXVlc3QpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLndlYlNvY2tldFdpbGxTZW5kSGFuZHNoYWtlUmVxdWVzdFwiLCBcInBhcmFtc1wiOiB7IFwicmVxdWVzdElkXCI6IHJlcXVlc3RJZCwgXCJ0aW1lc3RhbXBcIjogdGltZXN0YW1wLCBcInJlcXVlc3RcIjogcmVxdWVzdCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS53ZWJTb2NrZXRIYW5kc2hha2VSZXNwb25zZVJlY2VpdmVkID0gZnVuY3Rpb24gKHJlcXVlc3RJZCwgdGltZXN0YW1wLCByZXNwb25zZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIk5ldHdvcmsud2ViU29ja2V0SGFuZHNoYWtlUmVzcG9uc2VSZWNlaXZlZFwiLCBcInBhcmFtc1wiOiB7IFwicmVxdWVzdElkXCI6IHJlcXVlc3RJZCwgXCJ0aW1lc3RhbXBcIjogdGltZXN0YW1wLCBcInJlc3BvbnNlXCI6IHJlc3BvbnNlIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBOZXR3b3JrRnJvbnRlbmQucHJvdG90eXBlLndlYlNvY2tldENyZWF0ZWQgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB1cmwpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLndlYlNvY2tldENyZWF0ZWRcIiwgXCJwYXJhbXNcIjogeyBcInJlcXVlc3RJZFwiOiByZXF1ZXN0SWQsIFwidXJsXCI6IHVybCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS53ZWJTb2NrZXRDbG9zZWQgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB0aW1lc3RhbXApIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJOZXR3b3JrLndlYlNvY2tldENsb3NlZFwiLCBcInBhcmFtc1wiOiB7IFwicmVxdWVzdElkXCI6IHJlcXVlc3RJZCwgXCJ0aW1lc3RhbXBcIjogdGltZXN0YW1wIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBOZXR3b3JrRnJvbnRlbmQucHJvdG90eXBlLndlYlNvY2tldEZyYW1lUmVjZWl2ZWQgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB0aW1lc3RhbXAsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiTmV0d29yay53ZWJTb2NrZXRGcmFtZVJlY2VpdmVkXCIsIFwicGFyYW1zXCI6IHsgXCJyZXF1ZXN0SWRcIjogcmVxdWVzdElkLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwicmVzcG9uc2VcIjogcmVzcG9uc2UgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIE5ldHdvcmtGcm9udGVuZC5wcm90b3R5cGUud2ViU29ja2V0RnJhbWVFcnJvciA9IGZ1bmN0aW9uIChyZXF1ZXN0SWQsIHRpbWVzdGFtcCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiTmV0d29yay53ZWJTb2NrZXRGcmFtZUVycm9yXCIsIFwicGFyYW1zXCI6IHsgXCJyZXF1ZXN0SWRcIjogcmVxdWVzdElkLCBcInRpbWVzdGFtcFwiOiB0aW1lc3RhbXAsIFwiZXJyb3JNZXNzYWdlXCI6IGVycm9yTWVzc2FnZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgTmV0d29ya0Zyb250ZW5kLnByb3RvdHlwZS53ZWJTb2NrZXRGcmFtZVNlbnQgPSBmdW5jdGlvbiAocmVxdWVzdElkLCB0aW1lc3RhbXAsIHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiTmV0d29yay53ZWJTb2NrZXRGcmFtZVNlbnRcIiwgXCJwYXJhbXNcIjogeyBcInJlcXVlc3RJZFwiOiByZXF1ZXN0SWQsIFwidGltZXN0YW1wXCI6IHRpbWVzdGFtcCwgXCJyZXNwb25zZVwiOiByZXNwb25zZSB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE5ldHdvcmtGcm9udGVuZDtcbiAgICB9KCkpO1xuICAgIE5ldHdvcmtEb21haW4uTmV0d29ya0Zyb250ZW5kID0gTmV0d29ya0Zyb250ZW5kO1xufSkoTmV0d29ya0RvbWFpbiA9IGV4cG9ydHMuTmV0d29ya0RvbWFpbiB8fCAoZXhwb3J0cy5OZXR3b3JrRG9tYWluID0ge30pKTtcbnZhciBET01Eb21haW47XG4oZnVuY3Rpb24gKERPTURvbWFpbikge1xuICAgIHZhciBET01Gcm9udGVuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIERPTUZyb250ZW5kKCkge1xuICAgICAgICB9XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5kb2N1bWVudFVwZGF0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiRE9NLmRvY3VtZW50VXBkYXRlZFwiLCBcInBhcmFtc1wiOiB7fSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5zZXRDaGlsZE5vZGVzID0gZnVuY3Rpb24gKHBhcmVudElkLCBub2Rlcykge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRPTS5zZXRDaGlsZE5vZGVzXCIsIFwicGFyYW1zXCI6IHsgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCwgXCJub2Rlc1wiOiBub2RlcyB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgRE9NRnJvbnRlbmQucHJvdG90eXBlLmF0dHJpYnV0ZU1vZGlmaWVkID0gZnVuY3Rpb24gKG5vZGVJZCwgbmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJET00uYXR0cmlidXRlTW9kaWZpZWRcIiwgXCJwYXJhbXNcIjogeyBcIm5vZGVJZFwiOiBub2RlSWQsIFwibmFtZVwiOiBuYW1lLCBcInZhbHVlXCI6IHZhbHVlIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBET01Gcm9udGVuZC5wcm90b3R5cGUuYXR0cmlidXRlUmVtb3ZlZCA9IGZ1bmN0aW9uIChub2RlSWQsIG5hbWUpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJET00uYXR0cmlidXRlUmVtb3ZlZFwiLCBcInBhcmFtc1wiOiB7IFwibm9kZUlkXCI6IG5vZGVJZCwgXCJuYW1lXCI6IG5hbWUgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5pbmxpbmVTdHlsZUludmFsaWRhdGVkID0gZnVuY3Rpb24gKG5vZGVJZHMpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJET00uaW5saW5lU3R5bGVJbnZhbGlkYXRlZFwiLCBcInBhcmFtc1wiOiB7IFwibm9kZUlkc1wiOiBub2RlSWRzIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBET01Gcm9udGVuZC5wcm90b3R5cGUuY2hhcmFjdGVyRGF0YU1vZGlmaWVkID0gZnVuY3Rpb24gKG5vZGVJZCwgY2hhcmFjdGVyRGF0YSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRPTS5jaGFyYWN0ZXJEYXRhTW9kaWZpZWRcIiwgXCJwYXJhbXNcIjogeyBcIm5vZGVJZFwiOiBub2RlSWQsIFwiY2hhcmFjdGVyRGF0YVwiOiBjaGFyYWN0ZXJEYXRhIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBET01Gcm9udGVuZC5wcm90b3R5cGUuY2hpbGROb2RlQ291bnRVcGRhdGVkID0gZnVuY3Rpb24gKG5vZGVJZCwgY2hpbGROb2RlQ291bnQpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJET00uY2hpbGROb2RlQ291bnRVcGRhdGVkXCIsIFwicGFyYW1zXCI6IHsgXCJub2RlSWRcIjogbm9kZUlkLCBcImNoaWxkTm9kZUNvdW50XCI6IGNoaWxkTm9kZUNvdW50IH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBET01Gcm9udGVuZC5wcm90b3R5cGUuY2hpbGROb2RlSW5zZXJ0ZWQgPSBmdW5jdGlvbiAocGFyZW50Tm9kZUlkLCBwcmV2aW91c05vZGVJZCwgbm9kZSkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRPTS5jaGlsZE5vZGVJbnNlcnRlZFwiLCBcInBhcmFtc1wiOiB7IFwicGFyZW50Tm9kZUlkXCI6IHBhcmVudE5vZGVJZCwgXCJwcmV2aW91c05vZGVJZFwiOiBwcmV2aW91c05vZGVJZCwgXCJub2RlXCI6IG5vZGUgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5jaGlsZE5vZGVSZW1vdmVkID0gZnVuY3Rpb24gKHBhcmVudE5vZGVJZCwgbm9kZUlkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiRE9NLmNoaWxkTm9kZVJlbW92ZWRcIiwgXCJwYXJhbXNcIjogeyBcInBhcmVudE5vZGVJZFwiOiBwYXJlbnROb2RlSWQsIFwibm9kZUlkXCI6IG5vZGVJZCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgRE9NRnJvbnRlbmQucHJvdG90eXBlLnNoYWRvd1Jvb3RQdXNoZWQgPSBmdW5jdGlvbiAoaG9zdElkLCByb290KSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiRE9NLnNoYWRvd1Jvb3RQdXNoZWRcIiwgXCJwYXJhbXNcIjogeyBcImhvc3RJZFwiOiBob3N0SWQsIFwicm9vdFwiOiByb290IH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBET01Gcm9udGVuZC5wcm90b3R5cGUuc2hhZG93Um9vdFBvcHBlZCA9IGZ1bmN0aW9uIChob3N0SWQsIHJvb3RJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkRPTS5zaGFkb3dSb290UG9wcGVkXCIsIFwicGFyYW1zXCI6IHsgXCJob3N0SWRcIjogaG9zdElkLCBcInJvb3RJZFwiOiByb290SWQgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5wc2V1ZG9FbGVtZW50QWRkZWQgPSBmdW5jdGlvbiAocGFyZW50SWQsIHBzZXVkb0VsZW1lbnQpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJET00ucHNldWRvRWxlbWVudEFkZGVkXCIsIFwicGFyYW1zXCI6IHsgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCwgXCJwc2V1ZG9FbGVtZW50XCI6IHBzZXVkb0VsZW1lbnQgfSB9KSk7XG4gICAgICAgIH07XG4gICAgICAgIERPTUZyb250ZW5kLnByb3RvdHlwZS5wc2V1ZG9FbGVtZW50UmVtb3ZlZCA9IGZ1bmN0aW9uIChwYXJlbnRJZCwgcHNldWRvRWxlbWVudElkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiRE9NLnBzZXVkb0VsZW1lbnRSZW1vdmVkXCIsIFwicGFyYW1zXCI6IHsgXCJwYXJlbnRJZFwiOiBwYXJlbnRJZCwgXCJwc2V1ZG9FbGVtZW50SWRcIjogcHNldWRvRWxlbWVudElkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRE9NRnJvbnRlbmQ7XG4gICAgfSgpKTtcbiAgICBET01Eb21haW4uRE9NRnJvbnRlbmQgPSBET01Gcm9udGVuZDtcbn0pKERPTURvbWFpbiA9IGV4cG9ydHMuRE9NRG9tYWluIHx8IChleHBvcnRzLkRPTURvbWFpbiA9IHt9KSk7XG52YXIgQ1NTRG9tYWluO1xuKGZ1bmN0aW9uIChDU1NEb21haW4pIHtcbiAgICB2YXIgQ1NTRnJvbnRlbmQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDU1NGcm9udGVuZCgpIHtcbiAgICAgICAgfVxuICAgICAgICBDU1NGcm9udGVuZC5wcm90b3R5cGUubWVkaWFRdWVyeVJlc3VsdENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiQ1NTLm1lZGlhUXVlcnlSZXN1bHRDaGFuZ2VkXCIsIFwicGFyYW1zXCI6IHt9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ1NTRnJvbnRlbmQucHJvdG90eXBlLmZvbnRzVXBkYXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJDU1MuZm9udHNVcGRhdGVkXCIsIFwicGFyYW1zXCI6IHt9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ1NTRnJvbnRlbmQucHJvdG90eXBlLnN0eWxlU2hlZXRDaGFuZ2VkID0gZnVuY3Rpb24gKHN0eWxlU2hlZXRJZCkge1xuICAgICAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBcIm1ldGhvZFwiOiBcIkNTUy5zdHlsZVNoZWV0Q2hhbmdlZFwiLCBcInBhcmFtc1wiOiB7IFwic3R5bGVTaGVldElkXCI6IHN0eWxlU2hlZXRJZCB9IH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ1NTRnJvbnRlbmQucHJvdG90eXBlLnN0eWxlU2hlZXRBZGRlZCA9IGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJDU1Muc3R5bGVTaGVldEFkZGVkXCIsIFwicGFyYW1zXCI6IHsgXCJoZWFkZXJcIjogaGVhZGVyIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBDU1NGcm9udGVuZC5wcm90b3R5cGUuc3R5bGVTaGVldFJlbW92ZWQgPSBmdW5jdGlvbiAoc3R5bGVTaGVldElkKSB7XG4gICAgICAgICAgICBfX2luc3BlY3RvclNlbmRFdmVudChKU09OLnN0cmluZ2lmeSh7IFwibWV0aG9kXCI6IFwiQ1NTLnN0eWxlU2hlZXRSZW1vdmVkXCIsIFwicGFyYW1zXCI6IHsgXCJzdHlsZVNoZWV0SWRcIjogc3R5bGVTaGVldElkIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICBDU1NGcm9udGVuZC5wcm90b3R5cGUubGF5b3V0RWRpdG9yQ2hhbmdlID0gZnVuY3Rpb24gKHN0eWxlU2hlZXRJZCwgY2hhbmdlUmFuZ2UpIHtcbiAgICAgICAgICAgIF9faW5zcGVjdG9yU2VuZEV2ZW50KEpTT04uc3RyaW5naWZ5KHsgXCJtZXRob2RcIjogXCJDU1MubGF5b3V0RWRpdG9yQ2hhbmdlXCIsIFwicGFyYW1zXCI6IHsgXCJzdHlsZVNoZWV0SWRcIjogc3R5bGVTaGVldElkLCBcImNoYW5nZVJhbmdlXCI6IGNoYW5nZVJhbmdlIH0gfSkpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ1NTRnJvbnRlbmQ7XG4gICAgfSgpKTtcbiAgICBDU1NEb21haW4uQ1NTRnJvbnRlbmQgPSBDU1NGcm9udGVuZDtcbn0pKENTU0RvbWFpbiA9IGV4cG9ydHMuQ1NTRG9tYWluIHx8IChleHBvcnRzLkNTU0RvbWFpbiA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbnNwZWN0b3JCYWNrZW5kQ29tbWFuZHMuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBuZXR3b3JrO1xuZnVuY3Rpb24gZ2V0TmV0d29yaygpIHtcbiAgICByZXR1cm4gbmV0d29yaztcbn1cbmV4cG9ydHMuZ2V0TmV0d29yayA9IGdldE5ldHdvcms7XG5mdW5jdGlvbiBzZXROZXR3b3JrKG5ld05ldHdvcmspIHtcbiAgICBuZXR3b3JrID0gbmV3TmV0d29yaztcbn1cbmV4cG9ydHMuc2V0TmV0d29yayA9IHNldE5ldHdvcms7XG52YXIgZG9tO1xuZnVuY3Rpb24gZ2V0RE9NKCkge1xuICAgIHJldHVybiBkb207XG59XG5leHBvcnRzLmdldERPTSA9IGdldERPTTtcbmZ1bmN0aW9uIHNldERPTShuZXdET00pIHtcbiAgICBkb20gPSBuZXdET007XG59XG5leHBvcnRzLnNldERPTSA9IHNldERPTTtcbnZhciBjc3M7XG5mdW5jdGlvbiBnZXRDU1MoKSB7XG4gICAgcmV0dXJuIGNzcztcbn1cbmV4cG9ydHMuZ2V0Q1NTID0gZ2V0Q1NTO1xuZnVuY3Rpb24gc2V0Q1NTKG5ld0NTUykge1xuICAgIGNzcyA9IG5ld0NTUztcbn1cbmV4cG9ydHMuc2V0Q1NTID0gc2V0Q1NTO1xudmFyIE5ldHdvcmtBZ2VudDtcbihmdW5jdGlvbiAoTmV0d29ya0FnZW50KSB7XG4gICAgZnVuY3Rpb24gcmVzcG9uc2VSZWNlaXZlZChyZXF1ZXN0SWQsIHJlc3VsdCwgaGVhZGVycykge1xuICAgICAgICB2YXIgcmVxdWVzdElkU3RyID0gcmVxdWVzdElkLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciBtaW1lVHlwZSA9IGhlYWRlcnNbXCJDb250ZW50LVR5cGVcIl0gfHwgaGVhZGVyc1tcImNvbnRlbnQtdHlwZVwiXSB8fCBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiO1xuICAgICAgICB2YXIgY29udGVudExlbmd0aEhlYWRlciA9IGhlYWRlcnNbXCJDb250ZW50LUxlbmd0aFwiXSB8fCBoZWFkZXJzW1wiY29udGVudC1sZW5ndGhcIl07XG4gICAgICAgIHZhciBjb250ZW50TGVuZ3RoID0gcGFyc2VJbnQoY29udGVudExlbmd0aEhlYWRlciwgMTApO1xuICAgICAgICBpZiAoaXNOYU4oY29udGVudExlbmd0aCkpIHtcbiAgICAgICAgICAgIGNvbnRlbnRMZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXNwb25zZSA9IHtcbiAgICAgICAgICAgIHVybDogcmVzdWx0LnVybCB8fCBcIlwiLFxuICAgICAgICAgICAgc3RhdHVzOiByZXN1bHQuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlc3VsdC5zdGF0dXNUZXh0IHx8IFwiXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgICAgICAgbWltZVR5cGU6IG1pbWVUeXBlLFxuICAgICAgICAgICAgZnJvbURpc2tDYWNoZTogZmFsc2UsXG4gICAgICAgICAgICBjb25uZWN0aW9uUmV1c2VkOiB0cnVlLFxuICAgICAgICAgICAgY29ubmVjdGlvbklkOiAwLFxuICAgICAgICAgICAgZW5jb2RlZERhdGFMZW5ndGg6IGNvbnRlbnRMZW5ndGgsXG4gICAgICAgICAgICBzZWN1cml0eVN0YXRlOiBcImluZm9cIlxuICAgICAgICB9O1xuICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0ge1xuICAgICAgICAgICAgcmVxdWVzdElkOiByZXF1ZXN0SWRTdHIsXG4gICAgICAgICAgICB0eXBlOiBtaW1lVHlwZVRvVHlwZShyZXNwb25zZS5taW1lVHlwZSksXG4gICAgICAgICAgICByZXNwb25zZTogcmVzcG9uc2UsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IGdldFRpbWVTdGFtcCgpXG4gICAgICAgIH07XG4gICAgICAgIGdsb2JhbC5fX2luc3BlY3Rvci5yZXNwb25zZVJlY2VpdmVkKHJlc3BvbnNlRGF0YSk7XG4gICAgICAgIGdsb2JhbC5fX2luc3BlY3Rvci5sb2FkaW5nRmluaXNoZWQoe1xuICAgICAgICAgICAgcmVxdWVzdElkOiByZXF1ZXN0SWRTdHIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IGdldFRpbWVTdGFtcCgpLFxuICAgICAgICAgICAgZW5jb2RlZERhdGFMZW5ndGg6IGNvbnRlbnRMZW5ndGhcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBoYXNUZXh0Q29udGVudCA9IHJlc3BvbnNlRGF0YS50eXBlID09PSBcIkRvY3VtZW50XCIgfHwgcmVzcG9uc2VEYXRhLnR5cGUgPT09IFwiU2NyaXB0XCI7XG4gICAgICAgIHZhciBkYXRhO1xuICAgICAgICBpZiAoIWhhc1RleHRDb250ZW50KSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2VEYXRhLnR5cGUgPT09IFwiSW1hZ2VcIikge1xuICAgICAgICAgICAgICAgIHZhciBiaXRtYXAgPSByZXN1bHQucmVzcG9uc2VBc0ltYWdlO1xuICAgICAgICAgICAgICAgIGlmIChiaXRtYXApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dHB1dFN0cmVhbSA9IG5ldyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSgpO1xuICAgICAgICAgICAgICAgICAgICBiaXRtYXAuY29tcHJlc3MoYW5kcm9pZC5ncmFwaGljcy5CaXRtYXAuQ29tcHJlc3NGb3JtYXQuUE5HLCAxMDAsIG91dHB1dFN0cmVhbSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXNlNjRJbWFnZSA9IGFuZHJvaWQudXRpbC5CYXNlNjQuZW5jb2RlVG9TdHJpbmcob3V0cHV0U3RyZWFtLnRvQnl0ZUFycmF5KCksIGFuZHJvaWQudXRpbC5CYXNlNjQuREVGQVVMVCk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBiYXNlNjRJbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYXRhID0gcmVzdWx0LnJlc3BvbnNlQXNTdHJpbmc7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN1Y2Nlc3NmdWxSZXF1ZXN0RGF0YSA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkU3RyLFxuICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgIGhhc1RleHRDb250ZW50OiBoYXNUZXh0Q29udGVudFxuICAgICAgICB9O1xuICAgICAgICBnbG9iYWwuX19pbnNwZWN0b3IuZGF0YUZvclJlcXVlc3RJZChzdWNjZXNzZnVsUmVxdWVzdERhdGEpO1xuICAgIH1cbiAgICBOZXR3b3JrQWdlbnQucmVzcG9uc2VSZWNlaXZlZCA9IHJlc3BvbnNlUmVjZWl2ZWQ7XG4gICAgZnVuY3Rpb24gcmVxdWVzdFdpbGxCZVNlbnQocmVxdWVzdElkLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciByZXF1ZXN0ID0ge1xuICAgICAgICAgICAgdXJsOiBvcHRpb25zLnVybCxcbiAgICAgICAgICAgIG1ldGhvZDogb3B0aW9ucy5tZXRob2QsXG4gICAgICAgICAgICBoZWFkZXJzOiBvcHRpb25zLmhlYWRlcnMgfHwge30sXG4gICAgICAgICAgICBwb3N0RGF0YTogb3B0aW9ucy5jb250ZW50ID8gb3B0aW9ucy5jb250ZW50LnRvU3RyaW5nKCkgOiBcIlwiLFxuICAgICAgICAgICAgaW5pdGlhbFByaW9yaXR5OiBcIk1lZGl1bVwiLFxuICAgICAgICAgICAgcmVmZXJyZXJQb2xpY3k6IFwibm8tcmVmZXJyZXItd2hlbi1kb3duZ3JhZGVcIlxuICAgICAgICB9O1xuICAgICAgICB2YXIgcmVxdWVzdERhdGEgPSB7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZC50b1N0cmluZygpLFxuICAgICAgICAgICAgdXJsOiByZXF1ZXN0LnVybCxcbiAgICAgICAgICAgIHJlcXVlc3Q6IHJlcXVlc3QsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IGdldFRpbWVTdGFtcCgpLFxuICAgICAgICAgICAgdHlwZTogXCJEb2N1bWVudFwiLFxuICAgICAgICAgICAgd2FsbFRpbWU6IDBcbiAgICAgICAgfTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLnJlcXVlc3RXaWxsQmVTZW50KHJlcXVlc3REYXRhKTtcbiAgICB9XG4gICAgTmV0d29ya0FnZW50LnJlcXVlc3RXaWxsQmVTZW50ID0gcmVxdWVzdFdpbGxCZVNlbnQ7XG4gICAgZnVuY3Rpb24gZ2V0VGltZVN0YW1wKCkge1xuICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHJldHVybiBNYXRoLnJvdW5kKGQuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG1pbWVUeXBlVG9UeXBlKG1pbWVUeXBlKSB7XG4gICAgICAgIHZhciB0eXBlID0gXCJEb2N1bWVudFwiO1xuICAgICAgICBpZiAobWltZVR5cGUpIHtcbiAgICAgICAgICAgIGlmIChtaW1lVHlwZS5pbmRleE9mKFwiaW1hZ2VcIikgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gXCJJbWFnZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobWltZVR5cGUuaW5kZXhPZihcImphdmFzY3JpcHRcIikgIT09IC0xIHx8IG1pbWVUeXBlLmluZGV4T2YoXCJqc29uXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBcIlNjcmlwdFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgIH1cbn0pKE5ldHdvcmtBZ2VudCA9IGV4cG9ydHMuTmV0d29ya0FnZW50IHx8IChleHBvcnRzLk5ldHdvcmtBZ2VudCA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWJ1Z2dlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZG9tX25vZGVfMSA9IHJlcXVpcmUoXCIuL2RvbS1ub2RlXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgZnJhbWVUb3Btb3N0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uL3VpL2ZyYW1lXCIpLnRvcG1vc3QoKTsgfTtcbnZhciB1bnNldFZhbHVlO1xuZnVuY3Rpb24gdW5zZXRWaWV3VmFsdWUodmlldywgbmFtZSkge1xuICAgIGlmICghdW5zZXRWYWx1ZSkge1xuICAgICAgICB1bnNldFZhbHVlID0gcmVxdWlyZShcIi4uL3VpL2NvcmUvcHJvcGVydGllc1wiKS51bnNldFZhbHVlO1xuICAgIH1cbiAgICB2aWV3W25hbWVdID0gdW5zZXRWYWx1ZTtcbn1cbmZ1bmN0aW9uIGdldFZpZXdCeUlkKG5vZGVJZCkge1xuICAgIHZhciBub2RlID0gZG9tX25vZGVfMS5nZXROb2RlQnlJZChub2RlSWQpO1xuICAgIHZhciB2aWV3O1xuICAgIGlmIChub2RlKSB7XG4gICAgICAgIHZpZXcgPSBub2RlLnZpZXdSZWYuZ2V0KCk7XG4gICAgfVxuICAgIHJldHVybiB2aWV3O1xufVxuZnVuY3Rpb24gZ2V0RG9jdW1lbnQoKSB7XG4gICAgdmFyIHRvcE1vc3RGcmFtZSA9IGZyYW1lVG9wbW9zdCgpO1xuICAgIGlmICghdG9wTW9zdEZyYW1lKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIHRvcE1vc3RGcmFtZS5lbnN1cmVEb21Ob2RlKCk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1IgaW4gZ2V0RG9jdW1lbnQoKTogXCIgKyBlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRvcE1vc3RGcmFtZS5kb21Ob2RlLnRvT2JqZWN0KCk7XG59XG5leHBvcnRzLmdldERvY3VtZW50ID0gZ2V0RG9jdW1lbnQ7XG5mdW5jdGlvbiBnZXRDb21wdXRlZFN0eWxlc0Zvck5vZGUobm9kZUlkKSB7XG4gICAgdmFyIHZpZXcgPSBnZXRWaWV3QnlJZChub2RlSWQpO1xuICAgIGlmICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2aWV3LmRvbU5vZGUuZ2V0Q29tcHV0ZWRQcm9wZXJ0aWVzKCk7XG4gICAgfVxuICAgIHJldHVybiBbXTtcbn1cbmV4cG9ydHMuZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlID0gZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlO1xuZXhwb3J0cy5yZW1vdmVOb2RlID0gdXRpbHNfMS5tYWluVGhyZWFkaWZ5KGZ1bmN0aW9uIHJlbW92ZU5vZGUobm9kZUlkKSB7XG4gICAgdmFyIHZpZXcgPSBnZXRWaWV3QnlJZChub2RlSWQpO1xuICAgIGlmICh2aWV3KSB7XG4gICAgICAgIHZhciBwYXJlbnRfMSA9IHZpZXcucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50XzEucmVtb3ZlQ2hpbGQpIHtcbiAgICAgICAgICAgIHBhcmVudF8xLnJlbW92ZUNoaWxkKHZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcmVudF8xLmNvbnRlbnQgPT09IHZpZXcpIHtcbiAgICAgICAgICAgIHBhcmVudF8xLmNvbnRlbnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDYW4ndCByZW1vdmUgY2hpbGQgZnJvbSBcIiArIHBhcmVudF8xKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZXhwb3J0cy5zZXRBdHRyaWJ1dGVBc1RleHQgPSB1dGlsc18xLm1haW5UaHJlYWRpZnkoZnVuY3Rpb24gc2V0QXR0cmlidXRlQXNUZXh0KG5vZGVJZCwgdGV4dCwgbmFtZSkge1xuICAgIHZhciB2aWV3ID0gZ2V0Vmlld0J5SWQobm9kZUlkKTtcbiAgICBpZiAodmlldykge1xuICAgICAgICB2YXIgaGFzT3JpZ2luYWxBdHRyaWJ1dGUgPSAhIW5hbWUudHJpbSgpO1xuICAgICAgICBpZiAodGV4dCkge1xuICAgICAgICAgICAgdmFyIHRleHRQYXJ0cyA9IHRleHQuc3BsaXQoXCI9XCIpO1xuICAgICAgICAgICAgaWYgKHRleHRQYXJ0cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXR0ck5hbWUgPSB0ZXh0UGFydHNbMF07XG4gICAgICAgICAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IHRleHRQYXJ0c1sxXS5yZXBsYWNlKC9bJ1wiXSsvZywgXCJcIik7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUgIT09IGF0dHJOYW1lICYmIGhhc09yaWdpbmFsQXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHVuc2V0Vmlld1ZhbHVlKHZpZXcsIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB2aWV3W2F0dHJOYW1lXSA9IGF0dHJWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXdbaGFzT3JpZ2luYWxBdHRyaWJ1dGUgPyBuYW1lIDogYXR0ck5hbWVdID0gYXR0clZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHVuc2V0Vmlld1ZhbHVlKHZpZXcsIG5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHZpZXcuZG9tTm9kZS5sb2FkQXR0cmlidXRlcygpO1xuICAgIH1cbn0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGV2dG9vbHMtZWxlbWVudHMuY29tbW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkZXZ0b29sc19lbGVtZW50c19jb21tb25fMSA9IHJlcXVpcmUoXCIuL2RldnRvb2xzLWVsZW1lbnRzLmNvbW1vblwiKTtcbnZhciBkb21fbm9kZV8xID0gcmVxdWlyZShcIi4vZG9tLW5vZGVcIik7XG5mdW5jdGlvbiBhdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcyhET01Eb21haW5Gcm9udGVuZCkge1xuICAgIGRvbV9ub2RlXzEucmVnaXN0ZXJJbnNwZWN0b3JFdmVudHMoRE9NRG9tYWluRnJvbnRlbmQpO1xuICAgIHZhciBvcmlnaW5hbENoaWxkTm9kZUluc2VydGVkID0gRE9NRG9tYWluRnJvbnRlbmQuY2hpbGROb2RlSW5zZXJ0ZWQ7XG4gICAgRE9NRG9tYWluRnJvbnRlbmQuY2hpbGROb2RlSW5zZXJ0ZWQgPSBmdW5jdGlvbiAocGFyZW50SWQsIGxhc3RJZCwgbm9kZSkge1xuICAgICAgICBvcmlnaW5hbENoaWxkTm9kZUluc2VydGVkKHBhcmVudElkLCBsYXN0SWQsIG5vZGUudG9PYmplY3QoKSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuYXR0YWNoRE9NSW5zcGVjdG9yRXZlbnRDYWxsYmFja3MgPSBhdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcztcbmZ1bmN0aW9uIGF0dGFjaERPTUluc3BlY3RvckNvbW1hbmRDYWxsYmFja3MoRE9NRG9tYWluQmFja2VuZCkge1xuICAgIERPTURvbWFpbkJhY2tlbmQuZ2V0RG9jdW1lbnQgPSBkZXZ0b29sc19lbGVtZW50c19jb21tb25fMS5nZXREb2N1bWVudDtcbiAgICBET01Eb21haW5CYWNrZW5kLnJlbW92ZU5vZGUgPSBkZXZ0b29sc19lbGVtZW50c19jb21tb25fMS5yZW1vdmVOb2RlO1xuICAgIERPTURvbWFpbkJhY2tlbmQuc2V0QXR0cmlidXRlQXNUZXh0ID0gZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEuc2V0QXR0cmlidXRlQXNUZXh0O1xufVxuZXhwb3J0cy5hdHRhY2hET01JbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzID0gYXR0YWNoRE9NSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcztcbmZ1bmN0aW9uIGF0dGFjaENTU0luc3BlY3RvckNvbW1hbmRDYWxsYmFja3MoQ1NTRG9tYWluQmFja2VuZCkge1xuICAgIENTU0RvbWFpbkJhY2tlbmQuZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlID0gZGV2dG9vbHNfZWxlbWVudHNfY29tbW9uXzEuZ2V0Q29tcHV0ZWRTdHlsZXNGb3JOb2RlO1xufVxuZXhwb3J0cy5hdHRhY2hDU1NJbnNwZWN0b3JDb21tYW5kQ2FsbGJhY2tzID0gYXR0YWNoQ1NTSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRldnRvb2xzLWVsZW1lbnRzLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcmVnaXN0ZXJlZERvbU5vZGVzID0ge307XG52YXIgRUxFTUVOVF9OT0RFX1RZUEUgPSAxO1xudmFyIFJPT1RfTk9ERV9UWVBFID0gOTtcbnZhciBwcm9wZXJ0eUJsYWNrbGlzdCA9IFtcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdMZWZ0XCIsXG4gICAgXCJlZmZlY3RpdmVQYWRkaW5nQm90dG9tXCIsXG4gICAgXCJlZmZlY3RpdmVQYWRkaW5nUmlnaHRcIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdUb3BcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVNaW5XaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlTWluSGVpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVXaWR0aFwiLFxuICAgIFwiZWZmZWN0aXZlSGVpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5MZWZ0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5Ub3BcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpblJpZ2h0XCIsXG4gICAgXCJlZmZlY3RpdmVNYXJnaW5Cb3R0b21cIixcbiAgICBcIm5vZGVOYW1lXCIsXG4gICAgXCJub2RlVHlwZVwiLFxuICAgIFwiZGVjb2RlV2lkdGhcIixcbiAgICBcImRlY29kZUhlaWdodFwiLFxuICAgIFwibmctcmVmbGVjdC1pdGVtc1wiLFxuICAgIFwiZG9tTm9kZVwiLFxuICAgIFwidG91Y2hMaXN0ZW5lcklzU2V0XCIsXG4gICAgXCJiaW5kaW5nQ29udGV4dFwiLFxuICAgIFwibmF0aXZlVmlld1wiXG5dO1xuZnVuY3Rpb24gbGF6eShhY3Rpb24pIHtcbiAgICB2YXIgX3ZhbHVlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdmFsdWUgfHwgKF92YWx1ZSA9IGFjdGlvbigpKTsgfTtcbn1cbnZhciBwZXJjZW50TGVuZ3RoVG9TdHJpbmdMYXp5ID0gbGF6eShmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vdWkvc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpLlBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nOyB9KTtcbnZhciBnZXRTZXRQcm9wZXJ0aWVzTGF6eSA9IGxhenkoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uL3VpL2NvcmUvcHJvcGVydGllc1wiKS5nZXRTZXRQcm9wZXJ0aWVzOyB9KTtcbnZhciBnZXRDb21wdXRlZENzc1ZhbHVlc0xhenkgPSBsYXp5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi91aS9jb3JlL3Byb3BlcnRpZXNcIikuZ2V0Q29tcHV0ZWRDc3NWYWx1ZXM7IH0pO1xuZnVuY3Rpb24gcmVnaXN0ZXJJbnNwZWN0b3JFdmVudHMoaW5zcGVjdG9yKSB7XG4gICAgaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSA9IGluc3BlY3Rvcjtcbn1cbmV4cG9ydHMucmVnaXN0ZXJJbnNwZWN0b3JFdmVudHMgPSByZWdpc3Rlckluc3BlY3RvckV2ZW50cztcbnZhciBpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlO1xuZnVuY3Rpb24gbm90aWZ5SW5zcGVjdG9yKGNhbGxiYWNrKSB7XG4gICAgaWYgKGluc3BlY3RvckZyb250ZW5kSW5zdGFuY2UpIHtcbiAgICAgICAgY2FsbGJhY2soaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsdWVUb1N0cmluZyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZS51bml0KSB7XG4gICAgICAgIHJldHVybiBwZXJjZW50TGVuZ3RoVG9TdHJpbmdMYXp5KCkodmFsdWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICsgXCJcIjtcbiAgICB9XG59XG5mdW5jdGlvbiBwcm9wZXJ0eUZpbHRlcihfYSkge1xuICAgIHZhciBuYW1lID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XG4gICAgaWYgKG5hbWVbMF0gPT09IFwiX1wiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwcm9wZXJ0eUJsYWNrbGlzdC5pbmRleE9mKG5hbWUpID49IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyTm9kZShkb21Ob2RlKSB7XG4gICAgcmVnaXN0ZXJlZERvbU5vZGVzW2RvbU5vZGUubm9kZUlkXSA9IGRvbU5vZGU7XG59XG5mdW5jdGlvbiB1bnJlZ2lzdGVyTm9kZShkb21Ob2RlKSB7XG4gICAgZGVsZXRlIHJlZ2lzdGVyZWREb21Ob2Rlc1tkb21Ob2RlLm5vZGVJZF07XG59XG5mdW5jdGlvbiBnZXROb2RlQnlJZChpZCkge1xuICAgIHJldHVybiByZWdpc3RlcmVkRG9tTm9kZXNbaWRdO1xufVxuZXhwb3J0cy5nZXROb2RlQnlJZCA9IGdldE5vZGVCeUlkO1xudmFyIERPTU5vZGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERPTU5vZGUodmlldykge1xuICAgICAgICB0aGlzLm5vZGVWYWx1ZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgICAgICB0aGlzLnZpZXdSZWYgPSBuZXcgV2Vha1JlZih2aWV3KTtcbiAgICAgICAgdGhpcy5ub2RlVHlwZSA9IHZpZXcudHlwZU5hbWUgPT09IFwiRnJhbWVcIiA/IFJPT1RfTk9ERV9UWVBFIDogRUxFTUVOVF9OT0RFX1RZUEU7XG4gICAgICAgIHRoaXMubm9kZUlkID0gdmlldy5fZG9tSWQ7XG4gICAgICAgIHRoaXMubm9kZU5hbWUgPSB2aWV3LnR5cGVOYW1lO1xuICAgICAgICB0aGlzLmxvY2FsTmFtZSA9IHRoaXMubm9kZU5hbWU7XG4gICAgICAgIHRoaXMubG9hZEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgcmVnaXN0ZXJOb2RlKHRoaXMpO1xuICAgIH1cbiAgICBET01Ob2RlLnByb3RvdHlwZS5sb2FkQXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIGdldFNldFByb3BlcnRpZXNMYXp5KCkodGhpcy52aWV3UmVmLmdldCgpKVxuICAgICAgICAgICAgLmZpbHRlcihwcm9wZXJ0eUZpbHRlcilcbiAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChwYWlyKSB7IHJldHVybiBfdGhpcy5hdHRyaWJ1dGVzLnB1c2gocGFpclswXSwgcGFpclsxXSArIFwiXCIpOyB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01Ob2RlLnByb3RvdHlwZSwgXCJjaGlsZHJlblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzID0gW107XG4gICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBjaGlsZC5lbnN1cmVEb21Ob2RlKCk7XG4gICAgICAgICAgICAgICAgcmVzLnB1c2goY2hpbGQuZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIERPTU5vZGUucHJvdG90eXBlLm9uQ2hpbGRBZGRlZCA9IGZ1bmN0aW9uIChjaGlsZFZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gX3RoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIHZhciBwcmV2aW91c0NoaWxkO1xuICAgICAgICAgICAgdmlldy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkID09PSBjaGlsZFZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2aW91c0NoaWxkID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9ICEhcHJldmlvdXNDaGlsZCA/IHByZXZpb3VzQ2hpbGQuX2RvbUlkIDogMDtcbiAgICAgICAgICAgIGNoaWxkVmlldy5lbnN1cmVEb21Ob2RlKCk7XG4gICAgICAgICAgICBpbnMuY2hpbGROb2RlSW5zZXJ0ZWQoX3RoaXMubm9kZUlkLCBpbmRleCwgY2hpbGRWaWV3LmRvbU5vZGUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLm9uQ2hpbGRSZW1vdmVkID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlucy5jaGlsZE5vZGVSZW1vdmVkKF90aGlzLm5vZGVJZCwgdmlldy5fZG9tSWQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLmF0dHJpYnV0ZU1vZGlmaWVkID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIG5vdGlmeUluc3BlY3RvcihmdW5jdGlvbiAoaW5zKSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydHlCbGFja2xpc3QuaW5kZXhPZihuYW1lKSA8IDApIHtcbiAgICAgICAgICAgICAgICBpbnMuYXR0cmlidXRlTW9kaWZpZWQoX3RoaXMubm9kZUlkLCBuYW1lLCB2YWx1ZVRvU3RyaW5nKHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuYXR0cmlidXRlUmVtb3ZlZCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIG5vdGlmeUluc3BlY3RvcihmdW5jdGlvbiAoaW5zKSB7XG4gICAgICAgICAgICBpbnMuYXR0cmlidXRlUmVtb3ZlZChfdGhpcy5ub2RlSWQsIG5hbWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERPTU5vZGUucHJvdG90eXBlLmdldENvbXB1dGVkUHJvcGVydGllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBnZXRDb21wdXRlZENzc1ZhbHVlc0xhenkoKSh2aWV3KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocGFpcikgeyByZXR1cm4gcGFpclswXVswXSAhPT0gXCJfXCI7IH0pXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChwYWlyKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHBhaXJbMF0sXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlVG9TdHJpbmcocGFpclsxXSlcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdW5yZWdpc3Rlck5vZGUodGhpcyk7XG4gICAgICAgIHRoaXMudmlld1JlZi5jbGVhcigpO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUudG9PYmplY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBub2RlSWQ6IHRoaXMubm9kZUlkLFxuICAgICAgICAgICAgbm9kZVR5cGU6IHRoaXMubm9kZVR5cGUsXG4gICAgICAgICAgICBub2RlTmFtZTogdGhpcy5ub2RlTmFtZSxcbiAgICAgICAgICAgIGxvY2FsTmFtZTogdGhpcy5sb2NhbE5hbWUsXG4gICAgICAgICAgICBub2RlVmFsdWU6IHRoaXMubm9kZVZhbHVlLFxuICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW4ubWFwKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjLnRvT2JqZWN0KCk7IH0pLFxuICAgICAgICAgICAgYXR0cmlidXRlczogdGhpcy5hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgYmFja2VuZE5vZGVJZDogMFxuICAgICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIERPTU5vZGU7XG59KCkpO1xuZXhwb3J0cy5ET01Ob2RlID0gRE9NTm9kZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvbS1ub2RlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBpbnNwZWN0b3JDb21tYW5kcyA9IHJlcXVpcmUoXCIuL0luc3BlY3RvckJhY2tlbmRDb21tYW5kc1wiKTtcbnZhciBkZWJ1Z2dlckRvbWFpbnMgPSByZXF1aXJlKFwiLi9kZWJ1Z2dlclwiKTtcbnZhciBkZXZ0b29sc19lbGVtZW50c18xID0gcmVxdWlyZShcIi4vZGV2dG9vbHMtZWxlbWVudHNcIik7XG52YXIgQ1NTRG9tYWluRGVidWdnZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENTU0RvbWFpbkRlYnVnZ2VyKCkge1xuICAgICAgICB0aGlzLmV2ZW50cyA9IG5ldyBpbnNwZWN0b3JDb21tYW5kcy5DU1NEb21haW4uQ1NTRnJvbnRlbmQoKTtcbiAgICAgICAgdGhpcy5jb21tYW5kcyA9IHt9O1xuICAgICAgICBkZXZ0b29sc19lbGVtZW50c18xLmF0dGFjaENTU0luc3BlY3RvckNvbW1hbmRDYWxsYmFja3ModGhpcy5jb21tYW5kcyk7XG4gICAgICAgIHRoaXMuZW5hYmxlKCk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDU1NEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUsIFwiZW5hYmxlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2VuYWJsZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChkZWJ1Z2dlckRvbWFpbnMuZ2V0Q1NTKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9uZSBDU1NEb21haW5EZWJ1Z2dlciBtYXkgYmUgZW5hYmxlZCBhdCBhIHRpbWUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVidWdnZXJEb21haW5zLnNldENTUyh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbmFibGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoZGVidWdnZXJEb21haW5zLmdldENTUygpID09PSB0aGlzKSB7XG4gICAgICAgICAgICBkZWJ1Z2dlckRvbWFpbnMuc2V0Q1NTKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2VuYWJsZWQgPSBmYWxzZTtcbiAgICB9O1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5nZXRNYXRjaGVkU3R5bGVzRm9yTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH07XG4gICAgQ1NTRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmdldElubGluZVN0eWxlc0Zvck5vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9O1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5nZXRDb21wdXRlZFN0eWxlRm9yTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHsgY29tcHV0ZWRTdHlsZTogdGhpcy5jb21tYW5kcy5nZXRDb21wdXRlZFN0eWxlc0Zvck5vZGUocGFyYW1zLm5vZGVJZCkgfTtcbiAgICB9O1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5nZXRQbGF0Zm9ybUZvbnRzRm9yTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZvbnRzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBmYW1pbHlOYW1lOiBcIlN0YW5kYXJkIEZvbnRcIixcbiAgICAgICAgICAgICAgICAgICAgaXNDdXN0b21Gb250OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZ2x5cGhDb3VudDogMFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIENTU0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5nZXRTdHlsZVNoZWV0VGV4dCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1NEb21haW5EZWJ1Z2dlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBpbnNwZWN0b3JDb21tYW5kcy5Eb21haW5EaXNwYXRjaGVyKFwiQ1NTXCIpXG4gICAgXSwgQ1NTRG9tYWluRGVidWdnZXIpO1xuICAgIHJldHVybiBDU1NEb21haW5EZWJ1Z2dlcjtcbn0oKSk7XG5leHBvcnRzLkNTU0RvbWFpbkRlYnVnZ2VyID0gQ1NTRG9tYWluRGVidWdnZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWJpbnNwZWN0b3ItY3NzLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaW5zcGVjdG9yQ29tbWFuZHMgPSByZXF1aXJlKFwiLi9JbnNwZWN0b3JCYWNrZW5kQ29tbWFuZHNcIik7XG52YXIgZGVidWdnZXJEb21haW5zID0gcmVxdWlyZShcIi4vZGVidWdnZXJcIik7XG52YXIgZGV2dG9vbHNfZWxlbWVudHNfMSA9IHJlcXVpcmUoXCIuL2RldnRvb2xzLWVsZW1lbnRzXCIpO1xudmFyIERPTURvbWFpbkRlYnVnZ2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBET01Eb21haW5EZWJ1Z2dlcigpIHtcbiAgICAgICAgdGhpcy5ldmVudHMgPSBuZXcgaW5zcGVjdG9yQ29tbWFuZHMuRE9NRG9tYWluLkRPTUZyb250ZW5kKCk7XG4gICAgICAgIHRoaXMuY29tbWFuZHMgPSB7fTtcbiAgICAgICAgZGV2dG9vbHNfZWxlbWVudHNfMS5hdHRhY2hET01JbnNwZWN0b3JFdmVudENhbGxiYWNrcyh0aGlzLmV2ZW50cyk7XG4gICAgICAgIGRldnRvb2xzX2VsZW1lbnRzXzEuYXR0YWNoRE9NSW5zcGVjdG9yQ29tbWFuZENhbGxiYWNrcyh0aGlzLmNvbW1hbmRzKTtcbiAgICAgICAgdGhpcy5lbmFibGUoKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTURvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZSwgXCJlbmFibGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW5hYmxlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGRlYnVnZ2VyRG9tYWlucy5nZXRET00oKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT25lIERPTURvbWFpbkRlYnVnZ2VyIG1heSBiZSBlbmFibGVkIGF0IGEgdGltZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWJ1Z2dlckRvbWFpbnMuc2V0RE9NKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2VuYWJsZWQgPSB0cnVlO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChkZWJ1Z2dlckRvbWFpbnMuZ2V0RE9NKCkgPT09IHRoaXMpIHtcbiAgICAgICAgICAgIGRlYnVnZ2VyRG9tYWlucy5zZXRET00obnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmdldERvY3VtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZG9tTm9kZSA9IHRoaXMuY29tbWFuZHMuZ2V0RG9jdW1lbnQoKTtcbiAgICAgICAgcmV0dXJuIHsgcm9vdDogZG9tTm9kZSB9O1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLnJlbW92ZU5vZGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHRoaXMuY29tbWFuZHMucmVtb3ZlTm9kZShwYXJhbXMubm9kZUlkKTtcbiAgICB9O1xuICAgIERPTURvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5zZXRBdHRyaWJ1dGVWYWx1ZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC5cIik7XG4gICAgfTtcbiAgICBET01Eb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuc2V0QXR0cmlidXRlc0FzVGV4dCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5jb21tYW5kcy5zZXRBdHRyaWJ1dGVBc1RleHQocGFyYW1zLm5vZGVJZCwgcGFyYW1zLnRleHQsIHBhcmFtcy5uYW1lKTtcbiAgICB9O1xuICAgIERPTURvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5yZW1vdmVBdHRyaWJ1dGUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1ldGhvZCBub3QgaW1wbGVtZW50ZWQuXCIpO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLnBlcmZvcm1TZWFyY2ggPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmdldFNlYXJjaFJlc3VsdHMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmRpc2NhcmRTZWFyY2hSZXN1bHRzID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICByZXR1cm47XG4gICAgfTtcbiAgICBET01Eb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuaGlnaGxpZ2h0Tm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH07XG4gICAgRE9NRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmhpZGVIaWdobGlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuICAgIERPTURvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5yZXNvbHZlTm9kZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBET01Eb21haW5EZWJ1Z2dlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBpbnNwZWN0b3JDb21tYW5kcy5Eb21haW5EaXNwYXRjaGVyKFwiRE9NXCIpXG4gICAgXSwgRE9NRG9tYWluRGVidWdnZXIpO1xuICAgIHJldHVybiBET01Eb21haW5EZWJ1Z2dlcjtcbn0oKSk7XG5leHBvcnRzLkRPTURvbWFpbkRlYnVnZ2VyID0gRE9NRG9tYWluRGVidWdnZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWJpbnNwZWN0b3ItZG9tLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaW5zcGVjdG9yQ29tbWFuZHMgPSByZXF1aXJlKFwiLi9JbnNwZWN0b3JCYWNrZW5kQ29tbWFuZHNcIik7XG52YXIgZGVidWdnZXJEb21haW5zID0gcmVxdWlyZShcIi4vZGVidWdnZXJcIik7XG52YXIgZnJhbWVJZCA9IFwiTmF0aXZlU2NyaXB0TWFpbkZyYW1lSWRlbnRpZmllclwiO1xudmFyIGxvYWRlcklkID0gXCJMb2FkZXIgSWRlbnRpZmllclwiO1xudmFyIHJlc291cmNlc19kYXRhcyA9IFtdO1xudmFyIGRvY3VtZW50VHlwZUJ5TWltZVR5cGUgPSB7XG4gICAgXCJ0ZXh0L3htbFwiOiBcIkRvY3VtZW50XCIsXG4gICAgXCJ0ZXh0L3BsYWluXCI6IFwiRG9jdW1lbnRcIixcbiAgICBcInRleHQvaHRtbFwiOiBcIkRvY3VtZW50XCIsXG4gICAgXCJhcHBsaWNhdGlvbi94bWxcIjogXCJEb2N1bWVudFwiLFxuICAgIFwiYXBwbGljYXRpb24veGh0bWwreG1sXCI6IFwiRG9jdW1lbnRcIixcbiAgICBcInRleHQvY3NzXCI6IFwiU3R5bGVzaGVldFwiLFxuICAgIFwidGV4dC9qYXZhc2NyaXB0XCI6IFwiU2NyaXB0XCIsXG4gICAgXCJ0ZXh0L2VjbWFzY3JpcHRcIjogXCJTY3JpcHRcIixcbiAgICBcImFwcGxpY2F0aW9uL2phdmFzY3JpcHRcIjogXCJTY3JpcHRcIixcbiAgICBcImFwcGxpY2F0aW9uL2VjbWFzY3JpcHRcIjogXCJTY3JpcHRcIixcbiAgICBcImFwcGxpY2F0aW9uL3gtamF2YXNjcmlwdFwiOiBcIlNjcmlwdFwiLFxuICAgIFwiYXBwbGljYXRpb24vanNvblwiOiBcIlNjcmlwdFwiLFxuICAgIFwiYXBwbGljYXRpb24veC1qc29uXCI6IFwiU2NyaXB0XCIsXG4gICAgXCJ0ZXh0L3gtamF2YXNjcmlwdFwiOiBcIlNjcmlwdFwiLFxuICAgIFwidGV4dC94LWpzb25cIjogXCJTY3JpcHRcIixcbiAgICBcInRleHQvdHlwZXNjcmlwdFwiOiBcIlNjcmlwdFwiXG59O1xudmFyIFJlcXVlc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlcXVlc3QoX25ldHdvcmtEb21haW5EZWJ1Z2dlciwgX3JlcXVlc3RJRCkge1xuICAgICAgICB0aGlzLl9uZXR3b3JrRG9tYWluRGVidWdnZXIgPSBfbmV0d29ya0RvbWFpbkRlYnVnZ2VyO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0SUQgPSBfcmVxdWVzdElEO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVxdWVzdC5wcm90b3R5cGUsIFwibWltZVR5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9taW1lVHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9taW1lVHlwZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21pbWVUeXBlID0gXCJ0ZXh0L3BsYWluXCI7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc291cmNlVHlwZSA9IFwiT3RoZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9taW1lVHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZVR5cGUgPSBcIk90aGVyXCI7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21pbWVUeXBlIGluIGRvY3VtZW50VHlwZUJ5TWltZVR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VUeXBlID0gZG9jdW1lbnRUeXBlQnlNaW1lVHlwZVt0aGlzLl9taW1lVHlwZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9taW1lVHlwZS5pbmRleE9mKFwiaW1hZ2UvXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZVR5cGUgPSBcIkltYWdlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9taW1lVHlwZS5pbmRleE9mKFwiZm9udC9cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc291cmNlVHlwZSA9IFwiRm9udFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9yZXNvdXJjZVR5cGUgPSByZXNvdXJjZVR5cGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXF1ZXN0SURcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0SUQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXF1ZXN0LnByb3RvdHlwZSwgXCJoYXNUZXh0Q29udGVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtcIkRvY3VtZW50XCIsIFwiU3R5bGVzaGVldFwiLCBcIlNjcmlwdFwiLCBcIlhIUlwiXS5pbmRleE9mKHRoaXMuX3Jlc291cmNlVHlwZSkgIT09IC0xO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVxdWVzdC5wcm90b3R5cGUsIFwiZGF0YVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZGF0YSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kYXRhID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXNvdXJjZVR5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXNvdXJjZVR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVzb3VyY2VUeXBlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc291cmNlVHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBSZXF1ZXN0LnByb3RvdHlwZS5yZXNwb25zZVJlY2VpdmVkID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmICh0aGlzLl9uZXR3b3JrRG9tYWluRGVidWdnZXIuZW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5fbmV0d29ya0RvbWFpbkRlYnVnZ2VyLmV2ZW50cy5yZXNwb25zZVJlY2VpdmVkKHRoaXMucmVxdWVzdElELCBmcmFtZUlkLCBsb2FkZXJJZCwgX19pbnNwZWN0b3JUaW1lc3RhbXAoKSwgdGhpcy5yZXNvdXJjZVR5cGUsIHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVxdWVzdC5wcm90b3R5cGUubG9hZGluZ0ZpbmlzaGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fbmV0d29ya0RvbWFpbkRlYnVnZ2VyLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX25ldHdvcmtEb21haW5EZWJ1Z2dlci5ldmVudHMubG9hZGluZ0ZpbmlzaGVkKHRoaXMucmVxdWVzdElELCBfX2luc3BlY3RvclRpbWVzdGFtcCgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVxdWVzdC5wcm90b3R5cGUucmVxdWVzdFdpbGxCZVNlbnQgPSBmdW5jdGlvbiAocmVxdWVzdCkge1xuICAgICAgICBpZiAodGhpcy5fbmV0d29ya0RvbWFpbkRlYnVnZ2VyLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX25ldHdvcmtEb21haW5EZWJ1Z2dlci5ldmVudHMucmVxdWVzdFdpbGxCZVNlbnQodGhpcy5yZXF1ZXN0SUQsIGZyYW1lSWQsIGxvYWRlcklkLCByZXF1ZXN0LnVybCwgcmVxdWVzdCwgX19pbnNwZWN0b3JUaW1lc3RhbXAoKSwgeyB0eXBlOiBcIlNjcmlwdFwiIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUmVxdWVzdDtcbn0oKSk7XG5leHBvcnRzLlJlcXVlc3QgPSBSZXF1ZXN0O1xudmFyIE5ldHdvcmtEb21haW5EZWJ1Z2dlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTmV0d29ya0RvbWFpbkRlYnVnZ2VyKCkge1xuICAgICAgICB0aGlzLmV2ZW50cyA9IG5ldyBpbnNwZWN0b3JDb21tYW5kcy5OZXR3b3JrRG9tYWluLk5ldHdvcmtGcm9udGVuZCgpO1xuICAgICAgICB0aGlzLmVuYWJsZSgpO1xuICAgIH1cbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXJfMSA9IE5ldHdvcmtEb21haW5EZWJ1Z2dlcjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTmV0d29ya0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZSwgXCJlbmFibGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZW5hYmxlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTmV0d29ya0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChkZWJ1Z2dlckRvbWFpbnMuZ2V0TmV0d29yaygpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmUgTmV0d29ya0RvbWFpbkRlYnVnZ2VyIG1heSBiZSBlbmFibGVkIGF0IGEgdGltZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWJ1Z2dlckRvbWFpbnMuc2V0TmV0d29yayh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9lbmFibGVkID0gdHJ1ZTtcbiAgICB9O1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKGRlYnVnZ2VyRG9tYWlucy5nZXROZXR3b3JrKCkgPT09IHRoaXMpIHtcbiAgICAgICAgICAgIGRlYnVnZ2VyRG9tYWlucy5zZXROZXR3b3JrKG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2VuYWJsZWQgPSBmYWxzZTtcbiAgICB9O1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuc2V0RXh0cmFIVFRQSGVhZGVycyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICB9O1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuZ2V0UmVzcG9uc2VCb2R5ID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgcmVzb3VyY2VfZGF0YSA9IHJlc291cmNlc19kYXRhc1twYXJhbXMucmVxdWVzdElkXTtcbiAgICAgICAgdmFyIGJvZHkgPSByZXNvdXJjZV9kYXRhLmhhc1RleHRDb250ZW50ID8gTlNTdHJpbmcuYWxsb2MoKS5pbml0V2l0aERhdGFFbmNvZGluZyhyZXNvdXJjZV9kYXRhLmRhdGEsIDQpLnRvU3RyaW5nKCkgOlxuICAgICAgICAgICAgcmVzb3VyY2VfZGF0YS5kYXRhLmJhc2U2NEVuY29kZWRTdHJpbmdXaXRoT3B0aW9ucygwKTtcbiAgICAgICAgaWYgKHJlc291cmNlX2RhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYm9keTogYm9keSxcbiAgICAgICAgICAgICAgICBiYXNlNjRFbmNvZGVkOiAhcmVzb3VyY2VfZGF0YS5oYXNUZXh0Q29udGVudFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTmV0d29ya0RvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5jYW5DbGVhckJyb3dzZXJDYWNoZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3VsdDogZmFsc2VcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuY2xlYXJCcm93c2VyQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmNhbkNsZWFyQnJvd3NlckNvb2tpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXN1bHQ6IGZhbHNlXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmNsZWFyQnJvd3NlckNvb2tpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXIucHJvdG90eXBlLnNldENhY2hlRGlzYWJsZWQgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG4gICAgfTtcbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXIucHJvdG90eXBlLmxvYWRSZXNvdXJjZSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcbiAgICAgICAgdmFyIGFwcFBhdGggPSBOU0J1bmRsZS5tYWluQnVuZGxlLmJ1bmRsZVBhdGg7XG4gICAgICAgIHZhciBwYXRoVXJsID0gcGFyYW1zLnVybC5yZXBsYWNlKFwiZmlsZTovL1wiLCBhcHBQYXRoKTtcbiAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgdmFyIGRhdGEgPSBmaWxlTWFuYWdlci5maWxlRXhpc3RzQXRQYXRoKHBhdGhVcmwpID8gZmlsZU1hbmFnZXIuY29udGVudHNBdFBhdGgocGF0aFVybCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBjb250ZW50ID0gZGF0YSA/IE5TU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhEYXRhRW5jb2RpbmcoZGF0YSwgTlNVVEY4U3RyaW5nRW5jb2RpbmcpIDogXCJcIjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIG1pbWVUeXBlOiBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiLFxuICAgICAgICAgICAgc3RhdHVzOiAyMDBcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaWQgPSAoKytOZXR3b3JrRG9tYWluRGVidWdnZXJfMS5pZFNlcXVlbmNlKS50b1N0cmluZygpO1xuICAgICAgICB2YXIgcmVzb3VyY2VEYXRhID0gbmV3IFJlcXVlc3QodGhpcywgaWQpO1xuICAgICAgICByZXNvdXJjZXNfZGF0YXNbaWRdID0gcmVzb3VyY2VEYXRhO1xuICAgICAgICByZXR1cm4gcmVzb3VyY2VEYXRhO1xuICAgIH07XG4gICAgdmFyIE5ldHdvcmtEb21haW5EZWJ1Z2dlcl8xO1xuICAgIE5ldHdvcmtEb21haW5EZWJ1Z2dlci5pZFNlcXVlbmNlID0gMDtcbiAgICBOZXR3b3JrRG9tYWluRGVidWdnZXIgPSBOZXR3b3JrRG9tYWluRGVidWdnZXJfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBpbnNwZWN0b3JDb21tYW5kcy5Eb21haW5EaXNwYXRjaGVyKFwiTmV0d29ya1wiKVxuICAgIF0sIE5ldHdvcmtEb21haW5EZWJ1Z2dlcik7XG4gICAgcmV0dXJuIE5ldHdvcmtEb21haW5EZWJ1Z2dlcjtcbn0oKSk7XG5leHBvcnRzLk5ldHdvcmtEb21haW5EZWJ1Z2dlciA9IE5ldHdvcmtEb21haW5EZWJ1Z2dlcjtcbnZhciBSdW50aW1lRG9tYWluRGVidWdnZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJ1bnRpbWVEb21haW5EZWJ1Z2dlcigpIHtcbiAgICAgICAgX19pbnNwZWN0b3JTZW5kRXZlbnQoXCJ7XFxcIm1ldGhvZFxcXCI6XFxcIlJ1bnRpbWUuZXhlY3V0aW9uQ29udGV4dENyZWF0ZWRcXFwiLFxcXCJwYXJhbXNcXFwiOntcXFwiY29udGV4dFxcXCI6e1xcXCJpZFxcXCI6MSxcXFwib3JpZ2luXFxcIjpcXFwiaHR0cDovL21haW4ueG1sXFxcIixcXFwibmFtZVxcXCI6XFxcIlxcXCIsXFxcImF1eERhdGFcXFwiOntcXFwiaXNEZWZhdWx0XFxcIjp0cnVlLFxcXCJmcmFtZUlkXFxcIjpcXFwiXCIgKyBmcmFtZUlkICsgXCJcXFwifX19fVwiKTtcbiAgICB9XG4gICAgUnVudGltZURvbWFpbkRlYnVnZ2VyLnByb3RvdHlwZS5jb21waWxlU2NyaXB0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfTtcbiAgICBSdW50aW1lRG9tYWluRGVidWdnZXIgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgaW5zcGVjdG9yQ29tbWFuZHMuRG9tYWluRGlzcGF0Y2hlcihcIlJ1bnRpbWVcIilcbiAgICBdLCBSdW50aW1lRG9tYWluRGVidWdnZXIpO1xuICAgIHJldHVybiBSdW50aW1lRG9tYWluRGVidWdnZXI7XG59KCkpO1xuZXhwb3J0cy5SdW50aW1lRG9tYWluRGVidWdnZXIgPSBSdW50aW1lRG9tYWluRGVidWdnZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWJpbnNwZWN0b3ItbmV0d29yay5pb3MuanMubWFwIiwi77u/KGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0ID0gZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuRm9ybURhdGEgPSBnbG9iYWwuRm9ybURhdGE7XG5cbiAgICBpZiAoIWV4cG9ydHMuWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgdmFyIHhociA9IHJlcXVpcmUoXCJ4aHJcIik7XG4gICAgICAgIGV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSB4aHIuWE1MSHR0cFJlcXVlc3Q7XG4gICAgICAgIGV4cG9ydHMuRm9ybURhdGEgPSB4aHIuRm9ybURhdGE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTmFtZShuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9bXmEtejAtOVxcLSMkJSYnKisuXFxeX2B8fl0vaS50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgICAgIHRoaXMubWFwID0ge31cblxuICAgICAgICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICAgICAgICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG5cbiAgICAgICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgICAgICAgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSlcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm1hcFtuYW1lXVxuICAgICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgICAgIGxpc3QgPSBbXVxuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0gPSBsaXN0XG4gICAgICAgIH1cbiAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgICAgICByZXR1cm4gdmFsdWVzID8gdmFsdWVzWzBdIDogbnVsbFxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSB8fCBbXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IFtub3JtYWxpemVWYWx1ZSh2YWx1ZSldXG4gICAgfVxuXG4gICAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzLm1hcCkuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHZhbHVlLCBuYW1lLCB0aGlzKVxuICAgICAgICAgICAgfSwgdGhpcylcbiAgICAgICAgfSwgdGhpcylcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25zdW1lZChib2R5KSB7XG4gICAgICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgICAgIH1cbiAgICAgICAgYm9keS5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVhZGVyLnJlc3VsdClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChyZWFkZXIuZXJyb3IpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpXG4gICAgICAgIHJldHVybiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICAgICAgcmV0dXJuIGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgfVxuXG4gICAgdmFyIHN1cHBvcnQgPSB7XG4gICAgICAgIGJsb2I6ICdGaWxlUmVhZGVyJyBpbiBleHBvcnRzICYmICdCbG9iJyBpbiBleHBvcnRzICYmIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG5ldyBCbG9iKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKSxcbiAgICAgICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gZXhwb3J0c1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgICAgIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG5cbiAgICAgICAgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xuICAgICAgICAgICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgICAgICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keUJsb2IgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgZXhwb3J0cy5Gb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWJvZHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib2R5VGV4dCA9ICcnXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgICAgICAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIGJsb2InKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZEJsb2JBc1RleHQodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIHRleHQnKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkID8gcmVqZWN0ZWQgOiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmpzb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICAvLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbiAgICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTWV0aG9kKG1ldGhvZCkge1xuICAgICAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIHJldHVybiAobWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEpID8gdXBjYXNlZCA6IG1ldGhvZFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIFJlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgICAgIHRoaXMudXJsID0gdXJsXG5cbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHMgfHwgJ29taXQnXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgICAgICAgdGhpcy5tZXRob2QgPSBub3JtYWxpemVNZXRob2Qob3B0aW9ucy5tZXRob2QgfHwgJ0dFVCcpXG4gICAgICAgIHRoaXMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCBudWxsXG4gICAgICAgIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgICAgICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgb3B0aW9ucy5ib2R5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW5pdEJvZHkob3B0aW9ucy5ib2R5KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IGV4cG9ydHMuRm9ybURhdGEoKVxuICAgICAgICBib2R5LnRyaW0oKS5zcGxpdCgnJicpLmZvckVhY2goZnVuY3Rpb24gKGJ5dGVzKSB7XG4gICAgICAgICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXQgPSBieXRlcy5zcGxpdCgnPScpXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzcGxpdC5zaGlmdCgpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZm9ybVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhlYWRlcnMoeGhyKSB7XG4gICAgICAgIHZhciBoZWFkID0gbmV3IEhlYWRlcnMoKVxuICAgICAgICB2YXIgcGFpcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkudHJpbSgpLnNwbGl0KCdcXG4nKVxuICAgICAgICBwYWlycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IGhlYWRlci50cmltKCkuc3BsaXQoJzonKVxuICAgICAgICAgICAgdmFyIGtleSA9IHNwbGl0LnNoaWZ0KCkudHJpbSgpXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc6JykudHJpbSgpXG4gICAgICAgICAgICBoZWFkLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaGVhZFxuICAgIH1cblxuICAgIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICAgIGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHt9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgICAgICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgICAgIHRoaXMudXJsID0gbnVsbFxuICAgICAgICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzXG4gICAgICAgIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgICAgICAgdGhpcy5zdGF0dXNUZXh0ID0gb3B0aW9ucy5zdGF0dXNUZXh0XG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMgPyBvcHRpb25zLmhlYWRlcnMgOiBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gICAgICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB9XG5cbiAgICBCb2R5LmNhbGwoUmVzcG9uc2UucHJvdG90eXBlKVxuXG4gICAgZXhwb3J0cy5IZWFkZXJzID0gSGVhZGVycztcbiAgICBleHBvcnRzLlJlcXVlc3QgPSBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuUmVzcG9uc2UgPSBSZXNwb25zZTtcblxuICAgIGV4cG9ydHMuZmV0Y2ggPSBmdW5jdGlvbiAoaW5wdXQsIGluaXQpIHtcbiAgICAgICAgLy8gVE9ETzogUmVxdWVzdCBjb25zdHJ1Y3RvciBzaG91bGQgYWNjZXB0IGlucHV0LCBpbml0XG4gICAgICAgIHZhciByZXF1ZXN0XG4gICAgICAgIGlmIChSZXF1ZXN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGlucHV0KSAmJiAhaW5pdCkge1xuICAgICAgICAgICAgcmVxdWVzdCA9IGlucHV0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoaW5wdXQsIGluaXQpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHhociA9IG5ldyBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0KClcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2VVUkwoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCdyZXNwb25zZVVSTCcgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VVUkxcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBdm9pZCBzZWN1cml0eSB3YXJuaW5ncyBvbiBnZXRSZXNwb25zZUhlYWRlciB3aGVuIG5vdCBhbGxvd2VkIGJ5IENPUlNcbiAgICAgICAgICAgICAgICBpZiAoL15YLVJlcXVlc3QtVVJMOi9tLnRlc3QoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdYLVJlcXVlc3QtVVJMJylcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzKSA/IDIwNCA6IHhoci5zdGF0dXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzIDwgMTAwIHx8IHN0YXR1cyA+IDU5OSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyh4aHIpLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHJlc3BvbnNlVVJMKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy92YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZSh4aHIucmVzcG9uc2VUZXh0LCBvcHRpb25zKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcihbJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZV0uam9pbignICcpKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9wZW4ocmVxdWVzdC5tZXRob2QsIHJlcXVlc3QudXJsLCB0cnVlKVxuXG4gICAgICAgICAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCdyZXNwb25zZVR5cGUnIGluIHhociAmJiBzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSkge1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZXhwb3J0cy5mZXRjaC5wb2x5ZmlsbCA9IHRydWVcblxufSkoKTsiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF8xID0gcmVxdWlyZShcIi4uL3RleHRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbnZhciBGaWxlU3lzdGVtQWNjZXNzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlU3lzdGVtQWNjZXNzKCkge1xuICAgIH1cbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRMYXN0TW9kaWZpZWQgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGZpbGVNYW5hZ2VyLmF0dHJpYnV0ZXNPZkl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzLm9iamVjdEZvcktleShcIk5TRmlsZU1vZGlmaWNhdGlvbkRhdGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZVNpemUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGZpbGVNYW5hZ2VyLmF0dHJpYnV0ZXNPZkl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzLm9iamVjdEZvcktleShcIk5TRmlsZVNpemVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0UGFyZW50ID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgbnNTdHJpbmcgPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKHBhdGgpO1xuICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSBuc1N0cmluZy5zdHJpbmdCeURlbGV0aW5nTGFzdFBhdGhDb21wb25lbnQ7XG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gZmlsZU1hbmFnZXIuZGlzcGxheU5hbWVBdFBhdGgocGFyZW50UGF0aCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhdGg6IHBhcmVudFBhdGgudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzFcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGaWxlID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gZmlsZU1hbmFnZXIuZmlsZUV4aXN0c0F0UGF0aChwYXRoKTtcbiAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSB0aGlzLmdldFBhcmVudChwYXRoLCBvbkVycm9yKS5wYXRoO1xuICAgICAgICAgICAgICAgIGlmICghZmlsZU1hbmFnZXIuY3JlYXRlRGlyZWN0b3J5QXRQYXRoV2l0aEludGVybWVkaWF0ZURpcmVjdG9yaWVzQXR0cmlidXRlc0Vycm9yKHBhcmVudFBhdGgsIHRydWUsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIHx8ICFmaWxlTWFuYWdlci5jcmVhdGVGaWxlQXRQYXRoQ29udGVudHNBdHRyaWJ1dGVzKHBhdGgsIG51bGwsIG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgZmlsZSBhdCBwYXRoICdcIiArIHBhdGggKyBcIidcIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gZmlsZU1hbmFnZXIuZGlzcGxheU5hbWVBdFBhdGgocGF0aCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhdGg6IHBhdGgsXG4gICAgICAgICAgICAgICAgbmFtZTogZmlsZU5hbWUsXG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiB0aGlzLmdldEZpbGVFeHRlbnNpb24ocGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGb2xkZXIgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgICAgIHZhciBleGlzdHMgPSB0aGlzLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZU1hbmFnZXIuY3JlYXRlRGlyZWN0b3J5QXRQYXRoV2l0aEludGVybWVkaWF0ZURpcmVjdG9yaWVzQXR0cmlidXRlc0Vycm9yKHBhdGgsIHRydWUsIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGlyTmFtZSA9IGZpbGVNYW5hZ2VyLmRpc3BsYXlOYW1lQXRQYXRoKHBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgICAgIG5hbWU6IGRpck5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEV4aXN0aW5nRm9sZGVyID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gdGhpcy5mb2xkZXJFeGlzdHMocGF0aCk7XG4gICAgICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpck5hbWUgPSBmaWxlTWFuYWdlci5kaXNwbGF5TmFtZUF0UGF0aChwYXRoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBkaXJOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGdldCBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVhY2hFbnRpdHkgPSBmdW5jdGlvbiAocGF0aCwgb25FbnRpdHksIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKCFvbkVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW51bUVudGl0aWVzKHBhdGgsIG9uRW50aXR5LCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEVudGl0aWVzID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVJbmZvcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgb25FbnRpdHkgPSBmdW5jdGlvbiAoZW50aXR5KSB7XG4gICAgICAgICAgICBmaWxlSW5mb3MucHVzaChlbnRpdHkpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBlcnJvck9jY3VycmVkO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVycm9yT2NjdXJyZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVudW1FbnRpdGllcyhwYXRoLCBvbkVudGl0eSwgbG9jYWxFcnJvcik7XG4gICAgICAgIGlmICghZXJyb3JPY2N1cnJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVJbmZvcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmZpbGVFeGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5leGlzdHMocGF0aCk7XG4gICAgICAgIHJldHVybiByZXN1bHQuZXhpc3RzO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZm9sZGVyRXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuZXhpc3RzKHBhdGgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0LmV4aXN0cyAmJiByZXN1bHQuaXNEaXJlY3Rvcnk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5leGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgaXNEaXJlY3RvcnkgPSBuZXcgaW50ZXJvcC5SZWZlcmVuY2UoaW50ZXJvcC50eXBlcy5ib29sLCBmYWxzZSk7XG4gICAgICAgIHZhciBleGlzdHMgPSBmaWxlTWFuYWdlci5maWxlRXhpc3RzQXRQYXRoSXNEaXJlY3RvcnkocGF0aCwgaXNEaXJlY3RvcnkpO1xuICAgICAgICByZXR1cm4geyBleGlzdHM6IGV4aXN0cywgaXNEaXJlY3Rvcnk6IGlzRGlyZWN0b3J5LnZhbHVlIH07XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5jb25jYXRQYXRoID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIHJldHVybiBOU1N0cmluZy5wYXRoV2l0aENvbXBvbmVudHMoW2xlZnQsIHJpZ2h0XSkudG9TdHJpbmcoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmRlbGV0ZUZpbGUgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0aGlzLmRlbGV0ZUVudGl0eShwYXRoLCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmRlbGV0ZUZvbGRlciA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuZGVsZXRlRW50aXR5KHBhdGgsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZW1wdHlGb2xkZXIgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgZW50aXRpZXMgPSB0aGlzLmdldEVudGl0aWVzKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWVudGl0aWVzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbnRpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmaWxlTWFuYWdlci5yZW1vdmVJdGVtQXRQYXRoRXJyb3IoZW50aXRpZXNbaV0ucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBlbXB0eSBmb2xkZXIgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLnJlbmFtZSA9IGZ1bmN0aW9uIChwYXRoLCBuZXdQYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaWxlTWFuYWdlci5tb3ZlSXRlbUF0UGF0aFRvUGF0aEVycm9yKHBhdGgsIG5ld1BhdGgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byByZW5hbWUgJ1wiICsgcGF0aCArIFwiJyB0byAnXCIgKyBuZXdQYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldExvZ2ljYWxSb290UGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1haW5CdW5kbGVQYXRoID0gTlNCdW5kbGUubWFpbkJ1bmRsZS5idW5kbGVQYXRoO1xuICAgICAgICB2YXIgcmVzb2x2ZWRQYXRoID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhtYWluQnVuZGxlUGF0aCkuc3RyaW5nQnlSZXNvbHZpbmdTeW1saW5rc0luUGF0aDtcbiAgICAgICAgcmV0dXJuIHJlc29sdmVkUGF0aDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldERvY3VtZW50c0ZvbGRlclBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEtub3duUGF0aCg5KTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldFRlbXBGb2xkZXJQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRLbm93blBhdGgoMTMpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0Q3VycmVudEFwcFBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmlvcy5nZXRDdXJyZW50QXBwUGF0aCgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2RpbmcgfHwgdGV4dF8xLmVuY29kaW5nLlVURl84O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcihwYXRoLCBhY3R1YWxFbmNvZGluZyk7XG4gICAgICAgICAgICByZXR1cm4gbnNTdHJpbmcudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVhZCBmaWxlIGF0IHBhdGggJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBOU0RhdGEuZGF0YVdpdGhDb250ZW50c09mRmlsZShwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVhZCBmaWxlIGF0IHBhdGggJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS53cml0ZVRleHQgPSBmdW5jdGlvbiAocGF0aCwgY29udGVudCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhjb250ZW50KTtcbiAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2RpbmcgfHwgdGV4dF8xLmVuY29kaW5nLlVURl84O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbnNTdHJpbmcud3JpdGVUb0ZpbGVBdG9taWNhbGx5RW5jb2RpbmdFcnJvcihwYXRoLCBmYWxzZSwgYWN0dWFsRW5jb2RpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byB3cml0ZSB0byBmaWxlICdcIiArIHBhdGggKyBcIic6IFwiICsgZXgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAocGF0aCwgY29udGVudCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29udGVudC53cml0ZVRvRmlsZUF0b21pY2FsbHkocGF0aCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIHdyaXRlIHRvIGZpbGUgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRLbm93blBhdGggPSBmdW5jdGlvbiAoZm9sZGVyVHlwZSkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgcGF0aHMgPSBmaWxlTWFuYWdlci5VUkxzRm9yRGlyZWN0b3J5SW5Eb21haW5zKGZvbGRlclR5cGUsIDEpO1xuICAgICAgICB2YXIgdXJsID0gcGF0aHMub2JqZWN0QXRJbmRleCgwKTtcbiAgICAgICAgcmV0dXJuIHVybC5wYXRoO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZUV4dGVuc2lvbiA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBkb3RJbmRleCA9IHBhdGgubGFzdEluZGV4T2YoXCIuXCIpO1xuICAgICAgICBpZiAoZG90SW5kZXggJiYgZG90SW5kZXggPj0gMCAmJiBkb3RJbmRleCA8IHBhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGF0aC5zdWJzdHJpbmcoZG90SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZGVsZXRlRW50aXR5ID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGVNYW5hZ2VyLnJlbW92ZUl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZGVsZXRlIGZpbGUgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVudW1FbnRpdGllcyA9IGZ1bmN0aW9uIChwYXRoLCBjYWxsYmFjaywgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgICAgIHZhciBmaWxlcyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZmlsZXMgPSBmaWxlTWFuYWdlci5jb250ZW50c09mRGlyZWN0b3J5QXRQYXRoRXJyb3IocGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBlbnVtIGZpbGVzIGZvciBmb2xkZXIgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzLmNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGZpbGVzLm9iamVjdEF0SW5kZXgoaSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHRoaXMuY29uY2F0UGF0aChwYXRoLCBmaWxlKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiBcIlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZm9sZGVyRXhpc3RzKHRoaXMuam9pblBhdGgocGF0aCwgZmlsZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZm8uZXh0ZW5zaW9uID0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKGluZm8ucGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXRWYWwgPSBjYWxsYmFjayhpbmZvKTtcbiAgICAgICAgICAgICAgICBpZiAocmV0VmFsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRQYXRoU2VwYXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCIvXCI7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5ub3JtYWxpemVQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhwYXRoKTtcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSBuc1N0cmluZy5zdHJpbmdCeVN0YW5kYXJkaXppbmdQYXRoO1xuICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmpvaW5QYXRoID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIHZhciBuc1N0cmluZyA9IE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcobGVmdCk7XG4gICAgICAgIHJldHVybiBuc1N0cmluZy5zdHJpbmdCeUFwcGVuZGluZ1BhdGhDb21wb25lbnQocmlnaHQpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuam9pblBhdGhzID0gZnVuY3Rpb24gKHBhdGhzKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmlvcy5qb2luUGF0aHMuYXBwbHkodXRpbHNfMS5pb3MsIHBhdGhzKTtcbiAgICB9O1xuICAgIHJldHVybiBGaWxlU3lzdGVtQWNjZXNzO1xufSgpKTtcbmV4cG9ydHMuRmlsZVN5c3RlbUFjY2VzcyA9IEZpbGVTeXN0ZW1BY2Nlc3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWxlLXN5c3RlbS1hY2Nlc3MuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmaWxlX3N5c3RlbV9hY2Nlc3NfMSA9IHJlcXVpcmUoXCIuL2ZpbGUtc3lzdGVtLWFjY2Vzc1wiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi9wcm9maWxpbmdcIik7XG52YXIgZmlsZUFjY2VzcztcbmZ1bmN0aW9uIGdldEZpbGVBY2Nlc3MoKSB7XG4gICAgaWYgKCFmaWxlQWNjZXNzKSB7XG4gICAgICAgIGZpbGVBY2Nlc3MgPSBuZXcgZmlsZV9zeXN0ZW1fYWNjZXNzXzEuRmlsZVN5c3RlbUFjY2VzcygpO1xuICAgIH1cbiAgICByZXR1cm4gZmlsZUFjY2Vzcztcbn1cbnZhciBwbGF0Zm9ybTtcbmZ1bmN0aW9uIGVuc3VyZVBsYXRmb3JtKCkge1xuICAgIGlmICghcGxhdGZvcm0pIHtcbiAgICAgICAgcGxhdGZvcm0gPSByZXF1aXJlKFwicGxhdGZvcm1cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlRmlsZShpbmZvKSB7XG4gICAgdmFyIGZpbGUgPSBuZXcgRmlsZSgpO1xuICAgIGZpbGUuX3BhdGggPSBpbmZvLnBhdGg7XG4gICAgZmlsZS5fbmFtZSA9IGluZm8ubmFtZTtcbiAgICBmaWxlLl9leHRlbnNpb24gPSBpbmZvLmV4dGVuc2lvbjtcbiAgICByZXR1cm4gZmlsZTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUZvbGRlcihpbmZvKSB7XG4gICAgdmFyIGRvY3VtZW50cyA9IGtub3duRm9sZGVycy5kb2N1bWVudHMoKTtcbiAgICBpZiAoaW5mby5wYXRoID09PSBkb2N1bWVudHMucGF0aCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRzO1xuICAgIH1cbiAgICB2YXIgdGVtcCA9IGtub3duRm9sZGVycy50ZW1wKCk7XG4gICAgaWYgKGluZm8ucGF0aCA9PT0gdGVtcC5wYXRoKSB7XG4gICAgICAgIHJldHVybiB0ZW1wO1xuICAgIH1cbiAgICB2YXIgZm9sZGVyID0gbmV3IEZvbGRlcigpO1xuICAgIGZvbGRlci5fcGF0aCA9IGluZm8ucGF0aDtcbiAgICBmb2xkZXIuX25hbWUgPSBpbmZvLm5hbWU7XG4gICAgcmV0dXJuIGZvbGRlcjtcbn1cbnZhciBGaWxlU3lzdGVtRW50aXR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlU3lzdGVtRW50aXR5KCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwicGFyZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBmb2xkZXJJbmZvID0gZ2V0RmlsZUFjY2VzcygpLmdldFBhcmVudCh0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVTeW5jKGxvY2FsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW1vdmVTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzS25vd24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiQ2Fubm90IGRlbGV0ZSBrbm93biBmb2xkZXIuXCIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgICAgZmlsZUFjY2Vzcy5kZWxldGVGaWxlKHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcyBpbnN0YW5jZW9mIEZvbGRlcikge1xuICAgICAgICAgICAgZmlsZUFjY2Vzcy5kZWxldGVGb2xkZXIodGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUucmVuYW1lID0gZnVuY3Rpb24gKG5ld05hbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5yZW5hbWVTeW5jKG5ld05hbWUsIGxvY2FsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW5hbWVTeW5jID0gZnVuY3Rpb24gKG5ld05hbWUsIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzS25vd24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJDYW5ub3QgcmVuYW1lIGtub3duIGZvbGRlci5cIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnRGb2xkZXIgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJObyBwYXJlbnQgZm9sZGVyLlwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHZhciBwYXRoID0gcGFyZW50Rm9sZGVyLnBhdGg7XG4gICAgICAgIHZhciBuZXdQYXRoID0gZmlsZUFjY2Vzcy5qb2luUGF0aChwYXRoLCBuZXdOYW1lKTtcbiAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZUFjY2Vzcy5yZW5hbWUodGhpcy5wYXRoLCBuZXdQYXRoLCBsb2NhbEVycm9yKTtcbiAgICAgICAgdGhpcy5fcGF0aCA9IG5ld1BhdGg7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuZXdOYW1lO1xuICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2V4dGVuc2lvbiA9IGZpbGVBY2Nlc3MuZ2V0RmlsZUV4dGVuc2lvbihuZXdQYXRoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwicGF0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhdGg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZSwgXCJsYXN0TW9kaWZpZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX2xhc3RNb2RpZmllZDtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbGFzdE1vZGlmaWVkKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl9sYXN0TW9kaWZpZWQgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0TGFzdE1vZGlmaWVkKHRoaXMucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBGaWxlU3lzdGVtRW50aXR5O1xufSgpKTtcbmV4cG9ydHMuRmlsZVN5c3RlbUVudGl0eSA9IEZpbGVTeXN0ZW1FbnRpdHk7XG52YXIgRmlsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZpbGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmlsZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBGaWxlLmZyb21QYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZmlsZUluZm8gPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RmlsZShwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmaWxlSW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRmlsZShmaWxlSW5mbyk7XG4gICAgfTtcbiAgICBGaWxlLmV4aXN0cyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkuZmlsZUV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlLnByb3RvdHlwZSwgXCJleHRlbnNpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9leHRlbnNpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlLnByb3RvdHlwZSwgXCJpc0xvY2tlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5fbG9ja2VkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZS5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldEZpbGVBY2Nlc3MoKS5nZXRGaWxlU2l6ZSh0aGlzLnBhdGgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGaWxlLnByb3RvdHlwZS5yZWFkU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdGhpcy5fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhhdC5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGVudCA9IGdldEZpbGVBY2Nlc3MoKS5yZWFkKHRoaXMucGF0aCwgbG9jYWxFcnJvcik7XG4gICAgICAgIHRoaXMuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLndyaXRlU3luYyA9IGZ1bmN0aW9uIChjb250ZW50LCBvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGhhdF8xID0gdGhpcztcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhhdF8xLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZ2V0RmlsZUFjY2VzcygpLndyaXRlKHRoaXMucGF0aCwgY29udGVudCwgbG9jYWxFcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IF90aGlzLnJlYWRUZXh0U3luYyhsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShjb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS5yZWFkVGV4dFN5bmMgPSBmdW5jdGlvbiAob25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdGhpcy5jaGVja0FjY2VzcygpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aGF0Ll9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjb250ZW50ID0gZ2V0RmlsZUFjY2VzcygpLnJlYWRUZXh0KHRoaXMucGF0aCwgbG9jYWxFcnJvciwgZW5jb2RpbmcpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS53cml0ZVRleHQgPSBmdW5jdGlvbiAoY29udGVudCwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy53cml0ZVRleHRTeW5jKGNvbnRlbnQsIGxvY2FsRXJyb3IsIGVuY29kaW5nKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUud3JpdGVUZXh0U3luYyA9IGZ1bmN0aW9uIChjb250ZW50LCBvbkVycm9yLCBlbmNvZGluZykge1xuICAgICAgICB0aGlzLmNoZWNrQWNjZXNzKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHRoYXRfMiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoYXRfMi5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdldEZpbGVBY2Nlc3MoKS53cml0ZVRleHQodGhpcy5wYXRoLCBjb250ZW50LCBsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUuY2hlY2tBY2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgYWNjZXNzIGEgbG9ja2VkIGZpbGUuXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZpbGUucHJvdG90eXBlLCBcInJlYWRUZXh0U3luY1wiLCBudWxsKTtcbiAgICByZXR1cm4gRmlsZTtcbn0oRmlsZVN5c3RlbUVudGl0eSkpO1xuZXhwb3J0cy5GaWxlID0gRmlsZTtcbnZhciBGb2xkZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGb2xkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRm9sZGVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZvbGRlci5mcm9tUGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZvbGRlckluZm8gPSBnZXRGaWxlQWNjZXNzKCkuZ2V0Rm9sZGVyKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZvbGRlckluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKTtcbiAgICB9O1xuICAgIEZvbGRlci5leGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gZ2V0RmlsZUFjY2VzcygpLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHRoaXMucGF0aCwgbmFtZSk7XG4gICAgICAgIGlmIChmaWxlQWNjZXNzLmZpbGVFeGlzdHMocGF0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlQWNjZXNzLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMuY2xlYXJTeW5jKG9uRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmNsZWFyU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIGdldEZpbGVBY2Nlc3MoKS5lbXB0eUZvbGRlcih0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvbGRlci5wcm90b3R5cGUsIFwiaXNLbm93blwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzS25vd247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZvbGRlci5wcm90b3R5cGUuZ2V0RmlsZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICB2YXIgcGF0aCA9IGZpbGVBY2Nlc3Muam9pblBhdGgodGhpcy5wYXRoLCBuYW1lKTtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZmlsZUluZm8gPSBmaWxlQWNjZXNzLmdldEZpbGUocGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZmlsZUluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZpbGUoZmlsZUluZm8pO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5nZXRGb2xkZXIgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHRoaXMucGF0aCwgbmFtZSk7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZvbGRlckluZm8gPSBmaWxlQWNjZXNzLmdldEZvbGRlcihwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEVudGl0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlbnRpdGllcyA9IF90aGlzLmdldEVudGl0aWVzU3luYyhsb2NhbEVycm9yKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGVudGl0aWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEVudGl0aWVzU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIHZhciBmaWxlSW5mb3MgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RW50aXRpZXModGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmaWxlSW5mb3MpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbnRpdGllcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVJbmZvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGZpbGVJbmZvc1tpXS5leHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGNyZWF0ZUZpbGUoZmlsZUluZm9zW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGNyZWF0ZUZvbGRlcihmaWxlSW5mb3NbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50aXRpZXM7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmVhY2hFbnRpdHkgPSBmdW5jdGlvbiAob25FbnRpdHkpIHtcbiAgICAgICAgaWYgKCFvbkVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvblN1Y2Nlc3MgPSBmdW5jdGlvbiAoZmlsZUluZm8pIHtcbiAgICAgICAgICAgIHZhciBlbnRpdHk7XG4gICAgICAgICAgICBpZiAoZmlsZUluZm8uZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgZW50aXR5ID0gY3JlYXRlRmlsZShmaWxlSW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkgPSBjcmVhdGVGb2xkZXIoZmlsZUluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9uRW50aXR5KGVudGl0eSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RmlsZUFjY2VzcygpLmVhY2hFbnRpdHkodGhpcy5wYXRoLCBvblN1Y2Nlc3MsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgcmV0dXJuIEZvbGRlcjtcbn0oRmlsZVN5c3RlbUVudGl0eSkpO1xuZXhwb3J0cy5Gb2xkZXIgPSBGb2xkZXI7XG52YXIga25vd25Gb2xkZXJzO1xuKGZ1bmN0aW9uIChrbm93bkZvbGRlcnMpIHtcbiAgICB2YXIgX2RvY3VtZW50cztcbiAgICB2YXIgX3RlbXA7XG4gICAgdmFyIF9hcHA7XG4gICAgZnVuY3Rpb24gZG9jdW1lbnRzKCkge1xuICAgICAgICBpZiAoIV9kb2N1bWVudHMpIHtcbiAgICAgICAgICAgIHZhciBwYXRoXzEgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RG9jdW1lbnRzRm9sZGVyUGF0aCgpO1xuICAgICAgICAgICAgX2RvY3VtZW50cyA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF9kb2N1bWVudHMuX3BhdGggPSBwYXRoXzE7XG4gICAgICAgICAgICBfZG9jdW1lbnRzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2RvY3VtZW50cztcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLmRvY3VtZW50cyA9IGRvY3VtZW50cztcbiAgICBmdW5jdGlvbiB0ZW1wKCkge1xuICAgICAgICBpZiAoIV90ZW1wKSB7XG4gICAgICAgICAgICB2YXIgcGF0aF8yID0gZ2V0RmlsZUFjY2VzcygpLmdldFRlbXBGb2xkZXJQYXRoKCk7XG4gICAgICAgICAgICBfdGVtcCA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF90ZW1wLl9wYXRoID0gcGF0aF8yO1xuICAgICAgICAgICAgX3RlbXAuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGVtcDtcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLnRlbXAgPSB0ZW1wO1xuICAgIGZ1bmN0aW9uIGN1cnJlbnRBcHAoKSB7XG4gICAgICAgIGlmICghX2FwcCkge1xuICAgICAgICAgICAgdmFyIHBhdGhfMyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRDdXJyZW50QXBwUGF0aCgpO1xuICAgICAgICAgICAgX2FwcCA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF9hcHAuX3BhdGggPSBwYXRoXzM7XG4gICAgICAgICAgICBfYXBwLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2FwcDtcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLmN1cnJlbnRBcHAgPSBjdXJyZW50QXBwO1xuICAgIHZhciBpb3M7XG4gICAgKGZ1bmN0aW9uIChpb3MpIHtcbiAgICAgICAgZnVuY3Rpb24gX2NoZWNrUGxhdGZvcm0oa25vd25Gb2xkZXJOYW1lKSB7XG4gICAgICAgICAgICBlbnN1cmVQbGF0Zm9ybSgpO1xuICAgICAgICAgICAgaWYgKCFwbGF0Zm9ybS5pc0lPUykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBcXFwiXCIgKyBrbm93bkZvbGRlck5hbWUgKyBcIlxcXCIga25vd24gZm9sZGVyIGlzIGF2YWlsYWJsZSBvbiBpT1Mgb25seSFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9saWJyYXJ5O1xuICAgICAgICBmdW5jdGlvbiBsaWJyYXJ5KCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJsaWJyYXJ5XCIpO1xuICAgICAgICAgICAgaWYgKCFfbGlicmFyeSkge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oNSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfbGlicmFyeSA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9saWJyYXJ5Ll9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9saWJyYXJ5Ll9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2xpYnJhcnk7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmxpYnJhcnkgPSBsaWJyYXJ5O1xuICAgICAgICB2YXIgX2RldmVsb3BlcjtcbiAgICAgICAgZnVuY3Rpb24gZGV2ZWxvcGVyKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJkZXZlbG9wZXJcIik7XG4gICAgICAgICAgICBpZiAoIV9kZXZlbG9wZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDYpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2RldmVsb3BlciA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9kZXZlbG9wZXIuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX2RldmVsb3Blci5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9kZXZlbG9wZXI7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmRldmVsb3BlciA9IGRldmVsb3BlcjtcbiAgICAgICAgdmFyIF9kZXNrdG9wO1xuICAgICAgICBmdW5jdGlvbiBkZXNrdG9wKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJkZXNrdG9wXCIpO1xuICAgICAgICAgICAgaWYgKCFfZGVza3RvcCkge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTIpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2Rlc2t0b3AgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfZGVza3RvcC5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfZGVza3RvcC5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9kZXNrdG9wO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5kZXNrdG9wID0gZGVza3RvcDtcbiAgICAgICAgdmFyIF9kb3dubG9hZHM7XG4gICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkcygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwiZG93bmxvYWRzXCIpO1xuICAgICAgICAgICAgaWYgKCFfZG93bmxvYWRzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxNSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfZG93bmxvYWRzID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX2Rvd25sb2Fkcy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfZG93bmxvYWRzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2Rvd25sb2FkcztcbiAgICAgICAgfVxuICAgICAgICBpb3MuZG93bmxvYWRzID0gZG93bmxvYWRzO1xuICAgICAgICB2YXIgX21vdmllcztcbiAgICAgICAgZnVuY3Rpb24gbW92aWVzKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJtb3ZpZXNcIik7XG4gICAgICAgICAgICBpZiAoIV9tb3ZpZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDE3KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9tb3ZpZXMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfbW92aWVzLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9tb3ZpZXMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfbW92aWVzO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5tb3ZpZXMgPSBtb3ZpZXM7XG4gICAgICAgIHZhciBfbXVzaWM7XG4gICAgICAgIGZ1bmN0aW9uIG11c2ljKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJtdXNpY1wiKTtcbiAgICAgICAgICAgIGlmICghX211c2ljKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxOCk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfbXVzaWMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfbXVzaWMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX211c2ljLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX211c2ljO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5tdXNpYyA9IG11c2ljO1xuICAgICAgICB2YXIgX3BpY3R1cmVzO1xuICAgICAgICBmdW5jdGlvbiBwaWN0dXJlcygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwicGljdHVyZXNcIik7XG4gICAgICAgICAgICBpZiAoIV9waWN0dXJlcykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTkpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX3BpY3R1cmVzID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX3BpY3R1cmVzLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9waWN0dXJlcy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9waWN0dXJlcztcbiAgICAgICAgfVxuICAgICAgICBpb3MucGljdHVyZXMgPSBwaWN0dXJlcztcbiAgICAgICAgdmFyIF9zaGFyZWRQdWJsaWM7XG4gICAgICAgIGZ1bmN0aW9uIHNoYXJlZFB1YmxpYygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwic2hhcmVkUHVibGljXCIpO1xuICAgICAgICAgICAgaWYgKCFfc2hhcmVkUHVibGljKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygyMSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfc2hhcmVkUHVibGljID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX3NoYXJlZFB1YmxpYy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfc2hhcmVkUHVibGljLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX3NoYXJlZFB1YmxpYztcbiAgICAgICAgfVxuICAgICAgICBpb3Muc2hhcmVkUHVibGljID0gc2hhcmVkUHVibGljO1xuICAgICAgICBmdW5jdGlvbiBnZXRFeGlzdGluZ0ZvbGRlckluZm8ocGF0aERpcmVjdG9yeSkge1xuICAgICAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgICAgICB2YXIgZm9sZGVyUGF0aCA9IGZpbGVBY2Nlc3MuZ2V0S25vd25QYXRoKHBhdGhEaXJlY3RvcnkpO1xuICAgICAgICAgICAgdmFyIGZvbGRlckluZm8gPSBmaWxlQWNjZXNzLmdldEV4aXN0aW5nRm9sZGVyKGZvbGRlclBhdGgpO1xuICAgICAgICAgICAgaWYgKGZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBmb2xkZXI6IGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKSxcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogZm9sZGVyUGF0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSkoaW9zID0ga25vd25Gb2xkZXJzLmlvcyB8fCAoa25vd25Gb2xkZXJzLmlvcyA9IHt9KSk7XG59KShrbm93bkZvbGRlcnMgPSBleHBvcnRzLmtub3duRm9sZGVycyB8fCAoZXhwb3J0cy5rbm93bkZvbGRlcnMgPSB7fSkpO1xudmFyIHBhdGg7XG4oZnVuY3Rpb24gKHBhdGhfNCkge1xuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZShwYXRoKSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkubm9ybWFsaXplUGF0aChwYXRoKTtcbiAgICB9XG4gICAgcGF0aF80Lm5vcm1hbGl6ZSA9IG5vcm1hbGl6ZTtcbiAgICBmdW5jdGlvbiBqb2luKCkge1xuICAgICAgICB2YXIgcGF0aHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHBhdGhzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHJldHVybiBmaWxlQWNjZXNzLmpvaW5QYXRocyhwYXRocyk7XG4gICAgfVxuICAgIHBhdGhfNC5qb2luID0gam9pbjtcbiAgICBwYXRoXzQuc2VwYXJhdG9yID0gZ2V0RmlsZUFjY2VzcygpLmdldFBhdGhTZXBhcmF0b3IoKTtcbn0pKHBhdGggPSBleHBvcnRzLnBhdGggfHwgKGV4cG9ydHMucGF0aCA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWxlLXN5c3RlbS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi90cy1oZWxwZXJzXCIpO1xucmVxdWlyZShcIi4vcmVnaXN0ZXItbW9kdWxlLWhlbHBlcnNcIik7XG5nbG9iYWwubW9kdWxlTWVyZ2UgPSBmdW5jdGlvbiAoc291cmNlRXhwb3J0cywgZGVzdEV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlRXhwb3J0cykge1xuICAgICAgICBkZXN0RXhwb3J0c1trZXldID0gc291cmNlRXhwb3J0c1trZXldO1xuICAgIH1cbn07XG5nbG9iYWwuem9uZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChnbG9iYWwuem9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLnpvbmUuYmluZChjYWxsYmFjayk7XG4gICAgfVxuICAgIGlmIChnbG9iYWwuWm9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLlpvbmUuY3VycmVudC53cmFwKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaztcbiAgICB9XG59O1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGltZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInRpbWVyXCIpOyB9KTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2RpYWxvZ3NcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2RpYWxvZ3NcIik7IH0pO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwieGhyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ4aHJcIik7IH0pO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwiZmV0Y2hcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcImZldGNoXCIpOyB9KTtcbmdsb2JhbC5TeXN0ZW0gPSB7XG4gICAgaW1wb3J0OiBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGdsb2JhbC5yZXF1aXJlKHBhdGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuZnVuY3Rpb24gcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQobmFtZSwgbW9kdWxlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgbmFtZSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtID0gZ2xvYmFsLmxvYWRNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZFZhbHVlID0gbVtuYW1lXTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsIG5hbWUsIHsgdmFsdWU6IHJlc29sdmVkVmFsdWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRWYWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG59XG52YXIgc25hcHNob3RHbG9iYWxzO1xuZnVuY3Rpb24gaW5zdGFsbCgpIHtcbiAgICBpZiAoZ2xvYmFsLl9fc25hcHNob3QgfHwgZ2xvYmFsLl9fc25hcHNob3RFbmFibGVkKSB7XG4gICAgICAgIGlmICghc25hcHNob3RHbG9iYWxzKSB7XG4gICAgICAgICAgICB2YXIgdGltZXIgPSByZXF1aXJlKFwidGltZXJcIik7XG4gICAgICAgICAgICB2YXIgZGlhbG9ncyA9IHJlcXVpcmUoXCJ1aS9kaWFsb2dzXCIpO1xuICAgICAgICAgICAgdmFyIHhociA9IHJlcXVpcmUoXCJ4aHJcIik7XG4gICAgICAgICAgICB2YXIgZmV0Y2hfMSA9IHJlcXVpcmUoXCJmZXRjaFwiKTtcbiAgICAgICAgICAgIHNuYXBzaG90R2xvYmFscyA9IHNuYXBzaG90R2xvYmFscyB8fCB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dDogdGltZXIuc2V0VGltZW91dCxcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQ6IHRpbWVyLmNsZWFyVGltZW91dCxcbiAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbDogdGltZXIuc2V0SW50ZXJ2YWwsXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbDogdGltZXIuY2xlYXJJbnRlcnZhbCxcbiAgICAgICAgICAgICAgICBhbGVydDogZGlhbG9ncy5hbGVydCxcbiAgICAgICAgICAgICAgICBjb25maXJtOiBkaWFsb2dzLmNvbmZpcm0sXG4gICAgICAgICAgICAgICAgcHJvbXB0OiBkaWFsb2dzLnByb21wdCxcbiAgICAgICAgICAgICAgICBsb2dpbjogZGlhbG9ncy5sb2dpbixcbiAgICAgICAgICAgICAgICBhY3Rpb246IGRpYWxvZ3MuYWN0aW9uLFxuICAgICAgICAgICAgICAgIFhNTEh0dHBSZXF1ZXN0OiB4aHIuWE1MSHR0cFJlcXVlc3QsXG4gICAgICAgICAgICAgICAgRm9ybURhdGE6IHhoci5Gb3JtRGF0YSxcbiAgICAgICAgICAgICAgICBmZXRjaDogZmV0Y2hfMS5mZXRjaCxcbiAgICAgICAgICAgICAgICBIZWFkZXJzOiBmZXRjaF8xLkhlYWRlcnMsXG4gICAgICAgICAgICAgICAgUmVxdWVzdDogZmV0Y2hfMS5SZXF1ZXN0LFxuICAgICAgICAgICAgICAgIFJlc3BvbnNlOiBmZXRjaF8xLlJlc3BvbnNlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29uc29sZU1vZHVsZSA9IHJlcXVpcmUoXCJjb25zb2xlXCIpLkNvbnNvbGU7XG4gICAgICAgIGdsb2JhbC5jb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUgfHwgbmV3IGNvbnNvbGVNb2R1bGUoKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihnbG9iYWwsIHNuYXBzaG90R2xvYmFscyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcInNldFRpbWVvdXRcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJjbGVhclRpbWVvdXRcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJzZXRJbnRlcnZhbFwiLCBcInRpbWVyXCIpO1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcImNsZWFySW50ZXJ2YWxcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJhbGVydFwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiY29uZmlybVwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwicHJvbXB0XCIsIFwidWkvZGlhbG9nc1wiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJsb2dpblwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiYWN0aW9uXCIsIFwidWkvZGlhbG9nc1wiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJYTUxIdHRwUmVxdWVzdFwiLCBcInhoclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJGb3JtRGF0YVwiLCBcInhoclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJmZXRjaFwiLCBcImZldGNoXCIpO1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcIkhlYWRlcnNcIiwgXCJmZXRjaFwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJSZXF1ZXN0XCIsIFwiZmV0Y2hcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiUmVzcG9uc2VcIiwgXCJmZXRjaFwiKTtcbiAgICB9XG59XG5leHBvcnRzLmluc3RhbGwgPSBpbnN0YWxsO1xuaW5zdGFsbCgpO1xuZnVuY3Rpb24gRGVwcmVjYXRlZCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8xID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZGVwcmVjYXRlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZF8xLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCh0YXJnZXQgJiYgdGFyZ2V0Lm5hbWUgfHwgdGFyZ2V0KSArIFwiIGlzIGRlcHJlY2F0ZWRcIik7XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfVxufVxuZXhwb3J0cy5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmdsb2JhbC5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmZ1bmN0aW9uIEV4cGVyaW1lbnRhbCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8yID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsTWV0aG9kXzIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coKHRhcmdldCAmJiB0YXJnZXQubmFtZSB8fCB0YXJnZXQpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbn1cbmV4cG9ydHMuRXhwZXJpbWVudGFsID0gRXhwZXJpbWVudGFsO1xuZ2xvYmFsLkV4cGVyaW1lbnRhbCA9IEV4cGVyaW1lbnRhbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdsb2JhbHMuanMubWFwIiwidmFyIG1vZHVsZXMgPSBuZXcgTWFwKCk7XG52YXIgbW9kdWxlc0xvYWRlZEZvclVJID0gbmV3IFNldCgpO1xudmFyIGRlZmF1bHRFeHRlbnNpb25NYXAgPSB7XG4gICAgXCIuanNcIjogXCIuanNcIixcbiAgICBcIi50c1wiOiBcIi5qc1wiLFxuICAgIFwiLmNzc1wiOiBcIi5jc3NcIixcbiAgICBcIi5zY3NzXCI6IFwiLmNzc1wiLFxuICAgIFwiLmxlc3NcIjogXCIuY3NzXCIsXG4gICAgXCIuc2Fzc1wiOiBcIi5jc3NcIixcbiAgICBcIi54bWxcIjogXCIueG1sXCJcbn07XG5nbG9iYWwubW9kdWxlUmVzb2x2ZXJzID0gW2dsb2JhbC5yZXF1aXJlXTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uIChuYW1lLCBsb2FkZXIpIHtcbiAgICBtb2R1bGVzLnNldChuYW1lLCB7IGxvYWRlcjogbG9hZGVyLCBtb2R1bGVJZDogbmFtZSB9KTtcbn07XG5nbG9iYWwuX3VucmVnaXN0ZXJNb2R1bGUgPSBmdW5jdGlvbiBfdW5yZWdpc3Rlck1vZHVsZShuYW1lKSB7XG4gICAgbW9kdWxlcy5kZWxldGUobmFtZSk7XG59O1xuZ2xvYmFsLl9pc01vZHVsZUxvYWRlZEZvclVJID0gZnVuY3Rpb24gX2lzTW9kdWxlTG9hZGVkRm9yVUkobW9kdWxlTmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzTG9hZGVkRm9yVUkuaGFzKG1vZHVsZU5hbWUpO1xufTtcbmdsb2JhbC5yZWdpc3RlcldlYnBhY2tNb2R1bGVzID0gZnVuY3Rpb24gcmVnaXN0ZXJXZWJwYWNrTW9kdWxlcyhjb250ZXh0LCBleHRlbnNpb25NYXApIHtcbiAgICBpZiAoZXh0ZW5zaW9uTWFwID09PSB2b2lkIDApIHsgZXh0ZW5zaW9uTWFwID0ge307IH1cbiAgICBjb250ZXh0LmtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGVJZCkge1xuICAgICAgICB2YXIgZXh0RG90SW5kZXggPSBtb2R1bGVJZC5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgIHZhciBiYXNlID0gbW9kdWxlSWQuc3Vic3RyKDAsIGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIG9yaWdpbmFsRXh0ID0gbW9kdWxlSWQuc3Vic3RyKGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIHJlZ2lzdGVyRXh0ID0gZXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBkZWZhdWx0RXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBvcmlnaW5hbEV4dDtcbiAgICAgICAgdmFyIGlzU291cmNlRmlsZSA9IG9yaWdpbmFsRXh0ICE9PSByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyTmFtZSA9IGJhc2UgKyByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyV2l0aE5hbWUgPSBmdW5jdGlvbiAobmlja05hbWUpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5pY2tOYW1lLCB7XG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dChtb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpICYmIHJlZ2lzdGVyTmFtZS5lbmRzV2l0aChcIi5qc1wiKSkge1xuICAgICAgICAgICAgdmFyIGpzTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDUpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMCwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDMpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAganNOaWNrTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoanNOaWNrTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1NvdXJjZUZpbGUgfHwgIWdsb2JhbC5tb2R1bGVFeGlzdHMoanNOaWNrTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJXaXRoTmFtZShqc05pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpKSB7XG4gICAgICAgICAgICB2YXIgbW9kdWxlTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgbW9kdWxlTmlja05hbWVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZU5pY2tOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFnbG9iYWwubW9kdWxlRXhpc3RzKG1vZHVsZU5pY2tOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZWdpc3RlcldpdGhOYW1lKG1vZHVsZU5pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNTb3VyY2VGaWxlIHx8ICFnbG9iYWwubW9kdWxlRXhpc3RzKHJlZ2lzdGVyTmFtZSkpIHtcbiAgICAgICAgICAgIHJlZ2lzdGVyV2l0aE5hbWUocmVnaXN0ZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmdsb2JhbC5tb2R1bGVFeGlzdHMgPSBmdW5jdGlvbiBtb2R1bGVFeGlzdHMobmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzLmhhcyhuYW1lKTtcbn07XG5nbG9iYWwubG9hZE1vZHVsZSA9IGZ1bmN0aW9uIGxvYWRNb2R1bGUobmFtZSwgaXNVSU1vZHVsZSkge1xuICAgIGlmIChpc1VJTW9kdWxlID09PSB2b2lkIDApIHsgaXNVSU1vZHVsZSA9IGZhbHNlOyB9XG4gICAgdmFyIG1vZHVsZUluZm8gPSBtb2R1bGVzLmdldChuYW1lKTtcbiAgICBpZiAobW9kdWxlSW5mbykge1xuICAgICAgICBpZiAoaXNVSU1vZHVsZSkge1xuICAgICAgICAgICAgbW9kdWxlc0xvYWRlZEZvclVJLmFkZChtb2R1bGVJbmZvLm1vZHVsZUlkKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gbW9kdWxlSW5mby5sb2FkZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQuZW5hYmxlQXV0b0FjY2VwdCkge1xuICAgICAgICAgICAgcmVzdWx0LmVuYWJsZUF1dG9BY2NlcHQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChyZXNvbHZlcikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVzb2x2ZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5hbWUsIHsgbW9kdWxlSWQ6IG5hbWUsIGxvYWRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZ2xvYmFsLm1vZHVsZVJlc29sdmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHJlc29sdmVyID0gX2FbX2ldO1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocmVzb2x2ZXIpO1xuICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcbiAgICB9XG59O1xuZ2xvYmFsLmdldFJlZ2lzdGVyZWRNb2R1bGVzID0gZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZE1vZHVsZXMoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20obW9kdWxlcy5rZXlzKCkpO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlZ2lzdGVyLW1vZHVsZS1oZWxwZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmlmICghZ2xvYmFsLl9fZXh0ZW5kcykge1xuICAgIGdsb2JhbC5fX2V4dGVuZHMgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBmb3IgKHZhciBwIGluIGIpIHtcbiAgICAgICAgICAgIGlmIChiLmhhc093blByb3BlcnR5KHApKSB7XG4gICAgICAgICAgICAgICAgZFtwXSA9IGJbcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufVxudmFyIHRzbGliID0gcmVxdWlyZShcInRzbGliXCIpO1xuZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKHRzbGliKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICB2YXIgZm5OYW1lID0gX2FbX2ldO1xuICAgIGlmICh0eXBlb2YgdHNsaWJbZm5OYW1lXSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZm5OYW1lIGluIGdsb2JhbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZ2xvYmFsW2ZuTmFtZV0gPSB0c2xpYltmbk5hbWVdO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHMtaGVscGVycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBnZXRGaWxlbmFtZUZyb21VcmwodXJsKSB7XG4gICAgdmFyIGZzID0gcmVxdWlyZShcImZpbGUtc3lzdGVtXCIpO1xuICAgIHZhciBzbGFzaFBvcyA9IHVybC5sYXN0SW5kZXhPZihcIi9cIikgKyAxO1xuICAgIHZhciBxdWVzdGlvbk1hcmtQb3MgPSB1cmwubGFzdEluZGV4T2YoXCI/XCIpO1xuICAgIHZhciBhY3R1YWxGaWxlTmFtZTtcbiAgICBpZiAocXVlc3Rpb25NYXJrUG9zICE9PSAtMSkge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MsIHF1ZXN0aW9uTWFya1Bvcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5kb2N1bWVudHMoKS5wYXRoLCBhY3R1YWxGaWxlTmFtZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0RmlsZW5hbWVGcm9tVXJsID0gZ2V0RmlsZW5hbWVGcm9tVXJsO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0LWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgZG9tYWluRGVidWdnZXIgPSByZXF1aXJlKFwiLi4vLi4vZGVidWdnZXIvZGVidWdnZXJcIik7XG52YXIgaHR0cF9yZXF1ZXN0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0LWNvbW1vblwiKTtcbnZhciBIdHRwUmVzcG9uc2VFbmNvZGluZztcbihmdW5jdGlvbiAoSHR0cFJlc3BvbnNlRW5jb2RpbmcpIHtcbiAgICBIdHRwUmVzcG9uc2VFbmNvZGluZ1tIdHRwUmVzcG9uc2VFbmNvZGluZ1tcIlVURjhcIl0gPSAwXSA9IFwiVVRGOFwiO1xuICAgIEh0dHBSZXNwb25zZUVuY29kaW5nW0h0dHBSZXNwb25zZUVuY29kaW5nW1wiR0JLXCJdID0gMV0gPSBcIkdCS1wiO1xufSkoSHR0cFJlc3BvbnNlRW5jb2RpbmcgPSBleHBvcnRzLkh0dHBSZXNwb25zZUVuY29kaW5nIHx8IChleHBvcnRzLkh0dHBSZXNwb25zZUVuY29kaW5nID0ge30pKTtcbnZhciBjdXJyZW50RGV2aWNlID0gVUlEZXZpY2UuY3VycmVudERldmljZTtcbnZhciBkZXZpY2UgPSBjdXJyZW50RGV2aWNlLnVzZXJJbnRlcmZhY2VJZGlvbSA9PT0gMCA/IFwiUGhvbmVcIiA6IFwiUGFkXCI7XG52YXIgb3NWZXJzaW9uID0gY3VycmVudERldmljZS5zeXN0ZW1WZXJzaW9uO1xudmFyIEdFVCA9IFwiR0VUXCI7XG52YXIgVVNFUl9BR0VOVF9IRUFERVIgPSBcIlVzZXItQWdlbnRcIjtcbnZhciBVU0VSX0FHRU5UID0gXCJNb3ppbGxhLzUuMCAoaVwiICsgZGV2aWNlICsgXCI7IENQVSBPUyBcIiArIG9zVmVyc2lvbi5yZXBsYWNlKFwiLlwiLCBcIl9cIikgKyBcIiBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC81MzYuMjYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uL1wiICsgb3NWZXJzaW9uICsgXCIgTW9iaWxlLzEwQTUzNTVkIFNhZmFyaS84NTM2LjI1XCI7XG52YXIgc2Vzc2lvbkNvbmZpZyA9IE5TVVJMU2Vzc2lvbkNvbmZpZ3VyYXRpb24uZGVmYXVsdFNlc3Npb25Db25maWd1cmF0aW9uO1xudmFyIHF1ZXVlID0gTlNPcGVyYXRpb25RdWV1ZS5tYWluUXVldWU7XG5mdW5jdGlvbiBwYXJzZUpTT04oc291cmNlKSB7XG4gICAgdmFyIHNyYyA9IHNvdXJjZS50cmltKCk7XG4gICAgaWYgKHNyYy5sYXN0SW5kZXhPZihcIilcIikgPT09IHNyYy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHNyYy5zdWJzdHJpbmcoc3JjLmluZGV4T2YoXCIoXCIpICsgMSwgc3JjLmxhc3RJbmRleE9mKFwiKVwiKSkpO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShzcmMpO1xufVxudmFyIE5TVVJMU2Vzc2lvblRhc2tEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE5TVVJMU2Vzc2lvblRhc2tEZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlSW1wbC5wcm90b3R5cGUuVVJMU2Vzc2lvblRhc2tXaWxsUGVyZm9ybUhUVFBSZWRpcmVjdGlvbk5ld1JlcXVlc3RDb21wbGV0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIChzZXNzaW9uLCB0YXNrLCByZXNwb25zZSwgcmVxdWVzdCwgY29tcGxldGlvbkhhbmRsZXIpIHtcbiAgICAgICAgY29tcGxldGlvbkhhbmRsZXIobnVsbCk7XG4gICAgfTtcbiAgICBOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlXTtcbiAgICByZXR1cm4gTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbnZhciBzZXNzaW9uVGFza0RlbGVnYXRlSW5zdGFuY2UgPSBOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLm5ldygpO1xudmFyIGRlZmF1bHRTZXNzaW9uO1xuZnVuY3Rpb24gZW5zdXJlRGVmYXVsdFNlc3Npb24oKSB7XG4gICAgaWYgKCFkZWZhdWx0U2Vzc2lvbikge1xuICAgICAgICBkZWZhdWx0U2Vzc2lvbiA9IE5TVVJMU2Vzc2lvbi5zZXNzaW9uV2l0aENvbmZpZ3VyYXRpb25EZWxlZ2F0ZURlbGVnYXRlUXVldWUoc2Vzc2lvbkNvbmZpZywgbnVsbCwgcXVldWUpO1xuICAgIH1cbn1cbnZhciBzZXNzaW9uTm90Rm9sbG93aW5nUmVkaXJlY3RzO1xuZnVuY3Rpb24gZW5zdXJlU2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cygpIHtcbiAgICBpZiAoIXNlc3Npb25Ob3RGb2xsb3dpbmdSZWRpcmVjdHMpIHtcbiAgICAgICAgc2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cyA9IE5TVVJMU2Vzc2lvbi5zZXNzaW9uV2l0aENvbmZpZ3VyYXRpb25EZWxlZ2F0ZURlbGVnYXRlUXVldWUoc2Vzc2lvbkNvbmZpZywgc2Vzc2lvblRhc2tEZWxlZ2F0ZUluc3RhbmNlLCBxdWV1ZSk7XG4gICAgfVxufVxudmFyIGltYWdlU291cmNlO1xuZnVuY3Rpb24gZW5zdXJlSW1hZ2VTb3VyY2UoKSB7XG4gICAgaWYgKCFpbWFnZVNvdXJjZSkge1xuICAgICAgICBpbWFnZVNvdXJjZSA9IHJlcXVpcmUoXCJpbWFnZS1zb3VyY2VcIik7XG4gICAgfVxufVxudmFyIGZzO1xuZnVuY3Rpb24gZW5zdXJlRmlsZVN5c3RlbSgpIHtcbiAgICBpZiAoIWZzKSB7XG4gICAgICAgIGZzID0gcmVxdWlyZShcImZpbGUtc3lzdGVtXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGlmICghb3B0aW9ucy51cmwpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJSZXF1ZXN0IHVybCB3YXMgZW1wdHkuXCIpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG5ldHdvcmsgPSBkb21haW5EZWJ1Z2dlci5nZXROZXR3b3JrKCk7XG4gICAgICAgICAgICB2YXIgZGVidWdSZXF1ZXN0XzEgPSBuZXR3b3JrICYmIG5ldHdvcmsuY3JlYXRlKCk7XG4gICAgICAgICAgICB2YXIgdXJsUmVxdWVzdCA9IE5TTXV0YWJsZVVSTFJlcXVlc3QucmVxdWVzdFdpdGhVUkwoTlNVUkwuVVJMV2l0aFN0cmluZyhvcHRpb25zLnVybCkpO1xuICAgICAgICAgICAgdXJsUmVxdWVzdC5IVFRQTWV0aG9kID0gdHlwZXMuaXNEZWZpbmVkKG9wdGlvbnMubWV0aG9kKSA/IG9wdGlvbnMubWV0aG9kIDogR0VUO1xuICAgICAgICAgICAgdXJsUmVxdWVzdC5zZXRWYWx1ZUZvckhUVFBIZWFkZXJGaWVsZChVU0VSX0FHRU5ULCBVU0VSX0FHRU5UX0hFQURFUik7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaGVhZGVyIGluIG9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICB1cmxSZXF1ZXN0LnNldFZhbHVlRm9ySFRUUEhlYWRlckZpZWxkKG9wdGlvbnMuaGVhZGVyc1toZWFkZXJdICsgXCJcIiwgaGVhZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcob3B0aW9ucy5jb250ZW50KSB8fCBvcHRpb25zLmNvbnRlbnQgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgIHVybFJlcXVlc3QuSFRUUEJvZHkgPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKG9wdGlvbnMuY29udGVudC50b1N0cmluZygpKS5kYXRhVXNpbmdFbmNvZGluZyg0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlcy5pc051bWJlcihvcHRpb25zLnRpbWVvdXQpKSB7XG4gICAgICAgICAgICAgICAgdXJsUmVxdWVzdC50aW1lb3V0SW50ZXJ2YWwgPSBvcHRpb25zLnRpbWVvdXQgLyAxMDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlc3Npb24gPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNCb29sZWFuKG9wdGlvbnMuZG9udEZvbGxvd1JlZGlyZWN0cykgJiYgb3B0aW9ucy5kb250Rm9sbG93UmVkaXJlY3RzKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlU2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cygpO1xuICAgICAgICAgICAgICAgIHNlc3Npb24gPSBzZXNzaW9uTm90Rm9sbG93aW5nUmVkaXJlY3RzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlRGVmYXVsdFNlc3Npb24oKTtcbiAgICAgICAgICAgICAgICBzZXNzaW9uID0gZGVmYXVsdFNlc3Npb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGF0YVRhc2sgPSBzZXNzaW9uLmRhdGFUYXNrV2l0aFJlcXVlc3RDb21wbGV0aW9uSGFuZGxlcih1cmxSZXF1ZXN0LCBmdW5jdGlvbiAoZGF0YSwgcmVzcG9uc2UsIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmFsbEhlYWRlckZpZWxkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckZpZWxkcyA9IHJlc3BvbnNlLmFsbEhlYWRlckZpZWxkcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlckZpZWxkcy5lbnVtZXJhdGVLZXlzQW5kT2JqZWN0c1VzaW5nQmxvY2soZnVuY3Rpb24gKGtleSwgdmFsdWUsIHN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRIZWFkZXIoaGVhZGVyc18xLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWJ1Z1JlcXVlc3RfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdSZXF1ZXN0XzEubWltZVR5cGUgPSByZXNwb25zZS5NSU1FVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnUmVxdWVzdF8xLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlYnVnUmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBvcHRpb25zLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogTlNIVFRQVVJMUmVzcG9uc2UubG9jYWxpemVkU3RyaW5nRm9yU3RhdHVzQ29kZShyZXNwb25zZS5zdGF0dXNDb2RlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXzEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IHJlc3BvbnNlLk1JTUVUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21EaXNrQ2FjaGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdSZXF1ZXN0XzEucmVzcG9uc2VSZWNlaXZlZChkZWJ1Z1Jlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnUmVxdWVzdF8xLmxvYWRpbmdGaW5pc2hlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdzogZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gKGVuY29kaW5nKSB7IHJldHVybiBOU0RhdGFUb1N0cmluZyhkYXRhLCBlbmNvZGluZyk7IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9KU09OOiBmdW5jdGlvbiAoZW5jb2RpbmcpIHsgcmV0dXJuIHBhcnNlSlNPTihOU0RhdGFUb1N0cmluZyhkYXRhLCBlbmNvZGluZykpOyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvSW1hZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5zdXJlSW1hZ2VTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2l0aERhdGFDb21wbGV0aW9uKGRhdGEsIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGltYWdlU291cmNlLmZyb21OYXRpdmVTb3VyY2UoaW1hZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJSZXNwb25zZSBjb250ZW50IG1heSBub3QgYmUgY29udmVydGVkIHRvIGFuIEltYWdlXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0ZpbGU6IGZ1bmN0aW9uIChkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuc3VyZUZpbGVTeXN0ZW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZpbGVQYXRoID0gaHR0cF9yZXF1ZXN0X2NvbW1vbl8xLmdldEZpbGVuYW1lRnJvbVVybChvcHRpb25zLnVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBOU0RhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZnMuRmlsZS5mcm9tUGF0aChkZXN0aW5hdGlvbkZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEud3JpdGVUb0ZpbGVBdG9taWNhbGx5KGRlc3RpbmF0aW9uRmlsZVBhdGgsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQ2Fubm90IHNhdmUgZmlsZSB3aXRoIHBhdGg6IFwiICsgZGVzdGluYXRpb25GaWxlUGF0aCArIFwiLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNfMVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnVybCAmJiBkZWJ1Z1JlcXVlc3RfMSkge1xuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0XzEgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkZWJ1Z1JlcXVlc3RfMS5yZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0XzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YVRhc2sucmVzdW1lKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnJlcXVlc3QgPSByZXF1ZXN0O1xuZnVuY3Rpb24gTlNEYXRhVG9TdHJpbmcoZGF0YSwgZW5jb2RpbmcpIHtcbiAgICB2YXIgY29kZSA9IE5TVVRGOFN0cmluZ0VuY29kaW5nO1xuICAgIGlmIChlbmNvZGluZyA9PT0gSHR0cFJlc3BvbnNlRW5jb2RpbmcuR0JLKSB7XG4gICAgICAgIGNvZGUgPSAxNTg2O1xuICAgIH1cbiAgICB2YXIgZW5jb2RlZFN0cmluZyA9IE5TU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhEYXRhRW5jb2RpbmcoZGF0YSwgY29kZSk7XG4gICAgaWYgKCFlbmNvZGVkU3RyaW5nKSB7XG4gICAgICAgIGNvZGUgPSBOU0lTT0xhdGluMVN0cmluZ0VuY29kaW5nO1xuICAgICAgICBlbmNvZGVkU3RyaW5nID0gTlNTdHJpbmcuYWxsb2MoKS5pbml0V2l0aERhdGFFbmNvZGluZyhkYXRhLCBjb2RlKTtcbiAgICB9XG4gICAgcmV0dXJuIGVuY29kZWRTdHJpbmcudG9TdHJpbmcoKTtcbn1cbmZ1bmN0aW9uIGFkZEhlYWRlcihoZWFkZXJzLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKCFoZWFkZXJzW2tleV0pIHtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVyc1trZXldKSkge1xuICAgICAgICBoZWFkZXJzW2tleV0ucHVzaCh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWVzID0gW2hlYWRlcnNba2V5XV07XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWVzO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkSGVhZGVyID0gYWRkSGVhZGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0Lmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGh0dHBSZXF1ZXN0ID0gcmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0XCIpKTtcbmZ1bmN0aW9uIGdldFN0cmluZyhhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBzdHIgPSByLmNvbnRlbnQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHJlamVjdChlKTsgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldFN0cmluZyA9IGdldFN0cmluZztcbmZ1bmN0aW9uIGdldEpTT04oYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaHR0cFJlcXVlc3QucmVxdWVzdCh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8geyB1cmw6IGFyZywgbWV0aG9kOiBcIkdFVFwiIH0gOiBhcmcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIganNvbiA9IHIuY29udGVudC50b0pTT04oKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IHJldHVybiByZWplY3QoZSk7IH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRKU09OID0gZ2V0SlNPTjtcbmZ1bmN0aW9uIGdldEltYWdlKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGh0dHBSZXF1ZXN0LnJlcXVlc3QodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIiA/IHsgdXJsOiBhcmcsIG1ldGhvZDogXCJHRVRcIiB9IDogYXJnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyLmNvbnRlbnQudG9JbWFnZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRJbWFnZSA9IGdldEltYWdlO1xuZnVuY3Rpb24gZ2V0RmlsZShhcmcsIGRlc3RpbmF0aW9uRmlsZVBhdGgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gci5jb250ZW50LnRvRmlsZShkZXN0aW5hdGlvbkZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IHJldHVybiByZWplY3QoZSk7IH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRGaWxlID0gZ2V0RmlsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi9kYXRhL29ic2VydmFibGVcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybVwiKTtcbnZhciBJbWFnZUFzc2V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEltYWdlQXNzZXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEltYWdlQXNzZXRCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fb3B0aW9ucyA9IHsga2VlcEFzcGVjdFJhdGlvOiB0cnVlLCBhdXRvU2NhbGVGYWN0b3I6IHRydWUgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VBc3NldEJhc2UucHJvdG90eXBlLCBcIm9wdGlvbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW1hZ2VBc3NldEJhc2UucHJvdG90eXBlLCBcIm5hdGl2ZUltYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmF0aXZlSW1hZ2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9uYXRpdmVJbWFnZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBJbWFnZUFzc2V0QmFzZS5wcm90b3R5cGUuZ2V0SW1hZ2VBc3luYyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIH07XG4gICAgcmV0dXJuIEltYWdlQXNzZXRCYXNlO1xufShvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5JbWFnZUFzc2V0QmFzZSA9IEltYWdlQXNzZXRCYXNlO1xuZnVuY3Rpb24gZ2V0QXNwZWN0U2FmZURpbWVuc2lvbnMoc291cmNlV2lkdGgsIHNvdXJjZUhlaWdodCwgcmVxV2lkdGgsIHJlcUhlaWdodCkge1xuICAgIHZhciB3aWR0aENvZWYgPSBzb3VyY2VXaWR0aCAvIHJlcVdpZHRoO1xuICAgIHZhciBoZWlnaHRDb2VmID0gc291cmNlSGVpZ2h0IC8gcmVxSGVpZ2h0O1xuICAgIHZhciBhc3BlY3RDb2VmID0gTWF0aC5taW4od2lkdGhDb2VmLCBoZWlnaHRDb2VmKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogTWF0aC5mbG9vcihzb3VyY2VXaWR0aCAvIGFzcGVjdENvZWYpLFxuICAgICAgICBoZWlnaHQ6IE1hdGguZmxvb3Ioc291cmNlSGVpZ2h0IC8gYXNwZWN0Q29lZilcbiAgICB9O1xufVxuZXhwb3J0cy5nZXRBc3BlY3RTYWZlRGltZW5zaW9ucyA9IGdldEFzcGVjdFNhZmVEaW1lbnNpb25zO1xuZnVuY3Rpb24gZ2V0UmVxdWVzdGVkSW1hZ2VTaXplKHNyYywgb3B0aW9ucykge1xuICAgIHZhciBzY3JlZW4gPSBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuO1xuICAgIHZhciByZXFXaWR0aCA9IG9wdGlvbnMud2lkdGggfHwgTWF0aC5taW4oc3JjLndpZHRoLCBzY3JlZW4ud2lkdGhQaXhlbHMpO1xuICAgIHZhciByZXFIZWlnaHQgPSBvcHRpb25zLmhlaWdodCB8fCBNYXRoLm1pbihzcmMuaGVpZ2h0LCBzY3JlZW4uaGVpZ2h0UGl4ZWxzKTtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmtlZXBBc3BlY3RSYXRpbykge1xuICAgICAgICB2YXIgc2FmZUFzcGVjdFNpemUgPSBnZXRBc3BlY3RTYWZlRGltZW5zaW9ucyhzcmMud2lkdGgsIHNyYy5oZWlnaHQsIHJlcVdpZHRoLCByZXFIZWlnaHQpO1xuICAgICAgICByZXFXaWR0aCA9IHNhZmVBc3BlY3RTaXplLndpZHRoO1xuICAgICAgICByZXFIZWlnaHQgPSBzYWZlQXNwZWN0U2l6ZS5oZWlnaHQ7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiByZXFXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiByZXFIZWlnaHRcbiAgICB9O1xufVxuZXhwb3J0cy5nZXRSZXF1ZXN0ZWRJbWFnZVNpemUgPSBnZXRSZXF1ZXN0ZWRJbWFnZVNpemU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1hc3NldC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBpbWFnZV9hc3NldF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ltYWdlLWFzc2V0LWNvbW1vblwiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uL2ZpbGUtc3lzdGVtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vaW1hZ2UtYXNzZXQtY29tbW9uXCIpKTtcbnZhciBJbWFnZUFzc2V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW1hZ2VBc3NldCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbWFnZUFzc2V0KGFzc2V0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmICh0eXBlb2YgYXNzZXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIGlmIChhc3NldC5pbmRleE9mKFwifi9cIikgPT09IDApIHtcbiAgICAgICAgICAgICAgICBhc3NldCA9IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBhc3NldC5yZXBsYWNlKFwifi9cIiwgXCJcIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMubmF0aXZlSW1hZ2UgPSBVSUltYWdlLmltYWdlV2l0aENvbnRlbnRzT2ZGaWxlKGFzc2V0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhc3NldCBpbnN0YW5jZW9mIFVJSW1hZ2UpIHtcbiAgICAgICAgICAgIF90aGlzLm5hdGl2ZUltYWdlID0gYXNzZXQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5pb3MgPSBhc3NldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUFzc2V0LnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9pb3MgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSW1hZ2VBc3NldC5wcm90b3R5cGUuZ2V0SW1hZ2VBc3luYyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaW9zICYmICF0aGlzLm5hdGl2ZUltYWdlKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBcIkFzc2V0IGNhbm5vdCBiZSBmb3VuZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNyY1dpZHRoID0gdGhpcy5uYXRpdmVJbWFnZSA/IHRoaXMubmF0aXZlSW1hZ2Uuc2l6ZS53aWR0aCA6IHRoaXMuaW9zLnBpeGVsV2lkdGg7XG4gICAgICAgIHZhciBzcmNIZWlnaHQgPSB0aGlzLm5hdGl2ZUltYWdlID8gdGhpcy5uYXRpdmVJbWFnZS5zaXplLmhlaWdodCA6IHRoaXMuaW9zLnBpeGVsSGVpZ2h0O1xuICAgICAgICB2YXIgcmVxdWVzdGVkU2l6ZSA9IGltYWdlX2Fzc2V0X2NvbW1vbl8xLmdldFJlcXVlc3RlZEltYWdlU2l6ZSh7IHdpZHRoOiBzcmNXaWR0aCwgaGVpZ2h0OiBzcmNIZWlnaHQgfSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlSW1hZ2UpIHtcbiAgICAgICAgICAgIHZhciBuZXdTaXplID0gQ0dTaXplTWFrZShyZXF1ZXN0ZWRTaXplLndpZHRoLCByZXF1ZXN0ZWRTaXplLmhlaWdodCk7XG4gICAgICAgICAgICB2YXIgcmVzaXplZEltYWdlID0gdGhpcy5zY2FsZUltYWdlKHRoaXMubmF0aXZlSW1hZ2UsIG5ld1NpemUpO1xuICAgICAgICAgICAgY2FsbGJhY2socmVzaXplZEltYWdlLCBudWxsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1hZ2VSZXF1ZXN0T3B0aW9ucyA9IFBISW1hZ2VSZXF1ZXN0T3B0aW9ucy5hbGxvYygpLmluaXQoKTtcbiAgICAgICAgaW1hZ2VSZXF1ZXN0T3B0aW9ucy5kZWxpdmVyeU1vZGUgPSAxO1xuICAgICAgICBpbWFnZVJlcXVlc3RPcHRpb25zLm5ldHdvcmtBY2Nlc3NBbGxvd2VkID0gdHJ1ZTtcbiAgICAgICAgUEhJbWFnZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXIoKS5yZXF1ZXN0SW1hZ2VGb3JBc3NldFRhcmdldFNpemVDb250ZW50TW9kZU9wdGlvbnNSZXN1bHRIYW5kbGVyKHRoaXMuaW9zLCByZXF1ZXN0ZWRTaXplLCAwLCBpbWFnZVJlcXVlc3RPcHRpb25zLCBmdW5jdGlvbiAoaW1hZ2UsIGltYWdlUmVzdWx0SW5mbykge1xuICAgICAgICAgICAgaWYgKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdEltYWdlID0gX3RoaXMuc2NhbGVJbWFnZShpbWFnZSwgcmVxdWVzdGVkU2l6ZSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2socmVzdWx0SW1hZ2UsIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgaW1hZ2VSZXN1bHRJbmZvLnZhbHVlRm9yS2V5KFBISW1hZ2VFcnJvcktleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlQXNzZXQucHJvdG90eXBlLnNjYWxlSW1hZ2UgPSBmdW5jdGlvbiAoaW1hZ2UsIHJlcXVlc3RlZFNpemUpIHtcbiAgICAgICAgdmFyIHNjYWxlRmFjdG9yID0gdGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy5hdXRvU2NhbGVGYWN0b3IgPT09IGZhbHNlID8gMS4wIDogMC4wO1xuICAgICAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhyZXF1ZXN0ZWRTaXplLCBmYWxzZSwgc2NhbGVGYWN0b3IpO1xuICAgICAgICBpbWFnZS5kcmF3SW5SZWN0KENHUmVjdE1ha2UoMCwgMCwgcmVxdWVzdGVkU2l6ZS53aWR0aCwgcmVxdWVzdGVkU2l6ZS5oZWlnaHQpKTtcbiAgICAgICAgdmFyIHJlc3VsdEltYWdlID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICAgICAgVUlHcmFwaGljc0VuZEltYWdlQ29udGV4dCgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0SW1hZ2U7XG4gICAgfTtcbiAgICByZXR1cm4gSW1hZ2VBc3NldDtcbn0oaW1hZ2VfYXNzZXRfY29tbW9uXzEuSW1hZ2VBc3NldEJhc2UpKTtcbmV4cG9ydHMuSW1hZ2VBc3NldCA9IEltYWdlQXNzZXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1hc3NldC5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMuaXNGaWxlT3JSZXNvdXJjZVBhdGggPSB1dGlsc18xLmlzRmlsZU9yUmVzb3VyY2VQYXRoO1xudmFyIGh0dHA7XG5mdW5jdGlvbiBlbnN1cmVIdHRwKCkge1xuICAgIGlmICghaHR0cCkge1xuICAgICAgICBodHRwID0gcmVxdWlyZShcIi4uL2h0dHBcIik7XG4gICAgfVxufVxudmFyIEltYWdlU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJbWFnZVNvdXJjZSgpIHtcbiAgICB9XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmZyb21Bc3NldCA9IGZ1bmN0aW9uIChhc3NldCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgYXNzZXQuZ2V0SW1hZ2VBc3luYyhmdW5jdGlvbiAoaW1hZ2UsIGVycikge1xuICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZyb21OYXRpdmVTb3VyY2UoaW1hZ2UpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbVJlc291cmNlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdGhpcy5pb3MgPSBVSUltYWdlLnRuc19zYWZlSW1hZ2VOYW1lZChuYW1lKSB8fCBVSUltYWdlLnRuc19zYWZlSW1hZ2VOYW1lZChuYW1lICsgXCIuanBnXCIpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tUmVzb3VyY2UgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBVSUltYWdlLnRuc19zYWZlRGVjb2RlSW1hZ2VOYW1lZENvbXBsZXRpb24obmFtZSwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW9zID0gaW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgVUlJbWFnZS50bnNfc2FmZURlY29kZUltYWdlTmFtZWRDb21wbGV0aW9uKG5hbWUgKyBcIi5qcGdcIiwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW9zID0gaW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbUZpbGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB0aGlzLmlvcyA9IFVJSW1hZ2UuaW1hZ2VXaXRoQ29udGVudHNPZkZpbGUoZ2V0RmlsZU5hbWUocGF0aCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRmlsZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2lkdGhDb250ZW50c09mRmlsZUNvbXBsZXRpb24oZ2V0RmlsZU5hbWUocGF0aCksIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pb3MgPSBpbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuaW9zID0gVUlJbWFnZS5pbWFnZVdpdGhEYXRhKGRhdGEpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2l0aERhdGFDb21wbGV0aW9uKGRhdGEsIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pb3MgPSBpbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tQmFzZTY0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBpZiAodHlwZW9mIHNvdXJjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBOU0RhdGEuYWxsb2MoKS5pbml0V2l0aEJhc2U2NEVuY29kZWRTdHJpbmdPcHRpb25zKHNvdXJjZSwgMSk7XG4gICAgICAgICAgICB0aGlzLmlvcyA9IFVJSW1hZ2UuaW1hZ2VXaXRoRGF0YShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tQmFzZTY0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IE5TRGF0YS5hbGxvYygpLmluaXRXaXRoQmFzZTY0RW5jb2RlZFN0cmluZ09wdGlvbnMoc291cmNlLCAxKTtcbiAgICAgICAgICAgICAgICBVSUltYWdlLmltYWdlV2l0aERhdGFbXCJhc3luY1wiXShVSUltYWdlLCBbZGF0YV0pLnRoZW4oZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlvcyA9IGltYWdlO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUubG9hZEZyb21Gb250SWNvbkNvZGUgPSBmdW5jdGlvbiAoc291cmNlLCBmb250LCBjb2xvcikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBmb250U2l6ZSA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZvbnQuZm9udFNpemUpO1xuICAgICAgICBpZiAoIWZvbnRTaXplKSB7XG4gICAgICAgICAgICBmb250U2l6ZSA9IFVJRm9udC5sYWJlbEZvbnRTaXplO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZW5zaXR5ID0gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgdmFyIHNjYWxlZEZvbnRTaXplID0gZm9udFNpemUgKiBkZW5zaXR5O1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IChfYSA9IHt9LFxuICAgICAgICAgICAgX2FbTlNGb250QXR0cmlidXRlTmFtZV0gPSBmb250LmdldFVJRm9udChVSUZvbnQuc3lzdGVtRm9udE9mU2l6ZShzY2FsZWRGb250U2l6ZSkpLFxuICAgICAgICAgICAgX2EpO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXNbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGNvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXR0cmlidXRlZFN0cmluZyA9IE5TQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXRXaXRoU3RyaW5nQXR0cmlidXRlcyhzb3VyY2UsIGF0dHJpYnV0ZXMpO1xuICAgICAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhhdHRyaWJ1dGVkU3RyaW5nLnNpemUoKSwgZmFsc2UsIDAuMCk7XG4gICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcuZHJhd0F0UG9pbnQoQ0dQb2ludE1ha2UoMCwgMCkpO1xuICAgICAgICB2YXIgaWNvbkltYWdlID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICAgICAgVUlHcmFwaGljc0VuZEltYWdlQ29udGV4dCgpO1xuICAgICAgICB0aGlzLmlvcyA9IGljb25JbWFnZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW9zICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuc2V0TmF0aXZlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBpZiAoc291cmNlICYmICEoc291cmNlIGluc3RhbmNlb2YgVUlJbWFnZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBtZXRob2Qgc2V0TmF0aXZlU291cmNlKCkgZXhwZWN0cyBVSUltYWdlIGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlvcyA9IHNvdXJjZTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5zYXZlVG9GaWxlID0gZnVuY3Rpb24gKHBhdGgsIGZvcm1hdCwgcXVhbGl0eSkge1xuICAgICAgICBpZiAoIXRoaXMuaW9zKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHF1YWxpdHkpIHtcbiAgICAgICAgICAgIHF1YWxpdHkgPSAocXVhbGl0eSAtIDApIC8gKDEwMCAtIDApO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhID0gZ2V0SW1hZ2VEYXRhKHRoaXMuaW9zLCBmb3JtYXQsIHF1YWxpdHkpO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXIuY3JlYXRlRmlsZUF0UGF0aENvbnRlbnRzQXR0cmlidXRlcyhwYXRoLCBkYXRhLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUudG9CYXNlNjRTdHJpbmcgPSBmdW5jdGlvbiAoZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgICAgIHZhciByZXMgPSBudWxsO1xuICAgICAgICBpZiAoIXRoaXMuaW9zKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChxdWFsaXR5KSB7XG4gICAgICAgICAgICBxdWFsaXR5ID0gKHF1YWxpdHkgLSAwKSAvICgxMDAgLSAwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IGdldEltYWdlRGF0YSh0aGlzLmlvcywgZm9ybWF0LCBxdWFsaXR5KTtcbiAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgIHJlcyA9IGRhdGEuYmFzZTY0RW5jb2RpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlvcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5zaXplLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBOYU47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZVNvdXJjZS5wcm90b3R5cGUsIFwid2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlvcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5zaXplLndpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJyb3RhdGlvbkFuZ2xlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gTmFOO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChfdmFsdWUpIHtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEltYWdlU291cmNlO1xufSgpKTtcbmV4cG9ydHMuSW1hZ2VTb3VyY2UgPSBJbWFnZVNvdXJjZTtcbmZ1bmN0aW9uIGdldEZpbGVOYW1lKHBhdGgpIHtcbiAgICB2YXIgZmlsZU5hbWUgPSB0eXBlb2YgcGF0aCA9PT0gXCJzdHJpbmdcIiA/IHBhdGgudHJpbSgpIDogXCJcIjtcbiAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgIGZpbGVOYW1lID0gZmlsZV9zeXN0ZW1fMS5wYXRoLmpvaW4oZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIGZpbGVOYW1lLnJlcGxhY2UoXCJ+L1wiLCBcIlwiKSk7XG4gICAgfVxuICAgIHJldHVybiBmaWxlTmFtZTtcbn1cbmZ1bmN0aW9uIGdldEltYWdlRGF0YShpbnN0YW5jZSwgZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgaWYgKHF1YWxpdHkgPT09IHZvaWQgMCkgeyBxdWFsaXR5ID0gMC45OyB9XG4gICAgdmFyIGRhdGEgPSBudWxsO1xuICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICAgIGNhc2UgXCJwbmdcIjpcbiAgICAgICAgICAgIGRhdGEgPSBVSUltYWdlUE5HUmVwcmVzZW50YXRpb24oaW5zdGFuY2UpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJqcGVnXCI6XG4gICAgICAgIGNhc2UgXCJqcGdcIjpcbiAgICAgICAgICAgIGRhdGEgPSBVSUltYWdlSlBFR1JlcHJlc2VudGF0aW9uKGluc3RhbmNlLCBxdWFsaXR5KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cbmZ1bmN0aW9uIGZyb21Bc3NldChhc3NldCkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5mcm9tQXNzZXQoYXNzZXQpO1xufVxuZXhwb3J0cy5mcm9tQXNzZXQgPSBmcm9tQXNzZXQ7XG5mdW5jdGlvbiBmcm9tUmVzb3VyY2UobmFtZSkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbVJlc291cmNlKG5hbWUpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tUmVzb3VyY2UgPSBmcm9tUmVzb3VyY2U7XG5mdW5jdGlvbiBmcm9tRmlsZShwYXRoKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRmlsZShwYXRoKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUZpbGUgPSBmcm9tRmlsZTtcbmZ1bmN0aW9uIGZyb21Gb250SWNvbkNvZGUoc291cmNlLCBmb250LCBjb2xvcikge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbUZvbnRJY29uQ29kZShzb3VyY2UsIGZvbnQsIGNvbG9yKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUZvbnRJY29uQ29kZSA9IGZyb21Gb250SWNvbkNvZGU7XG5mdW5jdGlvbiBmcm9tRGF0YShkYXRhKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRGF0YShkYXRhKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbURhdGEgPSBmcm9tRGF0YTtcbmZ1bmN0aW9uIGZyb21CYXNlNjQoc291cmNlKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tQmFzZTY0KHNvdXJjZSkgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21CYXNlNjQgPSBmcm9tQmFzZTY0O1xuZnVuY3Rpb24gZnJvbU5hdGl2ZVNvdXJjZShzb3VyY2UpIHtcbiAgICB2YXIgaW1hZ2VTb3VyY2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICBpbWFnZVNvdXJjZS5zZXROYXRpdmVTb3VyY2Uoc291cmNlKTtcbiAgICByZXR1cm4gaW1hZ2VTb3VyY2U7XG59XG5leHBvcnRzLmZyb21OYXRpdmVTb3VyY2UgPSBmcm9tTmF0aXZlU291cmNlO1xuZnVuY3Rpb24gZnJvbVVybCh1cmwpIHtcbiAgICBlbnN1cmVIdHRwKCk7XG4gICAgcmV0dXJuIGh0dHAuZ2V0SW1hZ2UodXJsKTtcbn1cbmV4cG9ydHMuZnJvbVVybCA9IGZyb21Vcmw7XG5mdW5jdGlvbiBmcm9tRmlsZU9yUmVzb3VyY2UocGF0aCkge1xuICAgIGlmICghdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aChwYXRoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIFxcXCJcIiArIFwiXFxcIiBpcyBub3QgYSB2YWxpZCBmaWxlIG9yIHJlc291cmNlLlwiKTtcbiAgICB9XG4gICAgaWYgKHBhdGguaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZyb21SZXNvdXJjZShwYXRoLnN1YnN0cih1dGlsc18xLlJFU09VUkNFX1BSRUZJWC5sZW5ndGgpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21GaWxlKHBhdGgpO1xufVxuZXhwb3J0cy5mcm9tRmlsZU9yUmVzb3VyY2UgPSBmcm9tRmlsZU9yUmVzb3VyY2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1zb3VyY2UuaW9zLmpzLm1hcCIsImNvbnNvbGUubG9nKFwiTG9hZGluZyBpbnNwZWN0b3IgbW9kdWxlcy4uLlwiKTtcbnJlcXVpcmUoXCIuL2dsb2JhbHMvdHMtaGVscGVyc1wiKTtcbnJlcXVpcmUoXCIuL2RlYnVnZ2VyL3dlYmluc3BlY3Rvci1uZXR3b3JrXCIpO1xucmVxdWlyZShcIi4vZGVidWdnZXIvd2ViaW5zcGVjdG9yLWRvbVwiKTtcbnJlcXVpcmUoXCIuL2RlYnVnZ2VyL3dlYmluc3BlY3Rvci1jc3NcIik7XG5jb25zb2xlLmxvZyhcIkZpbmlzaGVkIGxvYWRpbmcgaW5zcGVjdG9yIG1vZHVsZXMuXCIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5zcGVjdG9yX21vZHVsZXMuaW9zLmpzLm1hcCIsIu+7v1x0Lypcblx0bmV3IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBwYXJzZXIgPSBuZXcgRWFzeVNBWFBhcnNlcigpO1xuXG5cdFx0cGFyc2VyLm5zKCdyc3MnLCB7IC8vIG9yIGZhbHNlXG5cdFx0XHRyc3M6ICdodHRwOi8vcHVybC5vcmcvcnNzLzEuMC8nLFxuXHRcdFx0YXRvbTogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDUvQXRvbScsXG5cdFx0XHR4aHRtbDogJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwnLFxuXHRcdFx0bWVkaWE6ICdodHRwOi8vc2VhcmNoLnlhaG9vLmNvbS9tcnNzLydcblx0XHR9KTtcblxuXG5cdFx0cGFyc2VyLm9uKCdlcnJvcicsIGZ1bmN0aW9uKG1zZykge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhtc2cpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ3N0YXJ0Tm9kZScsIGZ1bmN0aW9uKGVsZW0sIGF0dHIsIHVxLCB0YWdlbmQsIGdldFN0ck5vZGUpIHtcblx0XHRcdGF0dHIoKTtcblx0XHRcdHJldHVybjtcblx0XHRcdGlmICh0YWdlbmQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJyAgICcrc3RyKVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJysgICcrc3RyKVxuXHRcdFx0fTtcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbignZW5kTm9kZScsIGZ1bmN0aW9uKGVsZW0sIHVxLCB0YWdzdGFydCwgc3RyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0XHRpZiAoIXRhZ3N0YXJ0KSBjb25zb2xlLmxvZygnLSAgJyArIHN0cilcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbigndGV4dE5vZGUnLCBmdW5jdGlvbihzLCB1cSkge1xuXHRcdFx0dXEocyk7XG5cdFx0XHRyZXR1cm5cblx0XHRcdGNvbnNvbGUubG9nKCcgICAnK3MpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ2NkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuXHRcdH0pO1xuXG5cblx0XHRwYXJzZXIub24oJ2NvbW1lbnQnLCBmdW5jdGlvbih0ZXh0KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCctLScrdGV4dCsnLS0nKVxuXHRcdH0pO1xuXG5cdFx0Ly9wYXJzZXIub24oJ3F1ZXN0aW9uJywgZnVuY3Rpb24oKSB7fSk7IC8vIDw/IC4uLiA/PlxuXHRcdC8vcGFyc2VyLm9uKCdhdHRlbnRpb24nLCBmdW5jdGlvbigpIHt9KTsgLy8gPCFYWFhYWCB6enp6PVwiZWVlZVwiPlxuXG5cdFx0Y29uc29sZS50aW1lKCdlYXN5c2F4Jyk7XG5cdFx0Zm9yKHZhciB6PTEwMDA7ei0tOykge1xuXHRcdFx0cGFyc2VyLnBhcnNlKHhtbClcblx0XHR9O1xuXHRcdGNvbnNvbGUudGltZUVuZCgnZWFzeXNheCcpO1xuXHR9O1xuXG5cblx0Ki9cblxuLy8gPDwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tID4+IC8vXG5cblxuaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAvKiYmIHRoaXMgPT0gZXhwb3J0cyovKSB7XG5cdG1vZHVsZS5leHBvcnRzLkVhc3lTQVhQYXJzZXIgPSBFYXN5U0FYUGFyc2VyO1xufTtcblxuZnVuY3Rpb24gRWFzeVNBWFBhcnNlcigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGlmICghdGhpcykgcmV0dXJuIG51bGw7XG5cbiAgICB0aGlzLmFuZ3VsYXJTeW50YXggPSBmYWxzZTtcblxuXHRmdW5jdGlvbiBudWxsRnVuYygpIHt9O1xuXG5cdHRoaXMub25UZXh0Tm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25TdGFydE5vZGUgPSBudWxsRnVuYztcbiAgICB0aGlzLm9uRW5kTm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25DREFUQSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25FcnJvciA9IG51bGxGdW5jO1xuICAgIHRoaXMub25Db21tZW50ID0gbnVsbDtcbiAgICB0aGlzLm9uUXVlc3Rpb24gPSBudWxsO1xuICAgIHRoaXMub25BdHRlbnRpb24gPSBudWxsO1xuXHR0aGlzLmlzX29uQ29tbWVudCA9IHRoaXMuaXNfb25RdWVzdGlvbiA9IHRoaXMuaXNfb25BdHRlbnRpb24gPSBmYWxzZTtcblxuXHR0aGlzLmlzTmFtZXNwYWNlID0gZmFsc2U7XG4gICAgdGhpcy51c2VOUyA9IG51bGw7XG4gICAgdGhpcy5kZWZhdWx0X3htbG5zID0gbnVsbDtcbiAgICB0aGlzLnhtbG5zID0gbnVsbDtcblx0dGhpcy5uc21hdHJpeCA9IHt4bWxuczogdGhpcy54bWxuc307XG5cdHRoaXMuaGFzU3VybWlzZU5TID0gZmFsc2U7XG5cdDtcblxuXG5cdHRoaXMuYXR0cl9zdHJpbmcgPSAnJzsgLy8g0YHRgtGA0L7QutCwINCw0YLRgNC40LHRg9GC0L7QslxuXHR0aGlzLmF0dHJfcG9zc3RhcnQgPSAwOyAvL1xuXHR0aGlzLmF0dHJfcmVzOyAvLyDQt9Cw0LrQtdGI0LjRgNC+0LLQsNC90L3Ri9C5INGA0LXQt9GD0LvRjNGC0LDRgiDRgNCw0LfQsdC+0YDQsCDQsNGC0YDQuNCx0YPRgtC+0LIgLCBudWxsIC0g0YDQsNC30LHQvtGAINC90LUg0L/RgNC+0LLQvtC00LjQu9GB0Y8sIG9iamVjdCAtINGF0LXRiCDQsNGC0YDQuNCx0YPRgtC+0LIsIHRydWUgLSDQvdC10YIg0LDRgtGA0LjQsdGD0YLQvtCyLCBmYWxzZSAtINC90LXQstCw0LvQuNC00L3Ri9C5IHhtbFxufVxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKG5hbWUsIGNiKSB7XG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoY2IgIT09IG51bGwpIHJldHVybjtcbiAgICB9O1xuXG4gICAgc3dpdGNoKG5hbWUpIHtcbiAgICAgICAgY2FzZSAnZXJyb3InOiB0aGlzLm9uRXJyb3IgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3N0YXJ0Tm9kZSc6IHRoaXMub25TdGFydE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2VuZE5vZGUnOiB0aGlzLm9uRW5kTm9kZSA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAndGV4dE5vZGUnOiB0aGlzLm9uVGV4dE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NkYXRhJzogdGhpcy5vbkNEQVRBID0gY2IgfHwgbnVsbEZ1bmM7IGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2NvbW1lbnQnOiB0aGlzLm9uQ29tbWVudCA9IGNiOyB0aGlzLmlzX29uQ29tbWVudCA9ICEhY2I7IGJyZWFrO1xuICAgICAgICBjYXNlICdxdWVzdGlvbic6IHRoaXMub25RdWVzdGlvbiA9IGNiOyB0aGlzLmlzX29uUXVlc3Rpb24gPSAhIWNiOyBicmVhazsgLy8gPD8gLi4uLiAgPz5cbiAgICAgICAgY2FzZSAnYXR0ZW50aW9uJzogdGhpcy5vbkF0dGVudGlvbiA9IGNiOyB0aGlzLmlzX29uQXR0ZW50aW9uID0gISFjYjsgYnJlYWs7IC8vIDwhWFhYWFggenp6ej1cImVlZWVcIj5cbiAgICB9O1xufTtcblxuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUubnMgPSBmdW5jdGlvbihyb290LCBucykge1xuICAgIGlmICghcm9vdCB8fCB0eXBlb2Ygcm9vdCAhPT0gJ3N0cmluZycgfHwgIW5zKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgdmFyIHUsIHggPSB7fSwgb2ssIHYsIGk7XG5cbiAgICBmb3IoaSBpbiBucykge1xuICAgICAgICB2ID0gbnNbaV07XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmIChyb290ID09PSB2KSBvayA9IHRydWU7XG4gICAgICAgICAgICB4W2ldID0gdjtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgaWYgKG9rKSB7XG4gICAgICAgIHRoaXMuaXNOYW1lc3BhY2UgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlZmF1bHRfeG1sbnMgPSByb290O1xuICAgICAgICB0aGlzLnVzZU5TID0geDtcbiAgICB9O1xufTtcblxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHhtbCkge1xuICAgIGlmICh0eXBlb2YgeG1sICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgIHRoaXMubnNtYXRyaXggPSB7eG1sbnM6IHRoaXMuZGVmYXVsdF94bWxuc307XG5cbiAgICAgICAgcGFyc2UoeG1sKTtcblxuICAgICAgICB0aGlzLm5zbWF0cml4ID0gZmFsc2U7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXJzZSh4bWwpO1xuICAgIH07XG5cbiAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbnZhciB4aGFyc1F1b3Q9e2NvbnN0cnVjdG9yOiBmYWxzZSwgaGFzT3duUHJvcGVydHk6IGZhbHNlLCBpc1Byb3RvdHlwZU9mOiBmYWxzZSwgcHJvcGVydHlJc0VudW1lcmFibGU6IGZhbHNlLCB0b0xvY2FsZVN0cmluZzogZmFsc2UsIHRvU3RyaW5nOiBmYWxzZSwgdmFsdWVPZjogZmFsc2VcbiAgICAsIHF1b3Q6ICdcIidcbiAgICAsIFFVT1Q6ICdcIidcbiAgICAsIGFtcDogJyYnXG4gICAgLCBBTVA6ICcmJ1xuICAgICwgbmJzcDogJ1xcdTAwQTAnXG4gICAgLCBhcG9zOiAnXFwnJ1xuICAgICwgbHQ6ICc8J1xuICAgICwgTFQ6ICc8J1xuICAgICwgZ3Q6ICc+J1xuICAgICwgR1Q6ICc+J1xuICAgICwgY29weTogJ1xcdTAwQTknXG4gICAgLCBsYXF1bzogJ1xcdTAwQUInXG4gICAgLCByYXF1bzogJ1xcdTAwQkInXG4gICAgLCByZWc6ICdcXHUwMEFFJ1xuICAgICwgZGVnOiAnXFx1MDBCMCdcbiAgICAsIHBsdXNtbjogJ1xcdTAwQjEnXG4gICAgLCBzdXAyOiAnXFx1MDBCMidcbiAgICAsIHN1cDM6ICdcXHUwMEIzJ1xuICAgICwgbWljcm86ICdcXHUwMEI1J1xuICAgICwgcGFyYTogJ1xcdTAwQjYnXG59O1xuXG5cbmZ1bmN0aW9uIHJwRW50aXRpZXMocywgZCwgeCwgeikge1xuICAgIGlmICh6KSB7XG4gICAgICAgIHJldHVybiB4aGFyc1F1b3Rbel0gfHwgJ1xceDAxJztcbiAgICB9O1xuXG4gICAgaWYgKGQpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoZCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KHgsIDE2KSk7XG59O1xuXG5mdW5jdGlvbiB1bkVudGl0aWVzKHMsIGkpIHtcbiAgICBzID0gU3RyaW5nKHMpO1xuICAgIGlmIChzLmxlbmd0aCA+IDMgJiYgcy5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gICAgICAgIGlmIChzLmluZGV4T2YoJyZndDsnKSAhPT0gLTEpIHMgPSBzLnJlcGxhY2UoLyZndDsvZywgJz4nKTtcbiAgICAgICAgaWYgKHMuaW5kZXhPZignJmx0OycpICE9PSAtMSkgcyA9IHMucmVwbGFjZSgvJmx0Oy9nLCAnPCcpO1xuICAgICAgICBpZiAocy5pbmRleE9mKCcmcXVvdDsnKSAhPT0gLTEpIHMgPSBzLnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKTtcblxuICAgICAgICBpZiAocy5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gICAgICAgICAgICBzID0gcy5yZXBsYWNlKC8mIyhcXGQrKTt8JiN4KFswMTIzNDU2Nzg5YWJjZGVmXSspO3wmKFxcdyspOy9pZywgcnBFbnRpdGllcyk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHJldHVybiBzO1xufTtcblxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5hbGxvd2VkQW5ndWxhckF0dHJpYnV0ZUNoYXJzID0gZnVuY3Rpb24odykge1xuICAgIGlmICghdGhpcy5hbmd1bGFyU3ludGF4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgdyA9PT0gNDAgfHwgLy8gKFxuICAgICAgICAgICAgdyA9PT0gNDEgfHwgLy8gKVxuICAgICAgICAgICAgdyA9PT0gOTEgfHwgLy8gW1xuICAgICAgICAgICAgdyA9PT0gOTMgfHwgLy8gXVxuICAgICAgICAgICAgdyA9PT0gOTQgfHwgLy8gXlxuICAgICAgICAgICAgdyA9PT0gMzUgICAgLy8gI1xuICAgICAgICApO1xuICAgIH1cbn07XG5cblx0Lypcblx0XHTQv9Cw0YDRgdC40YIg0LDRgtGA0LjQsdGD0YLRiyDQv9C+INGC0YDQtdCx0L7QstCw0L3QuNGOLiDQktCw0LbQvdC+ISAtINGE0YPQvdC60YbQuNGPINC90LUg0LPQtdC90LXRgNC40YDRg9C10YIg0LjRgdC60LvRjtGH0LXQvdC40Y8uXG5cblx0XHTQtdGB0LvQuCDQsdGL0LvQsCDQvtGI0LjQsdC60LAg0YDQsNC30LHQvtGA0LAg0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPIGZhbHNlXG5cdFx00LXRgdC70Lgg0LDRgtGA0LjQsdGD0YLQvtCyINC90LXRgiDQuCDRgNCw0LfQsdC+0YAg0YPQtNCw0YfQtdC9INGC0L4g0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPIHRydWVcblx0XHTQtdGB0LvQuCDQtdGB0YLRjCDQsNGC0YDQuNCx0YPRgtGLINGC0L4g0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPINC+0LHRjNC10LrRgijRhdC10YgpXG5cdCovXG5cbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLmdldEF0dHJzID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYXR0cl9yZXMgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXM7XG4gICAgfTtcblxuICAgIC8qXG4gICAgaWYgKHh4dGVzdCAhPT0gdSAmJiBhdHRyX3N0cmluZy5pbmRleE9mKHh4dGVzdCkgPT09IC0xKSB7XG4gICAgICAgIC8gKlxuICAgICAgICAgICAgLy8g0LTQu9GPINGD0YHQutC+0YDQtdC90LjRj1xuICAgICAgICAgICAgaWYgKGdldEF0dHJzKCdodG1sJykudHlwZSA9PSAnaHRtbCcpIHtcbiAgICAgICAgICAgICAgICAuLi5cbiAgICAgICAgICAgIH07XG4gICAgICAgICogL1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgICovXG5cbiAgICB2YXIgdVxuICAgICwgcmVzID0ge31cbiAgICAsIHMgPSB0aGlzLmF0dHJfc3RyaW5nXG4gICAgLCBpID0gdGhpcy5hdHRyX3Bvc3N0YXJ0XG4gICAgLCBsID0gcy5sZW5ndGhcbiAgICAsIGF0dHJfbGlzdCA9IHRoaXMuaGFzU3VybWlzZU5TID8gW10gOiBmYWxzZVxuICAgICwgbmFtZSwgdmFsdWUgPSAnJ1xuICAgICwgb2sgPSBmYWxzZVxuICAgICwgbm9WYWx1ZUF0dHJpYnV0ZSA9IGZhbHNlXG4gICAgLCBqLCB3LCBubiwgblxuICAgICwgaGFzTmV3TWF0cml4XG4gICAgLCBhbGlhcywgbmV3YWxpYXNcbiAgICA7XG5cbiAgICBhYTpcbiAgICBmb3IoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaSk7XG5cbiAgICAgICAgaWYgKHc9PT0zMiB8fCAodzwxNCAmJiB3ID4gOCkgKSB7IC8vIFxcZlxcblxcclxcdFxcdlxuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgdmFsaWQgYXR0cmlidXRlIHN0YXJ0IGNoYXJcbiAgICAgICAgaWYgKCh3IDwgNjUgJiYgIXRoaXMuYWxsb3dlZEFuZ3VsYXJBdHRyaWJ1dGVDaGFycyh3KSkgfHxcbiAgICAgICAgICAgICAgICB3ID4gMTIyIHx8ICh3ID4gOTAgJiYgdyA8IDk3ICYmICF0aGlzLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnModykpICkgeyAvLyDQvtC20LjQtNCw0LXQvCDRgdC40LzQstC+0LtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IoaiA9IGkgKyAxOyBqIDwgbDsgaisrKSB7IC8vINC/0YDQvtCy0LXRgNGP0LXQvCDQstGB0LUg0YHQuNC80LLQvtC70Ysg0LjQvNC10L3QuCDQsNGC0YDQuNCx0YPRgtCwXG4gICAgICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGopO1xuXG4gICAgICAgICAgICBpZiAodyA+IDk2ICYmIHcgPCAxMjMgfHwgdyA+IDY0ICYmIHcgPCA5MSB8fCB3ID4gNDcgJiYgdyA8IDU5IHx8IHcgPT09IDQ1IHx8IHcgPT09IDk1IHx8IHcgPT09IDQ2IC8qIGh0dHBzOi8vZ2l0aHViLmNvbS90ZWxlcmlrL3hQbGF0Q29yZS9pc3N1ZXMvMTc5ICovKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgai0tOyAvL1N0YXJ0ZWQgbmV4dCBhdHRyaWJ1dGUuIEdldCBiYWNrIGFuZCBicmVhayBvdXQgb2YgdGhlIGxvb3AuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnModykpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHcgPT09IDMyIHx8ICh3ID4gOCAmJiB3IDwgMTQpICkgeyAgLy8gXFxmXFxuXFxyXFx0XFx2INC/0YDQvtCx0LXQu1xuICAgICAgICAgICAgICAgIG5vVmFsdWVBdHRyaWJ1dGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh3ID09PSA2MSkgeyAvLyBcIj1cIiA9PSA2MVxuICAgICAgICAgICAgICAgIG5vVmFsdWVBdHRyaWJ1dGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgMicpO1xuICAgICAgICAgICAgICAgIGlmICghbm9WYWx1ZUF0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH07XG5cbiAgICAgICAgbmFtZSA9IHMuc3Vic3RyaW5nKGksIGopLnRyaW0oKTtcbiAgICAgICAgb2sgPSB0cnVlO1xuXG4gICAgICAgIGlmIChuYW1lID09PSAneG1sbnM6eG1sbnMnKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvciA2JylcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIG5hbWVcbiAgICAgICAgfTtcblxuICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGorMSk7XG5cbiAgICAgICAgd2hpbGUgKHcgPSBzLmNoYXJDb2RlQXQoaisxKSkge1xuICAgICAgICAgICAgaWYgKHc9PT0zMiB8fCAodyA+IDggJiYgdzwxNCkgKSB7ICAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgaWYgKHcgPT09IDM0KSB7ICAvLyAnXCInXG4gICAgICAgICAgICAgICAgaiA9IHMuaW5kZXhPZignXCInLCBpID0gaisyICk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHcgPT09IDM5KSB7XG4gICAgICAgICAgICAgICAgICAgIGogPSBzLmluZGV4T2YoJ1xcJycsIGkgPSBqKzIgKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAvLyBcIidcIlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yIDQnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICB9O1xuXG5cbiAgICAgICAgaWYgKGorMSA8IGwgJiYgIW5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaisxKTtcblxuICAgICAgICAgICAgaWYgKHcgPiAzMiB8fCB3IDwgOSB8fCAodyA8IDMyICYmIHcgPiAxMykpIHtcbiAgICAgICAgICAgICAgICAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgNScpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cblxuICAgICAgICBpZiAobm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gcy5zdWJzdHJpbmcoaSwgaik7XG4gICAgICAgIH1cblxuICAgICAgICAvL2kgPSBqICsgMTsgLy8g0YHQu9C10LQuINGB0LXQvNCy0L7QuyDRg9C20LUg0L/RgNC+0LLQtdGA0LXQvSDQv9C+0YLQvtC80YMg0L/RgNC+0LLQtdGA0Y/RgtGMINC90YPQttC90L4g0YHQu9C10LTRg9GO0YjQuNC5XG4gICAgICAgIGkgPSBqOyAvLyDRgdC70LXQtC4g0YHQtdC80LLQvtC7INGD0LbQtSDQv9GA0L7QstC10YDQtdC9INC/0L7RgtC+0LzRgyDQv9GA0L7QstC10YDRj9GC0Ywg0L3Rg9C20L3QviDRgdC70LXQtNGD0Y7RiNC40LlcblxuICAgICAgICBpZiAodGhpcy5pc05hbWVzcGFjZSkgeyAvL1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TKSB7XG4gICAgICAgICAgICAgICAgLy8g0LXRgdGC0Ywg0L/QvtC00L7Qt9GA0LXQvdC40LUg0YfRgtC+INCyINCw0YLRgNC40LHRg9GC0LDRhSDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIgeG1sbnNcblxuICAgICAgICAgICAgICAgIGlmIChuZXdhbGlhcyA9IG5hbWUgPT09ICd4bWxucycgPyAneG1sbnMnIDogbmFtZS5jaGFyQ29kZUF0KDApID09PSAxMjAgJiYgbmFtZS5zdWJzdHIoMCwgNikgPT09ICd4bWxuczonICYmIG5hbWUuc3Vic3RyKDYpICkge1xuICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IHRoaXMudXNlTlNbdW5FbnRpdGllcyh2YWx1ZSldO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdICE9PSBhbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzTmV3TWF0cml4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05ld01hdHJpeCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5uID0ge307IGZvciAobiBpbiB0aGlzLm5zbWF0cml4KSBubltuXSA9IHRoaXMubnNtYXRyaXhbbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBubjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeFtuZXdhbGlhc10gPSBhbGlhcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uc21hdHJpeFtuZXdhbGlhc10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc05ld01hdHJpeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNOZXdNYXRyaXggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubiA9IHt9OyBmb3IgKG4gaW4gdGhpcy5uc21hdHJpeCkgbm5bbl0gPSB0aGlzLm5zbWF0cml4W25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gbm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgYXR0cl9saXN0LnB1c2gobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdyA9IG5hbWUubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUoLS13KSB7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUuY2hhckNvZGVBdCh3KSA9PT0gNTgpIHsgLy8gJzonXG4gICAgICAgICAgICAgICAgICAgIGlmICh3ID0gdGhpcy5uc21hdHJpeFtuYW1lLnN1YnN0cmluZygwLCB3KV0gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNbdyArIG5hbWUuc3Vic3RyKHcpXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBhYTtcblxuICAgICAgICAgICAgICAgICAgICAvLyAneG1sOmJhc2UnID8/P1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICBub1ZhbHVlQXR0cmlidXRlID0gZmFsc2U7XG4gICAgfTtcblxuXG4gICAgaWYgKCFvaykge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IHRydWU7ICAvLyDQsNGC0YDQuNCx0YPRgtC+0LIg0L3QtdGCLCDQvtGI0LjQsdC+0Log0YLQvtC20LUg0L3QtdGCXG4gICAgfTtcblxuXG4gICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TKSAge1xuICAgICAgICBiYjpcblxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gYXR0cl9saXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgbmFtZSA9IGF0dHJfbGlzdFtpKytdO1xuXG4gICAgICAgICAgICB3ID0gbmFtZS5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSgtLXcpIHsgLy8gbmFtZS5pbmRleE9mKCc6JylcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5jaGFyQ29kZUF0KHcpID09PSA1OCkgeyAvLyAnOidcbiAgICAgICAgICAgICAgICAgICAgaWYgKHcgPSB0aGlzLm5zbWF0cml4W25hbWUuc3Vic3RyaW5nKDAsIHcpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW3cgKyBuYW1lLnN1YnN0cih3KV0gPSBhdHRyX2xpc3RbaV07XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGJiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmVzW25hbWVdID0gYXR0cl9saXN0W2ldO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IHJlcztcbn07XG5cblxuLy8geG1sIC0gc3RyaW5nXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHhtbCkge1xuICAgIHZhciB1XG4gICAgLCB4bWwgPSBTdHJpbmcoeG1sKVxuICAgICwgbm9kZXN0YWNrID0gW11cbiAgICAsIHN0YWNrbnNtYXRyaXggPSBbXVxuICAgIC8vLCBzdHJpbmdfbm9kZVxuICAgICwgZWxlbVxuICAgICwgdGFnZW5kID0gZmFsc2VcbiAgICAsIHRhZ3N0YXJ0ID0gZmFsc2VcbiAgICAsIGogPSAwLCBpID0gMCwgayA9IDAsIGxlblxuICAgICwgeCwgeSwgcSwgd1xuICAgICwgeG1sbnNcbiAgICAsIHN0b3BJbmRleCA9IDBcbiAgICAsIHN0b3AgLy8g0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGPINC/0YDQuCDRgNCw0LfQsdC+0YDQtSBcIm5hbWVzcGFjZVwiIC4g0LXRgdC70Lgg0LLRgdGC0YDQtdGC0LjQu9GB0Y8g0L3QtdC40LfQstC10YHRgtC90L7QtSDQv9GA0L7RgdGC0YDQsNC90YHRgtCy0L4g0YLQviDRgdC+0LHRi9GC0LjRjyDQvdC1INCz0LXQvdC10YDQuNGA0YPRjtGC0YHRj1xuICAgICwgX25zbWF0cml4XG4gICAgLCBva1xuICAgICwgcG9zID0gMCwgbG4gPSAwLCBsblN0YXJ0ID0gLTIsIGxuRW5kID0gLTFcbiAgICA7XG5cbiAgICBsZW4gPSB4bWwubGVuZ3RoO1xuICAgIGZ1bmN0aW9uIGdldFN0cmluZ05vZGUoKSB7XG4gICAgICAgIHJldHVybiB4bWwuc3Vic3RyaW5nKGksIGorMSlcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGZpbmRMaW5lQW5kQ29sdW1uRnJvbVBvcygpIHtcbiAgICAgICAgd2hpbGUgKGxuU3RhcnQgPCBsbkVuZCAmJiBsbkVuZCA8IHBvcykge1xuICAgICAgICAgICAgbG5TdGFydCA9IGxuRW5kO1xuICAgICAgICAgICAgbG5FbmQgPSB4bWwuaW5kZXhPZihcIlxcblwiLCBsbkVuZCArIDEpO1xuICAgICAgICAgICAgKytsbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBsaW5lOiBsbiwgY29sdW1uOiBwb3MgLSBsblN0YXJ0IH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBvc2l0aW9uKHApIHtcbiAgICAgICAgcG9zID0gcDtcbiAgICAgICAgcmV0dXJuIGZpbmRMaW5lQW5kQ29sdW1uRnJvbVBvcztcbiAgICB9XG5cbiAgICB3aGlsZShqICE9PSAtMSkge1xuICAgICAgICBzdG9wID0gc3RvcEluZGV4ID4gMDtcblxuICAgICAgICBpZiAoeG1sLmNoYXJDb2RlQXQoaikgPT09IDYwKSB7IC8vIFwiPFwiXG4gICAgICAgICAgICBpID0gajtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkgPSB4bWwuaW5kZXhPZignPCcsIGopO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChpID09PSAtMSkgeyAvLyDQutC+0L3QtdGGINGA0LDQt9Cx0L7RgNCwXG5cbiAgICAgICAgICAgIGlmIChub2Rlc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdlbmQgZmlsZScsIHBvc2l0aW9uKGopKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGogIT09IGkgJiYgIXN0b3ApIHtcbiAgICAgICAgICAgIG9rID0gdGhpcy5vblRleHROb2RlKHhtbC5zdWJzdHJpbmcoaiwgaSksIHVuRW50aXRpZXMsIHBvc2l0aW9uKGopKTtcbiAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgfTtcblxuICAgICAgICB3ID0geG1sLmNoYXJDb2RlQXQoaSsxKTtcblxuICAgICAgICBpZiAodyA9PT0gMzMpIHsgLy8gXCIhXCJcbiAgICAgICAgICAgIHcgPSB4bWwuY2hhckNvZGVBdChpKzIpO1xuICAgICAgICAgICAgaWYgKHcgPT09IDkxICYmIHhtbC5zdWJzdHIoaSszLCA2KSA9PT0gJ0NEQVRBWycpIHsgLy8gOTEgPT0gXCJbXCJcbiAgICAgICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJ11dPicsIGkpO1xuICAgICAgICAgICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2NkYXRhJywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8veCA9IHhtbC5zdWJzdHJpbmcoaSs5LCBqKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uQ0RBVEEoeG1sLnN1YnN0cmluZyhpKzksIGopLCBmYWxzZSwgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh3ID09PSA0NSAmJiB4bWwuY2hhckNvZGVBdChpKzMpID09PSA0NSkgeyAvLyA0NSA9PSBcIi1cIlxuICAgICAgICAgICAgICAgIGogPSB4bWwuaW5kZXhPZignLS0+JywgaSk7XG4gICAgICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZXhwZWN0ZWQgLS0+JywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25Db21tZW50ICYmICFzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG9rID0gdGhpcy5vbkNvbW1lbnQoeG1sLnN1YnN0cmluZyhpKzQsIGopLCB1bkVudGl0aWVzLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaiArPSAzO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaiA9IHhtbC5pbmRleE9mKCc+JywgaSsxKTtcbiAgICAgICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZXhwZWN0ZWQgXCI+XCInLCBwb3NpdGlvbihpICsgMSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzX29uQXR0ZW50aW9uICYmICFzdG9wKSB7XG4gICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uQXR0ZW50aW9uKHhtbC5zdWJzdHJpbmcoaSwgaisxKSwgdW5FbnRpdGllcywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodyA9PT0gNjMpIHsgLy8gXCI/XCJcbiAgICAgICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJz8+JywgaSk7XG4gICAgICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7IC8vIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignLi4uPz4nLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25RdWVzdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBvayA9IHRoaXMub25RdWVzdGlvbih4bWwuc3Vic3RyaW5nKGksIGorMiksIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBqICs9IDI7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbnNpZGU9ZmFsc2U7XG4gICAgICAgIGZvciAoaz1pLGo9LTE7azxsZW47aysrKSB7XG4gICAgICAgICAgICB2YXIgYyA9IHhtbC5jaGFyQ29kZUF0KGspO1xuICAgICAgICAgICAgaWYgKCFpbnNpZGUpIHtcblxuICAgICAgICAgICAgICAgIGlmIChjID09PSAzNCkgeyAvLyAnXCInXG4gICAgICAgICAgICAgICAgICAgIGluc2lkZSA9IGM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09IDM5KSB7IC8vIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIGluc2lkZSA9IGM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09IDYyKSB7IC8vIDxcbiAgICAgICAgICAgICAgICAgICAgaiA9IGs7IGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGMgPT09IGluc2lkZSkgeyBpbnNpZGUgPSBmYWxzZTsgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGogPT0gLTEpIHsgLy8gZXJyb3JcbiAgICAgICAgICAgIHRoaXMub25FcnJvcignLi4uPicsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5hdHRyX3JlcyA9IHRydWU7IC8vINCw0YLRgNC40LHRg9GC0L7QsiDQvdC10YJcblxuICAgICAgICAvL2lmICh4bWwuY2hhckNvZGVBdChpKzEpID09PSA0NykgeyAvLyA8Ly4uLlxuICAgICAgICBpZiAodyA9PT0gNDcpIHsgLy8gPC8uLi5cbiAgICAgICAgICAgIHRhZ3N0YXJ0ID0gZmFsc2U7XG4gICAgICAgICAgICB0YWdlbmQgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyDQv9GA0L7QstC10YDRj9C10Lwg0YfRgtC+INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQt9Cw0LrRgNGL0YIg0YLQvtGC0LbQtSDRgtC10LMg0YfRgtC+INC4INC+0YLQutGA0YvQstCw0LvRgdGPXG4gICAgICAgICAgICB4ID0gZWxlbSA9IG5vZGVzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHEgPSBpICsgMiArIHgubGVuZ3RoO1xuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKClcbiAgICAgICAgICAgIGlmICh4bWwuc3Vic3RyaW5nKGkrMiwgcSkgIT09IHgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2Nsb3NlIHRhZ25hbWUnLCBwb3NpdGlvbihpICsgMikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vINC/0YDQvtCy0LXRgNC40Lwg0YfRgtC+INCyINC30LDQutGA0YvQstCw0Y7RiNC10Lwg0YLQtdCz0LUg0L3QtdGCINC70LjRiNC90LXQs9C+XG4gICAgICAgICAgICBmb3IoOyBxIDwgajsgcSsrKSB7XG4gICAgICAgICAgICAgICAgdyA9IHhtbC5jaGFyQ29kZUF0KHEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHc9PT0zMiB8fCAodyA+IDggJiYgdzwxNCkgKSB7ICAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2Nsb3NlIHRhZycsIHBvc2l0aW9uKGkgKyAyKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHhtbC5jaGFyQ29kZUF0KGotMSkgPT09ICA0NykgeyAvLyAuLi4vPlxuICAgICAgICAgICAgICAgIHggPSBlbGVtID0geG1sLnN1YnN0cmluZyhpKzEsIGotMSk7XG5cbiAgICAgICAgICAgICAgICB0YWdzdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGFnZW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeCA9IGVsZW0gPSB4bWwuc3Vic3RyaW5nKGkrMSwgaik7XG5cbiAgICAgICAgICAgICAgICB0YWdzdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGFnZW5kID0gZmFsc2U7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoICEodyA+IDk2ICAmJiB3IDwgMTIzIHx8IHcgPiA2NCAmJiB3IDw5MSkgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdmaXJzdCBjaGFyIG5vZGVOYW1lJywgcG9zaXRpb24oaSArIDEpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IocSA9IDEsIHkgPSB4Lmxlbmd0aDsgcSA8IHk7IHErKykge1xuICAgICAgICAgICAgICAgIHcgPSB4LmNoYXJDb2RlQXQocSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodyA+IDk2ICYmIHcgPCAxMjMgfHwgdyA+IDY0ICYmIHcgPCA5MSB8fCB3ID4gNDcgJiYgdyA8IDU5IHx8IHcgPT09IDQ1IHx8IHcgPT09IDk1IHx8IHcgPT09IDQ2IC8qIGh0dHBzOi8vZ2l0aHViLmNvbS90ZWxlcmlrL3hQbGF0Q29yZS9pc3N1ZXMvMTc5ICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodz09PTMyIHx8ICh3PDE0ICYmIHcgPiA4KSkgeyAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgICAgIGVsZW0gPSB4LnN1YnN0cmluZygwLCBxKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfcmVzID0gbnVsbDsgLy8g0LLQvtC30LzQvtC20L3QviDQtdGB0YLRjCDQsNGC0LjRgNC40LHRg9GC0YtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignaW52YWxpZCBub2RlTmFtZScsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCF0YWdlbmQpIHtcbiAgICAgICAgICAgICAgICBub2Rlc3RhY2sucHVzaChlbGVtKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cblxuICAgICAgICBpZiAodGhpcy5pc05hbWVzcGFjZSkge1xuICAgICAgICAgICAgaWYgKHN0b3ApIHtcbiAgICAgICAgICAgICAgICBpZiAodGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFnc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgtLXN0b3BJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBzdGFja25zbWF0cml4LnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3BJbmRleCArPSAxO1xuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIF9uc21hdHJpeCA9IHRoaXMubnNtYXRyaXg7XG5cbiAgICAgICAgICAgIGlmICghdGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgc3RhY2tuc21hdHJpeC5wdXNoKHRoaXMubnNtYXRyaXgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXR0cl9yZXMgIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TID0geC5pbmRleE9mKCd4bWxucycsIHEpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3N0cmluZyA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfcG9zc3RhcnQgPSBxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEF0dHJzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU3VybWlzZU5TID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgdyA9IGVsZW0uaW5kZXhPZignOicpO1xuICAgICAgICAgICAgaWYgKHcgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgeG1sbnMgPSB0aGlzLm5zbWF0cml4W2VsZW0uc3Vic3RyaW5nKDAsIHcpXTtcbiAgICAgICAgICAgICAgICBlbGVtID0gZWxlbS5zdWJzdHIodysxKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4bWxucyA9IHRoaXMubnNtYXRyaXgueG1sbnM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoIXhtbG5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ2VuZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFnc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBfbnNtYXRyaXg7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gc3RhY2tuc21hdHJpeC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdG9wSW5kZXggPSAxOyAvLyDQv9C10YDQstGL0Lkg0Y3Qu9C10LzQtdC90YIg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0L3QtSDQvtC/0YDQtdC00LXQu9C10L3QviDQv9GA0L7RgdGC0YDQsNC90YHRgtCy0L4g0LjQvNC10L1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3JlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGVsZW0gPSB4bWxucyArICc6JyArIGVsZW07XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9zdHJpbmdfbm9kZSA9IHhtbC5zdWJzdHJpbmcoaSwgaisxKTsgLy8g0YLQtdC60YHRgiDQvdC+0LTRiyDQutCw0Log0LXRgdGC0YxcblxuICAgICAgICBpZiAodGFnc3RhcnQpIHsgLy8gaXNfb25TdGFydE5vZGVcbiAgICAgICAgICAgIHRoaXMuYXR0cl9zdHJpbmcgPSB4O1xuICAgICAgICAgICAgdGhpcy5hdHRyX3Bvc3N0YXJ0ID0gcTtcblxuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgb2sgPSB0aGlzLm9uU3RhcnROb2RlKGVsZW0sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhhdC5nZXRBdHRycygpIH0sIHVuRW50aXRpZXMsIHRhZ2VuZFxuICAgICAgICAgICAgICAgICwgZ2V0U3RyaW5nTm9kZSwgcG9zaXRpb24oaSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGFnZW5kKSB7XG4gICAgICAgICAgICBvayA9IHRoaXMub25FbmROb2RlKGVsZW0sIHVuRW50aXRpZXMsIHRhZ3N0YXJ0XG4gICAgICAgICAgICAgICAgLCBnZXRTdHJpbmdOb2RlLCBwb3NpdGlvbihpKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBfbnNtYXRyaXg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IHN0YWNrbnNtYXRyaXgucG9wKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgaiArPSAxO1xuICAgIH07XG59O1xuIiwi77u/LypcbiAgQ29weXJpZ2h0IChDKSAyMDEzIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTMgVGhhZGRlZSBUeWwgPHRoYWRkZWUudHlsQGdtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgTWF0aGlhcyBCeW5lbnMgPG1hdGhpYXNAcWl3aS5iZT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEpvb3N0LVdpbSBCb2VrZXN0ZWlqbiA8am9vc3Qtd2ltQGJvZWtlc3RlaWpuLm5sPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgS3JpcyBLb3dhbCA8a3Jpcy5rb3dhbEBjaXhhci5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBZdXN1a2UgU3V6dWtpIDx1dGF0YW5lLnRlYUBnbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBBcnBhZCBCb3Jzb3MgPGFycGFkLmJvcnNvc0Bnb29nbGVtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDExIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuXG4gIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dFxuICBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcblxuICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuXG4gIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4gIEFORCBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEVcbiAgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIDxDT1BZUklHSFQgSE9MREVSPiBCRSBMSUFCTEUgRk9SIEFOWVxuICBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFU1xuICAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuICBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVFxuICAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0ZcbiAgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiovXG5cbihmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIFRva2VuLFxuICAgICAgICBUb2tlbk5hbWUsXG4gICAgICAgIFN5bnRheCxcbiAgICAgICAgTWVzc2FnZXMsXG4gICAgICAgIHNvdXJjZSxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIGxlbmd0aCxcbiAgICAgICAgZGVsZWdhdGUsXG4gICAgICAgIGxvb2thaGVhZCxcbiAgICAgICAgc3RhdGU7XG5cbiAgICBUb2tlbiA9IHtcbiAgICAgICAgQm9vbGVhbkxpdGVyYWw6IDEsXG4gICAgICAgIEVPRjogMixcbiAgICAgICAgSWRlbnRpZmllcjogMyxcbiAgICAgICAgS2V5d29yZDogNCxcbiAgICAgICAgTnVsbExpdGVyYWw6IDUsXG4gICAgICAgIE51bWVyaWNMaXRlcmFsOiA2LFxuICAgICAgICBQdW5jdHVhdG9yOiA3LFxuICAgICAgICBTdHJpbmdMaXRlcmFsOiA4XG4gICAgfTtcblxuICAgIFRva2VuTmFtZSA9IHt9O1xuICAgIFRva2VuTmFtZVtUb2tlbi5Cb29sZWFuTGl0ZXJhbF0gPSAnQm9vbGVhbic7XG4gICAgVG9rZW5OYW1lW1Rva2VuLkVPRl0gPSAnPGVuZD4nO1xuICAgIFRva2VuTmFtZVtUb2tlbi5JZGVudGlmaWVyXSA9ICdJZGVudGlmaWVyJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uS2V5d29yZF0gPSAnS2V5d29yZCc7XG4gICAgVG9rZW5OYW1lW1Rva2VuLk51bGxMaXRlcmFsXSA9ICdOdWxsJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uTnVtZXJpY0xpdGVyYWxdID0gJ051bWVyaWMnO1xuICAgIFRva2VuTmFtZVtUb2tlbi5QdW5jdHVhdG9yXSA9ICdQdW5jdHVhdG9yJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uU3RyaW5nTGl0ZXJhbF0gPSAnU3RyaW5nJztcblxuICAgIFN5bnRheCA9IHtcbiAgICAgICAgQXJyYXlFeHByZXNzaW9uOiAnQXJyYXlFeHByZXNzaW9uJyxcbiAgICAgICAgQmluYXJ5RXhwcmVzc2lvbjogJ0JpbmFyeUV4cHJlc3Npb24nLFxuICAgICAgICBDYWxsRXhwcmVzc2lvbjogJ0NhbGxFeHByZXNzaW9uJyxcbiAgICAgICAgQ29uZGl0aW9uYWxFeHByZXNzaW9uOiAnQ29uZGl0aW9uYWxFeHByZXNzaW9uJyxcbiAgICAgICAgRW1wdHlTdGF0ZW1lbnQ6ICdFbXB0eVN0YXRlbWVudCcsXG4gICAgICAgIEV4cHJlc3Npb25TdGF0ZW1lbnQ6ICdFeHByZXNzaW9uU3RhdGVtZW50JyxcbiAgICAgICAgSWRlbnRpZmllcjogJ0lkZW50aWZpZXInLFxuICAgICAgICBMaXRlcmFsOiAnTGl0ZXJhbCcsXG4gICAgICAgIExhYmVsZWRTdGF0ZW1lbnQ6ICdMYWJlbGVkU3RhdGVtZW50JyxcbiAgICAgICAgTG9naWNhbEV4cHJlc3Npb246ICdMb2dpY2FsRXhwcmVzc2lvbicsXG4gICAgICAgIE1lbWJlckV4cHJlc3Npb246ICdNZW1iZXJFeHByZXNzaW9uJyxcbiAgICAgICAgT2JqZWN0RXhwcmVzc2lvbjogJ09iamVjdEV4cHJlc3Npb24nLFxuICAgICAgICBQcm9ncmFtOiAnUHJvZ3JhbScsXG4gICAgICAgIFByb3BlcnR5OiAnUHJvcGVydHknLFxuICAgICAgICBUaGlzRXhwcmVzc2lvbjogJ1RoaXNFeHByZXNzaW9uJyxcbiAgICAgICAgVW5hcnlFeHByZXNzaW9uOiAnVW5hcnlFeHByZXNzaW9uJ1xuICAgIH07XG5cbiAgICAvLyBFcnJvciBtZXNzYWdlcyBzaG91bGQgYmUgaWRlbnRpY2FsIHRvIFY4LlxuICAgIE1lc3NhZ2VzID0ge1xuICAgICAgICBVbmV4cGVjdGVkVG9rZW46ICdVbmV4cGVjdGVkIHRva2VuICUwJyxcbiAgICAgICAgVW5rbm93bkxhYmVsOiAnVW5kZWZpbmVkIGxhYmVsIFxcJyUwXFwnJyxcbiAgICAgICAgUmVkZWNsYXJhdGlvbjogJyUwIFxcJyUxXFwnIGhhcyBhbHJlYWR5IGJlZW4gZGVjbGFyZWQnXG4gICAgfTtcblxuICAgIC8vIEVuc3VyZSB0aGUgY29uZGl0aW9uIGlzIHRydWUsIG90aGVyd2lzZSB0aHJvdyBhbiBlcnJvci5cbiAgICAvLyBUaGlzIGlzIG9ubHkgdG8gaGF2ZSBhIGJldHRlciBjb250cmFjdCBzZW1hbnRpYywgaS5lLiBhbm90aGVyIHNhZmV0eSBuZXRcbiAgICAvLyB0byBjYXRjaCBhIGxvZ2ljIGVycm9yLiBUaGUgY29uZGl0aW9uIHNoYWxsIGJlIGZ1bGZpbGxlZCBpbiBub3JtYWwgY2FzZS5cbiAgICAvLyBEbyBOT1QgdXNlIHRoaXMgdG8gZW5mb3JjZSBhIGNlcnRhaW4gY29uZGl0aW9uIG9uIGFueSB1c2VyIGlucHV0LlxuXG4gICAgZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICAgICAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBU1NFUlQ6ICcgKyBtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzRGVjaW1hbERpZ2l0KGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPj0gNDggJiYgY2ggPD0gNTcpOyAgIC8vIDAuLjlcbiAgICB9XG5cblxuICAgIC8vIDcuMiBXaGl0ZSBTcGFjZVxuXG4gICAgZnVuY3Rpb24gaXNXaGl0ZVNwYWNlKGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDMyKSB8fCAgLy8gc3BhY2VcbiAgICAgICAgICAgIChjaCA9PT0gOSkgfHwgICAgICAvLyB0YWJcbiAgICAgICAgICAgIChjaCA9PT0gMHhCKSB8fFxuICAgICAgICAgICAgKGNoID09PSAweEMpIHx8XG4gICAgICAgICAgICAoY2ggPT09IDB4QTApIHx8XG4gICAgICAgICAgICAoY2ggPj0gMHgxNjgwICYmICdcXHUxNjgwXFx1MTgwRVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBBXFx1MjAyRlxcdTIwNUZcXHUzMDAwXFx1RkVGRicuaW5kZXhPZihTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSkgPiAwKTtcbiAgICB9XG5cbiAgICAvLyA3LjMgTGluZSBUZXJtaW5hdG9yc1xuXG4gICAgZnVuY3Rpb24gaXNMaW5lVGVybWluYXRvcihjaCkge1xuICAgICAgICByZXR1cm4gKGNoID09PSAxMCkgfHwgKGNoID09PSAxMykgfHwgKGNoID09PSAweDIwMjgpIHx8IChjaCA9PT0gMHgyMDI5KTtcbiAgICB9XG5cbiAgICAvLyA3LjYgSWRlbnRpZmllciBOYW1lcyBhbmQgSWRlbnRpZmllcnNcblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllclN0YXJ0KGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDM2KSB8fCAoY2ggPT09IDk1KSB8fCAgLy8gJCAoZG9sbGFyKSBhbmQgXyAodW5kZXJzY29yZSlcbiAgICAgICAgICAgIChjaCA+PSA2NSAmJiBjaCA8PSA5MCkgfHwgICAgICAgICAvLyBBLi5aXG4gICAgICAgICAgICAoY2ggPj0gOTcgJiYgY2ggPD0gMTIyKTsgICAgICAgICAgLy8gYS4uelxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllclBhcnQoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA9PT0gMzYpIHx8IChjaCA9PT0gOTUpIHx8ICAvLyAkIChkb2xsYXIpIGFuZCBfICh1bmRlcnNjb3JlKVxuICAgICAgICAgICAgKGNoID49IDY1ICYmIGNoIDw9IDkwKSB8fCAgICAgICAgIC8vIEEuLlpcbiAgICAgICAgICAgIChjaCA+PSA5NyAmJiBjaCA8PSAxMjIpIHx8ICAgICAgICAvLyBhLi56XG4gICAgICAgICAgICAoY2ggPj0gNDggJiYgY2ggPD0gNTcpOyAgICAgICAgICAgLy8gMC4uOVxuICAgIH1cblxuICAgIC8vIDcuNi4xLjEgS2V5d29yZHNcblxuICAgIGZ1bmN0aW9uIGlzS2V5d29yZChpZCkge1xuICAgICAgICByZXR1cm4gKGlkID09PSAndGhpcycpXG4gICAgfVxuXG4gICAgLy8gNy40IENvbW1lbnRzXG5cbiAgICBmdW5jdGlvbiBza2lwV2hpdGVzcGFjZSgpIHtcbiAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuZ3RoICYmIGlzV2hpdGVTcGFjZShzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICArK2luZGV4O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0SWRlbnRpZmllcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0LCBjaDtcblxuICAgICAgICBzdGFydCA9IGluZGV4Kys7XG4gICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgY2ggPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCk7XG4gICAgICAgICAgICBpZiAoaXNJZGVudGlmaWVyUGFydChjaCkpIHtcbiAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzb3VyY2Uuc2xpY2Uoc3RhcnQsIGluZGV4KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY2FuSWRlbnRpZmllcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0LCBpZCwgdHlwZTtcblxuICAgICAgICBzdGFydCA9IGluZGV4O1xuXG4gICAgICAgIGlkID0gZ2V0SWRlbnRpZmllcigpO1xuXG4gICAgICAgIC8vIFRoZXJlIGlzIG5vIGtleXdvcmQgb3IgbGl0ZXJhbCB3aXRoIG9ubHkgb25lIGNoYXJhY3Rlci5cbiAgICAgICAgLy8gVGh1cywgaXQgbXVzdCBiZSBhbiBpZGVudGlmaWVyLlxuICAgICAgICBpZiAoaWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uSWRlbnRpZmllcjtcbiAgICAgICAgfSBlbHNlIGlmIChpc0tleXdvcmQoaWQpKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uS2V5d29yZDtcbiAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gJ251bGwnKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uTnVsbExpdGVyYWw7XG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICd0cnVlJyB8fCBpZCA9PT0gJ2ZhbHNlJykge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLkJvb2xlYW5MaXRlcmFsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLklkZW50aWZpZXI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiBpZCxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLy8gNy43IFB1bmN0dWF0b3JzXG5cbiAgICBmdW5jdGlvbiBzY2FuUHVuY3R1YXRvcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gaW5kZXgsXG4gICAgICAgICAgICBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpLFxuICAgICAgICAgICAgY29kZTIsXG4gICAgICAgICAgICBjaDEgPSBzb3VyY2VbaW5kZXhdLFxuICAgICAgICAgICAgY2gyO1xuXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgbW9zdCBjb21tb24gc2luZ2xlLWNoYXJhY3RlciBwdW5jdHVhdG9ycy5cbiAgICAgICAgICAgIGNhc2UgNDY6ICAgLy8gLiBkb3RcbiAgICAgICAgICAgIGNhc2UgNDA6ICAgLy8gKCBvcGVuIGJyYWNrZXRcbiAgICAgICAgICAgIGNhc2UgNDE6ICAgLy8gKSBjbG9zZSBicmFja2V0XG4gICAgICAgICAgICBjYXNlIDU5OiAgIC8vIDsgc2VtaWNvbG9uXG4gICAgICAgICAgICBjYXNlIDQ0OiAgIC8vICwgY29tbWFcbiAgICAgICAgICAgIGNhc2UgMTIzOiAgLy8geyBvcGVuIGN1cmx5IGJyYWNlXG4gICAgICAgICAgICBjYXNlIDEyNTogIC8vIH0gY2xvc2UgY3VybHkgYnJhY2VcbiAgICAgICAgICAgIGNhc2UgOTE6ICAgLy8gW1xuICAgICAgICAgICAgY2FzZSA5MzogICAvLyBdXG4gICAgICAgICAgICBjYXNlIDU4OiAgIC8vIDpcbiAgICAgICAgICAgIGNhc2UgNjM6ICAgLy8gP1xuICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSksXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29kZTIgPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCArIDEpO1xuXG4gICAgICAgICAgICAgICAgLy8gJz0nIChjaGFyICM2MSkgbWFya3MgYW4gYXNzaWdubWVudCBvciBjb21wYXJpc29uIG9wZXJhdG9yLlxuICAgICAgICAgICAgICAgIGlmIChjb2RlMiA9PT0gNjEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OiAgLy8gJVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzODogIC8vICZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDI6ICAvLyAqOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MzogIC8vICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDU6ICAvLyAtXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ3OiAgLy8gL1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2MDogIC8vIDxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjI6ICAvLyA+XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyNDogLy8gfFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzogLy8gIVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2MTogLy8gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhPT0gYW5kID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkgPT09IDYxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzb3VyY2Uuc2xpY2Uoc3RhcnQsIGluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQZWVrIG1vcmUgY2hhcmFjdGVycy5cblxuICAgICAgICBjaDIgPSBzb3VyY2VbaW5kZXggKyAxXTtcblxuICAgICAgICAvLyBPdGhlciAyLWNoYXJhY3RlciBwdW5jdHVhdG9yczogJiYgfHxcblxuICAgICAgICBpZiAoY2gxID09PSBjaDIgJiYgKCcmfCcuaW5kZXhPZihjaDEpID49IDApKSB7XG4gICAgICAgICAgICBpbmRleCArPSAyO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjaDEgKyBjaDIsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCc8Pj0hKy0qJSZ8Xi8nLmluZGV4T2YoY2gxKSA+PSAwKSB7XG4gICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjaDEsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgIH1cblxuICAgIC8vIDcuOC4zIE51bWVyaWMgTGl0ZXJhbHNcbiAgICBmdW5jdGlvbiBzY2FuTnVtZXJpY0xpdGVyYWwoKSB7XG4gICAgICAgIHZhciBudW1iZXIsIHN0YXJ0LCBjaDtcblxuICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIGFzc2VydChpc0RlY2ltYWxEaWdpdChjaC5jaGFyQ29kZUF0KDApKSB8fCAoY2ggPT09ICcuJyksXG4gICAgICAgICAgICAnTnVtZXJpYyBsaXRlcmFsIG11c3Qgc3RhcnQgd2l0aCBhIGRlY2ltYWwgZGlnaXQgb3IgYSBkZWNpbWFsIHBvaW50Jyk7XG5cbiAgICAgICAgc3RhcnQgPSBpbmRleDtcbiAgICAgICAgbnVtYmVyID0gJyc7XG4gICAgICAgIGlmIChjaCAhPT0gJy4nKSB7XG4gICAgICAgICAgICBudW1iZXIgPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG5cbiAgICAgICAgICAgIC8vIEhleCBudW1iZXIgc3RhcnRzIHdpdGggJzB4Jy5cbiAgICAgICAgICAgIC8vIE9jdGFsIG51bWJlciBzdGFydHMgd2l0aCAnMCcuXG4gICAgICAgICAgICBpZiAobnVtYmVyID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAvLyBkZWNpbWFsIG51bWJlciBzdGFydHMgd2l0aCAnMCcgc3VjaCBhcyAnMDknIGlzIGlsbGVnYWwuXG4gICAgICAgICAgICAgICAgaWYgKGNoICYmIGlzRGVjaW1hbERpZ2l0KGNoLmNoYXJDb2RlQXQoMCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaCA9PT0gJy4nKSB7XG4gICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgd2hpbGUgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoID09PSAnZScgfHwgY2ggPT09ICdFJykge1xuICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcblxuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGNoID09PSAnKycgfHwgY2ggPT09ICctJykge1xuICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFRva2VuLk51bWVyaWNMaXRlcmFsLFxuICAgICAgICAgICAgdmFsdWU6IHBhcnNlRmxvYXQobnVtYmVyKSxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIDcuOC40IFN0cmluZyBMaXRlcmFsc1xuXG4gICAgZnVuY3Rpb24gc2NhblN0cmluZ0xpdGVyYWwoKSB7XG4gICAgICAgIHZhciBzdHIgPSAnJywgcXVvdGUsIHN0YXJ0LCBjaCwgb2N0YWwgPSBmYWxzZTtcblxuICAgICAgICBxdW90ZSA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIGFzc2VydCgocXVvdGUgPT09ICdcXCcnIHx8IHF1b3RlID09PSAnXCInKSxcbiAgICAgICAgICAgICdTdHJpbmcgbGl0ZXJhbCBtdXN0IHN0YXJ0cyB3aXRoIGEgcXVvdGUnKTtcblxuICAgICAgICBzdGFydCA9IGluZGV4O1xuICAgICAgICArK2luZGV4O1xuXG4gICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXgrK107XG5cbiAgICAgICAgICAgIGlmIChjaCA9PT0gcXVvdGUpIHtcbiAgICAgICAgICAgICAgICBxdW90ZSA9ICcnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjaCA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICAgICAgaWYgKCFjaCB8fCAhaXNMaW5lVGVybWluYXRvcihjaC5jaGFyQ29kZUF0KDApKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xccic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcdCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdiJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcYic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcZic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd2JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xceDBCJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gY2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09ICdcXHInICYmIHNvdXJjZVtpbmRleF0gPT09ICdcXG4nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0xpbmVUZXJtaW5hdG9yKGNoLmNoYXJDb2RlQXQoMCkpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0ciArPSBjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdW90ZSAhPT0gJycpIHtcbiAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBUb2tlbi5TdHJpbmdMaXRlcmFsLFxuICAgICAgICAgICAgdmFsdWU6IHN0cixcbiAgICAgICAgICAgIG9jdGFsOiBvY3RhbCxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllck5hbWUodG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIHRva2VuLnR5cGUgPT09IFRva2VuLklkZW50aWZpZXIgfHxcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPT09IFRva2VuLktleXdvcmQgfHxcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPT09IFRva2VuLkJvb2xlYW5MaXRlcmFsIHx8XG4gICAgICAgICAgICB0b2tlbi50eXBlID09PSBUb2tlbi5OdWxsTGl0ZXJhbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZHZhbmNlKCkge1xuICAgICAgICB2YXIgY2g7XG5cbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcblxuICAgICAgICBpZiAoaW5kZXggPj0gbGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLkVPRixcbiAgICAgICAgICAgICAgICByYW5nZTogW2luZGV4LCBpbmRleF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjaCA9IHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KTtcblxuICAgICAgICAvLyBWZXJ5IGNvbW1vbjogKCBhbmQgKSBhbmQgO1xuICAgICAgICBpZiAoY2ggPT09IDQwIHx8IGNoID09PSA0MSB8fCBjaCA9PT0gNTgpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuUHVuY3R1YXRvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3RyaW5nIGxpdGVyYWwgc3RhcnRzIHdpdGggc2luZ2xlIHF1b3RlICgjMzkpIG9yIGRvdWJsZSBxdW90ZSAoIzM0KS5cbiAgICAgICAgaWYgKGNoID09PSAzOSB8fCBjaCA9PT0gMzQpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuU3RyaW5nTGl0ZXJhbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KGNoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5JZGVudGlmaWVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEb3QgKC4pIGNoYXIgIzQ2IGNhbiBhbHNvIHN0YXJ0IGEgZmxvYXRpbmctcG9pbnQgbnVtYmVyLCBoZW5jZSB0aGUgbmVlZFxuICAgICAgICAvLyB0byBjaGVjayB0aGUgbmV4dCBjaGFyYWN0ZXIuXG4gICAgICAgIGlmIChjaCA9PT0gNDYpIHtcbiAgICAgICAgICAgIGlmIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCArIDEpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzY2FuTnVtZXJpY0xpdGVyYWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzY2FuUHVuY3R1YXRvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzRGVjaW1hbERpZ2l0KGNoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5OdW1lcmljTGl0ZXJhbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNjYW5QdW5jdHVhdG9yKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGV4KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgdG9rZW4gPSBsb29rYWhlYWQ7XG4gICAgICAgIGluZGV4ID0gdG9rZW4ucmFuZ2VbMV07XG5cbiAgICAgICAgbG9va2FoZWFkID0gYWR2YW5jZSgpO1xuXG4gICAgICAgIGluZGV4ID0gdG9rZW4ucmFuZ2VbMV07XG5cbiAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBlZWsoKSB7XG4gICAgICAgIHZhciBwb3M7XG5cbiAgICAgICAgcG9zID0gaW5kZXg7XG4gICAgICAgIGxvb2thaGVhZCA9IGFkdmFuY2UoKTtcbiAgICAgICAgaW5kZXggPSBwb3M7XG4gICAgfVxuXG4gICAgLy8gVGhyb3cgYW4gZXhjZXB0aW9uXG5cbiAgICBmdW5jdGlvbiB0aHJvd0Vycm9yKHRva2VuLCBtZXNzYWdlRm9ybWF0KSB7XG4gICAgICAgIHZhciBlcnJvcixcbiAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLFxuICAgICAgICAgICAgbXNnID0gbWVzc2FnZUZvcm1hdC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgIC8lKFxcZCkvZyxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAod2hvbGUsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChpbmRleCA8IGFyZ3MubGVuZ3RoLCAnTWVzc2FnZSByZWZlcmVuY2UgbXVzdCBiZSBpbiByYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnc1tpbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBlcnJvciA9IG5ldyBFcnJvcihtc2cpO1xuICAgICAgICBlcnJvci5pbmRleCA9IGluZGV4O1xuICAgICAgICBlcnJvci5kZXNjcmlwdGlvbiA9IG1zZztcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgLy8gVGhyb3cgYW4gZXhjZXB0aW9uIGJlY2F1c2Ugb2YgdGhlIHRva2VuLlxuXG4gICAgZnVuY3Rpb24gdGhyb3dVbmV4cGVjdGVkKHRva2VuKSB7XG4gICAgICAgIHRocm93RXJyb3IodG9rZW4sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgdG9rZW4udmFsdWUpO1xuICAgIH1cblxuICAgIC8vIEV4cGVjdCB0aGUgbmV4dCB0b2tlbiB0byBtYXRjaCB0aGUgc3BlY2lmaWVkIHB1bmN0dWF0b3IuXG4gICAgLy8gSWYgbm90LCBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24uXG5cbiAgICBmdW5jdGlvbiBleHBlY3QodmFsdWUpIHtcbiAgICAgICAgdmFyIHRva2VuID0gbGV4KCk7XG4gICAgICAgIGlmICh0b2tlbi50eXBlICE9PSBUb2tlbi5QdW5jdHVhdG9yIHx8IHRva2VuLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKHRva2VuKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSBuZXh0IHRva2VuIG1hdGNoZXMgdGhlIHNwZWNpZmllZCBwdW5jdHVhdG9yLlxuXG4gICAgZnVuY3Rpb24gbWF0Y2godmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGxvb2thaGVhZC50eXBlID09PSBUb2tlbi5QdW5jdHVhdG9yICYmIGxvb2thaGVhZC52YWx1ZSA9PT0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRydWUgaWYgdGhlIG5leHQgdG9rZW4gbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIGtleXdvcmRcblxuICAgIGZ1bmN0aW9uIG1hdGNoS2V5d29yZChrZXl3b3JkKSB7XG4gICAgICAgIHJldHVybiBsb29rYWhlYWQudHlwZSA9PT0gVG9rZW4uS2V5d29yZCAmJiBsb29rYWhlYWQudmFsdWUgPT09IGtleXdvcmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29uc3VtZVNlbWljb2xvbigpIHtcbiAgICAgICAgLy8gQ2F0Y2ggdGhlIHZlcnkgY29tbW9uIGNhc2UgZmlyc3Q6IGltbWVkaWF0ZWx5IGEgc2VtaWNvbG9uIChjaGFyICM1OSkuXG4gICAgICAgIGlmIChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkgPT09IDU5KSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG5cbiAgICAgICAgaWYgKG1hdGNoKCc7JykpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5FT0YgJiYgIW1hdGNoKCd9JykpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChsb29rYWhlYWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gMTEuMS40IEFycmF5IEluaXRpYWxpc2VyXG5cbiAgICBmdW5jdGlvbiBwYXJzZUFycmF5SW5pdGlhbGlzZXIoKSB7XG4gICAgICAgIHZhciBlbGVtZW50cyA9IFtdO1xuXG4gICAgICAgIGV4cGVjdCgnWycpO1xuXG4gICAgICAgIHdoaWxlICghbWF0Y2goJ10nKSkge1xuICAgICAgICAgICAgaWYgKG1hdGNoKCcsJykpIHtcbiAgICAgICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5wdXNoKHBhcnNlRXhwcmVzc2lvbigpKTtcblxuICAgICAgICAgICAgICAgIGlmICghbWF0Y2goJ10nKSkge1xuICAgICAgICAgICAgICAgICAgICBleHBlY3QoJywnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBleHBlY3QoJ10nKTtcblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlQXJyYXlFeHByZXNzaW9uKGVsZW1lbnRzKTtcbiAgICB9XG5cbiAgICAvLyAxMS4xLjUgT2JqZWN0IEluaXRpYWxpc2VyXG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdFByb3BlcnR5S2V5KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcbiAgICAgICAgdG9rZW4gPSBsZXgoKTtcblxuICAgICAgICAvLyBOb3RlOiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbmx5IGZyb20gcGFyc2VPYmplY3RQcm9wZXJ0eSgpLCB3aGVyZVxuICAgICAgICAvLyBFT0YgYW5kIFB1bmN0dWF0b3IgdG9rZW5zIGFyZSBhbHJlYWR5IGZpbHRlcmVkIG91dC5cbiAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09IFRva2VuLlN0cmluZ0xpdGVyYWwgfHwgdG9rZW4udHlwZSA9PT0gVG9rZW4uTnVtZXJpY0xpdGVyYWwpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKHRva2VuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVJZGVudGlmaWVyKHRva2VuLnZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdFByb3BlcnR5KCkge1xuICAgICAgICB2YXIgdG9rZW4sIGtleTtcblxuICAgICAgICB0b2tlbiA9IGxvb2thaGVhZDtcbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcblxuICAgICAgICBpZiAodG9rZW4udHlwZSA9PT0gVG9rZW4uRU9GIHx8IHRva2VuLnR5cGUgPT09IFRva2VuLlB1bmN0dWF0b3IpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZCh0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICBrZXkgPSBwYXJzZU9iamVjdFByb3BlcnR5S2V5KCk7XG4gICAgICAgIGV4cGVjdCgnOicpO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlUHJvcGVydHkoJ2luaXQnLCBrZXksIHBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdEluaXRpYWxpc2VyKCkge1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IFtdO1xuXG4gICAgICAgIGV4cGVjdCgneycpO1xuXG4gICAgICAgIHdoaWxlICghbWF0Y2goJ30nKSkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKHBhcnNlT2JqZWN0UHJvcGVydHkoKSk7XG5cbiAgICAgICAgICAgIGlmICghbWF0Y2goJ30nKSkge1xuICAgICAgICAgICAgICAgIGV4cGVjdCgnLCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwZWN0KCd9Jyk7XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZU9iamVjdEV4cHJlc3Npb24ocHJvcGVydGllcyk7XG4gICAgfVxuXG4gICAgLy8gMTEuMS42IFRoZSBHcm91cGluZyBPcGVyYXRvclxuXG4gICAgZnVuY3Rpb24gcGFyc2VHcm91cEV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciBleHByO1xuXG4gICAgICAgIGV4cGVjdCgnKCcpO1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oKTtcblxuICAgICAgICBleHBlY3QoJyknKTtcblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cblxuICAgIC8vIDExLjEgUHJpbWFyeSBFeHByZXNzaW9uc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VQcmltYXJ5RXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIHR5cGUsIHRva2VuLCBleHByO1xuXG4gICAgICAgIGlmIChtYXRjaCgnKCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VHcm91cEV4cHJlc3Npb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHR5cGUgPSBsb29rYWhlYWQudHlwZTtcblxuICAgICAgICBpZiAodHlwZSA9PT0gVG9rZW4uSWRlbnRpZmllcikge1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUlkZW50aWZpZXIobGV4KCkudmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLlN0cmluZ0xpdGVyYWwgfHwgdHlwZSA9PT0gVG9rZW4uTnVtZXJpY0xpdGVyYWwpIHtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKGxleCgpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5LZXl3b3JkKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2hLZXl3b3JkKCd0aGlzJykpIHtcbiAgICAgICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlVGhpc0V4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5Cb29sZWFuTGl0ZXJhbCkge1xuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIHRva2VuLnZhbHVlID0gKHRva2VuLnZhbHVlID09PSAndHJ1ZScpO1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwodG9rZW4pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLk51bGxMaXRlcmFsKSB7XG4gICAgICAgICAgICB0b2tlbiA9IGxleCgpO1xuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwodG9rZW4pO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCdbJykpIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZUFycmF5SW5pdGlhbGlzZXIoKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgneycpKSB7XG4gICAgICAgICAgICBleHByID0gcGFyc2VPYmplY3RJbml0aWFsaXNlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV4cHIpIHtcbiAgICAgICAgICAgIHJldHVybiBleHByO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGxleCgpKTtcbiAgICB9XG5cbiAgICAvLyAxMS4yIExlZnQtSGFuZC1TaWRlIEV4cHJlc3Npb25zXG5cbiAgICBmdW5jdGlvbiBwYXJzZUFyZ3VtZW50cygpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcblxuICAgICAgICBleHBlY3QoJygnKTtcblxuICAgICAgICBpZiAoIW1hdGNoKCcpJykpIHtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKCcpJykpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGV4cGVjdCgnLCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwZWN0KCcpJyk7XG5cbiAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VOb25Db21wdXRlZFByb3BlcnR5KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgdG9rZW4gPSBsZXgoKTtcblxuICAgICAgICBpZiAoIWlzSWRlbnRpZmllck5hbWUodG9rZW4pKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQodG9rZW4pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUlkZW50aWZpZXIodG9rZW4udmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlTm9uQ29tcHV0ZWRNZW1iZXIoKSB7XG4gICAgICAgIGV4cGVjdCgnLicpO1xuXG4gICAgICAgIHJldHVybiBwYXJzZU5vbkNvbXB1dGVkUHJvcGVydHkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUNvbXB1dGVkTWVtYmVyKCkge1xuICAgICAgICB2YXIgZXhwcjtcblxuICAgICAgICBleHBlY3QoJ1snKTtcblxuICAgICAgICBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgZXhwZWN0KCddJyk7XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VMZWZ0SGFuZFNpZGVFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgYXJncywgcHJvcGVydHk7XG5cbiAgICAgICAgZXhwciA9IHBhcnNlUHJpbWFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgaWYgKG1hdGNoKCdbJykpIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IHBhcnNlQ29tcHV0ZWRNZW1iZXIoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTWVtYmVyRXhwcmVzc2lvbignWycsIGV4cHIsIHByb3BlcnR5KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJy4nKSkge1xuICAgICAgICAgICAgICAgIHByb3BlcnR5ID0gcGFyc2VOb25Db21wdXRlZE1lbWJlcigpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVNZW1iZXJFeHByZXNzaW9uKCcuJywgZXhwciwgcHJvcGVydHkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgnKCcpKSB7XG4gICAgICAgICAgICAgICAgYXJncyA9IHBhcnNlQXJndW1lbnRzKCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUNhbGxFeHByZXNzaW9uKGV4cHIsIGFyZ3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuICAgIC8vIDExLjMgUG9zdGZpeCBFeHByZXNzaW9uc1xuXG4gICAgdmFyIHBhcnNlUG9zdGZpeEV4cHJlc3Npb24gPSBwYXJzZUxlZnRIYW5kU2lkZUV4cHJlc3Npb247XG5cbiAgICAvLyAxMS40IFVuYXJ5IE9wZXJhdG9yc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VVbmFyeUV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciB0b2tlbiwgZXhwcjtcblxuICAgICAgICBpZiAobG9va2FoZWFkLnR5cGUgIT09IFRva2VuLlB1bmN0dWF0b3IgJiYgbG9va2FoZWFkLnR5cGUgIT09IFRva2VuLktleXdvcmQpIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVBvc3RmaXhFeHByZXNzaW9uKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJysnKSB8fCBtYXRjaCgnLScpIHx8IG1hdGNoKCchJykpIHtcbiAgICAgICAgICAgIHRva2VuID0gbGV4KCk7XG4gICAgICAgICAgICBleHByID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVVbmFyeUV4cHJlc3Npb24odG9rZW4udmFsdWUsIGV4cHIpO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoS2V5d29yZCgnZGVsZXRlJykgfHwgbWF0Y2hLZXl3b3JkKCd2b2lkJykgfHwgbWF0Y2hLZXl3b3JkKCd0eXBlb2YnKSkge1xuICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVBvc3RmaXhFeHByZXNzaW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBiaW5hcnlQcmVjZWRlbmNlKHRva2VuKSB7XG4gICAgICAgIHZhciBwcmVjID0gMDtcblxuICAgICAgICBpZiAodG9rZW4udHlwZSAhPT0gVG9rZW4uUHVuY3R1YXRvciAmJiB0b2tlbi50eXBlICE9PSBUb2tlbi5LZXl3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAodG9rZW4udmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3x8JzpcbiAgICAgICAgICAgICAgICBwcmVjID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnJiYnOlxuICAgICAgICAgICAgICAgIHByZWMgPSAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICc9PSc6XG4gICAgICAgICAgICBjYXNlICchPSc6XG4gICAgICAgICAgICBjYXNlICc9PT0nOlxuICAgICAgICAgICAgY2FzZSAnIT09JzpcbiAgICAgICAgICAgICAgICBwcmVjID0gNjtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIGNhc2UgJzw9JzpcbiAgICAgICAgICAgIGNhc2UgJz49JzpcbiAgICAgICAgICAgIGNhc2UgJ2luc3RhbmNlb2YnOlxuICAgICAgICAgICAgICAgIHByZWMgPSA3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdpbic6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgY2FzZSAnLSc6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJyonOlxuICAgICAgICAgICAgY2FzZSAnLyc6XG4gICAgICAgICAgICBjYXNlICclJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gMTE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJlYztcbiAgICB9XG5cbiAgICAvLyAxMS41IE11bHRpcGxpY2F0aXZlIE9wZXJhdG9yc1xuICAgIC8vIDExLjYgQWRkaXRpdmUgT3BlcmF0b3JzXG4gICAgLy8gMTEuNyBCaXR3aXNlIFNoaWZ0IE9wZXJhdG9yc1xuICAgIC8vIDExLjggUmVsYXRpb25hbCBPcGVyYXRvcnNcbiAgICAvLyAxMS45IEVxdWFsaXR5IE9wZXJhdG9yc1xuICAgIC8vIDExLjEwIEJpbmFyeSBCaXR3aXNlIE9wZXJhdG9yc1xuICAgIC8vIDExLjExIEJpbmFyeSBMb2dpY2FsIE9wZXJhdG9yc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VCaW5hcnlFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgdG9rZW4sIHByZWMsIHN0YWNrLCByaWdodCwgb3BlcmF0b3IsIGxlZnQsIGk7XG5cbiAgICAgICAgbGVmdCA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgdG9rZW4gPSBsb29rYWhlYWQ7XG4gICAgICAgIHByZWMgPSBiaW5hcnlQcmVjZWRlbmNlKHRva2VuKTtcbiAgICAgICAgaWYgKHByZWMgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBsZWZ0O1xuICAgICAgICB9XG4gICAgICAgIHRva2VuLnByZWMgPSBwcmVjO1xuICAgICAgICBsZXgoKTtcblxuICAgICAgICByaWdodCA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgc3RhY2sgPSBbbGVmdCwgdG9rZW4sIHJpZ2h0XTtcblxuICAgICAgICB3aGlsZSAoKHByZWMgPSBiaW5hcnlQcmVjZWRlbmNlKGxvb2thaGVhZCkpID4gMCkge1xuXG4gICAgICAgICAgICAvLyBSZWR1Y2U6IG1ha2UgYSBiaW5hcnkgZXhwcmVzc2lvbiBmcm9tIHRoZSB0aHJlZSB0b3Btb3N0IGVudHJpZXMuXG4gICAgICAgICAgICB3aGlsZSAoKHN0YWNrLmxlbmd0aCA+IDIpICYmIChwcmVjIDw9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDJdLnByZWMpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBvcGVyYXRvciA9IHN0YWNrLnBvcCgpLnZhbHVlO1xuICAgICAgICAgICAgICAgIGxlZnQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlQmluYXJ5RXhwcmVzc2lvbihvcGVyYXRvciwgbGVmdCwgcmlnaHQpO1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goZXhwcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNoaWZ0LlxuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIHRva2VuLnByZWMgPSBwcmVjO1xuICAgICAgICAgICAgc3RhY2sucHVzaCh0b2tlbik7XG4gICAgICAgICAgICBleHByID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goZXhwcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5hbCByZWR1Y2UgdG8gY2xlYW4tdXAgdGhlIHN0YWNrLlxuICAgICAgICBpID0gc3RhY2subGVuZ3RoIC0gMTtcbiAgICAgICAgZXhwciA9IHN0YWNrW2ldO1xuICAgICAgICB3aGlsZSAoaSA+IDEpIHtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVCaW5hcnlFeHByZXNzaW9uKHN0YWNrW2kgLSAxXS52YWx1ZSwgc3RhY2tbaSAtIDJdLCBleHByKTtcbiAgICAgICAgICAgIGkgLT0gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuXG4gICAgLy8gMTEuMTIgQ29uZGl0aW9uYWwgT3BlcmF0b3JcblxuICAgIGZ1bmN0aW9uIHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgY29uc2VxdWVudCwgYWx0ZXJuYXRlO1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZUJpbmFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICBpZiAobWF0Y2goJz8nKSkge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICBjb25zZXF1ZW50ID0gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIGV4cGVjdCgnOicpO1xuICAgICAgICAgICAgYWx0ZXJuYXRlID0gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb24oKTtcblxuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUNvbmRpdGlvbmFsRXhwcmVzc2lvbihleHByLCBjb25zZXF1ZW50LCBhbHRlcm5hdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgLy8gU2ltcGxpZmljYXRpb24gc2luY2Ugd2UgZG8gbm90IHN1cHBvcnQgQXNzaWdubWVudEV4cHJlc3Npb24uXG4gICAgdmFyIHBhcnNlRXhwcmVzc2lvbiA9IHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uO1xuXG4gICAgLy8gUG9seW1lciBTeW50YXggZXh0ZW5zaW9uc1xuXG4gICAgLy8gRmlsdGVyIDo6XG4gICAgLy8gICBJZGVudGlmaWVyXG4gICAgLy8gICBJZGVudGlmaWVyIFwiKFwiIFwiKVwiXG4gICAgLy8gICBJZGVudGlmaWVyIFwiKFwiIEZpbHRlckFyZ3VtZW50cyBcIilcIlxuXG4gICAgZnVuY3Rpb24gcGFyc2VGaWx0ZXIoKSB7XG4gICAgICAgIHZhciBpZGVudGlmaWVyLCBhcmdzO1xuXG4gICAgICAgIGlkZW50aWZpZXIgPSBsZXgoKTtcblxuICAgICAgICBpZiAoaWRlbnRpZmllci50eXBlICE9PSBUb2tlbi5JZGVudGlmaWVyKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQoaWRlbnRpZmllcik7XG4gICAgICAgIH1cblxuICAgICAgICBhcmdzID0gbWF0Y2goJygnKSA/IHBhcnNlQXJndW1lbnRzKCkgOiBbXTtcblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlRmlsdGVyKGlkZW50aWZpZXIudmFsdWUsIGFyZ3MpO1xuICAgIH1cblxuICAgIC8vIEZpbHRlcnMgOjpcbiAgICAvLyAgIFwifFwiIEZpbHRlclxuICAgIC8vICAgRmlsdGVycyBcInxcIiBGaWx0ZXJcblxuICAgIGZ1bmN0aW9uIHBhcnNlRmlsdGVycygpIHtcbiAgICAgICAgd2hpbGUgKG1hdGNoKCd8JykpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgcGFyc2VGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRvcExldmVsIDo6XG4gICAgLy8gICBMYWJlbGxlZEV4cHJlc3Npb25zXG4gICAgLy8gICBBc0V4cHJlc3Npb25cbiAgICAvLyAgIEluRXhwcmVzc2lvblxuICAgIC8vICAgRmlsdGVyRXhwcmVzc2lvblxuXG4gICAgLy8gQXNFeHByZXNzaW9uIDo6XG4gICAgLy8gICBGaWx0ZXJFeHByZXNzaW9uIGFzIElkZW50aWZpZXJcblxuICAgIC8vIEluRXhwcmVzc2lvbiA6OlxuICAgIC8vICAgSWRlbnRpZmllciwgSWRlbnRpZmllciBpbiBGaWx0ZXJFeHByZXNzaW9uXG4gICAgLy8gICBJZGVudGlmaWVyIGluIEZpbHRlckV4cHJlc3Npb25cblxuICAgIC8vIEZpbHRlckV4cHJlc3Npb24gOjpcbiAgICAvLyAgIEV4cHJlc3Npb25cbiAgICAvLyAgIEV4cHJlc3Npb24gRmlsdGVyc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VUb3BMZXZlbCgpIHtcbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcbiAgICAgICAgcGVlaygpO1xuXG4gICAgICAgIHZhciBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG4gICAgICAgIGlmIChleHByKSB7XG4gICAgICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnLCcgfHwgbG9va2FoZWFkLnZhbHVlID09ICdpbicgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgZXhwci50eXBlID09PSBTeW50YXguSWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgIHBhcnNlSW5FeHByZXNzaW9uKGV4cHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJzZUZpbHRlcnMoKTtcbiAgICAgICAgICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnYXMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlQXNFeHByZXNzaW9uKGV4cHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGVnYXRlLmNyZWF0ZVRvcExldmVsKGV4cHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uRU9GKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQobG9va2FoZWFkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlQXNFeHByZXNzaW9uKGV4cHIpIHtcbiAgICAgICAgbGV4KCk7ICAvLyBhc1xuICAgICAgICB2YXIgaWRlbnRpZmllciA9IGxleCgpLnZhbHVlO1xuICAgICAgICBkZWxlZ2F0ZS5jcmVhdGVBc0V4cHJlc3Npb24oZXhwciwgaWRlbnRpZmllcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VJbkV4cHJlc3Npb24oaWRlbnRpZmllcikge1xuICAgICAgICB2YXIgaW5kZXhOYW1lO1xuICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnLCcpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5JZGVudGlmaWVyKVxuICAgICAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChsb29rYWhlYWQpO1xuICAgICAgICAgICAgaW5kZXhOYW1lID0gbGV4KCkudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXgoKTsgIC8vIGluXG4gICAgICAgIHZhciBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG4gICAgICAgIHBhcnNlRmlsdGVycygpO1xuICAgICAgICBkZWxlZ2F0ZS5jcmVhdGVJbkV4cHJlc3Npb24oaWRlbnRpZmllci5uYW1lLCBpbmRleE5hbWUsIGV4cHIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlKGNvZGUsIGluRGVsZWdhdGUpIHtcbiAgICAgICAgZGVsZWdhdGUgPSBpbkRlbGVnYXRlO1xuICAgICAgICBzb3VyY2UgPSBjb2RlO1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIGxlbmd0aCA9IHNvdXJjZS5sZW5ndGg7XG4gICAgICAgIGxvb2thaGVhZCA9IG51bGw7XG4gICAgICAgIHN0YXRlID0ge1xuICAgICAgICAgICAgbGFiZWxTZXQ6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHBhcnNlVG9wTGV2ZWwoKTtcbiAgICB9XG5cbiAgICBnbG9iYWwuZXNwcmltYSA9IHtcbiAgICAgICAgcGFyc2U6IHBhcnNlXG4gICAgfTtcbn0pKG1vZHVsZS5leHBvcnRzKTsiLCLvu78vKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gZGV0ZWN0RXZhbCgpIHtcbiAgICAvLyBEb24ndCB0ZXN0IGZvciBldmFsIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBDaHJvbWUgQXBwIGVudmlyb25tZW50LlxuICAgIC8vIFdlIGNoZWNrIGZvciBBUElzIHNldCB0aGF0IG9ubHkgZXhpc3QgaW4gYSBDaHJvbWUgQXBwIGNvbnRleHQuXG4gICAgaWYgKHR5cGVvZiBjaHJvbWUgIT09ICd1bmRlZmluZWQnICYmIGNocm9tZS5hcHAgJiYgY2hyb21lLmFwcC5ydW50aW1lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBGaXJlZm94IE9TIEFwcHMgZG8gbm90IGFsbG93IGV2YWwuIFRoaXMgZmVhdHVyZSBkZXRlY3Rpb24gaXMgdmVyeSBoYWNreVxuICAgIC8vIGJ1dCBldmVuIGlmIHNvbWUgb3RoZXIgcGxhdGZvcm0gYWRkcyBzdXBwb3J0IGZvciB0aGlzIGZ1bmN0aW9uIHRoaXMgY29kZVxuICAgIC8vIHdpbGwgY29udGludWUgdG8gd29yay5cbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IuZ2V0RGV2aWNlU3RvcmFnZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGYgPSBuZXcgRnVuY3Rpb24oJycsICdyZXR1cm4gdHJ1ZTsnKTtcbiAgICAgICAgcmV0dXJuIGYoKTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG52YXIgaGFzRXZhbCA9IGRldGVjdEV2YWwoKTtcblxuZnVuY3Rpb24gaXNJbmRleChzKSB7XG4gICAgcmV0dXJuICtzID09PSBzID4+PiAwICYmIHMgIT09ICcnO1xufVxuXG5mdW5jdGlvbiB0b051bWJlcihzKSB7XG4gICAgcmV0dXJuICtzO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbn1cblxudmFyIG51bWJlcklzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzTmFOKHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gYXJlU2FtZVZhbHVlKGxlZnQsIHJpZ2h0KSB7XG4gICAgaWYgKGxlZnQgPT09IHJpZ2h0KVxuICAgICAgICByZXR1cm4gbGVmdCAhPT0gMCB8fCAxIC8gbGVmdCA9PT0gMSAvIHJpZ2h0O1xuICAgIGlmIChudW1iZXJJc05hTihsZWZ0KSAmJiBudW1iZXJJc05hTihyaWdodCkpXG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgcmV0dXJuIGxlZnQgIT09IGxlZnQgJiYgcmlnaHQgIT09IHJpZ2h0O1xufVxuXG52YXIgY3JlYXRlT2JqZWN0ID0gKCdfX3Byb3RvX18nIGluIHt9KSA/XG4gIGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iajsgfSA6XG4gIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHZhciBwcm90byA9IG9iai5fX3Byb3RvX187XG4gICAgICBpZiAoIXByb3RvKVxuICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICB2YXIgbmV3T2JqZWN0ID0gT2JqZWN0LmNyZWF0ZShwcm90byk7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqZWN0LCBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBuYW1lKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXdPYmplY3Q7XG4gIH07XG5cbnZhciBpZGVudFN0YXJ0ID0gJ1tcXCRfYS16QS1aXSc7XG52YXIgaWRlbnRQYXJ0ID0gJ1tcXCRfYS16QS1aMC05XSc7XG52YXIgaWRlbnRSZWdFeHAgPSBuZXcgUmVnRXhwKCdeJyArIGlkZW50U3RhcnQgKyAnKycgKyBpZGVudFBhcnQgKyAnKicgKyAnJCcpO1xuXG5mdW5jdGlvbiBnZXRQYXRoQ2hhclR5cGUoY2hhcikge1xuICAgIGlmIChjaGFyID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiAnZW9mJztcblxuICAgIHZhciBjb2RlID0gY2hhci5jaGFyQ29kZUF0KDApO1xuXG4gICAgc3dpdGNoIChjb2RlKSB7XG4gICAgICAgIGNhc2UgMHg1QjogLy8gW1xuICAgICAgICBjYXNlIDB4NUQ6IC8vIF1cbiAgICAgICAgY2FzZSAweDJFOiAvLyAuXG4gICAgICAgIGNhc2UgMHgyMjogLy8gXCJcbiAgICAgICAgY2FzZSAweDI3OiAvLyAnXG4gICAgICAgIGNhc2UgMHgzMDogLy8gMFxuICAgICAgICAgICAgcmV0dXJuIGNoYXI7XG5cbiAgICAgICAgY2FzZSAweDVGOiAvLyBfXG4gICAgICAgIGNhc2UgMHgyNDogLy8gJFxuICAgICAgICAgICAgcmV0dXJuICdpZGVudCc7XG5cbiAgICAgICAgY2FzZSAweDIwOiAvLyBTcGFjZVxuICAgICAgICBjYXNlIDB4MDk6IC8vIFRhYlxuICAgICAgICBjYXNlIDB4MEE6IC8vIE5ld2xpbmVcbiAgICAgICAgY2FzZSAweDBEOiAvLyBSZXR1cm5cbiAgICAgICAgY2FzZSAweEEwOiAgLy8gTm8tYnJlYWsgc3BhY2VcbiAgICAgICAgY2FzZSAweEZFRkY6ICAvLyBCeXRlIE9yZGVyIE1hcmtcbiAgICAgICAgY2FzZSAweDIwMjg6ICAvLyBMaW5lIFNlcGFyYXRvclxuICAgICAgICBjYXNlIDB4MjAyOTogIC8vIFBhcmFncmFwaCBTZXBhcmF0b3JcbiAgICAgICAgICAgIHJldHVybiAnd3MnO1xuICAgIH1cblxuICAgIC8vIGEteiwgQS1aXG4gICAgaWYgKCgweDYxIDw9IGNvZGUgJiYgY29kZSA8PSAweDdBKSB8fCAoMHg0MSA8PSBjb2RlICYmIGNvZGUgPD0gMHg1QSkpXG4gICAgICAgIHJldHVybiAnaWRlbnQnO1xuXG4gICAgLy8gMS05XG4gICAgaWYgKDB4MzEgPD0gY29kZSAmJiBjb2RlIDw9IDB4MzkpXG4gICAgICAgIHJldHVybiAnbnVtYmVyJztcblxuICAgIHJldHVybiAnZWxzZSc7XG59XG5cbnZhciBwYXRoU3RhdGVNYWNoaW5lID0ge1xuICAgICdiZWZvcmVQYXRoJzoge1xuICAgICAgICAnd3MnOiBbJ2JlZm9yZVBhdGgnXSxcbiAgICAgICAgJ2lkZW50JzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnWyc6IFsnYmVmb3JlRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydhZnRlclBhdGgnXVxuICAgIH0sXG5cbiAgICAnaW5QYXRoJzoge1xuICAgICAgICAnd3MnOiBbJ2luUGF0aCddLFxuICAgICAgICAnLic6IFsnYmVmb3JlSWRlbnQnXSxcbiAgICAgICAgJ1snOiBbJ2JlZm9yZUVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnYWZ0ZXJQYXRoJ11cbiAgICB9LFxuXG4gICAgJ2JlZm9yZUlkZW50Jzoge1xuICAgICAgICAnd3MnOiBbJ2JlZm9yZUlkZW50J10sXG4gICAgICAgICdpZGVudCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXVxuICAgIH0sXG5cbiAgICAnaW5JZGVudCc6IHtcbiAgICAgICAgJ2lkZW50JzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnMCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ251bWJlcic6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ3dzJzogWydpblBhdGgnLCAncHVzaCddLFxuICAgICAgICAnLic6IFsnYmVmb3JlSWRlbnQnLCAncHVzaCddLFxuICAgICAgICAnWyc6IFsnYmVmb3JlRWxlbWVudCcsICdwdXNoJ10sXG4gICAgICAgICdlb2YnOiBbJ2FmdGVyUGF0aCcsICdwdXNoJ11cbiAgICB9LFxuXG4gICAgJ2JlZm9yZUVsZW1lbnQnOiB7XG4gICAgICAgICd3cyc6IFsnYmVmb3JlRWxlbWVudCddLFxuICAgICAgICAnMCc6IFsnYWZ0ZXJaZXJvJywgJ2FwcGVuZCddLFxuICAgICAgICAnbnVtYmVyJzogWydpbkluZGV4JywgJ2FwcGVuZCddLFxuICAgICAgICBcIidcIjogWydpblNpbmdsZVF1b3RlJywgJ2FwcGVuZCcsICcnXSxcbiAgICAgICAgJ1wiJzogWydpbkRvdWJsZVF1b3RlJywgJ2FwcGVuZCcsICcnXVxuICAgIH0sXG5cbiAgICAnYWZ0ZXJaZXJvJzoge1xuICAgICAgICAnd3MnOiBbJ2FmdGVyRWxlbWVudCcsICdwdXNoJ10sXG4gICAgICAgICddJzogWydpblBhdGgnLCAncHVzaCddXG4gICAgfSxcblxuICAgICdpbkluZGV4Jzoge1xuICAgICAgICAnMCc6IFsnaW5JbmRleCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ251bWJlcic6IFsnaW5JbmRleCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ3dzJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ10nOiBbJ2luUGF0aCcsICdwdXNoJ11cbiAgICB9LFxuXG4gICAgJ2luU2luZ2xlUXVvdGUnOiB7XG4gICAgICAgIFwiJ1wiOiBbJ2FmdGVyRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydlcnJvciddLFxuICAgICAgICAnZWxzZSc6IFsnaW5TaW5nbGVRdW90ZScsICdhcHBlbmQnXVxuICAgIH0sXG5cbiAgICAnaW5Eb3VibGVRdW90ZSc6IHtcbiAgICAgICAgJ1wiJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnZXJyb3InXSxcbiAgICAgICAgJ2Vsc2UnOiBbJ2luRG91YmxlUXVvdGUnLCAnYXBwZW5kJ11cbiAgICB9LFxuXG4gICAgJ2FmdGVyRWxlbWVudCc6IHtcbiAgICAgICAgJ3dzJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ10nOiBbJ2luUGF0aCcsICdwdXNoJ11cbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vb3AoKSB7IH1cblxuZnVuY3Rpb24gcGFyc2VQYXRoKHBhdGgpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIHZhciBpbmRleCA9IC0xO1xuICAgIHZhciBjLCBuZXdDaGFyLCBrZXksIHR5cGUsIHRyYW5zaXRpb24sIGFjdGlvbiwgdHlwZU1hcCwgbW9kZSA9ICdiZWZvcmVQYXRoJztcblxuICAgIHZhciBhY3Rpb25zID0ge1xuICAgICAgICBwdXNoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgICAgIGtleSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBrZXkgPSBuZXdDaGFyXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAga2V5ICs9IG5ld0NoYXI7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gbWF5YmVVbmVzY2FwZVF1b3RlKCkge1xuICAgICAgICBpZiAoaW5kZXggPj0gcGF0aC5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgdmFyIG5leHRDaGFyID0gcGF0aFtpbmRleCArIDFdO1xuICAgICAgICBpZiAoKG1vZGUgPT0gJ2luU2luZ2xlUXVvdGUnICYmIG5leHRDaGFyID09IFwiJ1wiKSB8fFxuICAgICAgICAgICAgKG1vZGUgPT0gJ2luRG91YmxlUXVvdGUnICYmIG5leHRDaGFyID09ICdcIicpKSB7XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgbmV3Q2hhciA9IG5leHRDaGFyO1xuICAgICAgICAgICAgYWN0aW9ucy5hcHBlbmQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2hpbGUgKG1vZGUpIHtcbiAgICAgICAgaW5kZXgrKztcbiAgICAgICAgYyA9IHBhdGhbaW5kZXhdO1xuXG4gICAgICAgIGlmIChjID09ICdcXFxcJyAmJiBtYXliZVVuZXNjYXBlUXVvdGUobW9kZSkpXG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICB0eXBlID0gZ2V0UGF0aENoYXJUeXBlKGMpO1xuICAgICAgICB0eXBlTWFwID0gcGF0aFN0YXRlTWFjaGluZVttb2RlXTtcbiAgICAgICAgdHJhbnNpdGlvbiA9IHR5cGVNYXBbdHlwZV0gfHwgdHlwZU1hcFsnZWxzZSddIHx8ICdlcnJvcic7XG5cbiAgICAgICAgaWYgKHRyYW5zaXRpb24gPT0gJ2Vycm9yJylcbiAgICAgICAgICAgIHJldHVybjsgLy8gcGFyc2UgZXJyb3I7XG5cbiAgICAgICAgbW9kZSA9IHRyYW5zaXRpb25bMF07XG4gICAgICAgIGFjdGlvbiA9IGFjdGlvbnNbdHJhbnNpdGlvblsxXV0gfHwgbm9vcDtcbiAgICAgICAgbmV3Q2hhciA9IHRyYW5zaXRpb25bMl0gPT09IHVuZGVmaW5lZCA/IGMgOiB0cmFuc2l0aW9uWzJdO1xuICAgICAgICBhY3Rpb24oKTtcblxuICAgICAgICBpZiAobW9kZSA9PT0gJ2FmdGVyUGF0aCcpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuOyAvLyBwYXJzZSBlcnJvclxufVxuXG5mdW5jdGlvbiBpc0lkZW50KHMpIHtcbiAgICByZXR1cm4gaWRlbnRSZWdFeHAudGVzdChzKTtcbn1cblxudmFyIGNvbnN0cnVjdG9ySXNQcml2YXRlID0ge307XG5cbmZ1bmN0aW9uIFBhdGgocGFydHMsIHByaXZhdGVUb2tlbikge1xuICAgIGlmIChwcml2YXRlVG9rZW4gIT09IGNvbnN0cnVjdG9ySXNQcml2YXRlKVxuICAgICAgICB0aHJvdyBFcnJvcignVXNlIFBhdGguZ2V0IHRvIHJldHJpZXZlIHBhdGggb2JqZWN0cycpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnB1c2goU3RyaW5nKHBhcnRzW2ldKSk7XG4gICAgfVxuXG4gICAgaWYgKGhhc0V2YWwgJiYgdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5nZXRWYWx1ZUZyb20gPSB0aGlzLmNvbXBpbGVkR2V0VmFsdWVGcm9tRm4oKTtcbiAgICB9XG59XG5cbi8vIFRPRE8ocmFmYWVsdyk6IE1ha2Ugc2ltcGxlIExSVSBjYWNoZVxudmFyIHBhdGhDYWNoZSA9IHt9O1xuXG5mdW5jdGlvbiBnZXRQYXRoKHBhdGhTdHJpbmcpIHtcbiAgICBpZiAocGF0aFN0cmluZyBpbnN0YW5jZW9mIFBhdGgpXG4gICAgICAgIHJldHVybiBwYXRoU3RyaW5nO1xuXG4gICAgaWYgKHBhdGhTdHJpbmcgPT0gbnVsbCB8fCBwYXRoU3RyaW5nLmxlbmd0aCA9PSAwKVxuICAgICAgICBwYXRoU3RyaW5nID0gJyc7XG5cbiAgICBpZiAodHlwZW9mIHBhdGhTdHJpbmcgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKGlzSW5kZXgocGF0aFN0cmluZy5sZW5ndGgpKSB7XG4gICAgICAgICAgICAvLyBDb25zdHJ1Y3RlZCB3aXRoIGFycmF5LWxpa2UgKHByZS1wYXJzZWQpIGtleXNcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGF0aChwYXRoU3RyaW5nLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBwYXRoU3RyaW5nID0gU3RyaW5nKHBhdGhTdHJpbmcpO1xuICAgIH1cblxuICAgIHZhciBwYXRoID0gcGF0aENhY2hlW3BhdGhTdHJpbmddO1xuICAgIGlmIChwYXRoKVxuICAgICAgICByZXR1cm4gcGF0aDtcblxuICAgIHZhciBwYXJ0cyA9IHBhcnNlUGF0aChwYXRoU3RyaW5nKTtcbiAgICBpZiAoIXBhcnRzKVxuICAgICAgICByZXR1cm4gaW52YWxpZFBhdGg7XG5cbiAgICB2YXIgcGF0aCA9IG5ldyBQYXRoKHBhcnRzLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG4gICAgcGF0aENhY2hlW3BhdGhTdHJpbmddID0gcGF0aDtcbiAgICByZXR1cm4gcGF0aDtcbn1cblxuUGF0aC5nZXQgPSBnZXRQYXRoO1xuXG5mdW5jdGlvbiBmb3JtYXRBY2Nlc3NvcihrZXkpIHtcbiAgICBpZiAoaXNJbmRleChrZXkpKSB7XG4gICAgICAgIHJldHVybiAnWycgKyBrZXkgKyAnXSc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdbXCInICsga2V5LnJlcGxhY2UoL1wiL2csICdcXFxcXCInKSArICdcIl0nO1xuICAgIH1cbn1cblxuUGF0aC5wcm90b3R5cGUgPSBjcmVhdGVPYmplY3Qoe1xuICAgIF9fcHJvdG9fXzogW10sXG4gICAgdmFsaWQ6IHRydWUsXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGF0aFN0cmluZyA9ICcnO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzW2ldO1xuICAgICAgICAgICAgaWYgKGlzSWRlbnQoa2V5KSkge1xuICAgICAgICAgICAgICAgIHBhdGhTdHJpbmcgKz0gaSA/ICcuJyArIGtleSA6IGtleTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSBmb3JtYXRBY2Nlc3NvcihrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBhdGhTdHJpbmc7XG4gICAgfSxcblxuICAgIGdldFZhbHVlRnJvbTogZnVuY3Rpb24gKG9iaiwgZGlyZWN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAob2JqID09IG51bGwpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgb2JqID0gb2JqW3RoaXNbaV1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcblxuICAgIGl0ZXJhdGVPYmplY3RzOiBmdW5jdGlvbiAob2JqLCBvYnNlcnZlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkpXG4gICAgICAgICAgICAgICAgb2JqID0gb2JqW3RoaXNbaSAtIDFdXTtcbiAgICAgICAgICAgIGlmICghaXNPYmplY3Qob2JqKSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBvYnNlcnZlKG9iaiwgdGhpc1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY29tcGlsZWRHZXRWYWx1ZUZyb21GbjogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RyID0gJyc7XG4gICAgICAgIHZhciBwYXRoU3RyaW5nID0gJ29iaic7XG4gICAgICAgIHN0ciArPSAnaWYgKG9iaiAhPSBudWxsJztcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICBmb3IgKDsgaSA8ICh0aGlzLmxlbmd0aCAtIDEpIDsgaSsrKSB7XG4gICAgICAgICAgICBrZXkgPSB0aGlzW2ldO1xuICAgICAgICAgICAgcGF0aFN0cmluZyArPSBpc0lkZW50KGtleSkgPyAnLicgKyBrZXkgOiBmb3JtYXRBY2Nlc3NvcihrZXkpO1xuICAgICAgICAgICAgc3RyICs9ICcgJiZcXG4gICAgICcgKyBwYXRoU3RyaW5nICsgJyAhPSBudWxsJztcbiAgICAgICAgfVxuICAgICAgICBzdHIgKz0gJylcXG4nO1xuXG4gICAgICAgIHZhciBrZXkgPSB0aGlzW2ldO1xuICAgICAgICBwYXRoU3RyaW5nICs9IGlzSWRlbnQoa2V5KSA/ICcuJyArIGtleSA6IGZvcm1hdEFjY2Vzc29yKGtleSk7XG5cbiAgICAgICAgc3RyICs9ICcgIHJldHVybiAnICsgcGF0aFN0cmluZyArICc7XFxuZWxzZVxcbiAgcmV0dXJuIHVuZGVmaW5lZDsnO1xuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdvYmonLCBzdHIpO1xuICAgIH0sXG5cbiAgICBzZXRWYWx1ZUZyb206IGZ1bmN0aW9uIChvYmosIHZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFpc09iamVjdChvYmopKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIG9iaiA9IG9ialt0aGlzW2ldXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNPYmplY3Qob2JqKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBvYmpbdGhpc1tpXV0gPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufSk7XG5cbnZhciBpbnZhbGlkUGF0aCA9IG5ldyBQYXRoKCcnLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG5pbnZhbGlkUGF0aC52YWxpZCA9IGZhbHNlO1xuaW52YWxpZFBhdGguZ2V0VmFsdWVGcm9tID0gaW52YWxpZFBhdGguc2V0VmFsdWVGcm9tID0gZnVuY3Rpb24gKCkgeyB9O1xuXG5leHBvcnRzLlBhdGggPSBQYXRoO1xuIiwi77u/Ly8gQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbi8vIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4vLyBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbi8vIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4vLyBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuXG52YXIgZXNwcmltYSA9IHJlcXVpcmUoXCJqcy1saWJzL2VzcHJpbWFcIikuZXNwcmltYTtcbnZhciBQYXRoID0gcmVxdWlyZShcImpzLWxpYnMvcG9seW1lci1leHByZXNzaW9ucy9wYXRoLXBhcnNlclwiKS5QYXRoO1xuXG4oZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIFRPRE8ocmFmYWVsdyk6IEltcGxlbWVudCBzaW1wbGUgTFJVLlxuICAgIHZhciBleHByZXNzaW9uUGFyc2VDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgICBmdW5jdGlvbiBnZXRFeHByZXNzaW9uKGV4cHJlc3Npb25UZXh0KSB7XG4gICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblBhcnNlQ2FjaGVbZXhwcmVzc2lvblRleHRdO1xuICAgICAgICBpZiAoIWV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZSA9IG5ldyBBU1REZWxlZ2F0ZSgpO1xuICAgICAgICAgICAgZXNwcmltYS5wYXJzZShleHByZXNzaW9uVGV4dCwgZGVsZWdhdGUpO1xuICAgICAgICAgICAgZXhwcmVzc2lvbiA9IG5ldyBFeHByZXNzaW9uKGRlbGVnYXRlKTtcbiAgICAgICAgICAgIGV4cHJlc3Npb25QYXJzZUNhY2hlW2V4cHJlc3Npb25UZXh0XSA9IGV4cHJlc3Npb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb247XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTGl0ZXJhbCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMudmFsdWVGbl8gPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgTGl0ZXJhbC5wcm90b3R5cGUgPSB7XG4gICAgICAgIHZhbHVlRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZUZuXykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVGbl87XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBJZGVudFBhdGgobmFtZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnBhdGggPSBQYXRoLmdldChuYW1lKTtcbiAgICB9XG5cbiAgICBJZGVudFBhdGgucHJvdG90eXBlID0ge1xuICAgICAgICB2YWx1ZUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVGbl8pIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHRoaXMubmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMucGF0aDtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgY2hhbmdlZE1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgobW9kZWwsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwYXRoLmdldFZhbHVlRnJvbShjaGFuZ2VkTW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLmdldFZhbHVlRnJvbShtb2RlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUZuXztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGF0aC5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgIG1vZGVsID0gZmluZFNjb3BlKG1vZGVsLCB0aGlzLnBhdGhbMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnNldFZhbHVlRnJvbShtb2RlbCwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIE1lbWJlckV4cHJlc3Npb24ob2JqZWN0LCBwcm9wZXJ0eSwgYWNjZXNzb3IpIHtcbiAgICAgICAgdGhpcy5jb21wdXRlZCA9IGFjY2Vzc29yID09ICdbJztcblxuICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHlwZW9mIG9iamVjdCA9PSAnZnVuY3Rpb24nIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHluYW1pY0RlcHMgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLmNvbXB1dGVkICYmICEocHJvcGVydHkgaW5zdGFuY2VvZiBMaXRlcmFsKSk7XG5cbiAgICAgICAgdGhpcy5zaW1wbGVQYXRoID1cbiAgICAgICAgICAgICF0aGlzLmR5bmFtaWNEZXBzICYmXG4gICAgICAgICAgICAocHJvcGVydHkgaW5zdGFuY2VvZiBJZGVudFBhdGggfHwgcHJvcGVydHkgaW5zdGFuY2VvZiBMaXRlcmFsKSAmJlxuICAgICAgICAgICAgKG9iamVjdCBpbnN0YW5jZW9mIE1lbWJlckV4cHJlc3Npb24gfHwgb2JqZWN0IGluc3RhbmNlb2YgSWRlbnRQYXRoKTtcblxuICAgICAgICB0aGlzLm9iamVjdCA9IHRoaXMuc2ltcGxlUGF0aCA/IG9iamVjdCA6IGdldEZuKG9iamVjdCk7XG4gICAgICAgIHRoaXMucHJvcGVydHkgPSAhdGhpcy5jb21wdXRlZCB8fCB0aGlzLnNpbXBsZVBhdGggP1xuICAgICAgICAgICAgcHJvcGVydHkgOiBnZXRGbihwcm9wZXJ0eSk7XG4gICAgfVxuXG4gICAgTWVtYmVyRXhwcmVzc2lvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIGdldCBmdWxsUGF0aCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mdWxsUGF0aF8pIHtcblxuICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IHRoaXMub2JqZWN0IGluc3RhbmNlb2YgTWVtYmVyRXhwcmVzc2lvbiA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2JqZWN0LmZ1bGxQYXRoLnNsaWNlKCkgOiBbdGhpcy5vYmplY3QubmFtZV07XG4gICAgICAgICAgICAgICAgcGFydHMucHVzaCh0aGlzLnByb3BlcnR5IGluc3RhbmNlb2YgSWRlbnRQYXRoID9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lIDogdGhpcy5wcm9wZXJ0eS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5mdWxsUGF0aF8gPSBQYXRoLmdldChwYXJ0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZ1bGxQYXRoXztcbiAgICAgICAgfSxcblxuICAgICAgICB2YWx1ZUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVGbl8pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0ID0gdGhpcy5vYmplY3Q7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaW1wbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5mdWxsUGF0aDtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgobW9kZWwsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5nZXRWYWx1ZUZyb20obW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuY29tcHV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBQYXRoLmdldCh0aGlzLnByb3BlcnR5Lm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBvYmplY3QobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRQYXRoKGNvbnRleHQsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5nZXRWYWx1ZUZyb20oY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBDb21wdXRlZCBwcm9wZXJ0eS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcy5wcm9wZXJ0eTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gb2JqZWN0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gcHJvcGVydHkobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuYWRkUGF0aChjb250ZXh0LCBbcHJvcE5hbWVdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQgPyBjb250ZXh0W3Byb3BOYW1lXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUZuXztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2ltcGxlUGF0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZnVsbFBhdGguc2V0VmFsdWVGcm9tKG1vZGVsLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb2JqZWN0ID0gdGhpcy5vYmplY3QobW9kZWwpO1xuICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gdGhpcy5wcm9wZXJ0eSBpbnN0YW5jZW9mIElkZW50UGF0aCA/IHRoaXMucHJvcGVydHkubmFtZSA6XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eShtb2RlbCk7XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0W3Byb3BOYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEZpbHRlcihuYW1lLCBhcmdzKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuYXJnc1tpXSA9IGdldEZuKGFyZ3NbaV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgRmlsdGVyLnByb3RvdHlwZSA9IHtcbiAgICAgICAgdHJhbnNmb3JtOiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSwgdG9Nb2RlbERpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsQXJncykge1xuICAgICAgICAgICAgdmFyIGZuID0gZmlsdGVyUmVnaXN0cnlbdGhpcy5uYW1lXTtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gbW9kZWw7XG4gICAgICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmbiA9IGNvbnRleHRbdGhpcy5uYW1lXTtcbiAgICAgICAgICAgICAgICBpZiAoIWZuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBmaW5kIGZ1bmN0aW9uIG9yIGZpbHRlcjogJyArIHRoaXMubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRvTW9kZWxEaXJlY3Rpb24gaXMgZmFsc2V5LCB0aGVuIHRoZSBcIm5vcm1hbFwiIChkb20tYm91bmQpIGRpcmVjdGlvblxuICAgICAgICAgICAgLy8gaXMgdXNlZC4gT3RoZXJ3aXNlLCBpdCBsb29rcyBmb3IgYSAndG9Nb2RlbCcgcHJvcGVydHkgZnVuY3Rpb24gb24gdGhlXG4gICAgICAgICAgICAvLyBvYmplY3QuXG4gICAgICAgICAgICBpZiAodG9Nb2RlbERpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIGZuID0gZm4udG9Nb2RlbDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGZuLnRvVmlldyA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgZm4gPSBmbi50b1ZpZXc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBmaW5kIGZ1bmN0aW9uIG9yIGZpbHRlcjogJyArIHRoaXMubmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYXJncyA9IGluaXRpYWxBcmdzIHx8IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goZ2V0Rm4odGhpcy5hcmdzW2ldKShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBub3RJbXBsZW1lbnRlZCgpIHsgdGhyb3cgRXJyb3IoJ05vdCBJbXBsZW1lbnRlZCcpOyB9XG5cbiAgICB2YXIgdW5hcnlPcGVyYXRvcnMgPSB7XG4gICAgICAgICcrJzogZnVuY3Rpb24gKHYpIHsgcmV0dXJuICt2OyB9LFxuICAgICAgICAnLSc6IGZ1bmN0aW9uICh2KSB7IHJldHVybiAtdjsgfSxcbiAgICAgICAgJyEnOiBmdW5jdGlvbiAodikgeyByZXR1cm4gIXY7IH1cbiAgICB9O1xuXG4gICAgdmFyIGJpbmFyeU9wZXJhdG9ycyA9IHtcbiAgICAgICAgJysnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCArIHI7IH0sXG4gICAgICAgICctJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgLSByOyB9LFxuICAgICAgICAnKic6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICogcjsgfSxcbiAgICAgICAgJy8nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAvIHI7IH0sXG4gICAgICAgICclJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgJSByOyB9LFxuICAgICAgICAnPCc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIDwgcjsgfSxcbiAgICAgICAgJz4nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA+IHI7IH0sXG4gICAgICAgICc8PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIDw9IHI7IH0sXG4gICAgICAgICc+PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID49IHI7IH0sXG4gICAgICAgICc9PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID09IHI7IH0sXG4gICAgICAgICchPSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICE9IHI7IH0sXG4gICAgICAgICc9PT0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA9PT0gcjsgfSxcbiAgICAgICAgJyE9PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICE9PSByOyB9LFxuICAgICAgICAnJiYnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAmJiByOyB9LFxuICAgICAgICAnfHwnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCB8fCByOyB9LFxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRGbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmcgPT0gJ2Z1bmN0aW9uJyA/IGFyZyA6IGFyZy52YWx1ZUZuKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQVNURGVsZWdhdGUoKSB7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IG51bGw7XG4gICAgICAgIHRoaXMuZmlsdGVycyA9IFtdO1xuICAgICAgICB0aGlzLmRlcHMgPSB7fTtcbiAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmluZGV4SWRlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBBU1REZWxlZ2F0ZS5wcm90b3R5cGUgPSB7XG4gICAgICAgIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbjogZnVuY3Rpb24gKG9wLCBhcmd1bWVudCkge1xuICAgICAgICAgICAgaWYgKCF1bmFyeU9wZXJhdG9yc1tvcF0pXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0Rpc2FsbG93ZWQgb3BlcmF0b3I6ICcgKyBvcCk7XG5cbiAgICAgICAgICAgIGFyZ3VtZW50ID0gZ2V0Rm4oYXJndW1lbnQpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5hcnlPcGVyYXRvcnNbb3BdKGFyZ3VtZW50KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQmluYXJ5RXhwcmVzc2lvbjogZnVuY3Rpb24gKG9wLCBsZWZ0LCByaWdodCkge1xuICAgICAgICAgICAgaWYgKCFiaW5hcnlPcGVyYXRvcnNbb3BdKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdEaXNhbGxvd2VkIG9wZXJhdG9yOiAnICsgb3ApO1xuXG4gICAgICAgICAgICBsZWZ0ID0gZ2V0Rm4obGVmdCk7XG4gICAgICAgICAgICByaWdodCA9IGdldEZuKHJpZ2h0KTtcblxuICAgICAgICAgICAgc3dpdGNoIChvcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3x8JzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjYXNlICcmJic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsZWZ0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiaW5hcnlPcGVyYXRvcnNbb3BdKGxlZnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVDb25kaXRpb25hbEV4cHJlc3Npb246IGZ1bmN0aW9uICh0ZXN0LCBjb25zZXF1ZW50LCBhbHRlcm5hdGUpIHtcbiAgICAgICAgICAgIHRlc3QgPSBnZXRGbih0ZXN0KTtcbiAgICAgICAgICAgIGNvbnNlcXVlbnQgPSBnZXRGbihjb25zZXF1ZW50KTtcbiAgICAgICAgICAgIGFsdGVybmF0ZSA9IGdldEZuKGFsdGVybmF0ZSk7XG5cbiAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGVzdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSA/XG4gICAgICAgICAgICAgICAgICAgIGNvbnNlcXVlbnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgOlxuICAgICAgICAgICAgICAgICAgICBhbHRlcm5hdGUobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlSWRlbnRpZmllcjogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpZGVudCA9IG5ldyBJZGVudFBhdGgobmFtZSk7XG4gICAgICAgICAgICBpZGVudC50eXBlID0gJ0lkZW50aWZpZXInO1xuICAgICAgICAgICAgcmV0dXJuIGlkZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZU1lbWJlckV4cHJlc3Npb246IGZ1bmN0aW9uIChhY2Nlc3Nvciwgb2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgICAgICAgICAgdmFyIGV4ID0gbmV3IE1lbWJlckV4cHJlc3Npb24ob2JqZWN0LCBwcm9wZXJ0eSwgYWNjZXNzb3IpO1xuICAgICAgICAgICAgaWYgKGV4LmR5bmFtaWNEZXBzKVxuICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGV4O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUNhbGxFeHByZXNzaW9uOiBmdW5jdGlvbiAoZXhwcmVzc2lvbiwgYXJncykge1xuICAgICAgICAgICAgaWYgKCEoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIElkZW50UGF0aCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ09ubHkgaWRlbnRpZmllciBmdW5jdGlvbiBpbnZvY2F0aW9ucyBhcmUgYWxsb3dlZCcpO1xuXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gbmV3IEZpbHRlcihleHByZXNzaW9uLm5hbWUsIGFyZ3MpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyLnRyYW5zZm9ybShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5LCBmYWxzZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUxpdGVyYWw6IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBMaXRlcmFsKHRva2VuLnZhbHVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVBcnJheUV4cHJlc3Npb246IGZ1bmN0aW9uIChlbGVtZW50cykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICBlbGVtZW50c1tpXSA9IGdldEZuKGVsZW1lbnRzW2ldKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IFtdXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goZWxlbWVudHNbaV0obW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlUHJvcGVydHk6IGZ1bmN0aW9uIChraW5kLCBrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGtleToga2V5IGluc3RhbmNlb2YgSWRlbnRQYXRoID8ga2V5Lm5hbWUgOiBrZXkudmFsdWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZU9iamVjdEV4cHJlc3Npb246IGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgcHJvcGVydGllc1tpXS52YWx1ZSA9IGdldEZuKHByb3BlcnRpZXNbaV0udmFsdWUpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBvYmpbcHJvcGVydGllc1tpXS5rZXldID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbaV0udmFsdWUobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVGaWx0ZXI6IGZ1bmN0aW9uIChuYW1lLCBhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcnMucHVzaChuZXcgRmlsdGVyKG5hbWUsIGFyZ3MpKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVBc0V4cHJlc3Npb246IGZ1bmN0aW9uIChleHByZXNzaW9uLCBzY29wZUlkZW50KSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gc2NvcGVJZGVudDtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVJbkV4cHJlc3Npb246IGZ1bmN0aW9uIChzY29wZUlkZW50LCBpbmRleElkZW50LCBleHByZXNzaW9uKSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gc2NvcGVJZGVudDtcbiAgICAgICAgICAgIHRoaXMuaW5kZXhJZGVudCA9IGluZGV4SWRlbnQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlVG9wTGV2ZWw6IGZ1bmN0aW9uIChleHByZXNzaW9uKSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVRoaXNFeHByZXNzaW9uOiBub3RJbXBsZW1lbnRlZFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIEV4cHJlc3Npb24oZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gZGVsZWdhdGUuc2NvcGVJZGVudDtcbiAgICAgICAgdGhpcy5pbmRleElkZW50ID0gZGVsZWdhdGUuaW5kZXhJZGVudDtcblxuICAgICAgICBpZiAoIWRlbGVnYXRlLmV4cHJlc3Npb24pXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignTm8gZXhwcmVzc2lvbiBmb3VuZC4nKTtcblxuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBkZWxlZ2F0ZS5leHByZXNzaW9uO1xuICAgICAgICBnZXRGbih0aGlzLmV4cHJlc3Npb24pOyAvLyBmb3JjZXMgZW51bWVyYXRpb24gb2YgcGF0aCBkZXBlbmRlbmNpZXNcblxuICAgICAgICB0aGlzLmZpbHRlcnMgPSBkZWxlZ2F0ZS5maWx0ZXJzO1xuICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gZGVsZWdhdGUuZHluYW1pY0RlcHM7XG4gICAgfVxuXG4gICAgRXhwcmVzc2lvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbiAobW9kZWwsIGlzQmFja0NvbnZlcnQsIGNoYW5nZWRNb2RlbCwgb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGdldEZuKHRoaXMuZXhwcmVzc2lvbikobW9kZWwuY29udGV4dCwgb2JzZXJ2ZXIsIGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5maWx0ZXJzW2ldLnRyYW5zZm9ybShtb2RlbC5jb250ZXh0LCBvYnNlcnZlciwgbW9kZWwuY29udGV4dCwgaXNCYWNrQ29udmVydCwgW3ZhbHVlXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgIHZhciBjb3VudCA9IHRoaXMuZmlsdGVycyA/IHRoaXMuZmlsdGVycy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgd2hpbGUgKGNvdW50LS0gPiAwKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSB0aGlzLmZpbHRlcnNbY291bnRdLnRyYW5zZm9ybShtb2RlbCwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJSZWdpc3RyeSwgdHJ1ZSwgW25ld1ZhbHVlXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmV4cHJlc3Npb24uc2V0VmFsdWUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5zZXRWYWx1ZShtb2RlbCwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBzdHlsZSBwcm9wZXJ0eSBuYW1lIHRvIGEgY3NzIHByb3BlcnR5IG5hbWUuIEZvciBleGFtcGxlOlxuICAgICAqIFwiV2Via2l0VXNlclNlbGVjdFwiIHRvIFwiLXdlYmtpdC11c2VyLXNlbGVjdFwiXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udmVydFN0eWxlUHJvcGVydHlOYW1lKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZyhuYW1lKS5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuICctJyArIGMudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHBhcmVudFNjb3BlTmFtZSA9ICdAJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpO1xuXG4gICAgLy8gU2luZ2xlIGlkZW50IHBhdGhzIG11c3QgYmluZCBkaXJlY3RseSB0byB0aGUgYXBwcm9wcmlhdGUgc2NvcGUgb2JqZWN0LlxuICAgIC8vIEkuZS4gUHVzaGVkIHZhbHVlcyBpbiB0d28tYmluZGluZ3MgbmVlZCB0byBiZSBhc3NpZ25lZCB0byB0aGUgYWN0dWFsIG1vZGVsXG4gICAgLy8gb2JqZWN0LlxuICAgIGZ1bmN0aW9uIGZpbmRTY29wZShtb2RlbCwgcHJvcCkge1xuICAgICAgICB3aGlsZSAobW9kZWxbcGFyZW50U2NvcGVOYW1lXSAmJlxuICAgICAgICAgICAgICAgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2RlbCwgcHJvcCkpIHtcbiAgICAgICAgICAgIG1vZGVsID0gbW9kZWxbcGFyZW50U2NvcGVOYW1lXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0xpdGVyYWxFeHByZXNzaW9uKHBhdGhTdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoIChwYXRoU3RyaW5nKSB7XG4gICAgICAgICAgICBjYXNlICcnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgY2FzZSAnZmFsc2UnOlxuICAgICAgICAgICAgY2FzZSAnbnVsbCc6XG4gICAgICAgICAgICBjYXNlICd0cnVlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNOYU4oTnVtYmVyKHBhdGhTdHJpbmcpKSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gUG9seW1lckV4cHJlc3Npb25zKCkgeyB9XG5cbiAgICBQb2x5bWVyRXhwcmVzc2lvbnMucHJvdG90eXBlID0ge1xuICAgICAgICAvLyBcImJ1aWx0LWluXCIgZmlsdGVyc1xuICAgICAgICBzdHlsZU9iamVjdDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcGFydHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goY29udmVydFN0eWxlUHJvcGVydHlOYW1lKGtleSkgKyAnOiAnICsgdmFsdWVba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbignOyAnKTtcbiAgICAgICAgfSxcblxuICAgICAgICB0b2tlbkxpc3Q6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlW2tleV0pXG4gICAgICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdG9rZW5zLmpvaW4oJyAnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBiaW5kaW5nIGRlbGVnYXRlIEFQSVxuICAgICAgICBwcmVwYXJlSW5zdGFuY2VQb3NpdGlvbkNoYW5nZWQ6IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIGluZGV4SWRlbnQgPSB0ZW1wbGF0ZS5wb2x5bWVyRXhwcmVzc2lvbkluZGV4SWRlbnRfO1xuICAgICAgICAgICAgaWYgKCFpbmRleElkZW50KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0ZW1wbGF0ZUluc3RhbmNlLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlSW5zdGFuY2UubW9kZWxbaW5kZXhJZGVudF0gPSBpbmRleDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJlcGFyZUluc3RhbmNlTW9kZWw6IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHNjb3BlTmFtZSA9IHRlbXBsYXRlLnBvbHltZXJFeHByZXNzaW9uU2NvcGVJZGVudF87XG4gICAgICAgICAgICBpZiAoIXNjb3BlTmFtZSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBwYXJlbnRTY29wZSA9IHRlbXBsYXRlLnRlbXBsYXRlSW5zdGFuY2UgP1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnRlbXBsYXRlSW5zdGFuY2UubW9kZWwgOlxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLm1vZGVsO1xuXG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gdGVtcGxhdGUucG9seW1lckV4cHJlc3Npb25JbmRleElkZW50XztcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTY29wZU9iamVjdChwYXJlbnRTY29wZSwgbW9kZWwsIHNjb3BlTmFtZSwgaW5kZXhOYW1lKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZVNjb3BlT2JqZWN0ID0gKCdfX3Byb3RvX18nIGluIHt9KSA/XG4gICAgICBmdW5jdGlvbiAocGFyZW50U2NvcGUsIG1vZGVsLCBzY29wZU5hbWUsIGluZGV4TmFtZSkge1xuICAgICAgICAgIHZhciBzY29wZSA9IHt9O1xuICAgICAgICAgIHNjb3BlW3Njb3BlTmFtZV0gPSBtb2RlbDtcbiAgICAgICAgICBzY29wZVtpbmRleE5hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHNjb3BlW3BhcmVudFNjb3BlTmFtZV0gPSBwYXJlbnRTY29wZTtcbiAgICAgICAgICBzY29wZS5fX3Byb3RvX18gPSBwYXJlbnRTY29wZTtcbiAgICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgICB9IDpcbiAgICAgIGZ1bmN0aW9uIChwYXJlbnRTY29wZSwgbW9kZWwsIHNjb3BlTmFtZSwgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgdmFyIHNjb3BlID0gT2JqZWN0LmNyZWF0ZShwYXJlbnRTY29wZSk7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjb3BlLCBzY29wZU5hbWUsXG4gICAgICAgICAgICAgIHsgdmFsdWU6IG1vZGVsLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzY29wZSwgaW5kZXhOYW1lLFxuICAgICAgICAgICAgICB7IHZhbHVlOiB1bmRlZmluZWQsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjb3BlLCBwYXJlbnRTY29wZU5hbWUsXG4gICAgICAgICAgICAgIHsgdmFsdWU6IHBhcmVudFNjb3BlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgIHJldHVybiBzY29wZTtcbiAgICAgIH07XG5cbiAgICBnbG9iYWwuUG9seW1lckV4cHJlc3Npb25zID0gUG9seW1lckV4cHJlc3Npb25zO1xuICAgIFBvbHltZXJFeHByZXNzaW9ucy5nZXRFeHByZXNzaW9uID0gZ2V0RXhwcmVzc2lvbjtcbn0pKG1vZHVsZS5leHBvcnRzKTsiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbnVtYmVyX3V0aWxzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvbnVtYmVyLXV0aWxzXCIpO1xuZXhwb3J0cy5nZXRUcmFuc2Zvcm1NYXRyaXggPSBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdmFsdWUgPSBfYS52YWx1ZTtcbiAgICByZXR1cm4gVFJBTlNGT1JNX01BVFJJWEVTW3Byb3BlcnR5XSh2YWx1ZSk7XG59O1xudmFyIFRSQU5TRk9STV9NQVRSSVhFUyA9IHtcbiAgICBcInNjYWxlXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLngsIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgeCwgMCwgMCxcbiAgICAgICAgICAgIDAsIHksIDAsXG4gICAgICAgICAgICAwLCAwLCAxLFxuICAgICAgICBdO1xuICAgIH0sXG4gICAgXCJ0cmFuc2xhdGVcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB4ID0gX2EueCwgeSA9IF9hLnk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAxLCAwLCB4LFxuICAgICAgICAgICAgMCwgMSwgeSxcbiAgICAgICAgICAgIDAsIDAsIDEsXG4gICAgICAgIF07XG4gICAgfSxcbiAgICBcInJvdGF0ZVwiOiBmdW5jdGlvbiAoYW5nbGVJbkRlZykge1xuICAgICAgICB2YXIgYW5nbGVJblJhZCA9IG51bWJlcl91dGlsc18xLmRlZ3JlZXNUb1JhZGlhbnMoYW5nbGVJbkRlZyk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBNYXRoLmNvcyhhbmdsZUluUmFkKSwgLU1hdGguc2luKGFuZ2xlSW5SYWQpLCAwLFxuICAgICAgICAgICAgTWF0aC5zaW4oYW5nbGVJblJhZCksIE1hdGguY29zKGFuZ2xlSW5SYWQpLCAwLFxuICAgICAgICAgICAgMCwgMCwgMSxcbiAgICAgICAgXTtcbiAgICB9LFxufTtcbmV4cG9ydHMubWF0cml4QXJyYXlUb0Nzc01hdHJpeCA9IGZ1bmN0aW9uIChtKSB7IHJldHVybiBbXG4gICAgbVswXSwgbVszXSwgbVsxXSxcbiAgICBtWzRdLCBtWzJdLCBtWzVdLFxuXTsgfTtcbmZ1bmN0aW9uIG11bHRpcGx5QWZmaW5lMmQobTEsIG0yKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgbTFbMF0gKiBtMlswXSArIG0xWzFdICogbTJbM10sXG4gICAgICAgIG0xWzBdICogbTJbMV0gKyBtMVsxXSAqIG0yWzRdLFxuICAgICAgICBtMVswXSAqIG0yWzJdICsgbTFbMV0gKiBtMls1XSArIG0xWzJdLFxuICAgICAgICBtMVszXSAqIG0yWzBdICsgbTFbNF0gKiBtMlszXSxcbiAgICAgICAgbTFbM10gKiBtMlsxXSArIG0xWzRdICogbTJbNF0sXG4gICAgICAgIG0xWzNdICogbTJbMl0gKyBtMVs0XSAqIG0yWzVdICsgbTFbNV1cbiAgICBdO1xufVxuZXhwb3J0cy5tdWx0aXBseUFmZmluZTJkID0gbXVsdGlwbHlBZmZpbmUyZDtcbmZ1bmN0aW9uIGRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4KG1hdHJpeCkge1xuICAgIHZlcmlmeVRyYW5zZm9ybU1hdHJpeChtYXRyaXgpO1xuICAgIHZhciBfYSA9IG1hdHJpeC5zbGljZSgpLCBBID0gX2FbMF0sIEIgPSBfYVsxXSwgQyA9IF9hWzJdLCBEID0gX2FbM10sIEUgPSBfYVs0XSwgRiA9IF9hWzVdO1xuICAgIHZhciBkZXRlcm1pbmFudCA9IEEgKiBEIC0gQiAqIEM7XG4gICAgdmFyIHRyYW5zbGF0ZSA9IHsgeDogRSB8fCAwLCB5OiBGIHx8IDAgfTtcbiAgICB2YXIgcm90YXRlID0gMDtcbiAgICB2YXIgc2NhbGUgPSB7IHg6IDEsIHk6IDEgfTtcbiAgICBpZiAoQSB8fCBCKSB7XG4gICAgICAgIHZhciBSID0gTWF0aC5zcXJ0KEEgKiBBICsgQiAqIEIpO1xuICAgICAgICByb3RhdGUgPSBCID4gMCA/IE1hdGguYWNvcyhBIC8gUikgOiAtTWF0aC5hY29zKEEgLyBSKTtcbiAgICAgICAgc2NhbGUgPSB7IHg6IFIsIHk6IGRldGVybWluYW50IC8gUiB9O1xuICAgIH1cbiAgICBlbHNlIGlmIChDIHx8IEQpIHtcbiAgICAgICAgdmFyIFIgPSBNYXRoLnNxcnQoQyAqIEMgKyBEICogRCk7XG4gICAgICAgIHJvdGF0ZSA9IE1hdGguUEkgLyAyIC0gKEQgPiAwID8gTWF0aC5hY29zKC1DIC8gUikgOiAtTWF0aC5hY29zKEMgLyBSKSk7XG4gICAgICAgIHNjYWxlID0geyB4OiBkZXRlcm1pbmFudCAvIFIsIHk6IFIgfTtcbiAgICB9XG4gICAgcm90YXRlID0gbnVtYmVyX3V0aWxzXzEucmFkaWFuc1RvRGVncmVlcyhyb3RhdGUpO1xuICAgIHJldHVybiB7IHRyYW5zbGF0ZTogdHJhbnNsYXRlLCByb3RhdGU6IHJvdGF0ZSwgc2NhbGU6IHNjYWxlIH07XG59XG5leHBvcnRzLmRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4ID0gZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXg7XG5mdW5jdGlvbiB2ZXJpZnlUcmFuc2Zvcm1NYXRyaXgobWF0cml4KSB7XG4gICAgaWYgKG1hdHJpeC5sZW5ndGggPCA2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zZm9ybSBtYXRyaXggc2hvdWxkIGJlIDJ4My5cIik7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWF0cml4LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtL3BsYXRmb3JtXCIpO1xudmFyIGFwcENvbW1vbk1vZHVsZSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcXVhbGlmaWVyX21hdGNoZXJfMSA9IHJlcXVpcmUoXCIuL3F1YWxpZmllci1tYXRjaGVyXCIpO1xudmFyIG5vbl9idW5kbGVfd29ya2Zsb3dfY29tcGF0XzEgPSByZXF1aXJlKFwiLi9ub24tYnVuZGxlLXdvcmtmbG93LWNvbXBhdFwiKTtcbnZhciBNb2R1bGVOYW1lUmVzb2x2ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZU5hbWVSZXNvbHZlcihjb250ZXh0LCBtb2R1bGVMaXN0UHJvdmlkZXIpIHtcbiAgICAgICAgaWYgKG1vZHVsZUxpc3RQcm92aWRlciA9PT0gdm9pZCAwKSB7IG1vZHVsZUxpc3RQcm92aWRlciA9IGdsb2JhbC5nZXRSZWdpc3RlcmVkTW9kdWxlczsgfVxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLm1vZHVsZUxpc3RQcm92aWRlciA9IG1vZHVsZUxpc3RQcm92aWRlcjtcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlTW9kdWxlTmFtZSA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIGtleSA9IHBhdGggKyBleHQ7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9jYWNoZVtrZXldO1xuICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucmVzb2x2ZU1vZHVsZU5hbWVJbXBsKHBhdGgsIGV4dCk7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZVtrZXldID0gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhY2hlID0ge307XG4gICAgfTtcbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLnJlc29sdmVNb2R1bGVOYW1lSW1wbCA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIGV4dCA9IGV4dCA/IFwiLlwiICsgZXh0IDogXCJcIjtcbiAgICAgICAgaWYgKCFnbG9iYWwuVE5TX1dFQlBBQ0spIHtcbiAgICAgICAgICAgIG5vbl9idW5kbGVfd29ya2Zsb3dfY29tcGF0XzEucmVnaXN0ZXJNb2R1bGVzRnJvbUZpbGVTeXN0ZW0ocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhbmRpZGF0ZXMgPSB0aGlzLmdldENhbmRpZGF0ZXMocGF0aCwgZXh0KTtcbiAgICAgICAgcmVzdWx0ID0gcXVhbGlmaWVyX21hdGNoZXJfMS5maW5kTWF0Y2gocGF0aCwgZXh0LCBjYW5kaWRhdGVzLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5nZXRDYW5kaWRhdGVzID0gZnVuY3Rpb24gKHBhdGgsIGV4dCkge1xuICAgICAgICB2YXIgY2FuZGlkYXRlcyA9IHRoaXMubW9kdWxlTGlzdFByb3ZpZGVyKClcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKG1vZHVsZU5hbWUpIHsgcmV0dXJuIG1vZHVsZU5hbWUuc3RhcnRzV2l0aChwYXRoKSAmJiAoIWV4dCB8fCBtb2R1bGVOYW1lLmVuZHNXaXRoKGV4dCkpOyB9KTtcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZXM7XG4gICAgfTtcbiAgICByZXR1cm4gTW9kdWxlTmFtZVJlc29sdmVyO1xufSgpKTtcbmV4cG9ydHMuTW9kdWxlTmFtZVJlc29sdmVyID0gTW9kdWxlTmFtZVJlc29sdmVyO1xudmFyIHJlc29sdmVySW5zdGFuY2U7XG5mdW5jdGlvbiByZXNvbHZlTW9kdWxlTmFtZShwYXRoLCBleHQpIHtcbiAgICBpZiAoIXJlc29sdmVySW5zdGFuY2UpIHtcbiAgICAgICAgcmVzb2x2ZXJJbnN0YW5jZSA9IG5ldyBNb2R1bGVOYW1lUmVzb2x2ZXIoe1xuICAgICAgICAgICAgd2lkdGg6IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4ud2lkdGhESVBzLFxuICAgICAgICAgICAgaGVpZ2h0OiBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLmhlaWdodERJUHMsXG4gICAgICAgICAgICBvczogcGxhdGZvcm1fMS5kZXZpY2Uub3MsXG4gICAgICAgICAgICBkZXZpY2VUeXBlOiBwbGF0Zm9ybV8xLmRldmljZS5kZXZpY2VUeXBlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZXJJbnN0YW5jZS5yZXNvbHZlTW9kdWxlTmFtZShwYXRoLCBleHQpO1xufVxuZXhwb3J0cy5yZXNvbHZlTW9kdWxlTmFtZSA9IHJlc29sdmVNb2R1bGVOYW1lO1xuZnVuY3Rpb24gY2xlYXJDYWNoZSgpIHtcbiAgICBpZiAocmVzb2x2ZXJJbnN0YW5jZSkge1xuICAgICAgICByZXNvbHZlckluc3RhbmNlLmNsZWFyQ2FjaGUoKTtcbiAgICB9XG59XG5leHBvcnRzLmNsZWFyQ2FjaGUgPSBjbGVhckNhY2hlO1xuZnVuY3Rpb24gX3NldFJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgcmVzb2x2ZXJJbnN0YW5jZSA9IHJlc29sdmVyO1xufVxuZXhwb3J0cy5fc2V0UmVzb2x2ZXIgPSBfc2V0UmVzb2x2ZXI7XG5hcHBDb21tb25Nb2R1bGUub24oXCJsaXZlc3luY1wiLCBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gY2xlYXJDYWNoZSgpOyB9KTtcbmFwcENvbW1vbk1vZHVsZS5vbihcIm9yaWVudGF0aW9uQ2hhbmdlZFwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIHJlc29sdmVySW5zdGFuY2UgPSB1bmRlZmluZWQ7XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS1uYW1lLXJlc29sdmVyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmcyA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbS9maWxlLXN5c3RlbVwiKTtcbnZhciBhcHBDb21tb25Nb2R1bGUgPSByZXF1aXJlKFwiLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIGNhY2hlID0gbmV3IFNldCgpO1xudmFyIGluaXRpYWxpemVkID0gZmFsc2U7XG5mdW5jdGlvbiByZWdpc3RlcihuYW1lLCBsb2FkZXIpIHtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUobmFtZSwgbG9hZGVyKTtcbn1cbmZ1bmN0aW9uIHByb2Nlc3NGaWxlKGZpbGUpIHtcbiAgICB2YXIgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwID0gZmlsZS5wYXRoLnN1YnN0cihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgubGVuZ3RoICsgMSk7XG4gICAgdmFyIGxvYWRDb250ZW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZmlsZS5yZWFkVGV4dFN5bmMoKTsgfTtcbiAgICBzd2l0Y2ggKGZpbGUuZXh0ZW5zaW9uLnRvTG9jYWxlTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIi5qc1wiOlxuICAgICAgICAgICAgdmFyIG5vRXh0UGF0aCA9IGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5zdWJzdHIoMCwgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLmxlbmd0aCAtIFwiLmpzXCIubGVuZ3RoKTtcbiAgICAgICAgICAgIHJlZ2lzdGVyKGZpbGVQYXRoUmVsYXRpdmVUb0FwcCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2xvYmFsLnJlcXVpcmUoZmlsZS5wYXRoKTsgfSk7XG4gICAgICAgICAgICByZWdpc3Rlcihub0V4dFBhdGgsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7IH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCIuY3NzXCI6XG4gICAgICAgICAgICByZWdpc3RlcihmaWxlUGF0aFJlbGF0aXZlVG9BcHAsIGxvYWRDb250ZW50KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiLnhtbFwiOlxuICAgICAgICAgICAgcmVnaXN0ZXIoZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLCBsb2FkQ29udGVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGZpbGUubmFtZSA9PT0gXCJwYWNrYWdlLmpzb25cIikge1xuICAgICAgICB2YXIganNvbiA9IGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7XG4gICAgICAgIGlmIChqc29uLm1haW4pIHtcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSBmaWxlUGF0aFJlbGF0aXZlVG9BcHAuc3Vic3RyKDAsIGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5sZW5ndGggLSBcInBhY2thZ2UuanNvblwiLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVQYXRoXzEgPSBmcy5wYXRoLmpvaW4oZmlsZS5wYXJlbnQucGF0aCwganNvbi5tYWluKTtcbiAgICAgICAgICAgIGlmIChuYW1lXzEuc3RhcnRzV2l0aChcInRuc19tb2R1bGVzXCIpKSB7XG4gICAgICAgICAgICAgICAgbmFtZV8xID0gbmFtZV8xLnN1YnN0cihcInRuc19tb2R1bGVzXCIubGVuZ3RoICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWdpc3RlcihuYW1lXzEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKHJlcXVpcmVQYXRoXzEpOyB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHByb2Nlc3NGb2xkZXIocGF0aCkge1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHBhdGgpKSB7XG4gICAgICAgIHZhciBmb2xkZXIgPSBmcy5Gb2xkZXIuZnJvbVBhdGgocGF0aCk7XG4gICAgICAgIGZvbGRlci5lYWNoRW50aXR5KGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIGZzLkZpbGUpIHtcbiAgICAgICAgICAgICAgICBwcm9jZXNzRmlsZShmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiByZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbShtb2R1bGVOYW1lKSB7XG4gICAgaW5pdGlhbGl6ZSgpO1xuICAgIGlmIChjYWNoZS5oYXMobW9kdWxlTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjYWNoZS5hZGQobW9kdWxlTmFtZSk7XG4gICAgdmFyIHBhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBtb2R1bGVOYW1lKTtcbiAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyhwYXRoKSkge1xuICAgICAgICBwcm9jZXNzRm9sZGVyKHBhdGgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBwYXJlbnROYW1lID0gbW9kdWxlTmFtZS5zdWJzdHIoMCwgbW9kdWxlTmFtZS5sYXN0SW5kZXhPZihmcy5wYXRoLnNlcGFyYXRvcikpO1xuICAgIHZhciBwYXJlbnRGb2xkZXJQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgcGFyZW50TmFtZSk7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHMocGFyZW50Rm9sZGVyUGF0aCkpIHtcbiAgICAgICAgcHJvY2Vzc0ZvbGRlcihwYXJlbnRGb2xkZXJQYXRoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdG5zTW9kdWxlc1BhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBcInRuc19tb2R1bGVzXCIsIG1vZHVsZU5hbWUpO1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHRuc01vZHVsZXNQYXRoKSkge1xuICAgICAgICBwcm9jZXNzRm9sZGVyKHRuc01vZHVsZXNQYXRoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocGFyZW50TmFtZSkge1xuICAgICAgICB2YXIgdG5zUGFyZW50Rm9sZGVyUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIFwidG5zX21vZHVsZXNcIiwgcGFyZW50TmFtZSk7XG4gICAgICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHRuc1BhcmVudEZvbGRlclBhdGgpKSB7XG4gICAgICAgICAgICBwcm9jZXNzRm9sZGVyKHRuc1BhcmVudEZvbGRlclBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5yZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbSA9IHJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICBpZiAoIWluaXRpYWxpemVkKSB7XG4gICAgICAgIGFwcENvbW1vbk1vZHVsZS5vbihcImxpdmVzeW5jXCIsIGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBjYWNoZS5jbGVhcigpOyB9KTtcbiAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBNSU5fV0ggPSBcIm1pbldIXCI7XG52YXIgTUlOX1cgPSBcIm1pbldcIjtcbnZhciBNSU5fSCA9IFwibWluSFwiO1xudmFyIFBSSU9SSVRZX1NURVAgPSAxMDAwMDtcbnZhciBtaW5XaWR0aEhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA9PT0gMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsTGVuZ3RoID0gTWF0aC5taW4oY29udGV4dC53aWR0aCwgY29udGV4dC5oZWlnaHQpO1xuICAgICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgbnVtVmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBSSU9SSVRZX1NURVAgLSAoYWN0dWFsTGVuZ3RoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbldpZHRoUXVhbGlmaWVyID0ge1xuICAgIGlzTWF0Y2g6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5kZXhPZihNSU5fVykgPT09IDAgJiYgdmFsdWUuaW5kZXhPZihNSU5fV0gpIDwgMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XLmxlbmd0aCkpO1xuICAgICAgICBpZiAoaXNOYU4obnVtVmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhY3R1YWxXaWR0aCA9IGNvbnRleHQud2lkdGg7XG4gICAgICAgIGlmIChhY3R1YWxXaWR0aCA8IG51bVZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQUklPUklUWV9TVEVQIC0gKGFjdHVhbFdpZHRoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbkhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX0gpID09PSAwICYmIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA8IDA7XG4gICAgfSxcbiAgICBnZXRNYXRjaFZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcbiAgICAgICAgdmFyIG51bVZhbCA9IHBhcnNlSW50KHZhbHVlLnN1YnN0cihNSU5fSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsSGVpZ2h0ID0gY29udGV4dC5oZWlnaHQ7XG4gICAgICAgIGlmIChhY3R1YWxIZWlnaHQgPCBudW1WYWwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUFJJT1JJVFlfU1RFUCAtIChhY3R1YWxIZWlnaHQgLSBudW1WYWwpO1xuICAgIH1cbn07XG52YXIgcGxhdGZvcm1RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJhbmRyb2lkXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcImlvc1wiO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gY29udGV4dC5vcy50b0xvd2VyQ2FzZSgpID8gMSA6IC0xO1xuICAgIH1cbn07XG52YXIgb3JpZW50YXRpb25RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJsYW5kXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcInBvcnRcIjtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgaXNMYW5kc2NhcGUgPSAoY29udGV4dC53aWR0aCA+IGNvbnRleHQuaGVpZ2h0KSA/IDEgOiAtMTtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSA9PT0gXCJsYW5kXCIpID8gaXNMYW5kc2NhcGUgOiAtaXNMYW5kc2NhcGU7XG4gICAgfVxufTtcbnZhciBzdXBwb3J0ZWRRdWFsaWZpZXJzID0gW1xuICAgIG1pbldpZHRoSGVpZ2h0UXVhbGlmaWVyLFxuICAgIG1pbldpZHRoUXVhbGlmaWVyLFxuICAgIG1pbkhlaWdodFF1YWxpZmllcixcbiAgICBvcmllbnRhdGlvblF1YWxpZmllcixcbiAgICBwbGF0Zm9ybVF1YWxpZmllclxuXTtcbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVycyhxdWFsaWZpZXJzLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgdmFyIHZhbHVlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVhbGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocXVhbGlmaWVyc1tpXSkge1xuICAgICAgICAgICAgdmFsdWUgPSBjaGVja1F1YWxpZmllcihxdWFsaWZpZXJzW2ldLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgKz0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVyKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1cHBvcnRlZFF1YWxpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uaXNNYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uZ2V0TWF0Y2hWYWx1ZSh2YWx1ZSwgY29udGV4dCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAoc3VwcG9ydGVkUXVhbGlmaWVycy5sZW5ndGggLSBpKSAqIFBSSU9SSVRZX1NURVA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGZpbmRNYXRjaChwYXRoLCBleHQsIGNhbmRpZGF0ZXMsIGNvbnRleHQpIHtcbiAgICB2YXIgYmVzdFZhbHVlID0gLTE7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBmaWxlUGF0aCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIHZhciBxdWFsaWZpZXJzU3RyID0gZmlsZVBhdGguc3Vic3RyKHBhdGgubGVuZ3RoLCBmaWxlUGF0aC5sZW5ndGggLSBwYXRoLmxlbmd0aCAtIChleHQgPyBleHQubGVuZ3RoIDogMCkpO1xuICAgICAgICB2YXIgcXVhbGlmaWVycyA9IHF1YWxpZmllcnNTdHIuc3BsaXQoXCIuXCIpO1xuICAgICAgICB2YXIgdmFsdWUgPSBjaGVja1F1YWxpZmllcnMocXVhbGlmaWVycywgY29udGV4dCk7XG4gICAgICAgIGlmICh2YWx1ZSA+PSAwICYmIHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZmluZE1hdGNoID0gZmluZE1hdGNoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVhbGlmaWVyLW1hdGNoZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBsYXRmb3JtTmFtZXM7XG4oZnVuY3Rpb24gKHBsYXRmb3JtTmFtZXMpIHtcbiAgICBwbGF0Zm9ybU5hbWVzLmFuZHJvaWQgPSBcIkFuZHJvaWRcIjtcbiAgICBwbGF0Zm9ybU5hbWVzLmlvcyA9IFwiaU9TXCI7XG59KShwbGF0Zm9ybU5hbWVzID0gZXhwb3J0cy5wbGF0Zm9ybU5hbWVzIHx8IChleHBvcnRzLnBsYXRmb3JtTmFtZXMgPSB7fSkpO1xudmFyIERldmljZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGV2aWNlKCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJtYW51ZmFjdHVyZXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBcIkFwcGxlXCI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGxhdGZvcm1OYW1lcy5pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm9zVmVyc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vc1ZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vc1ZlcnNpb24gPSBVSURldmljZS5jdXJyZW50RGV2aWNlLnN5c3RlbVZlcnNpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3NWZXJzaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9tb2RlbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsID0gVUlEZXZpY2UuY3VycmVudERldmljZS5tb2RlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwic2RrVmVyc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9zZGtWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2RrVmVyc2lvbiA9IFVJRGV2aWNlLmN1cnJlbnREZXZpY2Uuc3lzdGVtVmVyc2lvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZGtWZXJzaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJkZXZpY2VUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RldmljZVR5cGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoVUlEZXZpY2UuY3VycmVudERldmljZS51c2VySW50ZXJmYWNlSWRpb20gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGV2aWNlVHlwZSA9IFwiUGhvbmVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RldmljZVR5cGUgPSBcIlRhYmxldFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZXZpY2VUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJ1dWlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlckRlZmF1bHRzID0gTlNVc2VyRGVmYXVsdHMuc3RhbmRhcmRVc2VyRGVmYXVsdHM7XG4gICAgICAgICAgICB2YXIgdXVpZF9rZXkgPSBcIlROU1VVSURcIjtcbiAgICAgICAgICAgIHZhciBhcHBfdXVpZCA9IHVzZXJEZWZhdWx0cy5zdHJpbmdGb3JLZXkodXVpZF9rZXkpO1xuICAgICAgICAgICAgaWYgKCFhcHBfdXVpZCkge1xuICAgICAgICAgICAgICAgIGFwcF91dWlkID0gTlNVVUlELlVVSUQoKS5VVUlEU3RyaW5nO1xuICAgICAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5zZXRPYmplY3RGb3JLZXkoYXBwX3V1aWQsIHV1aWRfa2V5KTtcbiAgICAgICAgICAgICAgICB1c2VyRGVmYXVsdHMuc3luY2hyb25pemUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcHBfdXVpZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwibGFuZ3VhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGFuZ3VhZ2VzID0gTlNMb2NhbGUucHJlZmVycmVkTGFuZ3VhZ2VzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhbmd1YWdlID0gbGFuZ3VhZ2VzWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhbmd1YWdlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJyZWdpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fcmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVnaW9uID0gTlNMb2NhbGUuY3VycmVudExvY2FsZS5vYmplY3RGb3JLZXkoTlNMb2NhbGVDb3VudHJ5Q29kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVnaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gRGV2aWNlO1xufSgpKTtcbnZhciBNYWluU2NyZWVuID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNYWluU2NyZWVuKCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwic2NyZWVuXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3NjcmVlbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NjcmVlbiA9IFVJU2NyZWVuLm1haW5TY3JlZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2NyZWVuO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwid2lkdGhQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndpZHRoRElQcyAqIHRoaXMuc2NhbGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYWluU2NyZWVuLnByb3RvdHlwZSwgXCJoZWlnaHRQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhlaWdodERJUHMgKiB0aGlzLnNjYWxlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwic2NhbGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmVlbi5zY2FsZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcIndpZHRoRElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyZWVuLmJvdW5kcy5zaXplLndpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwiaGVpZ2h0RElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyZWVuLmJvdW5kcy5zaXplLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIE1haW5TY3JlZW47XG59KCkpO1xuZXhwb3J0cy5kZXZpY2UgPSBuZXcgRGV2aWNlKCk7XG52YXIgc2NyZWVuO1xuKGZ1bmN0aW9uIChzY3JlZW4pIHtcbiAgICBzY3JlZW4ubWFpblNjcmVlbiA9IG5ldyBNYWluU2NyZWVuKCk7XG59KShzY3JlZW4gPSBleHBvcnRzLnNjcmVlbiB8fCAoZXhwb3J0cy5zY3JlZW4gPSB7fSkpO1xuZXhwb3J0cy5pc0lPUyA9IHRydWU7XG5leHBvcnRzLmlzQW5kcm9pZCA9IGZhbHNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGxhdGZvcm0uaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIHVwdGltZSgpIHtcbiAgICByZXR1cm4gZ2xvYmFsLmFuZHJvaWQgPyBvcmcubmF0aXZlc2NyaXB0LlByb2Nlc3MuZ2V0VXBUaW1lKCkgOiBnbG9iYWwuX190bnNfdXB0aW1lKCk7XG59XG5leHBvcnRzLnVwdGltZSA9IHVwdGltZTtcbmZ1bmN0aW9uIGxvZyhtZXNzYWdlKSB7XG4gICAgaWYgKGdsb2JhbC5fX25zbG9nKSB7XG4gICAgICAgIGdsb2JhbC5fX25zbG9nKFwiQ09OU09MRSBMT0c6IFwiICsgbWVzc2FnZSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xufVxuZXhwb3J0cy5sb2cgPSBsb2c7XG52YXIgdGltZXJzID0ge307XG52YXIgYW55R2xvYmFsID0gZ2xvYmFsO1xudmFyIHByb2ZpbGVOYW1lcyA9IFtdO1xuZXhwb3J0cy50aW1lID0gZ2xvYmFsLl9fdGltZSB8fCBEYXRlLm5vdztcbmZ1bmN0aW9uIHN0YXJ0KG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICBpZiAoaW5mbykge1xuICAgICAgICBpbmZvLmN1cnJlbnRTdGFydCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICBpbmZvLnJ1bkNvdW50Kys7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbmZvID0ge1xuICAgICAgICAgICAgdG90YWxUaW1lOiAwLFxuICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICBjdXJyZW50U3RhcnQ6IGV4cG9ydHMudGltZSgpLFxuICAgICAgICAgICAgcnVuQ291bnQ6IDFcbiAgICAgICAgfTtcbiAgICAgICAgdGltZXJzW25hbWVdID0gaW5mbztcbiAgICAgICAgcHJvZmlsZU5hbWVzLnB1c2gobmFtZSk7XG4gICAgfVxufVxuZXhwb3J0cy5zdGFydCA9IHN0YXJ0O1xuZnVuY3Rpb24gc3RvcChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRpbWVyIHN0YXJ0ZWQ6IFwiICsgbmFtZSk7XG4gICAgfVxuICAgIGlmIChpbmZvLnJ1bkNvdW50KSB7XG4gICAgICAgIGluZm8ucnVuQ291bnQtLTtcbiAgICAgICAgaWYgKGluZm8ucnVuQ291bnQpIHtcbiAgICAgICAgICAgIGluZm8uY291bnQrKztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGluZm8ubGFzdFRpbWUgPSBleHBvcnRzLnRpbWUoKSAtIGluZm8uY3VycmVudFN0YXJ0O1xuICAgICAgICAgICAgaW5mby50b3RhbFRpbWUgKz0gaW5mby5sYXN0VGltZTtcbiAgICAgICAgICAgIGluZm8uY291bnQrKztcbiAgICAgICAgICAgIGluZm8uY3VycmVudFN0YXJ0ID0gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGltZXIgXCIgKyBuYW1lICsgXCIgcGF1c2VkIG1vcmUgdGltZXMgdGhhbiBzdGFydGVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGluZm87XG59XG5leHBvcnRzLnN0b3AgPSBzdG9wO1xuZnVuY3Rpb24gdGltZXIobmFtZSkge1xuICAgIHJldHVybiB0aW1lcnNbbmFtZV07XG59XG5leHBvcnRzLnRpbWVyID0gdGltZXI7XG5mdW5jdGlvbiBwcmludChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRpbWVyIHN0YXJ0ZWQ6IFwiICsgbmFtZSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwiLS0tLSBbXCIgKyBuYW1lICsgXCJdIFNUT1AgdG90YWw6IFwiICsgaW5mby50b3RhbFRpbWUgKyBcIiBjb3VudDpcIiArIGluZm8uY291bnQpO1xuICAgIHJldHVybiBpbmZvO1xufVxuZXhwb3J0cy5wcmludCA9IHByaW50O1xuZnVuY3Rpb24gaXNSdW5uaW5nKG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICByZXR1cm4gISEoaW5mbyAmJiBpbmZvLnJ1bkNvdW50KTtcbn1cbmV4cG9ydHMuaXNSdW5uaW5nID0gaXNSdW5uaW5nO1xuZnVuY3Rpb24gY291bnRlcnNQcm9maWxlRnVuY3Rpb25GYWN0b3J5KGZuLCBuYW1lLCB0eXBlKSB7XG4gICAgaWYgKHR5cGUgPT09IHZvaWQgMCkgeyB0eXBlID0gMTsgfVxuICAgIHByb2ZpbGVOYW1lcy5wdXNoKG5hbWUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0YXJ0KG5hbWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBzdG9wKG5hbWUpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRpbWVsaW5lUHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShmbiwgbmFtZSwgdHlwZSkge1xuICAgIGlmICh0eXBlID09PSB2b2lkIDApIHsgdHlwZSA9IDE7IH1cbiAgICByZXR1cm4gdHlwZSA9PT0gMSA/IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHZhciBlbmQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZWxpbmU6IE1vZHVsZXM6IFwiICsgbmFtZSArIFwiIFwiICsgdGhpcyArIFwiICAoXCIgKyBzdGFydCArIFwibXMuIC0gXCIgKyBlbmQgKyBcIm1zLilcIik7XG4gICAgICAgIH1cbiAgICB9IDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdmFyIGVuZCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lbGluZTogTW9kdWxlczogXCIgKyBuYW1lICsgXCIgIChcIiArIHN0YXJ0ICsgXCJtcy4gLSBcIiArIGVuZCArIFwibXMuKVwiKTtcbiAgICAgICAgfVxuICAgIH07XG59XG52YXIgTGV2ZWw7XG4oZnVuY3Rpb24gKExldmVsKSB7XG4gICAgTGV2ZWxbTGV2ZWxbXCJub25lXCJdID0gMF0gPSBcIm5vbmVcIjtcbiAgICBMZXZlbFtMZXZlbFtcImxpZmVjeWNsZVwiXSA9IDFdID0gXCJsaWZlY3ljbGVcIjtcbiAgICBMZXZlbFtMZXZlbFtcInRpbWVsaW5lXCJdID0gMl0gPSBcInRpbWVsaW5lXCI7XG59KShMZXZlbCA9IGV4cG9ydHMuTGV2ZWwgfHwgKGV4cG9ydHMuTGV2ZWwgPSB7fSkpO1xudmFyIHRyYWNpbmdMZXZlbCA9IExldmVsLm5vbmU7XG52YXIgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeTtcbmZ1bmN0aW9uIGVuYWJsZShtb2RlKSB7XG4gICAgaWYgKG1vZGUgPT09IHZvaWQgMCkgeyBtb2RlID0gXCJjb3VudGVyc1wiOyB9XG4gICAgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSA9IG1vZGUgJiYge1xuICAgICAgICBjb3VudGVyczogY291bnRlcnNQcm9maWxlRnVuY3Rpb25GYWN0b3J5LFxuICAgICAgICB0aW1lbGluZTogdGltZWxpbmVQcm9maWxlRnVuY3Rpb25GYWN0b3J5XG4gICAgfVttb2RlXTtcbiAgICB0cmFjaW5nTGV2ZWwgPSB7XG4gICAgICAgIGxpZmVjeWNsZTogTGV2ZWwubGlmZWN5Y2xlLFxuICAgICAgICB0aW1lbGluZTogTGV2ZWwudGltZWxpbmUsXG4gICAgfVttb2RlXSB8fCBMZXZlbC5ub25lO1xufVxuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG50cnkge1xuICAgIHZhciBhcHBDb25maWcgPSByZXF1aXJlKFwifi9wYWNrYWdlLmpzb25cIik7XG4gICAgaWYgKGFwcENvbmZpZyAmJiBhcHBDb25maWcucHJvZmlsaW5nKSB7XG4gICAgICAgIGVuYWJsZShhcHBDb25maWcucHJvZmlsaW5nKTtcbiAgICB9XG59XG5jYXRjaCAoZTEpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlByb2ZpbGluZyBzdGFydHVwIGZhaWxlZCB0byBmaWd1cmUgb3V0IGRlZmF1bHRzIGZyb20gcGFja2FnZS5qc29uLCBlcnJvcjogXCIgKyBlMSk7XG4gICAgfVxuICAgIGNhdGNoIChlMikge1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSA9IHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5mdW5jdGlvbiBwcm9maWxlRnVuY3Rpb24oZm4sIGN1c3RvbU5hbWUpIHtcbiAgICByZXR1cm4gcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShmbiwgY3VzdG9tTmFtZSB8fCBmbi5uYW1lKTtcbn1cbnZhciBwcm9maWxlTWV0aG9kVW5uYW1lZCA9IGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIHZhciBjbGFzc05hbWUgPSBcIlwiO1xuICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmNvbnN0cnVjdG9yICYmIHRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IHRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lICsgXCIuXCI7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY2xhc3NOYW1lICsga2V5O1xuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBwcm9maWxlRnVuY3Rpb25GYWN0b3J5KG9yaWdpbmFsTWV0aG9kLCBuYW1lLCAxKTtcbiAgICByZXR1cm4gZGVzY3JpcHRvcjtcbn07XG52YXIgcHJvZmlsZVN0YXRpY01ldGhvZFVubmFtZWQgPSBmdW5jdGlvbiAoY3Rvciwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihjdG9yLCBrZXkpO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIHZhciBjbGFzc05hbWUgPSBcIlwiO1xuICAgIGlmIChjdG9yICYmIGN0b3IubmFtZSkge1xuICAgICAgICBjbGFzc05hbWUgPSBjdG9yLm5hbWUgKyBcIi5cIjtcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBjbGFzc05hbWUgKyBrZXk7XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnkob3JpZ2luYWxNZXRob2QsIG5hbWUsIDApO1xuICAgIHJldHVybiBkZXNjcmlwdG9yO1xufTtcbmZ1bmN0aW9uIHByb2ZpbGVNZXRob2ROYW1lZChuYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgICAgICBpZiAoZGVzY3JpcHRvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnkob3JpZ2luYWxNZXRob2QsIG5hbWUpO1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9O1xufVxudmFyIHZvaWRNZXRob2REZWNvcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG59O1xuZnVuY3Rpb24gcHJvZmlsZShuYW1lRm5PclRhcmdldCwgZm5PcktleSwgZGVzY3JpcHRvcikge1xuICAgIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwib2JqZWN0XCIgJiYgKHR5cGVvZiBmbk9yS2V5ID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBmbk9yS2V5ID09PSBcInN5bWJvbFwiKSkge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZU1ldGhvZFVubmFtZWQobmFtZUZuT3JUYXJnZXQsIGZuT3JLZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwiZnVuY3Rpb25cIiAmJiAodHlwZW9mIGZuT3JLZXkgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGZuT3JLZXkgPT09IFwic3ltYm9sXCIpKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlU3RhdGljTWV0aG9kVW5uYW1lZChuYW1lRm5PclRhcmdldCwgZm5PcktleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgZm5PcktleSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZuT3JLZXk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVGdW5jdGlvbihmbk9yS2V5LCBuYW1lRm5PclRhcmdldCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIG5hbWVGbk9yVGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlRnVuY3Rpb24obmFtZUZuT3JUYXJnZXQpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gdm9pZE1ldGhvZERlY29yYXRvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZU1ldGhvZE5hbWVkKG5hbWVGbk9yVGFyZ2V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIHZvaWRNZXRob2REZWNvcmF0b3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVNZXRob2RVbm5hbWVkO1xuICAgIH1cbn1cbmV4cG9ydHMucHJvZmlsZSA9IHByb2ZpbGU7XG5mdW5jdGlvbiBkdW1wUHJvZmlsZXMoKSB7XG4gICAgcHJvZmlsZU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0gW1wiICsgbmFtZSArIFwiXSBTVE9QIHRvdGFsOiBcIiArIGluZm8udG90YWxUaW1lICsgXCIgY291bnQ6XCIgKyBpbmZvLmNvdW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLSBbXCIgKyBuYW1lICsgXCJdIE5ldmVyIGNhbGxlZFwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5kdW1wUHJvZmlsZXMgPSBkdW1wUHJvZmlsZXM7XG5mdW5jdGlvbiByZXNldFByb2ZpbGVzKCkge1xuICAgIHByb2ZpbGVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgaWYgKGluZm8ucnVuQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0gdGltZXIgd2l0aCBuYW1lIFtcIiArIG5hbWUgKyBcIl0gaXMgY3VycmVudGx5IHJ1bm5pbmcgYW5kIHdvbid0IGJlIHJlc2V0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGltZXJzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnJlc2V0UHJvZmlsZXMgPSByZXNldFByb2ZpbGVzO1xuZnVuY3Rpb24gc3RhcnRDUFVQcm9maWxlKG5hbWUpIHtcbiAgICBpZiAoYW55R2xvYmFsLmFuZHJvaWQpIHtcbiAgICAgICAgX19zdGFydENQVVByb2ZpbGVyKG5hbWUpO1xuICAgIH1cbn1cbmV4cG9ydHMuc3RhcnRDUFVQcm9maWxlID0gc3RhcnRDUFVQcm9maWxlO1xuZnVuY3Rpb24gc3RvcENQVVByb2ZpbGUobmFtZSkge1xuICAgIGlmIChhbnlHbG9iYWwuYW5kcm9pZCkge1xuICAgICAgICBfX3N0b3BDUFVQcm9maWxlcihuYW1lKTtcbiAgICB9XG59XG5leHBvcnRzLnN0b3BDUFVQcm9maWxlID0gc3RvcENQVVByb2ZpbGU7XG5mdW5jdGlvbiBsZXZlbCgpIHtcbiAgICByZXR1cm4gdHJhY2luZ0xldmVsO1xufVxuZXhwb3J0cy5sZXZlbCA9IGxldmVsO1xuZnVuY3Rpb24gdHJhY2UobWVzc2FnZSwgc3RhcnQsIGVuZCkge1xuICAgIGxvZyhcIlRpbWVsaW5lOiBNb2R1bGVzOiBcIiArIG1lc3NhZ2UgKyBcIiAgKFwiICsgc3RhcnQgKyBcIm1zLiAtIFwiICsgZW5kICsgXCJtcy4pXCIpO1xufVxuZXhwb3J0cy50cmFjZSA9IHRyYWNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvZmlsaW5nLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzcGFuXzEgPSByZXF1aXJlKFwiLi9zcGFuXCIpO1xuZXhwb3J0cy5TcGFuID0gc3Bhbl8xLlNwYW47XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbnZhciBvYnNlcnZhYmxlX2FycmF5XzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlLWFycmF5XCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi91aS9jb3JlL3ZpZXdcIik7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuc3BhbnMgPSBcInNwYW5zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIEZvcm1hdHRlZFN0cmluZyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZvcm1hdHRlZFN0cmluZywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGb3JtYXR0ZWRTdHJpbmcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9zcGFucyA9IG5ldyBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgICAgIF90aGlzLl9zcGFucy5hZGRFdmVudExpc3RlbmVyKG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIF90aGlzLm9uU3BhbnNDb2xsZWN0aW9uQ2hhbmdlZCwgX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRGYW1pbHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRGYW1pbHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRGYW1pbHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiZm9udFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRXZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRXZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRXZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwidGV4dERlY29yYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImJhY2tncm91bmRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwic3BhbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc3BhbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zcGFucyA9IG5ldyBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3BhbnM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB0aGlzLl9zcGFucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5fc3BhbnMuZ2V0SXRlbShpKS50ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLl9hZGRBcnJheUZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBrbm93bkNvbGxlY3Rpb25zLnNwYW5zKSB7XG4gICAgICAgICAgICB0aGlzLnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHNwYW5fMS5TcGFuKSB7XG4gICAgICAgICAgICB0aGlzLnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLm9uU3BhbnNDb2xsZWN0aW9uQ2hhbmdlZCA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgaWYgKGV2ZW50RGF0YS5hZGRlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudERhdGEuYWRkZWRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBldmVudERhdGEub2JqZWN0LmdldEl0ZW0oZXZlbnREYXRhLmluZGV4ICsgaSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyhzcGFuKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlSGFuZGxlcihzcGFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnREYXRhLnJlbW92ZWQgJiYgZXZlbnREYXRhLnJlbW92ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBldmVudERhdGEucmVtb3ZlZC5sZW5ndGg7IHArKykge1xuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gZXZlbnREYXRhLnJlbW92ZWRbcF07XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVQcm9wZXJ0eUNoYW5nZUhhbmRsZXIoc3Bhbik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyhzcGFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKFwiLlwiLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuYWRkUHJvcGVydHlDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24gKHNwYW4pIHtcbiAgICAgICAgdmFyIHN0eWxlID0gc3Bhbi5zdHlsZTtcbiAgICAgICAgc3Bhbi5vbihvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRGYW1pbHlDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJmb250U2l6ZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRTdHlsZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRXZWlnaHRDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJ0ZXh0RGVjb3JhdGlvbkNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImNvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiYmFja2dyb3VuZENvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLnJlbW92ZVByb3BlcnR5Q2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzcGFuKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHNwYW4uc3R5bGU7XG4gICAgICAgIHNwYW4ub2ZmKG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRGYW1pbHlDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udFNpemVDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udFN0eWxlQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRXZWlnaHRDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwidGV4dERlY29yYXRpb25DaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiYmFja2dyb3VuZENvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKGRhdGEucHJvcGVydHlOYW1lLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuc3BhbnMuZm9yRWFjaChmdW5jdGlvbiAodiwgaSwgYXJyKSB7IHJldHVybiBjYWxsYmFjayh2KTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gRm9ybWF0dGVkU3RyaW5nO1xufSh2aWV3XzEuVmlld0Jhc2UpKTtcbmV4cG9ydHMuRm9ybWF0dGVkU3RyaW5nID0gRm9ybWF0dGVkU3RyaW5nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9ybWF0dGVkLXN0cmluZy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL3VpL2NvcmUvdmlld1wiKTtcbnZhciBTcGFuID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3BhbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTcGFuKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250RmFtaWx5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250RmFtaWx5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250RmFtaWx5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250U2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250V2VpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250V2VpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250V2VpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJ0ZXh0RGVjb3JhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJ0ZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXh0ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKFwidGV4dFwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNwYW4ucHJvdG90eXBlLl9zZXRUZXh0SW50ZXJuYWwgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdGV4dCA9IHZhbHVlO1xuICAgIH07XG4gICAgcmV0dXJuIFNwYW47XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5TcGFuID0gU3Bhbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNwYW4uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVuY29kaW5nO1xuKGZ1bmN0aW9uIChlbmNvZGluZykge1xuICAgIGVuY29kaW5nLklTT184ODU5XzEgPSA1O1xuICAgIGVuY29kaW5nLlVTX0FTQ0lJID0gMTtcbiAgICBlbmNvZGluZy5VVEZfMTYgPSAxMDtcbiAgICBlbmNvZGluZy5VVEZfMTZCRSA9IDB4OTAwMDAxMDA7XG4gICAgZW5jb2RpbmcuVVRGXzE2TEUgPSAweDk0MDAwMTAwO1xuICAgIGVuY29kaW5nLlVURl84ID0gNDtcbn0pKGVuY29kaW5nID0gZXhwb3J0cy5lbmNvZGluZyB8fCAoZXhwb3J0cy5lbmNvZGluZyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0Lmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGltZW91dENhbGxiYWNrcyA9IG5ldyBNYXAoKTtcbnZhciB0aW1lcklkID0gMDtcbnZhciBUaW1lclRhcmdldEltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUaW1lclRhcmdldEltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGltZXJUYXJnZXRJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRpbWVyVGFyZ2V0SW1wbC5pbml0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBpZCwgc2hvdWxkUmVwZWF0KSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gVGltZXJUYXJnZXRJbXBsLm5ldygpO1xuICAgICAgICBoYW5kbGVyLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIGhhbmRsZXIuaWQgPSBpZDtcbiAgICAgICAgaGFuZGxlci5zaG91bGRSZXBlYXQgPSBzaG91bGRSZXBlYXQ7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVGltZXJUYXJnZXRJbXBsLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24gKHRpbWVyKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNwb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zaG91bGRSZXBlYXQpIHtcbiAgICAgICAgICAgIHRoaXMudW5yZWdpc3RlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUaW1lclRhcmdldEltcGwucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNwb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5kaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGltZXIgPSB0aW1lb3V0Q2FsbGJhY2tzLmdldCh0aGlzLmlkKS5rO1xuICAgICAgICAgICAgdGltZXIuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgdGltZW91dENhbGxiYWNrcy5kZWxldGUodGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRpbWVyVGFyZ2V0SW1wbC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwidGlja1wiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbTlNUaW1lcl0gfVxuICAgIH07XG4gICAgcmV0dXJuIFRpbWVyVGFyZ2V0SW1wbDtcbn0oTlNPYmplY3QpKTtcbmZ1bmN0aW9uIGNyZWF0ZVRpbWVyQW5kR2V0SWQoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcywgc2hvdWxkUmVwZWF0KSB7XG4gICAgdGltZXJJZCsrO1xuICAgIHZhciBpZCA9IHRpbWVySWQ7XG4gICAgdmFyIHRpbWVyVGFyZ2V0ID0gVGltZXJUYXJnZXRJbXBsLmluaXRXaXRoQ2FsbGJhY2soY2FsbGJhY2ssIGlkLCBzaG91bGRSZXBlYXQpO1xuICAgIHZhciB0aW1lciA9IE5TVGltZXIuc2NoZWR1bGVkVGltZXJXaXRoVGltZUludGVydmFsVGFyZ2V0U2VsZWN0b3JVc2VySW5mb1JlcGVhdHMobWlsbGlzZWNvbmRzIC8gMTAwMCwgdGltZXJUYXJnZXQsIFwidGlja1wiLCBudWxsLCBzaG91bGRSZXBlYXQpO1xuICAgIE5TUnVuTG9vcC5jdXJyZW50UnVuTG9vcC5hZGRUaW1lckZvck1vZGUodGltZXIsIE5TUnVuTG9vcENvbW1vbk1vZGVzKTtcbiAgICB2YXIgcGFpciA9IHsgazogdGltZXIsIHY6IHRpbWVyVGFyZ2V0IH07XG4gICAgdGltZW91dENhbGxiYWNrcy5zZXQoaWQsIHBhaXIpO1xuICAgIHJldHVybiBpZDtcbn1cbmZ1bmN0aW9uIHNldFRpbWVvdXQoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcykge1xuICAgIGlmIChtaWxsaXNlY29uZHMgPT09IHZvaWQgMCkgeyBtaWxsaXNlY29uZHMgPSAwOyB9XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgaW52b2tlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FsbGJhY2suYXBwbHkodm9pZCAwLCBhcmdzKTsgfTtcbiAgICByZXR1cm4gY3JlYXRlVGltZXJBbmRHZXRJZCh6b25lZENhbGxiYWNrKGludm9rZSksIG1pbGxpc2Vjb25kcywgZmFsc2UpO1xufVxuZXhwb3J0cy5zZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbmZ1bmN0aW9uIGNsZWFyVGltZW91dChpZCkge1xuICAgIHZhciBwYWlyID0gdGltZW91dENhbGxiYWNrcy5nZXQoaWQpO1xuICAgIGlmIChwYWlyKSB7XG4gICAgICAgIHBhaXIudi51bnJlZ2lzdGVyKCk7XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG5mdW5jdGlvbiBzZXRJbnRlcnZhbChjYWxsYmFjaywgbWlsbGlzZWNvbmRzKSB7XG4gICAgaWYgKG1pbGxpc2Vjb25kcyA9PT0gdm9pZCAwKSB7IG1pbGxpc2Vjb25kcyA9IDA7IH1cbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBpbnZva2UgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjay5hcHBseSh2b2lkIDAsIGFyZ3MpOyB9O1xuICAgIHJldHVybiBjcmVhdGVUaW1lckFuZEdldElkKHpvbmVkQ2FsbGJhY2soaW52b2tlKSwgbWlsbGlzZWNvbmRzLCB0cnVlKTtcbn1cbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbDtcbmV4cG9ydHMuY2xlYXJJbnRlcnZhbCA9IGNsZWFyVGltZW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRpbWVyLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW5hYmxlZCA9IGZhbHNlO1xudmFyIF9jYXRlZ29yaWVzID0ge307XG52YXIgX3dyaXRlcnMgPSBbXTtcbnZhciBfZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbnZhciBfZXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIGVuYWJsZWQgPSB0cnVlO1xufVxuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIGVuYWJsZWQgPSBmYWxzZTtcbn1cbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5mdW5jdGlvbiBpc0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIGVuYWJsZWQ7XG59XG5leHBvcnRzLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcbmZ1bmN0aW9uIGlzQ2F0ZWdvcnlTZXQoY2F0ZWdvcnkpIHtcbiAgICByZXR1cm4gY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXM7XG59XG5leHBvcnRzLmlzQ2F0ZWdvcnlTZXQgPSBpc0NhdGVnb3J5U2V0O1xuZnVuY3Rpb24gYWRkV3JpdGVyKHdyaXRlcikge1xuICAgIF93cml0ZXJzLnB1c2god3JpdGVyKTtcbn1cbmV4cG9ydHMuYWRkV3JpdGVyID0gYWRkV3JpdGVyO1xuZnVuY3Rpb24gcmVtb3ZlV3JpdGVyKHdyaXRlcikge1xuICAgIHZhciBpbmRleCA9IF93cml0ZXJzLmluZGV4T2Yod3JpdGVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfd3JpdGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlV3JpdGVyID0gcmVtb3ZlV3JpdGVyO1xuZnVuY3Rpb24gY2xlYXJXcml0ZXJzKCkge1xuICAgIGlmIChfd3JpdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF93cml0ZXJzLnNwbGljZSgwLCBfd3JpdGVycy5sZW5ndGgpO1xuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJXcml0ZXJzID0gY2xlYXJXcml0ZXJzO1xuZnVuY3Rpb24gc2V0Q2F0ZWdvcmllcyhjYXRlZ29yaWVzKSB7XG4gICAgX2NhdGVnb3JpZXMgPSB7fTtcbiAgICBhZGRDYXRlZ29yaWVzKGNhdGVnb3JpZXMpO1xufVxuZXhwb3J0cy5zZXRDYXRlZ29yaWVzID0gc2V0Q2F0ZWdvcmllcztcbmZ1bmN0aW9uIGFkZENhdGVnb3JpZXMoY2F0ZWdvcmllcykge1xuICAgIHZhciBzcGxpdCA9IGNhdGVnb3JpZXMuc3BsaXQoXCIsXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2NhdGVnb3JpZXNbc3BsaXRbaV0udHJpbSgpXSA9IHRydWU7XG4gICAgfVxufVxuZXhwb3J0cy5hZGRDYXRlZ29yaWVzID0gYWRkQ2F0ZWdvcmllcztcbmZ1bmN0aW9uIHdyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKSB7XG4gICAgdmFyIGk7XG4gICAgaWYgKHR5cGUgPT09IG1lc3NhZ2VUeXBlLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBfd3JpdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX3dyaXRlcnNbaV0ud3JpdGUobWVzc2FnZSwgY2F0ZWdvcnksIHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFlbmFibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEoY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXMpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IF93cml0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF93cml0ZXJzW2ldLndyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKTtcbiAgICB9XG59XG5leHBvcnRzLndyaXRlID0gd3JpdGU7XG5mdW5jdGlvbiBub3RpZnlFdmVudChvYmplY3QsIG5hbWUsIGRhdGEpIHtcbiAgICBpZiAoIWVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaSwgbGlzdGVuZXIsIGZpbHRlcnM7XG4gICAgZm9yIChpID0gMDsgaSA8IF9ldmVudExpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsaXN0ZW5lciA9IF9ldmVudExpc3RlbmVyc1tpXTtcbiAgICAgICAgaWYgKGxpc3RlbmVyLmZpbHRlcikge1xuICAgICAgICAgICAgZmlsdGVycyA9IGxpc3RlbmVyLmZpbHRlci5zcGxpdChcIixcIik7XG4gICAgICAgICAgICBmaWx0ZXJzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnRyaW0oKSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5vbihvYmplY3QsIG5hbWUsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdGVuZXIub24ob2JqZWN0LCBuYW1lLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMubm90aWZ5RXZlbnQgPSBub3RpZnlFdmVudDtcbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICBfZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG59XG5leHBvcnRzLmFkZEV2ZW50TGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyO1xuZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIHZhciBpbmRleCA9IF9ldmVudExpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfZXZlbnRMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG59XG5leHBvcnRzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSByZW1vdmVFdmVudExpc3RlbmVyO1xudmFyIG1lc3NhZ2VUeXBlO1xuKGZ1bmN0aW9uIChtZXNzYWdlVHlwZSkge1xuICAgIG1lc3NhZ2VUeXBlLmxvZyA9IDA7XG4gICAgbWVzc2FnZVR5cGUuaW5mbyA9IDE7XG4gICAgbWVzc2FnZVR5cGUud2FybiA9IDI7XG4gICAgbWVzc2FnZVR5cGUuZXJyb3IgPSAzO1xufSkobWVzc2FnZVR5cGUgPSBleHBvcnRzLm1lc3NhZ2VUeXBlIHx8IChleHBvcnRzLm1lc3NhZ2VUeXBlID0ge30pKTtcbnZhciBjYXRlZ29yaWVzO1xuKGZ1bmN0aW9uIChjYXRlZ29yaWVzKSB7XG4gICAgY2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzID0gXCJWaXN1YWxUcmVlRXZlbnRzXCI7XG4gICAgY2F0ZWdvcmllcy5MYXlvdXQgPSBcIkxheW91dFwiO1xuICAgIGNhdGVnb3JpZXMuU3R5bGUgPSBcIlN0eWxlXCI7XG4gICAgY2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5ID0gXCJWaWV3SGllcmFyY2h5XCI7XG4gICAgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUgPSBcIk5hdGl2ZUxpZmVjeWNsZVwiO1xuICAgIGNhdGVnb3JpZXMuRGVidWcgPSBcIkRlYnVnXCI7XG4gICAgY2F0ZWdvcmllcy5OYXZpZ2F0aW9uID0gXCJOYXZpZ2F0aW9uXCI7XG4gICAgY2F0ZWdvcmllcy5UZXN0ID0gXCJUZXN0XCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nID0gXCJCaW5kaW5nXCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nRXJyb3IgPSBcIkJpbmRpbmdFcnJvclwiO1xuICAgIGNhdGVnb3JpZXMuRXJyb3IgPSBcIkVycm9yXCI7XG4gICAgY2F0ZWdvcmllcy5BbmltYXRpb24gPSBcIkFuaW1hdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuVHJhbnNpdGlvbiA9IFwiVHJhbnNpdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuTGl2ZXN5bmMgPSBcIkxpdmVzeW5jXCI7XG4gICAgY2F0ZWdvcmllcy5zZXBhcmF0b3IgPSBcIixcIjtcbiAgICBjYXRlZ29yaWVzLkFsbCA9IGNhdGVnb3JpZXMuVmlzdWFsVHJlZUV2ZW50cyArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5MYXlvdXQgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuU3R5bGUgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuRGVidWcgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuTmF2aWdhdGlvbiArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5UZXN0ICsgY2F0ZWdvcmllcy5zZXBhcmF0b3JcbiAgICAgICAgKyBjYXRlZ29yaWVzLkJpbmRpbmcgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuRXJyb3IgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuQW5pbWF0aW9uICsgY2F0ZWdvcmllcy5zZXBhcmF0b3JcbiAgICAgICAgKyBjYXRlZ29yaWVzLlRyYW5zaXRpb24gKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuTGl2ZXN5bmM7XG4gICAgZnVuY3Rpb24gY29uY2F0KCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGNhdGVnb3JpZXMuc2VwYXJhdG9yLCBhcmd1bWVudHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGNhdGVnb3JpZXMuY29uY2F0ID0gY29uY2F0O1xufSkoY2F0ZWdvcmllcyA9IGV4cG9ydHMuY2F0ZWdvcmllcyB8fCAoZXhwb3J0cy5jYXRlZ29yaWVzID0ge30pKTtcbnZhciBDb25zb2xlV3JpdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb25zb2xlV3JpdGVyKCkge1xuICAgIH1cbiAgICBDb25zb2xlV3JpdGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBjYXRlZ29yeSwgdHlwZSkge1xuICAgICAgICBpZiAoIWNvbnNvbGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXNnVHlwZTtcbiAgICAgICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbXNnVHlwZSA9IG1lc3NhZ2VUeXBlLmxvZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1zZ1R5cGUgPSB0eXBlO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAobXNnVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS5sb2c6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuaW5mbzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUud2FybjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuZXJyb3I6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ29uc29sZVdyaXRlcjtcbn0oKSk7XG5hZGRXcml0ZXIobmV3IENvbnNvbGVXcml0ZXIoKSk7XG52YXIgRGVmYXVsdEVycm9ySGFuZGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVmYXVsdEVycm9ySGFuZGxlcigpIHtcbiAgICB9XG4gICAgRGVmYXVsdEVycm9ySGFuZGxlci5wcm90b3R5cGUuaGFuZGxlckVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH07XG4gICAgcmV0dXJuIERlZmF1bHRFcnJvckhhbmRsZXI7XG59KCkpO1xuZXhwb3J0cy5EZWZhdWx0RXJyb3JIYW5kbGVyID0gRGVmYXVsdEVycm9ySGFuZGxlcjtcbnNldEVycm9ySGFuZGxlcihuZXcgRGVmYXVsdEVycm9ySGFuZGxlcigpKTtcbmZ1bmN0aW9uIGdldEVycm9ySGFuZGxlcigpIHtcbiAgICByZXR1cm4gX2Vycm9ySGFuZGxlcjtcbn1cbmV4cG9ydHMuZ2V0RXJyb3JIYW5kbGVyID0gZ2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gc2V0RXJyb3JIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICBfZXJyb3JIYW5kbGVyID0gaGFuZGxlcjtcbn1cbmV4cG9ydHMuc2V0RXJyb3JIYW5kbGVyID0gc2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoIV9lcnJvckhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKGVycm9yKTtcbiAgICB9XG4gICAgX2Vycm9ySGFuZGxlci5oYW5kbGVyRXJyb3IoZXJyb3IpO1xufVxuZXhwb3J0cy5lcnJvciA9IGVycm9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhY2UuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLmFjdGlvbkl0ZW1zID0gXCJhY3Rpb25JdGVtc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBBY3Rpb25CYXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uQmFyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpb25CYXJCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYWN0aW9uSXRlbXMgPSBuZXcgQWN0aW9uSXRlbXMoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJuYXZpZ2F0aW9uQnV0dG9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fbmF2aWdhdGlvbkJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25hdmlnYXRpb25CdXR0b24uYWN0aW9uQmFyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQnV0dG9uID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbi5hY3Rpb25CYXIgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX25hdmlnYXRpb25CdXR0b24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUsIFwiYWN0aW9uSXRlbXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hY3Rpb25JdGVtcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImFjdGlvbkl0ZW1zIHByb3BlcnR5IGlzIHJlYWQtb25seVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkJhckJhc2UucHJvdG90eXBlLCBcInRpdGxlVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpdGxlVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aXRsZVZpZXcgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlVmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHRoaXMuX3RpdGxlVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlVmlldy5zdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlVmlldy5zdHlsZVt2aWV3XzEudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IHZpZXdfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl90aXRsZVZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHZhbHVlLnN0eWxlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXdfMS5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gXCJjZW50ZXJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXdfMS52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVbdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcIm1pZGRsZVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXJCYXNlLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhY3Rpb25WaWV3c0NvdW50ID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbkl0ZW1zLmdldEl0ZW1zKCkuZm9yRWFjaChmdW5jdGlvbiAoYWN0aW9uSXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChhY3Rpb25JdGVtLmFjdGlvblZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uVmlld3NDb3VudCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvblZpZXdzQ291bnQgKyAodGhpcy50aXRsZVZpZXcgPyAxIDogMCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLl9vblRpdGxlUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiYWN0aW9uSXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25JdGVtcy5zZXRJdGVtcyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhckJhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRpdGxlVmlldyA9IHRoaXMudGl0bGVWaWV3O1xuICAgICAgICBpZiAodGl0bGVWaWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aXRsZVZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRpdGxlVmlldyA9IHRoaXMudGl0bGVWaWV3O1xuICAgICAgICBpZiAodGl0bGVWaWV3KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aXRsZVZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQnV0dG9uID0gdGhpcy5fbmF2aWdhdGlvbkJ1dHRvbjtcbiAgICAgICAgaWYgKG5hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKG5hdmlnYXRpb25CdXR0b24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb25JdGVtKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhhY3Rpb25JdGVtKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXJCYXNlLnByb3RvdHlwZS5faXNFbXB0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGl0bGUgfHxcbiAgICAgICAgICAgIHRoaXMudGl0bGVWaWV3IHx8XG4gICAgICAgICAgICAodGhpcy5hbmRyb2lkICYmIHRoaXMuYW5kcm9pZC5pY29uKSB8fFxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uQnV0dG9uIHx8XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkl0ZW1zLmdldEl0ZW1zKCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgQWN0aW9uQmFyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkFjdGlvbkJhclwiKVxuICAgIF0sIEFjdGlvbkJhckJhc2UpO1xuICAgIHJldHVybiBBY3Rpb25CYXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5BY3Rpb25CYXJCYXNlID0gQWN0aW9uQmFyQmFzZTtcbnZhciBBY3Rpb25JdGVtcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbXMoYWN0aW9uQmFyKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IGFjdGlvbkJhcjtcbiAgICB9XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmFkZEl0ZW0gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoIWl0ZW0pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBhZGQgZW1wdHkgaXRlbVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICBpdGVtLmFjdGlvbkJhciA9IHRoaXMuX2FjdGlvbkJhcjtcbiAgICAgICAgdGhpcy5fYWN0aW9uQmFyLl9hZGRWaWV3KGl0ZW0pO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1zLnByb3RvdHlwZS5yZW1vdmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcmVtb3ZlIGVtcHR5IGl0ZW1cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW1JbmRleCA9IHRoaXMuX2l0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgICAgIGlmIChpdGVtSW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBpdGVtIHRvIHJlbW92ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pdGVtcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fYWN0aW9uQmFyLl9yZW1vdmVWaWV3KGl0ZW0pO1xuICAgICAgICBpdGVtLmFjdGlvbkJhciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pdGVtcy5zbGljZSgpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmdldFZpc2libGVJdGVtcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpc2libGVJdGVtcyA9IFtdO1xuICAgICAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICBpZiAoaXNWaXNpYmxlKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgdmlzaWJsZUl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdmlzaWJsZUl0ZW1zO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLmdldEl0ZW1BdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuX2l0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXRlbXNbaW5kZXhdO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbXMucHJvdG90eXBlLnNldEl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLl9pdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUl0ZW0odGhpcy5faXRlbXNbdGhpcy5faXRlbXMubGVuZ3RoIC0gMV0pO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuYWRkSXRlbShpdGVtc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBBY3Rpb25JdGVtcy5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FjdGlvbkJhcikge1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aW9uSXRlbXM7XG59KCkpO1xuZXhwb3J0cy5BY3Rpb25JdGVtcyA9IEFjdGlvbkl0ZW1zO1xudmFyIEFjdGlvbkl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWN0aW9uSXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbUJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25WaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcuc3R5bGVbdmlld18xLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eS5jc3NOYW1lXSA9IHZpZXdfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25WaWV3LnN0eWxlW3ZpZXdfMS52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gdmlld18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fYWN0aW9uVmlldyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2FjdGlvblZpZXcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25JdGVtQmFzZS5wcm90b3R5cGUsIFwiYWN0aW9uQmFyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hY3Rpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uVmlldy5zdHlsZVt2aWV3XzEuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LmNzc05hbWVdID0gXCJjZW50ZXJcIjtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvblZpZXcuc3R5bGVbdmlld18xLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkuY3NzTmFtZV0gPSBcIm1pZGRsZVwiO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZS5fcmFpc2VUYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2VtaXQoQWN0aW9uSXRlbUJhc2UudGFwRXZlbnQpO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uVmlldyA9IHZhbHVlO1xuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLl9vblZpc2liaWxpdHlDaGFuZ2VkID0gZnVuY3Rpb24gKHZpc2liaWxpdHkpIHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkJhci51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uSXRlbUJhc2UucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICBpZiAodGhpcy5fYWN0aW9uVmlldykge1xuICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5fYWN0aW9uVmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkl0ZW1CYXNlLnRhcEV2ZW50ID0gXCJ0YXBcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEFjdGlvbkl0ZW1CYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICByZXR1cm4gQWN0aW9uSXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5BY3Rpb25JdGVtQmFzZSA9IEFjdGlvbkl0ZW1CYXNlO1xuZnVuY3Rpb24gaXNWaXNpYmxlKGl0ZW0pIHtcbiAgICByZXR1cm4gaXRlbS52aXNpYmlsaXR5ID09PSBcInZpc2libGVcIjtcbn1cbmV4cG9ydHMuaXNWaXNpYmxlID0gaXNWaXNpYmxlO1xuZnVuY3Rpb24gb25UaXRsZVByb3BlcnR5Q2hhbmdlZChhY3Rpb25CYXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGFjdGlvbkJhci5fb25UaXRsZVByb3BlcnR5Q2hhbmdlZCgpO1xufVxuZXhwb3J0cy50aXRsZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGl0bGVcIiwgdmFsdWVDaGFuZ2VkOiBvblRpdGxlUHJvcGVydHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy50aXRsZVByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkJhckJhc2UpO1xuZnVuY3Rpb24gb25JdGVtQ2hhbmdlZChpdGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpZiAoaXRlbS5hY3Rpb25CYXIpIHtcbiAgICAgICAgaXRlbS5hY3Rpb25CYXIudXBkYXRlKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gb25WaXNpYmlsaXR5Q2hhbmdlZChpdGVtLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpdGVtLl9vblZpc2liaWxpdHlDaGFuZ2VkKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIHRyYWNlTWlzc2luZ0ljb24oaWNvbikge1xuICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ291bGQgbm90IGxvYWQgYWN0aW9uIGJhciBpY29uOiBcIiArIGljb24sIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuRXJyb3IsIHZpZXdfMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbn1cbmV4cG9ydHMudHJhY2VNaXNzaW5nSWNvbiA9IHRyYWNlTWlzc2luZ0ljb247XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpb3NJY29uUmVuZGVyaW5nTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwiYWx3YXlzT3JpZ2luYWxcIiB9KTtcbmV4cG9ydHMuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eS5yZWdpc3RlcihBY3Rpb25CYXJCYXNlKTtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIHZhbHVlQ2hhbmdlZDogb25JdGVtQ2hhbmdlZCB9KTtcbmV4cG9ydHMudGV4dFByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkl0ZW1CYXNlKTtcbmV4cG9ydHMuaWNvblByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaWNvblwiLCB2YWx1ZUNoYW5nZWQ6IG9uSXRlbUNoYW5nZWQgfSk7XG5leHBvcnRzLmljb25Qcm9wZXJ0eS5yZWdpc3RlcihBY3Rpb25JdGVtQmFzZSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBcInZpc2libGVcIiwgdmFsdWVDaGFuZ2VkOiBvblZpc2liaWxpdHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIoQWN0aW9uSXRlbUJhc2UpO1xuZXhwb3J0cy5mbGF0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJmbGF0XCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuZmxhdFByb3BlcnR5LnJlZ2lzdGVyKEFjdGlvbkJhckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aW9uLWJhci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhY3Rpb25fYmFyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYWN0aW9uLWJhci1jb21tb25cIik7XG52YXIgaW1hZ2Vfc291cmNlXzEgPSByZXF1aXJlKFwiLi4vLi4vaW1hZ2Utc291cmNlXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hY3Rpb24tYmFyLWNvbW1vblwiKSk7XG52YXIgbWFqb3JWZXJzaW9uID0gdXRpbHNfMS5pb3MuTWFqb3JWZXJzaW9uO1xudmFyIFVOU1BFQ0lGSUVEID0gYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKDAsIGFjdGlvbl9iYXJfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEKTtcbmZ1bmN0aW9uIGxvYWRBY3Rpb25JY29uRnJvbUZpbGVPclJlc291cmNlKGljb24pIHtcbiAgICB2YXIgaW1nID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGljb24pO1xuICAgIGlmIChpbWcgJiYgaW1nLmlvcykge1xuICAgICAgICByZXR1cm4gaW1nLmlvcztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGFjdGlvbl9iYXJfY29tbW9uXzEudHJhY2VNaXNzaW5nSWNvbihpY29uKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxudmFyIFRhcEJhckl0ZW1IYW5kbGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhcEJhckl0ZW1IYW5kbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYXBCYXJJdGVtSGFuZGxlckltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFwQmFySXRlbUhhbmRsZXJJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBUYXBCYXJJdGVtSGFuZGxlckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVGFwQmFySXRlbUhhbmRsZXJJbXBsLnByb3RvdHlwZS50YXAgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5fcmFpc2VUYXAoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFwQmFySXRlbUhhbmRsZXJJbXBsLk9iakNFeHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgICAgXCJ0YXBcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW2ludGVyb3AudHlwZXMuaWRdIH1cbiAgICB9O1xuICAgIHJldHVybiBUYXBCYXJJdGVtSGFuZGxlckltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgQWN0aW9uSXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGlvbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uSXRlbSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pb3MgPSB7XG4gICAgICAgICAgICBwb3NpdGlvbjogXCJsZWZ0XCIsXG4gICAgICAgICAgICBzeXN0ZW1JY29uOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uSXRlbS5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW9zO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWN0aW9uSXRlbS5pb3MgaXMgcmVhZC1vbmx5XCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gQWN0aW9uSXRlbTtcbn0oYWN0aW9uX2Jhcl9jb21tb25fMS5BY3Rpb25JdGVtQmFzZSkpO1xuZXhwb3J0cy5BY3Rpb25JdGVtID0gQWN0aW9uSXRlbTtcbnZhciBOYXZpZ2F0aW9uQnV0dG9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTmF2aWdhdGlvbkJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOYXZpZ2F0aW9uQnV0dG9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE5hdmlnYXRpb25CdXR0b24ucHJvdG90eXBlLl9vblZpc2liaWxpdHlDaGFuZ2VkID0gZnVuY3Rpb24gKHZpc2liaWxpdHkpIHtcbiAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25JdGVtKSB7XG4gICAgICAgICAgICB2YXIgdmlzaWJsZSA9IHZpc2liaWxpdHkgPT09IFwidmlzaWJsZVwiO1xuICAgICAgICAgICAgdGhpcy5fbmF2aWdhdGlvbkl0ZW0uc2V0SGlkZXNCYWNrQnV0dG9uQW5pbWF0ZWQoIXZpc2libGUsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gTmF2aWdhdGlvbkJ1dHRvbjtcbn0oQWN0aW9uSXRlbSkpO1xuZXhwb3J0cy5OYXZpZ2F0aW9uQnV0dG9uID0gTmF2aWdhdGlvbkJ1dHRvbjtcbnZhciBBY3Rpb25CYXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBY3Rpb25CYXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWN0aW9uQmFyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLnBhZ2U7XG4gICAgICAgICAgICBpZiAoIXBhZ2UgfHwgIXBhZ2UucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZpZXdDb250cm9sbGVyID0gcGFnZS5pb3M7XG4gICAgICAgICAgICBpZiAodmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkNvbnRyb2xsZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkNvbnRyb2xsZXIubmF2aWdhdGlvbkJhcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlvcztcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTmF2aWdhdGlvbkJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uQnV0dG9uID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBY3Rpb25JdGVtKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbkl0ZW1zLmFkZEl0ZW0odmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgYWN0aW9uX2Jhcl9jb21tb25fMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlVmlldyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWN0aW9uQmFyLnByb3RvdHlwZSwgXCJfZ2V0QWN0dWFsU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG5hdkJhciA9IHRoaXMuaW9zO1xuICAgICAgICAgICAgaWYgKCFuYXZCYXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB3aWR0aDogMCwgaGVpZ2h0OiAwIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBuYXZCYXIuZnJhbWU7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IGZyYW1lLnNpemU7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBhY3Rpb25fYmFyX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzaXplLndpZHRoKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBhY3Rpb25fYmFyX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzaXplLmhlaWdodCk7XG4gICAgICAgICAgICByZXR1cm4geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUubGF5b3V0SW50ZXJuYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYSA9IHRoaXMuX2dldEFjdHVhbFNpemUsIHdpZHRoID0gX2Eud2lkdGgsIGhlaWdodCA9IF9hLmhlaWdodDtcbiAgICAgICAgdmFyIHdpZHRoU3BlYyA9IGFjdGlvbl9iYXJfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyh3aWR0aCwgYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHZhciBoZWlnaHRTcGVjID0gYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKGhlaWdodCwgYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHRoaXMubWVhc3VyZSh3aWR0aFNwZWMsIGhlaWdodFNwZWMpO1xuICAgICAgICB0aGlzLmxheW91dCgwLCAwLCB3aWR0aCwgaGVpZ2h0LCBmYWxzZSk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLl9nZXRJY29uUmVuZGVyaW5nTW9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLmlvc0ljb25SZW5kZXJpbmdNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIFwiYWx3YXlzT3JpZ2luYWxcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgXCJhbHdheXNUZW1wbGF0ZVwiOlxuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSBcImF1dG9tYXRpY1wiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICBpZiAoIXBhZ2UgfHwgIXBhZ2UuZnJhbWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXIgPSBwYWdlLmlvcztcbiAgICAgICAgdmFyIG5hdmlnYXRpb25JdGVtID0gdmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkl0ZW07XG4gICAgICAgIHZhciBuYXZDb250cm9sbGVyID0gdmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkNvbnRyb2xsZXI7XG4gICAgICAgIGlmICghbmF2Q29udHJvbGxlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQmFyID0gbmF2Q29udHJvbGxlci5uYXZpZ2F0aW9uQmFyO1xuICAgICAgICB2YXIgcHJldmlvdXNDb250cm9sbGVyO1xuICAgICAgICBuYXZpZ2F0aW9uSXRlbS50aXRsZSA9IHRoaXMudGl0bGU7XG4gICAgICAgIHZhciB0aXRsZVZpZXcgPSB0aGlzLnRpdGxlVmlldztcbiAgICAgICAgaWYgKHRpdGxlVmlldyAmJiB0aXRsZVZpZXcuaW9zKSB7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uSXRlbS50aXRsZVZpZXcgPSB0aXRsZVZpZXcuaW9zO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF2aWdhdGlvbkl0ZW0udGl0bGVWaWV3ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXhPZlZpZXdDb250cm9sbGVyID0gbmF2Q29udHJvbGxlci52aWV3Q29udHJvbGxlcnMuaW5kZXhPZk9iamVjdCh2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIGlmIChpbmRleE9mVmlld0NvbnRyb2xsZXIgPiAwICYmIGluZGV4T2ZWaWV3Q29udHJvbGxlciA8IG5hdkNvbnRyb2xsZXIudmlld0NvbnRyb2xsZXJzLmNvdW50KSB7XG4gICAgICAgICAgICBwcmV2aW91c0NvbnRyb2xsZXIgPSBuYXZDb250cm9sbGVyLnZpZXdDb250cm9sbGVyc1tpbmRleE9mVmlld0NvbnRyb2xsZXIgLSAxXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJldmlvdXNDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXZpZ2F0aW9uQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhcEhhbmRsZXIgPSBUYXBCYXJJdGVtSGFuZGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzLm5hdmlnYXRpb25CdXR0b24pKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFyQnV0dG9uSXRlbSA9IFVJQmFyQnV0dG9uSXRlbS5hbGxvYygpLmluaXRXaXRoVGl0bGVTdHlsZVRhcmdldEFjdGlvbih0aGlzLm5hdmlnYXRpb25CdXR0b24udGV4dCArIFwiXCIsIDAsIHRhcEhhbmRsZXIsIFwidGFwXCIpO1xuICAgICAgICAgICAgICAgIHByZXZpb3VzQ29udHJvbGxlci5uYXZpZ2F0aW9uSXRlbS5iYWNrQmFyQnV0dG9uSXRlbSA9IGJhckJ1dHRvbkl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c0NvbnRyb2xsZXIubmF2aWdhdGlvbkl0ZW0uYmFja0JhckJ1dHRvbkl0ZW0gPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBpbWc7XG4gICAgICAgIGlmICh0aGlzLm5hdmlnYXRpb25CdXR0b24gJiYgYWN0aW9uX2Jhcl9jb21tb25fMS5pc1Zpc2libGUodGhpcy5uYXZpZ2F0aW9uQnV0dG9uKSAmJiB0aGlzLm5hdmlnYXRpb25CdXR0b24uaWNvbikge1xuICAgICAgICAgICAgaW1nID0gbG9hZEFjdGlvbkljb25Gcm9tRmlsZU9yUmVzb3VyY2UodGhpcy5uYXZpZ2F0aW9uQnV0dG9uLmljb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbWcpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IGltZy5pbWFnZVdpdGhSZW5kZXJpbmdNb2RlKDEpO1xuICAgICAgICAgICAgbmF2aWdhdGlvbkJhci5iYWNrSW5kaWNhdG9ySW1hZ2UgPSBpbWFnZTtcbiAgICAgICAgICAgIG5hdmlnYXRpb25CYXIuYmFja0luZGljYXRvclRyYW5zaXRpb25NYXNrSW1hZ2UgPSBpbWFnZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdmlnYXRpb25CYXIuYmFja0luZGljYXRvckltYWdlID0gbnVsbDtcbiAgICAgICAgICAgIG5hdmlnYXRpb25CYXIuYmFja0luZGljYXRvclRyYW5zaXRpb25NYXNrSW1hZ2UgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5hdmlnYXRpb25CdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGlvbkJ1dHRvbi5fbmF2aWdhdGlvbkl0ZW0gPSBuYXZpZ2F0aW9uSXRlbTtcbiAgICAgICAgICAgIG5hdmlnYXRpb25JdGVtLnNldEhpZGVzQmFja0J1dHRvbkFuaW1hdGVkKCFhY3Rpb25fYmFyX2NvbW1vbl8xLmlzVmlzaWJsZSh0aGlzLm5hdmlnYXRpb25CdXR0b24pLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wb3B1bGF0ZU1lbnVJdGVtcyhuYXZpZ2F0aW9uSXRlbSk7XG4gICAgICAgIHRoaXMudXBkYXRlQ29sb3JzKG5hdmlnYXRpb25CYXIpO1xuICAgICAgICB0aGlzLnVwZGF0ZUZsYXRuZXNzKG5hdmlnYXRpb25CYXIpO1xuICAgICAgICBpZiAoIXRoaXMuaXNMYXlvdXRWYWxpZCkge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRJbnRlcm5hbCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLnBvcHVsYXRlTWVudUl0ZW1zID0gZnVuY3Rpb24gKG5hdmlnYXRpb25JdGVtKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuYWN0aW9uSXRlbXMuZ2V0VmlzaWJsZUl0ZW1zKCk7XG4gICAgICAgIHZhciBsZWZ0QmFySXRlbXMgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0QmFySXRlbXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGJhckJ1dHRvbkl0ZW0gPSB0aGlzLmNyZWF0ZUJhckJ1dHRvbkl0ZW0oaXRlbXNbaV0pO1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2ldLmlvcy5wb3NpdGlvbiA9PT0gXCJsZWZ0XCIpIHtcbiAgICAgICAgICAgICAgICBsZWZ0QmFySXRlbXMucHVzaChiYXJCdXR0b25JdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0QmFySXRlbXMuc3BsaWNlKDAsIDAsIGJhckJ1dHRvbkl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG5hdmlnYXRpb25JdGVtLnNldExlZnRCYXJCdXR0b25JdGVtc0FuaW1hdGVkKGxlZnRCYXJJdGVtcywgZmFsc2UpO1xuICAgICAgICBuYXZpZ2F0aW9uSXRlbS5zZXRSaWdodEJhckJ1dHRvbkl0ZW1zQW5pbWF0ZWQocmlnaHRCYXJJdGVtcywgZmFsc2UpO1xuICAgICAgICBpZiAobGVmdEJhckl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG5hdmlnYXRpb25JdGVtLmxlZnRJdGVtc1N1cHBsZW1lbnRCYWNrQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5jcmVhdGVCYXJCdXR0b25JdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIHRhcEhhbmRsZXIgPSBUYXBCYXJJdGVtSGFuZGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZihpdGVtKSk7XG4gICAgICAgIGl0ZW0uaGFuZGxlciA9IHRhcEhhbmRsZXI7XG4gICAgICAgIHZhciBiYXJCdXR0b25JdGVtO1xuICAgICAgICBpZiAoaXRlbS5hY3Rpb25WaWV3ICYmIGl0ZW0uYWN0aW9uVmlldy5pb3MpIHtcbiAgICAgICAgICAgIHZhciByZWNvZ25pemVyID0gVUlUYXBHZXN0dXJlUmVjb2duaXplci5hbGxvYygpLmluaXRXaXRoVGFyZ2V0QWN0aW9uKHRhcEhhbmRsZXIsIFwidGFwXCIpO1xuICAgICAgICAgICAgaXRlbS5hY3Rpb25WaWV3Lmlvcy5hZGRHZXN0dXJlUmVjb2duaXplcihyZWNvZ25pemVyKTtcbiAgICAgICAgICAgIGJhckJ1dHRvbkl0ZW0gPSBVSUJhckJ1dHRvbkl0ZW0uYWxsb2MoKS5pbml0V2l0aEN1c3RvbVZpZXcoaXRlbS5hY3Rpb25WaWV3Lmlvcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXRlbS5pb3Muc3lzdGVtSWNvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaWQgPSBpdGVtLmlvcy5zeXN0ZW1JY29uO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIGlkID0gcGFyc2VJbnQoaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmFyQnV0dG9uSXRlbSA9IFVJQmFyQnV0dG9uSXRlbS5hbGxvYygpLmluaXRXaXRoQmFyQnV0dG9uU3lzdGVtSXRlbVRhcmdldEFjdGlvbihpZCwgdGFwSGFuZGxlciwgXCJ0YXBcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXRlbS5pY29uKSB7XG4gICAgICAgICAgICB2YXIgaW1nID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh1dGlsc18xLmlzRm9udEljb25VUkkoaXRlbS5pY29uKSkge1xuICAgICAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSBpdGVtLmljb24uc3BsaXQoXCIvL1wiKVsxXTtcbiAgICAgICAgICAgICAgICB2YXIgZm9udCA9IGl0ZW0uc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IGl0ZW0uc3R5bGUuY29sb3I7XG4gICAgICAgICAgICAgICAgdmFyIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICBpZiAoaXMgJiYgaXMuaW9zKSB7XG4gICAgICAgICAgICAgICAgICAgIGltZyA9IGlzLmlvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbl9iYXJfY29tbW9uXzEudHJhY2VNaXNzaW5nSWNvbihpdGVtLmljb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGltZyA9IGxvYWRBY3Rpb25JY29uRnJvbUZpbGVPclJlc291cmNlKGl0ZW0uaWNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSBpbWcuaW1hZ2VXaXRoUmVuZGVyaW5nTW9kZSh0aGlzLl9nZXRJY29uUmVuZGVyaW5nTW9kZSgpKTtcbiAgICAgICAgICAgIGJhckJ1dHRvbkl0ZW0gPSBVSUJhckJ1dHRvbkl0ZW0uYWxsb2MoKS5pbml0V2l0aEltYWdlU3R5bGVUYXJnZXRBY3Rpb24oaW1hZ2UsIDAsIHRhcEhhbmRsZXIsIFwidGFwXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmFyQnV0dG9uSXRlbSA9IFVJQmFyQnV0dG9uSXRlbS5hbGxvYygpLmluaXRXaXRoVGl0bGVTdHlsZVRhcmdldEFjdGlvbihpdGVtLnRleHQgKyBcIlwiLCAwLCB0YXBIYW5kbGVyLCBcInRhcFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS50ZXh0KSB7XG4gICAgICAgICAgICBiYXJCdXR0b25JdGVtLmlzQWNjZXNzaWJpbGl0eUVsZW1lbnQgPSB0cnVlO1xuICAgICAgICAgICAgYmFyQnV0dG9uSXRlbS5hY2Nlc3NpYmlsaXR5TGFiZWwgPSBpdGVtLnRleHQ7XG4gICAgICAgICAgICBiYXJCdXR0b25JdGVtLmFjY2Vzc2liaWxpdHlUcmFpdHMgPSBVSUFjY2Vzc2liaWxpdHlUcmFpdEJ1dHRvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmFyQnV0dG9uSXRlbTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUudXBkYXRlQ29sb3JzID0gZnVuY3Rpb24gKG5hdkJhcikge1xuICAgICAgICB2YXIgY29sb3IgPSB0aGlzLmNvbG9yO1xuICAgICAgICB0aGlzLnNldENvbG9yKG5hdkJhciwgY29sb3IpO1xuICAgICAgICB2YXIgYmdDb2xvciA9IHRoaXMuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICBuYXZCYXIuYmFyVGludENvbG9yID0gYmdDb2xvciA/IGJnQ29sb3IuaW9zIDogbnVsbDtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuc2V0Q29sb3IgPSBmdW5jdGlvbiAobmF2QmFyLCBjb2xvcikge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIG5hdkJhci50aXRsZVRleHRBdHRyaWJ1dGVzID0gKF9hID0ge30sIF9hW05TRm9yZWdyb3VuZENvbG9yQXR0cmlidXRlTmFtZV0gPSBjb2xvci5pb3MsIF9hKTtcbiAgICAgICAgICAgIG5hdkJhci5sYXJnZVRpdGxlVGV4dEF0dHJpYnV0ZXMgPSAoX2IgPSB7fSwgX2JbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGNvbG9yLmlvcywgX2IpO1xuICAgICAgICAgICAgbmF2QmFyLnRpbnRDb2xvciA9IGNvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdkJhci50aXRsZVRleHRBdHRyaWJ1dGVzID0gbnVsbDtcbiAgICAgICAgICAgIG5hdkJhci5sYXJnZVRpdGxlVGV4dEF0dHJpYnV0ZXMgPSBudWxsO1xuICAgICAgICAgICAgbmF2QmFyLnRpbnRDb2xvciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUuX29uVGl0bGVQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICBpZiAoIXBhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFnZS5mcmFtZSkge1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5fdXBkYXRlQWN0aW9uQmFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25JdGVtID0gcGFnZS5pb3MubmF2aWdhdGlvbkl0ZW07XG4gICAgICAgIG5hdmlnYXRpb25JdGVtLnRpdGxlID0gdGhpcy50aXRsZTtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGUudXBkYXRlRmxhdG5lc3MgPSBmdW5jdGlvbiAobmF2QmFyKSB7XG4gICAgICAgIGlmICh0aGlzLmZsYXQpIHtcbiAgICAgICAgICAgIG5hdkJhci5zZXRCYWNrZ3JvdW5kSW1hZ2VGb3JCYXJNZXRyaWNzKFVJSW1hZ2UubmV3KCksIDApO1xuICAgICAgICAgICAgbmF2QmFyLnNoYWRvd0ltYWdlID0gVUlJbWFnZS5uZXcoKTtcbiAgICAgICAgICAgIG5hdkJhci50cmFuc2x1Y2VudCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF2QmFyLnNldEJhY2tncm91bmRJbWFnZUZvckJhck1ldHJpY3MobnVsbCwgbnVsbCk7XG4gICAgICAgICAgICBuYXZCYXIuc2hhZG93SW1hZ2UgPSBudWxsO1xuICAgICAgICAgICAgbmF2QmFyLnRyYW5zbHVjZW50ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHdpZHRoID0gYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gYWN0aW9uX2Jhcl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgaWYgKHRoaXMudGl0bGVWaWV3KSB7XG4gICAgICAgICAgICBhY3Rpb25fYmFyX2NvbW1vbl8xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMsIHRoaXMudGl0bGVWaWV3LCBVTlNQRUNJRklFRCwgVU5TUEVDSUZJRUQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aW9uSXRlbXMuZ2V0SXRlbXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb25JdGVtKSB7XG4gICAgICAgICAgICB2YXIgYWN0aW9uVmlldyA9IGFjdGlvbkl0ZW0uYWN0aW9uVmlldztcbiAgICAgICAgICAgIGlmIChhY3Rpb25WaWV3KSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uX2Jhcl9jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZChfdGhpcywgYWN0aW9uVmlldywgVU5TUEVDSUZJRUQsIFVOU1BFQ0lGSUVEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGgsIGhlaWdodCk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdGl0bGVWaWV3ID0gdGhpcy50aXRsZVZpZXc7XG4gICAgICAgIGlmICh0aXRsZVZpZXcpIHtcbiAgICAgICAgICAgIGlmIChtYWpvclZlcnNpb24gPiAxMCkge1xuICAgICAgICAgICAgICAgIGFjdGlvbl9iYXJfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aXRsZVZpZXcsIDAsIDAsIHRpdGxlVmlldy5nZXRNZWFzdXJlZFdpZHRoKCksIHRpdGxlVmlldy5nZXRNZWFzdXJlZEhlaWdodCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFjdGlvbl9iYXJfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aXRsZVZpZXcsIDAsIDAsIHJpZ2h0IC0gbGVmdCwgYm90dG9tIC0gdG9wKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGlvbkl0ZW1zLmdldEl0ZW1zKCkuZm9yRWFjaChmdW5jdGlvbiAoYWN0aW9uSXRlbSkge1xuICAgICAgICAgICAgdmFyIGFjdGlvblZpZXcgPSBhY3Rpb25JdGVtLmFjdGlvblZpZXc7XG4gICAgICAgICAgICBpZiAoYWN0aW9uVmlldyAmJiBhY3Rpb25WaWV3Lmlvcykge1xuICAgICAgICAgICAgICAgIHZhciBtZWFzdXJlZFdpZHRoID0gYWN0aW9uVmlldy5nZXRNZWFzdXJlZFdpZHRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1lYXN1cmVkSGVpZ2h0ID0gYWN0aW9uVmlldy5nZXRNZWFzdXJlZEhlaWdodCgpO1xuICAgICAgICAgICAgICAgIGFjdGlvbl9iYXJfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZChfdGhpcywgYWN0aW9uVmlldywgMCwgMCwgbWVhc3VyZWRXaWR0aCwgbWVhc3VyZWRIZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlLmxheW91dE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpb25CYXIucHJvdG90eXBlLCBcIm5hdkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLnBhZ2U7XG4gICAgICAgICAgICBpZiAoIXBhZ2UgfHwgIXBhZ2UuZnJhbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhZ2UuZnJhbWUuaW9zLmNvbnRyb2xsZXIubmF2aWdhdGlvbkJhcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICB2YXIgbmF2QmFyID0gdGhpcy5uYXZCYXI7XG4gICAgICAgIHRoaXMuc2V0Q29sb3IobmF2QmFyLCBjb2xvcik7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlW2FjdGlvbl9iYXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdkJhciA9IHRoaXMubmF2QmFyO1xuICAgICAgICBpZiAobmF2QmFyKSB7XG4gICAgICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGFjdGlvbl9iYXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgICAgIG5hdkJhci5iYXJUaW50Q29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGVbYWN0aW9uX2Jhcl9jb21tb25fMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBBY3Rpb25CYXIucHJvdG90eXBlW2FjdGlvbl9iYXJfY29tbW9uXzEuZmxhdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdkJhciA9IHRoaXMubmF2QmFyO1xuICAgICAgICBpZiAobmF2QmFyKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUZsYXRuZXNzKG5hdkJhcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGlvbkJhci5wcm90b3R5cGVbYWN0aW9uX2Jhcl9jb21tb25fMS5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJhbHdheXNPcmlnaW5hbFwiO1xuICAgIH07XG4gICAgQWN0aW9uQmFyLnByb3RvdHlwZVthY3Rpb25fYmFyX2NvbW1vbl8xLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgIH07XG4gICAgcmV0dXJuIEFjdGlvbkJhcjtcbn0oYWN0aW9uX2Jhcl9jb21tb25fMS5BY3Rpb25CYXJCYXNlKSk7XG5leHBvcnRzLkFjdGlvbkJhciA9IEFjdGlvbkJhcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjdGlvbi1iYXIuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIEFjdGl2aXR5SW5kaWNhdG9yQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGl2aXR5SW5kaWNhdG9yQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBY3Rpdml0eUluZGljYXRvckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWN0aXZpdHlJbmRpY2F0b3JCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiQWN0aXZpdHlJbmRpY2F0b3JcIilcbiAgICBdLCBBY3Rpdml0eUluZGljYXRvckJhc2UpO1xuICAgIHJldHVybiBBY3Rpdml0eUluZGljYXRvckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLkFjdGl2aXR5SW5kaWNhdG9yQmFzZSA9IEFjdGl2aXR5SW5kaWNhdG9yQmFzZTtcbkFjdGl2aXR5SW5kaWNhdG9yQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuYnVzeVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYnVzeVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmJ1c3lQcm9wZXJ0eS5yZWdpc3RlcihBY3Rpdml0eUluZGljYXRvckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWN0aXZpdHktaW5kaWNhdG9yLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2FjdGl2aXR5LWluZGljYXRvci1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hY3Rpdml0eS1pbmRpY2F0b3ItY29tbW9uXCIpKTtcbnZhciBBY3Rpdml0eUluZGljYXRvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFjdGl2aXR5SW5kaWNhdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFjdGl2aXR5SW5kaWNhdG9yKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IFVJQWN0aXZpdHlJbmRpY2F0b3JWaWV3LmFsbG9jKCkuaW5pdFdpdGhBY3Rpdml0eUluZGljYXRvclN0eWxlKDIpO1xuICAgICAgICB2aWV3LmhpZGVzV2hlblN0b3BwZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBY3Rpdml0eUluZGljYXRvci5wcm90b3R5cGVbYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLmJ1c3lQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pc0FuaW1hdGluZykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pc0FuaW1hdGluZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hbmltYXRpbmc7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuYnVzeVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zdGFydEFuaW1hdGluZygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zdG9wQW5pbWF0aW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcuaGlkZXNXaGVuU3RvcHBlZCkge1xuICAgICAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb2xvcjtcbiAgICB9O1xuICAgIEFjdGl2aXR5SW5kaWNhdG9yLnByb3RvdHlwZVthY3Rpdml0eV9pbmRpY2F0b3JfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgYWN0aXZpdHlfaW5kaWNhdG9yX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aXZpdHlJbmRpY2F0b3I7XG59KGFjdGl2aXR5X2luZGljYXRvcl9jb21tb25fMS5BY3Rpdml0eUluZGljYXRvckJhc2UpKTtcbmV4cG9ydHMuQWN0aXZpdHlJbmRpY2F0b3IgPSBBY3Rpdml0eUluZGljYXRvcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjdGl2aXR5LWluZGljYXRvci5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG5leHBvcnRzLkNvbG9yID0gY29sb3JfMS5Db2xvcjtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xuZXhwb3J0cy50cmFjZUVuYWJsZWQgPSB0cmFjZV8xLmlzRW5hYmxlZDtcbmV4cG9ydHMudHJhY2VXcml0ZSA9IHRyYWNlXzEud3JpdGU7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcmllcyA9IHRyYWNlXzEuY2F0ZWdvcmllcztcbmV4cG9ydHMudHJhY2VUeXBlID0gdHJhY2VfMS5tZXNzYWdlVHlwZTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIFByb3BlcnRpZXM7XG4oZnVuY3Rpb24gKFByb3BlcnRpZXMpIHtcbiAgICBQcm9wZXJ0aWVzLm9wYWNpdHkgPSBcIm9wYWNpdHlcIjtcbiAgICBQcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvciA9IFwiYmFja2dyb3VuZENvbG9yXCI7XG4gICAgUHJvcGVydGllcy50cmFuc2xhdGUgPSBcInRyYW5zbGF0ZVwiO1xuICAgIFByb3BlcnRpZXMucm90YXRlID0gXCJyb3RhdGVcIjtcbiAgICBQcm9wZXJ0aWVzLnNjYWxlID0gXCJzY2FsZVwiO1xuICAgIFByb3BlcnRpZXMuaGVpZ2h0ID0gXCJoZWlnaHRcIjtcbiAgICBQcm9wZXJ0aWVzLndpZHRoID0gXCJ3aWR0aFwiO1xufSkoUHJvcGVydGllcyA9IGV4cG9ydHMuUHJvcGVydGllcyB8fCAoZXhwb3J0cy5Qcm9wZXJ0aWVzID0ge30pKTtcbnZhciBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgIHRoaXMueDEgPSB4MTtcbiAgICAgICAgdGhpcy55MSA9IHkxO1xuICAgICAgICB0aGlzLngyID0geDI7XG4gICAgICAgIHRoaXMueTIgPSB5MjtcbiAgICB9XG4gICAgcmV0dXJuIEN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmU7XG59KCkpO1xuZXhwb3J0cy5DdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZTtcbnZhciBBbmltYXRpb25CYXNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25CYXNlKGFuaW1hdGlvbkRlZmluaXRpb25zLCBwbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgIGlmICghYW5pbWF0aW9uRGVmaW5pdGlvbnMgfHwgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhbmltYXRpb24gZGVmaW5pdGlvbnMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQW5hbHl6aW5nIFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoICsgXCIgYW5pbWF0aW9uIGRlZmluaXRpb25zLi4uXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBhbmltYXRpb25EZWZpbml0aW9ucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbnNbaV0uY3VydmUpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSA9IHRoaXMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMgPSB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMuY29uY2F0KEFuaW1hdGlvbkJhc2UuX2NyZWF0ZVByb3BlcnR5QW5pbWF0aW9ucyhhbmltYXRpb25EZWZpbml0aW9uc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3RoaW5nIHRvIGFuaW1hdGUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ3JlYXRlZCBcIiArIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGggKyBcIiBpbmRpdmlkdWFsIHByb3BlcnR5IGFuaW1hdGlvbnMuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BsYXlTZXF1ZW50aWFsbHkgPSBwbGF5U2VxdWVudGlhbGx5O1xuICAgIH1cbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVqZWN0QWxyZWFkeVBsYXlpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZWFzb24gPSBcIkFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCI7XG4gICAgICAgIHRyYWNlXzEud3JpdGUocmVhc29uLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXNfMS5fcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICBfdGhpc18xLl9yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmZpeHVwQW5pbWF0aW9uUHJvbWlzZShhbmltYXRpb25GaW5pc2hlZFByb21pc2UpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUuZml4dXBBbmltYXRpb25Qcm9taXNlID0gZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcHJvbWlzZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF90aGVuID0gcHJvbWlzZS50aGVuO1xuICAgICAgICBwcm9taXNlLnRoZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF90aGVuLmFwcGx5KHByb21pc2UsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBfdGhpcy5maXh1cEFuaW1hdGlvblByb21pc2Uocik7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9jYXRjaCA9IHByb21pc2UuY2F0Y2g7XG4gICAgICAgIHByb21pc2UuY2F0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF9jYXRjaC5hcHBseShwcm9taXNlLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgX3RoaXMuZml4dXBBbmltYXRpb25Qcm9taXNlKHIpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUsIFwiaXNQbGF5aW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNQbGF5aW5nO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLl9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWplY3QobmV3IEVycm9yKFwiQW5pbWF0aW9uIGNhbmNlbGxlZC5cIikpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5fY3JlYXRlUHJvcGVydHlBbmltYXRpb25zID0gZnVuY3Rpb24gKGFuaW1hdGlvbkRlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKCFhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYW5pbWF0aW9uIHRhcmdldCBzcGVjaWZpZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGl0ZW0gaW4gYW5pbWF0aW9uRGVmaW5pdGlvbikge1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLm9wYWNpdHkgfHxcbiAgICAgICAgICAgICAgICBpdGVtID09PSBQcm9wZXJ0aWVzLnJvdGF0ZSB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZHVyYXRpb25cIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZGVsYXlcIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiaXRlcmF0aW9uc1wiKSAmJiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgaXRlbSArIFwiIG11c3QgYmUgdmFsaWQgbnVtYmVyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLnNjYWxlIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMudHJhbnNsYXRlKSAmJlxuICAgICAgICAgICAgICAgICh0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXS54ICE9PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dLnkgIT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBQYWlyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT09IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yICYmICFjb2xvcl8xLkNvbG9yLmlzVmFsaWQoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBjb2xvci4gVmFsdWU6IFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpdGVtID09PSBQcm9wZXJ0aWVzLndpZHRoIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnBhcnNlKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9wZXJ0eUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ub3BhY2l0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5vcGFjaXR5LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLm9wYWNpdHksXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgPT09IFwic3RyaW5nXCIgP1xuICAgICAgICAgICAgICAgICAgICBuZXcgY29sb3JfMS5Db2xvcihhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcikgOiBhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLnRyYW5zbGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy50cmFuc2xhdGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24udHJhbnNsYXRlLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuc2NhbGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5yb3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMucm90YXRlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLnJvdGF0ZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMud2lkdGgsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGgsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8ga25vd24gYW5pbWF0aW9uIHByb3BlcnRpZXMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eUFuaW1hdGlvbnM7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLl9nZXRBbmltYXRpb25JbmZvID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb24udGFyZ2V0LmlkLFxuICAgICAgICAgICAgcHJvcGVydHk6IGFuaW1hdGlvbi5wcm9wZXJ0eSxcbiAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb24udmFsdWUsXG4gICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbi5kZWxheSxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbi5jdXJ2ZVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBBbmltYXRpb25CYXNlO1xufSgpKTtcbmV4cG9ydHMuQW5pbWF0aW9uQmFzZSA9IEFuaW1hdGlvbkJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmltYXRpb24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYW5pbWF0aW9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYW5pbWF0aW9uLWNvbW1vblwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hbmltYXRpb24tY29tbW9uXCIpKTtcbnZhciBfdHJhbnNmb3JtID0gXCJfdHJhbnNmb3JtXCI7XG52YXIgX3NraXAgPSBcIl9za2lwXCI7XG52YXIgRkxUX01BWCA9IDM0MDI4MjM0NjYzODUyODg1OTgxMTcwNDE4MzQ4NDUxNjkyNTQ0MC4wMDAwMDA7XG52YXIgQW5pbWF0aW9uSW5mbyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQW5pbWF0aW9uSW5mbygpIHtcbiAgICB9XG4gICAgcmV0dXJuIEFuaW1hdGlvbkluZm87XG59KCkpO1xudmFyIEFuaW1hdGlvbkRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFuaW1hdGlvbkRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25EZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQW5pbWF0aW9uRGVsZWdhdGVJbXBsLmluaXRXaXRoRmluaXNoZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChmaW5pc2hlZENhbGxiYWNrLCBwcm9wZXJ0eUFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gQW5pbWF0aW9uRGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBkZWxlZ2F0ZS5fZmluaXNoZWRDYWxsYmFjayA9IGZpbmlzaGVkQ2FsbGJhY2s7XG4gICAgICAgIGRlbGVnYXRlLl9wcm9wZXJ0eUFuaW1hdGlvbiA9IHByb3BlcnR5QW5pbWF0aW9uO1xuICAgICAgICBkZWxlZ2F0ZS5fdmFsdWVTb3VyY2UgPSB2YWx1ZVNvdXJjZTtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5hbmltYXRpb25EaWRTdGFydCA9IGZ1bmN0aW9uIChhbmltKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICB2YXIgc2V0TG9jYWwgPSB0aGlzLl92YWx1ZVNvdXJjZSA9PT0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgdmFyIHRhcmdldFN0eWxlID0gdGhpcy5fcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuX3N1c3BlbmRQcmVzZW50YXRpb25MYXllclVwZGF0ZXMoKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3I6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMub3BhY2l0eTpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZTpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGU6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLng7XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmhlaWdodDpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLmhlaWdodFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy53aWR0aDpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGU6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS54ID09PSAwID8gMC4wMDEgOiB2YWx1ZS54O1xuICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWUueSA9PT0gMCA/IDAuMDAxIDogdmFsdWUueTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgX3RyYW5zZm9ybTpcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLng7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS54O1xuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS55O1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHggPT09IDAgPyAwLjAwMSA6IHg7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0geSA9PT0gMCA/IDAuMDAxIDogeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcHJvcGVydHlBbmltYXRpb24udGFyZ2V0Ll9yZXN1bWVQcmVzZW50YXRpb25MYXllclVwZGF0ZXMoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkRlbGVnYXRlSW1wbC5wcm90b3R5cGUuYW5pbWF0aW9uRGlkU3RvcEZpbmlzaGVkID0gZnVuY3Rpb24gKGFuaW0sIGZpbmlzaGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hlZENhbGxiYWNrKCFmaW5pc2hlZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbmlzaGVkICYmIHRoaXMubmV4dEFuaW1hdGlvbikge1xuICAgICAgICAgICAgdGhpcy5uZXh0QW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbkRlbGVnYXRlSW1wbC5PYmpDUHJvdG9jb2xzID0gZ2xvYmFsLkNBQW5pbWF0aW9uRGVsZWdhdGUgPyBbZ2xvYmFsLkNBQW5pbWF0aW9uRGVsZWdhdGVdIDogW107XG4gICAgcmV0dXJuIEFuaW1hdGlvbkRlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbmZ1bmN0aW9uIF9yZXNvbHZlQW5pbWF0aW9uQ3VydmUoY3VydmUpIHtcbiAgICBzd2l0Y2ggKGN1cnZlKSB7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5cIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZUluKTtcbiAgICAgICAgY2FzZSBcImVhc2VPdXRcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZU91dCk7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5PdXRcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZUluRWFzZU91dCk7XG4gICAgICAgIGNhc2UgXCJsaW5lYXJcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uTGluZWFyKTtcbiAgICAgICAgY2FzZSBcInNwcmluZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIGN1cnZlO1xuICAgICAgICBjYXNlIFwiZWFzZVwiOlxuICAgICAgICAgICAgcmV0dXJuIENBTWVkaWFUaW1pbmdGdW5jdGlvbi5mdW5jdGlvbldpdGhDb250cm9sUG9pbnRzKDAuMjUsIDAuMSwgMC4yNSwgMS4wKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmIChjdXJ2ZSBpbnN0YW5jZW9mIENBTWVkaWFUaW1pbmdGdW5jdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJ2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnZlIGluc3RhbmNlb2YgYW5pbWF0aW9uX2NvbW1vbl8xLkN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uQ3VydmUgPSBjdXJ2ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uLmZ1bmN0aW9uV2l0aENvbnRyb2xQb2ludHMoYW5pbWF0aW9uQ3VydmUueDEsIGFuaW1hdGlvbkN1cnZlLnkxLCBhbmltYXRpb25DdXJ2ZS54MiwgYW5pbWF0aW9uQ3VydmUueTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbmltYXRpb24gY3VydmU6IFwiICsgY3VydmUpO1xuICAgICAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZSA9IF9yZXNvbHZlQW5pbWF0aW9uQ3VydmU7XG52YXIgQW5pbWF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5pbWF0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuaW1hdGlvbihhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25zLmxlbmd0aCA+IDAgJiYgYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOb24tbWVyZ2VkIFByb3BlcnR5IEFuaW1hdGlvbnM6IFwiICsgX3RoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGgsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMgPSBBbmltYXRpb24uX21lcmdlQWZmaW5lVHJhbnNmb3JtQW5pbWF0aW9ucyhfdGhpcy5fcHJvcGVydHlBbmltYXRpb25zKTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIk1lcmdlZCBQcm9wZXJ0eSBBbmltYXRpb25zOiBcIiArIF90aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5fbWVyZ2VkUHJvcGVydHlBbmltYXRpb25zID0gX3RoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhhdCA9IF90aGlzO1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbGxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZpbmlzaGVkQW5pbWF0aW9ucysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhhdC5fY2FuY2VsbGVkQW5pbWF0aW9ucyA+IDAgJiYgKHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMgKyB0aGF0Ll9maW5pc2hlZEFuaW1hdGlvbnMpID09PSB0aGF0Ll9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMgKyBcIiBhbmltYXRpb25zIGNhbmNlbGxlZC5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlamVjdEFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGF0Ll9maW5pc2hlZEFuaW1hdGlvbnMgPT09IHRoYXQuX21lcmdlZFByb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUodGhhdC5fZmluaXNoZWRBbmltYXRpb25zICsgXCIgYW5pbWF0aW9ucyBmaW5pc2hlZC5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9pT1NBbmltYXRpb25GdW5jdGlvbiA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24oX3RoaXMuX21lcmdlZFByb3BlcnR5QW5pbWF0aW9ucywgMCwgX3RoaXMuX3BsYXlTZXF1ZW50aWFsbHksIF90aGlzLl92YWx1ZVNvdXJjZSwgYW5pbWF0aW9uRmluaXNoZWRDYWxsYmFjayk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3RBbHJlYWR5UGxheWluZygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBfc3VwZXIucHJvdG90eXBlLnBsYXkuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZmluaXNoZWRBbmltYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGVkQW5pbWF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMuX2lPU0FuaW1hdGlvbkZ1bmN0aW9uKCk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25GaW5pc2hlZFByb21pc2U7XG4gICAgfTtcbiAgICBBbmltYXRpb24ucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykge1xuICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gaXMgbm90IGN1cnJlbnRseSBwbGF5aW5nLlwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoO1xuICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlBbmltYXRpb24gPSB0aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnNbaV07XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZC5sYXllci5yZW1vdmVBbGxBbmltYXRpb25zKCk7XG4gICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2socHJvcGVydHlBbmltYXRpb24uX29yaWdpbmFsVmFsdWUsIHRoaXMuX3ZhbHVlU291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkN1cnZlID0gZnVuY3Rpb24gKGN1cnZlKSB7XG4gICAgICAgIHJldHVybiBfcmVzb2x2ZUFuaW1hdGlvbkN1cnZlKGN1cnZlKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24gPSBmdW5jdGlvbiAocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCwgcGxheVNlcXVlbnRpYWxseSwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIGlmIChjYW5jZWxsZWQgJiYgZmluaXNoZWRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gXCIgKyAoaW5kZXggLSAxKS50b1N0cmluZygpICsgXCIgd2FzIGNhbmNlbGxlZC4gV2lsbCBza2lwIHRoZSByZXN0IG9mIGFuaW1hdGlvbnMgYW5kIGNhbGwgZmluaXNoZWRDYWxsYmFjayh0cnVlKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaW5pc2hlZENhbGxiYWNrKGNhbmNlbGxlZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHByb3BlcnR5QW5pbWF0aW9uc1tpbmRleF07XG4gICAgICAgICAgICB2YXIgYXJncyA9IEFuaW1hdGlvbi5fZ2V0TmF0aXZlQW5pbWF0aW9uQXJndW1lbnRzKGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi5jdXJ2ZSA9PT0gXCJzcHJpbmdcIikge1xuICAgICAgICAgICAgICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlU3ByaW5nQW5pbWF0aW9uKHByb3BlcnR5QW5pbWF0aW9ucywgaW5kZXgsIHBsYXlTZXF1ZW50aWFsbHksIGFyZ3MsIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgQW5pbWF0aW9uLl9jcmVhdGVOYXRpdmVBbmltYXRpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCwgcGxheVNlcXVlbnRpYWxseSwgYXJncywgYW5pbWF0aW9uLCB2YWx1ZVNvdXJjZSwgZmluaXNoZWRDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2dldE5hdGl2ZUFuaW1hdGlvbkFyZ3VtZW50cyA9IGZ1bmN0aW9uIChhbmltYXRpb24sIHZhbHVlU291cmNlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gYW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gYW5pbWF0aW9uLnByb3BlcnR5O1xuICAgICAgICB2YXIgdG9WYWx1ZSA9IGFuaW1hdGlvbi52YWx1ZTtcbiAgICAgICAgdmFyIGZyb21WYWx1ZTtcbiAgICAgICAgdmFyIHBhcmVudCA9IGFuaW1hdGlvbi50YXJnZXQucGFyZW50O1xuICAgICAgICB2YXIgc2NyZWVuU2NhbGUgPSBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLnNjYWxlO1xuICAgICAgICB2YXIgdGVtcFJvdGF0ZSA9IChhbmltYXRpb24udGFyZ2V0LnJvdGF0ZSB8fCAwKSAqIE1hdGguUEkgLyAxODA7XG4gICAgICAgIHZhciBhYnM7XG4gICAgICAgIHZhciBzZXRMb2NhbCA9IHZhbHVlU291cmNlID09PSBcImFuaW1hdGlvblwiO1xuICAgICAgICBzd2l0Y2ggKGFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3I6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IG5hdGl2ZVZpZXcubGF5ZXIuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgVUlMYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFZhbHVlRm9yS2V5KFVJQ29sb3IuY2xlYXJDb2xvciwgXCJiYWNrZ3JvdW5kQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSB0b1ZhbHVlLkNHQ29sb3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLm9wYWNpdHk6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5vcGFjaXR5O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IG5hdGl2ZVZpZXcubGF5ZXIub3BhY2l0eTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMucm90YXRlOlxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXQucm90YXRlICE9PSB1bmRlZmluZWQgPyBhbmltYXRpb24udGFyZ2V0LnJvdGF0ZSA6IDA7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHByb3BlcnR5TmFtZVRvQW5pbWF0ZSA9IFwidHJhbnNmb3JtLnJvdGF0aW9uXCI7XG4gICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gbmF0aXZlVmlldy5sYXllci52YWx1ZUZvcktleVBhdGgoXCJ0cmFuc2Zvcm0ucm90YXRpb25cIik7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi50YXJnZXQucm90YXRlICE9PSB1bmRlZmluZWQgJiYgYW5pbWF0aW9uLnRhcmdldC5yb3RhdGUgIT09IDAgJiYgTWF0aC5mbG9vcih0b1ZhbHVlIC8gMzYwKSAtIHRvVmFsdWUgLyAzNjAgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5yb3RhdGUgKiBNYXRoLlBJIC8gMTgwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0b1ZhbHVlID0gdG9WYWx1ZSAqIE1hdGguUEkgLyAxODA7XG4gICAgICAgICAgICAgICAgYWJzID0gZmFicyhmcm9tVmFsdWUgLSB0b1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoYWJzIDwgMC4wMDEgJiYgZnJvbVZhbHVlICE9PSB0ZW1wUm90YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IHRlbXBSb3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGU6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0geyB4OiBhbmltYXRpb24udGFyZ2V0LnRyYW5zbGF0ZVgsIHk6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWSB9O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS54O1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gXCJ0cmFuc2Zvcm1cIjtcbiAgICAgICAgICAgICAgICBmcm9tVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QobmF0aXZlVmlldy5sYXllci50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQ0FUcmFuc2Zvcm0zRFRyYW5zbGF0ZShuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybSwgdG9WYWx1ZS54LCB0b1ZhbHVlLnksIDApKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGU6XG4gICAgICAgICAgICAgICAgaWYgKHRvVmFsdWUueCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0b1ZhbHVlLnggPSAwLjAwMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRvVmFsdWUueSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0b1ZhbHVlLnkgPSAwLjAwMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0geyB4OiBhbmltYXRpb24udGFyZ2V0LnNjYWxlWCwgeTogYW5pbWF0aW9uLnRhcmdldC5zY2FsZVkgfTtcbiAgICAgICAgICAgICAgICBhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjayA9IGZ1bmN0aW9uICh2YWx1ZSwgdmFsdWVTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLng7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gXCJ0cmFuc2Zvcm1cIjtcbiAgICAgICAgICAgICAgICBmcm9tVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QobmF0aXZlVmlldy5sYXllci50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQ0FUcmFuc2Zvcm0zRFNjYWxlKG5hdGl2ZVZpZXcubGF5ZXIudHJhbnNmb3JtLCB0b1ZhbHVlLngsIHRvVmFsdWUueSwgMSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBfdHJhbnNmb3JtOlxuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IE5TVmFsdWUudmFsdWVXaXRoQ0FUcmFuc2Zvcm0zRChuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICB4czogYW5pbWF0aW9uLnRhcmdldC5zY2FsZVgsIHlzOiBhbmltYXRpb24udGFyZ2V0LnNjYWxlWSxcbiAgICAgICAgICAgICAgICAgICAgeHQ6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWCwgeXQ6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnh0O1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55dDtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnhzO1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWUueXM7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWVUb0FuaW1hdGUgPSBcInRyYW5zZm9ybVwiO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQW5pbWF0aW9uLl9jcmVhdGVOYXRpdmVBZmZpbmVUcmFuc2Zvcm0oYW5pbWF0aW9uKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLndpZHRoOlxuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5oZWlnaHQ6XG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGFuaW1hdGlvbi5wcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICB2YXIgaXNIZWlnaHRfMSA9IGRpcmVjdGlvbiA9PT0gXCJoZWlnaHRcIjtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWVUb0FuaW1hdGUgPSBcImJvdW5kc1wiO1xuICAgICAgICAgICAgICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbm5vdCBhbmltYXRlIFwiICsgZGlyZWN0aW9uICsgXCIgb24gcm9vdCB2aWV3XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50RXh0ZW50ID0gaXNIZWlnaHRfMSA/IHBhcmVudC5nZXRNZWFzdXJlZEhlaWdodCgpIDogcGFyZW50LmdldE1lYXN1cmVkV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgYXNOdW1iZXIgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC5wYXJzZSh0b1ZhbHVlKSwgcGFyZW50RXh0ZW50LCBwYXJlbnRFeHRlbnQpIC8gc2NyZWVuU2NhbGU7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRCb3VuZHMgPSBuYXRpdmVWaWV3LmxheWVyLmJvdW5kcztcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZW50WCA9IGlzSGVpZ2h0XzEgPyBjdXJyZW50Qm91bmRzLnNpemUud2lkdGggOiBhc051bWJlcjtcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZW50WSA9IGlzSGVpZ2h0XzEgPyBhc051bWJlciA6IGN1cnJlbnRCb3VuZHMuc2l6ZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gTlNWYWx1ZS52YWx1ZVdpdGhDR1JlY3QoY3VycmVudEJvdW5kcyk7XG4gICAgICAgICAgICAgICAgdG9WYWx1ZSA9IE5TVmFsdWUudmFsdWVXaXRoQ0dSZWN0KENHUmVjdE1ha2UoY3VycmVudEJvdW5kcy5vcmlnaW4ueCwgY3VycmVudEJvdW5kcy5vcmlnaW4ueSwgZXh0ZW50WCwgZXh0ZW50WSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXQuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGlzSGVpZ2h0XzEgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuaGVpZ2h0UHJvcGVydHkgOiBzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHByb3AubmFtZSA6IHByb3Aua2V5ZnJhbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQW5pbWF0aW5nIHByb3BlcnR5ICdcIiArIGFuaW1hdGlvbi5wcm9wZXJ0eSArIFwiJyBpcyB1bnN1cHBvcnRlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHVyYXRpb24gPSAwLjM7XG4gICAgICAgIGlmIChhbmltYXRpb24uZHVyYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSBhbmltYXRpb24uZHVyYXRpb24gLyAxMDAwLjA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbGF5ID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoYW5pbWF0aW9uLmRlbGF5KSB7XG4gICAgICAgICAgICBkZWxheSA9IGFuaW1hdGlvbi5kZWxheSAvIDEwMDAuMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVwZWF0Q291bnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChhbmltYXRpb24uaXRlcmF0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLml0ZXJhdGlvbnMgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgICAgICAgICAgIHJlcGVhdENvdW50ID0gRkxUX01BWDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcGVhdENvdW50ID0gYW5pbWF0aW9uLml0ZXJhdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZVRvQW5pbWF0ZTogcHJvcGVydHlOYW1lVG9BbmltYXRlLFxuICAgICAgICAgICAgZnJvbVZhbHVlOiBmcm9tVmFsdWUsXG4gICAgICAgICAgICB0b1ZhbHVlOiB0b1ZhbHVlLFxuICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICAgICAgcmVwZWF0Q291bnQ6IHJlcGVhdENvdW50LFxuICAgICAgICAgICAgZGVsYXk6IGRlbGF5XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2NyZWF0ZU5hdGl2ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uIChwcm9wZXJ0eUFuaW1hdGlvbnMsIGluZGV4LCBwbGF5U2VxdWVudGlhbGx5LCBhcmdzLCBhbmltYXRpb24sIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gYW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbmF0aXZlQW5pbWF0aW9uID0gQ0FCYXNpY0FuaW1hdGlvbi5hbmltYXRpb25XaXRoS2V5UGF0aChhcmdzLnByb3BlcnR5TmFtZVRvQW5pbWF0ZSk7XG4gICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5mcm9tVmFsdWUgPSBhcmdzLmZyb21WYWx1ZTtcbiAgICAgICAgbmF0aXZlQW5pbWF0aW9uLnRvVmFsdWUgPSBhcmdzLnRvVmFsdWU7XG4gICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5kdXJhdGlvbiA9IGFyZ3MuZHVyYXRpb247XG4gICAgICAgIGlmIChhcmdzLnJlcGVhdENvdW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5yZXBlYXRDb3VudCA9IGFyZ3MucmVwZWF0Q291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFyZ3MuZGVsYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbmF0aXZlQW5pbWF0aW9uLmJlZ2luVGltZSA9IENBQ3VycmVudE1lZGlhVGltZSgpICsgYXJncy5kZWxheTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uLmN1cnZlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZUFuaW1hdGlvbi50aW1pbmdGdW5jdGlvbiA9IGFuaW1hdGlvbi5jdXJ2ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9uRGVsZWdhdGUgPSBBbmltYXRpb25EZWxlZ2F0ZUltcGwuaW5pdFdpdGhGaW5pc2hlZENhbGxiYWNrKGZpbmlzaGVkQ2FsbGJhY2ssIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpO1xuICAgICAgICBuYXRpdmVBbmltYXRpb24uc2V0VmFsdWVGb3JLZXkoYW5pbWF0aW9uRGVsZWdhdGUsIFwiZGVsZWdhdGVcIik7XG4gICAgICAgIG5hdGl2ZVZpZXcubGF5ZXIuYWRkQW5pbWF0aW9uRm9yS2V5KG5hdGl2ZUFuaW1hdGlvbiwgYXJncy5wcm9wZXJ0eU5hbWVUb0FuaW1hdGUpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChpbmRleCArIDEgPCBwcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCArIDEsIHBsYXlTZXF1ZW50aWFsbHksIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmICghcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWxlZ2F0ZS5uZXh0QW5pbWF0aW9uID0gY2FsbGJhY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlU3ByaW5nQW5pbWF0aW9uID0gZnVuY3Rpb24gKHByb3BlcnR5QW5pbWF0aW9ucywgaW5kZXgsIHBsYXlTZXF1ZW50aWFsbHksIGFyZ3MsIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBhbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIG5leHRBbmltYXRpb247XG4gICAgICAgIGlmIChpbmRleCArIDEgPCBwcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCArIDEsIHBsYXlTZXF1ZW50aWFsbHksIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmICghcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXh0QW5pbWF0aW9uID0gY2FsbGJhY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbGF5ID0gMDtcbiAgICAgICAgaWYgKGFyZ3MuZGVsYXkpIHtcbiAgICAgICAgICAgIGRlbGF5ID0gYXJncy5kZWxheTtcbiAgICAgICAgfVxuICAgICAgICBVSVZpZXcuYW5pbWF0ZVdpdGhEdXJhdGlvbkRlbGF5VXNpbmdTcHJpbmdXaXRoRGFtcGluZ0luaXRpYWxTcHJpbmdWZWxvY2l0eU9wdGlvbnNBbmltYXRpb25zQ29tcGxldGlvbihhcmdzLmR1cmF0aW9uLCBkZWxheSwgMC4yLCAwLCAxOTY2MDgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLnJlcGVhdENvdW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uUmVwZWF0Q291bnQoYXJncy5yZXBlYXRDb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yOlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LmJhY2tncm91bmRDb2xvciA9IGFyZ3MudG9WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5vcGFjaXR5OlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0Lm9wYWNpdHkgPSBhcmdzLnRvVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuaGVpZ2h0OlxuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMud2lkdGg6XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXRbYW5pbWF0aW9uLnByb3BlcnR5XTtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXRbYW5pbWF0aW9uLnByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZTpcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNmb3JtOlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uX29yaWdpbmFsVmFsdWUgPSBuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGF5ZXIudHJhbnNmb3JtID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoYW5pbWF0aW9uRGlkRmluaXNoKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGlkRmluaXNoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi5wcm9wZXJ0eSA9PT0gX3RyYW5zZm9ybSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uLnZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC50cmFuc2xhdGVYID0gYW5pbWF0aW9uLnZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZV0ueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWSA9IGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zY2FsZVggPSBhbmltYXRpb24udmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGVdLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnNjYWxlWSA9IGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0ueTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjayhhbmltYXRpb24uX29yaWdpbmFsVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhbmNlbGxlZCA9ICFhbmltYXRpb25EaWRGaW5pc2g7XG4gICAgICAgICAgICAgICAgZmluaXNoZWRDYWxsYmFjayhjYW5jZWxsZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkRpZEZpbmlzaCAmJiBuZXh0QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlQWZmaW5lVHJhbnNmb3JtID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICB2YXIgdmFsdWUgPSBhbmltYXRpb24udmFsdWU7XG4gICAgICAgIHZhciByZXN1bHQgPSBDQVRyYW5zZm9ybTNESWRlbnRpdHk7XG4gICAgICAgIGlmICh2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB4ID0gdmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlXS54O1xuICAgICAgICAgICAgdmFyIHkgPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICByZXN1bHQgPSBDQVRyYW5zZm9ybTNEVHJhbnNsYXRlKHJlc3VsdCwgeCwgeSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgeCA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS54O1xuICAgICAgICAgICAgdmFyIHkgPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0ueTtcbiAgICAgICAgICAgIHJlc3VsdCA9IENBVHJhbnNmb3JtM0RTY2FsZShyZXN1bHQsIHggPT09IDAgPyAwLjAwMSA6IHgsIHkgPT09IDAgPyAwLjAwMSA6IHksIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eSA9PT0gX3RyYW5zZm9ybVxuICAgICAgICAgICAgfHwgcHJvcGVydHkgPT09IGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZVxuICAgICAgICAgICAgfHwgcHJvcGVydHkgPT09IGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uLl9jYW5CZU1lcmdlZCA9IGZ1bmN0aW9uIChhbmltYXRpb24xLCBhbmltYXRpb24yKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtKGFuaW1hdGlvbjEucHJvcGVydHkpICYmXG4gICAgICAgICAgICBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtKGFuaW1hdGlvbjIucHJvcGVydHkpICYmXG4gICAgICAgICAgICBhbmltYXRpb24xLnRhcmdldCA9PT0gYW5pbWF0aW9uMi50YXJnZXQgJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuZHVyYXRpb24gPT09IGFuaW1hdGlvbjIuZHVyYXRpb24gJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuZGVsYXkgPT09IGFuaW1hdGlvbjIuZGVsYXkgJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuaXRlcmF0aW9ucyA9PT0gYW5pbWF0aW9uMi5pdGVyYXRpb25zICYmXG4gICAgICAgICAgICBhbmltYXRpb24xLmN1cnZlID09PSBhbmltYXRpb24yLmN1cnZlO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQW5pbWF0aW9uLl9tZXJnZUFmZmluZVRyYW5zZm9ybUFuaW1hdGlvbnMgPSBmdW5jdGlvbiAocHJvcGVydHlBbmltYXRpb25zKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIgajtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHByb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbnNbaV1bX3NraXBdKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIUFuaW1hdGlvbi5faXNBZmZpbmVUcmFuc2Zvcm0ocHJvcGVydHlBbmltYXRpb25zW2ldLnByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHByb3BlcnR5QW5pbWF0aW9uc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VHJhbnNmb3JtQW5pbWF0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3BlcnR5QW5pbWF0aW9uc1tpXS50YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBfdHJhbnNmb3JtLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZToge30sXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBwcm9wZXJ0eUFuaW1hdGlvbnNbaV0uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5OiBwcm9wZXJ0eUFuaW1hdGlvbnNbaV0uZGVsYXksXG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IHByb3BlcnR5QW5pbWF0aW9uc1tpXS5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICBjdXJ2ZTogcHJvcGVydHlBbmltYXRpb25zW2ldLmN1cnZlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQ3VydmU6IFwiICsgcHJvcGVydHlBbmltYXRpb25zW2ldLmN1cnZlLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld1RyYW5zZm9ybUFuaW1hdGlvbi52YWx1ZVtwcm9wZXJ0eUFuaW1hdGlvbnNbaV0ucHJvcGVydHldID0gcHJvcGVydHlBbmltYXRpb25zW2ldLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDcmVhdGVkIG5ldyB0cmFuc2Zvcm0gYW5pbWF0aW9uOiBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhuZXdUcmFuc2Zvcm1BbmltYXRpb24pLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGogPSBpICsgMTtcbiAgICAgICAgICAgICAgICBpZiAoaiA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgaiA8IGxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQW5pbWF0aW9uLl9jYW5CZU1lcmdlZChwcm9wZXJ0eUFuaW1hdGlvbnNbaV0sIHByb3BlcnR5QW5pbWF0aW9uc1tqXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWVyZ2luZyBhbmltYXRpb25zOiBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhuZXdUcmFuc2Zvcm1BbmltYXRpb24pICsgXCIgKyBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhwcm9wZXJ0eUFuaW1hdGlvbnNbal0pICsgXCI7XCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VHJhbnNmb3JtQW5pbWF0aW9uLnZhbHVlW3Byb3BlcnR5QW5pbWF0aW9uc1tqXS5wcm9wZXJ0eV0gPSBwcm9wZXJ0eUFuaW1hdGlvbnNbal0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zW2pdW19za2lwXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobmV3VHJhbnNmb3JtQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIEFuaW1hdGlvbjtcbn0oYW5pbWF0aW9uX2NvbW1vbl8xLkFuaW1hdGlvbkJhc2UpKTtcbmV4cG9ydHMuQW5pbWF0aW9uID0gQW5pbWF0aW9uO1xuZnVuY3Rpb24gX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlKHZpZXcpIHtcbiAgICB2YXIgcmVzdWx0ID0gQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eTtcbiAgICB2YXIgdHggPSB2aWV3LnRyYW5zbGF0ZVg7XG4gICAgdmFyIHR5ID0gdmlldy50cmFuc2xhdGVZO1xuICAgIHJlc3VsdCA9IENHQWZmaW5lVHJhbnNmb3JtVHJhbnNsYXRlKHJlc3VsdCwgdHgsIHR5KTtcbiAgICByZXN1bHQgPSBDR0FmZmluZVRyYW5zZm9ybVJvdGF0ZShyZXN1bHQsICh2aWV3LnJvdGF0ZSB8fCAwKSAqIE1hdGguUEkgLyAxODApO1xuICAgIHJlc3VsdCA9IENHQWZmaW5lVHJhbnNmb3JtU2NhbGUocmVzdWx0LCB2aWV3LnNjYWxlWCB8fCAxLCB2aWV3LnNjYWxlWSB8fCAxKTtcbiAgICB2YXIgdmlld1RyYW5zZm9ybSA9IE5TU3RyaW5nRnJvbUNHQWZmaW5lVHJhbnNmb3JtKHJlc3VsdCk7XG4gICAgdmFyIG5hdGl2ZVRyYW5zZm9ybSA9IE5TU3RyaW5nRnJvbUNHQWZmaW5lVHJhbnNmb3JtKHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC50cmFuc2Zvcm0pO1xuICAgIGlmICh2aWV3VHJhbnNmb3JtICE9PSBuYXRpdmVUcmFuc2Zvcm0pIHtcbiAgICAgICAgcmV0dXJuIFwiVmlldyBhbmQgTmF0aXZlIHRyYW5zZm9ybXMgZG8gbm90IG1hdGNoLiBWaWV3OiBcIiArIHZpZXdUcmFuc2Zvcm0gKyBcIjsgTmF0aXZlOiBcIiArIG5hdGl2ZVRyYW5zZm9ybTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlID0gX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5pbWF0aW9uLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW51bXNfMSA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi9hbmltYXRpb25cIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBLZXlmcmFtZXMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lcygpIHtcbiAgICB9XG4gICAgcmV0dXJuIEtleWZyYW1lcztcbn0oKSk7XG5leHBvcnRzLktleWZyYW1lcyA9IEtleWZyYW1lcztcbnZhciBVbnBhcnNlZEtleWZyYW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBVbnBhcnNlZEtleWZyYW1lKCkge1xuICAgIH1cbiAgICByZXR1cm4gVW5wYXJzZWRLZXlmcmFtZTtcbn0oKSk7XG5leHBvcnRzLlVucGFyc2VkS2V5ZnJhbWUgPSBVbnBhcnNlZEtleWZyYW1lO1xudmFyIEtleWZyYW1lRGVjbGFyYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lRGVjbGFyYXRpb24oKSB7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZURlY2xhcmF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVEZWNsYXJhdGlvbiA9IEtleWZyYW1lRGVjbGFyYXRpb247XG52YXIgS2V5ZnJhbWVJbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUluZm8oKSB7XG4gICAgICAgIHRoaXMuY3VydmUgPSBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2U7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZUluZm87XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZUluZm8gPSBLZXlmcmFtZUluZm87XG52YXIgS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbkluZm8oKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZHVyYXRpb24gPSAwLjM7XG4gICAgICAgIHRoaXMuZGVsYXkgPSAwO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAxO1xuICAgICAgICB0aGlzLmN1cnZlID0gXCJlYXNlXCI7XG4gICAgICAgIHRoaXMuaXNGb3J3YXJkcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xudmFyIEtleWZyYW1lQW5pbWF0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbigpIHtcbiAgICAgICAgdGhpcy5kZWxheSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDE7XG4gICAgfVxuICAgIEtleWZyYW1lQW5pbWF0aW9uLmtleWZyYW1lQW5pbWF0aW9uRnJvbUluZm8gPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICB2YXIgbGVuZ3RoID0gaW5mby5rZXlmcmFtZXMubGVuZ3RoO1xuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgc3RhcnREdXJhdGlvbiA9IDA7XG4gICAgICAgIGlmIChpbmZvLmlzUmV2ZXJzZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMSA9IGxlbmd0aCAtIDE7IGluZGV4XzEgPj0gMDsgaW5kZXhfMS0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gaW5mby5rZXlmcmFtZXNbaW5kZXhfMV07XG4gICAgICAgICAgICAgICAgc3RhcnREdXJhdGlvbiA9IEtleWZyYW1lQW5pbWF0aW9uLnBhcnNlS2V5ZnJhbWUoaW5mbywga2V5ZnJhbWUsIGFuaW1hdGlvbnMsIHN0YXJ0RHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMiA9IDA7IGluZGV4XzIgPCBsZW5ndGg7IGluZGV4XzIrKykge1xuICAgICAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IGluZm8ua2V5ZnJhbWVzW2luZGV4XzJdO1xuICAgICAgICAgICAgICAgIHN0YXJ0RHVyYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbi5wYXJzZUtleWZyYW1lKGluZm8sIGtleWZyYW1lLCBhbmltYXRpb25zLCBzdGFydER1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4XzMgPSBsZW5ndGggLSAxOyBpbmRleF8zID4gMDsgaW5kZXhfMy0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGExID0gYW5pbWF0aW9uc1tpbmRleF8zXTtcbiAgICAgICAgICAgICAgICB2YXIgYTIgPSBhbmltYXRpb25zW2luZGV4XzMgLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAoYTJbXCJjdXJ2ZVwiXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGExW1wiY3VydmVcIl0gPSBhMltcImN1cnZlXCJdO1xuICAgICAgICAgICAgICAgICAgICBhMltcImN1cnZlXCJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb25zLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYVtcImN1cnZlXCJdID8gYSA6IE9iamVjdC5hc3NpZ24oYSwgeyBjdXJ2ZTogaW5mby5jdXJ2ZSB9KTsgfSk7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSBuZXcgS2V5ZnJhbWVBbmltYXRpb24oKTtcbiAgICAgICAgYW5pbWF0aW9uLmRlbGF5ID0gaW5mby5kZWxheTtcbiAgICAgICAgYW5pbWF0aW9uLml0ZXJhdGlvbnMgPSBpbmZvLml0ZXJhdGlvbnM7XG4gICAgICAgIGFuaW1hdGlvbi5hbmltYXRpb25zID0gYW5pbWF0aW9ucztcbiAgICAgICAgYW5pbWF0aW9uLl9pc0ZvcndhcmRzID0gaW5mby5pc0ZvcndhcmRzO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucGFyc2VLZXlmcmFtZSA9IGZ1bmN0aW9uIChpbmZvLCBrZXlmcmFtZSwgYW5pbWF0aW9ucywgc3RhcnREdXJhdGlvbikge1xuICAgICAgICB2YXIgYW5pbWF0aW9uID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBrZXlmcmFtZS5kZWNsYXJhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZGVjbGFyYXRpb24gPSBfYVtfaV07XG4gICAgICAgICAgICBhbmltYXRpb25bZGVjbGFyYXRpb24ucHJvcGVydHldID0gZGVjbGFyYXRpb24udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGR1cmF0aW9uID0ga2V5ZnJhbWUuZHVyYXRpb247XG4gICAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAwLjAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAoaW5mby5kdXJhdGlvbiAqIGR1cmF0aW9uKSAtIHN0YXJ0RHVyYXRpb247XG4gICAgICAgICAgICBzdGFydER1cmF0aW9uICs9IGR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbi5kdXJhdGlvbiA9IGluZm8uaXNSZXZlcnNlID8gaW5mby5kdXJhdGlvbiAtIGR1cmF0aW9uIDogZHVyYXRpb247XG4gICAgICAgIGFuaW1hdGlvbi5jdXJ2ZSA9IGtleWZyYW1lLmN1cnZlO1xuICAgICAgICBhbmltYXRpb24uZm9yY2VMYXllciA9IHRydWU7XG4gICAgICAgIGFuaW1hdGlvbi52YWx1ZVNvdXJjZSA9IFwia2V5ZnJhbWVcIjtcbiAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgIHJldHVybiBzdGFydER1cmF0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZSwgXCJpc1BsYXlpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1BsYXlpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJLZXlmcmFtZSBhbmltYXRpb24gaXMgYWxyZWFkeSBwbGF5aW5nLlwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuX25hdGl2ZUFuaW1hdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmlzUGxheWluZykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1swXTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHRoaXMuX3RhcmdldCwgYW5pbWF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNldEFuaW1hdGlvbnMoKTtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuX2lzUGxheWluZykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lIGFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgIF90aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdmlldztcbiAgICAgICAgaWYgKHRoaXMuZGVsYXkgIT09IDApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYW5pbWF0ZSh2aWV3LCAwLCBfdGhpcy5pdGVyYXRpb25zKTsgfSwgdGhpcy5kZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgdGhpcy5pdGVyYXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiAodmlldywgaW5kZXgsIGl0ZXJhdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLl9pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB0aGlzLmFuaW1hdGlvbnNbMF07XG4gICAgICAgICAgICBpZiAoXCJiYWNrZ3JvdW5kQ29sb3JcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueDtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInRyYW5zbGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24udHJhbnNsYXRlLng7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi50cmFuc2xhdGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInJvdGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5yb3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5vcGFjaXR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuaGVpZ2h0UHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcIndpZHRoXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24ud2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFuaW1hdGUodmlldywgMSwgaXRlcmF0aW9ucyk7IH0sIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpdGVyYXRpb25zIC09IDE7XG4gICAgICAgICAgICBpZiAoaXRlcmF0aW9ucyA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgaXRlcmF0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNGb3J3YXJkcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uc1t0aGlzLmFuaW1hdGlvbnMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHZpZXcsIGFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgY2FjaGVkQW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1tpbmRleCAtIDFdO1xuICAgICAgICAgICAgaWYgKGNhY2hlZEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IGNhY2hlZEFuaW1hdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb25EZWYgPSB0aGlzLmFuaW1hdGlvbnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkRlZi50YXJnZXQgPSB2aWV3O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IG5ldyBhbmltYXRpb25fMS5BbmltYXRpb24oW2FuaW1hdGlvbkRlZl0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzTGFzdEl0ZXJhdGlvbiA9IGl0ZXJhdGlvbnMgLSAxIDw9IDA7XG4gICAgICAgICAgICBhbmltYXRpb24ucGxheShpc0xhc3RJdGVyYXRpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFuaW1hdGUodmlldywgaW5kZXggKyAxLCBpdGVyYXRpb25zKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiID8gZXJyb3IgOiBlcnJvci5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIgPyBlcnJvciA6IGVycm9yLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLl9yZXNvbHZlQW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90YXJnZXQgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wcm90b3R5cGUuX3Jlc2V0QW5pbWF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbmF0aXZlQW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzZXRBbmltYXRpb25WYWx1ZXMgPSBmdW5jdGlvbiAodmlldywgYW5pbWF0aW9uKSB7XG4gICAgICAgIGlmIChcImJhY2tncm91bmRDb2xvclwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwidHJhbnNsYXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwicm90YXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJ3aWR0aFwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEtleWZyYW1lQW5pbWF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtleWZyYW1lLWFuaW1hdGlvbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpO1xudmFyIEJvcmRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJvcmRlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCb3JkZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJvcmRlci5wcm90b3R5cGUsIFwiY29ybmVyUmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuYm9yZGVyUmFkaXVzID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyUmFkaXVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmJvcmRlclJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCb3JkZXIucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSBjb250ZW50X3ZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gY29udGVudF92aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGNvbnRlbnRfdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGNvbnRlbnRfdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaG9yaXpvbnRhbEJvcmRlckxlbmd0aCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoO1xuICAgICAgICB2YXIgdmVydGljYWxCb3JkZXJMZW5ndGggPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGNvbnRlbnRfdmlld18xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMsIHRoaXMubGF5b3V0VmlldywgY29udGVudF92aWV3XzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyh3aWR0aCAtIGhvcml6b250YWxCb3JkZXJMZW5ndGgsIHdpZHRoTW9kZSksIGNvbnRlbnRfdmlld18xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoaGVpZ2h0IC0gdmVydGljYWxCb3JkZXJMZW5ndGgsIGhlaWdodE1vZGUpKTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBjb250ZW50X3ZpZXdfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUocmVzdWx0Lm1lYXN1cmVkV2lkdGggKyBob3Jpem9udGFsQm9yZGVyTGVuZ3RoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gY29udGVudF92aWV3XzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHJlc3VsdC5tZWFzdXJlZEhlaWdodCArIHZlcnRpY2FsQm9yZGVyTGVuZ3RoLCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIEJvcmRlci5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciBob3Jpem9udGFsQm9yZGVyTGVuZ3RoID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgIHZhciB2ZXJ0aWNhbEJvcmRlckxlbmd0aCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICBjb250ZW50X3ZpZXdfMS5WaWV3LmxheW91dENoaWxkKHRoaXMsIHRoaXMubGF5b3V0VmlldywgdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGgsIHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGgsIHJpZ2h0IC0gbGVmdCAtIGhvcml6b250YWxCb3JkZXJMZW5ndGgsIGJvdHRvbSAtIHRvcCAtIHZlcnRpY2FsQm9yZGVyTGVuZ3RoKTtcbiAgICB9O1xuICAgIEJvcmRlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBEZXByZWNhdGVkLFxuICAgICAgICBjb250ZW50X3ZpZXdfMS5DU1NUeXBlKFwiQm9yZGVyXCIpXG4gICAgXSwgQm9yZGVyKTtcbiAgICByZXR1cm4gQm9yZGVyO1xufShjb250ZW50X3ZpZXdfMS5Db250ZW50VmlldykpO1xuZXhwb3J0cy5Cb3JkZXIgPSBCb3JkZXI7XG5Cb3JkZXIucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ib3JkZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0YWJfc3RyaXBfaXRlbV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIik7XG52YXIgdGFiX25hdmlnYXRpb25fYmFzZV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuLi9mcmFtZVwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW1cIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIikpO1xudmFyIG1ham9yVmVyc2lvbiA9IHV0aWxzXzEuaW9zLk1ham9yVmVyc2lvbjtcbnZhciBpc1Bob25lID0gcGxhdGZvcm1fMS5kZXZpY2UuZGV2aWNlVHlwZSA9PT0gXCJQaG9uZVwiO1xudmFyIFVJVGFiQmFyQ29udHJvbGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVRhYkJhckNvbnRyb2xsZXJJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJVGFiQmFyQ29udHJvbGxlckltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlUYWJCYXJDb250cm9sbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gVUlUYWJCYXJDb250cm9sbGVySW1wbC5uZXcoKTtcbiAgICAgICAgaGFuZGxlci5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGhhbmRsZXI7XG4gICAgfTtcbiAgICBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXh0ZW5kZWRMYXlvdXRJbmNsdWRlc09wYXF1ZUJhcnMgPSB0cnVlO1xuICAgICAgICB2aWV3XzEuaW9zLnVwZGF0ZUF1dG9BZGp1c3RTY3JvbGxJbnNldHModGhpcywgb3duZXIpO1xuICAgICAgICBpZiAoIW93bmVyLnBhcmVudCkge1xuICAgICAgICAgICAgb3duZXIuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld0RpZERpc2FwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lciAmJiAhb3duZXIucGFyZW50ICYmIG93bmVyLmlzTG9hZGVkICYmICF0aGlzLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBvd25lci5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlUYWJCYXJDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld1dpbGxUcmFuc2l0aW9uVG9TaXplV2l0aFRyYW5zaXRpb25Db29yZGluYXRvciA9IGZ1bmN0aW9uIChzaXplLCBjb29yZGluYXRvcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdXaWxsVHJhbnNpdGlvblRvU2l6ZVdpdGhUcmFuc2l0aW9uQ29vcmRpbmF0b3IuY2FsbCh0aGlzLCBzaXplLCBjb29yZGluYXRvcik7XG4gICAgICAgIFVJVmlld0NvbnRyb2xsZXJUcmFuc2l0aW9uQ29vcmRpbmF0b3IucHJvdG90eXBlLmFuaW1hdGVBbG9uZ3NpZGVUcmFuc2l0aW9uQ29tcGxldGlvblxuICAgICAgICAgICAgLmNhbGwoY29vcmRpbmF0b3IsIG51bGwsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IF90aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmIChvd25lciAmJiBvd25lci5pdGVtcykge1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBVSVRhYkJhckNvbnRyb2xsZXJJbXBsO1xufShVSVRhYkJhckNvbnRyb2xsZXIpKTtcbnZhciBVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5uZXcoKTtcbiAgICAgICAgZGVsZWdhdGUuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFiQmFyQ29udHJvbGxlclNob3VsZFNlbGVjdFZpZXdDb250cm9sbGVyID0gZnVuY3Rpb24gKHRhYkJhckNvbnRyb2xsZXIsIHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgb3duZXIuX2hhbmRsZVR3b05hdmlnYXRpb25CYXJzKGJhY2tUb01vcmVXaWxsQmVWaXNpYmxlKTtcbiAgICAgICAgICAgIGlmICh0YWJCYXJDb250cm9sbGVyLnZpZXdDb250cm9sbGVycykge1xuICAgICAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHRhYkJhckNvbnRyb2xsZXIudmlld0NvbnRyb2xsZXJzLmluZGV4T2ZPYmplY3Qodmlld0NvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiAhPT0gTlNOb3RGb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFiU3RyaXBJdGVtcyA9IG93bmVyLnRhYlN0cmlwICYmIG93bmVyLnRhYlN0cmlwLml0ZW1zO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFiU3RyaXBJdGVtcyAmJiB0YWJTdHJpcEl0ZW1zW3Bvc2l0aW9uXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0udGFwRXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0YWJCYXJDb250cm9sbGVyLnNlbGVjdGVkVmlld0NvbnRyb2xsZXIgPT09IHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGFiQmFyQ29udHJvbGxlci5fd2lsbFNlbGVjdFZpZXdDb250cm9sbGVyID0gdmlld0NvbnRyb2xsZXI7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS50YWJCYXJDb250cm9sbGVyRGlkU2VsZWN0Vmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAodGFiQmFyQ29udHJvbGxlciwgdmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgaWYgKHRhYkJhckNvbnRyb2xsZXIudmlld0NvbnRyb2xsZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0gdGFiQmFyQ29udHJvbGxlci52aWV3Q29udHJvbGxlcnMuaW5kZXhPZk9iamVjdCh2aWV3Q29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uICE9PSBOU05vdEZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2UG9zaXRpb24gPSBvd25lci5zZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFiU3RyaXBJdGVtcyA9IG93bmVyLnRhYlN0cmlwICYmIG93bmVyLnRhYlN0cmlwLml0ZW1zO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFiU3RyaXBJdGVtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYlN0cmlwSXRlbXNbcG9zaXRpb25dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtc1twb3NpdGlvbl0uX2VtaXQodGFiX3N0cmlwX2l0ZW1fMS5UYWJTdHJpcEl0ZW0uc2VsZWN0RXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhYlN0cmlwSXRlbXNbcHJldlBvc2l0aW9uXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYlN0cmlwSXRlbXNbcHJldlBvc2l0aW9uXS5fZW1pdCh0YWJfc3RyaXBfaXRlbV8xLlRhYlN0cmlwSXRlbS51bnNlbGVjdEV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG93bmVyLl9vblZpZXdDb250cm9sbGVyU2hvd24odmlld0NvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRhYkJhckNvbnRyb2xsZXIuX3dpbGxTZWxlY3RWaWV3Q29udHJvbGxlciA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5PYmpDUHJvdG9jb2xzID0gW1VJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGU7XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5uYXZpZ2F0aW9uQ29udHJvbGxlcldpbGxTaG93Vmlld0NvbnRyb2xsZXJBbmltYXRlZCA9IGZ1bmN0aW9uIChuYXZpZ2F0aW9uQ29udHJvbGxlciwgdmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSA9IG93bmVyLl9pb3Mudmlld0NvbnRyb2xsZXJzLmNvbnRhaW5zT2JqZWN0KHZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgICAgIG93bmVyLl9oYW5kbGVUd29OYXZpZ2F0aW9uQmFycyhiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLm5hdmlnYXRpb25Db250cm9sbGVyRGlkU2hvd1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQgPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRyb2xsZXIsIHZpZXdDb250cm9sbGVyLCBhbmltYXRlZCkge1xuICAgICAgICBuYXZpZ2F0aW9uQ29udHJvbGxlci5uYXZpZ2F0aW9uQmFyLnRvcEl0ZW0ucmlnaHRCYXJCdXR0b25JdGVtID0gbnVsbDtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgb3duZXIuX29uVmlld0NvbnRyb2xsZXJTaG93bih2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xuZnVuY3Rpb24gdXBkYXRlVGl0bGVBbmRJY29uUG9zaXRpb25zKHRhYlN0cmlwSXRlbSwgdGFiQmFySXRlbSwgY29udHJvbGxlcikge1xuICAgIGlmICghdGFiU3RyaXBJdGVtIHx8ICF0YWJCYXJJdGVtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG9yaWVudGF0aW9uID0gY29udHJvbGxlci5pbnRlcmZhY2VPcmllbnRhdGlvbjtcbiAgICB2YXIgaXNQb3J0cmFpdCA9IG9yaWVudGF0aW9uICE9PSA0ICYmIG9yaWVudGF0aW9uICE9PSAzO1xuICAgIHZhciBpc0ljb25BYm92ZVRpdGxlID0gKG1ham9yVmVyc2lvbiA8IDExKSB8fCAoaXNQaG9uZSAmJiBpc1BvcnRyYWl0KTtcbiAgICBpZiAoIXRhYlN0cmlwSXRlbS5pY29uU291cmNlKSB7XG4gICAgICAgIGlmIChpc0ljb25BYm92ZVRpdGxlKSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLnRpdGxlUG9zaXRpb25BZGp1c3RtZW50ID0geyBob3Jpem9udGFsOiAwLCB2ZXJ0aWNhbDogLTIwIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLnRpdGxlUG9zaXRpb25BZGp1c3RtZW50ID0geyBob3Jpem9udGFsOiAwLCB2ZXJ0aWNhbDogMCB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghdGFiU3RyaXBJdGVtLnRpdGxlKSB7XG4gICAgICAgIGlmIChpc0ljb25BYm92ZVRpdGxlKSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLmltYWdlSW5zZXRzID0gbmV3IFVJRWRnZUluc2V0cyh7IHRvcDogNiwgbGVmdDogMCwgYm90dG9tOiAtNiwgcmlnaHQ6IDAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLmltYWdlSW5zZXRzID0gbmV3IFVJRWRnZUluc2V0cyh7IHRvcDogMCwgbGVmdDogMCwgYm90dG9tOiAwLCByaWdodDogMCB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbnZhciBCb3R0b21OYXZpZ2F0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQm90dG9tTmF2aWdhdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCb3R0b21OYXZpZ2F0aW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5faWNvbnNDYWNoZSA9IHt9O1xuICAgICAgICBfdGhpcy52aWV3Q29udHJvbGxlciA9IF90aGlzLl9pb3MgPSBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgX3RoaXMubmF0aXZlVmlld1Byb3RlY3RlZCA9IF90aGlzLl9pb3MudmlldztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICAgICAgdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGUgPSBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IHRoaXMuaXRlbXMgJiYgdGhpcy5pdGVtc1tzZWxlY3RlZEluZGV4XSAmJiB0aGlzLml0ZW1zW3NlbGVjdGVkSW5kZXhdLnZpZXc7XG4gICAgICAgIGlmIChzZWxlY3RlZFZpZXcgaW5zdGFuY2VvZiBmcmFtZV8xLkZyYW1lKSB7XG4gICAgICAgICAgICBzZWxlY3RlZFZpZXcuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pb3MuZGVsZWdhdGUgPSB0aGlzLl9kZWxlZ2F0ZTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lvcy5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lvcy5tb3JlTmF2aWdhdGlvbkNvbnRyb2xsZXIuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmxheW91dE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5vblNlbGVjdGVkSW5kZXhDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEluZGV4LCBuZXdJbmRleCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9sZEl0ZW0gPSBpdGVtc1tvbGRJbmRleF07XG4gICAgICAgIGlmIChvbGRJdGVtKSB7XG4gICAgICAgICAgICBvbGRJdGVtLmNhbkJlTG9hZGVkID0gZmFsc2U7XG4gICAgICAgICAgICBvbGRJdGVtLnVubG9hZFZpZXcob2xkSXRlbS52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3SXRlbSA9IGl0ZW1zW25ld0luZGV4XTtcbiAgICAgICAgaWYgKG5ld0l0ZW0gJiYgdGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IGl0ZW1zW25ld0luZGV4XS52aWV3O1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFZpZXcuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0l0ZW0uY2FuQmVMb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgbmV3SXRlbS5sb2FkVmlldyhuZXdJdGVtLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25TZWxlY3RlZEluZGV4Q2hhbmdlZC5jYWxsKHRoaXMsIG9sZEluZGV4LCBuZXdJbmRleCk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pb3MudGFiQmFyLmJhclRpbnRDb2xvcjtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pb3MudGFiQmFyLmJhclRpbnRDb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgY29sb3JfMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZ2V0VGFiQmFyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pb3MudGFiQmFyLnRpbnRDb2xvcjtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckNvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2lvcy50YWJCYXIudGludENvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBjb2xvcl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIGlmICghdGhpcy50YWJTdHJpcCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGF0ZXMgPSBnZXRUaXRsZUF0dHJpYnV0ZXNGb3JTdGF0ZXModGhpcy50YWJTdHJpcCk7XG4gICAgICAgIHRoaXMudGFiU3RyaXAuaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgICAgICBhcHBseVN0YXRlc1RvSXRlbSh0YWJTdHJpcEl0ZW0ubmF0aXZlVmlldywgc3RhdGVzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRhYlN0cmlwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJnVmlldyA9IHRhYlN0cmlwSXRlbS5iZ1ZpZXc7XG4gICAgICAgIGlmICghYmdWaWV3KSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhfMSA9IHRhYlN0cmlwSXRlbS5pbmRleDtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRoaXMudGFiU3RyaXAubmF0aXZlVmlldy5mcmFtZS5zaXplLndpZHRoIC8gdGhpcy50YWJTdHJpcC5pdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBDR1JlY3RNYWtlKHdpZHRoICogaW5kZXhfMSwgMCwgd2lkdGgsIHRoaXMudGFiU3RyaXAubmF0aXZlVmlldy5mcmFtZS5zaXplLndpZHRoKTtcbiAgICAgICAgICAgIGJnVmlldyA9IFVJVmlldy5hbGxvYygpLmluaXRXaXRoRnJhbWUoZnJhbWUpO1xuICAgICAgICAgICAgdGhpcy50YWJTdHJpcC5uYXRpdmVWaWV3Lmluc2VydFN1YnZpZXdBdEluZGV4KGJnVmlldywgMCk7XG4gICAgICAgICAgICB0YWJTdHJpcEl0ZW0uYmdWaWV3ID0gYmdWaWV3O1xuICAgICAgICB9XG4gICAgICAgIGJnVmlldy5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGNvbG9yXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lvcy50YWJCYXIudGludENvbG9yO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0VGFiQmFySXRlbUNvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHN0YXRlcyA9IGdldFRpdGxlQXR0cmlidXRlc0ZvclN0YXRlcyh0YWJTdHJpcEl0ZW0pO1xuICAgICAgICBhcHBseVN0YXRlc1RvSXRlbSh0YWJTdHJpcEl0ZW0ubmF0aXZlVmlldywgc3RhdGVzKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Gb250U2l6ZSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udFNpemUgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgICAgICB2YXIgc3RhdGVzID0gZ2V0VGl0bGVBdHRyaWJ1dGVzRm9yU3RhdGVzKHRhYlN0cmlwSXRlbSk7XG4gICAgICAgIGFwcGx5U3RhdGVzVG9JdGVtKHRhYlN0cmlwSXRlbS5uYXRpdmVWaWV3LCBzdGF0ZXMpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuZ2V0VGFiQmFySXRlbUZvbnRJbnRlcm5hbCA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udEludGVybmFsID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHN0YXRlcyA9IGdldFRpdGxlQXR0cmlidXRlc0ZvclN0YXRlcyh0YWJTdHJpcEl0ZW0pO1xuICAgICAgICBhcHBseVN0YXRlc1RvSXRlbSh0YWJTdHJpcEl0ZW0ubmF0aXZlVmlldywgc3RhdGVzKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLmdldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLnNldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHRpdGxlID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KHRhYlN0cmlwSXRlbS50aXRsZSwgdmFsdWUpO1xuICAgICAgICB0YWJTdHJpcEl0ZW0ubmF0aXZlVmlldy50aXRsZSA9IHRpdGxlO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IHV0aWxzXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IHV0aWxzXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHV0aWxzXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gdXRpbHNfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSB2aWV3XzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShoZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX29uVmlld0NvbnRyb2xsZXJTaG93biA9IGZ1bmN0aW9uICh2aWV3Q29udHJvbGxlcikge1xuICAgICAgICBpZiAodGhpcy5faW9zLnZpZXdDb250cm9sbGVycyAmJiB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzLmNvbnRhaW5zT2JqZWN0KHZpZXdDb250cm9sbGVyKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5faW9zLnZpZXdDb250cm9sbGVycy5pbmRleE9mT2JqZWN0KHZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuX2hhbmRsZVR3b05hdmlnYXRpb25CYXJzID0gZnVuY3Rpb24gKGJhY2tUb01vcmVXaWxsQmVWaXNpYmxlKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5wYWdlIHx8IHRoaXMuX3NlbGVjdGVkVmlldy5wYWdlIHx8IHRoaXMuX3NlbGVjdGVkVmlldy5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKCFwYWdlIHx8ICFwYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFjdGlvbkJhclZpc2libGUgPSBwYWdlLmZyYW1lLl9nZXROYXZCYXJWaXNpYmxlKHBhZ2UpO1xuICAgICAgICBpZiAoYmFja1RvTW9yZVdpbGxCZVZpc2libGUgJiYgYWN0aW9uQmFyVmlzaWJsZSkge1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgcGFnZS5hY3Rpb25CYXJIaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhckhpZGRlbkJ5VGFiVmlldyA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSAmJiB0aGlzLl9hY3Rpb25CYXJIaWRkZW5CeVRhYlZpZXcpIHtcbiAgICAgICAgICAgIHBhZ2UuZnJhbWUuaW9zLl9kaXNhYmxlTmF2QmFyQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHBhZ2UuYWN0aW9uQmFySGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICBwYWdlLmZyYW1lLmlvcy5fZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFySGlkZGVuQnlUYWJWaWV3ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRWaWV3Q29udHJvbGxlciA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHZhciBuZXdDb250cm9sbGVyID0gaXRlbS52aWV3ID8gaXRlbS52aWV3LnZpZXdDb250cm9sbGVyIDogbnVsbDtcbiAgICAgICAgaWYgKG5ld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGl0ZW0uc2V0Vmlld0NvbnRyb2xsZXIobmV3Q29udHJvbGxlciwgbmV3Q29udHJvbGxlci52aWV3KTtcbiAgICAgICAgICAgIHJldHVybiBuZXdDb250cm9sbGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpdGVtLnZpZXcuaW9zIGluc3RhbmNlb2YgVUlWaWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlciA9IGl0ZW0udmlldy5pb3M7XG4gICAgICAgICAgICBpdGVtLnNldFZpZXdDb250cm9sbGVyKG5ld0NvbnRyb2xsZXIsIG5ld0NvbnRyb2xsZXIudmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXRlbS52aWV3LmlvcyAmJiBpdGVtLnZpZXcuaW9zLmNvbnRyb2xsZXIgaW5zdGFuY2VvZiBVSVZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVyID0gaXRlbS52aWV3Lmlvcy5jb250cm9sbGVyO1xuICAgICAgICAgICAgaXRlbS5zZXRWaWV3Q29udHJvbGxlcihuZXdDb250cm9sbGVyLCBuZXdDb250cm9sbGVyLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlciA9IHZpZXdfMS5pb3MuVUlMYXlvdXRWaWV3Q29udHJvbGxlci5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKGl0ZW0udmlldykpO1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlci52aWV3LmFkZFN1YnZpZXcoaXRlbS52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICAgICAgaXRlbS52aWV3LnZpZXdDb250cm9sbGVyID0gbmV3Q29udHJvbGxlcjtcbiAgICAgICAgICAgIGl0ZW0uc2V0Vmlld0NvbnRyb2xsZXIobmV3Q29udHJvbGxlciwgaXRlbS52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdDb250cm9sbGVyO1xuICAgIH07XG4gICAgQm90dG9tTmF2aWdhdGlvbi5wcm90b3R5cGUuc2V0Vmlld0NvbnRyb2xsZXJzID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBsZW5ndGggPSBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2lvcy52aWV3Q29udHJvbGxlcnMgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb250cm9sbGVycyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhDYXBhY2l0eShsZW5ndGgpO1xuICAgICAgICB2YXIgc3RhdGVzID0gZ2V0VGl0bGVBdHRyaWJ1dGVzRm9yU3RhdGVzKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy50YWJTdHJpcCkge1xuICAgICAgICAgICAgdGhpcy50YWJTdHJpcC5zZXROYXRpdmVWaWV3KHRoaXMuX2lvcy50YWJCYXIpO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICAgIHZhciBjb250cm9sbGVyID0gX3RoaXMuZ2V0Vmlld0NvbnRyb2xsZXIoaXRlbSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMudGFiU3RyaXAgJiYgX3RoaXMudGFiU3RyaXAuaXRlbXMgJiYgX3RoaXMudGFiU3RyaXAuaXRlbXNbaV0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFiU3RyaXBJdGVtID0gX3RoaXMudGFiU3RyaXAuaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIHRhYkJhckl0ZW0gPSBfdGhpcy5jcmVhdGVUYWJCYXJJdGVtKHRhYlN0cmlwSXRlbSwgaSk7XG4gICAgICAgICAgICAgICAgdXBkYXRlVGl0bGVBbmRJY29uUG9zaXRpb25zKHRhYlN0cmlwSXRlbSwgdGFiQmFySXRlbSwgY29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgYXBwbHlTdGF0ZXNUb0l0ZW0odGFiQmFySXRlbSwgc3RhdGVzKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnRhYkJhckl0ZW0gPSB0YWJCYXJJdGVtO1xuICAgICAgICAgICAgICAgIHRhYlN0cmlwSXRlbS5pbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgdGFiU3RyaXBJdGVtLnNldE5hdGl2ZVZpZXcodGFiQmFySXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250cm9sbGVycy5hZGRPYmplY3QoY29udHJvbGxlcik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzID0gY29udHJvbGxlcnM7XG4gICAgICAgIHRoaXMuX2lvcy5jdXN0b21pemFibGVWaWV3Q29udHJvbGxlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pb3MubW9yZU5hdmlnYXRpb25Db250cm9sbGVyLmRlbGVnYXRlID0gdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGU7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5jcmVhdGVUYWJCYXJJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIHZhciBpbWFnZTtcbiAgICAgICAgdmFyIHRpdGxlO1xuICAgICAgICBpbWFnZSA9IHRoaXMuX2dldEljb24oaXRlbSk7XG4gICAgICAgIHRpdGxlID0gaXRlbS5sYWJlbCA/IGl0ZW0ubGFiZWwudGV4dCA6IGl0ZW0udGl0bGU7XG4gICAgICAgIHZhciB0YWJCYXJJdGVtID0gVUlUYWJCYXJJdGVtLmFsbG9jKCkuaW5pdFdpdGhUaXRsZUltYWdlVGFnKHRpdGxlLCBpbWFnZSwgaW5kZXgpO1xuICAgICAgICByZXR1cm4gdGFiQmFySXRlbTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlLl9nZXRJY29uUmVuZGVyaW5nTW9kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfTtcbiAgICBCb3R0b21OYXZpZ2F0aW9uLnByb3RvdHlwZS5fZ2V0SWNvbiA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0pIHtcbiAgICAgICAgdmFyIGljb25Tb3VyY2UgPSB0YWJTdHJpcEl0ZW0uaW1hZ2UgPyB0YWJTdHJpcEl0ZW0uaW1hZ2Uuc3JjIDogdGFiU3RyaXBJdGVtLmljb25Tb3VyY2U7XG4gICAgICAgIGlmICghaWNvblNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlID0gdGhpcy5faWNvbnNDYWNoZVtpY29uU291cmNlXTtcbiAgICAgICAgaWYgKCFpbWFnZSkge1xuICAgICAgICAgICAgdmFyIGlzID0gbmV3IGltYWdlX3NvdXJjZV8xLkltYWdlU291cmNlO1xuICAgICAgICAgICAgaWYgKHV0aWxzXzEuaXNGb250SWNvblVSSShpY29uU291cmNlKSkge1xuICAgICAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSBpY29uU291cmNlLnNwbGl0KFwiLy9cIilbMV07XG4gICAgICAgICAgICAgICAgdmFyIGZvbnQgPSB0YWJTdHJpcEl0ZW0uc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IHRhYlN0cmlwSXRlbS5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgICAgICBpcyA9IGltYWdlX3NvdXJjZV8xLmZyb21Gb250SWNvbkNvZGUoZm9udEljb25Db2RlLCBmb250LCBjb2xvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpcyA9IGltYWdlX3NvdXJjZV8xLmZyb21GaWxlT3JSZXNvdXJjZShpY29uU291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpcyAmJiBpcy5pb3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxSZW5kZXJlZEltYWdlID0gaXMuaW9zLmltYWdlV2l0aFJlbmRlcmluZ01vZGUodGhpcy5fZ2V0SWNvblJlbmRlcmluZ01vZGUoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5faWNvbnNDYWNoZVtpY29uU291cmNlXSA9IG9yaWdpbmFsUmVuZGVyZWRJbWFnZTtcbiAgICAgICAgICAgICAgICBpbWFnZSA9IG9yaWdpbmFsUmVuZGVyZWRJbWFnZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbWFnZTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgPiAtMSkge1xuICAgICAgICAgICAgdGhpcy5faW9zLl93aWxsU2VsZWN0Vmlld0NvbnRyb2xsZXIgPSB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzW3ZhbHVlXTtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5zZWxlY3RlZEluZGV4ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24ucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRWaWV3Q29udHJvbGxlcnModmFsdWUpO1xuICAgICAgICB0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIEJvdHRvbU5hdmlnYXRpb24gPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJCb3R0b21OYXZpZ2F0aW9uXCIpXG4gICAgXSwgQm90dG9tTmF2aWdhdGlvbik7XG4gICAgcmV0dXJuIEJvdHRvbU5hdmlnYXRpb247XG59KHRhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5UYWJOYXZpZ2F0aW9uQmFzZSkpO1xuZXhwb3J0cy5Cb3R0b21OYXZpZ2F0aW9uID0gQm90dG9tTmF2aWdhdGlvbjtcbmZ1bmN0aW9uIGdldFRpdGxlQXR0cmlidXRlc0ZvclN0YXRlcyh2aWV3KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIgZGVmYXVsdFRhYkl0ZW1Gb250U2l6ZSA9IDEwO1xuICAgIHZhciB0YWJJdGVtRm9udFNpemUgPSB2aWV3LnN0eWxlLmZvbnRTaXplIHx8IGRlZmF1bHRUYWJJdGVtRm9udFNpemU7XG4gICAgdmFyIGZvbnQgPSB2aWV3LnN0eWxlLmZvbnRJbnRlcm5hbC5nZXRVSUZvbnQoVUlGb250LnN5c3RlbUZvbnRPZlNpemUodGFiSXRlbUZvbnRTaXplKSk7XG4gICAgdmFyIHRhYkl0ZW1UZXh0Q29sb3IgPSB2aWV3LnN0eWxlLmNvbG9yO1xuICAgIHZhciB0ZXh0Q29sb3IgPSB0YWJJdGVtVGV4dENvbG9yIGluc3RhbmNlb2YgY29sb3JfMS5Db2xvciA/IHRhYkl0ZW1UZXh0Q29sb3IuaW9zIDogbnVsbDtcbiAgICByZXN1bHQubm9ybWFsU3RhdGUgPSAoX2EgPSB7fSwgX2FbTlNGb250QXR0cmlidXRlTmFtZV0gPSBmb250LCBfYSk7XG4gICAgaWYgKHRleHRDb2xvcikge1xuICAgICAgICByZXN1bHQubm9ybWFsU3RhdGVbVUlUZXh0QXR0cmlidXRlVGV4dENvbG9yXSA9IHRleHRDb2xvcjtcbiAgICB9XG4gICAgdmFyIHRhYlNlbGVjdGVkSXRlbVRleHRDb2xvciA9IHZpZXcuc3R5bGUuY29sb3I7XG4gICAgdmFyIHNlbGVjdGVkVGV4dENvbG9yID0gdGFiU2VsZWN0ZWRJdGVtVGV4dENvbG9yIGluc3RhbmNlb2YgY29sb3JfMS5Db2xvciA/IHRhYlNlbGVjdGVkSXRlbVRleHRDb2xvci5pb3MgOiBudWxsO1xuICAgIHJlc3VsdC5zZWxlY3RlZFN0YXRlID0gKF9iID0ge30sIF9iW05TRm9udEF0dHJpYnV0ZU5hbWVdID0gZm9udCwgX2IpO1xuICAgIGlmIChzZWxlY3RlZFRleHRDb2xvcikge1xuICAgICAgICByZXN1bHQuc2VsZWN0ZWRTdGF0ZVtVSVRleHRBdHRyaWJ1dGVUZXh0Q29sb3JdID0gc2VsZWN0ZWRUZXh0Q29sb3I7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBhcHBseVN0YXRlc1RvSXRlbShpdGVtLCBzdGF0ZXMpIHtcbiAgICBpZiAoIXN0YXRlcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGl0ZW0uc2V0VGl0bGVUZXh0QXR0cmlidXRlc0ZvclN0YXRlKHN0YXRlcy5ub3JtYWxTdGF0ZSwgMCk7XG4gICAgaXRlbS5zZXRUaXRsZVRleHRBdHRyaWJ1dGVzRm9yU3RhdGUoc3RhdGVzLnNlbGVjdGVkU3RhdGUsIDQpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Ym90dG9tLW5hdmlnYXRpb24uaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBleHByZXNzaW9uU3ltYm9sc1JlZ2V4ID0gL1tcXCtcXC1cXCpcXC8lXFw/Ojw+PSFcXHwmXFwoXFwpXn5dLztcbnZhciBiaW5kaW5nQ29uc3RhbnRzO1xuKGZ1bmN0aW9uIChiaW5kaW5nQ29uc3RhbnRzKSB7XG4gICAgYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eSA9IFwic291cmNlUHJvcGVydHlcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnRhcmdldFByb3BlcnR5ID0gXCJ0YXJnZXRQcm9wZXJ0eVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMuZXhwcmVzc2lvbiA9IFwiZXhwcmVzc2lvblwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMudHdvV2F5ID0gXCJ0d29XYXlcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZSA9IFwic291cmNlXCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5iaW5kaW5nVmFsdWVLZXkgPSBcIiR2YWx1ZVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMucGFyZW50VmFsdWVLZXkgPSBcIiRwYXJlbnRcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnBhcmVudHNWYWx1ZUtleSA9IFwiJHBhcmVudHNcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLm5ld1Byb3BlcnR5VmFsdWVLZXkgPSBcIiRuZXdQcm9wZXJ0eVZhbHVlXCI7XG59KShiaW5kaW5nQ29uc3RhbnRzID0gZXhwb3J0cy5iaW5kaW5nQ29uc3RhbnRzIHx8IChleHBvcnRzLmJpbmRpbmdDb25zdGFudHMgPSB7fSkpO1xudmFyIGhhc0VxdWFsU2lnblJlZ2V4ID0gLz0rLztcbnZhciBlcXVhbFNpZ25Db21wYXJpc2lvbk9wZXJhdG9yc1JlZ2V4ID0gLyg9PXw9PT18Pj18PD18IT18IT09KS87XG5leHBvcnRzLnBhcmVudHNSZWdleCA9IC9cXCRwYXJlbnRzXFxzKlxcW1xccyooWydcIl0qKVxcdypcXDFcXHMqXFxdL2c7XG5mdW5jdGlvbiBpc05hbWVkUGFyYW0odmFsdWUpIHtcbiAgICB2YXIgZXF1YWxTaWduSW5kZXggPSB2YWx1ZS5zZWFyY2goaGFzRXF1YWxTaWduUmVnZXgpO1xuICAgIGlmIChlcXVhbFNpZ25JbmRleCA+IC0xKSB7XG4gICAgICAgIHZhciBlcXVhbFNpZ25TdXJyb3VuZCA9IHZhbHVlLnN1YnN0cihlcXVhbFNpZ25JbmRleCA+IDAgPyBlcXVhbFNpZ25JbmRleCAtIDEgOiAwLCAzKTtcbiAgICAgICAgaWYgKGVxdWFsU2lnblN1cnJvdW5kLnNlYXJjaChlcXVhbFNpZ25Db21wYXJpc2lvbk9wZXJhdG9yc1JlZ2V4KSA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGFyZU5hbWVkUGFyYW1zKHBhcmFtcykge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChpc05hbWVkUGFyYW0ocGFyYW1zW2ldKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxudmFyIG5hbWVkUGFyYW1Db25zdGFudHMgPSB7XG4gICAgcHJvcE5hbWU6IFwicHJvcE5hbWVcIixcbiAgICBwcm9wVmFsdWU6IFwicHJvcFZhbHVlXCJcbn07XG5mdW5jdGlvbiBnZXRQcm9wZXJ0eU5hbWVWYWx1ZVBhaXIocGFyYW0sIGtub3duT3B0aW9ucywgY2FsbGJhY2spIHtcbiAgICB2YXIgbmFtZVZhbHVlUGFpciA9IHt9O1xuICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBwYXJhbS5zdWJzdHIoMCwgcGFyYW0uaW5kZXhPZihcIj1cIikpLnRyaW0oKTtcbiAgICB2YXIgcHJvcGVydHlWYWx1ZSA9IHBhcmFtLnN1YnN0cihwYXJhbS5pbmRleE9mKFwiPVwiKSArIDEpLnRyaW0oKTtcbiAgICBpZiAoa25vd25PcHRpb25zKSB7XG4gICAgICAgIGlmICghcHJvcGVydHlOYW1lKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eU5hbWUgPSBrbm93bk9wdGlvbnMuZGVmYXVsdFByb3BlcnR5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcHJvcGVydHlOYW1lID0gcHJvcGVydHlOYW1lIGluIGtub3duT3B0aW9ucyA/IHByb3BlcnR5TmFtZSA6IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHByb3BlcnR5TmFtZSkge1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIG5hbWVWYWx1ZVBhaXIgPSBjYWxsYmFjayhwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BOYW1lXSA9IHByb3BlcnR5TmFtZTtcbiAgICAgICAgICAgIG5hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdID0gcHJvcGVydHlWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZVZhbHVlUGFpcjtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBwYXJzZU5hbWVkUHJvcGVydGllcyhwYXJhbWV0ZXJMaXN0LCBrbm93bk9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIHZhciBuYW1lVmFsdWVQYWlyO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1ldGVyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBuYW1lVmFsdWVQYWlyID0gZ2V0UHJvcGVydHlOYW1lVmFsdWVQYWlyKHBhcmFtZXRlckxpc3RbaV0sIGtub3duT3B0aW9ucywgY2FsbGJhY2spO1xuICAgICAgICBpZiAobmFtZVZhbHVlUGFpcikge1xuICAgICAgICAgICAgcmVzdWx0W25hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wTmFtZV1dID0gbmFtZVZhbHVlUGFpcltuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGdldFBhcmFtc0FycmF5KHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBza2lwQ29tbWEgPSAwO1xuICAgIHZhciBpbmRleFJlYWNoZWQgPSAwO1xuICAgIHZhciBzaW5nbGVRdW90ZUJsb2NrID0gZmFsc2U7XG4gICAgdmFyIGRvdWJsZVF1b3RlQmxvY2sgPSBmYWxzZTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgIGRvdWJsZVF1b3RlQmxvY2sgPSAhZG91YmxlUXVvdGVCbG9jaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICBzaW5nbGVRdW90ZUJsb2NrID0gIXNpbmdsZVF1b3RlQmxvY2s7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIihcIiB8fCB2YWx1ZVtpXSA9PT0gXCJbXCIpIHtcbiAgICAgICAgICAgIHNraXBDb21tYSsrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCIpXCIgfHwgdmFsdWVbaV0gPT09IFwiXVwiKSB7XG4gICAgICAgICAgICBza2lwQ29tbWEtLTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiLFwiICYmIHNraXBDb21tYSA9PT0gMCAmJiAhKHNpbmdsZVF1b3RlQmxvY2sgfHwgZG91YmxlUXVvdGVCbG9jaykpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlLnN1YnN0cihpbmRleFJlYWNoZWQsIGkgLSBpbmRleFJlYWNoZWQpKTtcbiAgICAgICAgICAgIGluZGV4UmVhY2hlZCA9IGkgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKHZhbHVlLnN1YnN0cihpbmRleFJlYWNoZWQpKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gaXNFeHByZXNzaW9uKGV4cHJlc3Npb24pIHtcbiAgICBpZiAoZXhwcmVzc2lvbi5zZWFyY2goZXhwcmVzc2lvblN5bWJvbHNSZWdleCkgPiAtMSkge1xuICAgICAgICB2YXIgcGFyZW50c01hdGNoZXMgPSBleHByZXNzaW9uLm1hdGNoKGV4cG9ydHMucGFyZW50c1JlZ2V4KTtcbiAgICAgICAgaWYgKHBhcmVudHNNYXRjaGVzKSB7XG4gICAgICAgICAgICB2YXIgcmVzdE9mRXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uc3Vic3RyKGV4cHJlc3Npb24uaW5kZXhPZihwYXJlbnRzTWF0Y2hlc1swXSkgKyBwYXJlbnRzTWF0Y2hlc1swXS5sZW5ndGgpO1xuICAgICAgICAgICAgaWYgKCEocmVzdE9mRXhwcmVzc2lvbi5zZWFyY2goZXhwcmVzc2lvblN5bWJvbHNSZWdleCkgPiAtMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGdldEJpbmRpbmdPcHRpb25zKG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIG5hbWVkUGFyYW1zID0gW107XG4gICAgdmFyIHBhcmFtcyA9IGdldFBhcmFtc0FycmF5KHZhbHVlKTtcbiAgICBpZiAoIWFyZU5hbWVkUGFyYW1zKHBhcmFtcykpIHtcbiAgICAgICAgaWYgKHBhcmFtcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHZhciB0cmltbWVkVmFsdWUgPSBwYXJhbXNbMF0udHJpbSgpO1xuICAgICAgICAgICAgdmFyIHNvdXJjZVByb3AgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAoaXNFeHByZXNzaW9uKHRyaW1tZWRWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VQcm9wID0gYmluZGluZ0NvbnN0YW50cy5iaW5kaW5nVmFsdWVLZXk7XG4gICAgICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb24gKyBcIiA9IFwiICsgdHJpbW1lZFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNvdXJjZVByb3AgPSB0cmltbWVkVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHkgKyBcIiA9IFwiICsgc291cmNlUHJvcCk7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMudHdvV2F5ICsgXCIgPSB0cnVlXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5ICsgXCIgPSBcIiArIHBhcmFtc1swXS50cmltKCkpO1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb24gKyBcIiA9IFwiICsgcGFyYW1zWzFdLnRyaW0oKSk7XG4gICAgICAgICAgICB2YXIgdHdvV2F5ID0gcGFyYW1zWzJdID8gcGFyYW1zWzJdLnRvTG93ZXJDYXNlKCkudHJpbSgpID09PSBcInRydWVcIiA6IHRydWU7XG4gICAgICAgICAgICBuYW1lZFBhcmFtcy5wdXNoKGJpbmRpbmdDb25zdGFudHMudHdvV2F5ICsgXCIgPSBcIiArIHR3b1dheSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG5hbWVkUGFyYW1zID0gcGFyYW1zO1xuICAgIH1cbiAgICB2YXIgYmluZGluZ1Byb3BlcnR5SGFuZGxlciA9IGZ1bmN0aW9uIChwcm9wLCB2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BOYW1lXSA9IHByb3A7XG4gICAgICAgIGlmIChwcm9wID09PSBiaW5kaW5nQ29uc3RhbnRzLnR3b1dheSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBcInRydWVcIikge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV0gPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0W25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICB2YXIgYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzID0gcGFyc2VOYW1lZFByb3BlcnRpZXMobmFtZWRQYXJhbXMsIHhtbEJpbmRpbmdQcm9wZXJ0aWVzLCBiaW5kaW5nUHJvcGVydHlIYW5kbGVyKTtcbiAgICB2YXIgYmluZE9wdGlvbnMgPSB7XG4gICAgICAgIHRhcmdldFByb3BlcnR5OiBuYW1lXG4gICAgfTtcbiAgICBmb3IgKHZhciBwcm9wIGluIGJpbmRpbmdPcHRpb25zUGFyYW1ldGVycykge1xuICAgICAgICBpZiAoYmluZGluZ09wdGlvbnNQYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICAgICAgICBiaW5kT3B0aW9uc1twcm9wXSA9IGJpbmRpbmdPcHRpb25zUGFyYW1ldGVyc1twcm9wXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoYmluZE9wdGlvbnNbYmluZGluZ0NvbnN0YW50cy50d29XYXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgYmluZE9wdGlvbnNbYmluZGluZ0NvbnN0YW50cy50d29XYXldID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGJpbmRPcHRpb25zO1xufVxuZXhwb3J0cy5nZXRCaW5kaW5nT3B0aW9ucyA9IGdldEJpbmRpbmdPcHRpb25zO1xudmFyIHhtbEJpbmRpbmdQcm9wZXJ0aWVzID0ge1xuICAgIHNvdXJjZVByb3BlcnR5OiB0cnVlLFxuICAgIGV4cHJlc3Npb246IHRydWUsXG4gICAgdHdvV2F5OiB0cnVlLFxuICAgIHNvdXJjZTogdHJ1ZSxcbiAgICBkZWZhdWx0UHJvcGVydHk6IGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHlcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iaW5kaW5nLWJ1aWxkZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRlYnVnXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvZGVidWdcIik7XG52YXIgeG1sID0gcmVxdWlyZShcIi4uLy4uL3htbFwiKTtcbnZhciB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGNvbXBvbmVudF9idWlsZGVyXzEgPSByZXF1aXJlKFwiLi9jb21wb25lbnQtYnVpbGRlclwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xID0gcmVxdWlyZShcIi4uLy4uL21vZHVsZS1uYW1lLXJlc29sdmVyXCIpO1xudmFyIGlvcyA9IHBsYXRmb3JtXzEucGxhdGZvcm1OYW1lcy5pb3MudG9Mb3dlckNhc2UoKTtcbnZhciBhbmRyb2lkID0gcGxhdGZvcm1fMS5wbGF0Zm9ybU5hbWVzLmFuZHJvaWQudG9Mb3dlckNhc2UoKTtcbnZhciBkZWZhdWx0TmFtZVNwYWNlTWF0Y2hlciA9IC90bnNcXC54c2QkL2k7XG5mdW5jdGlvbiBwYXJzZSh2YWx1ZSwgY29udGV4dCkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gdmFsdWUoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHZhciBleHBvcnRzXzEgPSBjb250ZXh0ID8gZ2V0RXhwb3J0cyhjb250ZXh0KSA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGNvbXBvbmVudE1vZHVsZSA9IHBhcnNlSW50ZXJuYWwodmFsdWUsIGV4cG9ydHNfMSk7XG4gICAgICAgIHJldHVybiBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICB9XG59XG5leHBvcnRzLnBhcnNlID0gcGFyc2U7XG5mdW5jdGlvbiBwYXJzZU11bHRpcGxlVGVtcGxhdGVzKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIGR1bW15Q29tcG9uZW50ID0gXCI8TGlzdFZpZXc+PExpc3RWaWV3Lml0ZW1UZW1wbGF0ZXM+XCIgKyB2YWx1ZSArIFwiPC9MaXN0Vmlldy5pdGVtVGVtcGxhdGVzPjwvTGlzdFZpZXc+XCI7XG4gICAgcmV0dXJuIHBhcnNlSW50ZXJuYWwoZHVtbXlDb21wb25lbnQsIGNvbnRleHQpLmNvbXBvbmVudFtcIml0ZW1UZW1wbGF0ZXNcIl07XG59XG5leHBvcnRzLnBhcnNlTXVsdGlwbGVUZW1wbGF0ZXMgPSBwYXJzZU11bHRpcGxlVGVtcGxhdGVzO1xuZnVuY3Rpb24gbG9hZChwYXRoT3JPcHRpb25zLCBjb250ZXh0KSB7XG4gICAgdmFyIGNvbXBvbmVudE1vZHVsZTtcbiAgICBpZiAodHlwZW9mIHBhdGhPck9wdGlvbnMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUocGF0aE9yT3B0aW9ucyk7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBjb250ZXh0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IGxvYWRDdXN0b21Db21wb25lbnQocGF0aE9yT3B0aW9ucy5wYXRoLCBwYXRoT3JPcHRpb25zLm5hbWUsIHBhdGhPck9wdGlvbnMuYXR0cmlidXRlcywgcGF0aE9yT3B0aW9ucy5leHBvcnRzLCBwYXRoT3JPcHRpb25zLnBhZ2UsIHRydWUpO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlICYmIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG59XG5leHBvcnRzLmxvYWQgPSBsb2FkO1xuZXhwb3J0cy5jcmVhdGVWaWV3RnJvbUVudHJ5ID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImNyZWF0ZVZpZXdGcm9tRW50cnlcIiwgZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgaWYgKGVudHJ5LmNyZWF0ZSkge1xuICAgICAgICB2YXIgdmlldyA9IGVudHJ5LmNyZWF0ZSgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgVmlldyB3aXRoIGVudHJ5LmNyZWF0ZSgpIGZ1bmN0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9XG4gICAgZWxzZSBpZiAoZW50cnkubW9kdWxlTmFtZSkge1xuICAgICAgICB2YXIgbW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShlbnRyeS5tb2R1bGVOYW1lKTtcbiAgICAgICAgdmFyIHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiXCIpO1xuICAgICAgICB2YXIgbW9kdWxlRXhwb3J0cyA9IHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPyBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZENvZGVNb2R1bGVOYW1lLCB0cnVlKSA6IG51bGw7XG4gICAgICAgIGlmIChtb2R1bGVFeHBvcnRzICYmIG1vZHVsZUV4cG9ydHMuY3JlYXRlUGFnZSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBtb2R1bGVFeHBvcnRzLmNyZWF0ZVBhZ2UoKTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiY3NzXCIpO1xuICAgICAgICAgICAgaWYgKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgICAgIHZpZXcuYWRkQ3NzRmlsZShyZXNvbHZlZENzc01vZHVsZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY29tcG9uZW50TW9kdWxlID0gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIG1vZHVsZUV4cG9ydHMpO1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudFZpZXcgPSBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgIHJldHVybiBjb21wb25lbnRWaWV3O1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBsb2FkIHBhZ2UgWE1MIGZpbGUgZm9yIG1vZHVsZTogXCIgKyBlbnRyeS5tb2R1bGVOYW1lKTtcbn0pO1xuZnVuY3Rpb24gbG9hZEludGVybmFsKG1vZHVsZU5hbWUsIG1vZHVsZUV4cG9ydHMpIHtcbiAgICB2YXIgY29tcG9uZW50TW9kdWxlO1xuICAgIHZhciByZXNvbHZlZFhtbE1vZHVsZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJ4bWxcIik7XG4gICAgaWYgKHJlc29sdmVkWG1sTW9kdWxlKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRYbWxNb2R1bGUsIHRydWUpO1xuICAgICAgICBjb21wb25lbnRNb2R1bGUgPSBwYXJzZUludGVybmFsKHRleHQsIG1vZHVsZUV4cG9ydHMsIHJlc29sdmVkWG1sTW9kdWxlLCBtb2R1bGVOYW1lKTtcbiAgICB9XG4gICAgdmFyIGNvbXBvbmVudFZpZXcgPSBjb21wb25lbnRNb2R1bGUgJiYgY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICBpZiAoY29tcG9uZW50Vmlldykge1xuICAgICAgICBjb21wb25lbnRWaWV3LmV4cG9ydHMgPSBtb2R1bGVFeHBvcnRzO1xuICAgICAgICBjb21wb25lbnRWaWV3Ll9tb2R1bGVOYW1lID0gbW9kdWxlTmFtZTtcbiAgICB9XG4gICAgaWYgKCFjb21wb25lbnRNb2R1bGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIGxvYWQgY29tcG9uZW50IGZyb20gbW9kdWxlOiBcIiArIG1vZHVsZU5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlO1xufVxuZnVuY3Rpb24gbG9hZEN1c3RvbUNvbXBvbmVudChjb21wb25lbnROYW1lc3BhY2UsIGNvbXBvbmVudE5hbWUsIGF0dHJpYnV0ZXMsIGNvbnRleHQsIHBhcmVudFBhZ2UsIGlzUm9vdENvbXBvbmVudCwgbW9kdWxlTmFtZVBhdGgpIHtcbiAgICBpZiAoaXNSb290Q29tcG9uZW50ID09PSB2b2lkIDApIHsgaXNSb290Q29tcG9uZW50ID0gdHJ1ZTsgfVxuICAgIGlmICghcGFyZW50UGFnZSAmJiBjb250ZXh0KSB7XG4gICAgICAgIHBhcmVudFBhZ2UgPSBjb250ZXh0W1wiX3BhcmVudFBhZ2VcIl07XG4gICAgICAgIGRlbGV0ZSBjb250ZXh0W1wiX3BhcmVudFBhZ2VcIl07XG4gICAgfVxuICAgIHZhciByZXN1bHQ7XG4gICAgY29tcG9uZW50TmFtZXNwYWNlID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKGNvbXBvbmVudE5hbWVzcGFjZSk7XG4gICAgdmFyIG1vZHVsZU5hbWUgPSBjb21wb25lbnROYW1lc3BhY2UgKyBcIi9cIiArIGNvbXBvbmVudE5hbWU7XG4gICAgdmFyIHJlc29sdmVkQ29kZU1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiXCIpO1xuICAgIHZhciByZXNvbHZlZFhtbE1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwieG1sXCIpO1xuICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiY3NzXCIpO1xuICAgIGlmIChyZXNvbHZlZFhtbE1vZHVsZU5hbWUpIHtcbiAgICAgICAgdmFyIHN1YkV4cG9ydHMgPSBjb250ZXh0O1xuICAgICAgICBpZiAocmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgc3ViRXhwb3J0cyA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkQ29kZU1vZHVsZU5hbWUsIHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3ViRXhwb3J0cykge1xuICAgICAgICAgICAgc3ViRXhwb3J0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIHN1YkV4cG9ydHNbXCJfcGFyZW50UGFnZVwiXSA9IHBhcmVudFBhZ2U7XG4gICAgICAgIHJlc3VsdCA9IGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBzdWJFeHBvcnRzKTtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNEZWZpbmVkKHJlc3VsdCkgJiYgdHlwZXNfMS5pc0RlZmluZWQocmVzdWx0LmNvbXBvbmVudCkgJiYgdHlwZXNfMS5pc0RlZmluZWQoYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGF0dHIgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudF9idWlsZGVyXzEuc2V0UHJvcGVydHlWYWx1ZShyZXN1bHQuY29tcG9uZW50LCBzdWJFeHBvcnRzLCBjb250ZXh0LCBhdHRyLCBhdHRyaWJ1dGVzW2F0dHJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gY29tcG9uZW50X2J1aWxkZXJfMS5nZXRDb21wb25lbnRNb2R1bGUoY29tcG9uZW50TmFtZSwgY29tcG9uZW50TmFtZXNwYWNlLCBhdHRyaWJ1dGVzLCBjb250ZXh0LCBtb2R1bGVOYW1lUGF0aCwgaXNSb290Q29tcG9uZW50KTtcbiAgICAgICAgaWYgKCFyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUoY29tcG9uZW50TmFtZXNwYWNlLCBcImNzc1wiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocGFyZW50UGFnZSAmJiByZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgcGFyZW50UGFnZS5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRFeHBvcnRzKGluc3RhbmNlKSB7XG4gICAgdmFyIGlzVmlldyA9ICEhaW5zdGFuY2UuX2RvbUlkO1xuICAgIGlmICghaXNWaWV3KSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZS5leHBvcnRzIHx8IGluc3RhbmNlO1xuICAgIH1cbiAgICB2YXIgZXhwb3J0T2JqZWN0ID0gaW5zdGFuY2UuZXhwb3J0cztcbiAgICB2YXIgcGFyZW50ID0gaW5zdGFuY2UucGFyZW50O1xuICAgIHdoaWxlIChleHBvcnRPYmplY3QgPT09IHVuZGVmaW5lZCAmJiBwYXJlbnQpIHtcbiAgICAgICAgZXhwb3J0T2JqZWN0ID0gcGFyZW50LmV4cG9ydHM7XG4gICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgfVxuICAgIHJldHVybiBleHBvcnRPYmplY3Q7XG59XG5mdW5jdGlvbiBwYXJzZUludGVybmFsKHZhbHVlLCBjb250ZXh0LCB4bWxNb2R1bGUsIG1vZHVsZU5hbWUpIHtcbiAgICB2YXIgc3RhcnQ7XG4gICAgdmFyIHVpO1xuICAgIHZhciBlcnJvckZvcm1hdCA9IChkZWJ1Z18xLmRlYnVnICYmIHhtbE1vZHVsZSkgPyB4bWwydWkuU291cmNlRXJyb3JGb3JtYXQoeG1sTW9kdWxlKSA6IHhtbDJ1aS5Qb3NpdGlvbkVycm9yRm9ybWF0O1xuICAgIHZhciBjb21wb25lbnRTb3VyY2VUcmFja2VyID0gKGRlYnVnXzEuZGVidWcgJiYgeG1sTW9kdWxlKSA/IHhtbDJ1aS5Db21wb25lbnRTb3VyY2VUcmFja2VyKHhtbE1vZHVsZSkgOiBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICAoc3RhcnQgPSBuZXcgeG1sMnVpLlhtbFN0cmluZ1BhcnNlcihlcnJvckZvcm1hdCkpXG4gICAgICAgIC5waXBlKG5ldyB4bWwydWkuUGxhdGZvcm1GaWx0ZXIoKSlcbiAgICAgICAgLnBpcGUobmV3IHhtbDJ1aS5YbWxTdGF0ZVBhcnNlcih1aSA9IG5ldyB4bWwydWkuQ29tcG9uZW50UGFyc2VyKGNvbnRleHQsIGVycm9yRm9ybWF0LCBjb21wb25lbnRTb3VyY2VUcmFja2VyLCBtb2R1bGVOYW1lKSkpO1xuICAgIHN0YXJ0LnBhcnNlKHZhbHVlKTtcbiAgICByZXR1cm4gdWkucm9vdENvbXBvbmVudE1vZHVsZTtcbn1cbnZhciB4bWwydWk7XG4oZnVuY3Rpb24gKHhtbDJ1aSkge1xuICAgIHZhciBYbWxQcm9kdWNlckJhc2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYbWxQcm9kdWNlckJhc2UoKSB7XG4gICAgICAgIH1cbiAgICAgICAgWG1sUHJvZHVjZXJCYXNlLnByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gKG5leHQpIHtcbiAgICAgICAgICAgIHRoaXMuX25leHQgPSBuZXh0O1xuICAgICAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICAgIH07XG4gICAgICAgIFhtbFByb2R1Y2VyQmFzZS5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLl9uZXh0LnBhcnNlKGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sUHJvZHVjZXJCYXNlO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLlhtbFByb2R1Y2VyQmFzZSA9IFhtbFByb2R1Y2VyQmFzZTtcbiAgICB2YXIgWG1sU3RyaW5nUGFyc2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFhtbFN0cmluZ1BhcnNlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gWG1sU3RyaW5nUGFyc2VyKGVycm9yKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvciB8fCBQb3NpdGlvbkVycm9yRm9ybWF0O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIFhtbFN0cmluZ1BhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgeG1sUGFyc2VyID0gbmV3IHhtbC5YbWxQYXJzZXIoZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5uZXh0KGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvcihlLCBhcmdzLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSwgcCkge1xuICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yKGUsIHApO1xuICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB4bWxQYXJzZXIucGFyc2UodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sU3RyaW5nUGFyc2VyO1xuICAgIH0oWG1sUHJvZHVjZXJCYXNlKSk7XG4gICAgeG1sMnVpLlhtbFN0cmluZ1BhcnNlciA9IFhtbFN0cmluZ1BhcnNlcjtcbiAgICBmdW5jdGlvbiBQb3NpdGlvbkVycm9yRm9ybWF0KGUsIHApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBkZWJ1Z18xLlNjb3BlRXJyb3IoZSwgXCJQYXJzaW5nIFhNTCBhdCBcIiArIHAubGluZSArIFwiOlwiICsgcC5jb2x1bW4pO1xuICAgIH1cbiAgICB4bWwydWkuUG9zaXRpb25FcnJvckZvcm1hdCA9IFBvc2l0aW9uRXJyb3JGb3JtYXQ7XG4gICAgZnVuY3Rpb24gU291cmNlRXJyb3JGb3JtYXQodXJpKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgcCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHAgPyBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCBwLmxpbmUsIHAuY29sdW1uKSA6IG5ldyBkZWJ1Z18xLlNvdXJjZSh1cmksIC0xLCAtMSk7XG4gICAgICAgICAgICBlID0gbmV3IGRlYnVnXzEuU291cmNlRXJyb3IoZSwgc291cmNlLCBcIkJ1aWxkaW5nIFVJIGZyb20gWE1MLlwiKTtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9O1xuICAgIH1cbiAgICB4bWwydWkuU291cmNlRXJyb3JGb3JtYXQgPSBTb3VyY2VFcnJvckZvcm1hdDtcbiAgICBmdW5jdGlvbiBDb21wb25lbnRTb3VyY2VUcmFja2VyKHVyaSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNvbXBvbmVudCwgcCkge1xuICAgICAgICAgICAgaWYgKCFkZWJ1Z18xLlNvdXJjZS5nZXQoY29tcG9uZW50KSkge1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBwID8gbmV3IGRlYnVnXzEuU291cmNlKHVyaSwgcC5saW5lLCBwLmNvbHVtbikgOiBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCAtMSwgLTEpO1xuICAgICAgICAgICAgICAgIGRlYnVnXzEuU291cmNlLnNldChjb21wb25lbnQsIHNvdXJjZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIHhtbDJ1aS5Db21wb25lbnRTb3VyY2VUcmFja2VyID0gQ29tcG9uZW50U291cmNlVHJhY2tlcjtcbiAgICB2YXIgUGxhdGZvcm1GaWx0ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoUGxhdGZvcm1GaWx0ZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFBsYXRmb3JtRmlsdGVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIFBsYXRmb3JtRmlsdGVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFBsYXRmb3JtRmlsdGVyLmlzUGxhdGZvcm0oYXJncy5lbGVtZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWxyZWFkeSBpbiAnXCIgKyB0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgKyBcIicgcGxhdGZvcm0gY29udGV4dCBhbmQgY2Fubm90IHN3aXRjaCB0byAnXCIgKyBhcmdzLmVsZW1lbnROYW1lICsgXCInIHBsYXRmb3JtISBQbGF0Zm9ybSB0YWdzIGNhbm5vdCBiZSBuZXN0ZWQuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCA9IGFyZ3MuZWxlbWVudE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChQbGF0Zm9ybUZpbHRlci5pc1BsYXRmb3JtKGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgJiYgIVBsYXRmb3JtRmlsdGVyLmlzQ3VyZW50UGxhdGZvcm0odGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dChhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgUGxhdGZvcm1GaWx0ZXIuaXNQbGF0Zm9ybSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRvTG93ZXIgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0b0xvd2VyID09PSBhbmRyb2lkIHx8IHRvTG93ZXIgPT09IGlvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgUGxhdGZvcm1GaWx0ZXIuaXNDdXJlbnRQbGF0Zm9ybSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlICYmIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IHBsYXRmb3JtXzEuZGV2aWNlLm9zLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBQbGF0Zm9ybUZpbHRlcjtcbiAgICB9KFhtbFByb2R1Y2VyQmFzZSkpO1xuICAgIHhtbDJ1aS5QbGF0Zm9ybUZpbHRlciA9IFBsYXRmb3JtRmlsdGVyO1xuICAgIHZhciBYbWxBcmdzUmVwbGF5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFhtbEFyZ3NSZXBsYXksIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFhtbEFyZ3NSZXBsYXkoYXJncywgZXJyb3JGb3JtYXQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5hcmdzID0gYXJncztcbiAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3JGb3JtYXQ7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgWG1sQXJnc1JlcGxheS5wcm90b3R5cGUucmVwbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuYXJncy5mb3JFYWNoKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubmV4dChhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3IoZSwgYXJncy5wb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBYbWxBcmdzUmVwbGF5O1xuICAgIH0oWG1sUHJvZHVjZXJCYXNlKSk7XG4gICAgeG1sMnVpLlhtbEFyZ3NSZXBsYXkgPSBYbWxBcmdzUmVwbGF5O1xuICAgIHZhciBYbWxTdGF0ZVBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhtbFN0YXRlUGFyc2VyKHN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgICAgIH1cbiAgICAgICAgWG1sU3RhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSB0aGlzLnN0YXRlLnBhcnNlKGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sU3RhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuWG1sU3RhdGVQYXJzZXIgPSBYbWxTdGF0ZVBhcnNlcjtcbiAgICB2YXIgVGVtcGxhdGVQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBUZW1wbGF0ZVBhcnNlcihwYXJlbnQsIHRlbXBsYXRlUHJvcGVydHksIHNldFRlbXBsYXRlUHJvcGVydHkpIHtcbiAgICAgICAgICAgIGlmIChzZXRUZW1wbGF0ZVByb3BlcnR5ID09PSB2b2lkIDApIHsgc2V0VGVtcGxhdGVQcm9wZXJ0eSA9IHRydWU7IH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy5fY29udGV4dCA9IHRlbXBsYXRlUHJvcGVydHkuY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMuX3JlY29yZGVkWG1sU3RyZWFtID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5ID0gdGVtcGxhdGVQcm9wZXJ0eTtcbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zZXRUZW1wbGF0ZVByb3BlcnR5ID0gc2V0VGVtcGxhdGVQcm9wZXJ0eTtcbiAgICAgICAgfVxuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VTdGFydEVsZW1lbnQoYXJncy5wcmVmaXgsIGFyZ3MubmFtZXNwYWNlLCBhcmdzLmVsZW1lbnROYW1lLCBhcmdzLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VFbmRFbGVtZW50KGFyZ3MucHJlZml4LCBhcmdzLmVsZW1lbnROYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZGVkWG1sU3RyZWFtLnB1c2goYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdGUgPT09IDIgPyB0aGlzLnBhcmVudCA6IHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUsIFwiZWxlbWVudE5hbWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkuZWxlbWVudE5hbWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlU3RhcnRFbGVtZW50ID0gZnVuY3Rpb24gKHByZWZpeCwgbmFtZXNwYWNlLCBlbGVtZW50TmFtZSwgYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fc3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUZW1wbGF0ZSBtdXN0IGhhdmUgZXhhY3RseSBvbmUgcm9vdCBlbGVtZW50IGJ1dCBtdWx0aXBsZSBlbGVtZW50cyB3ZXJlIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbCsrO1xuICAgICAgICB9O1xuICAgICAgICBUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUucGFyc2VFbmRFbGVtZW50ID0gZnVuY3Rpb24gKHByZWZpeCwgZWxlbWVudE5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRlbXBsYXRlIG11c3QgaGF2ZSBleGFjdGx5IG9uZSByb290IGVsZW1lbnQgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX3N0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gbW9yZSBjbG9zaW5nIGVsZW1lbnRzIGV4cGVjdGVkIGZvciB0aGlzIHRlbXBsYXRlLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX25lc3RpbmdMZXZlbC0tO1xuICAgICAgICAgICAgaWYgKHRoaXMuX25lc3RpbmdMZXZlbCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gMjtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2V0VGVtcGxhdGVQcm9wZXJ0eSAmJiB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5Lm5hbWUgaW4gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5wYXJlbnQuY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuYnVpbGRUZW1wbGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LnBhcmVudC5jb21wb25lbnRbdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5uYW1lXSA9IHRlbXBsYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLmJ1aWxkVGVtcGxhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzLl9jb250ZXh0O1xuICAgICAgICAgICAgdmFyIGVycm9yRm9ybWF0ID0gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5lcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHZhciBzb3VyY2VUcmFja2VyID0gdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5zb3VyY2VUcmFja2VyO1xuICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlRlbXBsYXRlKClcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydDtcbiAgICAgICAgICAgICAgICB2YXIgdWk7XG4gICAgICAgICAgICAgICAgKHN0YXJ0ID0gbmV3IHhtbDJ1aS5YbWxBcmdzUmVwbGF5KF90aGlzLl9yZWNvcmRlZFhtbFN0cmVhbSwgZXJyb3JGb3JtYXQpKVxuICAgICAgICAgICAgICAgICAgICAucGlwZShuZXcgWG1sU3RhdGVQYXJzZXIodWkgPSBuZXcgQ29tcG9uZW50UGFyc2VyKGNvbnRleHQsIGVycm9yRm9ybWF0LCBzb3VyY2VUcmFja2VyKSkpO1xuICAgICAgICAgICAgICAgIHN0YXJ0LnJlcGxheSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1aS5yb290Q29tcG9uZW50TW9kdWxlLmNvbXBvbmVudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVGVtcGxhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuVGVtcGxhdGVQYXJzZXIgPSBUZW1wbGF0ZVBhcnNlcjtcbiAgICB2YXIgTXVsdGlUZW1wbGF0ZVBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIE11bHRpVGVtcGxhdGVQYXJzZXIocGFyZW50LCB0ZW1wbGF0ZVByb3BlcnR5KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVQcm9wZXJ0eSA9IHRlbXBsYXRlUHJvcGVydHk7XG4gICAgICAgICAgICB0aGlzLl9jaGlsZFBhcnNlcnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTXVsdGlUZW1wbGF0ZVBhcnNlci5wcm90b3R5cGUsIFwidmFsdWVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl92YWx1ZTsgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE11bHRpVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQgJiYgYXJncy5lbGVtZW50TmFtZSA9PT0gXCJ0ZW1wbGF0ZVwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkUGFyc2VyID0gbmV3IFRlbXBsYXRlUGFyc2VyKHRoaXMsIHRoaXMudGVtcGxhdGVQcm9wZXJ0eSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGNoaWxkUGFyc2VyW1wia2V5XCJdID0gYXJncy5hdHRyaWJ1dGVzW1wia2V5XCJdO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkUGFyc2Vycy5wdXNoKGNoaWxkUGFyc2VyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGRQYXJzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lXzEgPSBDb21wb25lbnRQYXJzZXIuZ2V0Q29tcGxleFByb3BlcnR5TmFtZShhcmdzLmVsZW1lbnROYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAobmFtZV8xID09PSB0aGlzLnRlbXBsYXRlUHJvcGVydHkubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2hpbGRQYXJzZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLl9jaGlsZFBhcnNlcnNbaV1bXCJrZXlcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlVmlldzogdGhpcy5fY2hpbGRQYXJzZXJzW2ldLmJ1aWxkVGVtcGxhdGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSB0ZW1wbGF0ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5wYXJzZShhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE11bHRpVGVtcGxhdGVQYXJzZXI7XG4gICAgfSgpKTtcbiAgICB4bWwydWkuTXVsdGlUZW1wbGF0ZVBhcnNlciA9IE11bHRpVGVtcGxhdGVQYXJzZXI7XG4gICAgdmFyIENvbXBvbmVudFBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENvbXBvbmVudFBhcnNlcihjb250ZXh0LCBlcnJvckZvcm1hdCwgc291cmNlVHJhY2tlciwgbW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVOYW1lID0gbW9kdWxlTmFtZTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgdGhpcy5jb21wbGV4UHJvcGVydGllcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHJhY2tlciA9IHNvdXJjZVRyYWNrZXI7XG4gICAgICAgIH1cbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLnByb3RvdHlwZS5idWlsZENvbXBvbmVudCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5wcmVmaXggJiYgYXJncy5uYW1lc3BhY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbG9hZEN1c3RvbUNvbXBvbmVudChhcmdzLm5hbWVzcGFjZSwgYXJncy5lbGVtZW50TmFtZSwgYXJncy5hdHRyaWJ1dGVzLCB0aGlzLmNvbnRleHQsIHRoaXMuY3VycmVudFJvb3RWaWV3LCAhdGhpcy5jdXJyZW50Um9vdFZpZXcsIHRoaXMubW9kdWxlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZXNwYWNlID0gYXJncy5uYW1lc3BhY2U7XG4gICAgICAgICAgICAgICAgaWYgKGRlZmF1bHROYW1lU3BhY2VNYXRjaGVyLnRlc3QobmFtZXNwYWNlIHx8IFwiXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudF9idWlsZGVyXzEuZ2V0Q29tcG9uZW50TW9kdWxlKGFyZ3MuZWxlbWVudE5hbWUsIG5hbWVzcGFjZSwgYXJncy5hdHRyaWJ1dGVzLCB0aGlzLmNvbnRleHQsIHRoaXMubW9kdWxlTmFtZSwgIXRoaXMuY3VycmVudFJvb3RWaWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnRzW3RoaXMucGFyZW50cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHZhciBjb21wbGV4UHJvcGVydHkgPSB0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzW3RoaXMuY29tcGxleFByb3BlcnRpZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0NvbXBsZXhQcm9wZXJ0eShhcmdzLmVsZW1lbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZV8yID0gQ29tcG9uZW50UGFyc2VyLmdldENvbXBsZXhQcm9wZXJ0eU5hbWUoYXJncy5lbGVtZW50TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wbGV4UHJvcGVydHlfMSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZV8yLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleFByb3BlcnRpZXMucHVzaChjb21wbGV4UHJvcGVydHlfMSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNLbm93blRlbXBsYXRlKG5hbWVfMiwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFRlbXBsYXRlUGFyc2VyKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiAocGFyZW50ID8gZ2V0RXhwb3J0cyhwYXJlbnQuY29tcG9uZW50KSA6IG51bGwpIHx8IHRoaXMuY29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudE5hbWU6IGFyZ3MuZWxlbWVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVJdGVtczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JGb3JtYXQ6IHRoaXMuZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVHJhY2tlcjogdGhpcy5zb3VyY2VUcmFja2VyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzS25vd25NdWx0aVRlbXBsYXRlKG5hbWVfMiwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyc2VyID0gbmV3IE11bHRpVGVtcGxhdGVQYXJzZXIodGhpcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IChwYXJlbnQgPyBnZXRFeHBvcnRzKHBhcmVudC5jb21wb25lbnQpIDogbnVsbCkgfHwgdGhpcy5jb250ZXh0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudDogcGFyZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVfMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50TmFtZTogYXJncy5lbGVtZW50TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZUl0ZW1zOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckZvcm1hdDogdGhpcy5lcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUcmFja2VyOiB0aGlzLnNvdXJjZVRyYWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxleFByb3BlcnR5XzEucGFyc2VyID0gcGFyc2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnNlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudE1vZHVsZSA9IHRoaXMuYnVpbGRDb21wb25lbnQoYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVHJhY2tlcihjb21wb25lbnRNb2R1bGUuY29tcG9uZW50LCBhcmdzLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxleFByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbXBvbmVudFBhcnNlci5hZGRUb0NvbXBsZXhQcm9wZXJ0eShwYXJlbnQsIGNvbXBsZXhQcm9wZXJ0eSwgY29tcG9uZW50TW9kdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50LmNvbXBvbmVudC5fYWRkQ2hpbGRGcm9tQnVpbGRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKGFyZ3MuZWxlbWVudE5hbWUsIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGFyZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3RDb21wb25lbnRNb2R1bGUgPSBjb21wb25lbnRNb2R1bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdENvbXBvbmVudE1vZHVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRSb290VmlldyA9IHRoaXMucm9vdENvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSb290Vmlldy5leHBvcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmN1cnJlbnRSb290Vmlldy5leHBvcnRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnB1c2goY29tcG9uZW50TW9kdWxlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzQ29tcGxleFByb3BlcnR5KGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV4UHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wbGV4UHJvcGVydHkucGFyc2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXBvbmVudFtjb21wbGV4UHJvcGVydHkubmFtZV0gPSBjb21wbGV4UHJvcGVydHkucGFyc2VyLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50ICYmIHBhcmVudC5jb21wb25lbnQuX2FkZEFycmF5RnJvbUJ1aWxkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY29tcG9uZW50Ll9hZGRBcnJheUZyb21CdWlsZGVyKGNvbXBsZXhQcm9wZXJ0eS5uYW1lLCBjb21wbGV4UHJvcGVydHkuaXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXhQcm9wZXJ0eS5pdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleFByb3BlcnRpZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudHMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0NvbXBsZXhQcm9wZXJ0eSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZXNfMS5pc1N0cmluZyhuYW1lKSAmJiBuYW1lLmluZGV4T2YoXCIuXCIpICE9PSAtMTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmdldENvbXBsZXhQcm9wZXJ0eU5hbWUgPSBmdW5jdGlvbiAoZnVsbE5hbWUpIHtcbiAgICAgICAgICAgIHZhciBuYW1lO1xuICAgICAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoZnVsbE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWVzID0gZnVsbE5hbWUuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lc1tuYW1lcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuaXNLbm93blRlbXBsYXRlID0gZnVuY3Rpb24gKG5hbWUsIGV4cG9ydHMpIHtcbiAgICAgICAgICAgIHJldHVybiBDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVMgaW4gZXhwb3J0cyAmJiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFU10gJiYgbmFtZSBpbiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTlRFTVBMQVRFU107XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0tub3duTXVsdGlUZW1wbGF0ZSA9IGZ1bmN0aW9uIChuYW1lLCBleHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVMgaW4gZXhwb3J0cyAmJiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTXSAmJiBuYW1lIGluIGV4cG9ydHNbQ29tcG9uZW50UGFyc2VyLktOT1dOTVVMVElURU1QTEFURVNdO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuYWRkVG9Db21wbGV4UHJvcGVydHkgPSBmdW5jdGlvbiAocGFyZW50LCBjb21wbGV4UHJvcGVydHksIGVsZW1lbnRNb2R1bGUpIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRDb21wb25lbnQgPSBwYXJlbnQuY29tcG9uZW50O1xuICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0tub3duQ29sbGVjdGlvbihjb21wbGV4UHJvcGVydHkubmFtZSwgcGFyZW50LmV4cG9ydHMpKSB7XG4gICAgICAgICAgICAgICAgY29tcGxleFByb3BlcnR5Lml0ZW1zLnB1c2goZWxlbWVudE1vZHVsZS5jb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50Q29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50Ll9hZGRDaGlsZEZyb21CdWlsZGVyKGNvbXBsZXhQcm9wZXJ0eS5uYW1lLCBlbGVtZW50TW9kdWxlLmNvbXBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRDb21wb25lbnRbY29tcGxleFByb3BlcnR5Lm5hbWVdID0gZWxlbWVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5pc0tub3duQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChuYW1lLCBjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlMgaW4gY29udGV4dCAmJiBjb250ZXh0W0NvbXBvbmVudFBhcnNlci5LTk9XTkNPTExFQ1RJT05TXSAmJiBuYW1lIGluIGNvbnRleHRbQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlNdO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuS05PV05DT0xMRUNUSU9OUyA9IFwia25vd25Db2xsZWN0aW9uc1wiO1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVMgPSBcImtub3duVGVtcGxhdGVzXCI7XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTID0gXCJrbm93bk11bHRpVGVtcGxhdGVzXCI7XG4gICAgICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgICAgICBdLCBDb21wb25lbnRQYXJzZXIucHJvdG90eXBlLCBcImJ1aWxkQ29tcG9uZW50XCIsIG51bGwpO1xuICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLkNvbXBvbmVudFBhcnNlciA9IENvbXBvbmVudFBhcnNlcjtcbn0pKHhtbDJ1aSB8fCAoeG1sMnVpID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1aWxkZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGJpbmRhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS9iaW5kYWJsZVwiKTtcbnZhciBiaW5kaW5nX2J1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9iaW5kaW5nLWJ1aWxkZXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIHBsYXRmb3JtID0gcmVxdWlyZShcIi4uLy4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL21vZHVsZS1uYW1lLXJlc29sdmVyXCIpO1xudmFyIFVJX1BBVEggPSBcInVpL1wiO1xudmFyIE1PRFVMRVMgPSB7XG4gICAgXCJUYWJWaWV3SXRlbVwiOiBcInVpL3RhYi12aWV3XCIsXG4gICAgXCJUYWJTdHJpcFwiOiBcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwXCIsXG4gICAgXCJUYWJTdHJpcEl0ZW1cIjogXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcC1pdGVtXCIsXG4gICAgXCJUYWJDb250ZW50SXRlbVwiOiBcInVpL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLWNvbnRlbnQtaXRlbVwiLFxuICAgIFwiRm9ybWF0dGVkU3RyaW5nXCI6IFwidGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIsXG4gICAgXCJTcGFuXCI6IFwidGV4dC9zcGFuXCIsXG4gICAgXCJBY3Rpb25JdGVtXCI6IFwidWkvYWN0aW9uLWJhclwiLFxuICAgIFwiTmF2aWdhdGlvbkJ1dHRvblwiOiBcInVpL2FjdGlvbi1iYXJcIixcbiAgICBcIlNlZ21lbnRlZEJhckl0ZW1cIjogXCJ1aS9zZWdtZW50ZWQtYmFyXCIsXG59O1xudmFyIENPREVfRklMRSA9IFwiY29kZUZpbGVcIjtcbnZhciBDU1NfRklMRSA9IFwiY3NzRmlsZVwiO1xudmFyIElNUE9SVCA9IFwiaW1wb3J0XCI7XG52YXIgY3JlYXRlQ29tcG9uZW50SW5zdGFuY2UgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiY3JlYXRlQ29tcG9uZW50SW5zdGFuY2VcIiwgZnVuY3Rpb24gKGVsZW1lbnROYW1lLCBuYW1lc3BhY2UpIHtcbiAgICB2YXIgaW5zdGFuY2U7XG4gICAgdmFyIGluc3RhbmNlTW9kdWxlO1xuICAgIHZhciByZXNvbHZlZE1vZHVsZU5hbWU7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJlc29sdmVkTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobmFtZXNwYWNlLCBcIlwiKTtcbiAgICAgICAgICAgIGluc3RhbmNlTW9kdWxlID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRNb2R1bGVOYW1lLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmVkTW9kdWxlTmFtZSA9IE1PRFVMRVNbZWxlbWVudE5hbWVdIHx8IFVJX1BBVEggK1xuICAgICAgICAgICAgICAgIChlbGVtZW50TmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJsYXlvdXRcIikgIT09IC0xID8gXCJsYXlvdXRzL1wiIDogXCJcIikgK1xuICAgICAgICAgICAgICAgIGVsZW1lbnROYW1lLnNwbGl0KC8oPz1bQS1aXSkvKS5qb2luKFwiLVwiKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaW5zdGFuY2VNb2R1bGUgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZE1vZHVsZU5hbWUsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5zdGFuY2VUeXBlID0gaW5zdGFuY2VNb2R1bGVbZWxlbWVudE5hbWVdIHx8IE9iamVjdDtcbiAgICAgICAgaW5zdGFuY2UgPSBuZXcgaW5zdGFuY2VUeXBlKCk7XG4gICAgfVxuICAgIGNhdGNoIChleCkge1xuICAgICAgICB2YXIgZGVidWcgPSByZXF1aXJlKFwidXRpbHMvZGVidWdcIik7XG4gICAgICAgIHRocm93IG5ldyBkZWJ1Zy5TY29wZUVycm9yKGV4LCBcIk1vZHVsZSAnXCIgKyByZXNvbHZlZE1vZHVsZU5hbWUgKyBcIicgbm90IGZvdW5kIGZvciBlbGVtZW50ICdcIiArIChuYW1lc3BhY2UgPyBuYW1lc3BhY2UgKyBcIjpcIiA6IFwiXCIpICsgZWxlbWVudE5hbWUgKyBcIicuXCIpO1xuICAgIH1cbiAgICByZXR1cm4geyBpbnN0YW5jZTogaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlOiBpbnN0YW5jZU1vZHVsZSB9O1xufSk7XG52YXIgZ2V0Q29tcG9uZW50TW9kdWxlRXhwb3J0cyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJnZXRDb21wb25lbnRNb2R1bGVFeHBvcnRzXCIsIGZ1bmN0aW9uIChpbnN0YW5jZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcykge1xuICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBjb2RlRmlsZUF0dHJpYnV0ZSA9IGF0dHJpYnV0ZXNbQ09ERV9GSUxFXSB8fCBhdHRyaWJ1dGVzW0lNUE9SVF07XG4gICAgICAgIGlmIChjb2RlRmlsZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkQ29kZUZpbGVNb2R1bGUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShjb2RlRmlsZUF0dHJpYnV0ZSksIFwiXCIpO1xuICAgICAgICAgICAgaWYgKHJlc29sdmVkQ29kZUZpbGVNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICBtb2R1bGVFeHBvcnRzID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRDb2RlRmlsZU1vZHVsZSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZXhwb3J0cyA9IG1vZHVsZUV4cG9ydHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2RlIGZpbGUgd2l0aCBwYXRoIFxcXCJcIiArIGNvZGVGaWxlQXR0cmlidXRlICsgXCJcXFwiIGNhbm5vdCBiZSBmb3VuZCEgTG9va2luZyBmb3Igd2VicGFjayBtb2R1bGUgd2l0aCBuYW1lIFxcXCJcIiArIHJlc29sdmVkQ29kZUZpbGVNb2R1bGUgKyBcIlxcXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vZHVsZUV4cG9ydHM7XG59KTtcbnZhciBhcHBseUNvbXBvbmVudENzcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJhcHBseUNvbXBvbmVudENzc1wiLCBmdW5jdGlvbiAoaW5zdGFuY2UsIG1vZHVsZU5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICB2YXIgY3NzQXBwbGllZCA9IGZhbHNlO1xuICAgIGlmIChhdHRyaWJ1dGVzICYmIGF0dHJpYnV0ZXNbQ1NTX0ZJTEVdKSB7XG4gICAgICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShhdHRyaWJ1dGVzW0NTU19GSUxFXSksIFwiY3NzXCIpO1xuICAgICAgICBpZiAocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICBjc3NBcHBsaWVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNzcyBmaWxlIHdpdGggcGF0aCBcXFwiXCIgKyBhdHRyaWJ1dGVzW0NTU19GSUxFXSArIFwiXFxcIiBjYW5ub3QgYmUgZm91bmQhIExvb2tpbmcgZm9yIHdlYnBhY2sgbW9kdWxlIHdpdGggbmFtZSBcXFwiXCIgKyByZXNvbHZlZENzc01vZHVsZU5hbWUgKyBcIlxcXCJcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1vZHVsZU5hbWUgJiYgIWNzc0FwcGxpZWQpIHtcbiAgICAgICAgdmFyIHJlc29sdmVkQ3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Jlc29sdmVyXzEucmVzb2x2ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgXCJjc3NcIik7XG4gICAgICAgIGlmIChyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLmFkZENzc0ZpbGUocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xudmFyIGFwcGx5Q29tcG9uZW50QXR0cmlidXRlcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJhcHBseUNvbXBvbmVudEF0dHJpYnV0ZXNcIiwgZnVuY3Rpb24gKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcykge1xuICAgIGlmIChpbnN0YW5jZSAmJiBpbnN0YW5jZU1vZHVsZSkge1xuICAgICAgICBmb3IgKHZhciBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHZhciBhdHRyVmFsdWUgPSBhdHRyaWJ1dGVzW2F0dHJdO1xuICAgICAgICAgICAgaWYgKGF0dHIuaW5kZXhPZihcIjpcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBsYXRmb3JtTmFtZSA9IGF0dHIuc3BsaXQoXCI6XCIpWzBdLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBpZiAocGxhdGZvcm1OYW1lLnRvTG93ZXJDYXNlKCkgPT09IHBsYXRmb3JtLmRldmljZS5vcy50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHIgPSBhdHRyLnNwbGl0KFwiOlwiKVsxXS50cmltKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0ci5pbmRleE9mKFwiLlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViT2JqID0gaW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBhdHRyLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvcE5hbWUgPSBwcm9wZXJ0aWVzW3Byb3BlcnRpZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViT2JqICE9PSB1bmRlZmluZWQgJiYgc3ViT2JqICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJPYmogPSBzdWJPYmpbcHJvcGVydGllc1tpXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN1Yk9iaiAhPT0gdW5kZWZpbmVkICYmIHN1Yk9iaiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBzZXRQcm9wZXJ0eVZhbHVlKHN1Yk9iaiwgaW5zdGFuY2VNb2R1bGUsIG1vZHVsZUV4cG9ydHMsIHN1YlByb3BOYW1lLCBhdHRyVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldFByb3BlcnR5VmFsdWUoaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlLCBtb2R1bGVFeHBvcnRzLCBhdHRyLCBhdHRyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG5mdW5jdGlvbiBnZXRDb21wb25lbnRNb2R1bGUoZWxlbWVudE5hbWUsIG5hbWVzcGFjZSwgYXR0cmlidXRlcywgbW9kdWxlRXhwb3J0cywgbW9kdWxlTmFtZVBhdGgsIGlzUm9vdENvbXBvbmVudCkge1xuICAgIGVsZW1lbnROYW1lID0gZWxlbWVudE5hbWUuc3BsaXQoXCItXCIpLm1hcChmdW5jdGlvbiAocykgeyByZXR1cm4gc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zdWJzdHJpbmcoMSk7IH0pLmpvaW4oXCJcIik7XG4gICAgdmFyIF9hID0gY3JlYXRlQ29tcG9uZW50SW5zdGFuY2UoZWxlbWVudE5hbWUsIG5hbWVzcGFjZSksIGluc3RhbmNlID0gX2EuaW5zdGFuY2UsIGluc3RhbmNlTW9kdWxlID0gX2EuaW5zdGFuY2VNb2R1bGU7XG4gICAgbW9kdWxlRXhwb3J0cyA9IGdldENvbXBvbmVudE1vZHVsZUV4cG9ydHMoaW5zdGFuY2UsIG1vZHVsZUV4cG9ydHMsIGF0dHJpYnV0ZXMpO1xuICAgIGlmIChpc1Jvb3RDb21wb25lbnQpIHtcbiAgICAgICAgYXBwbHlDb21wb25lbnRDc3MoaW5zdGFuY2UsIG1vZHVsZU5hbWVQYXRoLCBhdHRyaWJ1dGVzKTtcbiAgICB9XG4gICAgYXBwbHlDb21wb25lbnRBdHRyaWJ1dGVzKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgYXR0cmlidXRlcyk7XG4gICAgdmFyIGNvbXBvbmVudE1vZHVsZTtcbiAgICBpZiAoaW5zdGFuY2UgJiYgaW5zdGFuY2VNb2R1bGUpIHtcbiAgICAgICAgY29tcG9uZW50TW9kdWxlID0geyBjb21wb25lbnQ6IGluc3RhbmNlLCBleHBvcnRzOiBpbnN0YW5jZU1vZHVsZSB9O1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlO1xufVxuZXhwb3J0cy5nZXRDb21wb25lbnRNb2R1bGUgPSBnZXRDb21wb25lbnRNb2R1bGU7XG5mdW5jdGlvbiBzZXRQcm9wZXJ0eVZhbHVlKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgZXhwb3J0cywgcHJvcGVydHlOYW1lLCBwcm9wZXJ0eVZhbHVlKSB7XG4gICAgaWYgKGlzQmluZGluZyhwcm9wZXJ0eVZhbHVlKSAmJiBpbnN0YW5jZS5iaW5kKSB7XG4gICAgICAgIHZhciBiaW5kT3B0aW9ucyA9IGJpbmRpbmdfYnVpbGRlcl8xLmdldEJpbmRpbmdPcHRpb25zKHByb3BlcnR5TmFtZSwgZ2V0QmluZGluZ0V4cHJlc3Npb25Gcm9tQXR0cmlidXRlKHByb3BlcnR5VmFsdWUpKTtcbiAgICAgICAgaW5zdGFuY2UuYmluZCh7XG4gICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eTogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eV0sXG4gICAgICAgICAgICB0YXJnZXRQcm9wZXJ0eTogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy50YXJnZXRQcm9wZXJ0eV0sXG4gICAgICAgICAgICBleHByZXNzaW9uOiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb25dLFxuICAgICAgICAgICAgdHdvV2F5OiBiaW5kT3B0aW9uc1tiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzLnR3b1dheV1cbiAgICAgICAgfSwgYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy5zb3VyY2VdKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYmluZGFibGVfMS5pc0V2ZW50T3JHZXN0dXJlKHByb3BlcnR5TmFtZSwgaW5zdGFuY2UpKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gZXhwb3J0cyAmJiBleHBvcnRzW3Byb3BlcnR5VmFsdWVdO1xuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgaW5zdGFuY2Uub24ocHJvcGVydHlOYW1lLCBoYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpc0tub3duRnVuY3Rpb24ocHJvcGVydHlOYW1lLCBpbnN0YW5jZSkgJiYgZXhwb3J0cyAmJiB0eXBlb2YgZXhwb3J0c1twcm9wZXJ0eVZhbHVlXSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGluc3RhbmNlW3Byb3BlcnR5TmFtZV0gPSBleHBvcnRzW3Byb3BlcnR5VmFsdWVdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5VmFsdWU7XG4gICAgfVxufVxuZXhwb3J0cy5zZXRQcm9wZXJ0eVZhbHVlID0gc2V0UHJvcGVydHlWYWx1ZTtcbmZ1bmN0aW9uIGdldEJpbmRpbmdFeHByZXNzaW9uRnJvbUF0dHJpYnV0ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKFwie3tcIiwgXCJcIikucmVwbGFjZShcIn19XCIsIFwiXCIpLnRyaW0oKTtcbn1cbmZ1bmN0aW9uIGlzQmluZGluZyh2YWx1ZSkge1xuICAgIHZhciBpc0JpbmRpbmc7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgc3RyID0gdmFsdWUudHJpbSgpO1xuICAgICAgICBpc0JpbmRpbmcgPSBzdHIuaW5kZXhPZihcInt7XCIpID09PSAwICYmIHN0ci5sYXN0SW5kZXhPZihcIn19XCIpID09PSBzdHIubGVuZ3RoIC0gMjtcbiAgICB9XG4gICAgcmV0dXJuIGlzQmluZGluZztcbn1cbnZhciBLTk9XTl9GVU5DVElPTlMgPSBcImtub3duRnVuY3Rpb25zXCI7XG5mdW5jdGlvbiBpc0tub3duRnVuY3Rpb24obmFtZSwgaW5zdGFuY2UpIHtcbiAgICByZXR1cm4gaW5zdGFuY2UuY29uc3RydWN0b3JcbiAgICAgICAgJiYgS05PV05fRlVOQ1RJT05TIGluIGluc3RhbmNlLmNvbnN0cnVjdG9yXG4gICAgICAgICYmIGluc3RhbmNlLmNvbnN0cnVjdG9yW0tOT1dOX0ZVTkNUSU9OU10uaW5kZXhPZihuYW1lKSAhPT0gLTE7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb21wb25lbnQtYnVpbGRlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBzYW5pdGl6ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSwgcmVtb3ZlRXh0ZW5zaW9uKSB7XG4gICAgaWYgKHJlbW92ZUV4dGVuc2lvbiA9PT0gdm9pZCAwKSB7IHJlbW92ZUV4dGVuc2lvbiA9IHRydWU7IH1cbiAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS50cmltKCk7XG4gICAgaWYgKG1vZHVsZU5hbWUuc3RhcnRzV2l0aChcIn4vXCIpKSB7XG4gICAgICAgIG1vZHVsZU5hbWUgPSBtb2R1bGVOYW1lLnN1YnN0cmluZygyKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobW9kdWxlTmFtZS5zdGFydHNXaXRoKFwiL1wiKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5zdWJzdHJpbmcoMSk7XG4gICAgfVxuICAgIGlmIChyZW1vdmVFeHRlbnNpb24pIHtcbiAgICAgICAgdmFyIGxhc3REb3QgPSBtb2R1bGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKTtcbiAgICAgICAgaWYgKGxhc3REb3QgPiAwKSB7XG4gICAgICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5zdWJzdHIoMCwgbGFzdERvdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vZHVsZU5hbWU7XG59XG5leHBvcnRzLnNhbml0aXplTW9kdWxlTmFtZSA9IHNhbml0aXplTW9kdWxlTmFtZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS1uYW1lLXNhbml0aXplci5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIikpO1xudmFyIEJ1dHRvbkJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhCdXR0b25CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJ1dHRvbkJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1dHRvbkJhc2UucHJvdG90eXBlLCBcInRleHRXcmFwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS53aGl0ZVNwYWNlID09PSBcIm5vcm1hbFwiO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlcih2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndoaXRlU3BhY2UgPSB2YWx1ZSA/IFwibm9ybWFsXCIgOiBcIm5vd3JhcFwiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCdXR0b25CYXNlLnRhcEV2ZW50ID0gXCJ0YXBcIjtcbiAgICBCdXR0b25CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHRleHRfYmFzZV8xLkNTU1R5cGUoXCJCdXR0b25cIilcbiAgICBdLCBCdXR0b25CYXNlKTtcbiAgICByZXR1cm4gQnV0dG9uQmFzZTtcbn0odGV4dF9iYXNlXzEuVGV4dEJhc2UpKTtcbmV4cG9ydHMuQnV0dG9uQmFzZSA9IEJ1dHRvbkJhc2U7XG5CdXR0b25CYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnV0dG9uLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbnRyb2xfc3RhdGVfY2hhbmdlXzEgPSByZXF1aXJlKFwiLi4vY29yZS9jb250cm9sLXN0YXRlLWNoYW5nZVwiKTtcbnZhciBidXR0b25fY29tbW9uXzEgPSByZXF1aXJlKFwiLi9idXR0b24tY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYnV0dG9uLWNvbW1vblwiKSk7XG52YXIgQnV0dG9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEJ1dHRvbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBCdXR0b24ucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSUJ1dHRvbi5idXR0b25XaXRoVHlwZSgxKTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRoaXMuX3RhcEhhbmRsZXIgPSBUYXBIYW5kbGVySW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRUYXJnZXRBY3Rpb25Gb3JDb250cm9sRXZlbnRzKHRoaXMuX3RhcEhhbmRsZXIsIFwidGFwXCIsIDY0KTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3RhcEhhbmRsZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQnV0dG9uLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEJ1dHRvbi5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLl9zdGF0ZUNoYW5nZWRIYW5kbGVyKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0ZUNoYW5nZWRIYW5kbGVyLnN0b3AoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5fdXBkYXRlQnV0dG9uU3RhdGVDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24gKHN1YnNjcmliZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoc3Vic2NyaWJlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3N0YXRlQ2hhbmdlZEhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZUNoYW5nZWRIYW5kbGVyID0gbmV3IGNvbnRyb2xfc3RhdGVfY2hhbmdlXzEuQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXIodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLCBmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKHMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VkSGFuZGxlci5zdGFydCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VkSGFuZGxlci5zdG9wKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlclRvcFdpZHRoUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzLnRvcCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIHRvcCA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IHRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy5yaWdodCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGluc2V0ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzO1xuICAgICAgICB2YXIgcmlnaHQgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGgpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMgPSB7IHRvcDogaW5zZXQudG9wLCBsZWZ0OiBpbnNldC5sZWZ0LCBib3R0b206IGluc2V0LmJvdHRvbSwgcmlnaHQ6IHJpZ2h0IH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy5ib3R0b20sXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciBib3R0b20gPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy5sZWZ0LFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIGxlZnQgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogbGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy50b3AsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIHRvcCA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IHRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzLnJpZ2h0LFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIHJpZ2h0ID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiByaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy5ib3R0b20sXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIGJvdHRvbSA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMubGVmdCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIGxlZnQgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogbGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEudGV4dEFsaWdubWVudFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGl0bGVMYWJlbC50ZXh0QWxpZ25tZW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEhvcml6b250YWxBbGlnbm1lbnQgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImluaXRpYWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGl0bGVMYWJlbC50ZXh0QWxpZ25tZW50ID0gMTtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEhvcml6b250YWxBbGlnbm1lbnQgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRpdGxlTGFiZWwudGV4dEFsaWdubWVudCA9IDI7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRIb3Jpem9udGFsQWxpZ25tZW50ID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEud2hpdGVTcGFjZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGl0bGVMYWJlbDtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcIm5vcm1hbFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGluZUJyZWFrTW9kZSA9IDA7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5udW1iZXJPZkxpbmVzID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJub3dyYXBcIjpcbiAgICAgICAgICAgIGNhc2UgXCJpbml0aWFsXCI6XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5saW5lQnJlYWtNb2RlID0gNTtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3Lm51bWJlck9mTGluZXMgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICBpZiAoIXRoaXMudGV4dFdyYXApIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLm9uTWVhc3VyZS5jYWxsKHRoaXMsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRNb2RlID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdmFyIGhvcml6b250YWxQYWRkaW5nID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgICAgICB2YXIgdmVydGljYWxQYWRkaW5nID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgICAgICBpZiAodmVydGljYWxQYWRkaW5nID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdmVydGljYWxQYWRkaW5nID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscygxMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGVzaXJlZFNpemUgPSBidXR0b25fY29tbW9uXzEubGF5b3V0Lm1lYXN1cmVOYXRpdmVWaWV3KG5hdGl2ZVZpZXcudGl0bGVMYWJlbCwgd2lkdGggLSBob3Jpem9udGFsUGFkZGluZywgd2lkdGhNb2RlLCBoZWlnaHQgLSB2ZXJ0aWNhbFBhZGRpbmcsIGhlaWdodE1vZGUpO1xuICAgICAgICAgICAgZGVzaXJlZFNpemUud2lkdGggPSBkZXNpcmVkU2l6ZS53aWR0aCArIGhvcml6b250YWxQYWRkaW5nO1xuICAgICAgICAgICAgZGVzaXJlZFNpemUuaGVpZ2h0ID0gZGVzaXJlZFNpemUuaGVpZ2h0ICsgdmVydGljYWxQYWRkaW5nO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KGRlc2lyZWRTaXplLndpZHRoLCB0aGlzLmVmZmVjdGl2ZU1pbldpZHRoKTtcbiAgICAgICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgoZGVzaXJlZFNpemUuaGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IGJ1dHRvbl9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IGJ1dHRvbl9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgYnV0dG9uX2NvbW1vbl8xLlBzZXVkb0NsYXNzSGFuZGxlcihcIm5vcm1hbFwiLCBcImhpZ2hsaWdodGVkXCIsIFwicHJlc3NlZFwiLCBcImFjdGl2ZVwiKVxuICAgIF0sIEJ1dHRvbi5wcm90b3R5cGUsIFwiX3VwZGF0ZUJ1dHRvblN0YXRlQ2hhbmdlSGFuZGxlclwiLCBudWxsKTtcbiAgICByZXR1cm4gQnV0dG9uO1xufShidXR0b25fY29tbW9uXzEuQnV0dG9uQmFzZSkpO1xuZXhwb3J0cy5CdXR0b24gPSBCdXR0b247XG52YXIgVGFwSGFuZGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYXBIYW5kbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYXBIYW5kbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYXBIYW5kbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gVGFwSGFuZGxlckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVGFwSGFuZGxlckltcGwucHJvdG90eXBlLnRhcCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIG93bmVyLl9lbWl0KGJ1dHRvbl9jb21tb25fMS5CdXR0b25CYXNlLnRhcEV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFwSGFuZGxlckltcGwuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcInRhcFwiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbaW50ZXJvcC50eXBlcy5pZF0gfVxuICAgIH07XG4gICAgcmV0dXJuIFRhcEhhbmRsZXJJbXBsO1xufShOU09iamVjdCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YnV0dG9uLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBDb250ZW50VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENvbnRlbnRWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENvbnRlbnRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250ZW50Vmlldy5wcm90b3R5cGUsIFwiY29udGVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgb2xkVmlldyA9IHRoaXMuX2NvbnRlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50ID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRDaGFuZ2VkKG9sZFZpZXcsIHZhbHVlKTtcbiAgICAgICAgICAgIGlmICh2aWV3XzEuaXNJT1MgJiYgb2xkVmlldyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRlbnRWaWV3LnByb3RvdHlwZSwgXCJsYXlvdXRWaWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RfMSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGVudC5fZWFjaExheW91dFZpZXcoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaXJzdF8xID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBjaGlsZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgbGF5b3V0IGNoaWxkIGluc2lkZSBhIENvbnRlbnRWaWV3XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udGVudFZpZXcucHJvdG90eXBlLCBcIl9jaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudCA/IDEgOiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBDb250ZW50Vmlldy5wcm90b3R5cGUuX29uQ29udGVudENoYW5nZWQgPSBmdW5jdGlvbiAob2xkVmlldywgbmV3Vmlldykge1xuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgY2FsbGJhY2soY29udGVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRlbnRWaWV3LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHZpZXdfMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCB0aGlzLmxheW91dFZpZXcsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoID0gdmlld18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB2aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSB2aWV3XzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChyZXN1bHQubWVhc3VyZWRXaWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgocmVzdWx0Lm1lYXN1cmVkSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSB2aWV3XzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVIZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgQ29udGVudFZpZXcucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2aWV3XzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aGlzLmxheW91dFZpZXcsIDAsIDAsIHJpZ2h0IC0gbGVmdCwgYm90dG9tIC0gdG9wKTtcbiAgICB9O1xuICAgIHJldHVybiBDb250ZW50Vmlldztcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuQ29udGVudFZpZXcgPSBDb250ZW50VmlldztcbkNvbnRlbnRWaWV3LnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udGVudC12aWV3LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vcHJvcGVydGllc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gb2JzZXJ2YWJsZV8xLk9ic2VydmFibGU7XG5leHBvcnRzLldyYXBwZWRWYWx1ZSA9IG9ic2VydmFibGVfMS5XcmFwcGVkVmFsdWU7XG52YXIgd2Vha19ldmVudF9saXN0ZW5lcl8xID0gcmVxdWlyZShcIi4uL3dlYWstZXZlbnQtbGlzdGVuZXJcIik7XG52YXIgYmluZGluZ19idWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlci9iaW5kaW5nLWJ1aWxkZXJcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3RyYWNlXCIpO1xuZXhwb3J0cy50cmFjZUVuYWJsZWQgPSB0cmFjZV8xLmlzRW5hYmxlZDtcbmV4cG9ydHMudHJhY2VXcml0ZSA9IHRyYWNlXzEud3JpdGU7XG5leHBvcnRzLnRyYWNlRXJyb3IgPSB0cmFjZV8xLmVycm9yO1xuZXhwb3J0cy50cmFjZUNhdGVnb3JpZXMgPSB0cmFjZV8xLmNhdGVnb3JpZXM7XG5leHBvcnRzLnRyYWNlTm90aWZ5RXZlbnQgPSB0cmFjZV8xLm5vdGlmeUV2ZW50O1xuZXhwb3J0cy5pc0NhdGVnb3J5U2V0ID0gdHJhY2VfMS5pc0NhdGVnb3J5U2V0O1xuZXhwb3J0cy50cmFjZU1lc3NhZ2VUeXBlID0gdHJhY2VfMS5tZXNzYWdlVHlwZTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBhcHBsaWNhdGlvbkNvbW1vbiA9IHJlcXVpcmUoXCIuLi8uLi8uLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcG9seW1lckV4cHJlc3Npb25zID0gcmVxdWlyZShcIi4uLy4uLy4uL2pzLWxpYnMvcG9seW1lci1leHByZXNzaW9uc1wiKTtcbnZhciBjb250ZXh0S2V5ID0gXCJjb250ZXh0XCI7XG52YXIgcGFyYW1zUmVnZXggPSAvXFxbXFxzKihbJ1wiXSkqKFxcdyopXFwxXFxzKlxcXS87XG52YXIgYmMgPSBiaW5kaW5nX2J1aWxkZXJfMS5iaW5kaW5nQ29uc3RhbnRzO1xudmFyIGVtcHR5QXJyYXkgPSBbXTtcbnZhciBwcm9wZXJ0aWVzQ2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGdldFByb3BlcnRpZXMocHJvcGVydHkpIHtcbiAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgIHJldHVybiBlbXB0eUFycmF5O1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gcHJvcGVydGllc0NhY2hlW3Byb3BlcnR5XTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZhciBwYXJlbnRzTWF0Y2hlcyA9IHByb3BlcnR5Lm1hdGNoKGJpbmRpbmdfYnVpbGRlcl8xLnBhcmVudHNSZWdleCk7XG4gICAgcmVzdWx0ID0gcHJvcGVydHkucmVwbGFjZShiaW5kaW5nX2J1aWxkZXJfMS5wYXJlbnRzUmVnZXgsIFwicGFyZW50c01hdGNoXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cXF0vZywgXCJcIilcbiAgICAgICAgLnNwbGl0KC9cXC58XFxbLyk7XG4gICAgdmFyIHBhcmVudHNNYXRjaGVzQ291bnRlciA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDAsIHJlc3VsdExlbmd0aCA9IHJlc3VsdC5sZW5ndGg7IGkgPCByZXN1bHRMZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocmVzdWx0W2ldID09PSBcInBhcmVudHNNYXRjaFwiKSB7XG4gICAgICAgICAgICByZXN1bHRbaV0gPSBwYXJlbnRzTWF0Y2hlc1twYXJlbnRzTWF0Y2hlc0NvdW50ZXIrK107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJvcGVydGllc0NhY2hlW3Byb3BlcnR5XSA9IHJlc3VsdDtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0RXZlbnRPckdlc3R1cmVOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4gbmFtZS5pbmRleE9mKFwib25cIikgPT09IDAgPyBuYW1lLnN1YnN0cigyLCBuYW1lLmxlbmd0aCAtIDIpIDogbmFtZTtcbn1cbmV4cG9ydHMuZ2V0RXZlbnRPckdlc3R1cmVOYW1lID0gZ2V0RXZlbnRPckdlc3R1cmVOYW1lO1xuZnVuY3Rpb24gaXNHZXN0dXJlKGV2ZW50T3JHZXN0dXJlTmFtZSkge1xuICAgIHZhciB0ID0gZXZlbnRPckdlc3R1cmVOYW1lLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiB0ID09PSBcInRhcFwiXG4gICAgICAgIHx8IHQgPT09IFwiZG91YmxldGFwXCJcbiAgICAgICAgfHwgdCA9PT0gXCJwaW5jaFwiXG4gICAgICAgIHx8IHQgPT09IFwicGFuXCJcbiAgICAgICAgfHwgdCA9PT0gXCJzd2lwZVwiXG4gICAgICAgIHx8IHQgPT09IFwicm90YXRpb25cIlxuICAgICAgICB8fCB0ID09PSBcImxvbmdwcmVzc1wiXG4gICAgICAgIHx8IHQgPT09IFwidG91Y2hcIjtcbn1cbmV4cG9ydHMuaXNHZXN0dXJlID0gaXNHZXN0dXJlO1xuZnVuY3Rpb24gaXNFdmVudE9yR2VzdHVyZShuYW1lLCB2aWV3KSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciBldmVudE9yR2VzdHVyZU5hbWUgPSBnZXRFdmVudE9yR2VzdHVyZU5hbWUobmFtZSk7XG4gICAgICAgIHZhciBldnQgPSBldmVudE9yR2VzdHVyZU5hbWUgKyBcIkV2ZW50XCI7XG4gICAgICAgIHJldHVybiB2aWV3LmNvbnN0cnVjdG9yICYmIGV2dCBpbiB2aWV3LmNvbnN0cnVjdG9yIHx8IGlzR2VzdHVyZShldmVudE9yR2VzdHVyZU5hbWUudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydHMuaXNFdmVudE9yR2VzdHVyZSA9IGlzRXZlbnRPckdlc3R1cmU7XG52YXIgQmluZGluZyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmluZGluZyh0YXJnZXQsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy50YXJnZXQgPSBuZXcgV2Vha1JlZih0YXJnZXQpO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLnNvdXJjZVByb3BlcnRpZXMgPSBnZXRQcm9wZXJ0aWVzKG9wdGlvbnMuc291cmNlUHJvcGVydHkpO1xuICAgICAgICB0aGlzLnRhcmdldE9wdGlvbnMgPSB0aGlzLnJlc29sdmVPcHRpb25zKHRhcmdldCwgZ2V0UHJvcGVydGllcyhvcHRpb25zLnRhcmdldFByb3BlcnR5KSk7XG4gICAgICAgIGlmICghdGhpcy50YXJnZXRPcHRpb25zKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHByb3BlcnR5OiBcIiArIG9wdGlvbnMudGFyZ2V0UHJvcGVydHkgKyBcIiBmb3IgdGFyZ2V0OiBcIiArIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0XzEgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodGFyZ2V0XzEgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgICAgIHRhcmdldF8xLm9uKHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSArIFwiQ2hhbmdlXCIsIHRoaXMub25UYXJnZXRQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIEJpbmRpbmcucHJvdG90eXBlLm9uVGFyZ2V0UHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUd29XYXkoZGF0YS52YWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gYXJncy5vYmplY3Q7XG4gICAgICAgIHRhcmdldC5vZmYoXCJsb2FkZWRcIiwgdGhpcy5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcsIHRoaXMpO1xuICAgICAgICB2YXIgY29udGV4dCA9IHRhcmdldC5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgaWYgKGNvbnRleHQgIT09IHVuZGVmaW5lZCAmJiBjb250ZXh0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZShjb250ZXh0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuY2xlYXJTb3VyY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAob2JzZXJ2YWJsZSwgaW5kZXgsIG1hcCkge1xuICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyKG9ic2VydmFibGUsIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIF90aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCBfdGhpcyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMuaW5zdGFuY2UuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuc291cmNlT3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuc291cmNlQXNPYmplY3QgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIHZhciBvYmplY3RUeXBlID0gdHlwZW9mIHNvdXJjZTtcbiAgICAgICAgaWYgKG9iamVjdFR5cGUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBOdW1iZXIoc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvYmplY3RUeXBlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IEJvb2xlYW4oc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChvYmplY3RUeXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgU3RyaW5nKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnVuYmluZCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IGRhdGEudmFsdWU7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFyQmluZGluZygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICBpZiAodGhpcy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0ICYmIHRhcmdldCBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlICYmIHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJiaW5kaW5nQ29udGV4dFwiKSB7XG4gICAgICAgICAgICB0YXJnZXQub24oXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGUoc291cmNlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgdGhpcy5jbGVhclNvdXJjZSgpO1xuICAgICAgICBzb3VyY2UgPSB0aGlzLnNvdXJjZUFzT2JqZWN0KHNvdXJjZSk7XG4gICAgICAgIGlmICghdHlwZXMuaXNOdWxsT3JVbmRlZmluZWQoc291cmNlKSkge1xuICAgICAgICAgICAgdGhpcy5zb3VyY2UgPSBuZXcgV2Vha1JlZihzb3VyY2UpO1xuICAgICAgICAgICAgdGhpcy5zb3VyY2VPcHRpb25zID0gdGhpcy5yZXNvbHZlT3B0aW9ucyhzb3VyY2UsIHRoaXMuc291cmNlUHJvcGVydGllcyk7XG4gICAgICAgICAgICB2YXIgc291cmNlVmFsdWUgPSB0aGlzLmdldFNvdXJjZVByb3BlcnR5VmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHNvdXJjZVZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuYWRkUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnModGhpcy5zb3VyY2UsIHRoaXMuc291cmNlUHJvcGVydGllcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXRoaXMuc291cmNlSXNCaW5kaW5nQ29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZVZhbHVlID0gdGhpcy5nZXRTb3VyY2VQcm9wZXJ0eVZhbHVlKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChzb3VyY2VWYWx1ZSA/IHNvdXJjZVZhbHVlIDogc291cmNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy50YXJnZXRPcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lm9mZih0aGlzLnRhcmdldE9wdGlvbnMucHJvcGVydHkgKyBcIkNoYW5nZVwiLCB0aGlzLm9uVGFyZ2V0UHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUlzQmluZGluZ0NvbnRleHQgJiYgdGhpcy50YXJnZXRPcHRpb25zLnByb3BlcnR5ICE9PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQub2ZmKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRhcmdldE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0T3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNvdXJjZVByb3BlcnRpZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICghdGhpcy5zb3VyY2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNsZWFyU291cmNlKCk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5yZXNvbHZlT2JqZWN0c0FuZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAoc291cmNlLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGN1cnJlbnRPYmplY3QgPSBzb3VyY2U7XG4gICAgICAgIHZhciBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgcHJvcHNBcnJheUxlbmd0aCA9IHByb3BlcnRpZXMubGVuZ3RoOyBpIDwgcHJvcHNBcnJheUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBwcm9wZXJ0aWVzW2ldO1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBiYy5iaW5kaW5nVmFsdWVLZXkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IGJjLnBhcmVudFZhbHVlS2V5IHx8IHByb3BlcnR5LmluZGV4T2YoYmMucGFyZW50c1ZhbHVlS2V5KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRWaWV3ID0gdGhpcy5nZXRQYXJlbnRWaWV3KHRoaXMudGFyZ2V0LmdldCgpLCBwcm9wZXJ0eSkudmlldztcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Vmlldykge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0ID0gcGFyZW50Vmlldy5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRJbnN0YW5jZSA9IHRoaXMudGFyZ2V0LmdldCgpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJbnN0YW5jZS5vZmYoXCJsb2FkZWRcIiwgdGhpcy5sb2FkZWRIYW5kbGVyVmlzdWFsVHJlZUJpbmRpbmcsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRJbnN0YW5jZS5vbihcImxvYWRlZFwiLCB0aGlzLmxvYWRlZEhhbmRsZXJWaXN1YWxUcmVlQmluZGluZywgdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjdXJyZW50T2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyBpbnN0YW5jZTogY3VycmVudE9iamVjdCwgcHJvcGVydHk6IHByb3BlcnR5IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRPYmplY3RDaGFuZ2VkICYmIChpIDwgcHJvcHNBcnJheUxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudE9iamVjdCA9IGN1cnJlbnRPYmplY3QgPyBjdXJyZW50T2JqZWN0W3Byb3BlcnRpZXNbaV1dIDogbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzID0gZnVuY3Rpb24gKHNvdXJjZSwgc291cmNlUHJvcGVydHksIHBhcmVudFByb3Blcmllcykge1xuICAgICAgICB2YXIgb2JqZWN0c0FuZFByb3BlcnRpZXMgPSB0aGlzLnJlc29sdmVPYmplY3RzQW5kUHJvcGVydGllcyhzb3VyY2UuZ2V0KCksIHNvdXJjZVByb3BlcnR5KTtcbiAgICAgICAgdmFyIHByb3AgPSBwYXJlbnRQcm9wZXJpZXMgfHwgXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gb2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbaV0ucHJvcGVydHk7XG4gICAgICAgICAgICBwcm9wICs9IFwiJFwiICsgcHJvcE5hbWU7XG4gICAgICAgICAgICB2YXIgY3VycmVudE9iamVjdCA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW2ldLmluc3RhbmNlO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmhhcyhwcm9wKSAmJiBjdXJyZW50T2JqZWN0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUgJiYgY3VycmVudE9iamVjdC5faXNWaWV3QmFzZSkge1xuICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihjdXJyZW50T2JqZWN0LCBwcm9wTmFtZSArIFwiQ2hhbmdlXCIsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihjdXJyZW50T2JqZWN0LCBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLnNldChwcm9wLCBjdXJyZW50T2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCF0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmhhcyhwcm9wKSAmJiBjdXJyZW50T2JqZWN0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIoY3VycmVudE9iamVjdCwgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5zZXQocHJvcCwgY3VycmVudE9iamVjdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnByZXBhcmVFeHByZXNzaW9uRm9yVXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZXNjYXBlZFNvdXJjZVByb3BlcnR5ID0gdXRpbHNfMS5lc2NhcGVSZWdleFN5bWJvbHModGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5KTtcbiAgICAgICAgdmFyIGV4cFJlZ2V4ID0gbmV3IFJlZ0V4cChlc2NhcGVkU291cmNlUHJvcGVydHksIFwiZ1wiKTtcbiAgICAgICAgdmFyIHJlc3VsdEV4cCA9IHRoaXMub3B0aW9ucy5leHByZXNzaW9uLnJlcGxhY2UoZXhwUmVnZXgsIGJjLm5ld1Byb3BlcnR5VmFsdWVLZXkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0RXhwO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlVHdvV2F5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0aW5nIHx8ICF0aGlzLm9wdGlvbnMudHdvV2F5KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGNoYW5nZWRNb2RlbCA9IHt9O1xuICAgICAgICAgICAgY2hhbmdlZE1vZGVsW2JjLmJpbmRpbmdWYWx1ZUtleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtiYy5uZXdQcm9wZXJ0eVZhbHVlS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdmFyIHNvdXJjZVByb3BlcnR5TmFtZSA9IFwiXCI7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcGVydHlOYW1lID0gdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSA9PT0gXCJzdHJpbmdcIiAmJiB0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHkuaW5kZXhPZihcIi5cIikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcGVydHlOYW1lID0gdGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNvdXJjZVByb3BlcnR5TmFtZSAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIGNoYW5nZWRNb2RlbFtzb3VyY2VQcm9wZXJ0eU5hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdXBkYXRlRXhwcmVzc2lvbiA9IHRoaXMucHJlcGFyZUV4cHJlc3Npb25Gb3JVcGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMucHJlcGFyZUNvbnRleHRGb3JFeHByZXNzaW9uKGNoYW5nZWRNb2RlbCwgdXBkYXRlRXhwcmVzc2lvbiwgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uVmFsdWUgPSB0aGlzLl9nZXRFeHByZXNzaW9uVmFsdWUodXBkYXRlRXhwcmVzc2lvbiwgdHJ1ZSwgY2hhbmdlZE1vZGVsKTtcbiAgICAgICAgICAgIGlmIChleHByZXNzaW9uVmFsdWUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoZXhwcmVzc2lvblZhbHVlLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1ZhbHVlID0gZXhwcmVzc2lvblZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlU291cmNlKG5ld1ZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLl9nZXRFeHByZXNzaW9uVmFsdWUgPSBmdW5jdGlvbiAoZXhwcmVzc2lvbiwgaXNCYWNrQ29udmVydCwgY2hhbmdlZE1vZGVsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZXhwXzEgPSBwb2x5bWVyRXhwcmVzc2lvbnMuUG9seW1lckV4cHJlc3Npb25zLmdldEV4cHJlc3Npb24oZXhwcmVzc2lvbik7XG4gICAgICAgICAgICBpZiAoZXhwXzEpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dF8xID0gdGhpcy5zb3VyY2UgJiYgdGhpcy5zb3VyY2UuZ2V0ICYmIHRoaXMuc291cmNlLmdldCgpIHx8IGdsb2JhbDtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB7fTtcbiAgICAgICAgICAgICAgICB2YXIgYWRkZWRQcm9wcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciByZXNvdXJjZXMgPSBhcHBsaWNhdGlvbkNvbW1vbi5nZXRSZXNvdXJjZXMoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIHJlc291cmNlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2VzLmhhc093blByb3BlcnR5KHByb3ApICYmICFjb250ZXh0XzEuaGFzT3duUHJvcGVydHkocHJvcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRfMVtwcm9wXSA9IHJlc291cmNlc1twcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkUHJvcHMucHVzaChwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnByZXBhcmVDb250ZXh0Rm9yRXhwcmVzc2lvbihjb250ZXh0XzEsIGV4cHJlc3Npb24sIGFkZGVkUHJvcHMpO1xuICAgICAgICAgICAgICAgIG1vZGVsW2NvbnRleHRLZXldID0gY29udGV4dF8xO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleHBfMS5nZXRWYWx1ZShtb2RlbCwgaXNCYWNrQ29udmVydCwgY2hhbmdlZE1vZGVsID8gY2hhbmdlZE1vZGVsIDogbW9kZWwpO1xuICAgICAgICAgICAgICAgIHZhciBhZGRlZFByb3BzTGVuZ3RoID0gYWRkZWRQcm9wcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhZGRlZFByb3BzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGNvbnRleHRfMVthZGRlZFByb3BzW2ldXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKGV4cHJlc3Npb24gKyBcIiBpcyBub3QgYSB2YWxpZCBleHByZXNzaW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IFwiUnVuLXRpbWUgZXJyb3Igb2NjdXJlZCBpbiBmaWxlOiBcIiArIGUuc291cmNlVVJMICsgXCIgYXQgbGluZTogXCIgKyBlLmxpbmUgKyBcIiBhbmQgY29sdW1uOiBcIiArIGUuY29sdW1uO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBzb3VyY2VQcm9wcyA9IHRoaXMuc291cmNlUHJvcGVydGllcztcbiAgICAgICAgdmFyIHNvdXJjZVByb3BzTGVuZ3RoID0gc291cmNlUHJvcHMubGVuZ3RoO1xuICAgICAgICB2YXIgY2hhbmdlZFByb3BlcnR5SW5kZXggPSBzb3VyY2VQcm9wcy5pbmRleE9mKGRhdGEucHJvcGVydHlOYW1lKTtcbiAgICAgICAgdmFyIHBhcmVudFByb3BzID0gXCJcIjtcbiAgICAgICAgaWYgKGNoYW5nZWRQcm9wZXJ0eUluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHBhcmVudFByb3BzID0gXCIkXCIgKyBzb3VyY2VQcm9wcy5zbGljZSgwLCBjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpLmpvaW4oXCIkXCIpO1xuICAgICAgICAgICAgd2hpbGUgKHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZ2V0KHBhcmVudFByb3BzKSAhPT0gZGF0YS5vYmplY3QpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkUHJvcGVydHlJbmRleCArPSBzb3VyY2VQcm9wcy5zbGljZShjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpLmluZGV4T2YoZGF0YS5wcm9wZXJ0eU5hbWUpICsgMTtcbiAgICAgICAgICAgICAgICBwYXJlbnRQcm9wcyA9IFwiJFwiICsgc291cmNlUHJvcHMuc2xpY2UoMCwgY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKS5qb2luKFwiJFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uVmFsdWUgPSB0aGlzLl9nZXRFeHByZXNzaW9uVmFsdWUodGhpcy5vcHRpb25zLmV4cHJlc3Npb24sIGZhbHNlLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25WYWx1ZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShleHByZXNzaW9uVmFsdWUubWVzc2FnZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQoZXhwcmVzc2lvblZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkUHJvcGVydHlJbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BzID0gc291cmNlUHJvcHMuc2xpY2UoY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcHNMZW5ndGggPSBwcm9wcy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BzTGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkYXRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVbcHJvcHNbaV1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS5wcm9wZXJ0eU5hbWUgPT09IHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChkYXRhLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoYW5nZWRQcm9wZXJ0eUluZGV4ID4gLTEgJiYgY2hhbmdlZFByb3BlcnR5SW5kZXggPCBzb3VyY2VQcm9wc0xlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHZhciBwcm9iYWJseUNoYW5nZWRPYmplY3QgPSB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmdldChwYXJlbnRQcm9wcyk7XG4gICAgICAgICAgICBpZiAocHJvYmFibHlDaGFuZ2VkT2JqZWN0ICYmXG4gICAgICAgICAgICAgICAgcHJvYmFibHlDaGFuZ2VkT2JqZWN0ICE9PSBkYXRhLm9iamVjdFtzb3VyY2VQcm9wc1tjaGFuZ2VkUHJvcGVydHlJbmRleF1dKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHNvdXJjZVByb3BzTGVuZ3RoIC0gMTsgaSA+IGNoYW5nZWRQcm9wZXJ0eUluZGV4OyBpLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSBcIiRcIiArIHNvdXJjZVByb3BzLnNsaWNlKDAsIGkgKyAxKS5qb2luKFwiJFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuaGFzKHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIodGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5nZXQocHJvcCksIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5kZWxldGUocHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5ld1Byb3BzID0gc291cmNlUHJvcHMuc2xpY2UoY2hhbmdlZFByb3BlcnR5SW5kZXggKyAxKTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3T2JqZWN0ID0gZGF0YS5vYmplY3Rbc291cmNlUHJvcHNbY2hhbmdlZFByb3BlcnR5SW5kZXhdXTtcbiAgICAgICAgICAgICAgICBpZiAoIXR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKG5ld09iamVjdCkgJiYgdHlwZW9mIG5ld09iamVjdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzKG5ldyBXZWFrUmVmKG5ld09iamVjdCksIG5ld1Byb3BzLCBwYXJlbnRQcm9wcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5wcmVwYXJlQ29udGV4dEZvckV4cHJlc3Npb24gPSBmdW5jdGlvbiAobW9kZWwsIGV4cHJlc3Npb24sIG5ld1Byb3BzKSB7XG4gICAgICAgIHZhciBwYXJlbnRWaWV3QW5kSW5kZXg7XG4gICAgICAgIHZhciBwYXJlbnRWaWV3O1xuICAgICAgICB2YXIgYWRkZWRQcm9wcyA9IG5ld1Byb3BzIHx8IFtdO1xuICAgICAgICBpZiAoZXhwcmVzc2lvbi5pbmRleE9mKGJjLmJpbmRpbmdWYWx1ZUtleSkgPiAtMSkge1xuICAgICAgICAgICAgbW9kZWxbYmMuYmluZGluZ1ZhbHVlS2V5XSA9IG1vZGVsO1xuICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKGJjLmJpbmRpbmdWYWx1ZUtleSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cHJlc3Npb24uaW5kZXhPZihiYy5wYXJlbnRWYWx1ZUtleSkgPiAtMSkge1xuICAgICAgICAgICAgcGFyZW50VmlldyA9IHRoaXMuZ2V0UGFyZW50Vmlldyh0aGlzLnRhcmdldC5nZXQoKSwgYmMucGFyZW50VmFsdWVLZXkpLnZpZXc7XG4gICAgICAgICAgICBpZiAocGFyZW50Vmlldykge1xuICAgICAgICAgICAgICAgIG1vZGVsW2JjLnBhcmVudFZhbHVlS2V5XSA9IHBhcmVudFZpZXcuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKGJjLnBhcmVudFZhbHVlS2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50c0FycmF5ID0gZXhwcmVzc2lvbi5tYXRjaChiaW5kaW5nX2J1aWxkZXJfMS5wYXJlbnRzUmVnZXgpO1xuICAgICAgICBpZiAocGFyZW50c0FycmF5KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmVudHNBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhcmVudFZpZXdBbmRJbmRleCA9IHRoaXMuZ2V0UGFyZW50Vmlldyh0aGlzLnRhcmdldC5nZXQoKSwgcGFyZW50c0FycmF5W2ldKTtcbiAgICAgICAgICAgICAgICBpZiAocGFyZW50Vmlld0FuZEluZGV4LnZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxbYmMucGFyZW50c1ZhbHVlS2V5XSA9IG1vZGVsW2JjLnBhcmVudHNWYWx1ZUtleV0gfHwge307XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsW2JjLnBhcmVudHNWYWx1ZUtleV1bcGFyZW50Vmlld0FuZEluZGV4LmluZGV4XSA9IHBhcmVudFZpZXdBbmRJbmRleC52aWV3LmJpbmRpbmdDb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICBhZGRlZFByb3BzLnB1c2goYmMucGFyZW50c1ZhbHVlS2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmdldFNvdXJjZVByb3BlcnR5VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGNoYW5nZWRNb2RlbCA9IHt9O1xuICAgICAgICAgICAgY2hhbmdlZE1vZGVsW2JjLmJpbmRpbmdWYWx1ZUtleV0gPSB0aGlzLnNvdXJjZSA/IHRoaXMuc291cmNlLmdldCgpIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb25WYWx1ZSA9IHRoaXMuX2dldEV4cHJlc3Npb25WYWx1ZSh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbiwgZmFsc2UsIGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvblZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGV4cHJlc3Npb25WYWx1ZS5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvblZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZU9wdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2VPcHRpb25zSW5zdGFuY2UgPSB0aGlzLnNvdXJjZU9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ID09PSBiYy5iaW5kaW5nVmFsdWVLZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlT3B0aW9uc0luc3RhbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoKHNvdXJjZU9wdGlvbnNJbnN0YW5jZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSAmJiAodGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICYmIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlT3B0aW9uc0luc3RhbmNlLmdldCh0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc291cmNlT3B0aW9uc0luc3RhbmNlICYmIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAmJiB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgIT09IFwiXCIgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgaW4gc291cmNlT3B0aW9uc0luc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNvdXJjZU9wdGlvbnNJbnN0YW5jZVt0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlByb3BlcnR5OiAnXCIgKyB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgKyBcIicgaXMgaW52YWxpZCBvciBkb2VzIG5vdCBleGlzdC4gU291cmNlUHJvcGVydHk6ICdcIiArIHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSArIFwiJ1wiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5jbGVhckJpbmRpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJTb3VyY2UoKTtcbiAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQocHJvcGVydGllc18xLnVuc2V0VmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlVGFyZ2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVPcHRpb25zKHRoaXMudGFyZ2V0T3B0aW9ucywgdHlwZXMuaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiB2YWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVTb3VyY2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudXBkYXRpbmcgfHwgIXRoaXMuc291cmNlIHx8ICF0aGlzLnNvdXJjZS5nZXQoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudXBkYXRlT3B0aW9ucyh0aGlzLnNvdXJjZU9wdGlvbnMsIHZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmdldFBhcmVudFZpZXcgPSBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eSkge1xuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdmlldzogbnVsbCwgaW5kZXg6IG51bGwgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAocHJvcGVydHkgPT09IGJjLnBhcmVudFZhbHVlS2V5KSB7XG4gICAgICAgICAgICByZXN1bHQgPSB0YXJnZXQucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IG51bGw7XG4gICAgICAgIGlmIChwcm9wZXJ0eS5pbmRleE9mKGJjLnBhcmVudHNWYWx1ZUtleSkgPT09IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgaW5kZXhQYXJhbXMgPSBwYXJhbXNSZWdleC5leGVjKHByb3BlcnR5KTtcbiAgICAgICAgICAgIGlmIChpbmRleFBhcmFtcyAmJiBpbmRleFBhcmFtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSBpbmRleFBhcmFtc1syXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNOYU4oaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGV4QXNJbnQgPSBwYXJzZUludChpbmRleCk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGluZGV4QXNJbnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4QXNJbnQtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlcy5pc1N0cmluZyhpbmRleCkpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAocmVzdWx0ICYmIHJlc3VsdC50eXBlTmFtZSAhPT0gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnBhcmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdmlldzogcmVzdWx0LCBpbmRleDogaW5kZXggfTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnJlc29sdmVPcHRpb25zID0gZnVuY3Rpb24gKG9iaiwgcHJvcGVydGllcykge1xuICAgICAgICB2YXIgb2JqZWN0c0FuZFByb3BlcnRpZXMgPSB0aGlzLnJlc29sdmVPYmplY3RzQW5kUHJvcGVydGllcyhvYmosIHByb3BlcnRpZXMpO1xuICAgICAgICBpZiAob2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIHJlc29sdmVkT2JqID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbb2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoIC0gMV0uaW5zdGFuY2U7XG4gICAgICAgICAgICB2YXIgcHJvcCA9IG9iamVjdHNBbmRQcm9wZXJ0aWVzW29iamVjdHNBbmRQcm9wZXJ0aWVzLmxlbmd0aCAtIDFdLnByb3BlcnR5O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbmV3IFdlYWtSZWYodGhpcy5zb3VyY2VBc09iamVjdChyZXNvbHZlZE9iaikpLFxuICAgICAgICAgICAgICAgIHByb3BlcnR5OiBwcm9wXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlT3B0aW9ucyA9IGZ1bmN0aW9uIChvcHRpb25zLCB2YWx1ZSkge1xuICAgICAgICB2YXIgb3B0aW9uc0luc3RhbmNlO1xuICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmluc3RhbmNlKSB7XG4gICAgICAgICAgICBvcHRpb25zSW5zdGFuY2UgPSBvcHRpb25zLmluc3RhbmNlLmdldCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3B0aW9uc0luc3RhbmNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGluZyA9IHRydWU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoaXNFdmVudE9yR2VzdHVyZShvcHRpb25zLnByb3BlcnR5LCBvcHRpb25zSW5zdGFuY2UpICYmXG4gICAgICAgICAgICAgICAgdHlwZXMuaXNGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Uub2ZmKG9wdGlvbnMucHJvcGVydHksIG51bGwsIG9wdGlvbnNJbnN0YW5jZS5iaW5kaW5nQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlLm9uKG9wdGlvbnMucHJvcGVydHksIHZhbHVlLCBvcHRpb25zSW5zdGFuY2UuYmluZGluZ0NvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9uc0luc3RhbmNlIGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Uuc2V0KG9wdGlvbnMucHJvcGVydHksIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZVtvcHRpb25zLnByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkJpbmRpbmcgZXJyb3Igd2hpbGUgc2V0dGluZyBwcm9wZXJ0eSBcIiArIG9wdGlvbnMucHJvcGVydHkgKyBcIiBvZiBcIiArIG9wdGlvbnNJbnN0YW5jZSArIFwiOiBcIiArIGV4LCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGluZyA9IGZhbHNlO1xuICAgIH07XG4gICAgcmV0dXJuIEJpbmRpbmc7XG59KCkpO1xuZXhwb3J0cy5CaW5kaW5nID0gQmluZGluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJpbmRhYmxlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBPYnNlcnZlckNsYXNzID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoT2JzZXJ2ZXJDbGFzcywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBPYnNlcnZlckNsYXNzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9ic2VydmVyQ2xhc3MucHJvdG90eXBlLm9ic2VydmVWYWx1ZUZvcktleVBhdGhPZk9iamVjdENoYW5nZUNvbnRleHQgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICBpZiAocGF0aCA9PT0gXCJzZWxlY3RlZFwiKSB7XG4gICAgICAgICAgICB0aGlzW1wiX293bmVyXCJdLl9vblNlbGVjdGVkQ2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhdGggPT09IFwiZW5hYmxlZFwiKSB7XG4gICAgICAgICAgICB0aGlzW1wiX293bmVyXCJdLl9vbkVuYWJsZWRDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGF0aCA9PT0gXCJoaWdobGlnaHRlZFwiKSB7XG4gICAgICAgICAgICB0aGlzW1wiX293bmVyXCJdLl9vbkhpZ2hsaWdodGVkQ2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gT2JzZXJ2ZXJDbGFzcztcbn0oTlNPYmplY3QpKTtcbnZhciBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXIoY29udHJvbCwgY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fb2JzZXJ2aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX29ic2VydmVyID0gT2JzZXJ2ZXJDbGFzcy5hbGxvYygpO1xuICAgICAgICB0aGlzLl9vYnNlcnZlcltcIl9vd25lclwiXSA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2NvbnRyb2wgPSBjb250cm9sO1xuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cbiAgICBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lci5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fb2JzZXJ2aW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250cm9sLmFkZE9ic2VydmVyRm9yS2V5UGF0aE9wdGlvbnNDb250ZXh0KHRoaXMuX29ic2VydmVyLCBcImhpZ2hsaWdodGVkXCIsIDEsIG51bGwpO1xuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fb2JzZXJ2aW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2wucmVtb3ZlT2JzZXJ2ZXJGb3JLZXlQYXRoKHRoaXMuX29ic2VydmVyLCBcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lci5wcm90b3R5cGUuX29uRW5hYmxlZENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlKCk7XG4gICAgfTtcbiAgICBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lci5wcm90b3R5cGUuX29uU2VsZWN0ZWRDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl91cGRhdGVTdGF0ZSgpO1xuICAgIH07XG4gICAgQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXIucHJvdG90eXBlLl9vbkhpZ2hsaWdodGVkQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUoKTtcbiAgICB9O1xuICAgIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyLnByb3RvdHlwZS5fdXBkYXRlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IFwibm9ybWFsXCI7XG4gICAgICAgIGlmICh0aGlzLl9jb250cm9sLmhpZ2hsaWdodGVkKSB7XG4gICAgICAgICAgICBzdGF0ZSA9IFwiaGlnaGxpZ2h0ZWRcIjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jYWxsYmFjayhzdGF0ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXI7XG59KCkpO1xuZXhwb3J0cy5Db250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lciA9IENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29udHJvbC1zdGF0ZS1jaGFuZ2UuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdHJhY2VcIik7XG52YXIgc3R5bGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlXCIpO1xuZXhwb3J0cy5TdHlsZSA9IHN0eWxlXzEuU3R5bGU7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xuZXhwb3J0cy51bnNldFZhbHVlID0gbmV3IE9iamVjdCgpO1xudmFyIGNzc1Byb3BlcnR5TmFtZXMgPSBbXTtcbnZhciBzeW1ib2xQcm9wZXJ0eU1hcCA9IHt9O1xudmFyIGNzc1N5bWJvbFByb3BlcnR5TWFwID0ge307XG52YXIgaW5oZXJpdGFibGVQcm9wZXJ0aWVzID0gbmV3IEFycmF5KCk7XG52YXIgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzID0gbmV3IEFycmF5KCk7XG5mdW5jdGlvbiBwcmludChtYXApIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMobWFwKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfMSA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBtYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wLnJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJvcGVydHkgXCIgKyBwcm9wLm5hbWUgKyBcIiBub3QgUmVnaXN0ZXJlZCEhISEhXCIpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gX3ByaW50VW5yZWdpc3RlcmVkUHJvcGVydGllcygpIHtcbiAgICBwcmludChzeW1ib2xQcm9wZXJ0eU1hcCk7XG4gICAgcHJpbnQoY3NzU3ltYm9sUHJvcGVydHlNYXApO1xufVxuZXhwb3J0cy5fcHJpbnRVbnJlZ2lzdGVyZWRQcm9wZXJ0aWVzID0gX3ByaW50VW5yZWdpc3RlcmVkUHJvcGVydGllcztcbmZ1bmN0aW9uIF9nZXRQcm9wZXJ0aWVzKCkge1xuICAgIHJldHVybiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChzeW1ib2xQcm9wZXJ0eU1hcCk7XG59XG5leHBvcnRzLl9nZXRQcm9wZXJ0aWVzID0gX2dldFByb3BlcnRpZXM7XG5mdW5jdGlvbiBfZ2V0U3R5bGVQcm9wZXJ0aWVzKCkge1xuICAgIHJldHVybiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChjc3NTeW1ib2xQcm9wZXJ0eU1hcCk7XG59XG5leHBvcnRzLl9nZXRTdHlsZVByb3BlcnRpZXMgPSBfZ2V0U3R5bGVQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gZ2V0UHJvcGVydGllc0Zyb21NYXAobWFwKSB7XG4gICAgdmFyIHByb3BzID0gW107XG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhtYXApLmZvckVhY2goZnVuY3Rpb24gKHN5bWJvbCkgeyByZXR1cm4gcHJvcHMucHVzaChtYXBbc3ltYm9sXSk7IH0pO1xuICAgIHJldHVybiBwcm9wcztcbn1cbnZhciBQcm9wZXJ0eSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB0aGlzLmVudW1lcmFibGUgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMubmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICAgICAgdmFyIGtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpwcm9wZXJ0eUtleVwiKTtcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOmdldERlZmF1bHRcIik7XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdCA9IGdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6c2V0TmF0aXZlXCIpO1xuICAgICAgICB0aGlzLnNldE5hdGl2ZSA9IHNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpuYXRpdmVEZWZhdWx0VmFsdWVcIik7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlS2V5ID0gZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXI7XG4gICAgICAgIHZhciBhZmZlY3RzTGF5b3V0ID0gb3B0aW9ucy5hZmZlY3RzTGF5b3V0O1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQ7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2V0ID0gZnVuY3Rpb24gKGJveGVkVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciByZXNldCA9IGJveGVkVmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciB3cmFwcGVkO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB3cmFwcGVkID0gYm94ZWRWYWx1ZSAmJiBib3hlZFZhbHVlLndyYXBwZWQ7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB3cmFwcGVkID8gb2JzZXJ2YWJsZV8xLldyYXBwZWRWYWx1ZS51bndyYXAoYm94ZWRWYWx1ZSkgOiBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZUNvbnZlcnRlcih2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHdyYXBwZWQgfHwgY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB0aGlzW2dldERlZmF1bHRdID8gdGhpc1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmF0dHJpYnV0ZVJlbW92ZWQocHJvcGVydHlOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5hdHRyaWJ1dGVNb2RpZmllZChwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubmF0aXZlVmFsdWVDaGFuZ2UgPSBmdW5jdGlvbiAob3duZXIsIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gb3duZXIgPyBvd25lcltrZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgb3duZXJba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKG93bmVyLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3duZXIubmF0aXZlVmlld1Byb3RlY3RlZCAmJiAhKGRlZmF1bHRWYWx1ZUtleSBpbiBvd25lcikpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXJbZGVmYXVsdFZhbHVlS2V5XSA9IG93bmVyW2dldERlZmF1bHRdID8gb3duZXJbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IG9iamVjdDogb3duZXIsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG93bmVyLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG93bmVyLmRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIuZG9tTm9kZS5hdHRyaWJ1dGVNb2RpZmllZChwcm9wZXJ0eU5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHN5bWJvbFByb3BlcnR5TWFwW2tleV0gPSB0aGlzO1xuICAgIH1cbiAgICBQcm9wZXJ0eS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGlmICh0aGlzLnJlZ2lzdGVyZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgdGhpcy5uYW1lICsgXCIgYWxyZWFkeSByZWdpc3RlcmVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZ2lzdGVyZWQgPSB0cnVlO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5uYW1lLCB0aGlzKTtcbiAgICB9O1xuICAgIFByb3BlcnR5LnByb3RvdHlwZS5pc1NldCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXkgaW4gaW5zdGFuY2U7XG4gICAgfTtcbiAgICByZXR1cm4gUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5Qcm9wZXJ0eSA9IFByb3BlcnR5O1xuUHJvcGVydHkucHJvdG90eXBlLmlzU3R5bGVQcm9wZXJ0eSA9IGZhbHNlO1xudmFyIENvZXJjaWJsZVByb3BlcnR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ29lcmNpYmxlUHJvcGVydHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ29lcmNpYmxlUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gX3RoaXMua2V5O1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IF90aGlzLmdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBfdGhpcy5zZXROYXRpdmU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBfdGhpcy5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBfdGhpcy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBjb2VyY2VLZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6Y29lcmNlS2V5XCIpO1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyO1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQ7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBjb2VyY2VDYWxsYmFjayA9IG9wdGlvbnMuY29lcmNlVmFsdWU7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IF90aGlzO1xuICAgICAgICBfdGhpcy5jb2VyY2UgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWxWYWx1ZSA9IGNvZXJjZUtleSBpbiB0YXJnZXQgPyB0YXJnZXRbY29lcmNlS2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHRhcmdldFtwcm9wZXJ0eU5hbWVdID0gb3JpZ2luYWxWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc2V0ID0gZnVuY3Rpb24gKGJveGVkVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciByZXNldCA9IGJveGVkVmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciB3cmFwcGVkO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbY29lcmNlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdyYXBwZWQgPSBib3hlZFZhbHVlICYmIGJveGVkVmFsdWUud3JhcHBlZDtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBwZWQgPyBvYnNlcnZhYmxlXzEuV3JhcHBlZFZhbHVlLnVud3JhcChib3hlZFZhbHVlKSA6IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlQ29udmVydGVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpc1tjb2VyY2VLZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBjb2VyY2VDYWxsYmFjayh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAod3JhcHBlZCB8fCBjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdGhpc1tnZXREZWZhdWx0XSA/IHRoaXNbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlUmVtb3ZlZChwcm9wZXJ0eU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmF0dHJpYnV0ZU1vZGlmaWVkKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBDb2VyY2libGVQcm9wZXJ0eTtcbn0oUHJvcGVydHkpKTtcbmV4cG9ydHMuQ29lcmNpYmxlUHJvcGVydHkgPSBDb2VyY2libGVQcm9wZXJ0eTtcbnZhciBJbmhlcml0ZWRQcm9wZXJ0eSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEluaGVyaXRlZFByb3BlcnR5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEluaGVyaXRlZFByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICAgICAgdmFyIG5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBfdGhpcy5rZXk7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IFN5bWJvbChuYW1lICsgXCI6dmFsdWVTb3VyY2VLZXlcIik7XG4gICAgICAgIF90aGlzLnNvdXJjZUtleSA9IHNvdXJjZUtleTtcbiAgICAgICAgdmFyIHNldEJhc2UgPSBfdGhpcy5zZXQ7XG4gICAgICAgIHZhciBzZXRGdW5jID0gZnVuY3Rpb24gKHZhbHVlU291cmNlKSB7IHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHZhciB1bmJveGVkVmFsdWU7XG4gICAgICAgICAgICB2YXIgbmV3VmFsdWVTb3VyY2U7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHRoYXQucGFyZW50O1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRfMSAmJiBwYXJlbnRfMVtzb3VyY2VLZXldICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVuYm94ZWRWYWx1ZSA9IHBhcmVudF8xW25hbWVdO1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZVNvdXJjZSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1bmJveGVkVmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlU291cmNlID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB1bmJveGVkVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZVNvdXJjZSA9IHZhbHVlU291cmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHRoYXRba2V5XTtcbiAgICAgICAgICAgIHNldEJhc2UuY2FsbCh0aGF0LCB1bmJveGVkVmFsdWUpO1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhhdFtrZXldO1xuICAgICAgICAgICAgdGhhdFtzb3VyY2VLZXldID0gbmV3VmFsdWVTb3VyY2U7XG4gICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciByZXNldF8xID0gbmV3VmFsdWVTb3VyY2UgPT09IDA7XG4gICAgICAgICAgICAgICAgdGhhdC5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZFZhbHVlU291cmNlID0gY2hpbGRbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXRfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkVmFsdWVTb3VyY2UgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRGdW5jLmNhbGwoY2hpbGQsIGV4cG9ydHMudW5zZXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW5oZXJpdGVkVmFsdWUuY2FsbChjaGlsZCwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9OyB9O1xuICAgICAgICB2YXIgc2V0SW5oZXJpdGVkVmFsdWUgPSBzZXRGdW5jKDEpO1xuICAgICAgICBfdGhpcy5zZXRJbmhlcml0ZWRWYWx1ZSA9IHNldEluaGVyaXRlZFZhbHVlO1xuICAgICAgICBfdGhpcy5zZXQgPSBzZXRGdW5jKDMpO1xuICAgICAgICBpbmhlcml0YWJsZVByb3BlcnRpZXMucHVzaChfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIEluaGVyaXRlZFByb3BlcnR5O1xufShQcm9wZXJ0eSkpO1xuZXhwb3J0cy5Jbmhlcml0ZWRQcm9wZXJ0eSA9IEluaGVyaXRlZFByb3BlcnR5O1xudmFyIENzc1Byb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHRoaXMubmFtZSA9IHByb3BlcnR5TmFtZTtcbiAgICAgICAgY3NzUHJvcGVydHlOYW1lcy5wdXNoKG9wdGlvbnMuY3NzTmFtZSk7XG4gICAgICAgIHRoaXMuY3NzTmFtZSA9IFwiY3NzOlwiICsgb3B0aW9ucy5jc3NOYW1lO1xuICAgICAgICB0aGlzLmNzc0xvY2FsTmFtZSA9IG9wdGlvbnMuY3NzTmFtZTtcbiAgICAgICAgdmFyIGtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpwcm9wZXJ0eUtleVwiKTtcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6dmFsdWVTb3VyY2VLZXlcIik7XG4gICAgICAgIHRoaXMuc291cmNlS2V5ID0gc291cmNlS2V5O1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpnZXREZWZhdWx0XCIpO1xuICAgICAgICB0aGlzLmdldERlZmF1bHQgPSBnZXREZWZhdWx0O1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnNldE5hdGl2ZVwiKTtcbiAgICAgICAgdGhpcy5zZXROYXRpdmUgPSBzZXROYXRpdmU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6bmF0aXZlRGVmYXVsdFZhbHVlXCIpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZUtleSA9IGRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBhZmZlY3RzTGF5b3V0ID0gb3B0aW9ucy5hZmZlY3RzTGF5b3V0O1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkO1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBzZXRMb2NhbFZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXNldCA9IG5ld1ZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgbmV3VmFsdWUgPT09IFwiXCI7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tzb3VyY2VLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gMztcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICh2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgbmV3VmFsdWUgPT09IFwic3RyaW5nXCIpID9cbiAgICAgICAgICAgICAgICAgICAgdmFsdWVDb252ZXJ0ZXIobmV3VmFsdWUpIDpcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBzZXRDc3NWYWx1ZShuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlU291cmNlID0gdGhpc1tzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlU291cmNlID09PSAzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc2V0ID0gbmV3VmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSB8fCBuZXdWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW3NvdXJjZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiA/XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlQ29udmVydGVyKG5ld1ZhbHVlKSA6XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXNbc291cmNlS2V5XSA9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBnZXQsXG4gICAgICAgICAgICBzZXQ6IHNldENzc1ZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBnZXQsXG4gICAgICAgICAgICBzZXQ6IHNldExvY2FsVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgY3NzU3ltYm9sUHJvcGVydHlNYXBba2V5XSA9IHRoaXM7XG4gICAgfVxuICAgIENzc1Byb3BlcnR5LnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyB0aGlzLm5hbWUgKyBcIiBhbHJlYWR5IHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLm5hbWUsIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5jc3NOYW1lLCB0aGlzLmNzc1ZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIGlmICh0aGlzLmNzc0xvY2FsTmFtZSAhPT0gdGhpcy5jc3NOYW1lKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5jc3NMb2NhbE5hbWUsIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDc3NQcm9wZXJ0eS5wcm90b3R5cGUuaXNTZXQgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5IGluIGluc3RhbmNlO1xuICAgIH07XG4gICAgcmV0dXJuIENzc1Byb3BlcnR5O1xufSgpKTtcbmV4cG9ydHMuQ3NzUHJvcGVydHkgPSBDc3NQcm9wZXJ0eTtcbkNzc1Byb3BlcnR5LnByb3RvdHlwZS5pc1N0eWxlUHJvcGVydHkgPSB0cnVlO1xudmFyIENzc0FuaW1hdGlvblByb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NBbmltYXRpb25Qcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXIsIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXIsIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkLCBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5uYW1lID0gcHJvcGVydHlOYW1lO1xuICAgICAgICBjc3NQcm9wZXJ0eU5hbWVzLnB1c2gob3B0aW9ucy5jc3NOYW1lKTtcbiAgICAgICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvcGVydGllc1twcm9wZXJ0eU5hbWVdID0gdGhpcztcbiAgICAgICAgaWYgKG9wdGlvbnMuY3NzTmFtZSAmJiBvcHRpb25zLmNzc05hbWUgIT09IHByb3BlcnR5TmFtZSkge1xuICAgICAgICAgICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvcGVydGllc1tvcHRpb25zLmNzc05hbWVdID0gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl92YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBjc3NMb2NhbE5hbWUgPSAob3B0aW9ucy5jc3NOYW1lIHx8IHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHRoaXMuY3NzTG9jYWxOYW1lID0gY3NzTG9jYWxOYW1lO1xuICAgICAgICB2YXIgY3NzTmFtZSA9IFwiY3NzOlwiICsgY3NzTG9jYWxOYW1lO1xuICAgICAgICB0aGlzLmNzc05hbWUgPSBjc3NOYW1lO1xuICAgICAgICB2YXIga2V5ZnJhbWVOYW1lID0gXCJrZXlmcmFtZTpcIiArIHByb3BlcnR5TmFtZTtcbiAgICAgICAgdGhpcy5rZXlmcmFtZSA9IGtleWZyYW1lTmFtZTtcbiAgICAgICAgdmFyIGRlZmF1bHROYW1lID0gXCJkZWZhdWx0OlwiICsgcHJvcGVydHlOYW1lO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gU3ltYm9sKGRlZmF1bHROYW1lKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWVLZXkgPSBkZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgY3NzVmFsdWUgPSBTeW1ib2woY3NzTmFtZSk7XG4gICAgICAgIHZhciBzdHlsZVZhbHVlID0gU3ltYm9sKFwibG9jYWw6XCIgKyBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICB2YXIga2V5ZnJhbWVWYWx1ZSA9IFN5bWJvbChrZXlmcmFtZU5hbWUpO1xuICAgICAgICB2YXIgY29tcHV0ZWRWYWx1ZSA9IFN5bWJvbChcImNvbXB1dGVkLXZhbHVlOlwiICsgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgdGhpcy5rZXkgPSBjb21wdXRlZFZhbHVlO1xuICAgICAgICB2YXIgY29tcHV0ZWRTb3VyY2UgPSBTeW1ib2woXCJjb21wdXRlZC1zb3VyY2U6XCIgKyBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICB0aGlzLnNvdXJjZSA9IGNvbXB1dGVkU291cmNlO1xuICAgICAgICB0aGlzLmdldERlZmF1bHQgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6Z2V0RGVmYXVsdFwiKTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSB0aGlzLmdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSB0aGlzLnNldE5hdGl2ZSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpzZXROYXRpdmVcIik7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSB0aGlzO1xuICAgICAgICBmdW5jdGlvbiBkZXNjcmlwdG9yKHN5bWJvbCwgcHJvcGVydHlTb3VyY2UsIGVudW1lcmFibGUsIGNvbmZpZ3VyYWJsZSwgZ2V0c0NvbXB1dGVkKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGVudW1lcmFibGUsIGNvbmZpZ3VyYWJsZTogY29uZmlndXJhYmxlLFxuICAgICAgICAgICAgICAgIGdldDogZ2V0c0NvbXB1dGVkID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpc1tjb21wdXRlZFZhbHVlXTsgfSA6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXNbc3ltYm9sXTsgfSxcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChib3hlZFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoYm94ZWRWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXNbY29tcHV0ZWRWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBvbGRTb3VyY2UgPSB0aGlzW2NvbXB1dGVkU291cmNlXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdhc1NldCA9IG9sZFNvdXJjZSAhPT0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlIHx8IGJveGVkVmFsdWUgPT09IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzeW1ib2xdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbY29tcHV0ZWRTb3VyY2VdID09PSBwcm9wZXJ0eVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3N0eWxlVmFsdWVdICE9PSBleHBvcnRzLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFNvdXJjZV0gPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkVmFsdWVdID0gdGhpc1tzdHlsZVZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpc1tjc3NWYWx1ZV0gIT09IGV4cG9ydHMudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkU291cmNlXSA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRWYWx1ZV0gPSB0aGlzW2Nzc1ZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2NvbXB1dGVkU291cmNlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbY29tcHV0ZWRWYWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBib3hlZFZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94ZWRWYWx1ZSA9IHZhbHVlQ29udmVydGVyKGJveGVkVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzeW1ib2xdID0gYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW2NvbXB1dGVkU291cmNlXSA8PSBwcm9wZXJ0eVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRTb3VyY2VdID0gcHJvcGVydHlTb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFZhbHVlXSA9IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpc1tjb21wdXRlZFZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXNbY29tcHV0ZWRTb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXNTZXQgPSBzb3VyY2UgIT09IDA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wdXRlZFZhbHVlQ2hhbmdlZCA9IG9sZFZhbHVlICE9PSB2YWx1ZSAmJiAoIWVxdWFsaXR5Q29tcGFyZXIgfHwgIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wdXRlZFZhbHVlQ2hhbmdlZCAmJiB2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0gJiYgKGNvbXB1dGVkVmFsdWVDaGFuZ2VkIHx8IGlzU2V0ICE9PSB3YXNTZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc1NldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXdhc1NldCAmJiAhKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh3YXNTZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wdXRlZFZhbHVlQ2hhbmdlZCAmJiB0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlZmF1bHRQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKGRlZmF1bHRWYWx1ZUtleSwgMCwgZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG4gICAgICAgIHZhciBjc3NQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKGNzc1ZhbHVlLCAyLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgdmFyIHN0eWxlUHJvcGVydHlEZXNjcmlwdG9yID0gZGVzY3JpcHRvcihzdHlsZVZhbHVlLCAzLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdmFyIGtleWZyYW1lUHJvcGVydHlEZXNjcmlwdG9yID0gZGVzY3JpcHRvcihrZXlmcmFtZVZhbHVlLCA0LCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgc3ltYm9sUHJvcGVydHlNYXBbY29tcHV0ZWRWYWx1ZV0gPSB0aGlzO1xuICAgICAgICBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtjb21wdXRlZFZhbHVlXSA9IHRoaXM7XG4gICAgICAgIHRoaXMucmVnaXN0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgICAgICBjbHMucHJvdG90eXBlW2NvbXB1dGVkVmFsdWVdID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICBjbHMucHJvdG90eXBlW2NvbXB1dGVkU291cmNlXSA9IDA7XG4gICAgICAgICAgICBjbHMucHJvdG90eXBlW2Nzc1ZhbHVlXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbc3R5bGVWYWx1ZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICBjbHMucHJvdG90eXBlW2tleWZyYW1lVmFsdWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIGRlZmF1bHROYW1lLCBkZWZhdWx0UHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCBjc3NOYW1lLCBjc3NQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHByb3BlcnR5TmFtZSwgc3R5bGVQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuY3NzTmFtZSAmJiBvcHRpb25zLmNzc05hbWUgIT09IG9wdGlvbnMubmFtZSkge1xuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCBvcHRpb25zLmNzc05hbWUsIHN0eWxlUHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCBrZXlmcmFtZU5hbWUsIGtleWZyYW1lUHJvcGVydHlEZXNjcmlwdG9yKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvdG90eXBlLl9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJfaW5pdERlZmF1bHROYXRpdmVWYWx1ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSB0aGlzLmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRhcmdldCkpIHtcbiAgICAgICAgICAgIHZhciBnZXREZWZhdWx0ID0gdGhpcy5nZXREZWZhdWx0O1xuICAgICAgICAgICAgdGFyZ2V0W2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogdGhpcy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc0FuaW1hdGlvblByb3BlcnR5Ll9nZXRCeUNzc05hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzW25hbWVdO1xuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkuX2dldFByb3BlcnR5TmFtZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzKTtcbiAgICB9O1xuICAgIENzc0FuaW1hdGlvblByb3BlcnR5LnByb3RvdHlwZS5pc1NldCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gaW5zdGFuY2VbdGhpcy5zb3VyY2VdICE9PSAwO1xuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvcGVydGllcyA9IHt9O1xuICAgIHJldHVybiBDc3NBbmltYXRpb25Qcm9wZXJ0eTtcbn0oKSk7XG5leHBvcnRzLkNzc0FuaW1hdGlvblByb3BlcnR5ID0gQ3NzQW5pbWF0aW9uUHJvcGVydHk7XG5Dc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm90b3R5cGUuaXNTdHlsZVByb3BlcnR5ID0gdHJ1ZTtcbnZhciBJbmhlcml0ZWRDc3NQcm9wZXJ0eSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEluaGVyaXRlZENzc1Byb3BlcnR5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEluaGVyaXRlZENzc1Byb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0aW9ucykgfHwgdGhpcztcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdmFyIGtleSA9IF90aGlzLmtleTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IF90aGlzLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBfdGhpcy5nZXREZWZhdWx0O1xuICAgICAgICB2YXIgc2V0TmF0aXZlID0gX3RoaXMuc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gX3RoaXMuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgYWZmZWN0c0xheW91dCA9IG9wdGlvbnMuYWZmZWN0c0xheW91dDtcbiAgICAgICAgdmFyIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXI7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gX3RoaXM7XG4gICAgICAgIHZhciBzZXRGdW5jID0gZnVuY3Rpb24gKHZhbHVlU291cmNlKSB7IHJldHVybiBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGJveGVkVmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlIHx8IGJveGVkVmFsdWUgPT09IFwiXCI7XG4gICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlU291cmNlID0gdGhpc1tzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVTb3VyY2UgPT09IDIgJiYgY3VycmVudFZhbHVlU291cmNlID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlU291cmNlID4gdmFsdWVTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHVuc2V0TmF0aXZlVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMiA9IHZpZXcucGFyZW50O1xuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHBhcmVudF8yID8gcGFyZW50XzIuc3R5bGUgOiBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZVtzb3VyY2VLZXldID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHN0eWxlW3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbc291cmNlS2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW3NvdXJjZUtleV07XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIHVuc2V0TmF0aXZlVmFsdWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXNbc291cmNlS2V5XSA9IHZhbHVlU291cmNlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNvbnZlcnRlciAmJiB0eXBlb2YgYm94ZWRWYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlQ29udmVydGVyKGJveGVkVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodW5zZXROYXRpdmVWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmlldy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZFN0eWxlID0gY2hpbGQuc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZFZhbHVlU291cmNlID0gY2hpbGRTdHlsZVtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkVmFsdWVTb3VyY2UgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXREZWZhdWx0RnVuYy5jYWxsKGNoaWxkU3R5bGUsIGV4cG9ydHMudW5zZXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW5oZXJpdGVkRnVuYy5jYWxsKGNoaWxkU3R5bGUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTsgfTtcbiAgICAgICAgdmFyIHNldERlZmF1bHRGdW5jID0gc2V0RnVuYygwKTtcbiAgICAgICAgdmFyIHNldEluaGVyaXRlZEZ1bmMgPSBzZXRGdW5jKDEpO1xuICAgICAgICBfdGhpcy5zZXRJbmhlcml0ZWRWYWx1ZSA9IHNldEluaGVyaXRlZEZ1bmM7XG4gICAgICAgIF90aGlzLmNzc1ZhbHVlRGVzY3JpcHRvci5zZXQgPSBzZXRGdW5jKDIpO1xuICAgICAgICBfdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvci5zZXQgPSBzZXRGdW5jKDMpO1xuICAgICAgICBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXMucHVzaChfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIEluaGVyaXRlZENzc1Byb3BlcnR5O1xufShDc3NQcm9wZXJ0eSkpO1xuZXhwb3J0cy5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSA9IEluaGVyaXRlZENzc1Byb3BlcnR5O1xudmFyIFNob3J0aGFuZFByb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTaG9ydGhhbmRQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdmFyIGtleSA9IFN5bWJvbCh0aGlzLm5hbWUgKyBcIjpwcm9wZXJ0eUtleVwiKTtcbiAgICAgICAgdGhpcy5rZXkgPSBrZXk7XG4gICAgICAgIHRoaXMuY3NzTmFtZSA9IFwiY3NzOlwiICsgb3B0aW9ucy5jc3NOYW1lO1xuICAgICAgICB0aGlzLmNzc0xvY2FsTmFtZSA9IFwiXCIgKyBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHZhciBjb252ZXJ0ZXIgPSBvcHRpb25zLmNvbnZlcnRlcjtcbiAgICAgICAgZnVuY3Rpb24gc2V0TG9jYWxWYWx1ZSh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInNldExvY2FsVmFsdWUgbm90IGV4ZWN1dGVkIHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3Ll9iYXRjaFVwZGF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGNvbnZlcnRlcih2YWx1ZSk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9hW19pXSwgcCA9IF9iWzBdLCB2ID0gX2JbMV07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzW3AubmFtZV0gPSB2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldENzc1ZhbHVlKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwic2V0Q3NzVmFsdWUgbm90IGV4ZWN1dGVkIHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3Ll9iYXRjaFVwZGF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGNvbnZlcnRlcih2YWx1ZSk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfYiA9IF9hW19pXSwgcCA9IF9iWzBdLCB2ID0gX2JbMV07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzW3AuY3NzTmFtZV0gPSB2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGdldDogb3B0aW9ucy5nZXR0ZXIsXG4gICAgICAgICAgICBzZXQ6IHNldENzc1ZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBvcHRpb25zLmdldHRlcixcbiAgICAgICAgICAgIHNldDogc2V0TG9jYWxWYWx1ZVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnByb3BlcnR5QmFnRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGNvbnZlcnRlcih2YWx1ZSkuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gX2FbMF0sIHZhbHVlID0gX2FbMV07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzW3Byb3BlcnR5LmNzc0xvY2FsTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY3NzU3ltYm9sUHJvcGVydHlNYXBba2V5XSA9IHRoaXM7XG4gICAgfVxuICAgIFNob3J0aGFuZFByb3BlcnR5LnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyB0aGlzLm5hbWUgKyBcIiBhbHJlYWR5IHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLm5hbWUsIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5jc3NOYW1lLCB0aGlzLmNzc1ZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIGlmICh0aGlzLmNzc0xvY2FsTmFtZSAhPT0gdGhpcy5jc3NOYW1lKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgdGhpcy5jc3NMb2NhbE5hbWUsIHRoaXMubG9jYWxWYWx1ZURlc2NyaXB0b3IpO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLlByb3BlcnR5QmFnLCB0aGlzLmNzc0xvY2FsTmFtZSwgdGhpcy5wcm9wZXJ0eUJhZ0Rlc2NyaXB0b3IpO1xuICAgIH07XG4gICAgcmV0dXJuIFNob3J0aGFuZFByb3BlcnR5O1xufSgpKTtcbmV4cG9ydHMuU2hvcnRoYW5kUHJvcGVydHkgPSBTaG9ydGhhbmRQcm9wZXJ0eTtcbmZ1bmN0aW9uIGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXNPbih2aWV3KSB7XG4gICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZVByb3BlcnRpZXNfMSA9IGluaGVyaXRhYmxlUHJvcGVydGllczsgX2kgPCBpbmhlcml0YWJsZVByb3BlcnRpZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBpbmhlcml0YWJsZVByb3BlcnRpZXNfMVtfaV07XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIHZhbHVlU291cmNlID0gdmlld1tzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgIGlmICh2YWx1ZVNvdXJjZSAhPT0gMCkge1xuICAgICAgICAgICAgYXJyYXkucHVzaCh7IHByb3BlcnR5OiBwcm9wLCB2YWx1ZTogdmlld1twcm9wLm5hbWVdIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbn1cbmZ1bmN0aW9uIGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXNPbihzdHlsZSkge1xuICAgIHZhciBhcnJheSA9IG5ldyBBcnJheSgpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzEgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXM7IF9pIDwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzXzFbX2ldO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciB2YWx1ZVNvdXJjZSA9IHN0eWxlW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKHZhbHVlU291cmNlICE9PSAwKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKHsgcHJvcGVydHk6IHByb3AsIHZhbHVlOiBzdHlsZVtwcm9wLm5hbWVdIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbn1cbmV4cG9ydHMuaW5pdE5hdGl2ZVZpZXcgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiXFxcInByb3BlcnRpZXNcXFwiLmluaXROYXRpdmVWaWV3XCIsIGZ1bmN0aW9uIGluaXROYXRpdmVWaWV3KHZpZXcpIHtcbiAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICBhcHBseVBlbmRpbmdOYXRpdmVTZXR0ZXJzKHZpZXcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXBwbHlBbGxOYXRpdmVTZXR0ZXJzKHZpZXcpO1xuICAgIH1cbiAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzID0ge307XG59KTtcbmZ1bmN0aW9uIGFwcGx5UGVuZGluZ05hdGl2ZVNldHRlcnModmlldykge1xuICAgIHZhciBzdXNwZW5kZWRVcGRhdGVzID0gdmlldy5fc3VzcGVuZGVkVXBkYXRlcztcbiAgICBmb3IgKHZhciBwcm9wZXJ0eU5hbWUgaW4gc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV07XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBwcm9wZXJ0eS5zZXROYXRpdmU7XG4gICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgIHZhciBnZXREZWZhdWx0ID0gcHJvcGVydHkuZ2V0RGVmYXVsdCwgaXNTdHlsZVByb3BlcnR5ID0gcHJvcGVydHkuaXNTdHlsZVByb3BlcnR5LCBkZWZhdWx0VmFsdWVLZXkgPSBwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXksIGRlZmF1bHRWYWx1ZSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChpc1N0eWxlUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5pc1NldCh2aWV3LnN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZVtkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZpZXcuc3R5bGVbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc3R5bGVbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkuaXNTZXQodmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHZpZXcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3W2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmlld1twcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2aWV3W2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycyA9IGFwcGx5UGVuZGluZ05hdGl2ZVNldHRlcnM7XG5mdW5jdGlvbiBhcHBseUFsbE5hdGl2ZVNldHRlcnModmlldykge1xuICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh2aWV3KTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfMiA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc18yW19pXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gc3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IHByb3BlcnR5LnNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBwcm9wZXJ0eS5nZXREZWZhdWx0O1xuICAgICAgICBpZiAoc2V0TmF0aXZlIGluIHZpZXcpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdmlldykpIHtcbiAgICAgICAgICAgICAgICB2aWV3W2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogcHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdmlld1tzeW1ib2xdO1xuICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHN0eWxlKTtcbiAgICBmb3IgKHZhciBfYSA9IDAsIHN5bWJvbHNfMyA9IHN5bWJvbHM7IF9hIDwgc3ltYm9sc18zLmxlbmd0aDsgX2ErKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc18zW19hXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gY3NzU3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiBzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICBzdHlsZVtkZWZhdWx0VmFsdWVLZXldID0gdmlld1twcm9wZXJ0eS5nZXREZWZhdWx0XSA/IHZpZXdbcHJvcGVydHkuZ2V0RGVmYXVsdF0oKSA6IHByb3BlcnR5LmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHN0eWxlW3N5bWJvbF07XG4gICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5hcHBseUFsbE5hdGl2ZVNldHRlcnMgPSBhcHBseUFsbE5hdGl2ZVNldHRlcnM7XG5mdW5jdGlvbiByZXNldE5hdGl2ZVZpZXcodmlldykge1xuICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh2aWV3KTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfNCA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc180Lmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc180W19pXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gc3ltYm9sUHJvcGVydHlNYXBbc3ltYm9sXTtcbiAgICAgICAgaWYgKCFwcm9wZXJ0eSkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleSBpbiB2aWV3KSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHZpZXdbcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHZpZXdbcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXShwcm9wZXJ0eS5kZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc3R5bGUpO1xuICAgIGZvciAodmFyIF9hID0gMCwgc3ltYm9sc181ID0gc3ltYm9sczsgX2EgPCBzeW1ib2xzXzUubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzVbX2FdO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5IGluIHN0eWxlKSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHN0eWxlW3Byb3BlcnR5LmRlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBzdHlsZVtwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5LmRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlc2V0TmF0aXZlVmlldyA9IHJlc2V0TmF0aXZlVmlldztcbmZ1bmN0aW9uIGNsZWFySW5oZXJpdGVkUHJvcGVydGllcyh2aWV3KSB7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZVByb3BlcnRpZXNfMiA9IGluaGVyaXRhYmxlUHJvcGVydGllczsgX2kgPCBpbmhlcml0YWJsZVByb3BlcnRpZXNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBpbmhlcml0YWJsZVByb3BlcnRpZXNfMltfaV07XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgaWYgKHZpZXdbc291cmNlS2V5XSA9PT0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXQuY2FsbCh2aWV3LCBleHBvcnRzLnVuc2V0VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgZm9yICh2YXIgX2EgPSAwLCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMiA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllczsgX2EgPCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMi5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMltfYV07XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgaWYgKHN0eWxlW3NvdXJjZUtleV0gPT09IDEpIHtcbiAgICAgICAgICAgIHByb3Auc2V0SW5oZXJpdGVkVmFsdWUuY2FsbChzdHlsZSwgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJJbmhlcml0ZWRQcm9wZXJ0aWVzID0gY2xlYXJJbmhlcml0ZWRQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gcmVzZXRDU1NQcm9wZXJ0aWVzKHN0eWxlKSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHN0eWxlKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN5bWJvbHNfNiA9IHN5bWJvbHM7IF9pIDwgc3ltYm9sc182Lmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgc3ltYm9sID0gc3ltYm9sc182W19pXTtcbiAgICAgICAgdmFyIGNzc1Byb3BlcnR5ID0gdm9pZCAwO1xuICAgICAgICBpZiAoY3NzUHJvcGVydHkgPSBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdKSB7XG4gICAgICAgICAgICBzdHlsZVtjc3NQcm9wZXJ0eS5jc3NOYW1lXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIGlmIChjc3NQcm9wZXJ0eSBpbnN0YW5jZW9mIENzc0FuaW1hdGlvblByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgc3R5bGVbY3NzUHJvcGVydHkua2V5ZnJhbWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5yZXNldENTU1Byb3BlcnRpZXMgPSByZXNldENTU1Byb3BlcnRpZXM7XG5mdW5jdGlvbiBwcm9wYWdhdGVJbmhlcml0YWJsZVByb3BlcnRpZXModmlldywgY2hpbGQpIHtcbiAgICB2YXIgaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlcyA9IGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXNPbih2aWV3KTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXNfMSA9IGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXM7IF9pIDwgaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcGFpciA9IGluaGVyaXRhYmxlUHJvcGVydHlWYWx1ZXNfMVtfaV07XG4gICAgICAgIHZhciBwcm9wID0gcGFpci5wcm9wZXJ0eTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICB2YXIgY3VycmVudFZhbHVlU291cmNlID0gY2hpbGRbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICBpZiAoY3VycmVudFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgIHByb3Auc2V0SW5oZXJpdGVkVmFsdWUuY2FsbChjaGlsZCwgcGFpci52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcyA9IHByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcztcbmZ1bmN0aW9uIHByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcyhwYXJlbnRTdHlsZSwgY2hpbGRTdHlsZSkge1xuICAgIHZhciBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc09uKHBhcmVudFN0eWxlKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXNfMSA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXM7IF9pIDwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcGFpciA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXNfMVtfaV07XG4gICAgICAgIHZhciBwcm9wID0gcGFpci5wcm9wZXJ0eTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICB2YXIgY3VycmVudFZhbHVlU291cmNlID0gY2hpbGRTdHlsZVtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPD0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKGNoaWxkU3R5bGUsIHBhaXIudmFsdWUsIDEpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5wcm9wYWdhdGVJbmhlcml0YWJsZUNzc1Byb3BlcnRpZXMgPSBwcm9wYWdhdGVJbmhlcml0YWJsZUNzc1Byb3BlcnRpZXM7XG5mdW5jdGlvbiBtYWtlVmFsaWRhdG9yKCkge1xuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YWx1ZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIHNldCA9IG5ldyBTZXQodmFsdWVzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBzZXQuaGFzKHZhbHVlKTsgfTtcbn1cbmV4cG9ydHMubWFrZVZhbGlkYXRvciA9IG1ha2VWYWxpZGF0b3I7XG5mdW5jdGlvbiBtYWtlUGFyc2VyKGlzVmFsaWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBsb3dlciA9IHZhbHVlICYmIHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChpc1ZhbGlkKGxvd2VyKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvd2VyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuZXhwb3J0cy5tYWtlUGFyc2VyID0gbWFrZVBhcnNlcjtcbmZ1bmN0aW9uIGdldFNldFByb3BlcnRpZXModmlldykge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh2aWV3KS5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKFtwcm9wLCB2aWV3W3Byb3BdXSk7XG4gICAgfSk7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc183ID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzcubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzdbX2ldO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmFsdWUgPSB2aWV3W3Byb3BlcnR5LmtleV07XG4gICAgICAgIHJlc3VsdC5wdXNoKFtwcm9wZXJ0eS5uYW1lLCB2YWx1ZV0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5nZXRTZXRQcm9wZXJ0aWVzID0gZ2V0U2V0UHJvcGVydGllcztcbmZ1bmN0aW9uIGdldENvbXB1dGVkQ3NzVmFsdWVzKHZpZXcpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGNzc1Byb3BlcnR5TmFtZXNfMSA9IGNzc1Byb3BlcnR5TmFtZXM7IF9pIDwgY3NzUHJvcGVydHlOYW1lc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGNzc1Byb3BlcnR5TmFtZXNfMVtfaV07XG4gICAgICAgIHJlc3VsdC5wdXNoKFtwcm9wLCBzdHlsZVtwcm9wXV0pO1xuICAgIH1cbiAgICByZXN1bHQucHVzaChbXCJ0b3BcIiwgXCJhdXRvXCJdKTtcbiAgICByZXN1bHQucHVzaChbXCJsZWZ0XCIsIFwiYXV0b1wiXSk7XG4gICAgcmVzdWx0LnB1c2goW1wiYm90dG9tXCIsIFwiYXV0b1wiXSk7XG4gICAgcmVzdWx0LnB1c2goW1wicmlnaHRcIiwgXCJhdXRvXCJdKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5nZXRDb21wdXRlZENzc1ZhbHVlcyA9IGdldENvbXB1dGVkQ3NzVmFsdWVzO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvcGVydGllcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9wcm9wZXJ0aWVzXCIpO1xudmFyIGRlYnVnXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvZGVidWdcIik7XG52YXIgYmluZGFibGVfMSA9IHJlcXVpcmUoXCIuLi9iaW5kYWJsZVwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3BsYXRmb3JtXCIpO1xuZXhwb3J0cy5pc0lPUyA9IHBsYXRmb3JtXzEuaXNJT1M7XG5leHBvcnRzLmlzQW5kcm9pZCA9IHBsYXRmb3JtXzEuaXNBbmRyb2lkO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5leHBvcnRzLmxheW91dCA9IHV0aWxzXzEubGF5b3V0O1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jb2xvclwiKTtcbmV4cG9ydHMuQ29sb3IgPSBjb2xvcl8xLkNvbG9yO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9iaW5kYWJsZVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vcHJvcGVydGllc1wiKSk7XG52YXIgc3NtID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG52YXIgZG9tTm9kZU1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZWRvbU5vZGVNb2R1bGUoKSB7XG4gICAgaWYgKCFkb21Ob2RlTW9kdWxlKSB7XG4gICAgICAgIGRvbU5vZGVNb2R1bGUgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGVidWdnZXIvZG9tLW5vZGVcIik7XG4gICAgfVxufVxudmFyIHN0eWxlU2NvcGVNb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVTdHlsZVNjb3BlTW9kdWxlKCkge1xuICAgIGlmICghc3R5bGVTY29wZU1vZHVsZSkge1xuICAgICAgICBzdHlsZVNjb3BlTW9kdWxlID0gcmVxdWlyZShcInVpL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG4gICAgfVxufVxudmFyIGRlZmF1bHRCaW5kaW5nU291cmNlID0ge307XG5mdW5jdGlvbiBnZXRBbmNlc3Rvcih2aWV3LCBjcml0ZXJpb24pIHtcbiAgICB2YXIgbWF0Y2hlciA9IG51bGw7XG4gICAgaWYgKHR5cGVvZiBjcml0ZXJpb24gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgbWF0Y2hlciA9IGZ1bmN0aW9uICh2aWV3KSB7IHJldHVybiB2aWV3LnR5cGVOYW1lID09PSBjcml0ZXJpb247IH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBtYXRjaGVyID0gZnVuY3Rpb24gKHZpZXcpIHsgcmV0dXJuIHZpZXcgaW5zdGFuY2VvZiBjcml0ZXJpb247IH07XG4gICAgfVxuICAgIGZvciAodmFyIHBhcmVudF8xID0gdmlldy5wYXJlbnQ7IHBhcmVudF8xICE9IG51bGw7IHBhcmVudF8xID0gcGFyZW50XzEucGFyZW50KSB7XG4gICAgICAgIGlmIChtYXRjaGVyKHBhcmVudF8xKSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudF8xO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5nZXRBbmNlc3RvciA9IGdldEFuY2VzdG9yO1xuZnVuY3Rpb24gZ2V0Vmlld0J5SWQodmlldywgaWQpIHtcbiAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHZpZXcuaWQgPT09IGlkKSB7XG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH1cbiAgICB2YXIgcmV0VmFsO1xuICAgIHZhciBkZXNjZW5kYW50c0NhbGxiYWNrID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGlmIChjaGlsZC5pZCA9PT0gaWQpIHtcbiAgICAgICAgICAgIHJldFZhbCA9IGNoaWxkO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgZWFjaERlc2NlbmRhbnQodmlldywgZGVzY2VuZGFudHNDYWxsYmFjayk7XG4gICAgcmV0dXJuIHJldFZhbDtcbn1cbmV4cG9ydHMuZ2V0Vmlld0J5SWQgPSBnZXRWaWV3QnlJZDtcbmZ1bmN0aW9uIGVhY2hEZXNjZW5kYW50KHZpZXcsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFjYWxsYmFjayB8fCAhdmlldykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjb250aW51ZUl0ZXJhdGlvbjtcbiAgICB2YXIgbG9jYWxDYWxsYmFjayA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjb250aW51ZUl0ZXJhdGlvbiA9IGNhbGxiYWNrKGNoaWxkKTtcbiAgICAgICAgaWYgKGNvbnRpbnVlSXRlcmF0aW9uKSB7XG4gICAgICAgICAgICBjaGlsZC5lYWNoQ2hpbGQobG9jYWxDYWxsYmFjayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbnRpbnVlSXRlcmF0aW9uO1xuICAgIH07XG4gICAgdmlldy5lYWNoQ2hpbGQobG9jYWxDYWxsYmFjayk7XG59XG5leHBvcnRzLmVhY2hEZXNjZW5kYW50ID0gZWFjaERlc2NlbmRhbnQ7XG52YXIgdmlld0lkQ291bnRlciA9IDE7XG52YXIgRmxhZ3M7XG4oZnVuY3Rpb24gKEZsYWdzKSB7XG4gICAgRmxhZ3NbXCJzdXBlck9uTG9hZGVkQ2FsbGVkXCJdID0gXCJMb2FkZWRcIjtcbiAgICBGbGFnc1tcInN1cGVyT25VbmxvYWRlZENhbGxlZFwiXSA9IFwiVW5sb2FkZWRcIjtcbn0pKEZsYWdzIHx8IChGbGFncyA9IHt9KSk7XG52YXIgU3VzcGVuZFR5cGU7XG4oZnVuY3Rpb24gKFN1c3BlbmRUeXBlKSB7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJJbmNyZW1lbnRhbFwiXSA9IDBdID0gXCJJbmNyZW1lbnRhbFwiO1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiTG9hZGVkXCJdID0gMTA0ODU3Nl0gPSBcIkxvYWRlZFwiO1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiTmF0aXZlVmlld1wiXSA9IDIwOTcxNTJdID0gXCJOYXRpdmVWaWV3XCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJVSVNldHVwXCJdID0gNDE5NDMwNF0gPSBcIlVJU2V0dXBcIjtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIkluY3JlbWVudGFsQ291bnRNYXNrXCJdID0gLTczNDAwMzNdID0gXCJJbmNyZW1lbnRhbENvdW50TWFza1wiO1xufSkoU3VzcGVuZFR5cGUgfHwgKFN1c3BlbmRUeXBlID0ge30pKTtcbihmdW5jdGlvbiAoU3VzcGVuZFR5cGUpIHtcbiAgICBmdW5jdGlvbiB0b1N0cmluZyh0eXBlKSB7XG4gICAgICAgIHJldHVybiAodHlwZSA/IFwic3VzcGVuZGVkXCIgOiBcInJlc3VtZWRcIikgKyBcIihcIiArXG4gICAgICAgICAgICBcIkluY3JlbWVudGFsOiBcIiArICh0eXBlICYgU3VzcGVuZFR5cGUuSW5jcmVtZW50YWxDb3VudE1hc2spICsgXCIsIFwiICtcbiAgICAgICAgICAgIFwiTG9hZGVkOiBcIiArICEodHlwZSAmIFN1c3BlbmRUeXBlLkxvYWRlZCkgKyBcIiwgXCIgK1xuICAgICAgICAgICAgXCJOYXRpdmVWaWV3OiBcIiArICEodHlwZSAmIFN1c3BlbmRUeXBlLk5hdGl2ZVZpZXcpICsgXCIsIFwiICtcbiAgICAgICAgICAgIFwiVUlTZXR1cDogXCIgKyAhKHR5cGUgJiBTdXNwZW5kVHlwZS5VSVNldHVwKSArXG4gICAgICAgICAgICBcIilcIjtcbiAgICB9XG4gICAgU3VzcGVuZFR5cGUudG9TdHJpbmcgPSB0b1N0cmluZztcbn0pKFN1c3BlbmRUeXBlIHx8IChTdXNwZW5kVHlwZSA9IHt9KSk7XG52YXIgVmlld0Jhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhWaWV3QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWaWV3QmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX29uTG9hZGVkQ2FsbGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9vblVubG9hZGVkQ2FsbGVkID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9jc3NTdGF0ZSA9IG5ldyBzc20uQ3NzU3RhdGUobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgX3RoaXMucHNldWRvQ2xhc3NBbGlhc2VzID0ge1xuICAgICAgICAgICAgXCJoaWdobGlnaHRlZFwiOiBbXG4gICAgICAgICAgICAgICAgXCJhY3RpdmVcIixcbiAgICAgICAgICAgICAgICBcInByZXNzZWRcIlxuICAgICAgICAgICAgXVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5jc3NDbGFzc2VzID0gbmV3IFNldCgpO1xuICAgICAgICBfdGhpcy5jc3NQc2V1ZG9DbGFzc2VzID0gbmV3IFNldCgpO1xuICAgICAgICBfdGhpcy5fZG9tSWQgPSB2aWV3SWRDb3VudGVyKys7XG4gICAgICAgIF90aGlzLl9zdHlsZSA9IG5ldyBwcm9wZXJ0aWVzXzEuU3R5bGUobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcInBhcmVudE5vZGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZVBhcmVudCB8fCB0aGlzLnBhcmVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgdGhpcy5fdGVtcGxhdGVQYXJlbnQgPSBub2RlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcIm5hdGl2ZVZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnNldE5hdGl2ZVZpZXcodmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcInR5cGVOYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZXMuZ2V0Q2xhc3ModGhpcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwic3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoaW5saW5lU3R5bGUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5saW5lU3R5bGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldElubGluZVN0eWxlKGlubGluZVN0eWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZpZXcuc3R5bGUgcHJvcGVydHkgaXMgcmVhZC1vbmx5LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJhbmRyb2lkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5kcm9pZFZpZXc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW9zVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJpc0xvYWRlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzTG9hZGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImNsYXNzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc05hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gdjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmdldFZpZXdCeUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHJldHVybiBnZXRWaWV3QnlJZCh0aGlzLCBpZCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcInBhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5wYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5lbnN1cmVEb21Ob2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgZW5zdXJlZG9tTm9kZU1vZHVsZSgpO1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlID0gbmV3IGRvbU5vZGVNb2R1bGUuRE9NTm9kZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzW25hbWVdID0gYmluZGFibGVfMS5XcmFwcGVkVmFsdWUudW53cmFwKHZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXRGbGFnKEZsYWdzLnN1cGVyT25Mb2FkZWRDYWxsZWQsIHRydWUpO1xuICAgICAgICBpZiAodGhpcy5faXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pc0xvYWRlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX2Nzc1N0YXRlLm9uTG9hZGVkKCk7XG4gICAgICAgIHRoaXMuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuTG9hZGVkKTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBfdGhpcy5sb2FkVmlldyhjaGlsZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2VtaXQoXCJsb2FkZWRcIik7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXRGbGFnKEZsYWdzLnN1cGVyT25VbmxvYWRlZENhbGxlZCwgdHJ1ZSk7XG4gICAgICAgIGlmICghdGhpcy5faXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5Mb2FkZWQpO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIF90aGlzLnVubG9hZFZpZXcoY2hpbGQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9pc0xvYWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jc3NTdGF0ZS5vblVubG9hZGVkKCk7XG4gICAgICAgIHRoaXMuX2VtaXQoXCJ1bmxvYWRlZFwiKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCA9IHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgfCB0eXBlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCsrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICBpZiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCA9IHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgJiB+dHlwZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICgodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCAmIFN1c3BlbmRUeXBlLkluY3JlbWVudGFsQ291bnRNYXNrKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY2FsbCB0byBcIiArIHRoaXMgKyBcIi5fcmVzdW1lTmF0aXZlVXBkYXRlc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQtLTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgIHRoaXMub25SZXN1bWVOYXRpdmVVcGRhdGVzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYmF0Y2hVcGRhdGUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkluY3JlbWVudGFsKTtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5fcmVzdW1lTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5JbmNyZW1lbnRhbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zZXRGbGFnID0gZnVuY3Rpb24gKGZsYWcsIHZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAoZmxhZykge1xuICAgICAgICAgICAgY2FzZSBGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHRoaXMuX29uTG9hZGVkQ2FsbGVkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIEZsYWdzLnN1cGVyT25VbmxvYWRlZENhbGxlZDpcbiAgICAgICAgICAgICAgICB0aGlzLl9vblVubG9hZGVkQ2FsbGVkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5pc0ZsYWdTZXQgPSBmdW5jdGlvbiAoZmxhZykge1xuICAgICAgICBzd2l0Y2ggKGZsYWcpIHtcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPbkxvYWRlZENhbGxlZDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb25Mb2FkZWRDYWxsZWQ7XG4gICAgICAgICAgICBjYXNlIEZsYWdzLnN1cGVyT25VbmxvYWRlZENhbGxlZDpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb25VbmxvYWRlZENhbGxlZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNhbGxGdW5jdGlvbldpdGhTdXBlciA9IGZ1bmN0aW9uIChmbGFnLCBmdW5jKSB7XG4gICAgICAgIHRoaXMuc2V0RmxhZyhmbGFnLCBmYWxzZSk7XG4gICAgICAgIGZ1bmMoKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzRmxhZ1NldChmbGFnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic3VwZXIuXCIgKyBmbGFnICsgXCIgbm90IGNhbGxlZCBpbiBcIiArIHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY2FsbExvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5jYWxsRnVuY3Rpb25XaXRoU3VwZXIoRmxhZ3Muc3VwZXJPbkxvYWRlZENhbGxlZCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMub25Mb2FkZWQoKTsgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY2FsbFVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbGxGdW5jdGlvbldpdGhTdXBlcihGbGFncy5zdXBlck9uVW5sb2FkZWRDYWxsZWQsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLm9uVW5sb2FkZWQoKTsgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUubm90aWZ5UHNldWRvQ2xhc3NDaGFuZ2VkID0gZnVuY3Rpb24gKHBzZXVkb0NsYXNzKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBcIjpcIiArIHBzZXVkb0NsYXNzLCBvYmplY3Q6IHRoaXMgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZ2V0QWxsQWxpYXNlZFN0YXRlcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBhbGxTdGF0ZXMgPSBbXTtcbiAgICAgICAgYWxsU3RhdGVzLnB1c2gobmFtZSk7XG4gICAgICAgIGlmIChuYW1lIGluIHRoaXMucHNldWRvQ2xhc3NBbGlhc2VzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucHNldWRvQ2xhc3NBbGlhc2VzW25hbWVdLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYWxsU3RhdGVzLnB1c2godGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXNbbmFtZV1baV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGxTdGF0ZXM7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuYWRkUHNldWRvQ2xhc3MgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgYWxsU3RhdGVzID0gdGhpcy5nZXRBbGxBbGlhc2VkU3RhdGVzKG5hbWUpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbFN0YXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNzc1BzZXVkb0NsYXNzZXMuaGFzKGFsbFN0YXRlc1tpXSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNzc1BzZXVkb0NsYXNzZXMuYWRkKGFsbFN0YXRlc1tpXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlQc2V1ZG9DbGFzc0NoYW5nZWQoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmRlbGV0ZVBzZXVkb0NsYXNzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGFsbFN0YXRlcyA9IHRoaXMuZ2V0QWxsQWxpYXNlZFN0YXRlcyhuYW1lKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbGxTdGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNzc1BzZXVkb0NsYXNzZXMuaGFzKGFsbFN0YXRlc1tpXSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNzc1BzZXVkb0NsYXNzZXMuZGVsZXRlKGFsbFN0YXRlc1tpXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlQc2V1ZG9DbGFzc0NoYW5nZWQoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuYmluZGluZ3MuZ2V0KFwiYmluZGluZ0NvbnRleHRcIikuYmluZChkYXRhLnZhbHVlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKG9wdGlvbnMsIHNvdXJjZSkge1xuICAgICAgICBpZiAoc291cmNlID09PSB2b2lkIDApIHsgc291cmNlID0gZGVmYXVsdEJpbmRpbmdTb3VyY2U7IH1cbiAgICAgICAgdmFyIHRhcmdldFByb3BlcnR5ID0gb3B0aW9ucy50YXJnZXRQcm9wZXJ0eTtcbiAgICAgICAgdGhpcy51bmJpbmQodGFyZ2V0UHJvcGVydHkpO1xuICAgICAgICBpZiAoIXRoaXMuYmluZGluZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuYmluZGluZ3MgPSBuZXcgTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJpbmRpbmcgPSBuZXcgYmluZGFibGVfMS5CaW5kaW5nKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmJpbmRpbmdzLnNldCh0YXJnZXRQcm9wZXJ0eSwgYmluZGluZyk7XG4gICAgICAgIHZhciBiaW5kaW5nU291cmNlID0gc291cmNlO1xuICAgICAgICBpZiAoYmluZGluZ1NvdXJjZSA9PT0gZGVmYXVsdEJpbmRpbmdTb3VyY2UpIHtcbiAgICAgICAgICAgIGJpbmRpbmdTb3VyY2UgPSB0aGlzLmJpbmRpbmdDb250ZXh0O1xuICAgICAgICAgICAgYmluZGluZy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRQcm9wZXJ0eSA9PT0gXCJiaW5kaW5nQ29udGV4dFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dEJvdW5kVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMiA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRfMikge1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnRfMi5vbihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQWRkSGFuZGxlclRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYmluZGluZy5iaW5kKGJpbmRpbmdTb3VyY2UpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICB2YXIgYmluZGluZ3MgPSB0aGlzLmJpbmRpbmdzO1xuICAgICAgICBpZiAoIWJpbmRpbmdzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJpbmRpbmcgPSBiaW5kaW5ncy5nZXQocHJvcGVydHkpO1xuICAgICAgICBpZiAoYmluZGluZykge1xuICAgICAgICAgICAgYmluZGluZy51bmJpbmQoKTtcbiAgICAgICAgICAgIGJpbmRpbmdzLmRlbGV0ZShwcm9wZXJ0eSk7XG4gICAgICAgICAgICBpZiAoYmluZGluZy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG91bGRBZGRIYW5kbGVyVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dEJvdW5kVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudF8zID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnRfMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50XzMub2ZmKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUucmVxdWVzdExheW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICBwYXJlbnQucmVxdWVzdExheW91dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2FkZFZpZXcgPSBmdW5jdGlvbiAodmlldywgYXRJbmRleCkge1xuICAgICAgICBpZiAoYmluZGFibGVfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgYmluZGFibGVfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5fYWRkVmlldyhcIiArIHZpZXcgKyBcIiwgXCIgKyBhdEluZGV4ICsgXCIpXCIsIGJpbmRhYmxlXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0aW5nIGEgdmFsaWQgVmlldyBpbnN0YW5jZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEodmlldyBpbnN0YW5jZW9mIFZpZXdCYXNlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHZpZXcgKyBcIiBpcyBub3QgYSB2YWxpZCBWaWV3IGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlldy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZpZXcgYWxyZWFkeSBoYXMgYSBwYXJlbnQuIFZpZXc6IFwiICsgdmlldyArIFwiIFBhcmVudDogXCIgKyB2aWV3LnBhcmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgdmlldy5wYXJlbnQgPSB0aGlzO1xuICAgICAgICB0aGlzLl9hZGRWaWV3Q29yZSh2aWV3LCBhdEluZGV4KTtcbiAgICAgICAgdmlldy5fcGFyZW50Q2hhbmdlZChudWxsKTtcbiAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlLm9uQ2hpbGRBZGRlZCh2aWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9hZGRWaWV3Q29yZSA9IGZ1bmN0aW9uICh2aWV3LCBhdEluZGV4KSB7XG4gICAgICAgIHByb3BlcnRpZXNfMS5wcm9wYWdhdGVJbmhlcml0YWJsZVByb3BlcnRpZXModGhpcywgdmlldyk7XG4gICAgICAgIHZpZXcuX2luaGVyaXRTdHlsZVNjb3BlKHRoaXMuX3N0eWxlU2NvcGUpO1xuICAgICAgICBwcm9wZXJ0aWVzXzEucHJvcGFnYXRlSW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzKHRoaXMuc3R5bGUsIHZpZXcuc3R5bGUpO1xuICAgICAgICBpZiAodGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgdmlldy5fc2V0dXBVSSh0aGlzLl9jb250ZXh0LCBhdEluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5faXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZFZpZXcodmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5sb2FkVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh2aWV3ICYmICF2aWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB2aWV3LmNhbGxMb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnVubG9hZFZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICBpZiAodmlldyAmJiB2aWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB2aWV3LmNhbGxVbmxvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3JlbW92ZVZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICBpZiAoYmluZGFibGVfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgYmluZGFibGVfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5fcmVtb3ZlVmlldyhcIiArIHZpZXcgKyBcIilcIiwgYmluZGFibGVfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXcucGFyZW50ICE9PSB0aGlzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWaWV3IG5vdCBhZGRlZCB0byB0aGlzIGluc3RhbmNlLiBWaWV3OiBcIiArIHZpZXcgKyBcIiBDdXJyZW50UGFyZW50OiBcIiArIHZpZXcucGFyZW50ICsgXCIgRXhwZWN0ZWRQYXJlbnQ6IFwiICsgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlLm9uQ2hpbGRSZW1vdmVkKHZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlbW92ZVZpZXdDb3JlKHZpZXcpO1xuICAgICAgICB2aWV3LnBhcmVudCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmlldy5fcGFyZW50Q2hhbmdlZCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVtb3ZlVmlld0NvcmUgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB0aGlzLnVubG9hZFZpZXcodmlldyk7XG4gICAgICAgIGlmICh2aWV3Ll9jb250ZXh0KSB7XG4gICAgICAgICAgICB2aWV3Ll90ZWFyRG93blVJKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXdJbnRlcm5hbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fc2V0dXBBc1Jvb3RWaWV3ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fc2V0dXBVSShjb250ZXh0KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fc2V0dXBVSSA9IGZ1bmN0aW9uIChjb250ZXh0LCBhdEluZGV4LCBwYXJlbnRJc0xvYWRlZCkge1xuICAgICAgICBpZiAodGhpcy5fY29udGV4dCA9PT0gY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3RlYXJEb3duVUkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcgPSB0aGlzLmNyZWF0ZU5hdGl2ZVZpZXcoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0FuZHJvaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX2FuZHJvaWRWaWV3ID0gbmF0aXZlVmlldztcbiAgICAgICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzUGFkZGluZ1JlbGF0aXZlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNQYWRkaW5nUmVsYXRpdmUgPSBuYXRpdmVWaWV3LmlzUGFkZGluZ1JlbGF0aXZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBuYXRpdmVWaWV3LmRlZmF1bHRQYWRkaW5ncztcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gb3JnLm5hdGl2ZXNjcmlwdC53aWRnZXRzLlZpZXdIZWxwZXIuZ2V0UGFkZGluZyhuYXRpdmVWaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5kZWZhdWx0UGFkZGluZ3MgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nVG9wID0gcmVzdWx0LnRvcDtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0UGFkZGluZ1JpZ2h0ID0gcmVzdWx0LnJpZ2h0O1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nQm90dG9tID0gcmVzdWx0LmJvdHRvbTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQgPSByZXN1bHQubGVmdDtcbiAgICAgICAgICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLnN0eWxlO1xuICAgICAgICAgICAgICAgIGlmICghc3R5bGVfcHJvcGVydGllc18xLnBhZGRpbmdUb3BQcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wID0gdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc3R5bGVfcHJvcGVydGllc18xLnBhZGRpbmdSaWdodFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA9IHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc3R5bGVfcHJvcGVydGllc18xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tID0gdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghc3R5bGVfcHJvcGVydGllc18xLnBhZGRpbmdMZWZ0UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgPSB0aGlzLl9kZWZhdWx0UGFkZGluZ0xlZnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faW9zVmlldyA9IG5hdGl2ZVZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KG5hdGl2ZVZpZXcpO1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVJbmRleCA9IHRoaXMucGFyZW50Ll9jaGlsZEluZGV4VG9OYXRpdmVDaGlsZEluZGV4KGF0SW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSA9IHRoaXMucGFyZW50Ll9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlKHRoaXMsIG5hdGl2ZUluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLlVJU2V0dXApO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl9zZXR1cFVJKGNvbnRleHQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNldE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMuX19uYXRpdmVWaWV3ID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9fbmF0aXZlVmlldykge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuTmF0aXZlVmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fX25hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuX19uYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5pbml0TmF0aXZlVmlldygpO1xuICAgICAgICAgICAgdGhpcy5fcmVzdW1lTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5OYXRpdmVWaWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl90ZWFyRG93blVJID0gZnVuY3Rpb24gKGZvcmNlKSB7XG4gICAgICAgIGlmICghdGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzZXROYXRpdmVWaWV3SW50ZXJuYWwoKTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5fdGVhckRvd25VSShmb3JjZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRpc3Bvc2VOYXRpdmVWaWV3KCk7XG4gICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLlVJU2V0dXApO1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0FuZHJvaWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyhudWxsKTtcbiAgICAgICAgICAgIHRoaXMuX2FuZHJvaWRWaWV3ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuZG9tTm9kZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9jaGlsZEluZGV4VG9OYXRpdmVDaGlsZEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uICh2aWV3LCBhdEluZGV4KSB7XG4gICAgICAgIGlmICh2aWV3Ll9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDaGlsZCBhbHJlYWR5IGFkZGVkIHRvIHRoZSBuYXRpdmUgdmlzdWFsIHRyZWUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2aWV3Ll9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2dvVG9WaXN1YWxTdGF0ZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICBpZiAoYmluZGFibGVfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgYmluZGFibGVfMS50cmFjZVdyaXRlKHRoaXMgKyBcIiBnb2luZyB0byBzdGF0ZTogXCIgKyBzdGF0ZSwgYmluZGFibGVfMS50cmFjZUNhdGVnb3JpZXMuU3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGF0ZSA9PT0gdGhpcy5fdmlzdWFsU3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRlbGV0ZVBzZXVkb0NsYXNzKHRoaXMuX3Zpc3VhbFN0YXRlKTtcbiAgICAgICAgdGhpcy5fdmlzdWFsU3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgdGhpcy5hZGRQc2V1ZG9DbGFzcyhzdGF0ZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2FwcGx5WG1sQXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZSwgdmFsdWUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJWaWV3QmFzZS5fYXBwbHlYbWxBdHRyaWJ1dGUoLi4uKSBpcyBkZXByZWNhdGVkOyBzZXQgYXR0cmlidXRlcyBhcyBwbGFpbiBwcm9wZXJ0aWVzIGluc3RlYWRcIik7XG4gICAgICAgIGlmIChhdHRyaWJ1dGUgPT09IFwic3R5bGVcIiB8fCBhdHRyaWJ1dGUgPT09IFwicm93c1wiIHx8IGF0dHJpYnV0ZSA9PT0gXCJjb2x1bW5zXCIgfHwgYXR0cmlidXRlID09PSBcImZvbnRBdHRyaWJ1dGVzXCIpIHtcbiAgICAgICAgICAgIHRoaXNbYXR0cmlidXRlXSA9IHZhbHVlO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNldElubGluZVN0eWxlID0gZnVuY3Rpb24gKHN0eWxlKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc3R5bGUgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhcmFtZXRlciBzaG91bGQgYmUgdmFsaWQgQ1NTIHN0cmluZyFcIik7XG4gICAgICAgIH1cbiAgICAgICAgZW5zdXJlU3R5bGVTY29wZU1vZHVsZSgpO1xuICAgICAgICBzdHlsZVNjb3BlTW9kdWxlLmFwcGx5SW5saW5lU3R5bGUodGhpcywgc3R5bGUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9wYXJlbnRDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFBhcmVudCkge1xuICAgICAgICB2YXIgbmV3UGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChvbGRQYXJlbnQpIHtcbiAgICAgICAgICAgIHByb3BlcnRpZXNfMS5jbGVhckluaGVyaXRlZFByb3BlcnRpZXModGhpcyk7XG4gICAgICAgICAgICBpZiAodGhpcy5iaW5kaW5nQ29udGV4dEJvdW5kVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBvbGRQYXJlbnQub2ZmKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuc2hvdWxkQWRkSGFuZGxlclRvUGFyZW50QmluZGluZ0NvbnRleHRDaGFuZ2VkKSB7XG4gICAgICAgICAgICBuZXdQYXJlbnQub24oXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmJpbmRpbmdzLmdldChcImJpbmRpbmdDb250ZXh0XCIpLmJpbmQobmV3UGFyZW50LmJpbmRpbmdDb250ZXh0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLm9uUmVzdW1lTmF0aXZlVXBkYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcHJvcGVydGllc18xLmluaXROYXRpdmVWaWV3KHRoaXMpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RyID0gdGhpcy50eXBlTmFtZTtcbiAgICAgICAgaWYgKHRoaXMuaWQpIHtcbiAgICAgICAgICAgIHN0ciArPSBcIjxcIiArIHRoaXMuaWQgKyBcIj5cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0ciArPSBcIihcIiArIHRoaXMuX2RvbUlkICsgXCIpXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNvdXJjZSA9IGRlYnVnXzEuU291cmNlLmdldCh0aGlzKTtcbiAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgc3RyICs9IFwiQFwiICsgc291cmNlICsgXCI7XCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fb25Dc3NTdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fY3NzU3RhdGUub25DaGFuZ2UoKTtcbiAgICAgICAgZWFjaERlc2NlbmRhbnQodGhpcywgZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBjaGlsZC5fY3NzU3RhdGUub25DaGFuZ2UoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5faW5oZXJpdFN0eWxlU2NvcGUgPSBmdW5jdGlvbiAoc3R5bGVTY29wZSkge1xuICAgICAgICBpZiAodGhpcy5faXNTdHlsZVNjb3BlSG9zdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9zdHlsZVNjb3BlICE9PSBzdHlsZVNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdHlsZVNjb3BlID0gc3R5bGVTY29wZTtcbiAgICAgICAgICAgIHRoaXMuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIGNoaWxkLl9pbmhlcml0U3R5bGVTY29wZShzdHlsZVNjb3BlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2hvd01vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2hvd01vZGFsLmFwcGx5KHBhcmVudCwgYXJncyk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY2xvc2VNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5jbG9zZU1vZGFsLmFwcGx5KHBhcmVudCwgYXJncyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fZGlhbG9nQ2xvc2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBlYWNoRGVzY2VuZGFudCh0aGlzLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl9kaWFsb2dDbG9zZWQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBlYWNoRGVzY2VuZGFudCh0aGlzLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl9vblJvb3RWaWV3UmVzZXQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLmxvYWRlZEV2ZW50ID0gXCJsb2FkZWRcIjtcbiAgICBWaWV3QmFzZS51bmxvYWRlZEV2ZW50ID0gXCJ1bmxvYWRlZFwiO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIm9uVW5sb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwiYWRkUHNldWRvQ2xhc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwiZGVsZXRlUHNldWRvQ2xhc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwicmVxdWVzdExheW91dFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJfYWRkVmlld1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJfc2V0dXBVSVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJfdGVhckRvd25VSVwiLCBudWxsKTtcbiAgICByZXR1cm4gVmlld0Jhc2U7XG59KGJpbmRhYmxlXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5WaWV3QmFzZSA9IFZpZXdCYXNlO1xuVmlld0Jhc2UucHJvdG90eXBlLmlzQ29sbGFwc2VkID0gZmFsc2U7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZExlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9vbGRUb3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9vbGRSaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZEJvdHRvbSA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWluV2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1pbkhlaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlV2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUhlaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWFyZ2luVG9wID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5SaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWFyZ2luQm90dG9tID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5MZWZ0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVQYWRkaW5nVG9wID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX2RlZmF1bHRQYWRkaW5nVG9wID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdSaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX2RlZmF1bHRQYWRkaW5nQm90dG9tID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdMZWZ0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5faXNWaWV3QmFzZSA9IHRydWU7XG5WaWV3QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcIm5ldmVyXCI7XG5WaWV3QmFzZS5wcm90b3R5cGUuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQgPVxuICAgIFN1c3BlbmRUeXBlLkxvYWRlZCB8XG4gICAgICAgIFN1c3BlbmRUeXBlLk5hdGl2ZVZpZXcgfFxuICAgICAgICBTdXNwZW5kVHlwZS5VSVNldHVwO1xuZXhwb3J0cy5iaW5kaW5nQ29udGV4dFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRQcm9wZXJ0eSh7IG5hbWU6IFwiYmluZGluZ0NvbnRleHRcIiB9KTtcbmV4cG9ydHMuYmluZGluZ0NvbnRleHRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3QmFzZSk7XG5leHBvcnRzLmNsYXNzTmFtZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJjbGFzc05hbWVcIixcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGNsYXNzZXMgPSB2aWV3LmNzc0NsYXNzZXM7XG4gICAgICAgIGNsYXNzZXMuY2xlYXIoKTtcbiAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBuZXdWYWx1ZSAhPT0gXCJcIikge1xuICAgICAgICAgICAgbmV3VmFsdWUuc3BsaXQoXCIgXCIpLmZvckVhY2goZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGNsYXNzZXMuYWRkKGMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLmNsYXNzTmFtZVByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmV4cG9ydHMuaWRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoeyBuYW1lOiBcImlkXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkgeyByZXR1cm4gdmlldy5fb25Dc3NTdGF0ZUNoYW5nZSgpOyB9IH0pO1xuZXhwb3J0cy5pZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmZ1bmN0aW9uIGJvb2xlYW5Db252ZXJ0ZXIodikge1xuICAgIHZhciBsb3dlcmNhc2UgPSAodiArIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGxvd2VyY2FzZSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxvd2VyY2FzZSA9PT0gXCJmYWxzZVwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBib29sZWFuOiBcIiArIHYpO1xufVxuZXhwb3J0cy5ib29sZWFuQ29udmVydGVyID0gYm9vbGVhbkNvbnZlcnRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXctYmFzZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfYmFzZV8xID0gcmVxdWlyZShcIi4uL3ZpZXctYmFzZVwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIGdlc3R1cmVzXzEgPSByZXF1aXJlKFwiLi4vLi4vZ2VzdHVyZXNcIik7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uLy4uL2J1aWxkZXJcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG52YXIgc3R5bGVfc2NvcGVfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXNjb3BlXCIpO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvbGluZWFyLWdyYWRpZW50XCIpO1xuZXhwb3J0cy5MaW5lYXJHcmFkaWVudCA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50O1xuX19leHBvcnQocmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdmlldy1iYXNlXCIpKTtcbnZhciBhbmltYXRpb25Nb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVBbmltYXRpb25Nb2R1bGUoKSB7XG4gICAgaWYgKCFhbmltYXRpb25Nb2R1bGUpIHtcbiAgICAgICAgYW5pbWF0aW9uTW9kdWxlID0gcmVxdWlyZShcInVpL2FuaW1hdGlvblwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBDU1NUeXBlKHR5cGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBjbHMucHJvdG90eXBlLmNzc1R5cGUgPSB0eXBlO1xuICAgIH07XG59XG5leHBvcnRzLkNTU1R5cGUgPSBDU1NUeXBlO1xuZnVuY3Rpb24gdmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHZpZXcsIGNvbnRleHQsIHR5cGVzKSB7XG4gICAgcmV0dXJuIGNvbnRleHQgJiZcbiAgICAgICAgdmlldy5fbW9kdWxlTmFtZSAmJlxuICAgICAgICBjb250ZXh0LnR5cGUgJiZcbiAgICAgICAgdHlwZXMuc29tZShmdW5jdGlvbiAodHlwZSkgeyByZXR1cm4gdHlwZSA9PT0gY29udGV4dC50eXBlOyB9KSAmJlxuICAgICAgICBjb250ZXh0LnBhdGggJiZcbiAgICAgICAgY29udGV4dC5wYXRoLmluY2x1ZGVzKHZpZXcuX21vZHVsZU5hbWUpO1xufVxuZXhwb3J0cy52aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQgPSB2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQ7XG5mdW5jdGlvbiBQc2V1ZG9DbGFzc0hhbmRsZXIoKSB7XG4gICAgdmFyIHBzZXVkb0NsYXNzZXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBwc2V1ZG9DbGFzc2VzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBzdGF0ZUV2ZW50TmFtZXMgPSBwc2V1ZG9DbGFzc2VzLm1hcChmdW5jdGlvbiAocykgeyByZXR1cm4gXCI6XCIgKyBzOyB9KTtcbiAgICB2YXIgbGlzdGVuZXJzID0gU3ltYm9sKFwibGlzdGVuZXJzXCIpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoY2hhbmdlKSB7XG4gICAgICAgICAgICB2YXIgcHJldiA9IHRoaXNbbGlzdGVuZXJzXSB8fCAwO1xuICAgICAgICAgICAgdmFyIG5leHQgPSBwcmV2ICsgY2hhbmdlO1xuICAgICAgICAgICAgaWYgKHByZXYgPD0gMCAmJiBuZXh0ID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXNbcHJvcGVydHlLZXldKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocHJldiA+IDAgJiYgbmV4dCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eUtleV0oZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0YXRlRXZlbnROYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7IHJldHVybiB0YXJnZXRbc10gPSB1cGRhdGU7IH0pO1xuICAgIH07XG59XG5leHBvcnRzLlBzZXVkb0NsYXNzSGFuZGxlciA9IFBzZXVkb0NsYXNzSGFuZGxlcjtcbmV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzID0gbmV3IEFycmF5KCk7XG52YXIgVmlld0NvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXdDb21tb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlld0NvbW1vbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzID0ge307XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNjb3BlID0gdGhpcy5fc3R5bGVTY29wZTtcbiAgICAgICAgICAgIHJldHVybiBzY29wZSAmJiBzY29wZS5jc3M7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTdHlsZVNjb3BlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFkZENzcyA9IGZ1bmN0aW9uIChjc3NTdHJpbmcpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGVTY29wZSh1bmRlZmluZWQsIGNzc1N0cmluZyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5hZGRDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUoY3NzRmlsZU5hbWUpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuY2hhbmdlQ3NzRmlsZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSkge1xuICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoc2NvcGUgJiYgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgICAgIHNjb3BlLmNoYW5nZUNzc0ZpbGUoY3NzRmlsZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fdXBkYXRlU3R5bGVTY29wZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpIHtcbiAgICAgICAgdmFyIHNjb3BlID0gdGhpcy5fc3R5bGVTY29wZTtcbiAgICAgICAgaWYgKCFzY29wZSkge1xuICAgICAgICAgICAgc2NvcGUgPSBuZXcgc3R5bGVfc2NvcGVfMS5TdHlsZVNjb3BlKCk7XG4gICAgICAgICAgICB0aGlzLnNldFNjb3BlUHJvcGVydHkoc2NvcGUsIGNzc0ZpbGVOYW1lLCBjc3NTdHJpbmcsIGNzcyk7XG4gICAgICAgICAgICB0aGlzLl9pbmhlcml0U3R5bGVTY29wZShzY29wZSk7XG4gICAgICAgICAgICB0aGlzLl9pc1N0eWxlU2NvcGVIb3N0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcGVQcm9wZXJ0eShzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKTtcbiAgICAgICAgICAgIHRoaXMuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuc2V0U2NvcGVQcm9wZXJ0eSA9IGZ1bmN0aW9uIChzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKSB7XG4gICAgICAgIGlmIChjc3NGaWxlTmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzY29wZS5hZGRDc3NGaWxlKGNzc0ZpbGVOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjc3NTdHJpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2NvcGUuYWRkQ3NzKGNzc1N0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3NzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNjb3BlLmNzcyA9IGNzcztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29uTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9vbkxpdmVzeW5jKFwiICsgSlNPTi5zdHJpbmdpZnkoY29udGV4dCkgKyBcIilcIiwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5faGFuZGxlTGl2ZXN5bmMoY29udGV4dCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoYW5kbGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkVmlldyhmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZC5fb25MaXZlc3luYyhjb250ZXh0KSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBoYW5kbGVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2hhbmRsZUxpdmVzeW5jID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5faGFuZGxlTGl2ZXN5bmMoXCIgKyBKU09OLnN0cmluZ2lmeShjb250ZXh0KSArIFwiKVwiLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQodGhpcywgY29udGV4dCwgW1wic3R5bGVcIl0pKSB7XG4gICAgICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKFwiQ2hhbmdlIEhhbmRsZWQ6IENoYW5naW5nIENTUyBmb3IgXCIgKyB0aGlzLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoY29udGV4dC5wYXRoKSArIFwiLmNzc1wiO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VDc3NGaWxlKGNzc01vZHVsZU5hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCh0aGlzLCBjb250ZXh0LCBbXCJtYXJrdXBcIiwgXCJzY3JpcHRcIl0pICYmXG4gICAgICAgICAgICB0aGlzLnBhZ2UgJiZcbiAgICAgICAgICAgIHRoaXMucGFnZS5mcmFtZSkge1xuICAgICAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZShcIkNoYW5nZSBIYW5kbGVkOiBDaGFuZ2luZyBcIiArIGNvbnRleHQudHlwZSArIFwiIGZvciBcIiArIHRoaXMgKyBcIiBpbnNpZGUgXCIgKyB0aGlzLnBhZ2UsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYWdlLmZyYW1lLl9oYW5kbGVMaXZlc3luYyh7IHR5cGU6IGNvbnRleHQudHlwZSwgcGF0aDogdGhpcy5wYWdlLl9tb2R1bGVOYW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXR1cEFzUm9vdFZpZXcgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zZXR1cEFzUm9vdFZpZXcuY2FsbCh0aGlzLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKCF0aGlzLl9zdHlsZVNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTdHlsZVNjb3BlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9vYnNlcnZlID0gZnVuY3Rpb24gKHR5cGUsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICghdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXSkge1xuICAgICAgICAgICAgdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2dlc3R1cmVPYnNlcnZlcnNbdHlwZV0ucHVzaChnZXN0dXJlc18xLm9ic2VydmUodGhpcywgdHlwZSwgY2FsbGJhY2ssIHRoaXNBcmcpKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldEdlc3R1cmVPYnNlcnZlcnMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYXJnLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgYXJnID0gdmlld19iYXNlXzEuZ2V0RXZlbnRPckdlc3R1cmVOYW1lKGFyZyk7XG4gICAgICAgICAgICB2YXIgZ2VzdHVyZSA9IGdlc3R1cmVzXzEuZnJvbVN0cmluZyhhcmcpO1xuICAgICAgICAgICAgaWYgKGdlc3R1cmUgJiYgIXRoaXMuX2lzRXZlbnQoYXJnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmUoZ2VzdHVyZSwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50cyA9IChhcmcpLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldnQgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdzdCA9IGdlc3R1cmVzXzEuZnJvbVN0cmluZyhldnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdzdCAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZShnc3QsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGV2dCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZShhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZ2VzdHVyZSA9IGdlc3R1cmVzXzEuZnJvbVN0cmluZyhhcmcpO1xuICAgICAgICAgICAgaWYgKGdlc3R1cmUgJiYgIXRoaXMuX2lzRXZlbnQoYXJnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2Nvbm5lY3RHZXN0dXJlT2JzZXJ2ZXJzKGdlc3R1cmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50cyA9IGFyZy5zcGxpdChcIixcIik7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZ0ID0gZXZlbnRzW2ldLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnc3QgPSBnZXN0dXJlc18xLmZyb21TdHJpbmcoZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnc3QgJiYgIXRoaXMuX2lzRXZlbnQoYXJnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2Nvbm5lY3RHZXN0dXJlT2JzZXJ2ZXJzKGdzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBldnQsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwodGhpcywgYXJnLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc2Nvbm5lY3RHZXN0dXJlT2JzZXJ2ZXJzKGFyZyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLm9uQmFja1ByZXNzZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXRGcmFnbWVudE1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNb2RhbE9wdGlvbnMgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInNob3dNb2RhbCB3aXRob3V0IHBhcmFtZXRlcnMgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIGNhbGwgc2hvd01vZGFsIG9uIGEgdmlldyBpbnN0YW5jZSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBhcmdzWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3NbMF0gaW5zdGFuY2VvZiBWaWV3Q29tbW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2hvd01vZGFsKHZpZXc6IFZpZXdCYXNlLCBjb250ZXh0OiBhbnksIGNsb3NlQ2FsbGJhY2s6IEZ1bmN0aW9uLCBmdWxsc2NyZWVuPzogYm9vbGVhbiwgYW5pbWF0ZWQ/OiBib29sZWFuLCBzdHJldGNoZWQ/OiBib29sZWFuKSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlzIGRlcHJlY2F0ZWQuIFVzZSBzaG93TW9kYWwodmlldzogVmlld0Jhc2UsIG1vZGFsT3B0aW9uczogU2hvd01vZGFsT3B0aW9ucykgaW5zdGVhZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInNob3dNb2RhbChtb2R1bGVOYW1lOiBzdHJpbmcsIGNvbnRleHQ6IGFueSwgY2xvc2VDYWxsYmFjazogRnVuY3Rpb24sIGZ1bGxzY3JlZW4/OiBib29sZWFuLCBhbmltYXRlZD86IGJvb2xlYW4sIHN0cmV0Y2hlZD86IGJvb2xlYW4pIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXMgZGVwcmVjYXRlZC4gVXNlIHNob3dNb2RhbChtb2R1bGVOYW1lOiBzdHJpbmcsIG1vZGFsT3B0aW9uczogU2hvd01vZGFsT3B0aW9ucykgaW5zdGVhZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IGFyZ3NbMV0sXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQ2FsbGJhY2s6IGFyZ3NbMl0sXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxzY3JlZW46IGFyZ3NbM10sXG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGVkOiBhcmdzWzRdLFxuICAgICAgICAgICAgICAgICAgICBzdHJldGNoZWQ6IGFyZ3NbNV1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpcnN0QXJndW1lbnQgPSBhcmdzWzBdO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBmaXJzdEFyZ3VtZW50IGluc3RhbmNlb2YgVmlld0NvbW1vblxuICAgICAgICAgICAgICAgID8gZmlyc3RBcmd1bWVudCA6IGJ1aWxkZXJfMS5jcmVhdGVWaWV3RnJvbUVudHJ5KHsgbW9kdWxlTmFtZTogZmlyc3RBcmd1bWVudCB9KTtcbiAgICAgICAgICAgIHJldHVybiB7IHZpZXc6IHZpZXcsIG9wdGlvbnM6IG9wdGlvbnMgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuc2hvd01vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX2EgPSB0aGlzLmdldE1vZGFsT3B0aW9ucyhhcmd1bWVudHMpLCB2aWV3ID0gX2Eudmlldywgb3B0aW9ucyA9IF9hLm9wdGlvbnM7XG4gICAgICAgIHZpZXcuX3Nob3dOYXRpdmVNb2RhbFZpZXcodGhpcywgb3B0aW9ucyk7XG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuY2xvc2VNb2RhbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xvc2VDYWxsYmFjayA9IHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFjaztcbiAgICAgICAgaWYgKGNsb3NlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIGNsb3NlQ2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAocGFyZW50XzEpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRfMS5jbG9zZU1vZGFsLmFwcGx5KHBhcmVudF8xLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcIm1vZGFsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9kYWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zaG93TmF0aXZlTW9kYWxWaWV3ID0gZnVuY3Rpb24gKHBhcmVudCwgb3B0aW9ucykge1xuICAgICAgICBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5wdXNoKHRoaXMpO1xuICAgICAgICBwYXJlbnQuX21vZGFsID0gdGhpcztcbiAgICAgICAgdGhpcy5fbW9kYWxQYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMuX21vZGFsQ29udGV4dCA9IG9wdGlvbnMuY29udGV4dDtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB0aGlzLl9jbG9zZU1vZGFsQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWxBcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIG9yaWdpbmFsQXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoYXQuX2Nsb3NlTW9kYWxDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHZhciBtb2RhbEluZGV4ID0gZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MuaW5kZXhPZih0aGF0KTtcbiAgICAgICAgICAgICAgICBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5zcGxpY2UobW9kYWxJbmRleCk7XG4gICAgICAgICAgICAgICAgdGhhdC5fbW9kYWxQYXJlbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoYXQuX21vZGFsQ29udGV4dCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhhdC5fY2xvc2VNb2RhbENhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGF0Ll9kaWFsb2dDbG9zZWQoKTtcbiAgICAgICAgICAgICAgICBwYXJlbnQuX21vZGFsID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgd2hlbkNsb3NlZENhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMuY2xvc2VDYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmNsb3NlQ2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBvcmlnaW5hbEFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9oaWRlTmF0aXZlTW9kYWxWaWV3KHBhcmVudCwgd2hlbkNsb3NlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9yYWlzZUxheW91dENoYW5nZWRFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IFZpZXdDb21tb24ubGF5b3V0Q2hhbmdlZEV2ZW50LFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JhaXNlU2hvd25Nb2RhbGx5RXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBWaWV3Q29tbW9uLnNob3duTW9kYWxseUV2ZW50LFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5fbW9kYWxDb250ZXh0LFxuICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JhaXNlU2hvd2luZ01vZGFsbHlFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IFZpZXdDb21tb24uc2hvd2luZ01vZGFsbHlFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGNvbnRleHQ6IHRoaXMuX21vZGFsQ29udGV4dCxcbiAgICAgICAgICAgIGNsb3NlQ2FsbGJhY2s6IHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFja1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9pc0V2ZW50ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IgJiYgbmFtZSArIFwiRXZlbnRcIiBpbiB0aGlzLmNvbnN0cnVjdG9yO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2Rpc2Nvbm5lY3RHZXN0dXJlT2JzZXJ2ZXJzID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgdmFyIG9ic2VydmVycyA9IHRoaXMuZ2V0R2VzdHVyZU9ic2VydmVycyh0eXBlKTtcbiAgICAgICAgaWYgKG9ic2VydmVycykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcnNbaV0uZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyVG9wQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclRvcENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJUb3BDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyUmlnaHRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyQm90dG9tQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbUNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21Db2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyTGVmdENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJMZWZ0Q29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckxlZnRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlcldpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyVG9wV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJUb3BXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyUmlnaHRXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyUmlnaHRXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyQm90dG9tV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21XaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyTGVmdFdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJMZWZ0V2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckxlZnRXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyUmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyVG9wTGVmdFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wTGVmdFJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyVG9wTGVmdFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyVG9wUmlnaHRSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJUb3BSaWdodFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYm9yZGVyQm90dG9tTGVmdFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiY29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmNvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5jb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZEltYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZFBvc2l0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYmFja2dyb3VuZFJlcGVhdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZFJlcGVhdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZFJlcGVhdCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWluV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1pbldpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5taW5XaWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWluSGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5taW5IZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1pbkhlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwid2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLndpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS53aWR0aCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiaGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5oZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmhlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWFyZ2luXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW47XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWFyZ2luTGVmdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luTGVmdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luTGVmdCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWFyZ2luVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW5Ub3A7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpblRvcCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWFyZ2luUmlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpblJpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW5SaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibWFyZ2luQm90dG9tXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW5Cb3R0b207XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpbkJvdHRvbSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiaG9yaXpvbnRhbEFsaWdubWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwidmVydGljYWxBbGlnbm1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnZlcnRpY2FsQWxpZ25tZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS52ZXJ0aWNhbEFsaWdubWVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwidmlzaWJpbGl0eVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudmlzaWJpbGl0eTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudmlzaWJpbGl0eSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwib3BhY2l0eVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUub3BhY2l0eTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUub3BhY2l0eSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwicm90YXRlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5yb3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnJvdGF0ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwidHJhbnNsYXRlWFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudHJhbnNsYXRlWDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudHJhbnNsYXRlWCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwidHJhbnNsYXRlWVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudHJhbnNsYXRlWTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudHJhbnNsYXRlWSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwic2NhbGVYXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zY2FsZVg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnNjYWxlWCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwic2NhbGVZXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zY2FsZVk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnNjYWxlWSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYW5kcm9pZEVsZXZhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYW5kcm9pZEVsZXZhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYW5kcm9pZEVsZXZhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiaXNMYXlvdXRWYWxpZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzTGF5b3V0VmFsaWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJjc3NUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Nzc1R5cGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jc3NUeXBlID0gdGhpcy50eXBlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Nzc1R5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2Nzc1R5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVpcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUubWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB0aGlzLl9zZXRDdXJyZW50TWVhc3VyZVNwZWNzKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdGhpcy5fc2V0Q3VycmVudExheW91dEJvdW5kcyhsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TWVhc3VyZWRXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21lYXN1cmVkV2lkdGggJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU0laRV9NQVNLIHx8IDA7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNZWFzdXJlZEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21lYXN1cmVkSGVpZ2h0ICYgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NJWkVfTUFTSyB8fCAwO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TWVhc3VyZWRTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9tZWFzdXJlZFdpZHRoICYgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX01BU0spXG4gICAgICAgICAgICB8ICgodGhpcy5fbWVhc3VyZWRIZWlnaHQgPj4gdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX0hFSUdIVF9TVEFURV9TSElGVClcbiAgICAgICAgICAgICAgICAmICh2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfTUFTSyA+PiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfSEVJR0hUX1NUQVRFX1NISUZUKSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5zZXRNZWFzdXJlZERpbWVuc2lvbiA9IGZ1bmN0aW9uIChtZWFzdXJlZFdpZHRoLCBtZWFzdXJlZEhlaWdodCkge1xuICAgICAgICB0aGlzLl9tZWFzdXJlZFdpZHRoID0gbWVhc3VyZWRXaWR0aDtcbiAgICAgICAgdGhpcy5fbWVhc3VyZWRIZWlnaHQgPSBtZWFzdXJlZEhlaWdodDtcbiAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKHRoaXMgKyBcIiA6c2V0TWVhc3VyZWREaW1lbnNpb246IFwiICsgbWVhc3VyZWRXaWR0aCArIFwiLCBcIiArIG1lYXN1cmVkSGVpZ2h0LCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUucmVxdWVzdExheW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNMYXlvdXRWYWxpZCA9IGZhbHNlO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucmVzb2x2ZVNpemVBbmRTdGF0ZSA9IGZ1bmN0aW9uIChzaXplLCBzcGVjU2l6ZSwgc3BlY01vZGUsIGNoaWxkTWVhc3VyZWRTdGF0ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gc2l6ZTtcbiAgICAgICAgc3dpdGNoIChzcGVjTW9kZSkge1xuICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQ6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHNpemUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDpcbiAgICAgICAgICAgICAgICBpZiAoc3BlY1NpemUgPCBzaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IE1hdGguY2VpbChzcGVjU2l6ZSkgfCB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfVE9PX1NNQUxMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFk6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHNwZWNTaXplKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0IHwgKGNoaWxkTWVhc3VyZWRTdGF0ZSAmIHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9NQVNLKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24uY29tYmluZU1lYXN1cmVkU3RhdGVzID0gZnVuY3Rpb24gKGN1clN0YXRlLCBuZXdTdGF0ZSkge1xuICAgICAgICByZXR1cm4gY3VyU3RhdGUgfCBuZXdTdGF0ZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ubGF5b3V0Q2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCBjaGlsZCwgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBzZXRGcmFtZSkge1xuICAgICAgICBpZiAoc2V0RnJhbWUgPT09IHZvaWQgMCkgeyBzZXRGcmFtZSA9IHRydWU7IH1cbiAgICAgICAgaWYgKCFjaGlsZCB8fCBjaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZFN0eWxlID0gY2hpbGQuc3R5bGU7XG4gICAgICAgIHZhciBjaGlsZFRvcDtcbiAgICAgICAgdmFyIGNoaWxkTGVmdDtcbiAgICAgICAgdmFyIGNoaWxkV2lkdGggPSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCk7XG4gICAgICAgIHZhciBjaGlsZEhlaWdodCA9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCk7XG4gICAgICAgIHZhciBlZmZlY3RpdmVNYXJnaW5Ub3AgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Ub3A7XG4gICAgICAgIHZhciBlZmZlY3RpdmVNYXJnaW5Cb3R0b20gPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgIHZhciB2QWxpZ25tZW50O1xuICAgICAgICBpZiAoY2hpbGQuZWZmZWN0aXZlSGVpZ2h0ID49IDAgJiYgY2hpbGRTdHlsZS52ZXJ0aWNhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIpIHtcbiAgICAgICAgICAgIHZBbGlnbm1lbnQgPSBcIm1pZGRsZVwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdkFsaWdubWVudCA9IGNoaWxkU3R5bGUudmVydGljYWxBbGlnbm1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoICh2QWxpZ25tZW50KSB7XG4gICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSB0b3AgKyBlZmZlY3RpdmVNYXJnaW5Ub3A7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibWlkZGxlXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSB0b3AgKyAoYm90dG9tIC0gdG9wIC0gY2hpbGRIZWlnaHQgKyAoZWZmZWN0aXZlTWFyZ2luVG9wIC0gZWZmZWN0aXZlTWFyZ2luQm90dG9tKSkgLyAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gYm90dG9tIC0gY2hpbGRIZWlnaHQgLSBlZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3RyZXRjaFwiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHRvcCArIGVmZmVjdGl2ZU1hcmdpblRvcDtcbiAgICAgICAgICAgICAgICBjaGlsZEhlaWdodCA9IGJvdHRvbSAtIHRvcCAtIChlZmZlY3RpdmVNYXJnaW5Ub3AgKyBlZmZlY3RpdmVNYXJnaW5Cb3R0b20pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlZmZlY3RpdmVNYXJnaW5MZWZ0ID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luTGVmdDtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpblJpZ2h0ID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgIHZhciBoQWxpZ25tZW50O1xuICAgICAgICBpZiAoY2hpbGQuZWZmZWN0aXZlV2lkdGggPj0gMCAmJiBjaGlsZFN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiKSB7XG4gICAgICAgICAgICBoQWxpZ25tZW50ID0gXCJjZW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGhBbGlnbm1lbnQgPSBjaGlsZFN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQ7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChoQWxpZ25tZW50KSB7XG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IGxlZnQgKyBlZmZlY3RpdmVNYXJnaW5MZWZ0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImNlbnRlclwiOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IGxlZnQgKyAocmlnaHQgLSBsZWZ0IC0gY2hpbGRXaWR0aCArIChlZmZlY3RpdmVNYXJnaW5MZWZ0IC0gZWZmZWN0aXZlTWFyZ2luUmlnaHQpKSAvIDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSByaWdodCAtIGNoaWxkV2lkdGggLSBlZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzdHJldGNoXCI6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IGxlZnQgKyBlZmZlY3RpdmVNYXJnaW5MZWZ0O1xuICAgICAgICAgICAgICAgIGNoaWxkV2lkdGggPSByaWdodCAtIGxlZnQgLSAoZWZmZWN0aXZlTWFyZ2luTGVmdCArIGVmZmVjdGl2ZU1hcmdpblJpZ2h0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRSaWdodCA9IE1hdGgucm91bmQoY2hpbGRMZWZ0ICsgY2hpbGRXaWR0aCk7XG4gICAgICAgIHZhciBjaGlsZEJvdHRvbSA9IE1hdGgucm91bmQoY2hpbGRUb3AgKyBjaGlsZEhlaWdodCk7XG4gICAgICAgIGNoaWxkTGVmdCA9IE1hdGgucm91bmQoY2hpbGRMZWZ0KTtcbiAgICAgICAgY2hpbGRUb3AgPSBNYXRoLnJvdW5kKGNoaWxkVG9wKTtcbiAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKGNoaWxkLnBhcmVudCArIFwiIDpsYXlvdXRDaGlsZDogXCIgKyBjaGlsZCArIFwiIFwiICsgY2hpbGRMZWZ0ICsgXCIsIFwiICsgY2hpbGRUb3AgKyBcIiwgXCIgKyBjaGlsZFJpZ2h0ICsgXCIsIFwiICsgY2hpbGRCb3R0b20sIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkLmxheW91dChjaGlsZExlZnQsIGNoaWxkVG9wLCBjaGlsZFJpZ2h0LCBjaGlsZEJvdHRvbSwgc2V0RnJhbWUpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5tZWFzdXJlQ2hpbGQgPSBmdW5jdGlvbiAocGFyZW50LCBjaGlsZCwgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IDA7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gMDtcbiAgICAgICAgaWYgKGNoaWxkICYmICFjaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgdmFyIHdpZHRoU3BlYyA9IHBhcmVudCA/IHBhcmVudC5fY3VycmVudFdpZHRoTWVhc3VyZVNwZWMgOiB3aWR0aE1lYXN1cmVTcGVjO1xuICAgICAgICAgICAgdmFyIGhlaWdodFNwZWMgPSBwYXJlbnQgPyBwYXJlbnQuX2N1cnJlbnRIZWlnaHRNZWFzdXJlU3BlYyA6IGhlaWdodE1lYXN1cmVTcGVjO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aFNwZWMpO1xuICAgICAgICAgICAgdmFyIHdpZHRoTW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodFNwZWMpO1xuICAgICAgICAgICAgdmFyIGhlaWdodE1vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodFNwZWMpO1xuICAgICAgICAgICAgY2hpbGQuX3VwZGF0ZUVmZmVjdGl2ZUxheW91dFZhbHVlcyh3aWR0aCwgd2lkdGhNb2RlLCBoZWlnaHQsIGhlaWdodE1vZGUpO1xuICAgICAgICAgICAgdmFyIHN0eWxlID0gY2hpbGQuc3R5bGU7XG4gICAgICAgICAgICB2YXIgaG9yaXpvbnRhbE1hcmdpbnMgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICB2YXIgdmVydGljYWxNYXJnaW5zID0gY2hpbGQuZWZmZWN0aXZlTWFyZ2luVG9wICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgdmFyIGNoaWxkV2lkdGhNZWFzdXJlU3BlYyA9IFZpZXdDb21tb24uZ2V0TWVhc3VyZVNwZWMod2lkdGhNZWFzdXJlU3BlYywgaG9yaXpvbnRhbE1hcmdpbnMsIGNoaWxkLmVmZmVjdGl2ZVdpZHRoLCBzdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIik7XG4gICAgICAgICAgICB2YXIgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyA9IFZpZXdDb21tb24uZ2V0TWVhc3VyZVNwZWMoaGVpZ2h0TWVhc3VyZVNwZWMsIHZlcnRpY2FsTWFyZ2lucywgY2hpbGQuZWZmZWN0aXZlSGVpZ2h0LCBzdHlsZS52ZXJ0aWNhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIpO1xuICAgICAgICAgICAgaWYgKHZpZXdfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZShjaGlsZC5wYXJlbnQgKyBcIiA6bWVhc3VyZUNoaWxkOiBcIiArIGNoaWxkICsgXCIgXCIgKyB2aWV3X2Jhc2VfMS5sYXlvdXQubWVhc3VyZVNwZWNUb1N0cmluZyhjaGlsZFdpZHRoTWVhc3VyZVNwZWMpICsgXCIsIFwiICsgdmlld19iYXNlXzEubGF5b3V0Lm1lYXN1cmVTcGVjVG9TdHJpbmcoY2hpbGRIZWlnaHRNZWFzdXJlU3BlYykgKyBcIn1cIiwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxheW91dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZC5tZWFzdXJlKGNoaWxkV2lkdGhNZWFzdXJlU3BlYywgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLnJvdW5kKGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIGhvcml6b250YWxNYXJnaW5zKTtcbiAgICAgICAgICAgIG1lYXN1cmVIZWlnaHQgPSBNYXRoLnJvdW5kKGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyB2ZXJ0aWNhbE1hcmdpbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IG1lYXN1cmVkV2lkdGg6IG1lYXN1cmVXaWR0aCwgbWVhc3VyZWRIZWlnaHQ6IG1lYXN1cmVIZWlnaHQgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24uZ2V0TWVhc3VyZVNwZWMgPSBmdW5jdGlvbiAocGFyZW50U3BlYywgbWFyZ2lucywgY2hpbGRMZW5ndGgsIHN0cmV0Y2hlZCkge1xuICAgICAgICB2YXIgcGFyZW50TGVuZ3RoID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShwYXJlbnRTcGVjKTtcbiAgICAgICAgdmFyIHBhcmVudFNwZWNNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShwYXJlbnRTcGVjKTtcbiAgICAgICAgdmFyIHJlc3VsdFNpemU7XG4gICAgICAgIHZhciByZXN1bHRNb2RlO1xuICAgICAgICBpZiAoY2hpbGRMZW5ndGggPj0gMCkge1xuICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IHBhcmVudFNwZWNNb2RlID09PSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyBjaGlsZExlbmd0aCA6IE1hdGgubWluKHBhcmVudExlbmd0aCwgY2hpbGRMZW5ndGgpO1xuICAgICAgICAgICAgcmVzdWx0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5FWEFDVExZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJlbnRTcGVjTW9kZSkge1xuICAgICAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFk6XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBNYXRoLm1heCgwLCBwYXJlbnRMZW5ndGggLSBtYXJnaW5zKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IHN0cmV0Y2hlZCA/IHZpZXdfYmFzZV8xLmxheW91dC5FWEFDVExZIDogdmlld19iYXNlXzEubGF5b3V0LkFUX01PU1Q7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LkFUX01PU1Q6XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBNYXRoLm1heCgwLCBwYXJlbnRMZW5ndGggLSBtYXJnaW5zKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5BVF9NT1NUO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRDpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3X2Jhc2VfMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHJlc3VsdFNpemUsIHJlc3VsdE1vZGUpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldEN1cnJlbnRNZWFzdXJlU3BlY3MgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSB0aGlzLl9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYyAhPT0gd2lkdGhNZWFzdXJlU3BlYyB8fCB0aGlzLl9jdXJyZW50SGVpZ2h0TWVhc3VyZVNwZWMgIT09IGhlaWdodE1lYXN1cmVTcGVjO1xuICAgICAgICB0aGlzLl9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYyA9IHdpZHRoTWVhc3VyZVNwZWM7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRIZWlnaHRNZWFzdXJlU3BlYyA9IGhlaWdodE1lYXN1cmVTcGVjO1xuICAgICAgICByZXR1cm4gY2hhbmdlZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXRDdXJyZW50TGF5b3V0Qm91bmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXRDdXJyZW50TGF5b3V0Qm91bmRzID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB0aGlzLl9pc0xheW91dFZhbGlkID0gdHJ1ZTtcbiAgICAgICAgdmFyIGJvdW5kc0NoYW5nZWQgPSB0aGlzLl9vbGRMZWZ0ICE9PSBsZWZ0IHx8IHRoaXMuX29sZFRvcCAhPT0gdG9wIHx8IHRoaXMuX29sZFJpZ2h0ICE9PSByaWdodCB8fCB0aGlzLl9vbGRCb3R0b20gIT09IGJvdHRvbTtcbiAgICAgICAgdmFyIHNpemVDaGFuZ2VkID0gKHRoaXMuX29sZFJpZ2h0IC0gdGhpcy5fb2xkTGVmdCAhPT0gcmlnaHQgLSBsZWZ0KSB8fCAodGhpcy5fb2xkQm90dG9tIC0gdGhpcy5fb2xkVG9wICE9PSBib3R0b20gLSB0b3ApO1xuICAgICAgICB0aGlzLl9vbGRMZWZ0ID0gbGVmdDtcbiAgICAgICAgdGhpcy5fb2xkVG9wID0gdG9wO1xuICAgICAgICB0aGlzLl9vbGRSaWdodCA9IHJpZ2h0O1xuICAgICAgICB0aGlzLl9vbGRCb3R0b20gPSBib3R0b207XG4gICAgICAgIHJldHVybiB7IGJvdW5kc0NoYW5nZWQ6IGJvdW5kc0NoYW5nZWQsIHNpemVDaGFuZ2VkOiBzaXplQ2hhbmdlZCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkVmlldyhjYWxsYmFjayk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZ2V0TmF0aXZlVmlld3NDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPyAxIDogMDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9lYWNoTGF5b3V0VmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gY2FsbGJhY2sodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldFNhZmVBcmVhSW5zZXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldExvY2F0aW9uSW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvbk9uU2NyZWVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TG9jYXRpb25SZWxhdGl2ZVRvID0gZnVuY3Rpb24gKG90aGVyVmlldykge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0QWN0dWFsU2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRCb3VuZHMgPSB0aGlzLl9nZXRDdXJyZW50TGF5b3V0Qm91bmRzKCk7XG4gICAgICAgIGlmICghY3VycmVudEJvdW5kcykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHZpZXdfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGN1cnJlbnRCb3VuZHMucmlnaHQgLSBjdXJyZW50Qm91bmRzLmxlZnQpLFxuICAgICAgICAgICAgaGVpZ2h0OiB2aWV3X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhjdXJyZW50Qm91bmRzLmJvdHRvbSAtIGN1cnJlbnRCb3VuZHMudG9wKSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUFuaW1hdGlvbihhbmltYXRpb24pLnBsYXkoKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmNyZWF0ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcbiAgICAgICAgZW5zdXJlQW5pbWF0aW9uTW9kdWxlKCk7XG4gICAgICAgIGlmICghdGhpcy5fbG9jYWxBbmltYXRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbEFuaW1hdGlvbnMgPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgYW5pbWF0aW9uLnRhcmdldCA9IHRoaXM7XG4gICAgICAgIHZhciBhbmltID0gbmV3IGFuaW1hdGlvbk1vZHVsZS5BbmltYXRpb24oW2FuaW1hdGlvbl0pO1xuICAgICAgICB0aGlzLl9sb2NhbEFuaW1hdGlvbnMuYWRkKGFuaW0pO1xuICAgICAgICByZXR1cm4gYW5pbTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9yZW1vdmVBbmltYXRpb24gPSBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XG4gICAgICAgIHZhciBsb2NhbEFuaW1hdGlvbnMgPSB0aGlzLl9sb2NhbEFuaW1hdGlvbnM7XG4gICAgICAgIGlmIChsb2NhbEFuaW1hdGlvbnMgJiYgbG9jYWxBbmltYXRpb25zLmhhcyhhbmltYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhbEFuaW1hdGlvbnMuZGVsZXRlKGFuaW1hdGlvbik7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmlzUGxheWluZykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuX2xvY2FsQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5fbG9jYWxBbmltYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGEpIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVBbmltYXRpb24oYSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBWaWV3Ll9nZXRWYWx1ZSBpcyBvYnNvbGV0ZS4gVGhlcmUgaXMgYSBuZXcgcHJvcGVydHkgc3lzdGVtLlwiKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFZpZXcuX3NldFZhbHVlIGlzIG9ic29sZXRlLiBUaGVyZSBpcyBhIG5ldyBwcm9wZXJ0eSBzeXN0ZW0uXCIpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3VwZGF0ZUVmZmVjdGl2ZUxheW91dFZhbHVlcyA9IGZ1bmN0aW9uIChwYXJlbnRXaWR0aE1lYXN1cmVTaXplLCBwYXJlbnRXaWR0aE1lYXN1cmVNb2RlLCBwYXJlbnRIZWlnaHRNZWFzdXJlU2l6ZSwgcGFyZW50SGVpZ2h0TWVhc3VyZU1vZGUpIHtcbiAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5zdHlsZTtcbiAgICAgICAgdmFyIGF2YWlsYWJsZVdpZHRoID0gcGFyZW50V2lkdGhNZWFzdXJlTW9kZSA9PT0gdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEID8gLTEgOiBwYXJlbnRXaWR0aE1lYXN1cmVTaXplO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZVdpZHRoID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUud2lkdGgsIC0yLCBhdmFpbGFibGVXaWR0aCk7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWFyZ2luTGVmdCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLm1hcmdpbkxlZnQsIDAsIGF2YWlsYWJsZVdpZHRoKTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXJnaW5SaWdodCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLm1hcmdpblJpZ2h0LCAwLCBhdmFpbGFibGVXaWR0aCk7XG4gICAgICAgIHZhciBhdmFpbGFibGVIZWlnaHQgPSBwYXJlbnRIZWlnaHRNZWFzdXJlTW9kZSA9PT0gdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEID8gLTEgOiBwYXJlbnRIZWlnaHRNZWFzdXJlU2l6ZTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVIZWlnaHQgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS5oZWlnaHQsIC0yLCBhdmFpbGFibGVIZWlnaHQpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpblRvcCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLm1hcmdpblRvcCwgMCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXJnaW5Cb3R0b20gPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS5tYXJnaW5Cb3R0b20sIDAsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0TmF0aXZlQ2xpcFRvQm91bmRzID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JlZHJhd05hdGl2ZUJhY2tncm91bmQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9vbkF0dGFjaGVkVG9XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fb25EZXRhY2hlZEZyb21XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5faGFzQW5jZXN0b3JWaWV3ID0gZnVuY3Rpb24gKGFuY2VzdG9yVmlldykge1xuICAgICAgICB2YXIgbWF0Y2hlciA9IGZ1bmN0aW9uICh2aWV3KSB7IHJldHVybiB2aWV3ID09PSBhbmNlc3RvclZpZXc7IH07XG4gICAgICAgIGZvciAodmFyIHBhcmVudF8yID0gdGhpcy5wYXJlbnQ7IHBhcmVudF8yICE9IG51bGw7IHBhcmVudF8yID0gcGFyZW50XzIucGFyZW50KSB7XG4gICAgICAgICAgICBpZiAobWF0Y2hlcihwYXJlbnRfMikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLmxheW91dENoYW5nZWRFdmVudCA9IFwibGF5b3V0Q2hhbmdlZFwiO1xuICAgIFZpZXdDb21tb24uc2hvd25Nb2RhbGx5RXZlbnQgPSBcInNob3duTW9kYWxseVwiO1xuICAgIFZpZXdDb21tb24uc2hvd2luZ01vZGFsbHlFdmVudCA9IFwic2hvd2luZ01vZGFsbHlcIjtcbiAgICByZXR1cm4gVmlld0NvbW1vbjtcbn0odmlld19iYXNlXzEuVmlld0Jhc2UpKTtcbmV4cG9ydHMuVmlld0NvbW1vbiA9IFZpZXdDb21tb247XG5leHBvcnRzLmF1dG9tYXRpb25UZXh0UHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImF1dG9tYXRpb25UZXh0XCIgfSk7XG5leHBvcnRzLmF1dG9tYXRpb25UZXh0UHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLm9yaWdpblhQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwib3JpZ2luWFwiLCBkZWZhdWx0VmFsdWU6IDAuNSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5vcmlnaW5YUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLm9yaWdpbllQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwib3JpZ2luWVwiLCBkZWZhdWx0VmFsdWU6IDAuNSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5vcmlnaW5ZUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLmlzRW5hYmxlZFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImlzRW5hYmxlZFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogdHJ1ZSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogdmlld19iYXNlXzEuYm9vbGVhbkNvbnZlcnRlcixcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQuX2dvVG9WaXN1YWxTdGF0ZShuZXdWYWx1ZSA/IFwibm9ybWFsXCIgOiBcImRpc2FibGVkXCIpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pc0VuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImlzVXNlckludGVyYWN0aW9uRW5hYmxlZFwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB2aWV3X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYVByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJpb3NPdmVyZmxvd1NhZmVBcmVhXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5pb3NPdmVyZmxvd1NhZmVBcmVhUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG5leHBvcnRzLmlvc092ZXJmbG93U2FmZUFyZWFFbmFibGVkUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuSW5oZXJpdGVkUHJvcGVydHkoeyBuYW1lOiBcImlvc092ZXJmbG93U2FmZUFyZWFFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlvc092ZXJmbG93U2FmZUFyZWFFbmFibGVkUHJvcGVydHkucmVnaXN0ZXIoVmlld0NvbW1vbik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfY29tbW9uXzEgPSByZXF1aXJlKFwiLi92aWV3LWNvbW1vblwiKTtcbnZhciBiYWNrZ3JvdW5kXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9iYWNrZ3JvdW5kXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi92aWV3LWNvbW1vblwiKSk7XG52YXIgUEZMQUdfRk9SQ0VfTEFZT1VUID0gMTtcbnZhciBQRkxBR19NRUFTVVJFRF9ESU1FTlNJT05fU0VUID0gMSA8PCAxO1xudmFyIFBGTEFHX0xBWU9VVF9SRVFVSVJFRCA9IDEgPDwgMjtcbnZhciBtYWpvclZlcnNpb24gPSB1dGlsc18xLmlvcy5NYWpvclZlcnNpb247XG52YXIgVmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmlldygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pc0xhaWRPdXQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2hhc1RyYW5zZnJvbSA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fcHJpdmF0ZUZsYWdzID0gUEZMQUdfTEFZT1VUX1JFUVVJUkVEIHwgUEZMQUdfRk9SQ0VfTEFZT1VUO1xuICAgICAgICBfdGhpcy5fc3VzcGVuZENBVHJhbnNhY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldy5wcm90b3R5cGUsIFwiaXNMYXlvdXRSZXF1aXJlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9wcml2YXRlRmxhZ3MgJiBQRkxBR19MQVlPVVRfUkVRVUlSRUQpID09PSBQRkxBR19MQVlPVVRfUkVRVUlSRUQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3LnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVlc3RlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9wcml2YXRlRmxhZ3MgJiBQRkxBR19GT1JDRV9MQVlPVVQpID09PSBQRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFZpZXcucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVxdWVzdExheW91dC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgfD0gUEZMQUdfRk9SQ0VfTEFZT1VUO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0TmVlZHNMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy52aWV3Q29udHJvbGxlciAmJiB0aGlzLnZpZXdDb250cm9sbGVyLnZpZXcgIT09IG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlld0NvbnRyb2xsZXIudmlldy5zZXROZWVkc0xheW91dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBtZWFzdXJlU3BlY3NDaGFuZ2VkID0gdGhpcy5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBmb3JjZUxheW91dCA9ICh0aGlzLl9wcml2YXRlRmxhZ3MgJiBQRkxBR19GT1JDRV9MQVlPVVQpID09PSBQRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgICAgIGlmIChmb3JjZUxheW91dCB8fCBtZWFzdXJlU3BlY3NDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgJj0gflBGTEFHX01FQVNVUkVEX0RJTUVOU0lPTl9TRVQ7XG4gICAgICAgICAgICB0aGlzLm9uTWVhc3VyZSh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgfD0gUEZMQUdfTEFZT1VUX1JFUVVJUkVEO1xuICAgICAgICAgICAgaWYgKCh0aGlzLl9wcml2YXRlRmxhZ3MgJiBQRkxBR19NRUFTVVJFRF9ESU1FTlNJT05fU0VUKSAhPT0gUEZMQUdfTUVBU1VSRURfRElNRU5TSU9OX1NFVCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIm9uTWVhc3VyZSgpIGRpZCBub3Qgc2V0IHRoZSBtZWFzdXJlZCBkaW1lbnNpb24gYnkgY2FsbGluZyBzZXRNZWFzdXJlZERpbWVuc2lvbigpIFwiICsgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIHNldEZyYW1lKSB7XG4gICAgICAgIGlmIChzZXRGcmFtZSA9PT0gdm9pZCAwKSB7IHNldEZyYW1lID0gdHJ1ZTsgfVxuICAgICAgICB2YXIgX2EgPSB0aGlzLl9zZXRDdXJyZW50TGF5b3V0Qm91bmRzKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSksIGJvdW5kc0NoYW5nZWQgPSBfYS5ib3VuZHNDaGFuZ2VkLCBzaXplQ2hhbmdlZCA9IF9hLnNpemVDaGFuZ2VkO1xuICAgICAgICBpZiAoc2V0RnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMubGF5b3V0TmF0aXZlVmlldyhsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChib3VuZHNDaGFuZ2VkIHx8ICh0aGlzLl9wcml2YXRlRmxhZ3MgJiBQRkxBR19MQVlPVVRfUkVRVUlSRUQpID09PSBQRkxBR19MQVlPVVRfUkVRVUlSRUQpIHtcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHsgbGVmdDogbGVmdCwgdG9wOiB0b3AsIHJpZ2h0OiByaWdodCwgYm90dG9tOiBib3R0b20gfTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgbWFqb3JWZXJzaW9uID4gMTApIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZnJhbWU7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoZnJhbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkxheW91dChwb3NpdGlvbi5sZWZ0LCBwb3NpdGlvbi50b3AsIHBvc2l0aW9uLnJpZ2h0LCBwb3NpdGlvbi5ib3R0b20pO1xuICAgICAgICAgICAgdGhpcy5fcHJpdmF0ZUZsYWdzICY9IH5QRkxBR19MQVlPVVRfUkVRVUlSRUQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVCYWNrZ3JvdW5kKHNpemVDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5fcHJpdmF0ZUZsYWdzICY9IH5QRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS51cGRhdGVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHNpemVDaGFuZ2VkKSB7XG4gICAgICAgIGlmIChzaXplQ2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5fb25TaXplQ2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9PT0gXCJpbnZhbGlkXCIpIHtcbiAgICAgICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgICAgICAgICB0aGlzLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kKGJhY2tncm91bmQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5zZXRNZWFzdXJlZERpbWVuc2lvbiA9IGZ1bmN0aW9uIChtZWFzdXJlZFdpZHRoLCBtZWFzdXJlZEhlaWdodCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldE1lYXN1cmVkRGltZW5zaW9uLmNhbGwodGhpcywgbWVhc3VyZWRXaWR0aCwgbWVhc3VyZWRIZWlnaHQpO1xuICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgfD0gUEZMQUdfTUVBU1VSRURfRElNRU5TSU9OX1NFVDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHdpZHRoID0gdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgbmF0aXZlV2lkdGggPSAwO1xuICAgICAgICB2YXIgbmF0aXZlSGVpZ2h0ID0gMDtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVTaXplID0gdmlld19jb21tb25fMS5sYXlvdXQubWVhc3VyZU5hdGl2ZVZpZXcodmlldywgd2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIG5hdGl2ZVdpZHRoID0gbmF0aXZlU2l6ZS53aWR0aDtcbiAgICAgICAgICAgIG5hdGl2ZUhlaWdodCA9IG5hdGl2ZVNpemUuaGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChuYXRpdmVXaWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobmF0aXZlSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IFZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX3NldE5hdGl2ZVZpZXdGcmFtZSA9IGZ1bmN0aW9uIChuYXRpdmVWaWV3LCBmcmFtZSkge1xuICAgICAgICB2YXIgb2xkRnJhbWUgPSB0aGlzLl9jYWNoZWRGcmFtZSB8fCBuYXRpdmVWaWV3LmZyYW1lO1xuICAgICAgICBpZiAoIUNHUmVjdEVxdWFsVG9SZWN0KG9sZEZyYW1lLCBmcmFtZSkpIHtcbiAgICAgICAgICAgIGlmICh2aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIiA6X3NldE5hdGl2ZVZpZXdGcmFtZTogXCIgKyBKU09OLnN0cmluZ2lmeShpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoZnJhbWUpKSwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2NhY2hlZEZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICB2YXIgYWRqdXN0ZWRGcmFtZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgdHJhbnNmb3JtID0gbnVsbDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNUcmFuc2Zyb20pIHtcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm0gPSBuYXRpdmVWaWV3LnRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtSWRlbnRpdHk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5mcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5mcmFtZSA9IGZyYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRqdXN0ZWRGcmFtZSA9IHRoaXMuYXBwbHlTYWZlQXJlYUluc2V0cyhmcmFtZSk7XG4gICAgICAgICAgICBpZiAoYWRqdXN0ZWRGcmFtZSkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuZnJhbWUgPSBhZGp1c3RlZEZyYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1RyYW5zZnJvbSkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJvdW5kc09yaWdpbiA9IG5hdGl2ZVZpZXcuYm91bmRzLm9yaWdpbjtcbiAgICAgICAgICAgIHZhciBib3VuZHNGcmFtZSA9IGFkanVzdGVkRnJhbWUgfHwgZnJhbWU7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmJvdW5kcyA9IENHUmVjdE1ha2UoYm91bmRzT3JpZ2luLngsIGJvdW5kc09yaWdpbi55LCBib3VuZHNGcmFtZS5zaXplLndpZHRoLCBib3VuZHNGcmFtZS5zaXplLmhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLl9yYWlzZUxheW91dENoYW5nZWRFdmVudCgpO1xuICAgICAgICAgICAgdGhpcy5faXNMYWlkT3V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGhpcy5faXNMYWlkT3V0KSB7XG4gICAgICAgICAgICB0aGlzLl9yYWlzZUxheW91dENoYW5nZWRFdmVudCgpO1xuICAgICAgICAgICAgdGhpcy5faXNMYWlkT3V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcucHJvdG90eXBlLCBcImlzTGF5b3V0VmFsaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXNMYXlvdXRWYWxpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlldy5wcm90b3R5cGUubGF5b3V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgaWYgKCF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGZyYW1lID0gaW9zLmdldEZyYW1lRnJvbVBvc2l0aW9uKHsgbGVmdDogbGVmdCwgdG9wOiB0b3AsIHJpZ2h0OiByaWdodCwgYm90dG9tOiBib3R0b20gfSk7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVZpZXdGcmFtZShuYXRpdmVWaWV3LCBmcmFtZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fc2V0TGF5b3V0RmxhZ3MgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IHJpZ2h0IC0gbGVmdDtcbiAgICAgICAgdmFyIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcbiAgICAgICAgdmFyIHdpZHRoU3BlYyA9IHZpZXdfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyh3aWR0aCwgdmlld19jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHZhciBoZWlnaHRTcGVjID0gdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKGhlaWdodCwgdmlld19jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRNZWFzdXJlU3BlY3Mod2lkdGhTcGVjLCBoZWlnaHRTcGVjKTtcbiAgICAgICAgdGhpcy5fcHJpdmF0ZUZsYWdzICY9IH5QRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGgsIGhlaWdodCk7XG4gICAgICAgIHZhciBzaXplQ2hhbmdlZCA9IHRoaXMuX3NldEN1cnJlbnRMYXlvdXRCb3VuZHMobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKS5zaXplQ2hhbmdlZDtcbiAgICAgICAgdGhpcy51cGRhdGVCYWNrZ3JvdW5kKHNpemVDaGFuZ2VkKTtcbiAgICAgICAgdGhpcy5fcHJpdmF0ZUZsYWdzICY9IH5QRkxBR19MQVlPVVRfUkVRVUlSRUQ7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5mb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW9zKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pb3MuYmVjb21lRmlyc3RSZXNwb25kZXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5hcHBseVNhZmVBcmVhSW5zZXRzID0gZnVuY3Rpb24gKGZyYW1lKSB7XG4gICAgICAgIGlmIChtYWpvclZlcnNpb24gPD0gMTApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pb3NPdmVyZmxvd1NhZmVBcmVhIHx8ICF0aGlzLmlvc092ZXJmbG93U2FmZUFyZWFFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gaW9zLnNocmlua1RvU2FmZUFyZWEodGhpcywgZnJhbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm4gaW9zLmV4cGFuZEJleW9uZFNhZmVBcmVhKHRoaXMsIGZyYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldFNhZmVBcmVhSW5zZXRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2FmZUFyZWFJbnNldHMgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNhZmVBcmVhSW5zZXRzO1xuICAgICAgICB2YXIgaW5zZXRzID0geyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfTtcbiAgICAgICAgaWYgKHNhZmVBcmVhSW5zZXRzKSB7XG4gICAgICAgICAgICBpbnNldHMubGVmdCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNhZmVBcmVhSW5zZXRzLmxlZnQpKTtcbiAgICAgICAgICAgIGluc2V0cy50b3AgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzYWZlQXJlYUluc2V0cy50b3ApKTtcbiAgICAgICAgICAgIGluc2V0cy5yaWdodCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNhZmVBcmVhSW5zZXRzLnJpZ2h0KSk7XG4gICAgICAgICAgICBpbnNldHMuYm90dG9tID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2FmZUFyZWFJbnNldHMuYm90dG9tKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluc2V0cztcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldExvY2F0aW9uSW5XaW5kb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwb2ludEluV2luZG93ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnZlcnRQb2ludFRvVmlldyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLm9yaWdpbiwgbnVsbCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBwb2ludEluV2luZG93LngsXG4gICAgICAgICAgICB5OiBwb2ludEluV2luZG93LnlcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmdldExvY2F0aW9uT25TY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwb2ludEluV2luZG93ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnZlcnRQb2ludFRvVmlldyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLm9yaWdpbiwgbnVsbCk7XG4gICAgICAgIHZhciBwb2ludE9uU2NyZWVuID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLndpbmRvdy5jb252ZXJ0UG9pbnRUb1dpbmRvdyhwb2ludEluV2luZG93LCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IHBvaW50T25TY3JlZW4ueCxcbiAgICAgICAgICAgIHk6IHBvaW50T25TY3JlZW4ueVxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TG9jYXRpb25SZWxhdGl2ZVRvID0gZnVuY3Rpb24gKG90aGVyVmlldykge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCB8fCAhdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLndpbmRvdyB8fFxuICAgICAgICAgICAgIW90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICFvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC53aW5kb3cgfHxcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC53aW5kb3cgIT09IG90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLndpbmRvdykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXlQb2ludEluV2luZG93ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnZlcnRQb2ludFRvVmlldyh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLm9yaWdpbiwgbnVsbCk7XG4gICAgICAgIHZhciBvdGhlclBvaW50SW5XaW5kb3cgPSBvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5jb252ZXJ0UG9pbnRUb1ZpZXcob3RoZXJWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLm9yaWdpbiwgbnVsbCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiBteVBvaW50SW5XaW5kb3cueCAtIG90aGVyUG9pbnRJbldpbmRvdy54LFxuICAgICAgICAgICAgeTogbXlQb2ludEluV2luZG93LnkgLSBvdGhlclBvaW50SW5XaW5kb3cueVxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX29uU2l6ZUNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAoIW5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRoaXMuc3R5bGUuYmFja2dyb3VuZEludGVybmFsO1xuICAgICAgICB2YXIgYmFja2dyb3VuZERlcGVuZHNPblNpemUgPSBiYWNrZ3JvdW5kLmltYWdlXG4gICAgICAgICAgICB8fCAhYmFja2dyb3VuZC5oYXNVbmlmb3JtQm9yZGVyKClcbiAgICAgICAgICAgIHx8IGJhY2tncm91bmQuaGFzQm9yZGVyUmFkaXVzKCk7XG4gICAgICAgIGlmICh0aGlzLl9uYXRpdmVCYWNrZ3JvdW5kU3RhdGUgPT09IFwiaW52YWxpZFwiIHx8ICh0aGlzLl9uYXRpdmVCYWNrZ3JvdW5kU3RhdGUgPT09IFwiZHJhd25cIiAmJiBiYWNrZ3JvdW5kRGVwZW5kc09uU2l6ZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZHJhd05hdGl2ZUJhY2tncm91bmQoYmFja2dyb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNsaXBQYXRoID0gdGhpcy5zdHlsZS5jbGlwUGF0aDtcbiAgICAgICAgaWYgKGNsaXBQYXRoICE9PSBcIlwiICYmIHRoaXNbc3R5bGVfcHJvcGVydGllc18xLmNsaXBQYXRoUHJvcGVydHkuc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgdGhpc1tzdHlsZV9wcm9wZXJ0aWVzXzEuY2xpcFBhdGhQcm9wZXJ0eS5zZXROYXRpdmVdKGNsaXBQYXRoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUudXBkYXRlTmF0aXZlVHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2NhbGVYID0gdGhpcy5zY2FsZVggfHwgMWUtNjtcbiAgICAgICAgdmFyIHNjYWxlWSA9IHRoaXMuc2NhbGVZIHx8IDFlLTY7XG4gICAgICAgIHZhciByb3RhdGUgPSB0aGlzLnJvdGF0ZSB8fCAwO1xuICAgICAgICB2YXIgbmV3VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eTtcbiAgICAgICAgbmV3VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1UcmFuc2xhdGUobmV3VHJhbnNmb3JtLCB0aGlzLnRyYW5zbGF0ZVgsIHRoaXMudHJhbnNsYXRlWSk7XG4gICAgICAgIG5ld1RyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtUm90YXRlKG5ld1RyYW5zZm9ybSwgcm90YXRlICogTWF0aC5QSSAvIDE4MCk7XG4gICAgICAgIG5ld1RyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtU2NhbGUobmV3VHJhbnNmb3JtLCBzY2FsZVgsIHNjYWxlWSk7XG4gICAgICAgIGlmICghQ0dBZmZpbmVUcmFuc2Zvcm1FcXVhbFRvVHJhbnNmb3JtKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC50cmFuc2Zvcm0sIG5ld1RyYW5zZm9ybSkpIHtcbiAgICAgICAgICAgIHZhciB1cGRhdGVTdXNwZW5kZWQgPSB0aGlzLl9pc1ByZXNlbnRhdGlvbkxheWVyVXBkYXRlU3VzcGVuZWRlZCgpO1xuICAgICAgICAgICAgaWYgKCF1cGRhdGVTdXNwZW5kZWQpIHtcbiAgICAgICAgICAgICAgICBDQVRyYW5zYWN0aW9uLmJlZ2luKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudHJhbnNmb3JtID0gbmV3VHJhbnNmb3JtO1xuICAgICAgICAgICAgdGhpcy5faGFzVHJhbnNmcm9tID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmICFDR0FmZmluZVRyYW5zZm9ybUVxdWFsVG9UcmFuc2Zvcm0odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRyYW5zZm9ybSwgQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eSk7XG4gICAgICAgICAgICBpZiAoIXVwZGF0ZVN1c3BlbmRlZCkge1xuICAgICAgICAgICAgICAgIENBVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnVwZGF0ZU9yaWdpblBvaW50ID0gZnVuY3Rpb24gKG9yaWdpblgsIG9yaWdpblkpIHtcbiAgICAgICAgdmFyIG5ld1BvaW50ID0gQ0dQb2ludE1ha2Uob3JpZ2luWCwgb3JpZ2luWSk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5sYXllci5hbmNob3JQb2ludCA9IG5ld1BvaW50O1xuICAgICAgICBpZiAodGhpcy5fY2FjaGVkRnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3NldE5hdGl2ZVZpZXdGcmFtZSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQsIHRoaXMuX2NhY2hlZEZyYW1lKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX3N1c3BlbmRQcmVzZW50YXRpb25MYXllclVwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N1c3BlbmRDQVRyYW5zYWN0aW9uID0gdHJ1ZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9yZXN1bWVQcmVzZW50YXRpb25MYXllclVwZGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3N1c3BlbmRDQVRyYW5zYWN0aW9uID0gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5faXNQcmVzZW50YXRpb25MYXllclVwZGF0ZVN1c3BlbmVkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdXNwZW5kQ0FUcmFuc2FjdGlvbiB8fCB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX3Nob3dOYXRpdmVNb2RhbFZpZXcgPSBmdW5jdGlvbiAocGFyZW50LCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBwYXJlbnRXaXRoQ29udHJvbGxlciA9IGlvcy5nZXRQYXJlbnRXaXRoVmlld0NvbnRyb2xsZXIocGFyZW50KTtcbiAgICAgICAgaWYgKCFwYXJlbnRXaXRoQ29udHJvbGxlcikge1xuICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiQ291bGQgbm90IGZpbmQgcGFyZW50IHdpdGggdmlld0NvbnRyb2xsZXIgZm9yIFwiICsgcGFyZW50ICsgXCIgd2hpbGUgc2hvd2luZyBtb2RhbCB2aWV3LlwiLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5LCB2aWV3X2NvbW1vbl8xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnRDb250cm9sbGVyID0gcGFyZW50V2l0aENvbnRyb2xsZXIudmlld0NvbnRyb2xsZXI7XG4gICAgICAgIGlmIChwYXJlbnRDb250cm9sbGVyLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJQYXJlbnQgaXMgYWxyZWFkeSBwcmVzZW50aW5nIHZpZXcgY29udHJvbGxlci4gQ2xvc2UgdGhlIGN1cnJlbnQgbW9kYWwgcGFnZSBiZWZvcmUgc2hvd2luZyBhbm90aGVyIG9uZSFcIiwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSwgdmlld19jb21tb25fMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhcmVudENvbnRyb2xsZXIudmlldyB8fCAhcGFyZW50Q29udHJvbGxlci52aWV3LndpbmRvdykge1xuICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiUGFyZW50IHBhZ2UgaXMgbm90IHBhcnQgb2YgdGhlIHdpbmRvdyBoaWVyYXJjaHkuXCIsIHZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHksIHZpZXdfY29tbW9uXzEudHJhY2VNZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0dXBBc1Jvb3RWaWV3KHt9KTtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2hvd05hdGl2ZU1vZGFsVmlldy5jYWxsKHRoaXMsIHBhcmVudFdpdGhDb250cm9sbGVyLCBvcHRpb25zKTtcbiAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSB0aGlzLnZpZXdDb250cm9sbGVyO1xuICAgICAgICBpZiAoIWNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5pb3MgfHwgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgY29udHJvbGxlciA9IGlvcy5VSUxheW91dFZpZXdDb250cm9sbGVyLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICAgICAgaWYgKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSVZpZXcpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnZpZXcuYWRkU3VidmlldyhuYXRpdmVWaWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmlld0NvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIubW9kYWxQcmVzZW50YXRpb25TdHlsZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLm1vZGFsUHJlc2VudGF0aW9uU3R5bGUgPSAyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmlvcyAmJiBvcHRpb25zLmlvcy5wcmVzZW50YXRpb25TdHlsZSkge1xuICAgICAgICAgICAgdmFyIHByZXNlbnRhdGlvblN0eWxlID0gb3B0aW9ucy5pb3MucHJlc2VudGF0aW9uU3R5bGU7XG4gICAgICAgICAgICBjb250cm9sbGVyLm1vZGFsUHJlc2VudGF0aW9uU3R5bGUgPSBwcmVzZW50YXRpb25TdHlsZTtcbiAgICAgICAgICAgIGlmIChwcmVzZW50YXRpb25TdHlsZSA9PT0gNykge1xuICAgICAgICAgICAgICAgIHZhciBwb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlciA9IGNvbnRyb2xsZXIucG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5fcG9wb3ZlclByZXNlbnRhdGlvbkRlbGVnYXRlID0gaW9zLlVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcC5pbml0V2l0aE93bmVyQW5kQ2FsbGJhY2sobmV3IFdlYWtSZWYodGhpcyksIHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgcG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXIuZGVsZWdhdGUgPSB0aGlzLl9wb3BvdmVyUHJlc2VudGF0aW9uRGVsZWdhdGU7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBwYXJlbnQubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgICAgICAgICBwb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5zb3VyY2VWaWV3ID0gdmlldztcbiAgICAgICAgICAgICAgICBwb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5zb3VyY2VSZWN0ID0gQ0dSZWN0TWFrZSgwLCAwLCB2aWV3LmZyYW1lLnNpemUud2lkdGgsIHZpZXcuZnJhbWUuc2l6ZS5oZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuaG9yaXpvbnRhbEFsaWdubWVudCA9IFwic3RyZXRjaFwiO1xuICAgICAgICB0aGlzLnZlcnRpY2FsQWxpZ25tZW50ID0gXCJzdHJldGNoXCI7XG4gICAgICAgIHRoaXMuX3JhaXNlU2hvd2luZ01vZGFsbHlFdmVudCgpO1xuICAgICAgICB2YXIgYW5pbWF0ZWQgPSBvcHRpb25zLmFuaW1hdGVkID09PSB1bmRlZmluZWQgPyB0cnVlIDogISFvcHRpb25zLmFuaW1hdGVkO1xuICAgICAgICBjb250cm9sbGVyLmFuaW1hdGVkID0gYW5pbWF0ZWQ7XG4gICAgICAgIHBhcmVudENvbnRyb2xsZXIucHJlc2VudFZpZXdDb250cm9sbGVyQW5pbWF0ZWRDb21wbGV0aW9uKGNvbnRyb2xsZXIsIGFuaW1hdGVkLCBudWxsKTtcbiAgICAgICAgdmFyIHRyYW5zaXRpb25Db29yZGluYXRvciA9IHBhcmVudENvbnRyb2xsZXIudHJhbnNpdGlvbkNvb3JkaW5hdG9yO1xuICAgICAgICBpZiAodHJhbnNpdGlvbkNvb3JkaW5hdG9yKSB7XG4gICAgICAgICAgICBVSVZpZXdDb250cm9sbGVyVHJhbnNpdGlvbkNvb3JkaW5hdG9yLnByb3RvdHlwZS5hbmltYXRlQWxvbmdzaWRlVHJhbnNpdGlvbkNvbXBsZXRpb25cbiAgICAgICAgICAgICAgICAuY2FsbCh0cmFuc2l0aW9uQ29vcmRpbmF0b3IsIG51bGwsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9yYWlzZVNob3duTW9kYWxseUV2ZW50KCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmFpc2VTaG93bk1vZGFsbHlFdmVudCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5faGlkZU5hdGl2ZU1vZGFsVmlldyA9IGZ1bmN0aW9uIChwYXJlbnQsIHdoZW5DbG9zZWRDYWxsYmFjaykge1xuICAgICAgICBpZiAoIXBhcmVudCB8fCAhcGFyZW50LnZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlRXJyb3IoXCJUcnlpbmcgdG8gaGlkZSBtb2RhbCB2aWV3IGJ1dCBubyBwYXJlbnQgd2l0aCB2aWV3Q29udHJvbGxlciBzcGVjaWZpZWQuXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyZW50LnZpZXdDb250cm9sbGVyLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB3aGVuQ2xvc2VkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyZW50Q29udHJvbGxlciA9IHBhcmVudC52aWV3Q29udHJvbGxlcjtcbiAgICAgICAgdmFyIGFuaW1hdGVkID0gdGhpcy52aWV3Q29udHJvbGxlci5hbmltYXRlZDtcbiAgICAgICAgcGFyZW50Q29udHJvbGxlci5kaXNtaXNzVmlld0NvbnRyb2xsZXJBbmltYXRlZENvbXBsZXRpb24oYW5pbWF0ZWQsIHdoZW5DbG9zZWRDYWxsYmFjayk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmlzRW5hYmxlZFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUNvbnRyb2wgPyBuYXRpdmVWaWV3LmVuYWJsZWQgOiB0cnVlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5pc0VuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQ29udHJvbCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5lbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheWVyLmFuY2hvclBvaW50Lng7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLm9yaWdpblhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3JpZ2luUG9pbnQodmFsdWUsIHRoaXMub3JpZ2luWSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLm9yaWdpbllQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5sYXllci5hbmNob3JQb2ludC55O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5vcmlnaW5ZUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZU9yaWdpblBvaW50KHRoaXMub3JpZ2luWCwgdmFsdWUpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5hdXRvbWF0aW9uVGV4dFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFjY2Vzc2liaWxpdHlMYWJlbDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuYXV0b21hdGlvblRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hY2Nlc3NpYmlsaXR5SWRlbnRpZmllciA9IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWNjZXNzaWJpbGl0eUxhYmVsID0gdmFsdWU7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnVzZXJJbnRlcmFjdGlvbkVuYWJsZWQ7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnVzZXJJbnRlcmFjdGlvbkVuYWJsZWQgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS52aXNpYmlsaXR5UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaGlkZGVuID8gc3R5bGVfcHJvcGVydGllc18xLlZpc2liaWxpdHkuQ09MTEFQU0UgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5WSVNJQkxFO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnZpc2liaWxpdHlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2Ugc3R5bGVfcHJvcGVydGllc18xLlZpc2liaWxpdHkuVklTSUJMRTpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHN0eWxlX3Byb3BlcnRpZXNfMS5WaXNpYmlsaXR5LkhJRERFTjpcbiAgICAgICAgICAgIGNhc2Ugc3R5bGVfcHJvcGVydGllc18xLlZpc2liaWxpdHkuQ09MTEFQU0U6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmhpZGRlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmlzaWJpbGl0eSB2YWx1ZTogXCIgKyB2YWx1ZSArIFwiLiBWYWxpZCB2YWx1ZXMgYXJlOiBcXFwiXCIgKyBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5WSVNJQkxFICsgXCJcXFwiLCBcXFwiXCIgKyBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5ISURERU4gKyBcIlxcXCIsIFxcXCJcIiArIHN0eWxlX3Byb3BlcnRpZXNfMS5WaXNpYmlsaXR5LkNPTExBUFNFICsgXCJcXFwiLlwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hbHBoYTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHVwZGF0ZVN1c3BlbmRlZCA9IHRoaXMuX2lzUHJlc2VudGF0aW9uTGF5ZXJVcGRhdGVTdXNwZW5lZGVkKCk7XG4gICAgICAgIGlmICghdXBkYXRlU3VzcGVuZGVkKSB7XG4gICAgICAgICAgICBDQVRyYW5zYWN0aW9uLmJlZ2luKCk7XG4gICAgICAgIH1cbiAgICAgICAgbmF0aXZlVmlldy5hbHBoYSA9IHZhbHVlO1xuICAgICAgICBpZiAoIXVwZGF0ZVN1c3BlbmRlZCkge1xuICAgICAgICAgICAgQ0FUcmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlTmF0aXZlVHJhbnNmb3JtKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZU5hdGl2ZVRyYW5zZm9ybSgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlTmF0aXZlVHJhbnNmb3JtKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuekluZGV4UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnpJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheWVyLnpQb3NpdGlvbiA9IHZhbHVlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmJhY2tncm91bmRDb2xvcjtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9IFwiaW52YWxpZFwiO1xuICAgICAgICBpZiAodGhpcy5pc0xheW91dFZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyAmJiAhdGhpcy5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gbmF0aXZlVmlldy5mcmFtZTtcbiAgICAgICAgICAgIHZhciBvcmlnaW5fMSA9IGZyYW1lLm9yaWdpbjtcbiAgICAgICAgICAgIHZhciBzaXplID0gZnJhbWUuc2l6ZTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbGVmdDogTWF0aC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhvcmlnaW5fMS54KSksXG4gICAgICAgICAgICAgICAgdG9wOiBNYXRoLnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG9yaWdpbl8xLnkpKSxcbiAgICAgICAgICAgICAgICByaWdodDogTWF0aC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhvcmlnaW5fMS54ICsgc2l6ZS53aWR0aCkpLFxuICAgICAgICAgICAgICAgIGJvdHRvbTogTWF0aC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhvcmlnaW5fMS55ICsgc2l6ZS5oZWlnaHQpKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdXBkYXRlU3VzcGVuZGVkID0gdGhpcy5faXNQcmVzZW50YXRpb25MYXllclVwZGF0ZVN1c3BlbmVkZWQoKTtcbiAgICAgICAgaWYgKCF1cGRhdGVTdXNwZW5kZWQpIHtcbiAgICAgICAgICAgIENBVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBVSUNvbG9yKSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kXzEuaW9zLmNyZWF0ZUJhY2tncm91bmRVSUNvbG9yKHRoaXMsIGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgICAgIF90aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdXBkYXRlU3VzcGVuZGVkKSB7XG4gICAgICAgICAgICBDQVRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9IFwiZHJhd25cIjtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kSW50ZXJuYWwgPSB0aGlzLnN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNsaXBzVG9Cb3VuZHMgPVxuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3IHx8XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZEludGVybmFsLmhhc0JvcmRlcldpZHRoKCkgfHxcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kSW50ZXJuYWwuaGFzQm9yZGVyUmFkaXVzKCk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXcucHJvdG90eXBlLCBcImxheW91dFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXcucHJvdG90eXBlLCBcIm9uTWVhc3VyZVwiLCBudWxsKTtcbiAgICByZXR1cm4gVmlldztcbn0odmlld19jb21tb25fMS5WaWV3Q29tbW9uKSk7XG5leHBvcnRzLlZpZXcgPSBWaWV3O1xuVmlldy5wcm90b3R5cGUuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9IFwidW5zZXRcIjtcbnZhciBDb250YWluZXJWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ29udGFpbmVyVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb250YWluZXJWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5pb3NPdmVyZmxvd1NhZmVBcmVhID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gQ29udGFpbmVyVmlldztcbn0oVmlldykpO1xuZXhwb3J0cy5Db250YWluZXJWaWV3ID0gQ29udGFpbmVyVmlldztcbnZhciBDdXN0b21MYXlvdXRWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ3VzdG9tTGF5b3V0VmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDdXN0b21MYXlvdXRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSVZpZXcuYWxsb2MoKS5pbml0V2l0aEZyYW1lKFVJU2NyZWVuLm1haW5TY3JlZW4uYm91bmRzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkLCBhdEluZGV4KTtcbiAgICAgICAgdmFyIHBhcmVudE5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBjaGlsZE5hdGl2ZVZpZXcgPSBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAocGFyZW50TmF0aXZlVmlldyAmJiBjaGlsZE5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXRJbmRleCAhPT0gXCJudW1iZXJcIiB8fCBhdEluZGV4ID49IHBhcmVudE5hdGl2ZVZpZXcuc3Vidmlld3MuY291bnQpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnROYXRpdmVWaWV3LmFkZFN1YnZpZXcoY2hpbGROYXRpdmVWaWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcmVudE5hdGl2ZVZpZXcuaW5zZXJ0U3Vidmlld0F0SW5kZXgoY2hpbGROYXRpdmVWaWV3LCBhdEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICBpZiAoY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgY2hpbGQubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVGcm9tU3VwZXJ2aWV3KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBDdXN0b21MYXlvdXRWaWV3O1xufShDb250YWluZXJWaWV3KSk7XG5leHBvcnRzLkN1c3RvbUxheW91dFZpZXcgPSBDdXN0b21MYXlvdXRWaWV3O1xudmFyIGlvcztcbihmdW5jdGlvbiAoaW9zKSB7XG4gICAgZnVuY3Rpb24gZ2V0UGFyZW50V2l0aFZpZXdDb250cm9sbGVyKHZpZXcpIHtcbiAgICAgICAgd2hpbGUgKHZpZXcgJiYgIXZpZXcudmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZpZXcgPSB2aWV3LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9XG4gICAgaW9zLmdldFBhcmVudFdpdGhWaWV3Q29udHJvbGxlciA9IGdldFBhcmVudFdpdGhWaWV3Q29udHJvbGxlcjtcbiAgICBmdW5jdGlvbiB1cGRhdGVBdXRvQWRqdXN0U2Nyb2xsSW5zZXRzKGNvbnRyb2xsZXIsIG93bmVyKSB7XG4gICAgICAgIGlmIChtYWpvclZlcnNpb24gPD0gMTApIHtcbiAgICAgICAgICAgIG93bmVyLl9hdXRvbWF0aWNhbGx5QWRqdXN0c1Njcm9sbFZpZXdJbnNldHMgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuYXV0b21hdGljYWxseUFkanVzdHNTY3JvbGxWaWV3SW5zZXRzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW9zLnVwZGF0ZUF1dG9BZGp1c3RTY3JvbGxJbnNldHMgPSB1cGRhdGVBdXRvQWRqdXN0U2Nyb2xsSW5zZXRzO1xuICAgIGZ1bmN0aW9uIHVwZGF0ZUNvbnN0cmFpbnRzKGNvbnRyb2xsZXIsIG93bmVyKSB7XG4gICAgICAgIGlmIChtYWpvclZlcnNpb24gPD0gMTApIHtcbiAgICAgICAgICAgIHZhciBsYXlvdXRHdWlkZSA9IGluaXRMYXlvdXRHdWlkZShjb250cm9sbGVyKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5zYWZlQXJlYUxheW91dEd1aWRlID0gbGF5b3V0R3VpZGU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW9zLnVwZGF0ZUNvbnN0cmFpbnRzID0gdXBkYXRlQ29uc3RyYWludHM7XG4gICAgZnVuY3Rpb24gaW5pdExheW91dEd1aWRlKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gY29udHJvbGxlci52aWV3O1xuICAgICAgICB2YXIgbGF5b3V0R3VpZGUgPSBVSUxheW91dEd1aWRlLmFsbG9jKCkuaW5pdCgpO1xuICAgICAgICByb290Vmlldy5hZGRMYXlvdXRHdWlkZShsYXlvdXRHdWlkZSk7XG4gICAgICAgIE5TTGF5b3V0Q29uc3RyYWludC5hY3RpdmF0ZUNvbnN0cmFpbnRzKFtcbiAgICAgICAgICAgIGxheW91dEd1aWRlLnRvcEFuY2hvci5jb25zdHJhaW50RXF1YWxUb0FuY2hvcihjb250cm9sbGVyLnRvcExheW91dEd1aWRlLmJvdHRvbUFuY2hvciksXG4gICAgICAgICAgICBsYXlvdXRHdWlkZS5ib3R0b21BbmNob3IuY29uc3RyYWludEVxdWFsVG9BbmNob3IoY29udHJvbGxlci5ib3R0b21MYXlvdXRHdWlkZS50b3BBbmNob3IpLFxuICAgICAgICAgICAgbGF5b3V0R3VpZGUubGVhZGluZ0FuY2hvci5jb25zdHJhaW50RXF1YWxUb0FuY2hvcihyb290Vmlldy5sZWFkaW5nQW5jaG9yKSxcbiAgICAgICAgICAgIGxheW91dEd1aWRlLnRyYWlsaW5nQW5jaG9yLmNvbnN0cmFpbnRFcXVhbFRvQW5jaG9yKHJvb3RWaWV3LnRyYWlsaW5nQW5jaG9yKVxuICAgICAgICBdKTtcbiAgICAgICAgcmV0dXJuIGxheW91dEd1aWRlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBsYXlvdXRWaWV3KGNvbnRyb2xsZXIsIG93bmVyKSB7XG4gICAgICAgIHZhciBsYXlvdXRHdWlkZSA9IGNvbnRyb2xsZXIudmlldy5zYWZlQXJlYUxheW91dEd1aWRlO1xuICAgICAgICBpZiAoIWxheW91dEd1aWRlKSB7XG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJzYWZlQXJlYUxheW91dEd1aWRlIGR1cmluZyBsYXlvdXQgb2YgXCIgKyBvd25lciArIFwiLiBDcmVhdGluZyBmYWxsYmFjayBjb25zdHJhaW50cywgYnV0IGxheW91dCBtaWdodCBiZSB3cm9uZy5cIiwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0LCB2aWV3X2NvbW1vbl8xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgbGF5b3V0R3VpZGUgPSBpbml0TGF5b3V0R3VpZGUoY29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNhZmVBcmVhID0gbGF5b3V0R3VpZGUubGF5b3V0RnJhbWU7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShzYWZlQXJlYSk7XG4gICAgICAgIHZhciBzYWZlQXJlYVNpemUgPSBzYWZlQXJlYS5zaXplO1xuICAgICAgICB2YXIgaGFzQ2hpbGRWaWV3Q29udHJvbGxlcnMgPSBjb250cm9sbGVyLmNoaWxkVmlld0NvbnRyb2xsZXJzLmNvdW50ID4gMDtcbiAgICAgICAgaWYgKGhhc0NoaWxkVmlld0NvbnRyb2xsZXJzKSB7XG4gICAgICAgICAgICB2YXIgZnVsbHNjcmVlbiA9IGNvbnRyb2xsZXIudmlldy5mcmFtZTtcbiAgICAgICAgICAgIHBvc2l0aW9uID0gaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKGZ1bGxzY3JlZW4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzYWZlQXJlYVdpZHRoID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2FmZUFyZWFTaXplLndpZHRoKSk7XG4gICAgICAgIHZhciBzYWZlQXJlYUhlaWdodCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNhZmVBcmVhU2l6ZS5oZWlnaHQpKTtcbiAgICAgICAgdmFyIHdpZHRoU3BlYyA9IHZpZXdfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhzYWZlQXJlYVdpZHRoLCB2aWV3X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgdmFyIGhlaWdodFNwZWMgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoc2FmZUFyZWFIZWlnaHQsIHZpZXdfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkpO1xuICAgICAgICBWaWV3Lm1lYXN1cmVDaGlsZChudWxsLCBvd25lciwgd2lkdGhTcGVjLCBoZWlnaHRTcGVjKTtcbiAgICAgICAgVmlldy5sYXlvdXRDaGlsZChudWxsLCBvd25lciwgcG9zaXRpb24ubGVmdCwgcG9zaXRpb24udG9wLCBwb3NpdGlvbi5yaWdodCwgcG9zaXRpb24uYm90dG9tKTtcbiAgICAgICAgbGF5b3V0UGFyZW50KG93bmVyLnBhcmVudCk7XG4gICAgfVxuICAgIGlvcy5sYXlvdXRWaWV3ID0gbGF5b3V0VmlldztcbiAgICBmdW5jdGlvbiBnZXRQb3NpdGlvbkZyb21GcmFtZShmcmFtZSkge1xuICAgICAgICB2YXIgbGVmdCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZyYW1lLm9yaWdpbi54KSk7XG4gICAgICAgIHZhciB0b3AgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhmcmFtZS5vcmlnaW4ueSkpO1xuICAgICAgICB2YXIgcmlnaHQgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhmcmFtZS5vcmlnaW4ueCArIGZyYW1lLnNpemUud2lkdGgpKTtcbiAgICAgICAgdmFyIGJvdHRvbSA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZyYW1lLm9yaWdpbi55ICsgZnJhbWUuc2l6ZS5oZWlnaHQpKTtcbiAgICAgICAgcmV0dXJuIHsgbGVmdDogbGVmdCwgcmlnaHQ6IHJpZ2h0LCB0b3A6IHRvcCwgYm90dG9tOiBib3R0b20gfTtcbiAgICB9XG4gICAgaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lID0gZ2V0UG9zaXRpb25Gcm9tRnJhbWU7XG4gICAgZnVuY3Rpb24gZ2V0RnJhbWVGcm9tUG9zaXRpb24ocG9zaXRpb24sIGluc2V0cykge1xuICAgICAgICBpbnNldHMgPSBpbnNldHMgfHwgeyBsZWZ0OiAwLCB0b3A6IDAsIHJpZ2h0OiAwLCBib3R0b206IDAgfTtcbiAgICAgICAgdmFyIGxlZnQgPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBvc2l0aW9uLmxlZnQgKyBpbnNldHMubGVmdCk7XG4gICAgICAgIHZhciB0b3AgPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBvc2l0aW9uLnRvcCArIGluc2V0cy50b3ApO1xuICAgICAgICB2YXIgd2lkdGggPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBvc2l0aW9uLnJpZ2h0IC0gcG9zaXRpb24ubGVmdCAtIGluc2V0cy5sZWZ0IC0gaW5zZXRzLnJpZ2h0KTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocG9zaXRpb24uYm90dG9tIC0gcG9zaXRpb24udG9wIC0gaW5zZXRzLnRvcCAtIGluc2V0cy5ib3R0b20pO1xuICAgICAgICByZXR1cm4gQ0dSZWN0TWFrZShsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgICBpb3MuZ2V0RnJhbWVGcm9tUG9zaXRpb24gPSBnZXRGcmFtZUZyb21Qb3NpdGlvbjtcbiAgICBmdW5jdGlvbiBzaHJpbmtUb1NhZmVBcmVhKHZpZXcsIGZyYW1lKSB7XG4gICAgICAgIHZhciBpbnNldHMgPSB2aWV3LmdldFNhZmVBcmVhSW5zZXRzKCk7XG4gICAgICAgIGlmIChpbnNldHMubGVmdCB8fCBpbnNldHMudG9wKSB7XG4gICAgICAgICAgICB2YXIgcG9zaXRpb24gPSBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoZnJhbWUpO1xuICAgICAgICAgICAgdmFyIGFkanVzdGVkRnJhbWUgPSBpb3MuZ2V0RnJhbWVGcm9tUG9zaXRpb24ocG9zaXRpb24sIGluc2V0cyk7XG4gICAgICAgICAgICBpZiAodmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZSh0aGlzICsgXCIgOnNocmlua1RvU2FmZUFyZWE6IFwiICsgSlNPTi5zdHJpbmdpZnkoaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKGFkanVzdGVkRnJhbWUpKSwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhZGp1c3RlZEZyYW1lO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpb3Muc2hyaW5rVG9TYWZlQXJlYSA9IHNocmlua1RvU2FmZUFyZWE7XG4gICAgZnVuY3Rpb24gZXhwYW5kQmV5b25kU2FmZUFyZWEodmlldywgZnJhbWUpIHtcbiAgICAgICAgdmFyIGF2YWlsYWJsZVNwYWNlID0gZ2V0QXZhaWxhYmxlU3BhY2VGcm9tUGFyZW50KHZpZXcsIGZyYW1lKTtcbiAgICAgICAgdmFyIHNhZmVBcmVhID0gYXZhaWxhYmxlU3BhY2Uuc2FmZUFyZWE7XG4gICAgICAgIHZhciBmdWxsc2NyZWVuID0gYXZhaWxhYmxlU3BhY2UuZnVsbHNjcmVlbjtcbiAgICAgICAgdmFyIGluV2luZG93ID0gYXZhaWxhYmxlU3BhY2UuaW5XaW5kb3c7XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShmcmFtZSk7XG4gICAgICAgIHZhciBzYWZlQXJlYVBvc2l0aW9uID0gaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKHNhZmVBcmVhKTtcbiAgICAgICAgdmFyIGZ1bGxzY3JlZW5Qb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShmdWxsc2NyZWVuKTtcbiAgICAgICAgdmFyIGluV2luZG93UG9zaXRpb24gPSBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoaW5XaW5kb3cpO1xuICAgICAgICB2YXIgYWRqdXN0ZWRQb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgICBpZiAocG9zaXRpb24ubGVmdCAmJiBpbldpbmRvd1Bvc2l0aW9uLmxlZnQgPD0gc2FmZUFyZWFQb3NpdGlvbi5sZWZ0KSB7XG4gICAgICAgICAgICBhZGp1c3RlZFBvc2l0aW9uLmxlZnQgPSBmdWxsc2NyZWVuUG9zaXRpb24ubGVmdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAocG9zaXRpb24udG9wICYmIGluV2luZG93UG9zaXRpb24udG9wIDw9IHNhZmVBcmVhUG9zaXRpb24udG9wKSB7XG4gICAgICAgICAgICBhZGp1c3RlZFBvc2l0aW9uLnRvcCA9IGZ1bGxzY3JlZW5Qb3NpdGlvbi50b3A7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluV2luZG93UG9zaXRpb24ucmlnaHQgPCBmdWxsc2NyZWVuUG9zaXRpb24ucmlnaHQgJiYgaW5XaW5kb3dQb3NpdGlvbi5yaWdodCA+PSBzYWZlQXJlYVBvc2l0aW9uLnJpZ2h0ICsgZnVsbHNjcmVlblBvc2l0aW9uLmxlZnQpIHtcbiAgICAgICAgICAgIGFkanVzdGVkUG9zaXRpb24ucmlnaHQgKz0gZnVsbHNjcmVlblBvc2l0aW9uLnJpZ2h0IC0gaW5XaW5kb3dQb3NpdGlvbi5yaWdodDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5XaW5kb3dQb3NpdGlvbi5ib3R0b20gPCBmdWxsc2NyZWVuUG9zaXRpb24uYm90dG9tICYmIGluV2luZG93UG9zaXRpb24uYm90dG9tID49IHNhZmVBcmVhUG9zaXRpb24uYm90dG9tICsgZnVsbHNjcmVlblBvc2l0aW9uLnRvcCkge1xuICAgICAgICAgICAgYWRqdXN0ZWRQb3NpdGlvbi5ib3R0b20gKz0gZnVsbHNjcmVlblBvc2l0aW9uLmJvdHRvbSAtIGluV2luZG93UG9zaXRpb24uYm90dG9tO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhZGp1c3RlZEZyYW1lID0gQ0dSZWN0TWFrZSh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFkanVzdGVkUG9zaXRpb24ubGVmdCksIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYWRqdXN0ZWRQb3NpdGlvbi50b3ApLCB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFkanVzdGVkUG9zaXRpb24ucmlnaHQgLSBhZGp1c3RlZFBvc2l0aW9uLmxlZnQpLCB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFkanVzdGVkUG9zaXRpb24uYm90dG9tIC0gYWRqdXN0ZWRQb3NpdGlvbi50b3ApKTtcbiAgICAgICAgaWYgKHZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZSh2aWV3ICsgXCIgOmV4cGFuZEJleW9uZFNhZmVBcmVhOiBcIiArIEpTT04uc3RyaW5naWZ5KGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShhZGp1c3RlZEZyYW1lKSksIHZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkxheW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFkanVzdGVkRnJhbWU7XG4gICAgfVxuICAgIGlvcy5leHBhbmRCZXlvbmRTYWZlQXJlYSA9IGV4cGFuZEJleW9uZFNhZmVBcmVhO1xuICAgIGZ1bmN0aW9uIGxheW91dFBhcmVudCh2aWV3KSB7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3IGluc3RhbmNlb2YgVmlldyAmJiB2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5mcmFtZTtcbiAgICAgICAgICAgIHZhciBvcmlnaW5fMiA9IGZyYW1lLm9yaWdpbjtcbiAgICAgICAgICAgIHZhciBzaXplID0gZnJhbWUuc2l6ZTtcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMob3JpZ2luXzIueCk7XG4gICAgICAgICAgICB2YXIgdG9wXzEgPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhvcmlnaW5fMi55KTtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNpemUud2lkdGgpO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNpemUuaGVpZ2h0KTtcbiAgICAgICAgICAgIHZpZXcuX3NldExheW91dEZsYWdzKGxlZnQsIHRvcF8xLCB3aWR0aCArIGxlZnQsIGhlaWdodCArIHRvcF8xKTtcbiAgICAgICAgfVxuICAgICAgICBsYXlvdXRQYXJlbnQodmlldy5wYXJlbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXRBdmFpbGFibGVTcGFjZUZyb21QYXJlbnQodmlldywgZnJhbWUpIHtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNjcm9sbFZpZXcgPSBudWxsO1xuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXJWaWV3ID0gbnVsbDtcbiAgICAgICAgaWYgKHZpZXcudmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVyVmlldyA9IHZpZXcudmlld0NvbnRyb2xsZXIudmlldztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBwYXJlbnRfMSA9IHZpZXcucGFyZW50O1xuICAgICAgICAgICAgd2hpbGUgKHBhcmVudF8xICYmICFwYXJlbnRfMS52aWV3Q29udHJvbGxlciAmJiAhKHBhcmVudF8xLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSVNjcm9sbFZpZXcpKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50XzEgPSBwYXJlbnRfMS5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocGFyZW50XzEubmF0aXZlVmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJU2Nyb2xsVmlldykge1xuICAgICAgICAgICAgICAgIHNjcm9sbFZpZXcgPSBwYXJlbnRfMS5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAocGFyZW50XzEudmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICB2aWV3Q29udHJvbGxlclZpZXcgPSBwYXJlbnRfMS52aWV3Q29udHJvbGxlci52aWV3O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBmdWxsc2NyZWVuID0gbnVsbDtcbiAgICAgICAgdmFyIHNhZmVBcmVhID0gbnVsbDtcbiAgICAgICAgaWYgKHZpZXdDb250cm9sbGVyVmlldykge1xuICAgICAgICAgICAgc2FmZUFyZWEgPSB2aWV3Q29udHJvbGxlclZpZXcuc2FmZUFyZWFMYXlvdXRHdWlkZS5sYXlvdXRGcmFtZTtcbiAgICAgICAgICAgIGZ1bGxzY3JlZW4gPSB2aWV3Q29udHJvbGxlclZpZXcuZnJhbWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2Nyb2xsVmlldykge1xuICAgICAgICAgICAgdmFyIGluc2V0cyA9IHNjcm9sbFZpZXcuc2FmZUFyZWFJbnNldHM7XG4gICAgICAgICAgICBzYWZlQXJlYSA9IENHUmVjdE1ha2UoaW5zZXRzLmxlZnQsIGluc2V0cy50b3AsIHNjcm9sbFZpZXcuY29udGVudFNpemUud2lkdGggLSBpbnNldHMubGVmdCAtIGluc2V0cy5yaWdodCwgc2Nyb2xsVmlldy5jb250ZW50U2l6ZS5oZWlnaHQgLSBpbnNldHMudG9wIC0gaW5zZXRzLmJvdHRvbSk7XG4gICAgICAgICAgICBmdWxsc2NyZWVuID0gQ0dSZWN0TWFrZSgwLCAwLCBzY3JvbGxWaWV3LmNvbnRlbnRTaXplLndpZHRoLCBzY3JvbGxWaWV3LmNvbnRlbnRTaXplLmhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxvY2F0aW9uSW5XaW5kb3cgPSB2aWV3LmdldExvY2F0aW9uSW5XaW5kb3coKTtcbiAgICAgICAgdmFyIGluV2luZG93TGVmdCA9IGxvY2F0aW9uSW5XaW5kb3cueDtcbiAgICAgICAgdmFyIGluV2luZG93VG9wID0gbG9jYXRpb25JbldpbmRvdy55O1xuICAgICAgICBpZiAoc2Nyb2xsVmlldykge1xuICAgICAgICAgICAgaW5XaW5kb3dMZWZ0ICs9IHNjcm9sbFZpZXcuY29udGVudE9mZnNldC54O1xuICAgICAgICAgICAgaW5XaW5kb3dUb3AgKz0gc2Nyb2xsVmlldy5jb250ZW50T2Zmc2V0Lnk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluV2luZG93ID0gQ0dSZWN0TWFrZShpbldpbmRvd0xlZnQsIGluV2luZG93VG9wLCBmcmFtZS5zaXplLndpZHRoLCBmcmFtZS5zaXplLmhlaWdodCk7XG4gICAgICAgIHJldHVybiB7IHNhZmVBcmVhOiBzYWZlQXJlYSwgZnVsbHNjcmVlbjogZnVsbHNjcmVlbiwgaW5XaW5kb3c6IGluV2luZG93IH07XG4gICAgfVxuICAgIHZhciBVSUxheW91dFZpZXdDb250cm9sbGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFVJTGF5b3V0Vmlld0NvbnRyb2xsZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFVJTGF5b3V0Vmlld0NvbnRyb2xsZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgVUlMYXlvdXRWaWV3Q29udHJvbGxlci5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgY29udHJvbGxlciA9IFVJTGF5b3V0Vmlld0NvbnRyb2xsZXIubmV3KCk7XG4gICAgICAgICAgICBjb250cm9sbGVyLm93bmVyID0gb3duZXI7XG4gICAgICAgICAgICByZXR1cm4gY29udHJvbGxlcjtcbiAgICAgICAgfTtcbiAgICAgICAgVUlMYXlvdXRWaWV3Q29udHJvbGxlci5wcm90b3R5cGUudmlld0RpZExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWRMb2FkLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmV4dGVuZGVkTGF5b3V0SW5jbHVkZXNPcGFxdWVCYXJzID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgVUlMYXlvdXRWaWV3Q29udHJvbGxlci5wcm90b3R5cGUudmlld1dpbGxMYXlvdXRTdWJ2aWV3cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld1dpbGxMYXlvdXRTdWJ2aWV3cy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIHVwZGF0ZUNvbnN0cmFpbnRzKHRoaXMsIG93bmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVUlMYXlvdXRWaWV3Q29udHJvbGxlci5wcm90b3R5cGUudmlld0RpZExheW91dFN1YnZpZXdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3RGlkTGF5b3V0U3Vidmlld3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXIuZ2V0KCk7XG4gICAgICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFqb3JWZXJzaW9uID49IDExKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YWJWaWV3SXRlbSA9IG93bmVyLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYlZpZXcgPSB0YWJWaWV3SXRlbSAmJiB0YWJWaWV3SXRlbS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRfMiA9IHRhYlZpZXcgJiYgdGFiVmlldy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChwYXJlbnRfMiAmJiAhcGFyZW50XzIubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50XzIgPSBwYXJlbnRfMi5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudF8yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50UGFnZUluc2V0c1RvcCA9IHBhcmVudF8yLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2FmZUFyZWFJbnNldHMudG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnNldHNUb3AgPSB0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMudG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkZGl0aW9uYWxJbnNldHNUb3AgPSBNYXRoLm1heChwYXJlbnRQYWdlSW5zZXRzVG9wIC0gY3VycmVudEluc2V0c1RvcCwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50UGFnZUluc2V0c0JvdHRvbSA9IHBhcmVudF8yLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2FmZUFyZWFJbnNldHMuYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnNldHNCb3R0b20gPSB0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMuYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFkZGl0aW9uYWxJbnNldHNCb3R0b20gPSBNYXRoLm1heChwYXJlbnRQYWdlSW5zZXRzQm90dG9tIC0gY3VycmVudEluc2V0c0JvdHRvbSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRkaXRpb25hbEluc2V0c1RvcCA+IDAgfHwgYWRkaXRpb25hbEluc2V0c0JvdHRvbSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0cyA9IG5ldyBVSUVkZ2VJbnNldHMoeyB0b3A6IGFkZGl0aW9uYWxJbnNldHNUb3AsIGxlZnQ6IDAsIGJvdHRvbTogYWRkaXRpb25hbEluc2V0c0JvdHRvbSwgcmlnaHQ6IDAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRpdGlvbmFsU2FmZUFyZWFJbnNldHMgPSBhZGRpdGlvbmFsSW5zZXRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxheW91dFZpZXcodGhpcywgb3duZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXIuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXBkYXRlQXV0b0FkanVzdFNjcm9sbEluc2V0cyh0aGlzLCBvd25lcik7XG4gICAgICAgICAgICBpZiAoIW93bmVyLnBhcmVudCkge1xuICAgICAgICAgICAgICAgIG93bmVyLmNhbGxMb2FkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVUlMYXlvdXRWaWV3Q29udHJvbGxlci5wcm90b3R5cGUudmlld0RpZERpc2FwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmIChvd25lciAmJiAhb3duZXIucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgb3duZXIuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBVSUxheW91dFZpZXdDb250cm9sbGVyO1xuICAgIH0oVUlWaWV3Q29udHJvbGxlcikpO1xuICAgIGlvcy5VSUxheW91dFZpZXdDb250cm9sbGVyID0gVUlMYXlvdXRWaWV3Q29udHJvbGxlcjtcbiAgICB2YXIgVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIFVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcC5pbml0V2l0aE93bmVyQW5kQ2FsbGJhY2sgPSBmdW5jdGlvbiAob3duZXIsIHdoZW5DbG9zZWRDYWxsYmFjaykge1xuICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gX3N1cGVyLm5ldy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaW5zdGFuY2Uub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIGluc3RhbmNlLmNsb3NlZENhbGxiYWNrID0gd2hlbkNsb3NlZENhbGxiYWNrO1xuICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgICAgICB9O1xuICAgICAgICBVSVBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXAucHJvdG90eXBlLnBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGlkRGlzbWlzc1BvcG92ZXIgPSBmdW5jdGlvbiAocG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBvd25lciA9IHRoaXMub3duZXIuZ2V0KCk7XG4gICAgICAgICAgICBpZiAob3duZXIgJiYgdHlwZW9mIHRoaXMuY2xvc2VkQ2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VkQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wLk9iakNQcm90b2NvbHMgPSBbVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlXTtcbiAgICAgICAgcmV0dXJuIFVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcDtcbiAgICB9KE5TT2JqZWN0KSk7XG4gICAgaW9zLlVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcCA9IFVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcDtcbn0pKGlvcyA9IGV4cG9ydHMuaW9zIHx8IChleHBvcnRzLmlvcyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12aWV3Lmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaGFuZGxlcnNGb3JFdmVudE5hbWUgPSBuZXcgTWFwKCk7XG52YXIgc291cmNlc01hcCA9IG5ldyBXZWFrTWFwKCk7XG52YXIgVGFyZ2V0SGFuZGxlclBhaXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRhcmdldEhhbmRsZXJQYWlyKHRhcmdldCwgaGFuZGxlcikge1xuICAgICAgICB0aGlzLnRhZ2V0UmVmID0gbmV3IFdlYWtSZWYodGFyZ2V0KTtcbiAgICAgICAgdGhpcy5oYW5kbGVyID0gaGFuZGxlcjtcbiAgICB9XG4gICAgcmV0dXJuIFRhcmdldEhhbmRsZXJQYWlyO1xufSgpKTtcbmZ1bmN0aW9uIGdldEhhbmRsZXJGb3JFdmVudE5hbWUoZXZlbnROYW1lKSB7XG4gICAgdmFyIGhhbmRsZXIgPSBoYW5kbGVyc0ZvckV2ZW50TmFtZS5nZXQoZXZlbnROYW1lKTtcbiAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgICAgaGFuZGxlciA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldmVudERhdGEub2JqZWN0O1xuICAgICAgICAgICAgdmFyIHNvdXJjZUV2ZW50TWFwID0gc291cmNlc01hcC5nZXQoc291cmNlKTtcbiAgICAgICAgICAgIGlmICghc291cmNlRXZlbnRNYXApIHtcbiAgICAgICAgICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgICAgICAgICBpZiAoIXRhcmdldEhhbmRsZXJQYWlyTGlzdCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBkZWFkUGFpcnNJbmRleGVzID0gW107XG4gICAgICAgICAgICB2YXIgcGFpcjtcbiAgICAgICAgICAgIHZhciB0YXJnZXQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhaXIgPSB0YXJnZXRIYW5kbGVyUGFpckxpc3RbaV07XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gcGFpci50YWdldFJlZi5nZXQoKTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhaXIuaGFuZGxlci5jYWxsKHRhcmdldCwgZXZlbnREYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlYWRQYWlyc0luZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZGVhZFBhaXJzSW5kZXhlcy5sZW5ndGggPT09IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VFdmVudE1hcC5kZWxldGUoZXZlbnROYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBkZWFkUGFpcnNJbmRleGVzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEhhbmRsZXJQYWlyTGlzdC5zcGxpY2UoZGVhZFBhaXJzSW5kZXhlc1tqXSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBoYW5kbGVyc0ZvckV2ZW50TmFtZS5zZXQoZXZlbnROYW1lLCBoYW5kbGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGhhbmRsZXI7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCkge1xuICAgIGlmICghc291cmNlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcInNvdXJjZSBpcyBudWxsIG9yIHVuZGVmaW5lZFwiKTtcbiAgICB9XG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGFyZ2V0IGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGV2ZW50TmFtZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJldmVudE5hbWUgaXMgbm90IGEgc3RyaW5nXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGhhbmRsZXIgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJoYW5kbGVyIGlzIG5vdCBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZFdlYWtFdmVudExpc3RlbmVyKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpIHtcbiAgICB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCk7XG4gICAgdmFyIHNob3VsZEF0dGFjaCA9IGZhbHNlO1xuICAgIHZhciBzb3VyY2VFdmVudE1hcCA9IHNvdXJjZXNNYXAuZ2V0KHNvdXJjZSk7XG4gICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICBzb3VyY2VFdmVudE1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgc291cmNlc01hcC5zZXQoc291cmNlLCBzb3VyY2VFdmVudE1hcCk7XG4gICAgICAgIHNob3VsZEF0dGFjaCA9IHRydWU7XG4gICAgfVxuICAgIHZhciBwYWlyTGlzdCA9IHNvdXJjZUV2ZW50TWFwLmdldChldmVudE5hbWUpO1xuICAgIGlmICghcGFpckxpc3QpIHtcbiAgICAgICAgcGFpckxpc3QgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgc291cmNlRXZlbnRNYXAuc2V0KGV2ZW50TmFtZSwgcGFpckxpc3QpO1xuICAgICAgICBzaG91bGRBdHRhY2ggPSB0cnVlO1xuICAgIH1cbiAgICBwYWlyTGlzdC5wdXNoKG5ldyBUYXJnZXRIYW5kbGVyUGFpcih0YXJnZXQsIGhhbmRsZXIpKTtcbiAgICBpZiAoc2hvdWxkQXR0YWNoKSB7XG4gICAgICAgIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZ2V0SGFuZGxlckZvckV2ZW50TmFtZShldmVudE5hbWUpKTtcbiAgICB9XG59XG5leHBvcnRzLmFkZFdlYWtFdmVudExpc3RlbmVyID0gYWRkV2Vha0V2ZW50TGlzdGVuZXI7XG5mdW5jdGlvbiByZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KSB7XG4gICAgdmFsaWRhdGVBcmdzKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpO1xuICAgIHZhciBoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSA9IGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpO1xuICAgIGlmICghaGFuZGxlckZvckV2ZW50V2l0aE5hbWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgc291cmNlRXZlbnRNYXAgPSBzb3VyY2VzTWFwLmdldChzb3VyY2UpO1xuICAgIGlmICghc291cmNlRXZlbnRNYXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCF0YXJnZXRIYW5kbGVyUGFpckxpc3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUgPSBbXTtcbiAgICB2YXIgcGFpcjtcbiAgICB2YXIgcmVnaXN0ZXJlZFRhcmdldDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBwYWlyID0gdGFyZ2V0SGFuZGxlclBhaXJMaXN0W2ldO1xuICAgICAgICByZWdpc3RlcmVkVGFyZ2V0ID0gcGFpci50YWdldFJlZi5nZXQoKTtcbiAgICAgICAgaWYgKCFyZWdpc3RlcmVkVGFyZ2V0IHx8IChyZWdpc3RlcmVkVGFyZ2V0ID09PSB0YXJnZXQgJiYgaGFuZGxlciA9PT0gcGFpci5oYW5kbGVyKSkge1xuICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUucHVzaChpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAodGFyZ2V0SGFuZGxlclBhaXJzVG9SZW1vdmUubGVuZ3RoID09PSB0YXJnZXRIYW5kbGVyUGFpckxpc3QubGVuZ3RoKSB7XG4gICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlckZvckV2ZW50V2l0aE5hbWUpO1xuICAgICAgICBzb3VyY2VFdmVudE1hcC5kZWxldGUoZXZlbnROYW1lKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGogPSB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJMaXN0LnNwbGljZSh0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZVtqXSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlbW92ZVdlYWtFdmVudExpc3RlbmVyID0gcmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWFrLWV2ZW50LWxpc3RlbmVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIGRlZmF1bHREYXRlID0gbmV3IERhdGUoKTtcbnZhciBkYXRlQ29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPD0geSAmJiB4ID49IHkpOyB9O1xudmFyIERhdGVQaWNrZXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRGF0ZVBpY2tlckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGF0ZVBpY2tlckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRGF0ZVBpY2tlckJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJEYXRlUGlja2VyXCIpXG4gICAgXSwgRGF0ZVBpY2tlckJhc2UpO1xuICAgIHJldHVybiBEYXRlUGlja2VyQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuRGF0ZVBpY2tlckJhc2UgPSBEYXRlUGlja2VyQmFzZTtcbkRhdGVQaWNrZXJCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy55ZWFyUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInllYXJcIixcbiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHREYXRlLmdldEZ1bGxZZWFyKCksXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbn0pO1xuZXhwb3J0cy55ZWFyUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tb250aFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtb250aFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUuZ2V0TW9udGgoKSArIDEsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbn0pO1xuZXhwb3J0cy5tb250aFByb3BlcnR5LnJlZ2lzdGVyKERhdGVQaWNrZXJCYXNlKTtcbmV4cG9ydHMuZGF5UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRheVwiLFxuICAgIGRlZmF1bHRWYWx1ZTogZGVmYXVsdERhdGUuZ2V0RGF0ZSgpLFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH0sXG59KTtcbmV4cG9ydHMuZGF5UHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5tYXhEYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heERhdGVcIixcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBkYXRlQ29tcGFyZXIsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgRGF0ZSh2KTsgfSxcbn0pO1xuZXhwb3J0cy5tYXhEYXRlUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5taW5EYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbkRhdGVcIixcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBkYXRlQ29tcGFyZXIsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgRGF0ZSh2KTsgfSxcbn0pO1xuZXhwb3J0cy5taW5EYXRlUHJvcGVydHkucmVnaXN0ZXIoRGF0ZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5kYXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRhdGVcIixcbiAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHREYXRlLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGRhdGVDb21wYXJlcixcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBEYXRlKHYpOyB9LFxufSk7XG5leHBvcnRzLmRhdGVQcm9wZXJ0eS5yZWdpc3RlcihEYXRlUGlja2VyQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRlLXBpY2tlci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkYXRlX3BpY2tlcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2RhdGUtcGlja2VyLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2RhdGUtcGlja2VyLWNvbW1vblwiKSk7XG52YXIgRGF0ZVBpY2tlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKERhdGVQaWNrZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGF0ZVBpY2tlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGlja2VyID0gVUlEYXRlUGlja2VyLm5ldygpO1xuICAgICAgICBwaWNrZXIuZGF0ZVBpY2tlck1vZGUgPSAxO1xuICAgICAgICByZXR1cm4gcGlja2VyO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHRoaXMuX2NoYW5nZUhhbmRsZXIgPSBVSURhdGVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICAgICAgbmF0aXZlVmlldy5hZGRUYXJnZXRBY3Rpb25Gb3JDb250cm9sRXZlbnRzKHRoaXMuX2NoYW5nZUhhbmRsZXIsIFwidmFsdWVDaGFuZ2VkXCIsIDQwOTYpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NoYW5nZUhhbmRsZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0ZVBpY2tlci5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS55ZWFyUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmRhdGUgPSBuZXcgRGF0ZSh2YWx1ZSwgdGhpcy5tb250aCAtIDEsIHRoaXMuZGF5KTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1vbnRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmRhdGUgPSBuZXcgRGF0ZSh0aGlzLnllYXIsIHZhbHVlIC0gMSwgdGhpcy5kYXkpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGVbZGF0ZV9waWNrZXJfY29tbW9uXzEuZGF5UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmRhdGUgPSBuZXcgRGF0ZSh0aGlzLnllYXIsIHRoaXMubW9udGggLSAxLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5kYXRlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGlja2VyID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgY29tcHMgPSBOU0NhbGVuZGFyLmN1cnJlbnRDYWxlbmRhci5jb21wb25lbnRzRnJvbURhdGUoNCB8IDggfCAxNiwgcGlja2VyLmRhdGUpO1xuICAgICAgICBjb21wcy55ZWFyID0gdmFsdWUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgY29tcHMubW9udGggPSB2YWx1ZS5nZXRNb250aCgpICsgMTtcbiAgICAgICAgY29tcHMuZGF5ID0gdmFsdWUuZ2V0RGF0ZSgpO1xuICAgICAgICBwaWNrZXIuc2V0RGF0ZUFuaW1hdGVkKE5TQ2FsZW5kYXIuY3VycmVudENhbGVuZGFyLmRhdGVGcm9tQ29tcG9uZW50cyhjb21wcyksIGZhbHNlKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1heERhdGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5tYXhpbXVtRGF0ZTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1heERhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwaWNrZXIgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBuc0RhdGUgPSBOU0RhdGUuZGF0ZVdpdGhUaW1lSW50ZXJ2YWxTaW5jZTE5NzAodmFsdWUuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgICAgIHBpY2tlci5tYXhpbXVtRGF0ZSA9IG5zRGF0ZTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1pbkRhdGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5taW5pbXVtRGF0ZTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLm1pbkRhdGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwaWNrZXIgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBuc0RhdGUgPSBOU0RhdGUuZGF0ZVdpdGhUaW1lSW50ZXJ2YWxTaW5jZTE5NzAodmFsdWUuZ2V0VGltZSgpIC8gMTAwMCk7XG4gICAgICAgIHBpY2tlci5taW5pbXVtRGF0ZSA9IG5zRGF0ZTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXIucHJvdG90eXBlW2RhdGVfcGlja2VyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudmFsdWVGb3JLZXkoXCJ0ZXh0Q29sb3JcIik7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyLnByb3RvdHlwZVtkYXRlX3BpY2tlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBpY2tlciA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgcGlja2VyLnNldFZhbHVlRm9yS2V5KHZhbHVlIGluc3RhbmNlb2YgZGF0ZV9waWNrZXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZSwgXCJ0ZXh0Q29sb3JcIik7XG4gICAgfTtcbiAgICByZXR1cm4gRGF0ZVBpY2tlcjtcbn0oZGF0ZV9waWNrZXJfY29tbW9uXzEuRGF0ZVBpY2tlckJhc2UpKTtcbmV4cG9ydHMuRGF0ZVBpY2tlciA9IERhdGVQaWNrZXI7XG52YXIgVUlEYXRlUGlja2VyQ2hhbmdlSGFuZGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSURhdGVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSURhdGVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSURhdGVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBpbXBsID0gVUlEYXRlUGlja2VyQ2hhbmdlSGFuZGxlckltcGwubmV3KCk7XG4gICAgICAgIGltcGwuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBpbXBsO1xuICAgIH07XG4gICAgVUlEYXRlUGlja2VyQ2hhbmdlSGFuZGxlckltcGwucHJvdG90eXBlLnZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChzZW5kZXIpIHtcbiAgICAgICAgdmFyIGNvbXBzID0gTlNDYWxlbmRhci5jdXJyZW50Q2FsZW5kYXIuY29tcG9uZW50c0Zyb21EYXRlKDQgfCA4IHwgMTYsIHNlbmRlci5kYXRlKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0ZUNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKGNvbXBzLnllYXIgIT09IG93bmVyLnllYXIpIHtcbiAgICAgICAgICAgIGRhdGVfcGlja2VyX2NvbW1vbl8xLnllYXJQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgY29tcHMueWVhcik7XG4gICAgICAgICAgICBkYXRlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBzLm1vbnRoICE9PSBvd25lci5tb250aCkge1xuICAgICAgICAgICAgZGF0ZV9waWNrZXJfY29tbW9uXzEubW9udGhQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgY29tcHMubW9udGgpO1xuICAgICAgICAgICAgZGF0ZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb21wcy5kYXkgIT09IG93bmVyLmRheSkge1xuICAgICAgICAgICAgZGF0ZV9waWNrZXJfY29tbW9uXzEuZGF5UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIGNvbXBzLmRheSk7XG4gICAgICAgICAgICBkYXRlQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGVDaGFuZ2VkKSB7XG4gICAgICAgICAgICBkYXRlX3BpY2tlcl9jb21tb25fMS5kYXRlUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ldyBEYXRlKGNvbXBzLnllYXIsIGNvbXBzLm1vbnRoIC0gMSwgY29tcHMuZGF5KSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJRGF0ZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsLk9iakNFeHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgICAgXCJ2YWx1ZUNoYW5nZWRcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW1VJRGF0ZVBpY2tlcl0gfVxuICAgIH07XG4gICAgcmV0dXJuIFVJRGF0ZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsO1xufShOU09iamVjdCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0ZS1waWNrZXIuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG5leHBvcnRzLlNUUklORyA9IFwic3RyaW5nXCI7XG5leHBvcnRzLlBST01QVCA9IFwiUHJvbXB0XCI7XG5leHBvcnRzLkNPTkZJUk0gPSBcIkNvbmZpcm1cIjtcbmV4cG9ydHMuQUxFUlQgPSBcIkFsZXJ0XCI7XG5leHBvcnRzLkxPR0lOID0gXCJMb2dpblwiO1xuZXhwb3J0cy5PSyA9IFwiT0tcIjtcbmV4cG9ydHMuQ0FOQ0VMID0gXCJDYW5jZWxcIjtcbnZhciBpbnB1dFR5cGU7XG4oZnVuY3Rpb24gKGlucHV0VHlwZSkge1xuICAgIGlucHV0VHlwZS50ZXh0ID0gXCJ0ZXh0XCI7XG4gICAgaW5wdXRUeXBlLnBhc3N3b3JkID0gXCJwYXNzd29yZFwiO1xuICAgIGlucHV0VHlwZS5lbWFpbCA9IFwiZW1haWxcIjtcbiAgICBpbnB1dFR5cGUubnVtYmVyID0gXCJudW1iZXJcIjtcbiAgICBpbnB1dFR5cGUuZGVjaW1hbCA9IFwiZGVjaW1hbFwiO1xuICAgIGlucHV0VHlwZS5waG9uZSA9IFwicGhvbmVcIjtcbn0pKGlucHV0VHlwZSA9IGV4cG9ydHMuaW5wdXRUeXBlIHx8IChleHBvcnRzLmlucHV0VHlwZSA9IHt9KSk7XG52YXIgY2FwaXRhbGl6YXRpb25UeXBlO1xuKGZ1bmN0aW9uIChjYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICBjYXBpdGFsaXphdGlvblR5cGUubm9uZSA9IFwibm9uZVwiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5hbGwgPSBcImFsbFwiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5zZW50ZW5jZXMgPSBcInNlbnRlbmNlc1wiO1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS53b3JkcyA9IFwid29yZHNcIjtcbn0pKGNhcGl0YWxpemF0aW9uVHlwZSA9IGV4cG9ydHMuY2FwaXRhbGl6YXRpb25UeXBlIHx8IChleHBvcnRzLmNhcGl0YWxpemF0aW9uVHlwZSA9IHt9KSk7XG52YXIgZnJhbWU7XG5mdW5jdGlvbiBnZXRDdXJyZW50UGFnZSgpIHtcbiAgICBpZiAoIWZyYW1lKSB7XG4gICAgICAgIGZyYW1lID0gcmVxdWlyZShcInVpL2ZyYW1lXCIpO1xuICAgIH1cbiAgICB2YXIgdG9wbW9zdEZyYW1lID0gZnJhbWUudG9wbW9zdCgpO1xuICAgIGlmICh0b3Btb3N0RnJhbWUpIHtcbiAgICAgICAgcmV0dXJuIHRvcG1vc3RGcmFtZS5jdXJyZW50UGFnZTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZ2V0Q3VycmVudFBhZ2UgPSBnZXRDdXJyZW50UGFnZTtcbmZ1bmN0aW9uIGFwcGx5U2VsZWN0b3JzKHZpZXcsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGN1cnJlbnRQYWdlID0gZ2V0Q3VycmVudFBhZ2UoKTtcbiAgICBpZiAoY3VycmVudFBhZ2UpIHtcbiAgICAgICAgdmFyIHN0eWxlU2NvcGUgPSBjdXJyZW50UGFnZS5fc3R5bGVTY29wZTtcbiAgICAgICAgaWYgKHN0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHZpZXcuX2luaGVyaXRTdHlsZVNjb3BlKHN0eWxlU2NvcGUpO1xuICAgICAgICAgICAgdmlldy5vbkxvYWRlZCgpO1xuICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgICAgICB2aWV3Lm9uVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbnZhciBidXR0b247XG52YXIgbGFiZWw7XG52YXIgdGV4dEZpZWxkO1xuZnVuY3Rpb24gZ2V0QnV0dG9uQ29sb3JzKCkge1xuICAgIGlmICghYnV0dG9uKSB7XG4gICAgICAgIHZhciBCdXR0b24gPSByZXF1aXJlKFwidWkvYnV0dG9uXCIpLkJ1dHRvbjtcbiAgICAgICAgYnV0dG9uID0gbmV3IEJ1dHRvbjtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIGJ1dHRvbi5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGJ1dHRvbkNvbG9yO1xuICAgIHZhciBidXR0b25CYWNrZ3JvdW5kQ29sb3I7XG4gICAgYXBwbHlTZWxlY3RvcnMoYnV0dG9uLCBmdW5jdGlvbiAoYnRuKSB7XG4gICAgICAgIGJ1dHRvbkNvbG9yID0gYnRuLmNvbG9yO1xuICAgICAgICBidXR0b25CYWNrZ3JvdW5kQ29sb3IgPSBidG4uYmFja2dyb3VuZENvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiB7IGNvbG9yOiBidXR0b25Db2xvciwgYmFja2dyb3VuZENvbG9yOiBidXR0b25CYWNrZ3JvdW5kQ29sb3IgfTtcbn1cbmV4cG9ydHMuZ2V0QnV0dG9uQ29sb3JzID0gZ2V0QnV0dG9uQ29sb3JzO1xuZnVuY3Rpb24gZ2V0TGFiZWxDb2xvcigpIHtcbiAgICBpZiAoIWxhYmVsKSB7XG4gICAgICAgIHZhciBMYWJlbCA9IHJlcXVpcmUoXCJ1aS9sYWJlbFwiKS5MYWJlbDtcbiAgICAgICAgbGFiZWwgPSBuZXcgTGFiZWw7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICBsYWJlbC5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGxhYmVsQ29sb3I7XG4gICAgYXBwbHlTZWxlY3RvcnMobGFiZWwsIGZ1bmN0aW9uIChsYmwpIHtcbiAgICAgICAgbGFiZWxDb2xvciA9IGxibC5jb2xvcjtcbiAgICB9KTtcbiAgICByZXR1cm4gbGFiZWxDb2xvcjtcbn1cbmV4cG9ydHMuZ2V0TGFiZWxDb2xvciA9IGdldExhYmVsQ29sb3I7XG5mdW5jdGlvbiBnZXRUZXh0RmllbGRDb2xvcigpIHtcbiAgICBpZiAoIXRleHRGaWVsZCkge1xuICAgICAgICB2YXIgVGV4dEZpZWxkID0gcmVxdWlyZShcInVpL3RleHQtZmllbGRcIikuVGV4dEZpZWxkO1xuICAgICAgICB0ZXh0RmllbGQgPSBuZXcgVGV4dEZpZWxkKCk7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICB0ZXh0RmllbGQuX3NldHVwVUkoe30pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB0ZXh0RmllbGRDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyh0ZXh0RmllbGQsIGZ1bmN0aW9uICh0Zikge1xuICAgICAgICB0ZXh0RmllbGRDb2xvciA9IHRmLmNvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiB0ZXh0RmllbGRDb2xvcjtcbn1cbmV4cG9ydHMuZ2V0VGV4dEZpZWxkQ29sb3IgPSBnZXRUZXh0RmllbGRDb2xvcjtcbmZ1bmN0aW9uIGlzRGlhbG9nT3B0aW9ucyhhcmcpIHtcbiAgICByZXR1cm4gYXJnICYmIChhcmcubWVzc2FnZSB8fCBhcmcudGl0bGUpO1xufVxuZXhwb3J0cy5pc0RpYWxvZ09wdGlvbnMgPSBpc0RpYWxvZ09wdGlvbnM7XG5mdW5jdGlvbiBwYXJzZUxvZ2luT3B0aW9ucyhhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmIHR5cGVzXzEuaXNPYmplY3QoYXJnc1swXSkpIHtcbiAgICAgICAgcmV0dXJuIGFyZ3NbMF07XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0geyB0aXRsZTogZXhwb3J0cy5MT0dJTiwgb2tCdXR0b25UZXh0OiBleHBvcnRzLk9LLCBjYW5jZWxCdXR0b25UZXh0OiBleHBvcnRzLkNBTkNFTCB9O1xuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbMF0pKSB7XG4gICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3NbMF07XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbMV0pKSB7XG4gICAgICAgIG9wdGlvbnMudXNlck5hbWVIaW50ID0gYXJnc1sxXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1syXSkpIHtcbiAgICAgICAgb3B0aW9ucy5wYXNzd29yZEhpbnQgPSBhcmdzWzJdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzNdKSkge1xuICAgICAgICBvcHRpb25zLnVzZXJOYW1lID0gYXJnc1szXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1s0XSkpIHtcbiAgICAgICAgb3B0aW9ucy5wYXNzd29yZCA9IGFyZ3NbNF07XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xufVxuZXhwb3J0cy5wYXJzZUxvZ2luT3B0aW9ucyA9IHBhcnNlTG9naW5PcHRpb25zO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGlhbG9ncy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGRpYWxvZ3NfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9kaWFsb2dzLWNvbW1vblwiKTtcbnZhciB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGFwcGxpY2F0aW9uXzEgPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9kaWFsb2dzLWNvbW1vblwiKSk7XG5mdW5jdGlvbiBhZGRCdXR0b25zVG9BbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyLCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCkpIHtcbiAgICAgICAgYWxlcnRDb250cm9sbGVyLmFkZEFjdGlvbihVSUFsZXJ0QWN0aW9uLmFjdGlvbldpdGhUaXRsZVN0eWxlSGFuZGxlcihvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJhaXNlQ2FsbGJhY2soY2FsbGJhY2ssIGZhbHNlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhvcHRpb25zLm5ldXRyYWxCdXR0b25UZXh0KSkge1xuICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkQWN0aW9uKFVJQWxlcnRBY3Rpb24uYWN0aW9uV2l0aFRpdGxlU3R5bGVIYW5kbGVyKG9wdGlvbnMubmV1dHJhbEJ1dHRvblRleHQsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJhaXNlQ2FsbGJhY2soY2FsbGJhY2ssIHVuZGVmaW5lZCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcob3B0aW9ucy5va0J1dHRvblRleHQpKSB7XG4gICAgICAgIGFsZXJ0Q29udHJvbGxlci5hZGRBY3Rpb24oVUlBbGVydEFjdGlvbi5hY3Rpb25XaXRoVGl0bGVTdHlsZUhhbmRsZXIob3B0aW9ucy5va0J1dHRvblRleHQsIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJhaXNlQ2FsbGJhY2soY2FsbGJhY2ssIHRydWUpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuZnVuY3Rpb24gcmFpc2VDYWxsYmFjayhjYWxsYmFjaywgcmVzdWx0KSB7XG4gICAgaWYgKHR5cGVzXzEuaXNGdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgICAgY2FsbGJhY2socmVzdWx0KTtcbiAgICB9XG59XG5mdW5jdGlvbiBhbGVydChhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSAhZGlhbG9nc19jb21tb25fMS5pc0RpYWxvZ09wdGlvbnMoYXJnKSA/IHsgdGl0bGU6IGRpYWxvZ3NfY29tbW9uXzEuQUxFUlQsIG9rQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5PSywgbWVzc2FnZTogYXJnICsgXCJcIiB9IDogYXJnO1xuICAgICAgICAgICAgdmFyIGFsZXJ0Q29udHJvbGxlciA9IFVJQWxlcnRDb250cm9sbGVyLmFsZXJ0Q29udHJvbGxlcldpdGhUaXRsZU1lc3NhZ2VQcmVmZXJyZWRTdHlsZShvcHRpb25zLnRpdGxlLCBvcHRpb25zLm1lc3NhZ2UsIDEpO1xuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlciwgb3B0aW9ucywgZnVuY3Rpb24gKCkgeyByZXNvbHZlKCk7IH0pO1xuICAgICAgICAgICAgc2hvd1VJQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmFsZXJ0ID0gYWxlcnQ7XG5mdW5jdGlvbiBjb25maXJtKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICFkaWFsb2dzX2NvbW1vbl8xLmlzRGlhbG9nT3B0aW9ucyhhcmcpID8geyB0aXRsZTogZGlhbG9nc19jb21tb25fMS5DT05GSVJNLCBva0J1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuT0ssIGNhbmNlbEJ1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuQ0FOQ0VMLCBtZXNzYWdlOiBhcmcgKyBcIlwiIH0gOiBhcmc7XG4gICAgICAgICAgICB2YXIgYWxlcnRDb250cm9sbGVyID0gVUlBbGVydENvbnRyb2xsZXIuYWxlcnRDb250cm9sbGVyV2l0aFRpdGxlTWVzc2FnZVByZWZlcnJlZFN0eWxlKG9wdGlvbnMudGl0bGUsIG9wdGlvbnMubWVzc2FnZSwgMSk7XG4gICAgICAgICAgICBhZGRCdXR0b25zVG9BbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyLCBvcHRpb25zLCBmdW5jdGlvbiAocikgeyByZXNvbHZlKHIpOyB9KTtcbiAgICAgICAgICAgIHNob3dVSUFsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5jb25maXJtID0gY29uZmlybTtcbmZ1bmN0aW9uIHByb21wdChhcmcpIHtcbiAgICB2YXIgb3B0aW9ucztcbiAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgICAgIHRpdGxlOiBkaWFsb2dzX2NvbW1vbl8xLlBST01QVCxcbiAgICAgICAgb2tCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLk9LLFxuICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLkNBTkNFTCxcbiAgICAgICAgaW5wdXRUeXBlOiBkaWFsb2dzX2NvbW1vbl8xLmlucHV0VHlwZS50ZXh0LFxuICAgIH07XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3VtZW50c1swXSkgJiYgdHlwZXNfMS5pc1N0cmluZyhhcmd1bWVudHNbMV0pKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBvcHRpb25zLmRlZmF1bHRUZXh0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgdGV4dEZpZWxkXzE7XG4gICAgICAgICAgICB2YXIgYWxlcnRDb250cm9sbGVyID0gVUlBbGVydENvbnRyb2xsZXIuYWxlcnRDb250cm9sbGVyV2l0aFRpdGxlTWVzc2FnZVByZWZlcnJlZFN0eWxlKG9wdGlvbnMudGl0bGUsIG9wdGlvbnMubWVzc2FnZSwgMSk7XG4gICAgICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkVGV4dEZpZWxkV2l0aENvbmZpZ3VyYXRpb25IYW5kbGVyKGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICBhcmcudGV4dCA9IHR5cGVzXzEuaXNTdHJpbmcob3B0aW9ucy5kZWZhdWx0VGV4dCkgPyBvcHRpb25zLmRlZmF1bHRUZXh0IDogXCJcIjtcbiAgICAgICAgICAgICAgICBhcmcuc2VjdXJlVGV4dEVudHJ5ID0gb3B0aW9ucyAmJiBvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUucGFzc3dvcmQ7XG4gICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLmVtYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZy5rZXlib2FyZFR5cGUgPSA3O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zICYmIG9wdGlvbnMuaW5wdXRUeXBlID09PSBkaWFsb2dzX2NvbW1vbl8xLmlucHV0VHlwZS5udW1iZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLmtleWJvYXJkVHlwZSA9IDQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLmRlY2ltYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLmtleWJvYXJkVHlwZSA9IDg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLnBob25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZy5rZXlib2FyZFR5cGUgPSA1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSBkaWFsb2dzX2NvbW1vbl8xLmdldFRleHRGaWVsZENvbG9yKCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZy50ZXh0Q29sb3IgPSBhcmcudGludENvbG9yID0gY29sb3IuaW9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGV4dEZpZWxkXzEgPSBhbGVydENvbnRyb2xsZXIudGV4dEZpZWxkcy5maXJzdE9iamVjdDtcbiAgICAgICAgICAgIGlmIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvcHRpb25zLmNhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGRpYWxvZ3NfY29tbW9uXzEuY2FwaXRhbGl6YXRpb25UeXBlLmFsbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEZpZWxkXzEuYXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIGRpYWxvZ3NfY29tbW9uXzEuY2FwaXRhbGl6YXRpb25UeXBlLnNlbnRlbmNlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEZpZWxkXzEuYXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIGRpYWxvZ3NfY29tbW9uXzEuY2FwaXRhbGl6YXRpb25UeXBlLndvcmRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RmllbGRfMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRGaWVsZF8xLmF1dG9jYXBpdGFsaXphdGlvblR5cGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlciwgb3B0aW9ucywgZnVuY3Rpb24gKHIpIHsgcmVzb2x2ZSh7IHJlc3VsdDogciwgdGV4dDogdGV4dEZpZWxkXzEudGV4dCB9KTsgfSk7XG4gICAgICAgICAgICBzaG93VUlBbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMucHJvbXB0ID0gcHJvbXB0O1xuZnVuY3Rpb24gbG9naW4oKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBvcHRpb25zID0gZGlhbG9nc19jb21tb25fMS5wYXJzZUxvZ2luT3B0aW9ucyhhcmdzKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHVzZXJOYW1lVGV4dEZpZWxkXzE7XG4gICAgICAgICAgICB2YXIgcGFzc3dvcmRUZXh0RmllbGRfMTtcbiAgICAgICAgICAgIHZhciBhbGVydENvbnRyb2xsZXIgPSBVSUFsZXJ0Q29udHJvbGxlci5hbGVydENvbnRyb2xsZXJXaXRoVGl0bGVNZXNzYWdlUHJlZmVycmVkU3R5bGUob3B0aW9ucy50aXRsZSwgb3B0aW9ucy5tZXNzYWdlLCAxKTtcbiAgICAgICAgICAgIHZhciB0ZXh0RmllbGRDb2xvcl8xID0gZGlhbG9nc19jb21tb25fMS5nZXRUZXh0RmllbGRDb2xvcigpO1xuICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLmFkZFRleHRGaWVsZFdpdGhDb25maWd1cmF0aW9uSGFuZGxlcihmdW5jdGlvbiAoYXJnKSB7XG4gICAgICAgICAgICAgICAgYXJnLnBsYWNlaG9sZGVyID0gXCJMb2dpblwiO1xuICAgICAgICAgICAgICAgIGFyZy5wbGFjZWhvbGRlciA9IG9wdGlvbnMudXNlck5hbWVIaW50ID8gb3B0aW9ucy51c2VyTmFtZUhpbnQgOiBcIlwiO1xuICAgICAgICAgICAgICAgIGFyZy50ZXh0ID0gdHlwZXNfMS5pc1N0cmluZyhvcHRpb25zLnVzZXJOYW1lKSA/IG9wdGlvbnMudXNlck5hbWUgOiBcIlwiO1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0RmllbGRDb2xvcl8xKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZy50ZXh0Q29sb3IgPSBhcmcudGludENvbG9yID0gdGV4dEZpZWxkQ29sb3JfMS5pb3M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkVGV4dEZpZWxkV2l0aENvbmZpZ3VyYXRpb25IYW5kbGVyKGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICBhcmcucGxhY2Vob2xkZXIgPSBcIlBhc3N3b3JkXCI7XG4gICAgICAgICAgICAgICAgYXJnLnNlY3VyZVRleHRFbnRyeSA9IHRydWU7XG4gICAgICAgICAgICAgICAgYXJnLnBsYWNlaG9sZGVyID0gb3B0aW9ucy5wYXNzd29yZEhpbnQgPyBvcHRpb25zLnBhc3N3b3JkSGludCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgYXJnLnRleHQgPSB0eXBlc18xLmlzU3RyaW5nKG9wdGlvbnMucGFzc3dvcmQpID8gb3B0aW9ucy5wYXNzd29yZCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRGaWVsZENvbG9yXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLnRleHRDb2xvciA9IGFyZy50aW50Q29sb3IgPSB0ZXh0RmllbGRDb2xvcl8xLmlvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHVzZXJOYW1lVGV4dEZpZWxkXzEgPSBhbGVydENvbnRyb2xsZXIudGV4dEZpZWxkcy5maXJzdE9iamVjdDtcbiAgICAgICAgICAgIHBhc3N3b3JkVGV4dEZpZWxkXzEgPSBhbGVydENvbnRyb2xsZXIudGV4dEZpZWxkcy5sYXN0T2JqZWN0O1xuICAgICAgICAgICAgYWRkQnV0dG9uc1RvQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlciwgb3B0aW9ucywgZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiByLFxuICAgICAgICAgICAgICAgICAgICB1c2VyTmFtZTogdXNlck5hbWVUZXh0RmllbGRfMS50ZXh0LFxuICAgICAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRUZXh0RmllbGRfMS50ZXh0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNob3dVSUFsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5sb2dpbiA9IGxvZ2luO1xuZnVuY3Rpb24gc2hvd1VJQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlcikge1xuICAgIHZhciBfYSwgX2I7XG4gICAgdmFyIGN1cnJlbnRWaWV3ID0gZGlhbG9nc19jb21tb25fMS5nZXRDdXJyZW50UGFnZSgpIHx8IGFwcGxpY2F0aW9uXzEuZ2V0Um9vdFZpZXcoKTtcbiAgICBpZiAoY3VycmVudFZpZXcpIHtcbiAgICAgICAgY3VycmVudFZpZXcgPSBjdXJyZW50Vmlldy5tb2RhbCB8fCBjdXJyZW50VmlldztcbiAgICAgICAgdmFyIHZpZXdDb250cm9sbGVyID0gY3VycmVudFZpZXcuaW9zO1xuICAgICAgICBpZiAoIShjdXJyZW50Vmlldy5pb3MgaW5zdGFuY2VvZiBVSVZpZXdDb250cm9sbGVyKSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudFdpdGhDb250cm9sbGVyID0gdmlld18xLmlvcy5nZXRQYXJlbnRXaXRoVmlld0NvbnRyb2xsZXIoY3VycmVudFZpZXcpO1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIgPSBwYXJlbnRXaXRoQ29udHJvbGxlciA/IHBhcmVudFdpdGhDb250cm9sbGVyLnZpZXdDb250cm9sbGVyIDogdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgaWYgKGFsZXJ0Q29udHJvbGxlci5wb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5wb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5zb3VyY2VWaWV3ID0gdmlld0NvbnRyb2xsZXIudmlldztcbiAgICAgICAgICAgICAgICBhbGVydENvbnRyb2xsZXIucG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXIuc291cmNlUmVjdCA9IENHUmVjdE1ha2Uodmlld0NvbnRyb2xsZXIudmlldy5ib3VuZHMuc2l6ZS53aWR0aCAvIDIuMCwgdmlld0NvbnRyb2xsZXIudmlldy5ib3VuZHMuc2l6ZS5oZWlnaHQgLyAyLjAsIDEuMCwgMS4wKTtcbiAgICAgICAgICAgICAgICBhbGVydENvbnRyb2xsZXIucG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXIucGVybWl0dGVkQXJyb3dEaXJlY3Rpb25zID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb2xvciA9IGRpYWxvZ3NfY29tbW9uXzEuZ2V0QnV0dG9uQ29sb3JzKCkuY29sb3I7XG4gICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICBhbGVydENvbnRyb2xsZXIudmlldy50aW50Q29sb3IgPSBjb2xvci5pb3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbGJsQ29sb3IgPSBkaWFsb2dzX2NvbW1vbl8xLmdldExhYmVsQ29sb3IoKTtcbiAgICAgICAgICAgIGlmIChsYmxDb2xvcikge1xuICAgICAgICAgICAgICAgIGlmIChhbGVydENvbnRyb2xsZXIudGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gTlNBdHRyaWJ1dGVkU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmdBdHRyaWJ1dGVzKGFsZXJ0Q29udHJvbGxlci50aXRsZSwgKF9hID0ge30sIF9hW05TRm9yZWdyb3VuZENvbG9yQXR0cmlidXRlTmFtZV0gPSBsYmxDb2xvci5pb3MsIF9hKSk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5zZXRWYWx1ZUZvcktleSh0aXRsZSwgXCJhdHRyaWJ1dGVkVGl0bGVcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbGVydENvbnRyb2xsZXIubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IE5TQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXRXaXRoU3RyaW5nQXR0cmlidXRlcyhhbGVydENvbnRyb2xsZXIubWVzc2FnZSwgKF9iID0ge30sIF9iW05TRm9yZWdyb3VuZENvbG9yQXR0cmlidXRlTmFtZV0gPSBsYmxDb2xvci5pb3MsIF9iKSk7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5zZXRWYWx1ZUZvcktleShtZXNzYWdlLCBcImF0dHJpYnV0ZWRNZXNzYWdlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVyLnByZXNlbnRNb2RhbFZpZXdDb250cm9sbGVyQW5pbWF0ZWQoYWxlcnRDb250cm9sbGVyLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIGFjdGlvbigpIHtcbiAgICB2YXIgb3B0aW9ucztcbiAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7IHRpdGxlOiBudWxsLCBjYW5jZWxCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLkNBTkNFTCB9O1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmd1bWVudHNbMF0pICYmIHR5cGVzXzEuaXNTdHJpbmcoYXJndW1lbnRzWzFdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgb3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJndW1lbnRzWzBdKSAmJiB0eXBlc18xLmlzU3RyaW5nKGFyZ3VtZW50c1sxXSkgJiYgdHlwZXNfMS5pc0RlZmluZWQoYXJndW1lbnRzWzJdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgb3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICAgICAgb3B0aW9ucy5hY3Rpb25zID0gYXJndW1lbnRzWzJdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgaSA9IHZvaWQgMDtcbiAgICAgICAgICAgIHZhciBhY3Rpb25fMTtcbiAgICAgICAgICAgIHZhciBhbGVydENvbnRyb2xsZXIgPSBVSUFsZXJ0Q29udHJvbGxlci5hbGVydENvbnRyb2xsZXJXaXRoVGl0bGVNZXNzYWdlUHJlZmVycmVkU3R5bGUob3B0aW9ucy50aXRsZSwgb3B0aW9ucy5tZXNzYWdlLCAwKTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmFjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgb3B0aW9ucy5hY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbl8xID0gb3B0aW9ucy5hY3Rpb25zW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhY3Rpb25fMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5hZGRBY3Rpb24oVUlBbGVydEFjdGlvbi5hY3Rpb25XaXRoVGl0bGVTdHlsZUhhbmRsZXIoYWN0aW9uXzEsIDAsIGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGFyZy50aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQpKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLmFkZEFjdGlvbihVSUFsZXJ0QWN0aW9uLmFjdGlvbldpdGhUaXRsZVN0eWxlSGFuZGxlcihvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQsIDEsIGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShhcmcudGl0bGUpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNob3dVSUFsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5hY3Rpb24gPSBhY3Rpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaWFsb2dzLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIikpO1xudmFyIEVkaXRhYmxlVGV4dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhFZGl0YWJsZVRleHRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVkaXRhYmxlVGV4dEJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fZm9jdXNIYW5kbGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImZvY3VzXCIpOyB9O1xuICAgICAgICBfdGhpcy5fYmx1ckhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiYmx1clwiKTsgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5fdXBkYXRlVGV4dEJhc2VGb2N1c1N0YXRlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIG1ldGhvZCA9IHN1YnNjcmliZSA/IFwib25cIiA6IFwib2ZmXCI7XG4gICAgICAgIHRoaXNbbWV0aG9kXShcImZvY3VzXCIsIHRoaXMuX2ZvY3VzSGFuZGxlcik7XG4gICAgICAgIHRoaXNbbWV0aG9kXShcImJsdXJcIiwgdGhpcy5fYmx1ckhhbmRsZXIpO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5ibHVyRXZlbnQgPSBcImJsdXJcIjtcbiAgICBFZGl0YWJsZVRleHRCYXNlLmZvY3VzRXZlbnQgPSBcImZvY3VzXCI7XG4gICAgRWRpdGFibGVUZXh0QmFzZS50ZXh0Q2hhbmdlRXZlbnQgPSBcInRleHRDaGFuZ2VcIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgdGV4dF9iYXNlXzEuUHNldWRvQ2xhc3NIYW5kbGVyKFwiZm9jdXNcIiwgXCJibHVyXCIpXG4gICAgXSwgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGUsIFwiX3VwZGF0ZVRleHRCYXNlRm9jdXNTdGF0ZUhhbmRsZXJcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEVkaXRhYmxlVGV4dEJhc2U7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkVkaXRhYmxlVGV4dEJhc2UgPSBFZGl0YWJsZVRleHRCYXNlO1xuZXhwb3J0cy5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInBsYWNlaG9sZGVyQ29sb3JcIiwgY3NzTmFtZTogXCJwbGFjZWhvbGRlci1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB0ZXh0X2Jhc2VfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHRleHRfYmFzZV8xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkucmVnaXN0ZXIodGV4dF9iYXNlXzEuU3R5bGUpO1xudmFyIGtleWJvYXJkVHlwZUNvbnZlcnRlciA9IHRleHRfYmFzZV8xLm1ha2VQYXJzZXIodGV4dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImRhdGV0aW1lXCIsIFwicGhvbmVcIiwgXCJudW1iZXJcIiwgXCJ1cmxcIiwgXCJlbWFpbFwiKSk7XG5leHBvcnRzLmtleWJvYXJkVHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJrZXlib2FyZFR5cGVcIiwgdmFsdWVDb252ZXJ0ZXI6IGtleWJvYXJkVHlwZUNvbnZlcnRlciB9KTtcbmV4cG9ydHMua2V5Ym9hcmRUeXBlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG52YXIgcmV0dXJuS2V5VHlwZUNvbnZlcnRlciA9IHRleHRfYmFzZV8xLm1ha2VQYXJzZXIodGV4dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcImRvbmVcIiwgXCJuZXh0XCIsIFwiZ29cIiwgXCJzZWFyY2hcIiwgXCJzZW5kXCIpKTtcbmV4cG9ydHMucmV0dXJuS2V5VHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJyZXR1cm5LZXlUeXBlXCIsIHZhbHVlQ29udmVydGVyOiByZXR1cm5LZXlUeXBlQ29udmVydGVyIH0pO1xuZXhwb3J0cy5yZXR1cm5LZXlUeXBlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLmVkaXRhYmxlUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImVkaXRhYmxlXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmVkaXRhYmxlUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLnVwZGF0ZVRleHRUcmlnZ2VyUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcInVwZGF0ZVRleHRUcmlnZ2VyXCIsIGRlZmF1bHRWYWx1ZTogXCJ0ZXh0Q2hhbmdlZFwiIH0pO1xuZXhwb3J0cy51cGRhdGVUZXh0VHJpZ2dlclByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xudmFyIGF1dG9jYXBpdGFsaXphdGlvblR5cGVDb252ZXJ0ZXIgPSB0ZXh0X2Jhc2VfMS5tYWtlUGFyc2VyKHRleHRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJub25lXCIsIFwid29yZHNcIiwgXCJzZW50ZW5jZXNcIiwgXCJhbGxjaGFyYWN0ZXJzXCIpKTtcbmV4cG9ydHMuYXV0b2NhcGl0YWxpemF0aW9uVHlwZVByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJhdXRvY2FwaXRhbGl6YXRpb25UeXBlXCIsIGRlZmF1bHRWYWx1ZTogXCJzZW50ZW5jZXNcIiwgdmFsdWVDb252ZXJ0ZXI6IGF1dG9jYXBpdGFsaXphdGlvblR5cGVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMuYXV0b2NvcnJlY3RQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYXV0b2NvcnJlY3RcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmF1dG9jb3JyZWN0UHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG5leHBvcnRzLmhpbnRQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaGludFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIgfSk7XG5leHBvcnRzLmhpbnRQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMubWF4TGVuZ3RoUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm1heExlbmd0aFwiLCBkZWZhdWx0VmFsdWU6IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlSW50IH0pO1xuZXhwb3J0cy5tYXhMZW5ndGhQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVkaXRhYmxlLXRleHQtYmFzZS1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZWRpdGFibGUtdGV4dC1iYXNlLWNvbW1vblwiKSk7XG52YXIgRWRpdGFibGVUZXh0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEVkaXRhYmxlVGV4dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRWRpdGFibGVUZXh0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZS5kaXNtaXNzU29mdElucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnJlc2lnbkZpcnN0UmVzcG9uZGVyKCk7XG4gICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBFZGl0YWJsZVRleHRCYXNlLmJsdXJFdmVudCwgb2JqZWN0OiB0aGlzIH0pO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmtleWJvYXJkVHlwZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2V5Ym9hcmRUeXBlID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5rZXlib2FyZFR5cGU7XG4gICAgICAgIHN3aXRjaCAoa2V5Ym9hcmRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwicGhvbmVcIjtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1cmxcIjtcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJlbWFpbFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5Ym9hcmRUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5rZXlib2FyZFR5cGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdLZXlib2FyZFR5cGU7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJkYXRldGltZVwiOlxuICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicGhvbmVcIjpcbiAgICAgICAgICAgICAgICBuZXdLZXlib2FyZFR5cGUgPSA1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOlxuICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidXJsXCI6XG4gICAgICAgICAgICAgICAgbmV3S2V5Ym9hcmRUeXBlID0gMztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJlbWFpbFwiOlxuICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHZhciBrdCA9ICt2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGt0KSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdLZXlib2FyZFR5cGUgPSBrdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQua2V5Ym9hcmRUeXBlID0gbmV3S2V5Ym9hcmRUeXBlO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnJldHVybktleVR5cGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJldHVybktleVR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnJldHVybktleVR5cGU7XG4gICAgICAgIHN3aXRjaCAocmV0dXJuS2V5VHlwZSkge1xuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIHJldHVybiBcImRvbmVcIjtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJnb1wiO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcIm5leHRcIjtcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzZWFyY2hcIjtcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzZW5kXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiByZXR1cm5LZXlUeXBlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5yZXR1cm5LZXlUeXBlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3VmFsdWU7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJkb25lXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSA5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImdvXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIm5leHRcIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2VhcmNoXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSA2O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNlbmRcIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHZhciBya3QgPSArdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihya3QpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gcmt0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnJldHVybktleVR5cGUgPSBuZXdWYWx1ZTtcbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdXRvY2FwaXRhbGl6YXRpb25UeXBlO1xuICAgICAgICBzd2l0Y2ggKGF1dG9jYXBpdGFsaXphdGlvblR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJub25lXCI7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwid29yZHNcIjtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzZW50ZW5jZXNcIjtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhbGxjaGFyYWN0ZXJzXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYXV0b2NhcGl0YWxpemF0aW9uVHlwZSB2YWx1ZTpcIiArIGF1dG9jYXBpdGFsaXphdGlvblR5cGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuYXV0b2NhcGl0YWxpemF0aW9uVHlwZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld1ZhbHVlO1xuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ3b3Jkc1wiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzZW50ZW5jZXNcIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYWxsY2hhcmFjdGVyc1wiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gMztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IG5ld1ZhbHVlO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jb3JyZWN0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhdXRvY29ycmVjdGlvblR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmF1dG9jb3JyZWN0aW9uVHlwZTtcbiAgICAgICAgc3dpdGNoIChhdXRvY29ycmVjdGlvblR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF1dG9jb3JyZWN0aW9uVHlwZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jb3JyZWN0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3VmFsdWU7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSAyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXV0b2NvcnJlY3Rpb25UeXBlID0gbmV3VmFsdWU7XG4gICAgfTtcbiAgICByZXR1cm4gRWRpdGFibGVUZXh0QmFzZTtcbn0oZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLkVkaXRhYmxlVGV4dEJhc2UpKTtcbmV4cG9ydHMuRWRpdGFibGVUZXh0QmFzZSA9IEVkaXRhYmxlVGV4dEJhc2U7XG5mdW5jdGlvbiBfdXBkYXRlQ2hhcmFjdGVyc0luUmFuZ2VSZXBsYWNlbWVudFN0cmluZyhmb3JtYXR0ZWRUZXh0LCByYW5nZUxvY2F0aW9uLCByYW5nZUxlbmd0aCwgcmVwbGFjZW1lbnRTdHJpbmcpIHtcbiAgICB2YXIgZGVsZXRpbmdUZXh0ID0gIXJlcGxhY2VtZW50U3RyaW5nO1xuICAgIHZhciBjdXJyZW50TG9jYXRpb24gPSAwO1xuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGZvcm1hdHRlZFRleHQuc3BhbnMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICB2YXIgc3BhbiA9IGZvcm1hdHRlZFRleHQuc3BhbnMuZ2V0SXRlbShpKTtcbiAgICAgICAgaWYgKGN1cnJlbnRMb2NhdGlvbiA8PSByYW5nZUxvY2F0aW9uICYmIHJhbmdlTG9jYXRpb24gPCAoY3VycmVudExvY2F0aW9uICsgc3Bhbi50ZXh0Lmxlbmd0aCkpIHtcbiAgICAgICAgICAgIHZhciBuZXdUZXh0ID0gc3BsaWNlKHNwYW4udGV4dCwgcmFuZ2VMb2NhdGlvbiAtIGN1cnJlbnRMb2NhdGlvbiwgZGVsZXRpbmdUZXh0ID8gcmFuZ2VMZW5ndGggOiAwLCByZXBsYWNlbWVudFN0cmluZyk7XG4gICAgICAgICAgICBzcGFuLl9zZXRUZXh0SW50ZXJuYWwobmV3VGV4dCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY3VycmVudExvY2F0aW9uICs9IHNwYW4udGV4dC5sZW5ndGg7XG4gICAgfVxufVxuZXhwb3J0cy5fdXBkYXRlQ2hhcmFjdGVyc0luUmFuZ2VSZXBsYWNlbWVudFN0cmluZyA9IF91cGRhdGVDaGFyYWN0ZXJzSW5SYW5nZVJlcGxhY2VtZW50U3RyaW5nO1xuZnVuY3Rpb24gc3BsaWNlKHZhbHVlLCBzdGFydCwgZGVsQ291bnQsIG5ld1N1YlN0cikge1xuICAgIHJldHVybiB2YWx1ZS5zbGljZSgwLCBzdGFydCkgKyBuZXdTdWJTdHIgKyB2YWx1ZS5zbGljZShzdGFydCArIE1hdGguYWJzKGRlbENvdW50KSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lZGl0YWJsZS10ZXh0LWJhc2UuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBLZXlib2FyZFR5cGU7XG4oZnVuY3Rpb24gKEtleWJvYXJkVHlwZSkge1xuICAgIEtleWJvYXJkVHlwZS5kYXRldGltZSA9IFwiZGF0ZXRpbWVcIjtcbiAgICBLZXlib2FyZFR5cGUucGhvbmUgPSBcInBob25lXCI7XG4gICAgS2V5Ym9hcmRUeXBlLm51bWJlciA9IFwibnVtYmVyXCI7XG4gICAgS2V5Ym9hcmRUeXBlLnVybCA9IFwidXJsXCI7XG4gICAgS2V5Ym9hcmRUeXBlLmVtYWlsID0gXCJlbWFpbFwiO1xufSkoS2V5Ym9hcmRUeXBlID0gZXhwb3J0cy5LZXlib2FyZFR5cGUgfHwgKGV4cG9ydHMuS2V5Ym9hcmRUeXBlID0ge30pKTtcbnZhciBSZXR1cm5LZXlUeXBlO1xuKGZ1bmN0aW9uIChSZXR1cm5LZXlUeXBlKSB7XG4gICAgUmV0dXJuS2V5VHlwZS5kb25lID0gXCJkb25lXCI7XG4gICAgUmV0dXJuS2V5VHlwZS5uZXh0ID0gXCJuZXh0XCI7XG4gICAgUmV0dXJuS2V5VHlwZS5nbyA9IFwiZ29cIjtcbiAgICBSZXR1cm5LZXlUeXBlLnNlYXJjaCA9IFwic2VhcmNoXCI7XG4gICAgUmV0dXJuS2V5VHlwZS5zZW5kID0gXCJzZW5kXCI7XG59KShSZXR1cm5LZXlUeXBlID0gZXhwb3J0cy5SZXR1cm5LZXlUeXBlIHx8IChleHBvcnRzLlJldHVybktleVR5cGUgPSB7fSkpO1xudmFyIFRleHRBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFRleHRBbGlnbm1lbnQpIHtcbiAgICBUZXh0QWxpZ25tZW50LmxlZnQgPSBcImxlZnRcIjtcbiAgICBUZXh0QWxpZ25tZW50LmNlbnRlciA9IFwiY2VudGVyXCI7XG4gICAgVGV4dEFsaWdubWVudC5yaWdodCA9IFwicmlnaHRcIjtcbn0pKFRleHRBbGlnbm1lbnQgPSBleHBvcnRzLlRleHRBbGlnbm1lbnQgfHwgKGV4cG9ydHMuVGV4dEFsaWdubWVudCA9IHt9KSk7XG52YXIgVGV4dERlY29yYXRpb247XG4oZnVuY3Rpb24gKFRleHREZWNvcmF0aW9uKSB7XG4gICAgVGV4dERlY29yYXRpb24ubm9uZSA9IFwibm9uZVwiO1xuICAgIFRleHREZWNvcmF0aW9uLnVuZGVybGluZSA9IFwidW5kZXJsaW5lXCI7XG4gICAgVGV4dERlY29yYXRpb24ubGluZVRocm91Z2ggPSBcImxpbmUtdGhyb3VnaFwiO1xufSkoVGV4dERlY29yYXRpb24gPSBleHBvcnRzLlRleHREZWNvcmF0aW9uIHx8IChleHBvcnRzLlRleHREZWNvcmF0aW9uID0ge30pKTtcbnZhciBUZXh0VHJhbnNmb3JtO1xuKGZ1bmN0aW9uIChUZXh0VHJhbnNmb3JtKSB7XG4gICAgVGV4dFRyYW5zZm9ybS5ub25lID0gXCJub25lXCI7XG4gICAgVGV4dFRyYW5zZm9ybS5jYXBpdGFsaXplID0gXCJjYXBpdGFsaXplXCI7XG4gICAgVGV4dFRyYW5zZm9ybS51cHBlcmNhc2UgPSBcInVwcGVyY2FzZVwiO1xuICAgIFRleHRUcmFuc2Zvcm0ubG93ZXJjYXNlID0gXCJsb3dlcmNhc2VcIjtcbn0pKFRleHRUcmFuc2Zvcm0gPSBleHBvcnRzLlRleHRUcmFuc2Zvcm0gfHwgKGV4cG9ydHMuVGV4dFRyYW5zZm9ybSA9IHt9KSk7XG52YXIgV2hpdGVTcGFjZTtcbihmdW5jdGlvbiAoV2hpdGVTcGFjZSkge1xuICAgIFdoaXRlU3BhY2Uubm9ybWFsID0gXCJub3JtYWxcIjtcbiAgICBXaGl0ZVNwYWNlLm5vd3JhcCA9IFwibm93cmFwXCI7XG59KShXaGl0ZVNwYWNlID0gZXhwb3J0cy5XaGl0ZVNwYWNlIHx8IChleHBvcnRzLldoaXRlU3BhY2UgPSB7fSkpO1xudmFyIE9yaWVudGF0aW9uO1xuKGZ1bmN0aW9uIChPcmllbnRhdGlvbikge1xuICAgIE9yaWVudGF0aW9uLmhvcml6b250YWwgPSBcImhvcml6b250YWxcIjtcbiAgICBPcmllbnRhdGlvbi52ZXJ0aWNhbCA9IFwidmVydGljYWxcIjtcbn0pKE9yaWVudGF0aW9uID0gZXhwb3J0cy5PcmllbnRhdGlvbiB8fCAoZXhwb3J0cy5PcmllbnRhdGlvbiA9IHt9KSk7XG52YXIgRGV2aWNlT3JpZW50YXRpb247XG4oZnVuY3Rpb24gKERldmljZU9yaWVudGF0aW9uKSB7XG4gICAgRGV2aWNlT3JpZW50YXRpb24ucG9ydHJhaXQgPSBcInBvcnRyYWl0XCI7XG4gICAgRGV2aWNlT3JpZW50YXRpb24ubGFuZHNjYXBlID0gXCJsYW5kc2NhcGVcIjtcbiAgICBEZXZpY2VPcmllbnRhdGlvbi51bmtub3duID0gXCJ1bmtub3duXCI7XG59KShEZXZpY2VPcmllbnRhdGlvbiA9IGV4cG9ydHMuRGV2aWNlT3JpZW50YXRpb24gfHwgKGV4cG9ydHMuRGV2aWNlT3JpZW50YXRpb24gPSB7fSkpO1xudmFyIEhvcml6b250YWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKEhvcml6b250YWxBbGlnbm1lbnQpIHtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmxlZnQgPSBcImxlZnRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmNlbnRlciA9IFwiY2VudGVyXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5yaWdodCA9IFwicmlnaHRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LnN0cmV0Y2ggPSBcInN0cmV0Y2hcIjtcbn0pKEhvcml6b250YWxBbGlnbm1lbnQgPSBleHBvcnRzLkhvcml6b250YWxBbGlnbm1lbnQgfHwgKGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCA9IHt9KSk7XG52YXIgVmVydGljYWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFZlcnRpY2FsQWxpZ25tZW50KSB7XG4gICAgVmVydGljYWxBbGlnbm1lbnQudG9wID0gXCJ0b3BcIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5taWRkbGUgPSBcIm1pZGRsZVwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LmJvdHRvbSA9IFwiYm90dG9tXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuc3RyZXRjaCA9IFwic3RyZXRjaFwiO1xufSkoVmVydGljYWxBbGlnbm1lbnQgPSBleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50IHx8IChleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50ID0ge30pKTtcbnZhciBTdHJldGNoO1xuKGZ1bmN0aW9uIChTdHJldGNoKSB7XG4gICAgU3RyZXRjaC5ub25lID0gXCJub25lXCI7XG4gICAgU3RyZXRjaC5hc3BlY3RGaWxsID0gXCJhc3BlY3RGaWxsXCI7XG4gICAgU3RyZXRjaC5hc3BlY3RGaXQgPSBcImFzcGVjdEZpdFwiO1xuICAgIFN0cmV0Y2guZmlsbCA9IFwiZmlsbFwiO1xufSkoU3RyZXRjaCA9IGV4cG9ydHMuU3RyZXRjaCB8fCAoZXhwb3J0cy5TdHJldGNoID0ge30pKTtcbnZhciBWaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChWaXNpYmlsaXR5KSB7XG4gICAgVmlzaWJpbGl0eS52aXNpYmxlID0gXCJ2aXNpYmxlXCI7XG4gICAgVmlzaWJpbGl0eS5jb2xsYXBzZSA9IFwiY29sbGFwc2VcIjtcbiAgICBWaXNpYmlsaXR5LmNvbGxhcHNlZCA9IFwiY29sbGFwc2VkXCI7XG59KShWaXNpYmlsaXR5ID0gZXhwb3J0cy5WaXNpYmlsaXR5IHx8IChleHBvcnRzLlZpc2liaWxpdHkgPSB7fSkpO1xudmFyIEZvbnRBdHRyaWJ1dGVzO1xuKGZ1bmN0aW9uIChGb250QXR0cmlidXRlcykge1xuICAgIEZvbnRBdHRyaWJ1dGVzLk5vcm1hbCA9IDA7XG4gICAgRm9udEF0dHJpYnV0ZXMuQm9sZCA9IDE7XG4gICAgRm9udEF0dHJpYnV0ZXMuSXRhbGljID0gMSA8PCAxO1xufSkoRm9udEF0dHJpYnV0ZXMgPSBleHBvcnRzLkZvbnRBdHRyaWJ1dGVzIHx8IChleHBvcnRzLkZvbnRBdHRyaWJ1dGVzID0ge30pKTtcbnZhciBEZXZpY2VUeXBlO1xuKGZ1bmN0aW9uIChEZXZpY2VUeXBlKSB7XG4gICAgRGV2aWNlVHlwZS5QaG9uZSA9IFwiUGhvbmVcIjtcbiAgICBEZXZpY2VUeXBlLlRhYmxldCA9IFwiVGFibGV0XCI7XG59KShEZXZpY2VUeXBlID0gZXhwb3J0cy5EZXZpY2VUeXBlIHx8IChleHBvcnRzLkRldmljZVR5cGUgPSB7fSkpO1xudmFyIFVwZGF0ZVRleHRUcmlnZ2VyO1xuKGZ1bmN0aW9uIChVcGRhdGVUZXh0VHJpZ2dlcikge1xuICAgIFVwZGF0ZVRleHRUcmlnZ2VyLmZvY3VzTG9zdCA9IFwiZm9jdXNMb3N0XCI7XG4gICAgVXBkYXRlVGV4dFRyaWdnZXIudGV4dENoYW5nZWQgPSBcInRleHRDaGFuZ2VkXCI7XG59KShVcGRhdGVUZXh0VHJpZ2dlciA9IGV4cG9ydHMuVXBkYXRlVGV4dFRyaWdnZXIgfHwgKGV4cG9ydHMuVXBkYXRlVGV4dFRyaWdnZXIgPSB7fSkpO1xudmFyIEFjY3VyYWN5O1xuKGZ1bmN0aW9uIChBY2N1cmFjeSkge1xuICAgIEFjY3VyYWN5LmFueSA9IDMwMDtcbiAgICBBY2N1cmFjeS5oaWdoID0gMztcbn0pKEFjY3VyYWN5ID0gZXhwb3J0cy5BY2N1cmFjeSB8fCAoZXhwb3J0cy5BY2N1cmFjeSA9IHt9KSk7XG52YXIgRG9jaztcbihmdW5jdGlvbiAoRG9jaykge1xuICAgIERvY2subGVmdCA9IFwibGVmdFwiO1xuICAgIERvY2sudG9wID0gXCJ0b3BcIjtcbiAgICBEb2NrLnJpZ2h0ID0gXCJyaWdodFwiO1xuICAgIERvY2suYm90dG9tID0gXCJib3R0b21cIjtcbn0pKERvY2sgPSBleHBvcnRzLkRvY2sgfHwgKGV4cG9ydHMuRG9jayA9IHt9KSk7XG52YXIgQXV0b2NhcGl0YWxpemF0aW9uVHlwZTtcbihmdW5jdGlvbiAoQXV0b2NhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUubm9uZSA9IFwibm9uZVwiO1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUud29yZHMgPSBcIndvcmRzXCI7XG4gICAgQXV0b2NhcGl0YWxpemF0aW9uVHlwZS5zZW50ZW5jZXMgPSBcInNlbnRlbmNlc1wiO1xuICAgIEF1dG9jYXBpdGFsaXphdGlvblR5cGUuYWxsQ2hhcmFjdGVycyA9IFwiYWxsY2hhcmFjdGVyc1wiO1xufSkoQXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IGV4cG9ydHMuQXV0b2NhcGl0YWxpemF0aW9uVHlwZSB8fCAoZXhwb3J0cy5BdXRvY2FwaXRhbGl6YXRpb25UeXBlID0ge30pKTtcbnZhciBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoTmF2aWdhdGlvbkJhclZpc2liaWxpdHkpIHtcbiAgICBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eS5hdXRvID0gXCJhdXRvXCI7XG4gICAgTmF2aWdhdGlvbkJhclZpc2liaWxpdHkubmV2ZXIgPSBcIm5ldmVyXCI7XG4gICAgTmF2aWdhdGlvbkJhclZpc2liaWxpdHkuYWx3YXlzID0gXCJhbHdheXNcIjtcbn0pKE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5ID0gZXhwb3J0cy5OYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSB8fCAoZXhwb3J0cy5OYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSA9IHt9KSk7XG52YXIgQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkpIHtcbiAgICBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkuYXV0byA9IFwiYXV0b1wiO1xuICAgIEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eS5uZXZlciA9IFwibmV2ZXJcIjtcbiAgICBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkuYWx3YXlzID0gXCJhbHdheXNcIjtcbn0pKEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSA9IGV4cG9ydHMuQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5IHx8IChleHBvcnRzLkFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSA9IHt9KSk7XG52YXIgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbjtcbihmdW5jdGlvbiAoQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbikge1xuICAgIEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24uYWN0aW9uQmFyID0gXCJhY3Rpb25CYXJcIjtcbiAgICBBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uLmFjdGlvbkJhcklmUm9vbSA9IFwiYWN0aW9uQmFySWZSb29tXCI7XG4gICAgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbi5wb3B1cCA9IFwicG9wdXBcIjtcbn0pKEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24gPSBleHBvcnRzLkFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24gfHwgKGV4cG9ydHMuQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbiA9IHt9KSk7XG52YXIgSU9TQWN0aW9uSXRlbVBvc2l0aW9uO1xuKGZ1bmN0aW9uIChJT1NBY3Rpb25JdGVtUG9zaXRpb24pIHtcbiAgICBJT1NBY3Rpb25JdGVtUG9zaXRpb24ubGVmdCA9IFwibGVmdFwiO1xuICAgIElPU0FjdGlvbkl0ZW1Qb3NpdGlvbi5yaWdodCA9IFwicmlnaHRcIjtcbn0pKElPU0FjdGlvbkl0ZW1Qb3NpdGlvbiA9IGV4cG9ydHMuSU9TQWN0aW9uSXRlbVBvc2l0aW9uIHx8IChleHBvcnRzLklPU0FjdGlvbkl0ZW1Qb3NpdGlvbiA9IHt9KSk7XG52YXIgSW1hZ2VGb3JtYXQ7XG4oZnVuY3Rpb24gKEltYWdlRm9ybWF0KSB7XG4gICAgSW1hZ2VGb3JtYXQucG5nID0gXCJwbmdcIjtcbiAgICBJbWFnZUZvcm1hdC5qcGVnID0gXCJqcGVnXCI7XG4gICAgSW1hZ2VGb3JtYXQuanBnID0gXCJqcGdcIjtcbn0pKEltYWdlRm9ybWF0ID0gZXhwb3J0cy5JbWFnZUZvcm1hdCB8fCAoZXhwb3J0cy5JbWFnZUZvcm1hdCA9IHt9KSk7XG52YXIgRm9udFN0eWxlO1xuKGZ1bmN0aW9uIChGb250U3R5bGUpIHtcbiAgICBGb250U3R5bGUubm9ybWFsID0gXCJub3JtYWxcIjtcbiAgICBGb250U3R5bGUuaXRhbGljID0gXCJpdGFsaWNcIjtcbn0pKEZvbnRTdHlsZSA9IGV4cG9ydHMuRm9udFN0eWxlIHx8IChleHBvcnRzLkZvbnRTdHlsZSA9IHt9KSk7XG52YXIgRm9udFdlaWdodDtcbihmdW5jdGlvbiAoRm9udFdlaWdodCkge1xuICAgIEZvbnRXZWlnaHQudGhpbiA9IFwiMTAwXCI7XG4gICAgRm9udFdlaWdodC5leHRyYUxpZ2h0ID0gXCIyMDBcIjtcbiAgICBGb250V2VpZ2h0LmxpZ2h0ID0gXCIzMDBcIjtcbiAgICBGb250V2VpZ2h0Lm5vcm1hbCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFdlaWdodC5tZWRpdW0gPSBcIjUwMFwiO1xuICAgIEZvbnRXZWlnaHQuc2VtaUJvbGQgPSBcIjYwMFwiO1xuICAgIEZvbnRXZWlnaHQuYm9sZCA9IFwiYm9sZFwiO1xuICAgIEZvbnRXZWlnaHQuZXh0cmFCb2xkID0gXCI4MDBcIjtcbiAgICBGb250V2VpZ2h0LmJsYWNrID0gXCI5MDBcIjtcbn0pKEZvbnRXZWlnaHQgPSBleHBvcnRzLkZvbnRXZWlnaHQgfHwgKGV4cG9ydHMuRm9udFdlaWdodCA9IHt9KSk7XG52YXIgQmFja2dyb3VuZFJlcGVhdDtcbihmdW5jdGlvbiAoQmFja2dyb3VuZFJlcGVhdCkge1xuICAgIEJhY2tncm91bmRSZXBlYXQucmVwZWF0ID0gXCJyZXBlYXRcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnJlcGVhdFggPSBcInJlcGVhdC14XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5yZXBlYXRZID0gXCJyZXBlYXQteVwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQubm9SZXBlYXQgPSBcIm5vLXJlcGVhdFwiO1xufSkoQmFja2dyb3VuZFJlcGVhdCA9IGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCB8fCAoZXhwb3J0cy5CYWNrZ3JvdW5kUmVwZWF0ID0ge30pKTtcbnZhciBhbmltYXRpb247XG52YXIgQW5pbWF0aW9uQ3VydmU7XG4oZnVuY3Rpb24gKEFuaW1hdGlvbkN1cnZlKSB7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZSA9IFwiZWFzZVwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2VJbiA9IFwiZWFzZUluXCI7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZU91dCA9IFwiZWFzZU91dFwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLmVhc2VJbk91dCA9IFwiZWFzZUluT3V0XCI7XG4gICAgQW5pbWF0aW9uQ3VydmUubGluZWFyID0gXCJsaW5lYXJcIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5zcHJpbmcgPSBcInNwcmluZ1wiO1xuICAgIGZ1bmN0aW9uIGN1YmljQmV6aWVyKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgIGFuaW1hdGlvbiA9IGFuaW1hdGlvbiB8fCByZXF1aXJlKFwidWkvYW5pbWF0aW9uXCIpO1xuICAgICAgICByZXR1cm4gbmV3IGFuaW1hdGlvbi5DdWJpY0JlemllckFuaW1hdGlvbkN1cnZlKHgxLCB5MSwgeDIsIHkyKTtcbiAgICB9XG4gICAgQW5pbWF0aW9uQ3VydmUuY3ViaWNCZXppZXIgPSBjdWJpY0Jlemllcjtcbn0pKEFuaW1hdGlvbkN1cnZlID0gZXhwb3J0cy5BbmltYXRpb25DdXJ2ZSB8fCAoZXhwb3J0cy5BbmltYXRpb25DdXJ2ZSA9IHt9KSk7XG52YXIgU3RhdHVzQmFyU3R5bGU7XG4oZnVuY3Rpb24gKFN0YXR1c0JhclN0eWxlKSB7XG4gICAgU3RhdHVzQmFyU3R5bGUubGlnaHQgPSBcImxpZ2h0XCI7XG4gICAgU3RhdHVzQmFyU3R5bGUuZGFyayA9IFwiZGFya1wiO1xufSkoU3RhdHVzQmFyU3R5bGUgPSBleHBvcnRzLlN0YXR1c0JhclN0eWxlIHx8IChleHBvcnRzLlN0YXR1c0JhclN0eWxlID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVudW1zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzbGlkZV90cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vdHJhbnNpdGlvbi9zbGlkZS10cmFuc2l0aW9uXCIpO1xudmFyIGZhZGVfdHJhbnNpdGlvbl8xID0gcmVxdWlyZShcIi4uL3RyYW5zaXRpb24vZmFkZS10cmFuc2l0aW9uXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgVUlWaWV3Q29udHJvbGxlckFuaW1hdGVkVHJhbnNpdGlvbmluZ01ldGhvZHM7XG4oZnVuY3Rpb24gKFVJVmlld0NvbnRyb2xsZXJBbmltYXRlZFRyYW5zaXRpb25pbmdNZXRob2RzKSB7XG4gICAgdmFyIG1ldGhvZFNpZ25hdHVyZSA9IE5TTWV0aG9kU2lnbmF0dXJlLnNpZ25hdHVyZVdpdGhPYmpDVHlwZXMoXCJ2QDpjXCIpO1xuICAgIHZhciBpbnZvY2F0aW9uID0gTlNJbnZvY2F0aW9uLmludm9jYXRpb25XaXRoTWV0aG9kU2lnbmF0dXJlKG1ldGhvZFNpZ25hdHVyZSk7XG4gICAgaW52b2NhdGlvbi5zZWxlY3RvciA9IFwiY29tcGxldGVUcmFuc2l0aW9uOlwiO1xuICAgIGZ1bmN0aW9uIGNvbXBsZXRlVHJhbnNpdGlvbihkaWRDb21wbGV0ZSkge1xuICAgICAgICB2YXIgZGlkQ29tcGxldGVSZWZlcmVuY2UgPSBuZXcgaW50ZXJvcC5SZWZlcmVuY2UoaW50ZXJvcC50eXBlcy5ib29sLCBkaWRDb21wbGV0ZSk7XG4gICAgICAgIGludm9jYXRpb24uc2V0QXJndW1lbnRBdEluZGV4KGRpZENvbXBsZXRlUmVmZXJlbmNlLCAyKTtcbiAgICAgICAgaW52b2NhdGlvbi5pbnZva2VXaXRoVGFyZ2V0KHRoaXMpO1xuICAgIH1cbiAgICBVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nTWV0aG9kcy5jb21wbGV0ZVRyYW5zaXRpb24gPSBjb21wbGV0ZVRyYW5zaXRpb247XG59KShVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nTWV0aG9kcyB8fCAoVUlWaWV3Q29udHJvbGxlckFuaW1hdGVkVHJhbnNpdGlvbmluZ01ldGhvZHMgPSB7fSkpO1xudmFyIEFuaW1hdGVkVHJhbnNpdGlvbmluZyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFuaW1hdGVkVHJhbnNpdGlvbmluZywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmltYXRlZFRyYW5zaXRpb25pbmcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQW5pbWF0ZWRUcmFuc2l0aW9uaW5nLmluaXQgPSBmdW5jdGlvbiAodHJhbnNpdGlvbiwgb3BlcmF0aW9uLCBmcm9tVkMsIHRvVkMpIHtcbiAgICAgICAgdmFyIGltcGwgPSBBbmltYXRlZFRyYW5zaXRpb25pbmcubmV3KCk7XG4gICAgICAgIGltcGwuX3RyYW5zaXRpb24gPSB0cmFuc2l0aW9uO1xuICAgICAgICBpbXBsLl9vcGVyYXRpb24gPSBvcGVyYXRpb247XG4gICAgICAgIGltcGwuX2Zyb21WQyA9IGZyb21WQztcbiAgICAgICAgaW1wbC5fdG9WQyA9IHRvVkM7XG4gICAgICAgIHJldHVybiBpbXBsO1xuICAgIH07XG4gICAgQW5pbWF0ZWRUcmFuc2l0aW9uaW5nLnByb3RvdHlwZS5hbmltYXRlVHJhbnNpdGlvbiA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uQ29udGV4dCkge1xuICAgICAgICB2YXIgY29udGFpbmVyVmlldyA9IHRyYW5zaXRpb25Db250ZXh0LnZhbHVlRm9yS2V5KFwiY29udGFpbmVyVmlld1wiKTtcbiAgICAgICAgdmFyIGNvbXBsZXRpb24gPSBVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nTWV0aG9kcy5jb21wbGV0ZVRyYW5zaXRpb24uYmluZCh0cmFuc2l0aW9uQ29udGV4dCk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fb3BlcmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvblR5cGUgPSBcInB1c2hcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uVHlwZSA9IFwicG9wXCI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNpdGlvblR5cGUgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIlNUQVJUIFwiICsgdGhpcy5fdHJhbnNpdGlvbiArIFwiIFwiICsgdGhpcy5fdHJhbnNpdGlvblR5cGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90cmFuc2l0aW9uLmFuaW1hdGVJT1NUcmFuc2l0aW9uKGNvbnRhaW5lclZpZXcsIHRoaXMuX2Zyb21WQy52aWV3LCB0aGlzLl90b1ZDLnZpZXcsIHRoaXMuX29wZXJhdGlvbiwgY29tcGxldGlvbik7XG4gICAgfTtcbiAgICBBbmltYXRlZFRyYW5zaXRpb25pbmcucHJvdG90eXBlLnRyYW5zaXRpb25EdXJhdGlvbiA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uQ29udGV4dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNpdGlvbi5nZXREdXJhdGlvbigpO1xuICAgIH07XG4gICAgQW5pbWF0ZWRUcmFuc2l0aW9uaW5nLnByb3RvdHlwZS5hbmltYXRpb25FbmRlZCA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgIGlmICh0cmFuc2l0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJFTkQgXCIgKyB0aGlzLl90cmFuc2l0aW9uICsgXCIgXCIgKyB0aGlzLl90cmFuc2l0aW9uVHlwZSwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ0FOQ0VMIFwiICsgdGhpcy5fdHJhbnNpdGlvbiArIFwiIFwiICsgdGhpcy5fdHJhbnNpdGlvblR5cGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5pbWF0ZWRUcmFuc2l0aW9uaW5nLk9iakNQcm90b2NvbHMgPSBbVUlWaWV3Q29udHJvbGxlckFuaW1hdGVkVHJhbnNpdGlvbmluZ107XG4gICAgcmV0dXJuIEFuaW1hdGVkVHJhbnNpdGlvbmluZztcbn0oTlNPYmplY3QpKTtcbmZ1bmN0aW9uIF9jcmVhdGVJT1NBbmltYXRlZFRyYW5zaXRpb25pbmcobmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZUN1cnZlLCBvcGVyYXRpb24sIGZyb21WQywgdG9WQykge1xuICAgIHZhciBpbnN0YW5jZSA9IG5hdmlnYXRpb25UcmFuc2l0aW9uLmluc3RhbmNlO1xuICAgIHZhciB0cmFuc2l0aW9uO1xuICAgIGlmIChpbnN0YW5jZSkge1xuICAgICAgICB0cmFuc2l0aW9uID0gaW5zdGFuY2U7XG4gICAgfVxuICAgIGVsc2UgaWYgKG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUpIHtcbiAgICAgICAgdmFyIG5hbWVfMSA9IG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKG5hbWVfMS5pbmRleE9mKFwic2xpZGVcIikgPT09IDApIHtcbiAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSBuYW1lXzEuc3Vic3RyKFwic2xpZGVcIi5sZW5ndGgpIHx8IFwibGVmdFwiO1xuICAgICAgICAgICAgdHJhbnNpdGlvbiA9IG5ldyBzbGlkZV90cmFuc2l0aW9uXzEuU2xpZGVUcmFuc2l0aW9uKGRpcmVjdGlvbiwgbmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24sIG5hdGl2ZUN1cnZlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYW1lXzEgPT09IFwiZmFkZVwiKSB7XG4gICAgICAgICAgICB0cmFuc2l0aW9uID0gbmV3IGZhZGVfdHJhbnNpdGlvbl8xLkZhZGVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLmR1cmF0aW9uLCBuYXRpdmVDdXJ2ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRyYW5zaXRpb24gPyBBbmltYXRlZFRyYW5zaXRpb25pbmcuaW5pdCh0cmFuc2l0aW9uLCBvcGVyYXRpb24sIGZyb21WQywgdG9WQykgOiB1bmRlZmluZWQ7XG59XG5leHBvcnRzLl9jcmVhdGVJT1NBbmltYXRlZFRyYW5zaXRpb25pbmcgPSBfY3JlYXRlSU9TQW5pbWF0ZWRUcmFuc2l0aW9uaW5nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhZ21lbnQudHJhbnNpdGlvbnMuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXcvdmlldy1jb21tb25cIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlclwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIgZnJhbWVfc3RhY2tfMSA9IHJlcXVpcmUoXCIuL2ZyYW1lLXN0YWNrXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTmF2aWdhdGlvblR5cGU7XG4oZnVuY3Rpb24gKE5hdmlnYXRpb25UeXBlKSB7XG4gICAgTmF2aWdhdGlvblR5cGVbTmF2aWdhdGlvblR5cGVbXCJiYWNrXCJdID0gMF0gPSBcImJhY2tcIjtcbiAgICBOYXZpZ2F0aW9uVHlwZVtOYXZpZ2F0aW9uVHlwZVtcImZvcndhcmRcIl0gPSAxXSA9IFwiZm9yd2FyZFwiO1xuICAgIE5hdmlnYXRpb25UeXBlW05hdmlnYXRpb25UeXBlW1wicmVwbGFjZVwiXSA9IDJdID0gXCJyZXBsYWNlXCI7XG59KShOYXZpZ2F0aW9uVHlwZSA9IGV4cG9ydHMuTmF2aWdhdGlvblR5cGUgfHwgKGV4cG9ydHMuTmF2aWdhdGlvblR5cGUgPSB7fSkpO1xuZnVuY3Rpb24gYnVpbGRFbnRyeUZyb21BcmdzKGFyZykge1xuICAgIHZhciBlbnRyeTtcbiAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlbnRyeSA9IHtcbiAgICAgICAgICAgIG1vZHVsZU5hbWU6IGFyZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgZW50cnkgPSB7XG4gICAgICAgICAgICBjcmVhdGU6IGFyZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZW50cnkgPSBhcmc7XG4gICAgfVxuICAgIHJldHVybiBlbnRyeTtcbn1cbnZhciBGcmFtZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGcmFtZUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRnJhbWVCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2JhY2tTdGFjayA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5fbmF2aWdhdGlvblF1ZXVlID0gbmV3IEFycmF5KCk7XG4gICAgICAgIF90aGlzLl9pc0luRnJhbWVTdGFjayA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZyYW1lQmFzZV8xID0gRnJhbWVCYXNlO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRnJhbWUgc2hvdWxkIG5vdCBoYXZlIGEgdmlldy4gVXNlICdkZWZhdWx0UGFnZScgcHJvcGVydHkgaW5zdGVhZC5cIik7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmNhbkdvQmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGJhY2tzdGFjayA9IHRoaXMuX2JhY2tTdGFjay5sZW5ndGg7XG4gICAgICAgIHZhciBwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjayA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgdmFyIGVudHJ5ID0gaXRlbS5lbnRyeTtcbiAgICAgICAgICAgIHZhciBpc0JhY2tOYXZpZ2F0aW9uID0gaXRlbS5uYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgICAgIGlmIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tzdGFjay0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhY2tzdGFja0luZGV4ID0gX3RoaXMuX2JhY2tTdGFjay5pbmRleE9mKGVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJhY2tzdGFja0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja3N0YWNrID0gYmFja3N0YWNrSW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVudHJ5LmVudHJ5LmNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYmFja3N0YWNrID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJhY2tzdGFjaysrO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjaykge1xuICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBlbnRyeS5lbnRyeS5iYWNrc3RhY2tWaXNpYmxlID09PSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID4gMCAmJiAhdGhpcy5fY3VycmVudEVudHJ5KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2stLTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYmFja3N0YWNrID4gMDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuZ29CYWNrID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiR08gQkFDS1wiLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5jYW5Hb0JhY2soKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICAgICAgdmFyIGluZGV4XzEgPSB0aGlzLl9iYWNrU3RhY2suaW5kZXhPZihiYWNrc3RhY2tFbnRyeSk7XG4gICAgICAgICAgICBpZiAoaW5kZXhfMSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0ge1xuICAgICAgICAgICAgZW50cnk6IGJhY2tzdGFja0VudHJ5LFxuICAgICAgICAgICAgaXNCYWNrTmF2aWdhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5iYWNrXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3JlbW92ZUVudHJ5ID0gZnVuY3Rpb24gKHJlbW92ZWQpIHtcbiAgICAgICAgdmFyIHBhZ2UgPSByZW1vdmVkLnJlc29sdmVkUGFnZTtcbiAgICAgICAgdmFyIGZyYW1lID0gcGFnZS5mcmFtZTtcbiAgICAgICAgcGFnZS5fZnJhbWUgPSBudWxsO1xuICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICAgIGZyYW1lLl9yZW1vdmVWaWV3KHBhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFnZS5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICByZW1vdmVkLnJlc29sdmVkUGFnZSA9IG51bGw7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLm5hdmlnYXRlID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiTkFWSUdBVEVcIiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW50cnkgPSBidWlsZEVudHJ5RnJvbUFyZ3MocGFyYW0pO1xuICAgICAgICB2YXIgcGFnZSA9IGJ1aWxkZXJfMS5jcmVhdGVWaWV3RnJvbUVudHJ5KGVudHJ5KTtcbiAgICAgICAgdGhpcy5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSB7XG4gICAgICAgICAgICBlbnRyeTogZW50cnksXG4gICAgICAgICAgICByZXNvbHZlZFBhZ2U6IHBhZ2UsXG4gICAgICAgICAgICBuYXZEZXB0aDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgZnJhZ21lbnRUYWc6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB7XG4gICAgICAgICAgICBlbnRyeTogYmFja3N0YWNrRW50cnksXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5mb3J3YXJkXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuaXNDdXJyZW50ID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkgPT09IGVudHJ5O1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5zZXRDdXJyZW50ID0gZnVuY3Rpb24gKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSkge1xuICAgICAgICB2YXIgbmV3UGFnZSA9IGVudHJ5LnJlc29sdmVkUGFnZTtcbiAgICAgICAgaWYgKCFuZXdQYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KG5ld1BhZ2UpO1xuICAgICAgICAgICAgbmV3UGFnZS5fZnJhbWUgPSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N1cnJlbnRFbnRyeSA9IGVudHJ5O1xuICAgICAgICB2YXIgaXNCYWNrID0gbmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgIGlmIChpc0JhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX3B1c2hJbkZyYW1lU3RhY2soKTtcbiAgICAgICAgfVxuICAgICAgICBuZXdQYWdlLm9uTmF2aWdhdGVkVG8oaXNCYWNrKTtcbiAgICAgICAgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA9IG51bGw7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl91cGRhdGVCYWNrc3RhY2sgPSBmdW5jdGlvbiAoZW50cnksIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpc0JhY2sgPSBuYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgdmFyIGlzUmVwbGFjZSA9IG5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5yZXBsYWNlO1xuICAgICAgICB0aGlzLnJhaXNlQ3VycmVudFBhZ2VOYXZpZ2F0ZWRFdmVudHMoaXNCYWNrKTtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLl9jdXJyZW50RW50cnk7XG4gICAgICAgIGlmIChpc0JhY2spIHtcbiAgICAgICAgICAgIHZhciBpbmRleF8yID0gdGhpcy5fYmFja1N0YWNrLmluZGV4T2YoZW50cnkpO1xuICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLnNwbGljZShpbmRleF8yICsgMSkuZm9yRWFjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZUVudHJ5KGUpOyB9KTtcbiAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICBpZiAoZW50cnkuZW50cnkuY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLmZvckVhY2goZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVFbnRyeShlKTsgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChGcmFtZUJhc2VfMS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUoY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2sucHVzaChjdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCAmJiB0aGlzLl9iYWNrU3RhY2suaW5kZXhPZihjdXJyZW50KSA8IDApIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbW92ZUVudHJ5KGN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmlzTmVzdGVkV2l0aGluID0gZnVuY3Rpb24gKHBhcmVudEZyYW1lQ2FuZGlkYXRlKSB7XG4gICAgICAgIHZhciBmcmFtZUFuY2VzdG9yID0gdGhpcztcbiAgICAgICAgd2hpbGUgKGZyYW1lQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIGZyYW1lQW5jZXN0b3IgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKGZyYW1lQW5jZXN0b3IsIEZyYW1lQmFzZV8xKTtcbiAgICAgICAgICAgIGlmIChmcmFtZUFuY2VzdG9yID09PSBwYXJlbnRGcmFtZUNhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucmFpc2VDdXJyZW50UGFnZU5hdmlnYXRlZEV2ZW50cyA9IGZ1bmN0aW9uIChpc0JhY2spIHtcbiAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICBpZiAocGFnZSkge1xuICAgICAgICAgICAgaWYgKHBhZ2UuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBwYWdlLmNhbGxVbmxvYWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFnZS5vbk5hdmlnYXRlZEZyb20oaXNCYWNrKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHJvY2Vzc05hdmlnYXRpb25RdWV1ZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgIGlmICh0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy5fbmF2aWdhdGlvblF1ZXVlWzBdLmVudHJ5O1xuICAgICAgICB2YXIgY3VycmVudE5hdmlnYXRpb25QYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICBpZiAocGFnZSAhPT0gY3VycmVudE5hdmlnYXRpb25QYWdlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOZXh0TmF2aWdhdGlvbkVudHJ5KCk7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUFjdGlvbkJhcigpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZmluZEVudHJ5Rm9yVGFnID0gZnVuY3Rpb24gKGZyYWdtZW50VGFnKSB7XG4gICAgICAgIHZhciBlbnRyeTtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSAmJiB0aGlzLl9jdXJyZW50RW50cnkuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnKSB7XG4gICAgICAgICAgICBlbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVudHJ5ID0gdGhpcy5fYmFja1N0YWNrLmZpbmQoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZS5mcmFnbWVudFRhZyA9PT0gZnJhZ21lbnRUYWc7IH0pO1xuICAgICAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uSXRlbSA9IHRoaXMuX25hdmlnYXRpb25RdWV1ZS5maW5kKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUuZW50cnkuZnJhZ21lbnRUYWcgPT09IGZyYWdtZW50VGFnOyB9KTtcbiAgICAgICAgICAgICAgICBlbnRyeSA9IG5hdmlnYXRpb25JdGVtID8gbmF2aWdhdGlvbkl0ZW0uZW50cnkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5uYXZpZ2F0aW9uUXVldWVJc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbmF2aWdhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUgPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgaWYgKCFlbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrc3RhY2tWaXNpYmxlVmFsdWUgPSBlbnRyeS5lbnRyeS5iYWNrc3RhY2tWaXNpYmxlO1xuICAgICAgICB2YXIgYmFja3N0YWNrSGlkZGVuID0gYmFja3N0YWNrVmlzaWJsZVZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWJhY2tzdGFja1Zpc2libGVWYWx1ZTtcbiAgICAgICAgcmV0dXJuICFiYWNrc3RhY2tIaWRkZW47XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl91cGRhdGVBY3Rpb25CYXIgPSBmdW5jdGlvbiAocGFnZSwgZGlzYWJsZU5hdkJhckFuaW1hdGlvbikge1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCB8fCB0aGlzLl9leGVjdXRpbmdDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB0aGlzLl9uYXZpZ2F0aW9uUXVldWVbMF07XG4gICAgICAgICAgICB2YXIgaXNCYWNrTmF2aWdhdGlvbiA9IG5hdmlnYXRpb25Db250ZXh0Lm5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICAgICAgaWYgKGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1Hb0JhY2sobmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wZXJmb3JtTmF2aWdhdGlvbihuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucGVyZm9ybU5hdmlnYXRpb24gPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA9IG5hdmlnYXRpb25Db250ZXh0O1xuICAgICAgICB2YXIgYmFja3N0YWNrRW50cnkgPSBuYXZpZ2F0aW9uQ29udGV4dC5lbnRyeTtcbiAgICAgICAgdmFyIGlzQmFja05hdmlnYXRpb24gPSBuYXZpZ2F0aW9uQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgdGhpcy5fb25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnksIGlzQmFja05hdmlnYXRpb24pO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0ZUNvcmUoYmFja3N0YWNrRW50cnkpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5wZXJmb3JtR29CYWNrID0gZnVuY3Rpb24gKG5hdmlnYXRpb25Db250ZXh0KSB7XG4gICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IG5hdmlnYXRpb25Db250ZXh0LmVudHJ5O1xuICAgICAgICB2YXIgYmFja3N0YWNrID0gdGhpcy5fYmFja1N0YWNrO1xuICAgICAgICBpZiAoIWJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgICAgICBiYWNrc3RhY2tFbnRyeSA9IGJhY2tzdGFja1tiYWNrc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBuYXZpZ2F0aW9uQ29udGV4dC5lbnRyeSA9IGJhY2tzdGFja0VudHJ5O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgPSBuYXZpZ2F0aW9uQ29udGV4dDtcbiAgICAgICAgdGhpcy5fb25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnksIHRydWUpO1xuICAgICAgICB0aGlzLl9nb0JhY2tDb3JlKGJhY2tzdGFja0VudHJ5KTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dvQmFja0NvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJHTyBCQUNLIENPUkUoXCIgKyB0aGlzLl9iYWNrc3RhY2tFbnRyeVRyYWNlKGJhY2tzdGFja0VudHJ5KSArIFwiKTsgY3VycmVudFBhZ2U6IFwiICsgdGhpcy5jdXJyZW50UGFnZSwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fbmF2aWdhdGVDb3JlID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiTkFWSUdBVEUgQ09SRShcIiArIHRoaXMuX2JhY2tzdGFja0VudHJ5VHJhY2UoYmFja3N0YWNrRW50cnkpICsgXCIpOyBjdXJyZW50UGFnZTogXCIgKyB0aGlzLmN1cnJlbnRQYWdlLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9vbk5hdmlnYXRpbmdUbyA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSwgaXNCYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlLm9uTmF2aWdhdGluZ0Zyb20oaXNCYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBiYWNrc3RhY2tFbnRyeS5yZXNvbHZlZFBhZ2Uub25OYXZpZ2F0aW5nVG8oYmFja3N0YWNrRW50cnkuZW50cnkuY29udGV4dCwgaXNCYWNrLCBiYWNrc3RhY2tFbnRyeS5lbnRyeS5iaW5kaW5nQ29udGV4dCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJhbmltYXRlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuaW1hdGVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fYW5pbWF0ZWQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwidHJhbnNpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImJhY2tTdGFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhY2tTdGFjay5zbGljZSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJjdXJyZW50UGFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImN1cnJlbnRFbnRyeVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50RW50cnkuZW50cnk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB2YXIgZnJhbWVzVG9QdXNoID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZnJhbWVTdGFja18xID0gZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrOyBfaSA8IGZyYW1lU3RhY2tfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGZyYW1lU3RhY2tfMVtfaV07XG4gICAgICAgICAgICBpZiAoZnJhbWUuaXNOZXN0ZWRXaXRoaW4odGhpcykpIHtcbiAgICAgICAgICAgICAgICBmcmFtZXNUb1B1c2gucHVzaChmcmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBmcmFtZXNUb1B1c2hfMSA9IGZyYW1lc1RvUHVzaDsgX2EgPCBmcmFtZXNUb1B1c2hfMS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IGZyYW1lc1RvUHVzaF8xW19hXTtcbiAgICAgICAgICAgIGZyYW1lLl9wdXNoSW5GcmFtZVN0YWNrKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3B1c2hJbkZyYW1lU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZyYW1lX3N0YWNrXzEuX3B1c2hJbkZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wb3BGcm9tRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVfc3RhY2tfMS5fcG9wRnJvbUZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9yZW1vdmVGcm9tRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVfc3RhY2tfMS5fcmVtb3ZlRnJvbUZyYW1lU3RhY2sodGhpcyk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9kaWFsb2dDbG9zZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZUZyb21GcmFtZVN0YWNrKCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9yZW1vdmVGcm9tRnJhbWVTdGFjaygpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKHBhZ2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHBhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9nZXRJc0FuaW1hdGVkTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICBpZiAoZW50cnkgJiYgZW50cnkuYW5pbWF0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5LmFuaW1hdGVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFuaW1hdGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBGcmFtZUJhc2VfMS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZ2V0TmF2aWdhdGlvblRyYW5zaXRpb24gPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICBpZiAodmlld18xLmlzSU9TICYmIGVudHJ5LnRyYW5zaXRpb25pT1MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS50cmFuc2l0aW9uaU9TO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZpZXdfMS5pc0FuZHJvaWQgJiYgZW50cnkudHJhbnNpdGlvbkFuZHJvaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS50cmFuc2l0aW9uQW5kcm9pZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbnRyeS50cmFuc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZW50cnkudHJhbnNpdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy50cmFuc2l0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRyYW5zaXRpb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEZyYW1lQmFzZV8xLmRlZmF1bHRUcmFuc2l0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwibmF2aWdhdGlvbkJhckhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dldE5hdkJhclZpc2libGUgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgY2hpbGQuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3ByaW50RnJhbWVCYWNrU3RhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmJhY2tTdGFjay5sZW5ndGg7XG4gICAgICAgIHZhciBpID0gbGVuZ3RoIC0gMTtcbiAgICAgICAgY29uc29sZS5sb2coXCJGcmFtZSBCYWNrIFN0YWNrOiBcIik7XG4gICAgICAgIHdoaWxlIChpID49IDApIHtcbiAgICAgICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IHRoaXMuYmFja1N0YWNrW2ktLV07XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlxcdFwiICsgYmFja3N0YWNrRW50cnkucmVzb2x2ZWRQYWdlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fYmFja3N0YWNrRW50cnlUcmFjZSA9IGZ1bmN0aW9uIChiKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiICsgYi5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIHZhciBiYWNrc3RhY2tWaXNpYmxlID0gRnJhbWVCYXNlXzEuX2lzRW50cnlCYWNrc3RhY2tWaXNpYmxlKGIpO1xuICAgICAgICBpZiAoIWJhY2tzdGFja1Zpc2libGUpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIiB8IElOVklTSUJMRVwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiLmVudHJ5LmNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgQ0xFQVIgSElTVE9SWVwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRlZCA9IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKGIuZW50cnkpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCIgfCBOT1QgQU5JTUFURURcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdCA9IHRoaXMuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uKGIuZW50cnkpO1xuICAgICAgICBpZiAodCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgVHJhbnNpdGlvbltcIiArIEpTT04uc3RyaW5naWZ5KHQpICsgXCJdXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX29uTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAoX3N1cGVyLnByb3RvdHlwZS5fb25MaXZlc3luYy5jYWxsKHRoaXMsIGNvbnRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxlZ2FjeUxpdmVzeW5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAoX3N1cGVyLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMuY2FsbCh0aGlzLCBjb250ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgJiZcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHRoaXMuY3VycmVudFBhZ2UsIGNvbnRleHQsIFtcIm1hcmt1cFwiLCBcInNjcmlwdFwiXSkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKFwiQ2hhbmdlIEhhbmRsZWQ6IFJlcGxhY2luZyBwYWdlIFwiICsgY29udGV4dC5wYXRoLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgICAgIHRoaXMucmVwbGFjZVBhZ2UoY29udGV4dC5wYXRoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUubGVnYWN5TGl2ZXN5bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh2aWV3XzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5fb25MaXZlc3luYygpXCIsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fY3VycmVudEVudHJ5IHx8ICF0aGlzLl9jdXJyZW50RW50cnkuZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3VycmVudEVudHJ5ID0gdGhpcy5fY3VycmVudEVudHJ5LmVudHJ5O1xuICAgICAgICB2YXIgbmV3RW50cnkgPSB7XG4gICAgICAgICAgICBhbmltYXRlZDogZmFsc2UsXG4gICAgICAgICAgICBjbGVhckhpc3Rvcnk6IHRydWUsXG4gICAgICAgICAgICBjb250ZXh0OiBjdXJyZW50RW50cnkuY29udGV4dCxcbiAgICAgICAgICAgIGNyZWF0ZTogY3VycmVudEVudHJ5LmNyZWF0ZSxcbiAgICAgICAgICAgIG1vZHVsZU5hbWU6IGN1cnJlbnRFbnRyeS5tb2R1bGVOYW1lLFxuICAgICAgICAgICAgYmFja3N0YWNrVmlzaWJsZTogY3VycmVudEVudHJ5LmJhY2tzdGFja1Zpc2libGVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG5ld0VudHJ5LmNyZWF0ZSkge1xuICAgICAgICAgICAgdmFyIHBhZ2UgPSBuZXdFbnRyeS5jcmVhdGUoKTtcbiAgICAgICAgICAgIGlmIChwYWdlID09PSB0aGlzLmN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF2aWdhdGUobmV3RW50cnkpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUucmVwbGFjZVBhZ2UgPSBmdW5jdGlvbiAocGFnZVBhdGgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRCYWNrc3RhY2tFbnRyeSA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgdmFyIGNvbnRleHRNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKHBhZ2VQYXRoKTtcbiAgICAgICAgdmFyIG5ld1BhZ2UgPSBidWlsZGVyXzEuY3JlYXRlVmlld0Zyb21FbnRyeSh7IG1vZHVsZU5hbWU6IGNvbnRleHRNb2R1bGVOYW1lIH0pO1xuICAgICAgICB2YXIgbmV3QmFja3N0YWNrRW50cnkgPSB7XG4gICAgICAgICAgICBlbnRyeTogY3VycmVudEJhY2tzdGFja0VudHJ5LmVudHJ5LFxuICAgICAgICAgICAgcmVzb2x2ZWRQYWdlOiBuZXdQYWdlLFxuICAgICAgICAgICAgbmF2RGVwdGg6IGN1cnJlbnRCYWNrc3RhY2tFbnRyeS5uYXZEZXB0aCxcbiAgICAgICAgICAgIGZyYWdtZW50VGFnOiBjdXJyZW50QmFja3N0YWNrRW50cnkuZnJhZ21lbnRUYWcsXG4gICAgICAgICAgICBmcmFtZUlkOiBjdXJyZW50QmFja3N0YWNrRW50cnkuZnJhbWVJZFxuICAgICAgICB9O1xuICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB7XG4gICAgICAgICAgICBlbnRyeTogbmV3QmFja3N0YWNrRW50cnksXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBOYXZpZ2F0aW9uVHlwZS5yZXBsYWNlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5wdXNoKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIHZhciBGcmFtZUJhc2VfMTtcbiAgICBGcmFtZUJhc2UuYW5kcm9pZE9wdGlvblNlbGVjdGVkRXZlbnQgPSBcIm9wdGlvblNlbGVjdGVkXCI7XG4gICAgRnJhbWVCYXNlLmRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb24gPSB0cnVlO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lQmFzZS5wcm90b3R5cGUsIFwicGVyZm9ybU5hdmlnYXRpb25cIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFtZUJhc2UucHJvdG90eXBlLCBcInBlcmZvcm1Hb0JhY2tcIiwgbnVsbCk7XG4gICAgRnJhbWVCYXNlID0gRnJhbWVCYXNlXzEgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJGcmFtZVwiKVxuICAgIF0sIEZyYW1lQmFzZSk7XG4gICAgcmV0dXJuIEZyYW1lQmFzZTtcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuRnJhbWVCYXNlID0gRnJhbWVCYXNlO1xuZnVuY3Rpb24gZ2V0RnJhbWVCeUlkKGlkKSB7XG4gICAgcmV0dXJuIGZyYW1lX3N0YWNrXzEuZnJhbWVTdGFjay5maW5kKGZ1bmN0aW9uIChmcmFtZSkgeyByZXR1cm4gZnJhbWUuaWQgJiYgZnJhbWUuaWQgPT09IGlkOyB9KTtcbn1cbmV4cG9ydHMuZ2V0RnJhbWVCeUlkID0gZ2V0RnJhbWVCeUlkO1xuZnVuY3Rpb24gdG9wbW9zdCgpIHtcbiAgICByZXR1cm4gZnJhbWVfc3RhY2tfMS50b3Btb3N0KCk7XG59XG5leHBvcnRzLnRvcG1vc3QgPSB0b3Btb3N0O1xuZnVuY3Rpb24gZ29CYWNrKCkge1xuICAgIHZhciB0b3AgPSB0b3Btb3N0KCk7XG4gICAgaWYgKHRvcCAmJiB0b3AuY2FuR29CYWNrKCkpIHtcbiAgICAgICAgdG9wLmdvQmFjaygpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodG9wKSB7XG4gICAgICAgIHZhciBwYXJlbnRGcmFtZUNhbkdvQmFjayA9IGZhbHNlO1xuICAgICAgICB2YXIgcGFyZW50RnJhbWUgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKHRvcCwgXCJGcmFtZVwiKTtcbiAgICAgICAgd2hpbGUgKHBhcmVudEZyYW1lICYmICFwYXJlbnRGcmFtZUNhbkdvQmFjaykge1xuICAgICAgICAgICAgaWYgKHBhcmVudEZyYW1lICYmIHBhcmVudEZyYW1lLmNhbkdvQmFjaygpKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RnJhbWVDYW5Hb0JhY2sgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyZW50RnJhbWUgPSB2aWV3X2NvbW1vbl8xLmdldEFuY2VzdG9yKHBhcmVudEZyYW1lLCBcIkZyYW1lXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJlbnRGcmFtZSAmJiBwYXJlbnRGcmFtZUNhbkdvQmFjaykge1xuICAgICAgICAgICAgcGFyZW50RnJhbWUuZ29CYWNrKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdG9wLl9wb3BGcm9tRnJhbWVTdGFjaygpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnRzLmdvQmFjayA9IGdvQmFjaztcbmZ1bmN0aW9uIF9zdGFjaygpIHtcbiAgICByZXR1cm4gZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrO1xufVxuZXhwb3J0cy5fc3RhY2sgPSBfc3RhY2s7XG5leHBvcnRzLmRlZmF1bHRQYWdlID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJkZWZhdWx0UGFnZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChmcmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGZyYW1lLm5hdmlnYXRlKHsgbW9kdWxlTmFtZTogbmV3VmFsdWUgfSk7XG4gICAgfVxufSk7XG5leHBvcnRzLmRlZmF1bHRQYWdlLnJlZ2lzdGVyKEZyYW1lQmFzZSk7XG5leHBvcnRzLmFjdGlvbkJhclZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImFjdGlvbkJhclZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TIH0pO1xuZXhwb3J0cy5hY3Rpb25CYXJWaXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIoRnJhbWVCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYW1lLWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmZyYW1lU3RhY2sgPSBbXTtcbmZ1bmN0aW9uIHRvcG1vc3QoKSB7XG4gICAgaWYgKGV4cG9ydHMuZnJhbWVTdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBleHBvcnRzLmZyYW1lU3RhY2tbZXhwb3J0cy5mcmFtZVN0YWNrLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy50b3Btb3N0ID0gdG9wbW9zdDtcbmZ1bmN0aW9uIF9wdXNoSW5GcmFtZVN0YWNrKGZyYW1lKSB7XG4gICAgaWYgKGZyYW1lLl9pc0luRnJhbWVTdGFjayAmJiBleHBvcnRzLmZyYW1lU3RhY2tbZXhwb3J0cy5mcmFtZVN0YWNrLmxlbmd0aCAtIDFdID09PSBmcmFtZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChmcmFtZS5faXNJbkZyYW1lU3RhY2spIHtcbiAgICAgICAgdmFyIGluZGV4T2ZGcmFtZSA9IGV4cG9ydHMuZnJhbWVTdGFjay5pbmRleE9mKGZyYW1lKTtcbiAgICAgICAgZXhwb3J0cy5mcmFtZVN0YWNrLnNwbGljZShpbmRleE9mRnJhbWUsIDEpO1xuICAgIH1cbiAgICBleHBvcnRzLmZyYW1lU3RhY2sucHVzaChmcmFtZSk7XG4gICAgZnJhbWUuX2lzSW5GcmFtZVN0YWNrID0gdHJ1ZTtcbn1cbmV4cG9ydHMuX3B1c2hJbkZyYW1lU3RhY2sgPSBfcHVzaEluRnJhbWVTdGFjaztcbmZ1bmN0aW9uIF9wb3BGcm9tRnJhbWVTdGFjayhmcmFtZSkge1xuICAgIGlmICghZnJhbWUuX2lzSW5GcmFtZVN0YWNrKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRvcCA9IHRvcG1vc3QoKTtcbiAgICBpZiAodG9wICE9PSBmcmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgcG9wIGEgRnJhbWUgd2hpY2ggaXMgbm90IGF0IHRoZSB0b3Agb2YgdGhlIG5hdmlnYXRpb24gc3RhY2suXCIpO1xuICAgIH1cbiAgICBleHBvcnRzLmZyYW1lU3RhY2sucG9wKCk7XG4gICAgZnJhbWUuX2lzSW5GcmFtZVN0YWNrID0gZmFsc2U7XG59XG5leHBvcnRzLl9wb3BGcm9tRnJhbWVTdGFjayA9IF9wb3BGcm9tRnJhbWVTdGFjaztcbmZ1bmN0aW9uIF9yZW1vdmVGcm9tRnJhbWVTdGFjayhmcmFtZSkge1xuICAgIGlmICghZnJhbWUuX2lzSW5GcmFtZVN0YWNrKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGluZGV4ID0gZXhwb3J0cy5mcmFtZVN0YWNrLmluZGV4T2YoZnJhbWUpO1xuICAgIGV4cG9ydHMuZnJhbWVTdGFjay5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGZyYW1lLl9pc0luRnJhbWVTdGFjayA9IGZhbHNlO1xufVxuZXhwb3J0cy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2sgPSBfcmVtb3ZlRnJvbUZyYW1lU3RhY2s7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFtZS1zdGFjay5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBmcmFtZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZyYW1lLWNvbW1vblwiKTtcbnZhciBmcmFnbWVudF90cmFuc2l0aW9uc18xID0gcmVxdWlyZShcIi4vZnJhZ21lbnQudHJhbnNpdGlvbnNcIik7XG52YXIgdXRpbHMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9mcmFtZS1jb21tb25cIikpO1xudmFyIG1ham9yVmVyc2lvbiA9IHV0aWxzLmlvcy5NYWpvclZlcnNpb247XG52YXIgRU5UUlkgPSBcIl9lbnRyeVwiO1xudmFyIERFTEVHQVRFID0gXCJfZGVsZWdhdGVcIjtcbnZhciBOQVZfREVQVEggPSBcIl9uYXZEZXB0aFwiO1xudmFyIFRSQU5TSVRJT04gPSBcIl90cmFuc2l0aW9uXCI7XG52YXIgTk9OX0FOSU1BVEVEX1RSQU5TSVRJT04gPSBcIm5vbi1hbmltYXRlZFwiO1xudmFyIEhNUl9SRVBMQUNFX1RSQU5TSVRJT04gPSBcImZhZGVcIjtcbnZhciBuYXZEZXB0aCA9IC0xO1xudmFyIEZyYW1lID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRnJhbWUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRnJhbWUoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9hbmltYXRlZERlbGVnYXRlID0gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGUubmV3KCk7XG4gICAgICAgIF90aGlzLl9pb3MgPSBuZXcgaU9TRnJhbWUoX3RoaXMpO1xuICAgICAgICBfdGhpcy52aWV3Q29udHJvbGxlciA9IF90aGlzLl9pb3MuY29udHJvbGxlcjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGcmFtZS5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld0NvbnRyb2xsZXIudmlldztcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2soKTtcbiAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZyYW1lLnByb3RvdHlwZS5zZXRDdXJyZW50ID0gZnVuY3Rpb24gKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSkge1xuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgdmFyIGN1cnJlbnRFbnRyeUNoYW5nZWQgPSBjdXJyZW50ICE9PSBlbnRyeTtcbiAgICAgICAgaWYgKGN1cnJlbnRFbnRyeUNoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUJhY2tzdGFjayhlbnRyeSwgbmF2aWdhdGlvblR5cGUpO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRDdXJyZW50LmNhbGwodGhpcywgZW50cnksIG5hdmlnYXRpb25UeXBlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9uYXZpZ2F0ZUNvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fbmF2aWdhdGVDb3JlLmNhbGwodGhpcywgYmFja3N0YWNrRW50cnkpO1xuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXIgPSBiYWNrc3RhY2tFbnRyeS5yZXNvbHZlZFBhZ2UuaW9zO1xuICAgICAgICBpZiAoIXZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZXF1aXJlZCBwYWdlIGRvZXMgbm90IGhhdmUgYSB2aWV3Q29udHJvbGxlciBjcmVhdGVkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xlYXJIaXN0b3J5ID0gYmFja3N0YWNrRW50cnkuZW50cnkuY2xlYXJIaXN0b3J5O1xuICAgICAgICBpZiAoY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICBuYXZEZXB0aCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc1JlcGxhY2UgPSB0aGlzLl9leGVjdXRpbmdDb250ZXh0ICYmIHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQubmF2aWdhdGlvblR5cGUgPT09IGZyYW1lX2NvbW1vbl8xLk5hdmlnYXRpb25UeXBlLnJlcGxhY2U7XG4gICAgICAgIGlmICghaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICBuYXZEZXB0aCsrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uVHJhbnNpdGlvbjtcbiAgICAgICAgdmFyIGFuaW1hdGVkID0gdGhpcy5jdXJyZW50UGFnZSA/IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKGJhY2tzdGFja0VudHJ5LmVudHJ5KSA6IGZhbHNlO1xuICAgICAgICBpZiAoaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICBhbmltYXRlZCA9IHRydWU7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHsgbmFtZTogSE1SX1JFUExBQ0VfVFJBTlNJVElPTiwgZHVyYXRpb246IDEwMCB9O1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl0gPSBuYXZpZ2F0aW9uVHJhbnNpdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhbmltYXRlZCkge1xuICAgICAgICAgICAgbmF2aWdhdGlvblRyYW5zaXRpb24gPSB0aGlzLl9nZXROYXZpZ2F0aW9uVHJhbnNpdGlvbihiYWNrc3RhY2tFbnRyeS5lbnRyeSk7XG4gICAgICAgICAgICBpZiAobmF2aWdhdGlvblRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3Q29udHJvbGxlcltUUkFOU0lUSU9OXSA9IG5hdmlnYXRpb25UcmFuc2l0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl0gPSB7IG5hbWU6IE5PTl9BTklNQVRFRF9UUkFOU0lUSU9OIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVRyYW5zaXRpb24gPSBfZ2V0TmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgdHJ1ZSk7XG4gICAgICAgIGlmICghbmF0aXZlVHJhbnNpdGlvbiAmJiBuYXZpZ2F0aW9uVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIuZGVsZWdhdGUgPSB0aGlzLl9hbmltYXRlZERlbGVnYXRlO1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXJbREVMRUdBVEVdID0gdGhpcy5fYW5pbWF0ZWREZWxlZ2F0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVyW0RFTEVHQVRFXSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgYmFja3N0YWNrRW50cnlbTkFWX0RFUFRIXSA9IG5hdkRlcHRoO1xuICAgICAgICB2aWV3Q29udHJvbGxlcltFTlRSWV0gPSBiYWNrc3RhY2tFbnRyeTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCAmJiBtYWpvclZlcnNpb24gPiAxMCkge1xuICAgICAgICAgICAgdmFyIGJhckJ1dHRvbkl0ZW0gPSBVSUJhckJ1dHRvbkl0ZW0uYWxsb2MoKS5pbml0V2l0aFRpdGxlU3R5bGVUYXJnZXRBY3Rpb24oXCJcIiwgMCwgbnVsbCwgbnVsbCk7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlci5uYXZpZ2F0aW9uSXRlbS5iYWNrQmFyQnV0dG9uSXRlbSA9IGJhckJ1dHRvbkl0ZW07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9jdXJyZW50RW50cnkpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUFjdGlvbkJhcihiYWNrc3RhY2tFbnRyeS5yZXNvbHZlZFBhZ2UsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQodmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKTtcbiAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUodGhpcyArIFwiLnB1c2hWaWV3Q29udHJvbGxlckFuaW1hdGVkKFwiICsgdmlld0NvbnRyb2xsZXIgKyBcIiwgXCIgKyBhbmltYXRlZCArIFwiKTsgZGVwdGggPSBcIiArIG5hdkRlcHRoLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNsZWFySGlzdG9yeSkge1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkl0ZW0uaGlkZXNCYWNrQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBuZXdDb250cm9sbGVycyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhDYXBhY2l0eSgxKTtcbiAgICAgICAgICAgIG5ld0NvbnRyb2xsZXJzLmFkZE9iamVjdCh2aWV3Q29udHJvbGxlcik7XG4gICAgICAgICAgICB2YXIgb2xkQ29udHJvbGxlcnMgPSB0aGlzLl9pb3MuY29udHJvbGxlci52aWV3Q29udHJvbGxlcnM7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9sZENvbnRyb2xsZXJzLmNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBvbGRDb250cm9sbGVycy5vYmplY3RBdEluZGV4KGkpLmlzQmFja3N0YWNrQ2xlYXJlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZChuZXdDb250cm9sbGVycywgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZSh0aGlzICsgXCIuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQoW1wiICsgdmlld0NvbnRyb2xsZXIgKyBcIl0sIFwiICsgYW5pbWF0ZWQgKyBcIik7IGRlcHRoID0gXCIgKyBuYXZEZXB0aCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghRnJhbWUuX2lzRW50cnlCYWNrc3RhY2tWaXNpYmxlKHRoaXMuX2N1cnJlbnRFbnRyeSkgfHwgaXNSZXBsYWNlKSB7XG4gICAgICAgICAgICB2YXIgbmV3Q29udHJvbGxlcnMgPSBOU011dGFibGVBcnJheS5hbGxvYygpLmluaXRXaXRoQXJyYXkodGhpcy5faW9zLmNvbnRyb2xsZXIudmlld0NvbnRyb2xsZXJzKTtcbiAgICAgICAgICAgIGlmIChuZXdDb250cm9sbGVycy5jb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIldyb25nIGNvbnRyb2xsZXJzIGNvdW50LlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVyLm5hdmlnYXRpb25JdGVtLmhpZGVzQmFja0J1dHRvbiA9IHRoaXMuYmFja1N0YWNrLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgICAgIHZhciBza2lwcGVkTmF2Q29udHJvbGxlciA9IG5ld0NvbnRyb2xsZXJzLmxhc3RPYmplY3Q7XG4gICAgICAgICAgICBza2lwcGVkTmF2Q29udHJvbGxlci5pc0JhY2tzdGFja1NraXBwZWQgPSB0cnVlO1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlcnMucmVtb3ZlTGFzdE9iamVjdCgpO1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlcnMuYWRkT2JqZWN0KHZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyLnNldFZpZXdDb250cm9sbGVyc0FuaW1hdGVkKG5ld0NvbnRyb2xsZXJzLCBhbmltYXRlZCk7XG4gICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZChbb3JpZ2luYWxDb250cm9sbGVycyAtIGxhc3RDb250cm9sbGVyICsgXCIgKyB2aWV3Q29udHJvbGxlciArIFwiXSwgXCIgKyBhbmltYXRlZCArIFwiKTsgZGVwdGggPSBcIiArIG5hdkRlcHRoLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQodmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZChcIiArIHZpZXdDb250cm9sbGVyICsgXCIsIFwiICsgYW5pbWF0ZWQgKyBcIik7IGRlcHRoID0gXCIgKyBuYXZEZXB0aCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX2dvQmFja0NvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fZ29CYWNrQ29yZS5jYWxsKHRoaXMsIGJhY2tzdGFja0VudHJ5KTtcbiAgICAgICAgbmF2RGVwdGggPSBiYWNrc3RhY2tFbnRyeVtOQVZfREVQVEhdO1xuICAgICAgICB2YXIgY29udHJvbGxlciA9IGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZS5pb3M7XG4gICAgICAgIHZhciBhbmltYXRlZCA9IHRoaXMuX2N1cnJlbnRFbnRyeSA/IHRoaXMuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uKHRoaXMuX2N1cnJlbnRFbnRyeS5lbnRyeSkgOiBmYWxzZTtcbiAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uQmFyKGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZSk7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZSh0aGlzICsgXCIucG9wVG9WaWV3Q29udHJvbGxlckFuaW1hdGVkKFwiICsgY29udHJvbGxlciArIFwiLCBcIiArIGFuaW1hdGVkICsgXCIpOyBkZXB0aCA9IFwiICsgbmF2RGVwdGgsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQoY29udHJvbGxlciwgYW5pbWF0ZWQpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl91cGRhdGVBY3Rpb25CYXIgPSBmdW5jdGlvbiAocGFnZSwgZGlzYWJsZU5hdkJhckFuaW1hdGlvbikge1xuICAgICAgICBpZiAoZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9PT0gdm9pZCAwKSB7IGRpc2FibGVOYXZCYXJBbmltYXRpb24gPSBmYWxzZTsgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl91cGRhdGVBY3Rpb25CYXIuY2FsbCh0aGlzLCBwYWdlKTtcbiAgICAgICAgaWYgKHBhZ2UgJiYgdGhpcy5jdXJyZW50UGFnZSAmJiB0aGlzLmN1cnJlbnRQYWdlLm1vZGFsID09PSBwYWdlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcGFnZSA9IHBhZ2UgfHwgdGhpcy5jdXJyZW50UGFnZTtcbiAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5fZ2V0TmF2QmFyVmlzaWJsZShwYWdlKTtcbiAgICAgICAgdmFyIGRpc2FibGVOYXZCYXJBbmltYXRpb25DYWNoZSA9IHRoaXMuX2lvcy5fZGlzYWJsZU5hdkJhckFuaW1hdGlvbjtcbiAgICAgICAgaWYgKGRpc2FibGVOYXZCYXJBbmltYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5fZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW9zLnNob3dOYXZpZ2F0aW9uQmFyID0gbmV3VmFsdWU7XG4gICAgICAgIGlmIChkaXNhYmxlTmF2QmFyQW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSBkaXNhYmxlTmF2QmFyQW5pbWF0aW9uQ2FjaGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX2lvcy5jb250cm9sbGVyLm5hdmlnYXRpb25CYXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyLm5hdmlnYXRpb25CYXIudXNlckludGVyYWN0aW9uRW5hYmxlZCA9IHRoaXMubmF2aWdhdGlvblF1ZXVlSXNFbXB0eSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX2dldE5hdkJhclZpc2libGUgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuYWN0aW9uQmFyVmlzaWJpbGl0eSkge1xuICAgICAgICAgICAgY2FzZSBcImFsd2F5c1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgY2FzZSBcIm5ldmVyXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgY2FzZSBcImF1dG9cIjpcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMuX2lvcy5uYXZCYXJWaXNpYmlsaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhbHdheXNcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibmV2ZXJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImF1dG9cIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWdlICYmIHBhZ2UuYWN0aW9uQmFySGlkZGVuICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9ICFwYWdlLmFjdGlvbkJhckhpZGRlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gdGhpcy5pb3MuY29udHJvbGxlci52aWV3Q29udHJvbGxlcnMuY291bnQgPiAxIHx8IChwYWdlICYmIHBhZ2UuYWN0aW9uQmFyICYmICFwYWdlLmFjdGlvbkJhci5faXNFbXB0eSgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gISFuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZSwgXCJkZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlLmRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UuZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUsIFwiZGVmYXVsdFRyYW5zaXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UuZGVmYXVsdFRyYW5zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UuZGVmYXVsdFRyYW5zaXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWUucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSBmcmFtZV9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gZnJhbWVfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGZyYW1lX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGZyYW1lX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IGZyYW1lX2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZSh3aWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IGZyYW1lX2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShoZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLmxheW91dE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX3NldE5hdGl2ZVZpZXdGcmFtZSA9IGZ1bmN0aW9uIChuYXRpdmVWaWV3LCBmcmFtZSkge1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLl9vbk5hdmlnYXRpbmdUbyA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSwgaXNCYWNrKSB7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lLnByb3RvdHlwZSwgXCJfbmF2aWdhdGVDb3JlXCIsIG51bGwpO1xuICAgIHJldHVybiBGcmFtZTtcbn0oZnJhbWVfY29tbW9uXzEuRnJhbWVCYXNlKSk7XG5leHBvcnRzLkZyYW1lID0gRnJhbWU7XG52YXIgdHJhbnNpdGlvbkRlbGVnYXRlcyA9IG5ldyBBcnJheSgpO1xudmFyIFRyYW5zaXRpb25EZWxlZ2F0ZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRyYW5zaXRpb25EZWxlZ2F0ZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUcmFuc2l0aW9uRGVsZWdhdGUoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVHJhbnNpdGlvbkRlbGVnYXRlLmluaXRXaXRoT3duZXJJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBUcmFuc2l0aW9uRGVsZWdhdGUubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9pZCA9IGlkO1xuICAgICAgICB0cmFuc2l0aW9uRGVsZWdhdGVzLnB1c2goZGVsZWdhdGUpO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGU7XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uRGVsZWdhdGUucHJvdG90eXBlLmFuaW1hdGlvbldpbGxTdGFydCA9IGZ1bmN0aW9uIChhbmltYXRpb25JRCwgY29udGV4dCkge1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJTVEFSVCBcIiArIHRoaXMuX2lkLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRyYW5zaXRpb25EZWxlZ2F0ZS5wcm90b3R5cGUuYW5pbWF0aW9uRGlkU3RvcCA9IGZ1bmN0aW9uIChhbmltYXRpb25JRCwgZmluaXNoZWQsIGNvbnRleHQpIHtcbiAgICAgICAgaWYgKGZpbmlzaGVkKSB7XG4gICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiRU5EIFwiICsgdGhpcy5faWQsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDQU5DRUwgXCIgKyB0aGlzLl9pZCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IHRyYW5zaXRpb25EZWxlZ2F0ZXMuaW5kZXhPZih0aGlzKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgIHRyYW5zaXRpb25EZWxlZ2F0ZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVHJhbnNpdGlvbkRlbGVnYXRlLk9iakNFeHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgICAgXCJhbmltYXRpb25XaWxsU3RhcnRcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW05TU3RyaW5nLCBOU09iamVjdF0gfSxcbiAgICAgICAgXCJhbmltYXRpb25EaWRTdG9wXCI6IHsgcmV0dXJuczogaW50ZXJvcC50eXBlcy52b2lkLCBwYXJhbXM6IFtOU1N0cmluZywgTlNOdW1iZXIsIE5TT2JqZWN0XSB9XG4gICAgfTtcbiAgICByZXR1cm4gVHJhbnNpdGlvbkRlbGVnYXRlO1xufShOU09iamVjdCkpO1xudmFyIF9kZWZhdWx0VHJhbnNpdGlvbkR1cmF0aW9uID0gMC4zNTtcbnZhciBVSU5hdmlnYXRpb25Db250cm9sbGVyQW5pbWF0ZWREZWxlZ2F0ZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJBbmltYXRlZERlbGVnYXRlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJBbmltYXRlZERlbGVnYXRlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJBbmltYXRlZERlbGVnYXRlLnByb3RvdHlwZS5uYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGlvbkNvbnRyb2xsZXJGb3JPcGVyYXRpb25Gcm9tVmlld0NvbnRyb2xsZXJUb1ZpZXdDb250cm9sbGVyID0gZnVuY3Rpb24gKG5hdmlnYXRpb25Db250cm9sbGVyLCBvcGVyYXRpb24sIGZyb21WQywgdG9WQykge1xuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXI7XG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIgPSB0b1ZDO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHZpZXdDb250cm9sbGVyID0gZnJvbVZDO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHZpZXdDb250cm9sbGVyW1RSQU5TSVRJT05dO1xuICAgICAgICBpZiAoIW5hdmlnYXRpb25UcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5uYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGlvbkNvbnRyb2xsZXJGb3JPcGVyYXRpb25Gcm9tVmlld0NvbnRyb2xsZXJUb1ZpZXdDb250cm9sbGVyKFwiICsgb3BlcmF0aW9uICsgXCIsIFwiICsgZnJvbVZDICsgXCIsIFwiICsgdG9WQyArIFwiKSwgdHJhbnNpdGlvbjogXCIgKyBKU09OLnN0cmluZ2lmeShuYXZpZ2F0aW9uVHJhbnNpdGlvbiksIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJ2ZSA9IF9nZXROYXRpdmVDdXJ2ZShuYXZpZ2F0aW9uVHJhbnNpdGlvbik7XG4gICAgICAgIHZhciBhbmltYXRpb25Db250cm9sbGVyID0gZnJhZ21lbnRfdHJhbnNpdGlvbnNfMS5fY3JlYXRlSU9TQW5pbWF0ZWRUcmFuc2l0aW9uaW5nKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBjdXJ2ZSwgb3BlcmF0aW9uLCBmcm9tVkMsIHRvVkMpO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uQ29udHJvbGxlcjtcbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJBbmltYXRlZERlbGVnYXRlLk9iakNQcm90b2NvbHMgPSBbVUlOYXZpZ2F0aW9uQ29udHJvbGxlckRlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGU7XG59KE5TT2JqZWN0KSk7XG52YXIgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBjb250cm9sbGVyID0gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwubmV3KCk7XG4gICAgICAgIGNvbnRyb2xsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBjb250cm9sbGVyO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZSwgXCJvd25lclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld1dpbGxBcHBlYXIgPSBmdW5jdGlvbiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lciAmJiAhb3duZXIuaXNMb2FkZWQgJiYgIW93bmVyLnBhcmVudCkge1xuICAgICAgICAgICAgb3duZXIuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld0RpZERpc2FwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWREaXNhcHBlYXIuY2FsbCh0aGlzLCBhbmltYXRlZCk7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIgJiYgb3duZXIuaXNMb2FkZWQgJiYgIW93bmVyLnBhcmVudCAmJiAhdGhpcy5wcmVzZW50ZWRWaWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgb3duZXIuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgICAgICBvd25lci5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucHJvdG90eXBlLmFuaW1hdGVXaXRoRHVyYXRpb24gPSBmdW5jdGlvbiAobmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZVRyYW5zaXRpb24sIHRyYW5zaXRpb25UeXBlLCBiYXNlQ2FsbGJhY2spIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gbmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24gPyBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbiAvIDEwMDAgOiBfZGVmYXVsdFRyYW5zaXRpb25EdXJhdGlvbjtcbiAgICAgICAgdmFyIGN1cnZlID0gX2dldE5hdGl2ZUN1cnZlKG5hdmlnYXRpb25UcmFuc2l0aW9uKTtcbiAgICAgICAgdmFyIHRyYW5zaXRpb25UcmFjZWQgPSBmcmFtZV9jb21tb25fMS5pc0NhdGVnb3J5U2V0KGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgdmFyIHRyYW5zaXRpb25EZWxlZ2F0ZTtcbiAgICAgICAgaWYgKHRyYW5zaXRpb25UcmFjZWQpIHtcbiAgICAgICAgICAgIHZhciBpZCA9IF9nZXRUcmFuc2l0aW9uSWQobmF0aXZlVHJhbnNpdGlvbiwgdHJhbnNpdGlvblR5cGUpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGVnYXRlID0gVHJhbnNpdGlvbkRlbGVnYXRlLmluaXRXaXRoT3duZXJJZChpZCk7XG4gICAgICAgIH1cbiAgICAgICAgVUlWaWV3LmFuaW1hdGVXaXRoRHVyYXRpb25BbmltYXRpb25zKGR1cmF0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodHJhbnNpdGlvblRyYWNlZCkge1xuICAgICAgICAgICAgICAgIFVJVmlldy5zZXRBbmltYXRpb25EZWxlZ2F0ZSh0cmFuc2l0aW9uRGVsZWdhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgVUlWaWV3LnNldEFuaW1hdGlvbldpbGxTdGFydFNlbGVjdG9yKFwiYW5pbWF0aW9uV2lsbFN0YXJ0XCIpO1xuICAgICAgICAgICAgVUlWaWV3LnNldEFuaW1hdGlvbkRpZFN0b3BTZWxlY3RvcihcImFuaW1hdGlvbkRpZFN0b3BcIik7XG4gICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uQ3VydmUoY3VydmUpO1xuICAgICAgICAgICAgYmFzZUNhbGxiYWNrKCk7XG4gICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uVHJhbnNpdGlvbkZvclZpZXdDYWNoZShuYXRpdmVUcmFuc2l0aW9uLCBfdGhpcy52aWV3LCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQgPSBmdW5jdGlvbiAodmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHZpZXdDb250cm9sbGVyW1RSQU5TSVRJT05dO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZChcIiArIHZpZXdDb250cm9sbGVyICsgXCIsIFwiICsgYW5pbWF0ZWQgKyBcIik7IHRyYW5zaXRpb246IFwiICsgSlNPTi5zdHJpbmdpZnkobmF2aWdhdGlvblRyYW5zaXRpb24pLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVHJhbnNpdGlvbiA9IF9nZXROYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cnVlKTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCB8fCAhbmF2aWdhdGlvblRyYW5zaXRpb24gfHwgIW5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbCh0aGlzLCB2aWV3Q29udHJvbGxlciwgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5pbWF0ZVdpdGhEdXJhdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmF0aXZlVHJhbnNpdGlvbiwgXCJwdXNoXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbChfdGhpcywgdmlld0NvbnRyb2xsZXIsIGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQgPSBmdW5jdGlvbiAodmlld0NvbnRyb2xsZXJzLCBhbmltYXRlZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXIgPSB2aWV3Q29udHJvbGxlcnMubGFzdE9iamVjdDtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gdmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl07XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnNldFZpZXdDb250cm9sbGVyc0FuaW1hdGVkKFwiICsgdmlld0NvbnRyb2xsZXJzICsgXCIsIFwiICsgYW5pbWF0ZWQgKyBcIik7IHRyYW5zaXRpb246IFwiICsgSlNPTi5zdHJpbmdpZnkobmF2aWdhdGlvblRyYW5zaXRpb24pLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVHJhbnNpdGlvbiA9IF9nZXROYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cnVlKTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCB8fCAhbmF2aWdhdGlvblRyYW5zaXRpb24gfHwgIW5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQuY2FsbCh0aGlzLCB2aWV3Q29udHJvbGxlcnMsIGFuaW1hdGVkKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuaW1hdGVXaXRoRHVyYXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZVRyYW5zaXRpb24sIFwic2V0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQuY2FsbChfdGhpcywgdmlld0NvbnRyb2xsZXJzLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucHJvdG90eXBlLnBvcFZpZXdDb250cm9sbGVyQW5pbWF0ZWQgPSBmdW5jdGlvbiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGxhc3RWaWV3Q29udHJvbGxlciA9IHRoaXMudmlld0NvbnRyb2xsZXJzLmxhc3RPYmplY3Q7XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IGxhc3RWaWV3Q29udHJvbGxlcltUUkFOU0lUSU9OXTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucG9wVmlld0NvbnRyb2xsZXJBbmltYXRlZChcIiArIGFuaW1hdGVkICsgXCIpOyB0cmFuc2l0aW9uOiBcIiArIEpTT04uc3RyaW5naWZ5KG5hdmlnYXRpb25UcmFuc2l0aW9uKSwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdmlnYXRpb25UcmFuc2l0aW9uICYmIG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUgPT09IE5PTl9BTklNQVRFRF9UUkFOU0lUSU9OKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5wb3BWaWV3Q29udHJvbGxlckFuaW1hdGVkLmNhbGwodGhpcywgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVUcmFuc2l0aW9uID0gX2dldE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGZhbHNlKTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCB8fCAhbmF2aWdhdGlvblRyYW5zaXRpb24gfHwgIW5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnBvcFZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbCh0aGlzLCBhbmltYXRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbmltYXRlV2l0aER1cmF0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBuYXRpdmVUcmFuc2l0aW9uLCBcInBvcFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnBvcFZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbChfdGhpcywgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUucG9wVG9WaWV3Q29udHJvbGxlckFuaW1hdGVkID0gZnVuY3Rpb24gKHZpZXdDb250cm9sbGVyLCBhbmltYXRlZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgbGFzdFZpZXdDb250cm9sbGVyID0gdGhpcy52aWV3Q29udHJvbGxlcnMubGFzdE9iamVjdDtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gbGFzdFZpZXdDb250cm9sbGVyW1RSQU5TSVRJT05dO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQoXCIgKyB2aWV3Q29udHJvbGxlciArIFwiLCBcIiArIGFuaW1hdGVkICsgXCIpOyB0cmFuc2l0aW9uOiBcIiArIEpTT04uc3RyaW5naWZ5KG5hdmlnYXRpb25UcmFuc2l0aW9uKSwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdmlnYXRpb25UcmFuc2l0aW9uICYmIG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUgPT09IE5PTl9BTklNQVRFRF9UUkFOU0lUSU9OKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbCh0aGlzLCB2aWV3Q29udHJvbGxlciwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVUcmFuc2l0aW9uID0gX2dldE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIGZhbHNlKTtcbiAgICAgICAgaWYgKCFhbmltYXRlZCB8fCAhbmF2aWdhdGlvblRyYW5zaXRpb24gfHwgIW5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnBvcFRvVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKHRoaXMsIHZpZXdDb250cm9sbGVyLCBhbmltYXRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbmltYXRlV2l0aER1cmF0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBuYXRpdmVUcmFuc2l0aW9uLCBcInBvcFRvXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucG9wVG9WaWV3Q29udHJvbGxlckFuaW1hdGVkLmNhbGwoX3RoaXMsIHZpZXdDb250cm9sbGVyLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucHJvdG90eXBlLCBcInZpZXdXaWxsQXBwZWFyXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucHJvdG90eXBlLCBcInZpZXdEaWREaXNhcHBlYXJcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUsIFwicHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUsIFwic2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsO1xufShVSU5hdmlnYXRpb25Db250cm9sbGVyKSk7XG5mdW5jdGlvbiBfZ2V0VHJhbnNpdGlvbklkKG5hdGl2ZVRyYW5zaXRpb24sIHRyYW5zaXRpb25UeXBlKSB7XG4gICAgdmFyIG5hbWU7XG4gICAgc3dpdGNoIChuYXRpdmVUcmFuc2l0aW9uKSB7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIG5hbWUgPSBcIkN1cmxEb3duXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgbmFtZSA9IFwiQ3VybFVwXCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgbmFtZSA9IFwiRmxpcEZyb21MZWZ0XCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgbmFtZSA9IFwiRmxpcEZyb21SaWdodFwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIG5hbWUgPSBcIk5vbmVcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gbmFtZSArIFwiIFwiICsgdHJhbnNpdGlvblR5cGU7XG59XG5mdW5jdGlvbiBfZ2V0TmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgcHVzaCkge1xuICAgIGlmIChuYXZpZ2F0aW9uVHJhbnNpdGlvbiAmJiBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5uYW1lKSB7XG4gICAgICAgIHN3aXRjaCAobmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwiZmxpcFwiOlxuICAgICAgICAgICAgY2FzZSBcImZsaXByaWdodFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBwdXNoID8gMiA6IDE7XG4gICAgICAgICAgICBjYXNlIFwiZmxpcGxlZnRcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gcHVzaCA/IDEgOiAyO1xuICAgICAgICAgICAgY2FzZSBcImN1cmxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJjdXJsdXBcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gcHVzaCA/IDMgOiA0O1xuICAgICAgICAgICAgY2FzZSBcImN1cmxkb3duXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1c2ggPyA0IDogMztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmZ1bmN0aW9uIF9nZXROYXRpdmVDdXJ2ZSh0cmFuc2l0aW9uKSB7XG4gICAgaWYgKHRyYW5zaXRpb24uY3VydmUpIHtcbiAgICAgICAgc3dpdGNoICh0cmFuc2l0aW9uLmN1cnZlKSB7XG4gICAgICAgICAgICBjYXNlIFwiZWFzZUluXCI6XG4gICAgICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUcmFuc2l0aW9uIGN1cnZlIHJlc29sdmVkIHRvIFVJVmlld0FuaW1hdGlvbkN1cnZlLkVhc2VJbi5cIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgXCJlYXNlT3V0XCI6XG4gICAgICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUcmFuc2l0aW9uIGN1cnZlIHJlc29sdmVkIHRvIFVJVmlld0FuaW1hdGlvbkN1cnZlLkVhc2VPdXQuXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBjYXNlIFwiZWFzZUluT3V0XCI6XG4gICAgICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUcmFuc2l0aW9uIGN1cnZlIHJlc29sdmVkIHRvIFVJVmlld0FuaW1hdGlvbkN1cnZlLkVhc2VJbk91dC5cIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgXCJsaW5lYXJcIjpcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlRyYW5zaXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gVUlWaWV3QW5pbWF0aW9uQ3VydmUuTGluZWFyLlwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAzO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlRyYW5zaXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gb3JpZ2luYWw6IFwiICsgdHJhbnNpdGlvbi5jdXJ2ZSwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNpdGlvbi5jdXJ2ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmV4cG9ydHMuX2dldE5hdGl2ZUN1cnZlID0gX2dldE5hdGl2ZUN1cnZlO1xudmFyIGlPU0ZyYW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBpT1NGcmFtZShmcmFtZSkge1xuICAgICAgICB0aGlzLl9uYXZCYXJWaXNpYmlsaXR5ID0gXCJhdXRvXCI7XG4gICAgICAgIHRoaXMuX2NvbnRyb2xsZXIgPSBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKGZyYW1lKSk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpT1NGcmFtZS5wcm90b3R5cGUsIFwiY29udHJvbGxlclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRyb2xsZXI7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpT1NGcmFtZS5wcm90b3R5cGUsIFwic2hvd05hdmlnYXRpb25CYXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zaG93TmF2aWdhdGlvbkJhcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dOYXZpZ2F0aW9uQmFyID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnNldE5hdmlnYXRpb25CYXJIaWRkZW5BbmltYXRlZCghdmFsdWUsICF0aGlzLl9kaXNhYmxlTmF2QmFyQW5pbWF0aW9uKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGlPU0ZyYW1lLnByb3RvdHlwZSwgXCJuYXZCYXJWaXNpYmlsaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmF2QmFyVmlzaWJpbGl0eTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX25hdkJhclZpc2liaWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGlPU0ZyYW1lO1xufSgpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYW1lLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgR2VzdHVyZVR5cGVzO1xuKGZ1bmN0aW9uIChHZXN0dXJlVHlwZXMpIHtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1widGFwXCJdID0gMV0gPSBcInRhcFwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJkb3VibGVUYXBcIl0gPSAyXSA9IFwiZG91YmxlVGFwXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInBpbmNoXCJdID0gNF0gPSBcInBpbmNoXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInBhblwiXSA9IDhdID0gXCJwYW5cIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wic3dpcGVcIl0gPSAxNl0gPSBcInN3aXBlXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInJvdGF0aW9uXCJdID0gMzJdID0gXCJyb3RhdGlvblwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJsb25nUHJlc3NcIl0gPSA2NF0gPSBcImxvbmdQcmVzc1wiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJ0b3VjaFwiXSA9IDEyOF0gPSBcInRvdWNoXCI7XG59KShHZXN0dXJlVHlwZXMgPSBleHBvcnRzLkdlc3R1cmVUeXBlcyB8fCAoZXhwb3J0cy5HZXN0dXJlVHlwZXMgPSB7fSkpO1xudmFyIEdlc3R1cmVTdGF0ZVR5cGVzO1xuKGZ1bmN0aW9uIChHZXN0dXJlU3RhdGVUeXBlcykge1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiY2FuY2VsbGVkXCJdID0gMF0gPSBcImNhbmNlbGxlZFwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiYmVnYW5cIl0gPSAxXSA9IFwiYmVnYW5cIjtcbiAgICBHZXN0dXJlU3RhdGVUeXBlc1tHZXN0dXJlU3RhdGVUeXBlc1tcImNoYW5nZWRcIl0gPSAyXSA9IFwiY2hhbmdlZFwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiZW5kZWRcIl0gPSAzXSA9IFwiZW5kZWRcIjtcbn0pKEdlc3R1cmVTdGF0ZVR5cGVzID0gZXhwb3J0cy5HZXN0dXJlU3RhdGVUeXBlcyB8fCAoZXhwb3J0cy5HZXN0dXJlU3RhdGVUeXBlcyA9IHt9KSk7XG52YXIgU3dpcGVEaXJlY3Rpb247XG4oZnVuY3Rpb24gKFN3aXBlRGlyZWN0aW9uKSB7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJyaWdodFwiXSA9IDFdID0gXCJyaWdodFwiO1xuICAgIFN3aXBlRGlyZWN0aW9uW1N3aXBlRGlyZWN0aW9uW1wibGVmdFwiXSA9IDJdID0gXCJsZWZ0XCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJ1cFwiXSA9IDRdID0gXCJ1cFwiO1xuICAgIFN3aXBlRGlyZWN0aW9uW1N3aXBlRGlyZWN0aW9uW1wiZG93blwiXSA9IDhdID0gXCJkb3duXCI7XG59KShTd2lwZURpcmVjdGlvbiA9IGV4cG9ydHMuU3dpcGVEaXJlY3Rpb24gfHwgKGV4cG9ydHMuU3dpcGVEaXJlY3Rpb24gPSB7fSkpO1xudmFyIFRvdWNoQWN0aW9uO1xuKGZ1bmN0aW9uIChUb3VjaEFjdGlvbikge1xuICAgIFRvdWNoQWN0aW9uLmRvd24gPSBcImRvd25cIjtcbiAgICBUb3VjaEFjdGlvbi51cCA9IFwidXBcIjtcbiAgICBUb3VjaEFjdGlvbi5tb3ZlID0gXCJtb3ZlXCI7XG4gICAgVG91Y2hBY3Rpb24uY2FuY2VsID0gXCJjYW5jZWxcIjtcbn0pKFRvdWNoQWN0aW9uID0gZXhwb3J0cy5Ub3VjaEFjdGlvbiB8fCAoZXhwb3J0cy5Ub3VjaEFjdGlvbiA9IHt9KSk7XG5mdW5jdGlvbiB0b1N0cmluZyh0eXBlLCBzZXBhcmF0b3IpIHtcbiAgICB2YXIgdHlwZXMgPSBuZXcgQXJyYXkoKTtcbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy50YXApIHtcbiAgICAgICAgdHlwZXMucHVzaChcInRhcFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMuZG91YmxlVGFwKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJkb3VibGVUYXBcIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnBpbmNoKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJwaW5jaFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucGFuKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJwYW5cIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnN3aXBlKSB7XG4gICAgICAgIHR5cGVzLnB1c2goXCJzd2lwZVwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucm90YXRpb24pIHtcbiAgICAgICAgdHlwZXMucHVzaChcInJvdGF0aW9uXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5sb25nUHJlc3MpIHtcbiAgICAgICAgdHlwZXMucHVzaChcImxvbmdQcmVzc1wiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMudG91Y2gpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInRvdWNoXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZXMuam9pbihzZXBhcmF0b3IpO1xufVxuZXhwb3J0cy50b1N0cmluZyA9IHRvU3RyaW5nO1xuZnVuY3Rpb24gZnJvbVN0cmluZyh0eXBlKSB7XG4gICAgdmFyIHQgPSB0eXBlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmICh0ID09PSBcInRhcFwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMudGFwO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcImRvdWJsZXRhcFwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMuZG91YmxlVGFwO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInBpbmNoXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5waW5jaDtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJwYW5cIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnBhbjtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJzd2lwZVwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMuc3dpcGU7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwicm90YXRpb25cIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnJvdGF0aW9uO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcImxvbmdwcmVzc1wiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMubG9uZ1ByZXNzO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInRvdWNoXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy50b3VjaDtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZnJvbVN0cmluZyA9IGZyb21TdHJpbmc7XG52YXIgR2VzdHVyZXNPYnNlcnZlckJhc2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdlc3R1cmVzT2JzZXJ2ZXJCYXNlKHRhcmdldCwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlc3R1cmVzT2JzZXJ2ZXJCYXNlLnByb3RvdHlwZSwgXCJjYWxsYmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhbGxiYWNrO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcInRhcmdldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RhcmdldDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdlc3R1cmVzT2JzZXJ2ZXJCYXNlLnByb3RvdHlwZSwgXCJjb250ZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLnRhcmdldC5nZXRHZXN0dXJlT2JzZXJ2ZXJzKHRoaXMudHlwZSk7XG4gICAgICAgICAgICBpZiAobGlzdCAmJiBsaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3RbaV0uY2FsbGJhY2sgPT09IHRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldC5fZ2VzdHVyZU9ic2VydmVyc1t0aGlzLnR5cGVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRhcmdldC5fZ2VzdHVyZU9ic2VydmVyc1t0aGlzLnR5cGVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RhcmdldCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IG51bGw7XG4gICAgfTtcbiAgICByZXR1cm4gR2VzdHVyZXNPYnNlcnZlckJhc2U7XG59KCkpO1xuZXhwb3J0cy5HZXN0dXJlc09ic2VydmVyQmFzZSA9IEdlc3R1cmVzT2JzZXJ2ZXJCYXNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2VzdHVyZXMtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZ2VzdHVyZXNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9nZXN0dXJlcy1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9nZXN0dXJlcy1jb21tb25cIikpO1xuZnVuY3Rpb24gb2JzZXJ2ZSh0YXJnZXQsIHR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IEdlc3R1cmVzT2JzZXJ2ZXIodGFyZ2V0LCBjYWxsYmFjaywgY29udGV4dCk7XG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0eXBlKTtcbiAgICByZXR1cm4gb2JzZXJ2ZXI7XG59XG5leHBvcnRzLm9ic2VydmUgPSBvYnNlcnZlO1xudmFyIFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSUdlc3R1cmVSZWNvZ25pemVyRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZ2VzdHVyZVJlY29nbml6ZXJTaG91bGRSZWNvZ25pemVTaW11bHRhbmVvdXNseVdpdGhHZXN0dXJlUmVjb2duaXplciA9IGZ1bmN0aW9uIChnZXN0dXJlUmVjb2duaXplciwgb3RoZXJHZXN0dXJlUmVjb2duaXplcikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLmdlc3R1cmVSZWNvZ25pemVyU2hvdWxkUmVxdWlyZUZhaWx1cmVPZkdlc3R1cmVSZWNvZ25pemVyID0gZnVuY3Rpb24gKGdlc3R1cmVSZWNvZ25pemVyLCBvdGhlckdlc3R1cmVSZWNvZ25pemVyKSB7XG4gICAgICAgIGlmIChnZXN0dXJlUmVjb2duaXplciBpbnN0YW5jZW9mIFVJVGFwR2VzdHVyZVJlY29nbml6ZXJcbiAgICAgICAgICAgICYmIG90aGVyR2VzdHVyZVJlY29nbml6ZXIgaW5zdGFuY2VvZiBVSVRhcEdlc3R1cmVSZWNvZ25pemVyXG4gICAgICAgICAgICAmJiBvdGhlckdlc3R1cmVSZWNvZ25pemVyLm51bWJlck9mVGFwc1JlcXVpcmVkID09PSAyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBVSUdlc3R1cmVSZWNvZ25pemVyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbnZhciByZWNvZ25pemVyRGVsZWdhdGVJbnN0YW5jZSA9IFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwubmV3KCk7XG52YXIgVUlHZXN0dXJlUmVjb2duaXplckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSUdlc3R1cmVSZWNvZ25pemVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSUdlc3R1cmVSZWNvZ25pemVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSUdlc3R1cmVSZWNvZ25pemVySW1wbC5pbml0V2l0aE93bmVyVHlwZUNhbGxiYWNrID0gZnVuY3Rpb24gKG93bmVyLCB0eXBlLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICB2YXIgaGFuZGxlciA9IFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsLm5ldygpO1xuICAgICAgICBoYW5kbGVyLl9vd25lciA9IG93bmVyO1xuICAgICAgICBoYW5kbGVyLl90eXBlID0gdHlwZTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBoYW5kbGVyLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzQXJnKSB7XG4gICAgICAgICAgICBoYW5kbGVyLl9jb250ZXh0ID0gdGhpc0FyZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGFuZGxlcjtcbiAgICB9O1xuICAgIFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsLnByb3RvdHlwZS5yZWNvZ25pemUgPSBmdW5jdGlvbiAocmVjb2duaXplcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5fY2FsbGJhY2sgPyB0aGlzLl9jYWxsYmFjayA6IChvd25lciA/IG93bmVyLmNhbGxiYWNrIDogbnVsbCk7XG4gICAgICAgIHZhciB0eXBlUGFyYW0gPSB0aGlzLl90eXBlO1xuICAgICAgICB2YXIgdGFyZ2V0ID0gb3duZXIgPyBvd25lci50YXJnZXQgOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgdHlwZTogdHlwZVBhcmFtLFxuICAgICAgICAgICAgdmlldzogdGFyZ2V0LFxuICAgICAgICAgICAgaW9zOiByZWNvZ25pemVyLFxuICAgICAgICAgICAgYW5kcm9pZDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb2JqZWN0OiB0YXJnZXQsXG4gICAgICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKHR5cGVQYXJhbSksXG4gICAgICAgIH07XG4gICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLl9jb250ZXh0LCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlHZXN0dXJlUmVjb2duaXplckltcGwuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcInJlY29nbml6ZVwiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbVUlHZXN0dXJlUmVjb2duaXplcl0gfVxuICAgIH07XG4gICAgcmV0dXJuIFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsO1xufShOU09iamVjdCkpO1xudmFyIEdlc3R1cmVzT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhHZXN0dXJlc09ic2VydmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEdlc3R1cmVzT2JzZXJ2ZXIodGFyZ2V0LCBjYWxsYmFjaywgY29udGV4dCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB0YXJnZXQsIGNhbGxiYWNrLCBjb250ZXh0KSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fcmVjb2duaXplcnMgPSB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5hbmRyb2lkT25Ub3VjaEV2ZW50ID0gZnVuY3Rpb24gKG1vdGlvbkV2ZW50KSB7XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5vYnNlcnZlID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRMb2FkZWQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIF90aGlzLl9hdHRhY2goX3RoaXMudGFyZ2V0LCB0eXBlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldFVubG9hZGVkID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub24oXCJsb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRMb2FkZWQpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub24oXCJ1bmxvYWRlZFwiLCB0aGlzLl9vblRhcmdldFVubG9hZGVkKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldC5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F0dGFjaCh0aGlzLnRhcmdldCwgdHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLl9hdHRhY2ggPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2RldGFjaCgpO1xuICAgICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIHRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkLmFkZEdlc3R1cmVSZWNvZ25pemVyKSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudGFwKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5waW5jaCkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGluY2gsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFBpbmNoRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGFuKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4sIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFBhbkRhdGEoYXJncywgdGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFN3aXBlRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSwgOCkpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFN3aXBlRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSwgMikpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFN3aXBlRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSwgMSkpO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFN3aXBlRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSwgNCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucm90YXRpb24pIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmFkZEdlc3R1cmVSZWNvZ25pemVyKHRoaXMuX2NyZWF0ZVJlY29nbml6ZXIoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnJvdGF0aW9uLCBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZXhlY3V0ZUNhbGxiYWNrKF9nZXRSb3RhdGlvbkRhdGEoYXJncykpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmxvbmdQcmVzcykge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50b3VjaCkge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2gpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUuX2RldGFjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0ICYmIHRoaXMudGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIGZvciAodmFyIG5hbWVfMSBpbiB0aGlzLl9yZWNvZ25pemVycykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZWNvZ25pemVycy5oYXNPd25Qcm9wZXJ0eShuYW1lXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5fcmVjb2duaXplcnNbbmFtZV8xXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZC5yZW1vdmVHZXN0dXJlUmVjb2duaXplcihpdGVtLnJlY29nbml6ZXIpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnJlY29nbml6ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnRhcmdldCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVjb2duaXplcnMgPSB7fTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub2ZmKFwibG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0TG9hZGVkKTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0Lm9mZihcInVubG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQpO1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRMb2FkZWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNjb25uZWN0LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5fZXhlY3V0ZUNhbGxiYWNrID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2suY2FsbCh0aGlzLmNvbnRleHQsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5fY3JlYXRlUmVjb2duaXplciA9IGZ1bmN0aW9uICh0eXBlLCBjYWxsYmFjaywgc3dpcGVEaXJlY3Rpb24pIHtcbiAgICAgICAgdmFyIHJlY29nbml6ZXI7XG4gICAgICAgIHZhciBuYW1lID0gZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcodHlwZSk7XG4gICAgICAgIHZhciB0YXJnZXQgPSBfY3JlYXRlVUlHZXN0dXJlUmVjb2duaXplclRhcmdldCh0aGlzLCB0eXBlLCBjYWxsYmFjaywgdGhpcy5jb250ZXh0KTtcbiAgICAgICAgdmFyIHJlY29nbml6ZXJUeXBlID0gX2dldFVJR2VzdHVyZVJlY29nbml6ZXJUeXBlKHR5cGUpO1xuICAgICAgICBpZiAocmVjb2duaXplclR5cGUpIHtcbiAgICAgICAgICAgIHJlY29nbml6ZXIgPSByZWNvZ25pemVyVHlwZS5hbGxvYygpLmluaXRXaXRoVGFyZ2V0QWN0aW9uKHRhcmdldCwgXCJyZWNvZ25pemVcIik7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnN3aXBlICYmIHN3aXBlRGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUgKyBzd2lwZURpcmVjdGlvbi50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIHJlY29nbml6ZXIuZGlyZWN0aW9uID0gc3dpcGVEaXJlY3Rpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2gpIHtcbiAgICAgICAgICAgICAgICByZWNvZ25pemVyLm9ic2VydmVyID0gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5kb3VibGVUYXApIHtcbiAgICAgICAgICAgICAgICByZWNvZ25pemVyLm51bWJlck9mVGFwc1JlcXVpcmVkID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZWNvZ25pemVyKSB7XG4gICAgICAgICAgICAgICAgcmVjb2duaXplci5kZWxlZ2F0ZSA9IHJlY29nbml6ZXJEZWxlZ2F0ZUluc3RhbmNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlY29nbml6ZXJzW25hbWVdID0geyByZWNvZ25pemVyOiByZWNvZ25pemVyLCB0YXJnZXQ6IHRhcmdldCB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWNvZ25pemVyO1xuICAgIH07XG4gICAgcmV0dXJuIEdlc3R1cmVzT2JzZXJ2ZXI7XG59KGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVzT2JzZXJ2ZXJCYXNlKSk7XG5leHBvcnRzLkdlc3R1cmVzT2JzZXJ2ZXIgPSBHZXN0dXJlc09ic2VydmVyO1xuZnVuY3Rpb24gX2NyZWF0ZVVJR2VzdHVyZVJlY29nbml6ZXJUYXJnZXQob3duZXIsIHR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsLmluaXRXaXRoT3duZXJUeXBlQ2FsbGJhY2sobmV3IFdlYWtSZWYob3duZXIpLCB0eXBlLCBjYWxsYmFjaywgY29udGV4dCk7XG59XG5mdW5jdGlvbiBfZ2V0VUlHZXN0dXJlUmVjb2duaXplclR5cGUodHlwZSkge1xuICAgIHZhciBuYXRpdmVUeXBlID0gbnVsbDtcbiAgICBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRhcCkge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlUYXBHZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCkge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlUYXBHZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBpbmNoKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBVSVBpbmNoR2VzdHVyZVJlY29nbml6ZXI7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgPT09IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4pIHtcbiAgICAgICAgbmF0aXZlVHlwZSA9IFVJUGFuR2VzdHVyZVJlY29nbml6ZXI7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgPT09IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSkge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlTd2lwZUdlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucm90YXRpb24pIHtcbiAgICAgICAgbmF0aXZlVHlwZSA9IFVJUm90YXRpb25HZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmxvbmdQcmVzcykge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlMb25nUHJlc3NHZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBUb3VjaEdlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICByZXR1cm4gbmF0aXZlVHlwZTtcbn1cbmZ1bmN0aW9uIGdldFN0YXRlKHJlY29nbml6ZXIpIHtcbiAgICBpZiAocmVjb2duaXplci5zdGF0ZSA9PT0gMSkge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuYmVnYW47XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlY29nbml6ZXIuc3RhdGUgPT09IDQpIHtcbiAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVTdGF0ZVR5cGVzLmNhbmNlbGxlZDtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVjb2duaXplci5zdGF0ZSA9PT0gMikge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuY2hhbmdlZDtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVjb2duaXplci5zdGF0ZSA9PT0gMykge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuZW5kZWQ7XG4gICAgfVxufVxuZnVuY3Rpb24gX2dldFN3aXBlRGlyZWN0aW9uKGRpcmVjdGlvbikge1xuICAgIGlmIChkaXJlY3Rpb24gPT09IDgpIHtcbiAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlN3aXBlRGlyZWN0aW9uLmRvd247XG4gICAgfVxuICAgIGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gMikge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24ubGVmdDtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGlyZWN0aW9uID09PSAxKSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Td2lwZURpcmVjdGlvbi5yaWdodDtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGlyZWN0aW9uID09PSA0KSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Td2lwZURpcmVjdGlvbi51cDtcbiAgICB9XG59XG5mdW5jdGlvbiBfZ2V0UGluY2hEYXRhKGFyZ3MpIHtcbiAgICB2YXIgcmVjb2duaXplciA9IGFyZ3MuaW9zO1xuICAgIHZhciBjZW50ZXIgPSByZWNvZ25pemVyLmxvY2F0aW9uSW5WaWV3KGFyZ3Mudmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBhcmdzLnR5cGUsXG4gICAgICAgIHZpZXc6IGFyZ3MudmlldyxcbiAgICAgICAgaW9zOiBhcmdzLmlvcyxcbiAgICAgICAgYW5kcm9pZDogdW5kZWZpbmVkLFxuICAgICAgICBzY2FsZTogcmVjb2duaXplci5zY2FsZSxcbiAgICAgICAgZ2V0Rm9jdXNYOiBmdW5jdGlvbiAoKSB7IHJldHVybiBjZW50ZXIueDsgfSxcbiAgICAgICAgZ2V0Rm9jdXNZOiBmdW5jdGlvbiAoKSB7IHJldHVybiBjZW50ZXIueTsgfSxcbiAgICAgICAgb2JqZWN0OiBhcmdzLnZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoYXJncy50eXBlKSxcbiAgICAgICAgc3RhdGU6IGdldFN0YXRlKHJlY29nbml6ZXIpXG4gICAgfTtcbn1cbmZ1bmN0aW9uIF9nZXRTd2lwZURhdGEoYXJncykge1xuICAgIHZhciByZWNvZ25pemVyID0gYXJncy5pb3M7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogYXJncy50eXBlLFxuICAgICAgICB2aWV3OiBhcmdzLnZpZXcsXG4gICAgICAgIGlvczogYXJncy5pb3MsXG4gICAgICAgIGFuZHJvaWQ6IHVuZGVmaW5lZCxcbiAgICAgICAgZGlyZWN0aW9uOiBfZ2V0U3dpcGVEaXJlY3Rpb24ocmVjb2duaXplci5kaXJlY3Rpb24pLFxuICAgICAgICBvYmplY3Q6IGFyZ3MudmlldyxcbiAgICAgICAgZXZlbnROYW1lOiBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhhcmdzLnR5cGUpLFxuICAgIH07XG59XG5mdW5jdGlvbiBfZ2V0UGFuRGF0YShhcmdzLCB2aWV3KSB7XG4gICAgdmFyIHJlY29nbml6ZXIgPSBhcmdzLmlvcztcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBhcmdzLnR5cGUsXG4gICAgICAgIHZpZXc6IGFyZ3MudmlldyxcbiAgICAgICAgaW9zOiBhcmdzLmlvcyxcbiAgICAgICAgYW5kcm9pZDogdW5kZWZpbmVkLFxuICAgICAgICBkZWx0YVg6IHJlY29nbml6ZXIudHJhbnNsYXRpb25JblZpZXcodmlldykueCxcbiAgICAgICAgZGVsdGFZOiByZWNvZ25pemVyLnRyYW5zbGF0aW9uSW5WaWV3KHZpZXcpLnksXG4gICAgICAgIG9iamVjdDogYXJncy52aWV3LFxuICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKGFyZ3MudHlwZSksXG4gICAgICAgIHN0YXRlOiBnZXRTdGF0ZShyZWNvZ25pemVyKVxuICAgIH07XG59XG5mdW5jdGlvbiBfZ2V0Um90YXRpb25EYXRhKGFyZ3MpIHtcbiAgICB2YXIgcmVjb2duaXplciA9IGFyZ3MuaW9zO1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IGFyZ3MudHlwZSxcbiAgICAgICAgdmlldzogYXJncy52aWV3LFxuICAgICAgICBpb3M6IGFyZ3MuaW9zLFxuICAgICAgICBhbmRyb2lkOiB1bmRlZmluZWQsXG4gICAgICAgIHJvdGF0aW9uOiByZWNvZ25pemVyLnJvdGF0aW9uICogKDE4MC4wIC8gTWF0aC5QSSksXG4gICAgICAgIG9iamVjdDogYXJncy52aWV3LFxuICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKGFyZ3MudHlwZSksXG4gICAgICAgIHN0YXRlOiBnZXRTdGF0ZShyZWNvZ25pemVyKVxuICAgIH07XG59XG52YXIgVG91Y2hHZXN0dXJlUmVjb2duaXplciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRvdWNoR2VzdHVyZVJlY29nbml6ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVG91Y2hHZXN0dXJlUmVjb2duaXplcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUb3VjaEdlc3R1cmVSZWNvZ25pemVyLnByb3RvdHlwZS50b3VjaGVzQmVnYW5XaXRoRXZlbnQgPSBmdW5jdGlvbiAodG91Y2hlcywgZXZlbnQpIHtcbiAgICAgICAgdGhpcy5leGVjdXRlQ2FsbGJhY2soZ2VzdHVyZXNfY29tbW9uXzEuVG91Y2hBY3Rpb24uZG93biwgdG91Y2hlcywgZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudG91Y2hlc0JlZ2FuV2l0aEV2ZW50KHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlUmVjb2duaXplci5wcm90b3R5cGUudG91Y2hlc01vdmVkV2l0aEV2ZW50ID0gZnVuY3Rpb24gKHRvdWNoZXMsIGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLm1vdmUsIHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnRvdWNoZXNNb3ZlZFdpdGhFdmVudCh0b3VjaGVzLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZVJlY29nbml6ZXIucHJvdG90eXBlLnRvdWNoZXNFbmRlZFdpdGhFdmVudCA9IGZ1bmN0aW9uICh0b3VjaGVzLCBldmVudCkge1xuICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi51cCwgdG91Y2hlcywgZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudG91Y2hlc0VuZGVkV2l0aEV2ZW50KHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlUmVjb2duaXplci5wcm90b3R5cGUudG91Y2hlc0NhbmNlbGxlZFdpdGhFdmVudCA9IGZ1bmN0aW9uICh0b3VjaGVzLCBldmVudCkge1xuICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi5jYW5jZWwsIHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgaWYgKHRoaXMudmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3LnRvdWNoZXNDYW5jZWxsZWRXaXRoRXZlbnQodG91Y2hlcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVSZWNvZ25pemVyLnByb3RvdHlwZS5leGVjdXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYWN0aW9uLCB0b3VjaGVzLCBldmVudCkge1xuICAgICAgICBpZiAoIXRoaXMuX2V2ZW50RGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fZXZlbnREYXRhID0gbmV3IFRvdWNoR2VzdHVyZUV2ZW50RGF0YSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2V2ZW50RGF0YS5wcmVwYXJlKHRoaXMub2JzZXJ2ZXIudGFyZ2V0LCBhY3Rpb24sIHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5fZXhlY3V0ZUNhbGxiYWNrKHRoaXMuX2V2ZW50RGF0YSk7XG4gICAgfTtcbiAgICByZXR1cm4gVG91Y2hHZXN0dXJlUmVjb2duaXplcjtcbn0oVUlHZXN0dXJlUmVjb2duaXplcikpO1xudmFyIFBvaW50ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBvaW50ZXIodG91Y2gsIHRhcmdldFZpZXcpIHtcbiAgICAgICAgdGhpcy5hbmRyb2lkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmlvcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5pb3MgPSB0b3VjaDtcbiAgICAgICAgdGhpcy5fdmlldyA9IHRhcmdldFZpZXc7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQb2ludGVyLnByb3RvdHlwZSwgXCJsb2NhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvY2F0aW9uID0gdGhpcy5pb3MubG9jYXRpb25JblZpZXcodGhpcy5fdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2NhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUG9pbnRlci5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYXRpb24ueDtcbiAgICB9O1xuICAgIFBvaW50ZXIucHJvdG90eXBlLmdldFkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2F0aW9uLnk7XG4gICAgfTtcbiAgICByZXR1cm4gUG9pbnRlcjtcbn0oKSk7XG52YXIgVG91Y2hHZXN0dXJlRXZlbnREYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUb3VjaEdlc3R1cmVFdmVudERhdGEoKSB7XG4gICAgICAgIHRoaXMuZXZlbnROYW1lID0gZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoKTtcbiAgICAgICAgdGhpcy50eXBlID0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoO1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIFRvdWNoR2VzdHVyZUV2ZW50RGF0YS5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uICh2aWV3LCBhY3Rpb24sIHRvdWNoZXMsIGV2ZW50KSB7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB0aGlzLm9iamVjdCA9IHZpZXc7XG4gICAgICAgIHRoaXMuaW9zID0ge1xuICAgICAgICAgICAgdG91Y2hlczogdG91Y2hlcyxcbiAgICAgICAgICAgIGV2ZW50OiBldmVudFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9tYWluUG9pbnRlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fYWN0aXZlUG9pbnRlcnMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2FsbFBvaW50ZXJzID0gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRQb2ludGVyQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlvcy5ldmVudC5hbGxUb3VjaGVzLmNvdW50O1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRNYWluUG9pbnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX21haW5Qb2ludGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX21haW5Qb2ludGVyID0gdGhpcy5pb3MudG91Y2hlcy5hbnlPYmplY3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbWFpblBvaW50ZXI7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEFjdGl2ZVBvaW50ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FjdGl2ZVBvaW50ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLl9hY3RpdmVQb2ludGVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG5zQXJyID0gdGhpcy5pb3MudG91Y2hlcy5hbGxPYmplY3RzOyBpIDwgbnNBcnIuY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVBvaW50ZXJzLnB1c2gobmV3IFBvaW50ZXIobnNBcnIub2JqZWN0QXRJbmRleChpKSwgdGhpcy52aWV3KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGl2ZVBvaW50ZXJzO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRBbGxQb2ludGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9hbGxQb2ludGVycykge1xuICAgICAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMgPSBbXTtcbiAgICAgICAgICAgIHZhciBuc0FyciA9IHRoaXMuaW9zLmV2ZW50LmFsbFRvdWNoZXMuYWxsT2JqZWN0cztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnNBcnIuY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2FsbFBvaW50ZXJzLnB1c2gobmV3IFBvaW50ZXIobnNBcnIub2JqZWN0QXRJbmRleChpKSwgdGhpcy52aWV3KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FsbFBvaW50ZXJzO1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRYID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNYWluUG9pbnRlcigpLmxvY2F0aW9uSW5WaWV3KHRoaXMudmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKS54O1xuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNYWluUG9pbnRlcigpLmxvY2F0aW9uSW5WaWV3KHRoaXMudmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKS55O1xuICAgIH07XG4gICAgcmV0dXJuIFRvdWNoR2VzdHVyZUV2ZW50RGF0YTtcbn0oKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXN0dXJlcy5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgSHRtbFZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSHRtbFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEh0bWxWaWV3QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBIdG1sVmlld0Jhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJIdG1sVmlld1wiKVxuICAgIF0sIEh0bWxWaWV3QmFzZSk7XG4gICAgcmV0dXJuIEh0bWxWaWV3QmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuSHRtbFZpZXdCYXNlID0gSHRtbFZpZXdCYXNlO1xuSHRtbFZpZXdCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5odG1sUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJodG1sXCIsIGRlZmF1bHRWYWx1ZTogXCJcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSB9KTtcbmV4cG9ydHMuaHRtbFByb3BlcnR5LnJlZ2lzdGVyKEh0bWxWaWV3QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odG1sLXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaHRtbF92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaHRtbC12aWV3LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2h0bWwtdmlldy1jb21tb25cIikpO1xudmFyIEh0bWxWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSHRtbFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSHRtbFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgSHRtbFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gVUlUZXh0Vmlldy5uZXcoKTtcbiAgICAgICAgdmlldy5zY3JvbGxFbmFibGVkID0gZmFsc2U7XG4gICAgICAgIHZpZXcuZWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgdmlldy5zZWxlY3RhYmxlID0gdHJ1ZTtcbiAgICAgICAgdmlldy51c2VySW50ZXJhY3Rpb25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdmlldy5kYXRhRGV0ZWN0b3JUeXBlcyA9IC0xO1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIdG1sVmlldy5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBIdG1sVmlldy5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gaHRtbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gaHRtbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gaHRtbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBodG1sX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgZGVzaXJlZFNpemUgPSBodG1sX3ZpZXdfY29tbW9uXzEubGF5b3V0Lm1lYXN1cmVOYXRpdmVWaWV3KG5hdGl2ZVZpZXcsIHdpZHRoLCB3aWR0aE1vZGUsIGhlaWdodCwgaGVpZ2h0TW9kZSk7XG4gICAgICAgICAgICB2YXIgbGFiZWxXaWR0aCA9IHdpZHRoTW9kZSA9PT0gaHRtbF92aWV3X2NvbW1vbl8xLmxheW91dC5BVF9NT1NUID8gTWF0aC5taW4oZGVzaXJlZFNpemUud2lkdGgsIHdpZHRoKSA6IGRlc2lyZWRTaXplLndpZHRoO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KGxhYmVsV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSBNYXRoLm1heChkZXNpcmVkU2l6ZS5oZWlnaHQsIHRoaXMuZWZmZWN0aXZlTWluSGVpZ2h0KTtcbiAgICAgICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gaHRtbF92aWV3X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gaHRtbF92aWV3X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEh0bWxWaWV3LnByb3RvdHlwZVtodG1sX3ZpZXdfY29tbW9uXzEuaHRtbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIEh0bWxWaWV3LnByb3RvdHlwZVtodG1sX3ZpZXdfY29tbW9uXzEuaHRtbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgaHRtbFN0cmluZyA9IE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcodmFsdWUgKyBcIlwiKTtcbiAgICAgICAgdmFyIG5zRGF0YSA9IGh0bWxTdHJpbmcuZGF0YVVzaW5nRW5jb2RpbmcoTlNVbmljb2RlU3RyaW5nRW5jb2RpbmcpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYXR0cmlidXRlZFRleHQgPSBOU0F0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aERhdGFPcHRpb25zRG9jdW1lbnRBdHRyaWJ1dGVzRXJyb3IobnNEYXRhLCAoX2EgPSB7fSwgX2FbTlNEb2N1bWVudFR5cGVEb2N1bWVudEF0dHJpYnV0ZV0gPSBOU0hUTUxUZXh0RG9jdW1lbnRUeXBlLCBfYSksIG51bGwpO1xuICAgIH07XG4gICAgcmV0dXJuIEh0bWxWaWV3O1xufShodG1sX3ZpZXdfY29tbW9uXzEuSHRtbFZpZXdCYXNlKSk7XG5leHBvcnRzLkh0bWxWaWV3ID0gSHRtbFZpZXc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odG1sLXZpZXcuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBpbWFnZV9hc3NldF8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLWFzc2V0XCIpO1xuZXhwb3J0cy5JbWFnZUFzc2V0ID0gaW1hZ2VfYXNzZXRfMS5JbWFnZUFzc2V0O1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbmV4cG9ydHMuSW1hZ2VTb3VyY2UgPSBpbWFnZV9zb3VyY2VfMS5JbWFnZVNvdXJjZTtcbmV4cG9ydHMuZnJvbUFzc2V0ID0gaW1hZ2Vfc291cmNlXzEuZnJvbUFzc2V0O1xuZXhwb3J0cy5mcm9tTmF0aXZlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuZnJvbU5hdGl2ZVNvdXJjZTtcbmV4cG9ydHMuZnJvbVVybCA9IGltYWdlX3NvdXJjZV8xLmZyb21Vcmw7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMuaXNEYXRhVVJJID0gdXRpbHNfMS5pc0RhdGFVUkk7XG5leHBvcnRzLmlzRm9udEljb25VUkkgPSB1dGlsc18xLmlzRm9udEljb25VUkk7XG5leHBvcnRzLmlzRmlsZU9yUmVzb3VyY2VQYXRoID0gdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aDtcbmV4cG9ydHMuUkVTT1VSQ0VfUFJFRklYID0gdXRpbHNfMS5SRVNPVVJDRV9QUkVGSVg7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBJbWFnZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW1hZ2VCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZUJhc2UucHJvdG90eXBlLCBcInRpbnRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGludENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50aW50Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSW1hZ2VCYXNlLnByb3RvdHlwZS5fY3JlYXRlSW1hZ2VTb3VyY2VGcm9tU3JjID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBvcmlnaW5hbFZhbHVlID0gdmFsdWU7XG4gICAgICAgIHZhciBzeW5jID0gdGhpcy5sb2FkTW9kZSA9PT0gXCJzeW5jXCI7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzW1wiX3VybFwiXSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHNvdXJjZV8xID0gbmV3IGltYWdlX3NvdXJjZV8xLkltYWdlU291cmNlKCk7XG4gICAgICAgICAgICB2YXIgaW1hZ2VMb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IF90aGlzLnNyYztcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlICE9PSBvcmlnaW5hbFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSBzb3VyY2VfMTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodXRpbHNfMS5pc0ZvbnRJY29uVVJJKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhciBmb250SWNvbkNvZGUgPSB2YWx1ZS5zcGxpdChcIi8vXCIpWzFdO1xuICAgICAgICAgICAgICAgIGlmIChmb250SWNvbkNvZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm9udCA9IHRoaXMuc3R5bGUuZm9udEludGVybmFsO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3IgPSB0aGlzLnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2VMb2FkZWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh1dGlsc18xLmlzRGF0YVVSSSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZTY0RGF0YSA9IHZhbHVlLnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgICAgICAgICBpZiAoYmFzZTY0RGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUJhc2U2NChiYXNlNjREYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlTG9hZGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5mcm9tQmFzZTY0KGJhc2U2NERhdGEpLnRoZW4oaW1hZ2VMb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc1BhdGggPSB2YWx1ZS5zdWJzdHIodXRpbHNfMS5SRVNPVVJDRV9QUkVGSVgubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN5bmMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV8xLmxvYWRGcm9tUmVzb3VyY2UocmVzUGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUxvYWRlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5mcm9tUmVzb3VyY2UocmVzUGF0aCkudGhlbihpbWFnZUxvYWRlZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzeW5jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VfMS5sb2FkRnJvbUZpbGUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VMb2FkZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlXzEuZnJvbUZpbGUodmFsdWUpLnRoZW4oaW1hZ2VMb2FkZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaW1hZ2Vfc291cmNlXzEuZnJvbVVybCh2YWx1ZSkudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXNbXCJfdXJsXCJdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSByO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVyciA9PT0gXCJvYmplY3RcIiAmJiBlcnIubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IGVyci5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoZXJyLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgaW1hZ2Vfc291cmNlXzEuSW1hZ2VTb3VyY2UpIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBpbWFnZV9hc3NldF8xLkltYWdlQXNzZXQpIHtcbiAgICAgICAgICAgIGltYWdlX3NvdXJjZV8xLmZyb21Bc3NldCh2YWx1ZSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW1hZ2VTb3VyY2UgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBpbWFnZV9zb3VyY2VfMS5mcm9tTmF0aXZlU291cmNlKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEltYWdlQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkltYWdlXCIpXG4gICAgXSwgSW1hZ2VCYXNlKTtcbiAgICByZXR1cm4gSW1hZ2VCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5JbWFnZUJhc2UgPSBJbWFnZUJhc2U7XG5JbWFnZUJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmltYWdlU291cmNlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpbWFnZVNvdXJjZVwiIH0pO1xuZXhwb3J0cy5pbWFnZVNvdXJjZVByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLnNyY1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic3JjXCIgfSk7XG5leHBvcnRzLnNyY1Byb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLmxvYWRNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJsb2FkTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwic3luY1wiIH0pO1xuZXhwb3J0cy5sb2FkTW9kZVByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLmlzTG9hZGluZ1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaXNMb2FkaW5nXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaXNMb2FkaW5nUHJvcGVydHkucmVnaXN0ZXIoSW1hZ2VCYXNlKTtcbmV4cG9ydHMuc3RyZXRjaFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic3RyZXRjaFwiLCBkZWZhdWx0VmFsdWU6IFwiYXNwZWN0Rml0XCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyB9KTtcbmV4cG9ydHMuc3RyZXRjaFByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG5leHBvcnRzLnRpbnRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGludENvbG9yXCIsIGNzc05hbWU6IFwidGludC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHZhbHVlKTsgfSB9KTtcbmV4cG9ydHMudGludENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMuZGVjb2RlSGVpZ2h0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJkZWNvZGVIZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiB7IHZhbHVlOiAwLCB1bml0OiBcImRpcFwiIH0sIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuTGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5kZWNvZGVIZWlnaHRQcm9wZXJ0eS5yZWdpc3RlcihJbWFnZUJhc2UpO1xuZXhwb3J0cy5kZWNvZGVXaWR0aFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZGVjb2RlV2lkdGhcIiwgZGVmYXVsdFZhbHVlOiB7IHZhbHVlOiAwLCB1bml0OiBcImRpcFwiIH0sIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuTGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5kZWNvZGVXaWR0aFByb3BlcnR5LnJlZ2lzdGVyKEltYWdlQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBpbWFnZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ltYWdlLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ltYWdlLWNvbW1vblwiKSk7XG52YXIgSW1hZ2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbWFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJbWFnZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pbWFnZVNvdXJjZUFmZmVjdHNMYXlvdXQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEltYWdlLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW1hZ2VWaWV3ID0gVUlJbWFnZVZpZXcubmV3KCk7XG4gICAgICAgIGltYWdlVmlldy5jb250ZW50TW9kZSA9IDE7XG4gICAgICAgIGltYWdlVmlldy51c2VySW50ZXJhY3Rpb25FbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGltYWdlVmlldztcbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMoKTtcbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZS5zZXRUaW50Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICYmIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pbWFnZSAmJiAhdGhpcy5fdGVtcGxhdGVJbWFnZVdhc0NyZWF0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pbWFnZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5pbWFnZS5pbWFnZVdpdGhSZW5kZXJpbmdNb2RlKDIpO1xuICAgICAgICAgICAgdGhpcy5fdGVtcGxhdGVJbWFnZVdhc0NyZWF0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF2YWx1ZSAmJiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaW1hZ2UgJiYgdGhpcy5fdGVtcGxhdGVJbWFnZVdhc0NyZWF0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3RlbXBsYXRlSW1hZ2VXYXNDcmVhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaW1hZ2UgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaW1hZ2UuaW1hZ2VXaXRoUmVuZGVyaW5nTW9kZSgwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGludENvbG9yID0gdmFsdWUgPyB2YWx1ZS5pb3MgOiBudWxsO1xuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLl9zZXROYXRpdmVJbWFnZSA9IGZ1bmN0aW9uIChuYXRpdmVJbWFnZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaW1hZ2UgPSBuYXRpdmVJbWFnZTtcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVJbWFnZVdhc0NyZWF0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZXRUaW50Q29sb3IodGhpcy5zdHlsZS50aW50Q29sb3IpO1xuICAgICAgICBpZiAodGhpcy5faW1hZ2VTb3VyY2VBZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSW1hZ2UucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jbGlwc1RvQm91bmRzID0gdHJ1ZTtcbiAgICB9O1xuICAgIEltYWdlLnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2VfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGltYWdlX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZV9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBpbWFnZV9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIG5hdGl2ZVdpZHRoID0gdGhpcy5pbWFnZVNvdXJjZSA/IGltYWdlX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyh0aGlzLmltYWdlU291cmNlLndpZHRoKSA6IDA7XG4gICAgICAgIHZhciBuYXRpdmVIZWlnaHQgPSB0aGlzLmltYWdlU291cmNlID8gaW1hZ2VfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHRoaXMuaW1hZ2VTb3VyY2UuaGVpZ2h0KSA6IDA7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChuYXRpdmVXaWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobmF0aXZlSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIHZhciBmaW5pdGVXaWR0aCA9IHdpZHRoTW9kZSAhPT0gaW1hZ2VfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEO1xuICAgICAgICB2YXIgZmluaXRlSGVpZ2h0ID0gaGVpZ2h0TW9kZSAhPT0gaW1hZ2VfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEO1xuICAgICAgICB0aGlzLl9pbWFnZVNvdXJjZUFmZmVjdHNMYXlvdXQgPSB3aWR0aE1vZGUgIT09IGltYWdlX2NvbW1vbl8xLmxheW91dC5FWEFDVExZIHx8IGhlaWdodE1vZGUgIT09IGltYWdlX2NvbW1vbl8xLmxheW91dC5FWEFDVExZO1xuICAgICAgICBpZiAobmF0aXZlV2lkdGggIT09IDAgJiYgbmF0aXZlSGVpZ2h0ICE9PSAwICYmIChmaW5pdGVXaWR0aCB8fCBmaW5pdGVIZWlnaHQpKSB7XG4gICAgICAgICAgICB2YXIgc2NhbGUgPSBJbWFnZS5jb21wdXRlU2NhbGVGYWN0b3Iod2lkdGgsIGhlaWdodCwgZmluaXRlV2lkdGgsIGZpbml0ZUhlaWdodCwgbmF0aXZlV2lkdGgsIG5hdGl2ZUhlaWdodCwgdGhpcy5zdHJldGNoKTtcbiAgICAgICAgICAgIHZhciByZXN1bHRXID0gTWF0aC5yb3VuZChuYXRpdmVXaWR0aCAqIHNjYWxlLndpZHRoKTtcbiAgICAgICAgICAgIHZhciByZXN1bHRIID0gTWF0aC5yb3VuZChuYXRpdmVIZWlnaHQgKiBzY2FsZS5oZWlnaHQpO1xuICAgICAgICAgICAgbWVhc3VyZVdpZHRoID0gZmluaXRlV2lkdGggPyBNYXRoLm1pbihyZXN1bHRXLCB3aWR0aCkgOiByZXN1bHRXO1xuICAgICAgICAgICAgbWVhc3VyZUhlaWdodCA9IGZpbml0ZUhlaWdodCA/IE1hdGgubWluKHJlc3VsdEgsIGhlaWdodCkgOiByZXN1bHRIO1xuICAgICAgICAgICAgaWYgKGltYWdlX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VfY29tbW9uXzEudHJhY2VXcml0ZShcIkltYWdlIHN0cmV0Y2g6IFwiICsgdGhpcy5zdHJldGNoICtcbiAgICAgICAgICAgICAgICAgICAgXCIsIG5hdGl2ZVdpZHRoOiBcIiArIG5hdGl2ZVdpZHRoICtcbiAgICAgICAgICAgICAgICAgICAgXCIsIG5hdGl2ZUhlaWdodDogXCIgKyBuYXRpdmVIZWlnaHQsIGltYWdlX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gSW1hZ2UucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBJbWFnZS5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVIZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgSW1hZ2UuY29tcHV0ZVNjYWxlRmFjdG9yID0gZnVuY3Rpb24gKG1lYXN1cmVXaWR0aCwgbWVhc3VyZUhlaWdodCwgd2lkdGhJc0Zpbml0ZSwgaGVpZ2h0SXNGaW5pdGUsIG5hdGl2ZVdpZHRoLCBuYXRpdmVIZWlnaHQsIGltYWdlU3RyZXRjaCkge1xuICAgICAgICB2YXIgc2NhbGVXID0gMTtcbiAgICAgICAgdmFyIHNjYWxlSCA9IDE7XG4gICAgICAgIGlmICgoaW1hZ2VTdHJldGNoID09PSBcImFzcGVjdEZpbGxcIiB8fCBpbWFnZVN0cmV0Y2ggPT09IFwiYXNwZWN0Rml0XCIgfHwgaW1hZ2VTdHJldGNoID09PSBcImZpbGxcIikgJiZcbiAgICAgICAgICAgICh3aWR0aElzRmluaXRlIHx8IGhlaWdodElzRmluaXRlKSkge1xuICAgICAgICAgICAgc2NhbGVXID0gKG5hdGl2ZVdpZHRoID4gMCkgPyBtZWFzdXJlV2lkdGggLyBuYXRpdmVXaWR0aCA6IDA7XG4gICAgICAgICAgICBzY2FsZUggPSAobmF0aXZlSGVpZ2h0ID4gMCkgPyBtZWFzdXJlSGVpZ2h0IC8gbmF0aXZlSGVpZ2h0IDogMDtcbiAgICAgICAgICAgIGlmICghd2lkdGhJc0Zpbml0ZSkge1xuICAgICAgICAgICAgICAgIHNjYWxlVyA9IHNjYWxlSDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFoZWlnaHRJc0Zpbml0ZSkge1xuICAgICAgICAgICAgICAgIHNjYWxlSCA9IHNjYWxlVztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoaW1hZ2VTdHJldGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhc3BlY3RGaXRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlSCA9IHNjYWxlVyA8IHNjYWxlSCA/IHNjYWxlVyA6IHNjYWxlSDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlVyA9IHNjYWxlSDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXNwZWN0RmlsbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVIID0gc2NhbGVXID4gc2NhbGVIID8gc2NhbGVXIDogc2NhbGVIO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVXID0gc2NhbGVIO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHdpZHRoOiBzY2FsZVcsIGhlaWdodDogc2NhbGVIIH07XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3RyZXRjaFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImFzcGVjdEZpdFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50TW9kZSA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYXNwZWN0RmlsbFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50TW9kZSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZmlsbFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50TW9kZSA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudE1vZGUgPSA5O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEudGludENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldFRpbnRDb2xvcih2YWx1ZSk7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuaW1hZ2VTb3VyY2VQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZUltYWdlKHZhbHVlID8gdmFsdWUuaW9zIDogbnVsbCk7XG4gICAgfTtcbiAgICBJbWFnZS5wcm90b3R5cGVbaW1hZ2VfY29tbW9uXzEuc3JjUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jcmVhdGVJbWFnZVNvdXJjZUZyb21TcmModmFsdWUpO1xuICAgIH07XG4gICAgcmV0dXJuIEltYWdlO1xufShpbWFnZV9jb21tb25fMS5JbWFnZUJhc2UpKTtcbmV4cG9ydHMuSW1hZ2UgPSBJbWFnZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWltYWdlLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGJhY2tncm91bmRfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2JhY2tncm91bmRcIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xudmFyIGJhY2tncm91bmRfMiA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2JhY2tncm91bmRcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBGaXhlZFNpemU7XG4oZnVuY3Rpb24gKEZpeGVkU2l6ZSkge1xuICAgIEZpeGVkU2l6ZVtGaXhlZFNpemVbXCJOT05FXCJdID0gMF0gPSBcIk5PTkVcIjtcbiAgICBGaXhlZFNpemVbRml4ZWRTaXplW1wiV0lEVEhcIl0gPSAxXSA9IFwiV0lEVEhcIjtcbiAgICBGaXhlZFNpemVbRml4ZWRTaXplW1wiSEVJR0hUXCJdID0gMl0gPSBcIkhFSUdIVFwiO1xuICAgIEZpeGVkU2l6ZVtGaXhlZFNpemVbXCJCT1RIXCJdID0gM10gPSBcIkJPVEhcIjtcbn0pKEZpeGVkU2l6ZSB8fCAoRml4ZWRTaXplID0ge30pKTtcbnZhciBMYWJlbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExhYmVsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExhYmVsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExhYmVsLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IFROU0xhYmVsLm5ldygpO1xuICAgICAgICB2aWV3LnVzZXJJbnRlcmFjdGlvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYWJlbC5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExhYmVsLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9PT0gXCJub3JtYWxcIjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWUgPyBcIm5vcm1hbFwiIDogXCJub3dyYXBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGFiZWwucHJvdG90eXBlLl9yZXF1ZXN0TGF5b3V0T25UZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2ZpeGVkU2l6ZSA9PT0gRml4ZWRTaXplLkJPVEgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fZml4ZWRTaXplID09PSBGaXhlZFNpemUuV0lEVEggJiYgIXRoaXMudGV4dFdyYXAgJiYgdGhpcy5nZXRNZWFzdXJlZEhlaWdodCgpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlcXVlc3RMYXlvdXRPblRleHRDaGFuZ2VkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRleHRfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gdGV4dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSB0ZXh0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRNb2RlID0gdGV4dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB0aGlzLl9maXhlZFNpemUgPSAod2lkdGhNb2RlID09PSB0ZXh0X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWSA/IEZpeGVkU2l6ZS5XSURUSCA6IEZpeGVkU2l6ZS5OT05FKVxuICAgICAgICAgICAgICAgIHwgKGhlaWdodE1vZGUgPT09IHRleHRfYmFzZV8xLmxheW91dC5FWEFDVExZID8gRml4ZWRTaXplLkhFSUdIVCA6IEZpeGVkU2l6ZS5OT05FKTtcbiAgICAgICAgICAgIHZhciBuYXRpdmVTaXplID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKHRoaXMudGV4dFdyYXApIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVTaXplID0gdGhpcy5fbWVhc3VyZU5hdGl2ZVZpZXcod2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVNpemUgPSB0ZXh0X2Jhc2VfMS5sYXlvdXQubWVhc3VyZU5hdGl2ZVZpZXcobmF0aXZlVmlldywgd2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBsYWJlbFdpZHRoID0gbmF0aXZlU2l6ZS53aWR0aDtcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRXcmFwICYmIHdpZHRoTW9kZSA9PT0gdGV4dF9iYXNlXzEubGF5b3V0LkFUX01PU1QpIHtcbiAgICAgICAgICAgICAgICBsYWJlbFdpZHRoID0gTWF0aC5taW4obGFiZWxXaWR0aCwgd2lkdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KGxhYmVsV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSBNYXRoLm1heChuYXRpdmVTaXplLmhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSB0ZXh0X2Jhc2VfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IHRleHRfYmFzZV8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZS5fbWVhc3VyZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAod2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIG5hdGl2ZVNpemUgPSB2aWV3LnRleHRSZWN0Rm9yQm91bmRzTGltaXRlZFRvTnVtYmVyT2ZMaW5lcyhDR1JlY3RNYWtlKDAsIDAsIHdpZHRoTW9kZSA9PT0gMCA/IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSA6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHdpZHRoKSwgaGVpZ2h0TW9kZSA9PT0gMCA/IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSA6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGhlaWdodCkpLCAwKS5zaXplO1xuICAgICAgICBuYXRpdmVTaXplLndpZHRoID0gdGV4dF9iYXNlXzEubGF5b3V0LnJvdW5kKHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZVBpeGVscyhuYXRpdmVTaXplLndpZHRoKSk7XG4gICAgICAgIG5hdGl2ZVNpemUuaGVpZ2h0ID0gdGV4dF9iYXNlXzEubGF5b3V0LnJvdW5kKHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZVBpeGVscyhuYXRpdmVTaXplLmhlaWdodCkpO1xuICAgICAgICByZXR1cm4gbmF0aXZlU2l6ZTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS53aGl0ZVNwYWNlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmxpbmVCcmVha01vZGUgPSAwO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubnVtYmVyT2ZMaW5lcyA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm93cmFwXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW5pdGlhbFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGluZUJyZWFrTW9kZSA9IDQ7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5udW1iZXJPZkxpbmVzID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGJhY2tncm91bmRfMS5CYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kXzIuaW9zLmNyZWF0ZUJhY2tncm91bmRVSUNvbG9yKHRoaXMsIGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgICAgIHZhciBjZ0NvbG9yID0gY29sb3IgPyBjb2xvci5DR0NvbG9yIDogbnVsbDtcbiAgICAgICAgICAgICAgICBfdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5sYXllci5iYWNrZ3JvdW5kQ29sb3IgPSBjZ0NvbG9yO1xuICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlQ2xpcFRvQm91bmRzKCk7XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGVbdGV4dF9iYXNlXzEuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCksXG4gICAgICAgICAgICByaWdodDogYm9yZGVyLnJpZ2h0LFxuICAgICAgICAgICAgYm90dG9tOiBib3JkZXIuYm90dG9tLFxuICAgICAgICAgICAgbGVmdDogYm9yZGVyLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBib3JkZXIgPSBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcztcbiAgICAgICAgbmF0aXZlVmlldy5ib3JkZXJUaGlja25lc3MgPSB7XG4gICAgICAgICAgICB0b3A6IGJvcmRlci50b3AsXG4gICAgICAgICAgICByaWdodDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKSxcbiAgICAgICAgICAgIGJvdHRvbTogYm9yZGVyLmJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IGJvcmRlci5sZWZ0XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGVbdGV4dF9iYXNlXzEuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogYm9yZGVyLnRvcCxcbiAgICAgICAgICAgIHJpZ2h0OiBib3JkZXIucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGgpLFxuICAgICAgICAgICAgbGVmdDogYm9yZGVyLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogYm9yZGVyLnRvcCxcbiAgICAgICAgICAgIHJpZ2h0OiBib3JkZXIucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IGJvcmRlci5ib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiB0ZXh0X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBwYWRkaW5nID0gbmF0aXZlVmlldy5wYWRkaW5nO1xuICAgICAgICBuYXRpdmVWaWV3LnBhZGRpbmcgPSB7XG4gICAgICAgICAgICB0b3A6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCksXG4gICAgICAgICAgICByaWdodDogcGFkZGluZy5yaWdodCxcbiAgICAgICAgICAgIGJvdHRvbTogcGFkZGluZy5ib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiBwYWRkaW5nLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBuYXRpdmVWaWV3LnBhZGRpbmc7XG4gICAgICAgIG5hdGl2ZVZpZXcucGFkZGluZyA9IHtcbiAgICAgICAgICAgIHRvcDogcGFkZGluZy50b3AsXG4gICAgICAgICAgICByaWdodDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQpLFxuICAgICAgICAgICAgYm90dG9tOiBwYWRkaW5nLmJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IHBhZGRpbmcubGVmdFxuICAgICAgICB9O1xuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlW3RleHRfYmFzZV8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBuYXRpdmVWaWV3LnBhZGRpbmc7XG4gICAgICAgIG5hdGl2ZVZpZXcucGFkZGluZyA9IHtcbiAgICAgICAgICAgIHRvcDogcGFkZGluZy50b3AsXG4gICAgICAgICAgICByaWdodDogcGFkZGluZy5yaWdodCxcbiAgICAgICAgICAgIGJvdHRvbTogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tKSxcbiAgICAgICAgICAgIGxlZnQ6IHBhZGRpbmcubGVmdFxuICAgICAgICB9O1xuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlW3RleHRfYmFzZV8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBwYWRkaW5nID0gbmF0aXZlVmlldy5wYWRkaW5nO1xuICAgICAgICBuYXRpdmVWaWV3LnBhZGRpbmcgPSB7XG4gICAgICAgICAgICB0b3A6IHBhZGRpbmcudG9wLFxuICAgICAgICAgICAgcmlnaHQ6IHBhZGRpbmcucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IHBhZGRpbmcuYm90dG9tLFxuICAgICAgICAgICAgbGVmdDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHRleHRfYmFzZV8xLkNTU1R5cGUoXCJMYWJlbFwiKVxuICAgIF0sIExhYmVsKTtcbiAgICByZXR1cm4gTGFiZWw7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkxhYmVsID0gTGFiZWw7XG5MYWJlbC5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhYmVsLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIikpO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5lZmZlY3RpdmVMZWZ0ID0gMDtcbmxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUuZWZmZWN0aXZlVG9wID0gMDtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmllZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xufVxudmFyIEFic29sdXRlTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFic29sdXRlTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBYnNvbHV0ZUxheW91dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLmdldExlZnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmxlZnQ7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2Uuc2V0TGVmdCA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkubGVmdCA9IHZhbHVlO1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLmdldFRvcCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkudG9wO1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXRCYXNlLnNldFRvcCA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkudG9wID0gdmFsdWU7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2UucHJvdG90eXBlLm9uTGVmdENoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dEJhc2UucHJvdG90eXBlLm9uVG9wQ2hhbmdlZCA9IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICB9O1xuICAgIEFic29sdXRlTGF5b3V0QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJBYnNvbHV0ZUxheW91dFwiKVxuICAgIF0sIEFic29sdXRlTGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIEFic29sdXRlTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLkFic29sdXRlTGF5b3V0QmFzZSA9IEFic29sdXRlTGF5b3V0QmFzZTtcbkFic29sdXRlTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMubGVmdFByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibGVmdFwiLCBkZWZhdWx0VmFsdWU6IGxheW91dF9iYXNlXzEuemVyb0xlbmd0aCxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQuZWZmZWN0aXZlTGVmdCA9IGxheW91dF9iYXNlXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgdmFyIGxheW91dCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChsYXlvdXQgaW5zdGFuY2VvZiBBYnNvbHV0ZUxheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGxheW91dC5vbkxlZnRDaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbGF5b3V0X2Jhc2VfMS5MZW5ndGgucGFyc2Uodik7IH1cbn0pO1xuZXhwb3J0cy5sZWZ0UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbmV4cG9ydHMudG9wUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ0b3BcIiwgZGVmYXVsdFZhbHVlOiBsYXlvdXRfYmFzZV8xLnplcm9MZW5ndGgsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0LmVmZmVjdGl2ZVRvcCA9IGxheW91dF9iYXNlXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgdmFyIGxheW91dCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIGlmIChsYXlvdXQgaW5zdGFuY2VvZiBBYnNvbHV0ZUxheW91dEJhc2UpIHtcbiAgICAgICAgICAgIGxheW91dC5vblRvcENoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBsYXlvdXRfYmFzZV8xLkxlbmd0aC5wYXJzZSh2KTsgfVxufSk7XG5leHBvcnRzLnRvcFByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hYnNvbHV0ZS1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYWJzb2x1dGUtbGF5b3V0LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2Fic29sdXRlLWxheW91dC1jb21tb25cIikpO1xudmFyIEFic29sdXRlTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQWJzb2x1dGVMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQWJzb2x1dGVMYXlvdXQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQWJzb2x1dGVMYXlvdXQucHJvdG90eXBlLm9uTGVmdENoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgQWJzb2x1dGVMYXlvdXQucHJvdG90eXBlLm9uVG9wQ2hhbmdlZCA9IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dC5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25NZWFzdXJlLmNhbGwodGhpcywgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgbWVhc3VyZVdpZHRoID0gMDtcbiAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSAwO1xuICAgICAgICB2YXIgd2lkdGggPSBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGFic29sdXRlX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGFic29sdXRlX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGNoaWxkTWVhc3VyZVNwZWMgPSBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYygwLCBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEKTtcbiAgICAgICAgdGhpcy5lYWNoTGF5b3V0Q2hpbGQoZnVuY3Rpb24gKGNoaWxkLCBsYXN0KSB7XG4gICAgICAgICAgICB2YXIgY2hpbGRTaXplID0gYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLlZpZXcubWVhc3VyZUNoaWxkKF90aGlzLCBjaGlsZCwgY2hpbGRNZWFzdXJlU3BlYywgY2hpbGRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChtZWFzdXJlV2lkdGgsIGNoaWxkLmVmZmVjdGl2ZUxlZnQgKyBjaGlsZFNpemUubWVhc3VyZWRXaWR0aCk7XG4gICAgICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobWVhc3VyZUhlaWdodCwgY2hpbGQuZWZmZWN0aXZlVG9wICsgY2hpbGRTaXplLm1lYXN1cmVkSGVpZ2h0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1lYXN1cmVXaWR0aCArPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgbWVhc3VyZUhlaWdodCArPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aDtcbiAgICAgICAgbWVhc3VyZVdpZHRoID0gTWF0aC5tYXgobWVhc3VyZVdpZHRoLCB0aGlzLmVmZmVjdGl2ZU1pbldpZHRoKTtcbiAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KG1lYXN1cmVIZWlnaHQsIHRoaXMuZWZmZWN0aXZlTWluSGVpZ2h0KTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IGFic29sdXRlX2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBBYnNvbHV0ZUxheW91dC5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25MYXlvdXQuY2FsbCh0aGlzLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pO1xuICAgICAgICB2YXIgaW5zZXRzID0gdGhpcy5nZXRTYWZlQXJlYUluc2V0cygpO1xuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZFdpZHRoID0gY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpO1xuICAgICAgICAgICAgdmFyIGNoaWxkSGVpZ2h0ID0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKTtcbiAgICAgICAgICAgIHZhciBjaGlsZExlZnQgPSBfdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyBfdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGNoaWxkLmVmZmVjdGl2ZUxlZnQgKyBpbnNldHMubGVmdDtcbiAgICAgICAgICAgIHZhciBjaGlsZFRvcCA9IF90aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgX3RoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGNoaWxkLmVmZmVjdGl2ZVRvcCArIGluc2V0cy50b3A7XG4gICAgICAgICAgICB2YXIgY2hpbGRSaWdodCA9IGNoaWxkTGVmdCArIGNoaWxkV2lkdGggKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICB2YXIgY2hpbGRCb3R0b20gPSBjaGlsZFRvcCArIGNoaWxkSGVpZ2h0ICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luVG9wICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgYWJzb2x1dGVfbGF5b3V0X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQoX3RoaXMsIGNoaWxkLCBjaGlsZExlZnQsIGNoaWxkVG9wLCBjaGlsZFJpZ2h0LCBjaGlsZEJvdHRvbSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEFic29sdXRlTGF5b3V0O1xufShhYnNvbHV0ZV9sYXlvdXRfY29tbW9uXzEuQWJzb2x1dGVMYXlvdXRCYXNlKSk7XG5leHBvcnRzLkFic29sdXRlTGF5b3V0ID0gQWJzb2x1dGVMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hYnNvbHV0ZS1sYXlvdXQuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmllZC5cIik7XG4gICAgfVxuICAgIHJldHVybiBlbGVtZW50O1xufVxuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbnZhciBEb2NrTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKERvY2tMYXlvdXRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERvY2tMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIERvY2tMYXlvdXRCYXNlLmdldERvY2sgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmRvY2s7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0QmFzZS5zZXREb2NrID0gZnVuY3Rpb24gKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyhlbGVtZW50KS5kb2NrID0gdmFsdWU7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0QmFzZS5wcm90b3R5cGUub25Eb2NrQ2hhbmdlZCA9IGZ1bmN0aW9uICh2aWV3LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICB9O1xuICAgIERvY2tMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIkRvY2tMYXlvdXRcIilcbiAgICBdLCBEb2NrTGF5b3V0QmFzZSk7XG4gICAgcmV0dXJuIERvY2tMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuRG9ja0xheW91dEJhc2UgPSBEb2NrTGF5b3V0QmFzZTtcbkRvY2tMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xudmFyIGRvY2tDb252ZXJ0ZXIgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIobGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwibGVmdFwiLCBcInRvcFwiLCBcInJpZ2h0XCIsIFwiYm90dG9tXCIpKTtcbmV4cG9ydHMuZG9ja1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZG9ja1wiLCBkZWZhdWx0VmFsdWU6IFwibGVmdFwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5WaWV3KSB7XG4gICAgICAgICAgICB2YXIgbGF5b3V0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgICAgIGlmIChsYXlvdXQgaW5zdGFuY2VvZiBEb2NrTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgICAgIGxheW91dC5vbkRvY2tDaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBkb2NrQ29udmVydGVyXG59KTtcbmV4cG9ydHMuZG9ja1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnN0cmV0Y2hMYXN0Q2hpbGRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInN0cmV0Y2hMYXN0Q2hpbGRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogbGF5b3V0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuc3RyZXRjaExhc3RDaGlsZFByb3BlcnR5LnJlZ2lzdGVyKERvY2tMYXlvdXRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRvY2stbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGRvY2tfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZG9jay1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZG9jay1sYXlvdXQtY29tbW9uXCIpKTtcbnZhciBEb2NrTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRG9ja0xheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBEb2NrTGF5b3V0KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIERvY2tMYXlvdXQucHJvdG90eXBlLm9uRG9ja0NoYW5nZWQgPSBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgRG9ja0xheW91dC5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25NZWFzdXJlLmNhbGwodGhpcywgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgbWVhc3VyZVdpZHRoID0gMDtcbiAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSAwO1xuICAgICAgICB2YXIgd2lkdGggPSBkb2NrX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGRvY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGRvY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaG9yaXpvbnRhbFBhZGRpbmdzQW5kTWFyZ2lucyA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoO1xuICAgICAgICB2YXIgdmVydGljYWxQYWRkaW5nc0FuZE1hcmdpbnMgPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aDtcbiAgICAgICAgdmFyIHJlbWFpbmluZ1dpZHRoID0gd2lkdGhNb2RlID09PSBkb2NrX2xheW91dF9jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyBOdW1iZXIuTUFYX1ZBTFVFIDogd2lkdGggLSBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICB2YXIgcmVtYWluaW5nSGVpZ2h0ID0gaGVpZ2h0TW9kZSA9PT0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEID8gTnVtYmVyLk1BWF9WQUxVRSA6IGhlaWdodCAtIHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICB2YXIgdGVtcEhlaWdodCA9IDA7XG4gICAgICAgIHZhciB0ZW1wV2lkdGggPSAwO1xuICAgICAgICB2YXIgY2hpbGRXaWR0aE1lYXN1cmVTcGVjO1xuICAgICAgICB2YXIgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYztcbiAgICAgICAgdGhpcy5lYWNoTGF5b3V0Q2hpbGQoZnVuY3Rpb24gKGNoaWxkLCBsYXN0KSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuc3RyZXRjaExhc3RDaGlsZCAmJiBsYXN0KSB7XG4gICAgICAgICAgICAgICAgY2hpbGRXaWR0aE1lYXN1cmVTcGVjID0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZW1haW5pbmdXaWR0aCwgd2lkdGhNb2RlKTtcbiAgICAgICAgICAgICAgICBjaGlsZEhlaWdodE1lYXN1cmVTcGVjID0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZW1haW5pbmdIZWlnaHQsIGhlaWdodE1vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hpbGRXaWR0aE1lYXN1cmVTcGVjID0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZW1haW5pbmdXaWR0aCwgd2lkdGhNb2RlID09PSBkb2NrX2xheW91dF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSA/IGRvY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5BVF9NT1NUIDogd2lkdGhNb2RlKTtcbiAgICAgICAgICAgICAgICBjaGlsZEhlaWdodE1lYXN1cmVTcGVjID0gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZW1haW5pbmdIZWlnaHQsIGhlaWdodE1vZGUgPT09IGRvY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5FWEFDVExZID8gZG9ja19sYXlvdXRfY29tbW9uXzEubGF5b3V0LkFUX01PU1QgOiBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGlsZFNpemUgPSBkb2NrX2xheW91dF9jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZChfdGhpcywgY2hpbGQsIGNoaWxkV2lkdGhNZWFzdXJlU3BlYywgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICBzd2l0Y2ggKGNoaWxkLmRvY2spIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdIZWlnaHQgPSBNYXRoLm1heCgwLCByZW1haW5pbmdIZWlnaHQgLSBjaGlsZFNpemUubWVhc3VyZWRIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wSGVpZ2h0ICs9IGNoaWxkU2l6ZS5tZWFzdXJlZEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgbWVhc3VyZVdpZHRoID0gTWF0aC5tYXgobWVhc3VyZVdpZHRoLCB0ZW1wV2lkdGggKyBjaGlsZFNpemUubWVhc3VyZWRXaWR0aCk7XG4gICAgICAgICAgICAgICAgICAgIG1lYXN1cmVIZWlnaHQgPSBNYXRoLm1heChtZWFzdXJlSGVpZ2h0LCB0ZW1wSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdXaWR0aCA9IE1hdGgubWF4KDAsIHJlbWFpbmluZ1dpZHRoIC0gY2hpbGRTaXplLm1lYXN1cmVkV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wV2lkdGggKz0gY2hpbGRTaXplLm1lYXN1cmVkV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KG1lYXN1cmVXaWR0aCwgdGVtcFdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KG1lYXN1cmVIZWlnaHQsIHRlbXBIZWlnaHQgKyBjaGlsZFNpemUubWVhc3VyZWRIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIG1lYXN1cmVXaWR0aCArPSBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ICs9IHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChtZWFzdXJlV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobWVhc3VyZUhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IGRvY2tfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBkb2NrX2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBEb2NrTGF5b3V0LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHZhciBpbnNldHMgPSB0aGlzLmdldFNhZmVBcmVhSW5zZXRzKCk7XG4gICAgICAgIHZhciBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggKyBpbnNldHMubGVmdCArIGluc2V0cy5yaWdodDtcbiAgICAgICAgdmFyIHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggKyBpbnNldHMudG9wICsgaW5zZXRzLmJvdHRvbTtcbiAgICAgICAgdmFyIGNoaWxkTGVmdCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGluc2V0cy5sZWZ0O1xuICAgICAgICB2YXIgY2hpbGRUb3AgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgaW5zZXRzLnRvcDtcbiAgICAgICAgdmFyIHggPSBjaGlsZExlZnQ7XG4gICAgICAgIHZhciB5ID0gY2hpbGRUb3A7XG4gICAgICAgIHZhciByZW1haW5pbmdXaWR0aCA9IE1hdGgubWF4KDAsIHJpZ2h0IC0gbGVmdCAtIGhvcml6b250YWxQYWRkaW5nc0FuZE1hcmdpbnMpO1xuICAgICAgICB2YXIgcmVtYWluaW5nSGVpZ2h0ID0gTWF0aC5tYXgoMCwgYm90dG9tIC0gdG9wIC0gdmVydGljYWxQYWRkaW5nc0FuZE1hcmdpbnMpO1xuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZFdpZHRoID0gY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luTGVmdCArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICAgICAgdmFyIGNoaWxkSGVpZ2h0ID0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpblRvcCArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgICAgIGlmIChsYXN0ICYmIF90aGlzLnN0cmV0Y2hMYXN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBkb2NrX2xheW91dF9jb21tb25fMS5WaWV3LmxheW91dENoaWxkKF90aGlzLCBjaGlsZCwgeCwgeSwgeCArIHJlbWFpbmluZ1dpZHRoLCB5ICsgcmVtYWluaW5nSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZG9jayA9IERvY2tMYXlvdXQuZ2V0RG9jayhjaGlsZCk7XG4gICAgICAgICAgICBzd2l0Y2ggKGRvY2spIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHg7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wID0geTtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRXaWR0aCA9IHJlbWFpbmluZ1dpZHRoO1xuICAgICAgICAgICAgICAgICAgICB5ICs9IGNoaWxkSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdIZWlnaHQgPSBNYXRoLm1heCgwLCByZW1haW5pbmdIZWlnaHQgLSBjaGlsZEhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0geDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRUb3AgPSB5ICsgcmVtYWluaW5nSGVpZ2h0IC0gY2hpbGRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkV2lkdGggPSByZW1haW5pbmdXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nSGVpZ2h0ID0gTWF0aC5tYXgoMCwgcmVtYWluaW5nSGVpZ2h0IC0gY2hpbGRIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0geCArIHJlbWFpbmluZ1dpZHRoIC0gY2hpbGRXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRUb3AgPSB5O1xuICAgICAgICAgICAgICAgICAgICBjaGlsZEhlaWdodCA9IHJlbWFpbmluZ0hlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nV2lkdGggPSBNYXRoLm1heCgwLCByZW1haW5pbmdXaWR0aCAtIGNoaWxkV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHg7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wID0geTtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRIZWlnaHQgPSByZW1haW5pbmdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIHggKz0gY2hpbGRXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nV2lkdGggPSBNYXRoLm1heCgwLCByZW1haW5pbmdXaWR0aCAtIGNoaWxkV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRvY2tfbGF5b3V0X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQoX3RoaXMsIGNoaWxkLCBjaGlsZExlZnQsIGNoaWxkVG9wLCBjaGlsZExlZnQgKyBjaGlsZFdpZHRoLCBjaGlsZFRvcCArIGNoaWxkSGVpZ2h0KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gRG9ja0xheW91dDtcbn0oZG9ja19sYXlvdXRfY29tbW9uXzEuRG9ja0xheW91dEJhc2UpKTtcbmV4cG9ydHMuRG9ja0xheW91dCA9IERvY2tMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kb2NrLWxheW91dC5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbmV4cG9ydHMuT1JERVJfREVGQVVMVCA9IDE7XG5leHBvcnRzLkZMRVhfR1JPV19ERUZBVUxUID0gMC4wO1xuZXhwb3J0cy5GTEVYX1NIUklOS19ERUZBVUxUID0gMS4wO1xudmFyIEZsZXhEaXJlY3Rpb247XG4oZnVuY3Rpb24gKEZsZXhEaXJlY3Rpb24pIHtcbiAgICBGbGV4RGlyZWN0aW9uLlJPVyA9IFwicm93XCI7XG4gICAgRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRSA9IFwicm93LXJldmVyc2VcIjtcbiAgICBGbGV4RGlyZWN0aW9uLkNPTFVNTiA9IFwiY29sdW1uXCI7XG4gICAgRmxleERpcmVjdGlvbi5DT0xVTU5fUkVWRVJTRSA9IFwiY29sdW1uLXJldmVyc2VcIjtcbiAgICBGbGV4RGlyZWN0aW9uLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoRmxleERpcmVjdGlvbi5ST1csIEZsZXhEaXJlY3Rpb24uUk9XX1JFVkVSU0UsIEZsZXhEaXJlY3Rpb24uQ09MVU1OLCBGbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFKTtcbiAgICBGbGV4RGlyZWN0aW9uLnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEZsZXhEaXJlY3Rpb24uaXNWYWxpZCk7XG59KShGbGV4RGlyZWN0aW9uID0gZXhwb3J0cy5GbGV4RGlyZWN0aW9uIHx8IChleHBvcnRzLkZsZXhEaXJlY3Rpb24gPSB7fSkpO1xudmFyIEZsZXhXcmFwO1xuKGZ1bmN0aW9uIChGbGV4V3JhcCkge1xuICAgIEZsZXhXcmFwLk5PV1JBUCA9IFwibm93cmFwXCI7XG4gICAgRmxleFdyYXAuV1JBUCA9IFwid3JhcFwiO1xuICAgIEZsZXhXcmFwLldSQVBfUkVWRVJTRSA9IFwid3JhcC1yZXZlcnNlXCI7XG4gICAgRmxleFdyYXAuaXNWYWxpZCA9IGxheW91dF9iYXNlXzEubWFrZVZhbGlkYXRvcihGbGV4V3JhcC5OT1dSQVAsIEZsZXhXcmFwLldSQVAsIEZsZXhXcmFwLldSQVBfUkVWRVJTRSk7XG4gICAgRmxleFdyYXAucGFyc2UgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIoRmxleFdyYXAuaXNWYWxpZCk7XG59KShGbGV4V3JhcCA9IGV4cG9ydHMuRmxleFdyYXAgfHwgKGV4cG9ydHMuRmxleFdyYXAgPSB7fSkpO1xudmFyIEp1c3RpZnlDb250ZW50O1xuKGZ1bmN0aW9uIChKdXN0aWZ5Q29udGVudCkge1xuICAgIEp1c3RpZnlDb250ZW50LkZMRVhfU1RBUlQgPSBcImZsZXgtc3RhcnRcIjtcbiAgICBKdXN0aWZ5Q29udGVudC5GTEVYX0VORCA9IFwiZmxleC1lbmRcIjtcbiAgICBKdXN0aWZ5Q29udGVudC5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEp1c3RpZnlDb250ZW50LlNQQUNFX0JFVFdFRU4gPSBcInNwYWNlLWJldHdlZW5cIjtcbiAgICBKdXN0aWZ5Q29udGVudC5TUEFDRV9BUk9VTkQgPSBcInNwYWNlLWFyb3VuZFwiO1xuICAgIEp1c3RpZnlDb250ZW50LmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoSnVzdGlmeUNvbnRlbnQuRkxFWF9TVEFSVCwgSnVzdGlmeUNvbnRlbnQuRkxFWF9FTkQsIEp1c3RpZnlDb250ZW50LkNFTlRFUiwgSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQkVUV0VFTiwgSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQVJPVU5EKTtcbiAgICBKdXN0aWZ5Q29udGVudC5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihKdXN0aWZ5Q29udGVudC5pc1ZhbGlkKTtcbn0pKEp1c3RpZnlDb250ZW50ID0gZXhwb3J0cy5KdXN0aWZ5Q29udGVudCB8fCAoZXhwb3J0cy5KdXN0aWZ5Q29udGVudCA9IHt9KSk7XG52YXIgRmxleEJhc2lzUGVyY2VudDtcbihmdW5jdGlvbiAoRmxleEJhc2lzUGVyY2VudCkge1xuICAgIEZsZXhCYXNpc1BlcmNlbnQuREVGQVVMVCA9IC0xO1xufSkoRmxleEJhc2lzUGVyY2VudCA9IGV4cG9ydHMuRmxleEJhc2lzUGVyY2VudCB8fCAoZXhwb3J0cy5GbGV4QmFzaXNQZXJjZW50ID0ge30pKTtcbnZhciBBbGlnbkl0ZW1zO1xuKGZ1bmN0aW9uIChBbGlnbkl0ZW1zKSB7XG4gICAgQWxpZ25JdGVtcy5GTEVYX1NUQVJUID0gXCJmbGV4LXN0YXJ0XCI7XG4gICAgQWxpZ25JdGVtcy5GTEVYX0VORCA9IFwiZmxleC1lbmRcIjtcbiAgICBBbGlnbkl0ZW1zLkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgQWxpZ25JdGVtcy5CQVNFTElORSA9IFwiYmFzZWxpbmVcIjtcbiAgICBBbGlnbkl0ZW1zLlNUUkVUQ0ggPSBcInN0cmV0Y2hcIjtcbiAgICBBbGlnbkl0ZW1zLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoQWxpZ25JdGVtcy5GTEVYX1NUQVJULCBBbGlnbkl0ZW1zLkZMRVhfRU5ELCBBbGlnbkl0ZW1zLkNFTlRFUiwgQWxpZ25JdGVtcy5CQVNFTElORSwgQWxpZ25JdGVtcy5TVFJFVENIKTtcbiAgICBBbGlnbkl0ZW1zLnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEFsaWduSXRlbXMuaXNWYWxpZCk7XG59KShBbGlnbkl0ZW1zID0gZXhwb3J0cy5BbGlnbkl0ZW1zIHx8IChleHBvcnRzLkFsaWduSXRlbXMgPSB7fSkpO1xudmFyIEFsaWduQ29udGVudDtcbihmdW5jdGlvbiAoQWxpZ25Db250ZW50KSB7XG4gICAgQWxpZ25Db250ZW50LkZMRVhfU1RBUlQgPSBcImZsZXgtc3RhcnRcIjtcbiAgICBBbGlnbkNvbnRlbnQuRkxFWF9FTkQgPSBcImZsZXgtZW5kXCI7XG4gICAgQWxpZ25Db250ZW50LkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgQWxpZ25Db250ZW50LlNQQUNFX0JFVFdFRU4gPSBcInNwYWNlLWJldHdlZW5cIjtcbiAgICBBbGlnbkNvbnRlbnQuU1BBQ0VfQVJPVU5EID0gXCJzcGFjZS1hcm91bmRcIjtcbiAgICBBbGlnbkNvbnRlbnQuU1RSRVRDSCA9IFwic3RyZXRjaFwiO1xuICAgIEFsaWduQ29udGVudC5pc1ZhbGlkID0gbGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKEFsaWduQ29udGVudC5GTEVYX1NUQVJULCBBbGlnbkNvbnRlbnQuRkxFWF9FTkQsIEFsaWduQ29udGVudC5DRU5URVIsIEFsaWduQ29udGVudC5TUEFDRV9CRVRXRUVOLCBBbGlnbkNvbnRlbnQuU1BBQ0VfQVJPVU5ELCBBbGlnbkNvbnRlbnQuU1RSRVRDSCk7XG4gICAgQWxpZ25Db250ZW50LnBhcnNlID0gbGF5b3V0X2Jhc2VfMS5tYWtlUGFyc2VyKEFsaWduQ29udGVudC5pc1ZhbGlkKTtcbn0pKEFsaWduQ29udGVudCA9IGV4cG9ydHMuQWxpZ25Db250ZW50IHx8IChleHBvcnRzLkFsaWduQ29udGVudCA9IHt9KSk7XG52YXIgT3JkZXI7XG4oZnVuY3Rpb24gKE9yZGVyKSB7XG4gICAgZnVuY3Rpb24gaXNWYWxpZCh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaXNGaW5pdGUocGFyc2VJbnQodmFsdWUpKTtcbiAgICB9XG4gICAgT3JkZXIuaXNWYWxpZCA9IGlzVmFsaWQ7XG4gICAgT3JkZXIucGFyc2UgPSBwYXJzZUludDtcbn0pKE9yZGVyID0gZXhwb3J0cy5PcmRlciB8fCAoZXhwb3J0cy5PcmRlciA9IHt9KSk7XG52YXIgRmxleEdyb3c7XG4oZnVuY3Rpb24gKEZsZXhHcm93KSB7XG4gICAgZnVuY3Rpb24gaXNWYWxpZCh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyc2VkID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICByZXR1cm4gaXNGaW5pdGUocGFyc2VkKSAmJiB2YWx1ZSA+PSAwO1xuICAgIH1cbiAgICBGbGV4R3Jvdy5pc1ZhbGlkID0gaXNWYWxpZDtcbiAgICBGbGV4R3Jvdy5wYXJzZSA9IHBhcnNlRmxvYXQ7XG59KShGbGV4R3JvdyA9IGV4cG9ydHMuRmxleEdyb3cgfHwgKGV4cG9ydHMuRmxleEdyb3cgPSB7fSkpO1xudmFyIEZsZXhTaHJpbms7XG4oZnVuY3Rpb24gKEZsZXhTaHJpbmspIHtcbiAgICBmdW5jdGlvbiBpc1ZhbGlkKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJzZWQgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBpc0Zpbml0ZShwYXJzZWQpICYmIHZhbHVlID49IDA7XG4gICAgfVxuICAgIEZsZXhTaHJpbmsuaXNWYWxpZCA9IGlzVmFsaWQ7XG4gICAgRmxleFNocmluay5wYXJzZSA9IHBhcnNlRmxvYXQ7XG59KShGbGV4U2hyaW5rID0gZXhwb3J0cy5GbGV4U2hyaW5rIHx8IChleHBvcnRzLkZsZXhTaHJpbmsgPSB7fSkpO1xudmFyIEZsZXhXcmFwQmVmb3JlO1xuKGZ1bmN0aW9uIChGbGV4V3JhcEJlZm9yZSkge1xuICAgIGZ1bmN0aW9uIGlzVmFsaWQodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHIgPSB2YWx1ZS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHJldHVybiBzdHIgPT09IFwidHJ1ZVwiIHx8IHN0ciA9PT0gXCJmYWxzZVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgRmxleFdyYXBCZWZvcmUuaXNWYWxpZCA9IGlzVmFsaWQ7XG4gICAgZnVuY3Rpb24gcGFyc2UodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHZhbHVlLnRvU3RyaW5nKCkudHJpbSgpLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiO1xuICAgIH1cbiAgICBGbGV4V3JhcEJlZm9yZS5wYXJzZSA9IHBhcnNlO1xufSkoRmxleFdyYXBCZWZvcmUgPSBleHBvcnRzLkZsZXhXcmFwQmVmb3JlIHx8IChleHBvcnRzLkZsZXhXcmFwQmVmb3JlID0ge30pKTtcbnZhciBBbGlnblNlbGY7XG4oZnVuY3Rpb24gKEFsaWduU2VsZikge1xuICAgIEFsaWduU2VsZi5BVVRPID0gXCJhdXRvXCI7XG4gICAgQWxpZ25TZWxmLkZMRVhfU1RBUlQgPSBcImZsZXgtc3RhcnRcIjtcbiAgICBBbGlnblNlbGYuRkxFWF9FTkQgPSBcImZsZXgtZW5kXCI7XG4gICAgQWxpZ25TZWxmLkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgQWxpZ25TZWxmLkJBU0VMSU5FID0gXCJiYXNlbGluZVwiO1xuICAgIEFsaWduU2VsZi5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgQWxpZ25TZWxmLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoQWxpZ25TZWxmLkFVVE8sIEFsaWduU2VsZi5GTEVYX1NUQVJULCBBbGlnblNlbGYuRkxFWF9FTkQsIEFsaWduU2VsZi5DRU5URVIsIEFsaWduU2VsZi5CQVNFTElORSwgQWxpZ25TZWxmLlNUUkVUQ0gpO1xuICAgIEFsaWduU2VsZi5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihBbGlnblNlbGYuaXNWYWxpZCk7XG59KShBbGlnblNlbGYgPSBleHBvcnRzLkFsaWduU2VsZiB8fCAoZXhwb3J0cy5BbGlnblNlbGYgPSB7fSkpO1xuZnVuY3Rpb24gdmFsaWRhdGVBcmdzKGVsZW1lbnQpIHtcbiAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZWxlbWVudCBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluaWVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59XG52YXIgRmxleGJveExheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGbGV4Ym94TGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGbGV4Ym94TGF5b3V0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLCBcImZsZXhEaXJlY3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZsZXhEaXJlY3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZsZXhEaXJlY3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJmbGV4V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZmxleFdyYXA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZsZXhXcmFwID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4Ym94TGF5b3V0QmFzZS5wcm90b3R5cGUsIFwianVzdGlmeUNvbnRlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmp1c3RpZnlDb250ZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5qdXN0aWZ5Q29udGVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLCBcImFsaWduSXRlbXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFsaWduSXRlbXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFsaWduSXRlbXMgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhib3hMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJhbGlnbkNvbnRlbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFsaWduQ29udGVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYWxpZ25Db250ZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLnNldE9yZGVyID0gZnVuY3Rpb24gKHZpZXcsIG9yZGVyKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5vcmRlciA9IG9yZGVyO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UuZ2V0T3JkZXIgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLm9yZGVyO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2Uuc2V0RmxleEdyb3cgPSBmdW5jdGlvbiAodmlldywgZ3Jvdykge1xuICAgICAgICB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleEdyb3cgPSBncm93O1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UuZ2V0RmxleEdyb3cgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhHcm93O1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2Uuc2V0RmxleFNocmluayA9IGZ1bmN0aW9uICh2aWV3LCBzaHJpbmspIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhTaHJpbmsgPSBzaHJpbms7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0QmFzZS5nZXRGbGV4U2hyaW5rID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5mbGV4U2hyaW5rO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2Uuc2V0QWxpZ25TZWxmID0gZnVuY3Rpb24gKHZpZXcsIGFsaWduKSB7XG4gICAgICAgIHZhbGlkYXRlQXJncyh2aWV3KS5zdHlsZS5hbGlnblNlbGYgPSBhbGlnbjtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXRCYXNlLmdldEFsaWduU2VsZiA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuYWxpZ25TZWxmO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2Uuc2V0RmxleFdyYXBCZWZvcmUgPSBmdW5jdGlvbiAodmlldywgd3JhcCkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3Modmlldykuc3R5bGUuZmxleFdyYXBCZWZvcmUgPSB3cmFwO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UuZ2V0RmxleFdyYXBCZWZvcmUgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKHZpZXcpLnN0eWxlLmZsZXhXcmFwQmVmb3JlO1xuICAgIH07XG4gICAgRmxleGJveExheW91dEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgbGF5b3V0X2Jhc2VfMS5DU1NUeXBlKFwiRmxleGJveExheW91dFwiKVxuICAgIF0sIEZsZXhib3hMYXlvdXRCYXNlKTtcbiAgICByZXR1cm4gRmxleGJveExheW91dEJhc2U7XG59KGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5GbGV4Ym94TGF5b3V0QmFzZSA9IEZsZXhib3hMYXlvdXRCYXNlO1xuRmxleGJveExheW91dEJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJmbGV4RGlyZWN0aW9uXCIsIGNzc05hbWU6IFwiZmxleC1kaXJlY3Rpb25cIiwgZGVmYXVsdFZhbHVlOiBGbGV4RGlyZWN0aW9uLlJPVywgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IEZsZXhEaXJlY3Rpb24ucGFyc2UgfSk7XG5leHBvcnRzLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbmV4cG9ydHMuZmxleFdyYXBQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJmbGV4V3JhcFwiLCBjc3NOYW1lOiBcImZsZXgtd3JhcFwiLCBkZWZhdWx0VmFsdWU6IFwibm93cmFwXCIsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBGbGV4V3JhcC5wYXJzZSB9KTtcbmV4cG9ydHMuZmxleFdyYXBQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbmV4cG9ydHMuanVzdGlmeUNvbnRlbnRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJqdXN0aWZ5Q29udGVudFwiLCBjc3NOYW1lOiBcImp1c3RpZnktY29udGVudFwiLCBkZWZhdWx0VmFsdWU6IEp1c3RpZnlDb250ZW50LkZMRVhfU1RBUlQsIGFmZmVjdHNMYXlvdXQ6IGxheW91dF9iYXNlXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBKdXN0aWZ5Q29udGVudC5wYXJzZSB9KTtcbmV4cG9ydHMuanVzdGlmeUNvbnRlbnRQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbmV4cG9ydHMuYWxpZ25JdGVtc1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFsaWduSXRlbXNcIiwgY3NzTmFtZTogXCJhbGlnbi1pdGVtc1wiLCBkZWZhdWx0VmFsdWU6IEFsaWduSXRlbXMuU1RSRVRDSCwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IEFsaWduSXRlbXMucGFyc2UgfSk7XG5leHBvcnRzLmFsaWduSXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbmV4cG9ydHMuYWxpZ25Db250ZW50UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYWxpZ25Db250ZW50XCIsIGNzc05hbWU6IFwiYWxpZ24tY29udGVudFwiLCBkZWZhdWx0VmFsdWU6IEFsaWduQ29udGVudC5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogQWxpZ25Db250ZW50LnBhcnNlIH0pO1xuZXhwb3J0cy5hbGlnbkNvbnRlbnRQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbmV4cG9ydHMub3JkZXJQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJvcmRlclwiLCBjc3NOYW1lOiBcIm9yZGVyXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy5PUkRFUl9ERUZBVUxULCB2YWx1ZUNvbnZlcnRlcjogT3JkZXIucGFyc2UgfSk7XG5leHBvcnRzLm9yZGVyUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJvcmRlclwiLCB7XG4gICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm9yZGVyO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdHlsZS5vcmRlciA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbn0pO1xuZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZsZXhHcm93XCIsIGNzc05hbWU6IFwiZmxleC1ncm93XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy5GTEVYX0dST1dfREVGQVVMVCwgdmFsdWVDb252ZXJ0ZXI6IEZsZXhHcm93LnBhcnNlIH0pO1xuZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGxheW91dF9iYXNlXzEuVmlldy5wcm90b3R5cGUsIFwiZmxleEdyb3dcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mbGV4R3JvdztcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGUuZmxleEdyb3cgPSB2YWx1ZTtcbiAgICB9LFxuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgY29uZmlndXJhYmxlOiB0cnVlXG59KTtcbmV4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZsZXhTaHJpbmtcIiwgY3NzTmFtZTogXCJmbGV4LXNocmlua1wiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuRkxFWF9TSFJJTktfREVGQVVMVCwgdmFsdWVDb252ZXJ0ZXI6IEZsZXhTaHJpbmsucGFyc2UgfSk7XG5leHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImZsZXhTaHJpbmtcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mbGV4U2hyaW5rO1xuICAgIH0sXG4gICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zdHlsZS5mbGV4U2hyaW5rID0gdmFsdWU7XG4gICAgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5leHBvcnRzLmZsZXhXcmFwQmVmb3JlUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZmxleFdyYXBCZWZvcmVcIiwgY3NzTmFtZTogXCJmbGV4LXdyYXAtYmVmb3JlXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiBGbGV4V3JhcEJlZm9yZS5wYXJzZSB9KTtcbmV4cG9ydHMuZmxleFdyYXBCZWZvcmVQcm9wZXJ0eS5yZWdpc3RlcihsYXlvdXRfYmFzZV8xLlN0eWxlKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShsYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLCBcImZsZXhXcmFwQmVmb3JlXCIsIHtcbiAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZmxleFdyYXBCZWZvcmU7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0eWxlLmZsZXhXcmFwQmVmb3JlID0gdmFsdWU7XG4gICAgfSxcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5leHBvcnRzLmFsaWduU2VsZlByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFsaWduU2VsZlwiLCBjc3NOYW1lOiBcImFsaWduLXNlbGZcIiwgZGVmYXVsdFZhbHVlOiBBbGlnblNlbGYuQVVUTywgdmFsdWVDb252ZXJ0ZXI6IEFsaWduU2VsZi5wYXJzZSB9KTtcbmV4cG9ydHMuYWxpZ25TZWxmUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkobGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZSwgXCJhbGlnblNlbGZcIiwge1xuICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbGlnblNlbGY7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnN0eWxlLmFsaWduU2VsZiA9IHZhbHVlO1xuICAgIH0sXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBjb25maWd1cmFibGU6IHRydWVcbn0pO1xudmFyIGZsZXhGbG93UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmbGV4Rmxvd1wiLCBjc3NOYW1lOiBcImZsZXgtZmxvd1wiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mbGV4RGlyZWN0aW9uICsgXCIgXCIgKyB0aGlzLmZsZXhXcmFwO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBbXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSBsYXlvdXRfYmFzZV8xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4RGlyZWN0aW9uUHJvcGVydHksIHZhbHVlXSk7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFdyYXBQcm9wZXJ0eSwgdmFsdWVdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciB0cmltbWVkID0gdmFsdWUgJiYgdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgaWYgKHRyaW1tZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVzID0gdHJpbW1lZC5zcGxpdCgvXFxzKy8pO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID49IDEgJiYgRmxleERpcmVjdGlvbi5pc1ZhbGlkKHZhbHVlc1swXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhEaXJlY3Rpb25Qcm9wZXJ0eSwgRmxleERpcmVjdGlvbi5wYXJzZSh2YWx1ZXNbMF0pXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPj0gMiAmJiBGbGV4V3JhcC5pc1ZhbGlkKHZhbHVlc1sxXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhXcmFwUHJvcGVydHksIEZsZXhXcmFwLnBhcnNlKHZhbHVlc1sxXSldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gICAgfVxufSk7XG5mbGV4Rmxvd1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuU3R5bGUpO1xudmFyIGZsZXhQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImZsZXhcIiwgY3NzTmFtZTogXCJmbGV4XCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZsZXhHcm93ICsgXCIgXCIgKyB0aGlzLmZsZXhTaHJpbms7XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IFtdO1xuICAgICAgICBpZiAodmFsdWUgPT09IGxheW91dF9iYXNlXzEudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIHZhbHVlXSk7XG4gICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCB2YWx1ZV0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRyaW1tZWQgPSB2YWx1ZSAmJiB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAodHJpbW1lZCkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0cmltbWVkLnNwbGl0KC9cXHMrLyk7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh2YWx1ZXNbMF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJpbml0YWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhdXRvXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhHcm93UHJvcGVydHksIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleFNocmlua1Byb3BlcnR5LCAxXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCAwXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoRmxleEdyb3cuaXNWYWxpZCh2YWx1ZXNbMF0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4R3Jvd1Byb3BlcnR5LCBGbGV4R3Jvdy5wYXJzZSh2YWx1ZXNbMF0pXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbZXhwb3J0cy5mbGV4U2hyaW5rUHJvcGVydHksIDFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPj0gMikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoRmxleEdyb3cuaXNWYWxpZCh2YWx1ZXNbMF0pICYmIEZsZXhTaHJpbmsuaXNWYWxpZCh2YWx1ZXNbMV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLnB1c2goW2V4cG9ydHMuZmxleEdyb3dQcm9wZXJ0eSwgRmxleEdyb3cucGFyc2UodmFsdWVzWzBdKV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKFtleHBvcnRzLmZsZXhTaHJpbmtQcm9wZXJ0eSwgRmxleFNocmluay5wYXJzZSh2YWx1ZXNbMV0pXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7XG4gICAgfVxufSk7XG5mbGV4UHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5TdHlsZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mbGV4Ym94LWxheW91dC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmbGV4Ym94X2xheW91dF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZsZXhib3gtbGF5b3V0LWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ZsZXhib3gtbGF5b3V0LWNvbW1vblwiKSk7XG52YXIgRVhBQ1RMWSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5FWEFDVExZO1xudmFyIEFUX01PU1QgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5sYXlvdXQuQVRfTU9TVDtcbnZhciBVTlNQRUNJRklFRCA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRDtcbnZhciBNRUFTVVJFRF9TSVpFX01BU0sgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5sYXlvdXQuTUVBU1VSRURfU0laRV9NQVNLO1xudmFyIE1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTCA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9UT09fU01BTEw7XG5mdW5jdGlvbiByZXF1ZXN0RmxleGJveExheW91dCh2YWx1ZSkge1xuICAgIHZhciBmbGV4Ym94ID0gdGhpcy5wYXJlbnQ7XG4gICAgaWYgKGZsZXhib3ggaW5zdGFuY2VvZiBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4Ym94TGF5b3V0QmFzZSkge1xuICAgICAgICBmbGV4Ym94LnJlcXVlc3RMYXlvdXQoKTtcbiAgICB9XG59XG5mbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnByb3RvdHlwZVtmbGV4Ym94X2xheW91dF9jb21tb25fMS5vcmRlclByb3BlcnR5LnNldE5hdGl2ZV0gPSByZXF1ZXN0RmxleGJveExheW91dDtcbmZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhHcm93UHJvcGVydHkuc2V0TmF0aXZlXSA9IHJlcXVlc3RGbGV4Ym94TGF5b3V0O1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuZmxleFNocmlua1Byb3BlcnR5LnNldE5hdGl2ZV0gPSByZXF1ZXN0RmxleGJveExheW91dDtcbmZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucHJvdG90eXBlW2ZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmZsZXhXcmFwQmVmb3JlUHJvcGVydHkuc2V0TmF0aXZlXSA9IHJlcXVlc3RGbGV4Ym94TGF5b3V0O1xuZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5wcm90b3R5cGVbZmxleGJveF9sYXlvdXRfY29tbW9uXzEuYWxpZ25TZWxmUHJvcGVydHkuc2V0TmF0aXZlXSA9IHJlcXVlc3RGbGV4Ym94TGF5b3V0O1xudmFyIE1BVENIX1BBUkVOVCA9IC0xO1xudmFyIFdSQVBfQ09OVEVOVCA9IC0yO1xudmFyIFZpZXdfc1VzZVplcm9VbnNwZWNpZmllZE1lYXN1cmVTcGVjID0gdHJ1ZTtcbnZhciBNQVhfU0laRSA9IDB4MDBGRkZGRkYgJiBNRUFTVVJFRF9TSVpFX01BU0s7XG52YXIgbWFrZU1lYXN1cmVTcGVjID0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYztcbnZhciBnZXRNZWFzdXJlU3BlY01vZGUgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlO1xudmFyIGdldE1lYXN1cmVTcGVjU2l6ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemU7XG52YXIgTWVhc3VyZUNvbnRleHQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lYXN1cmVDb250ZXh0KG93bmVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgICAgICB0aGlzLm93bmVyLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIF90aGlzLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lYXN1cmVDb250ZXh0LnByb3RvdHlwZSwgXCJjaGlsZHJlbkNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE1lYXN1cmVDb250ZXh0LnByb3RvdHlwZS5jaGlsZEF0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuW2luZGV4XTtcbiAgICB9O1xuICAgIHJldHVybiBNZWFzdXJlQ29udGV4dDtcbn0oKSk7XG52YXIgRmxleExpbmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZsZXhMaW5lKCkge1xuICAgICAgICB0aGlzLl9sZWZ0ID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgICAgdGhpcy5fdG9wID0gTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAgICAgdGhpcy5fcmlnaHQgPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgICB0aGlzLl9ib3R0b20gPSBOdW1iZXIuTUFYX1ZBTFVFO1xuICAgICAgICB0aGlzLl9tYWluU2l6ZSA9IDA7XG4gICAgICAgIHRoaXMuX2RpdmlkZXJMZW5ndGhJbk1haW5TaXplID0gMDtcbiAgICAgICAgdGhpcy5fY3Jvc3NTaXplID0gMDtcbiAgICAgICAgdGhpcy5faXRlbUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5fdG90YWxGbGV4R3JvdyA9IDA7XG4gICAgICAgIHRoaXMuX3RvdGFsRmxleFNocmluayA9IDA7XG4gICAgICAgIHRoaXMuX21heEJhc2VsaW5lID0gMDtcbiAgICAgICAgdGhpcy5faW5kaWNlc0FsaWduU2VsZlN0cmV0Y2ggPSBbXTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhMaW5lLnByb3RvdHlwZSwgXCJsZWZ0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9sZWZ0OyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleExpbmUucHJvdG90eXBlLCBcInRvcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fdG9wOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleExpbmUucHJvdG90eXBlLCBcInJpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9yaWdodDsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhMaW5lLnByb3RvdHlwZSwgXCJib3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2JvdHRvbTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhMaW5lLnByb3RvdHlwZSwgXCJtYWluU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fbWFpblNpemU7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4TGluZS5wcm90b3R5cGUsIFwiY3Jvc3NTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9jcm9zc1NpemU7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4TGluZS5wcm90b3R5cGUsIFwiaXRlbUNvdW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9pdGVtQ291bnQ7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbGV4TGluZS5wcm90b3R5cGUsIFwidG90YWxGbGV4R3Jvd1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fdG90YWxGbGV4R3JvdzsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZsZXhMaW5lLnByb3RvdHlwZSwgXCJ0b3RhbEZsZXhTaHJpbmtcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3RvdGFsRmxleFNocmluazsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEZsZXhMaW5lO1xufSgpKTtcbnZhciBPcmRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gT3JkZXIoKSB7XG4gICAgfVxuICAgIE9yZGVyLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAoYW5vdGhlcikge1xuICAgICAgICBpZiAodGhpcy5vcmRlciAhPT0gYW5vdGhlci5vcmRlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3JkZXIgLSBhbm90aGVyLm9yZGVyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4IC0gYW5vdGhlci5pbmRleDtcbiAgICB9O1xuICAgIHJldHVybiBPcmRlcjtcbn0oKSk7XG52YXIgRmxleGJveExheW91dCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZsZXhib3hMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmxleGJveExheW91dCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9mbGV4TGluZXMgPSBbXTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdGhpcy5tZWFzdXJlQ29udGV4dCA9IG5ldyBNZWFzdXJlQ29udGV4dCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzT3JkZXJDaGFuZ2VkRnJvbUxhc3RNZWFzdXJlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fcmVvcmRlcmVkSW5kaWNlcyA9IHRoaXMuX2NyZWF0ZVJlb3JkZXJlZEluZGljZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2NoaWxkcmVuRnJvemVuIHx8IHRoaXMuX2NoaWxkcmVuRnJvemVuLmxlbmd0aCA8IHRoaXMubWVhc3VyZUNvbnRleHQuY2hpbGRyZW5Db3VudCkge1xuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW5Gcm96ZW4gPSBuZXcgQXJyYXkodGhpcy5tZWFzdXJlQ29udGV4dC5jaGlsZHJlbkNvdW50KTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHRoaXMuZmxleERpcmVjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPVzpcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRTpcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWFzdXJlSG9yaXpvbnRhbCh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OOlxuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFOlxuICAgICAgICAgICAgICAgIHRoaXMuX21lYXN1cmVWZXJ0aWNhbCh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIHRoZSBmbGV4IGRpcmVjdGlvbiBpcyBzZXQ6IFwiICsgdGhpcy5mbGV4RGlyZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jaGlsZHJlbkZyb3plbi5sZW5ndGggPSAwO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX2dldFJlb3JkZXJlZENoaWxkQXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIGNoaWxkO1xuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuX3Jlb3JkZXJlZEluZGljZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjaGlsZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcmVvcmRlcmVkSW5kZXggPSB0aGlzLl9yZW9yZGVyZWRJbmRpY2VzW2luZGV4XTtcbiAgICAgICAgICAgIGNoaWxkID0gdGhpcy5tZWFzdXJlQ29udGV4dC5jaGlsZEF0KHJlb3JkZXJlZEluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fY3JlYXRlUmVvcmRlcmVkSW5kaWNlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNoaWxkQ291bnQgPSB0aGlzLm1lYXN1cmVDb250ZXh0LmNoaWxkcmVuQ291bnQ7XG4gICAgICAgIHZhciBvcmRlcnMgPSB0aGlzLl9jcmVhdGVPcmRlcnMoY2hpbGRDb3VudCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9zb3J0T3JkZXJzSW50b1Jlb3JkZXJlZEluZGljZXMoY2hpbGRDb3VudCwgb3JkZXJzKTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLl9zb3J0T3JkZXJzSW50b1Jlb3JkZXJlZEluZGljZXMgPSBmdW5jdGlvbiAoY2hpbGRDb3VudCwgb3JkZXJzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIG9yZGVycy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmNvbXBhcmVUbyhiKTsgfSk7XG4gICAgICAgIGlmICghdGhpcy5fb3JkZXJDYWNoZSkge1xuICAgICAgICAgICAgdGhpcy5fb3JkZXJDYWNoZSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX29yZGVyQ2FjaGUubGVuZ3RoID0gMDtcbiAgICAgICAgdmFyIHJlb3JkZXJlZEluZGljZXMgPSBbXTtcbiAgICAgICAgb3JkZXJzLmZvckVhY2goZnVuY3Rpb24gKG9yZGVyLCBpKSB7XG4gICAgICAgICAgICByZW9yZGVyZWRJbmRpY2VzW2ldID0gb3JkZXIuaW5kZXg7XG4gICAgICAgICAgICBfdGhpcy5fb3JkZXJDYWNoZVtpXSA9IG9yZGVyLm9yZGVyO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlb3JkZXJlZEluZGljZXM7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fY3JlYXRlT3JkZXJzID0gZnVuY3Rpb24gKGNoaWxkQ291bnQpIHtcbiAgICAgICAgdmFyIG9yZGVycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5tZWFzdXJlQ29udGV4dC5jaGlsZEF0KGkpO1xuICAgICAgICAgICAgdmFyIG9yZGVyID0gbmV3IE9yZGVyKCk7XG4gICAgICAgICAgICBvcmRlci5vcmRlciA9IEZsZXhib3hMYXlvdXQuZ2V0T3JkZXIoY2hpbGQpO1xuICAgICAgICAgICAgb3JkZXIuaW5kZXggPSBpO1xuICAgICAgICAgICAgb3JkZXJzLnB1c2gob3JkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcmRlcnM7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmxleGJveExheW91dC5wcm90b3R5cGUsIFwiX2lzT3JkZXJDaGFuZ2VkRnJvbUxhc3RNZWFzdXJlbWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNoaWxkQ291bnQgPSB0aGlzLm1lYXN1cmVDb250ZXh0LmNoaWxkcmVuQ291bnQ7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX29yZGVyQ2FjaGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vcmRlckNhY2hlID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fb3JkZXJDYWNoZS5sZW5ndGggIT09IGNoaWxkQ291bnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLm1lYXN1cmVDb250ZXh0LmNoaWxkQXQoaSk7XG4gICAgICAgICAgICAgICAgaWYgKHZpZXcgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChGbGV4Ym94TGF5b3V0LmdldE9yZGVyKHZpZXcpICE9PSB0aGlzLl9vcmRlckNhY2hlW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX21lYXN1cmVIb3Jpem9udGFsID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB3aWR0aFNpemUgPSBnZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRTaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgY2hpbGRTdGF0ZSA9IDA7XG4gICAgICAgIHRoaXMuX2ZsZXhMaW5lcy5sZW5ndGggPSAwO1xuICAgICAgICAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNoaWxkQ291bnQgPSBfdGhpcy5tZWFzdXJlQ29udGV4dC5jaGlsZHJlbkNvdW50O1xuICAgICAgICAgICAgdmFyIHBhZGRpbmdTdGFydCA9IEZsZXhib3hMYXlvdXQuZ2V0UGFkZGluZ1N0YXJ0KF90aGlzKTtcbiAgICAgICAgICAgIHZhciBwYWRkaW5nRW5kID0gRmxleGJveExheW91dC5nZXRQYWRkaW5nRW5kKF90aGlzKTtcbiAgICAgICAgICAgIHZhciBsYXJnZXN0SGVpZ2h0SW5Sb3cgPSBOdW1iZXIuTUlOX1ZBTFVFO1xuICAgICAgICAgICAgdmFyIGZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICB2YXIgaW5kZXhJbkZsZXhMaW5lID0gMDtcbiAgICAgICAgICAgIGZsZXhMaW5lLl9tYWluU2l6ZSA9IHBhZGRpbmdTdGFydCArIHBhZGRpbmdFbmQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IF90aGlzLl9nZXRSZW9yZGVyZWRDaGlsZEF0KGkpO1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRkRmxleExpbmVJZkxhc3RGbGV4SXRlbShpLCBjaGlsZENvdW50LCBmbGV4TGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgICAgICBmbGV4TGluZS5faXRlbUNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9hZGRGbGV4TGluZUlmTGFzdEZsZXhJdGVtKGksIGNoaWxkQ291bnQsIGZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNoaWxkLl91cGRhdGVFZmZlY3RpdmVMYXlvdXRWYWx1ZXMod2lkdGhTaXplLCB3aWR0aE1vZGUsIGhlaWdodFNpemUsIGhlaWdodE1vZGUpO1xuICAgICAgICAgICAgICAgIHZhciBscCA9IGNoaWxkO1xuICAgICAgICAgICAgICAgIGlmIChGbGV4Ym94TGF5b3V0LmdldEFsaWduU2VsZihjaGlsZCkgPT09IFwic3RyZXRjaFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9pbmRpY2VzQWxpZ25TZWxmU3RyZXRjaC5wdXNoKGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRXaWR0aCA9IGxwLmVmZmVjdGl2ZVdpZHRoO1xuICAgICAgICAgICAgICAgIGlmIChmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4QmFzaXNQZXJjZW50LkRFRkFVTFQgIT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhCYXNpc1BlcmNlbnQuREVGQVVMVCAmJiB3aWR0aE1vZGUgPT09IEVYQUNUTFkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRXaWR0aCA9IE1hdGgucm91bmQod2lkdGhTaXplICogZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleEJhc2lzUGVyY2VudC5ERUZBVUxUKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkV2lkdGhNZWFzdXJlU3BlYyA9IEZsZXhib3hMYXlvdXQuZ2V0Q2hpbGRNZWFzdXJlU3BlYyh3aWR0aE1lYXN1cmVTcGVjLCBscC5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGxwLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnRcbiAgICAgICAgICAgICAgICAgICAgKyBscC5lZmZlY3RpdmVNYXJnaW5SaWdodCwgY2hpbGRXaWR0aCA8IDAgPyBXUkFQX0NPTlRFTlQgOiBjaGlsZFdpZHRoKTtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyA9IEZsZXhib3hMYXlvdXQuZ2V0Q2hpbGRNZWFzdXJlU3BlYyhoZWlnaHRNZWFzdXJlU3BlYywgbHAuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGxwLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3BcbiAgICAgICAgICAgICAgICAgICAgKyBscC5lZmZlY3RpdmVNYXJnaW5Cb3R0b20sIGxwLmVmZmVjdGl2ZUhlaWdodCA8IDAgPyBXUkFQX0NPTlRFTlQgOiBscC5lZmZlY3RpdmVIZWlnaHQpO1xuICAgICAgICAgICAgICAgIGNoaWxkLm1lYXN1cmUoY2hpbGRXaWR0aE1lYXN1cmVTcGVjLCBjaGlsZEhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fY2hlY2tTaXplQ29uc3RyYWludHMoY2hpbGQpO1xuICAgICAgICAgICAgICAgIGNoaWxkU3RhdGUgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LmNvbWJpbmVNZWFzdXJlZFN0YXRlcyhjaGlsZFN0YXRlLCBjaGlsZC5nZXRNZWFzdXJlZFN0YXRlKCkpO1xuICAgICAgICAgICAgICAgIGxhcmdlc3RIZWlnaHRJblJvdyA9IE1hdGgubWF4KGxhcmdlc3RIZWlnaHRJblJvdywgY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcCArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLl9pc1dyYXBSZXF1aXJlZChjaGlsZCwgd2lkdGhNb2RlLCB3aWR0aFNpemUsIGZsZXhMaW5lLl9tYWluU2l6ZSwgY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luTGVmdCArIGxwLmVmZmVjdGl2ZU1hcmdpblJpZ2h0LCBpLCBpbmRleEluRmxleExpbmUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmbGV4TGluZS5pdGVtQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fYWRkRmxleExpbmUoZmxleExpbmUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9pdGVtQ291bnQgPSAxO1xuICAgICAgICAgICAgICAgICAgICBmbGV4TGluZS5fbWFpblNpemUgPSBwYWRkaW5nU3RhcnQgKyBwYWRkaW5nRW5kO1xuICAgICAgICAgICAgICAgICAgICBsYXJnZXN0SGVpZ2h0SW5Sb3cgPSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wICsgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgICAgICAgICBpbmRleEluRmxleExpbmUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZmxleExpbmUuX2l0ZW1Db3VudCsrO1xuICAgICAgICAgICAgICAgICAgICBpbmRleEluRmxleExpbmUrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX21haW5TaXplICs9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBscC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fdG90YWxGbGV4R3JvdyArPSBGbGV4Ym94TGF5b3V0LmdldEZsZXhHcm93KGNoaWxkKTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fdG90YWxGbGV4U2hyaW5rICs9IEZsZXhib3hMYXlvdXQuZ2V0RmxleFNocmluayhjaGlsZCk7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX2Nyb3NzU2l6ZSA9IE1hdGgubWF4KGZsZXhMaW5lLl9jcm9zc1NpemUsIGxhcmdlc3RIZWlnaHRJblJvdyk7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLmZsZXhXcmFwICE9PSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4V3JhcC5XUkFQX1JFVkVSU0UpIHtcbiAgICAgICAgICAgICAgICAgICAgZmxleExpbmUuX21heEJhc2VsaW5lID0gTWF0aC5tYXgoZmxleExpbmUuX21heEJhc2VsaW5lLCBGbGV4Ym94TGF5b3V0LmdldEJhc2VsaW5lKGNoaWxkKSArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmbGV4TGluZS5fbWF4QmFzZWxpbmUgPSBNYXRoLm1heChmbGV4TGluZS5fbWF4QmFzZWxpbmUsIGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgLSBGbGV4Ym94TGF5b3V0LmdldEJhc2VsaW5lKGNoaWxkKSArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLl9hZGRGbGV4TGluZUlmTGFzdEZsZXhJdGVtKGksIGNoaWxkQ291bnQsIGZsZXhMaW5lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKTtcbiAgICAgICAgdGhpcy5fZGV0ZXJtaW5lTWFpblNpemUodGhpcy5mbGV4RGlyZWN0aW9uLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIGlmICh0aGlzLmFsaWduSXRlbXMgPT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuQkFTRUxJTkUpIHtcbiAgICAgICAgICAgIHZhciB2aWV3SW5kZXhfMSA9IDA7XG4gICAgICAgICAgICB0aGlzLl9mbGV4TGluZXMuZm9yRWFjaChmdW5jdGlvbiAoZmxleExpbmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGFyZ2VzdEhlaWdodEluTGluZSA9IE51bWJlci5NSU5fVkFMVUU7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHZpZXdJbmRleF8xOyBpIDwgdmlld0luZGV4XzEgKyBmbGV4TGluZS5faXRlbUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gX3RoaXMuX2dldFJlb3JkZXJlZENoaWxkQXQoaSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBscCA9IGNoaWxkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZmxleFdyYXAgIT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBfUkVWRVJTRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmdpblRvcCA9IGZsZXhMaW5lLl9tYXhCYXNlbGluZSAtIEZsZXhib3hMYXlvdXQuZ2V0QmFzZWxpbmUoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wID0gTWF0aC5tYXgobWFyZ2luVG9wLCBscC5lZmZlY3RpdmVNYXJnaW5Ub3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VzdEhlaWdodEluTGluZSA9IE1hdGgubWF4KGxhcmdlc3RIZWlnaHRJbkxpbmUsIGNoaWxkLmdldEFjdHVhbFNpemUoKS5oZWlnaHQgKyBtYXJnaW5Ub3AgKyBscC5lZmZlY3RpdmVNYXJnaW5Cb3R0b20pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmdpbkJvdHRvbSA9IGZsZXhMaW5lLl9tYXhCYXNlbGluZSAtIGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBGbGV4Ym94TGF5b3V0LmdldEJhc2VsaW5lKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkJvdHRvbSA9IE1hdGgubWF4KG1hcmdpbkJvdHRvbSwgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhcmdlc3RIZWlnaHRJbkxpbmUgPSBNYXRoLm1heChsYXJnZXN0SGVpZ2h0SW5MaW5lLCBjaGlsZC5nZXRBY3R1YWxTaXplKCkuaGVpZ2h0ICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wICsgbWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fY3Jvc3NTaXplID0gbGFyZ2VzdEhlaWdodEluTGluZTtcbiAgICAgICAgICAgICAgICB2aWV3SW5kZXhfMSArPSBmbGV4TGluZS5pdGVtQ291bnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9kZXRlcm1pbmVDcm9zc1NpemUodGhpcy5mbGV4RGlyZWN0aW9uLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYywgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tKTtcbiAgICAgICAgdGhpcy5fc3RyZXRjaFZpZXdzKHRoaXMuZmxleERpcmVjdGlvbiwgdGhpcy5hbGlnbkl0ZW1zKTtcbiAgICAgICAgdGhpcy5fc2V0TWVhc3VyZWREaW1lbnNpb25Gb3JGbGV4KHRoaXMuZmxleERpcmVjdGlvbiwgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMsIGNoaWxkU3RhdGUpO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX21lYXN1cmVWZXJ0aWNhbCA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGhTaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0U2l6ZSA9IGdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGNoaWxkU3RhdGUgPSAwO1xuICAgICAgICB0aGlzLl9mbGV4TGluZXMubGVuZ3RoID0gMDtcbiAgICAgICAgdmFyIGNoaWxkQ291bnQgPSB0aGlzLm1lYXN1cmVDb250ZXh0LmNoaWxkcmVuQ291bnQ7XG4gICAgICAgIHZhciBwYWRkaW5nVG9wID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wO1xuICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbTtcbiAgICAgICAgdmFyIGxhcmdlc3RXaWR0aEluQ29sdW1uID0gTnVtYmVyLk1JTl9WQUxVRTtcbiAgICAgICAgdmFyIGZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgIGZsZXhMaW5lLl9tYWluU2l6ZSA9IHBhZGRpbmdUb3AgKyBwYWRkaW5nQm90dG9tO1xuICAgICAgICB2YXIgaW5kZXhJbkZsZXhMaW5lID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZENvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjaGlsZCA9IHRoaXMuX2dldFJlb3JkZXJlZENoaWxkQXQoaSk7XG4gICAgICAgICAgICBpZiAoY2hpbGQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRGbGV4TGluZUlmTGFzdEZsZXhJdGVtKGksIGNoaWxkQ291bnQsIGZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX2l0ZW1Db3VudCsrO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZEZsZXhMaW5lSWZMYXN0RmxleEl0ZW0oaSwgY2hpbGRDb3VudCwgZmxleExpbmUpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpbGQuX3VwZGF0ZUVmZmVjdGl2ZUxheW91dFZhbHVlcyh3aWR0aFNpemUsIHdpZHRoTW9kZSwgaGVpZ2h0U2l6ZSwgaGVpZ2h0TW9kZSk7XG4gICAgICAgICAgICB2YXIgbHAgPSBjaGlsZDtcbiAgICAgICAgICAgIGlmIChGbGV4Ym94TGF5b3V0LmdldEFsaWduU2VsZihjaGlsZCkgPT09IFwic3RyZXRjaFwiKSB7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX2luZGljZXNBbGlnblNlbGZTdHJldGNoLnB1c2goaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hpbGRIZWlnaHQgPSBscC5lZmZlY3RpdmVIZWlnaHQ7XG4gICAgICAgICAgICBpZiAoZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleEJhc2lzUGVyY2VudC5ERUZBVUxUICE9PSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4QmFzaXNQZXJjZW50LkRFRkFVTFQgJiYgaGVpZ2h0TW9kZSA9PT0gRVhBQ1RMWSkge1xuICAgICAgICAgICAgICAgIGNoaWxkSGVpZ2h0ID0gTWF0aC5yb3VuZChoZWlnaHRTaXplICogZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleEJhc2lzUGVyY2VudC5ERUZBVUxUKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGlsZFdpZHRoTWVhc3VyZVNwZWMgPSBGbGV4Ym94TGF5b3V0LmdldENoaWxkTWVhc3VyZVNwZWMod2lkdGhNZWFzdXJlU3BlYywgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgbHAuZWZmZWN0aXZlTWFyZ2luTGVmdFxuICAgICAgICAgICAgICAgICsgbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQsIGxwLmVmZmVjdGl2ZVdpZHRoIDwgMCA/IFdSQVBfQ09OVEVOVCA6IGxwLmVmZmVjdGl2ZVdpZHRoKTtcbiAgICAgICAgICAgIHZhciBjaGlsZEhlaWdodE1lYXN1cmVTcGVjID0gRmxleGJveExheW91dC5nZXRDaGlsZE1lYXN1cmVTcGVjKGhlaWdodE1lYXN1cmVTcGVjLCB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3BcbiAgICAgICAgICAgICAgICArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSwgY2hpbGRIZWlnaHQgPCAwID8gV1JBUF9DT05URU5UIDogY2hpbGRIZWlnaHQpO1xuICAgICAgICAgICAgY2hpbGQubWVhc3VyZShjaGlsZFdpZHRoTWVhc3VyZVNwZWMsIGNoaWxkSGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tTaXplQ29uc3RyYWludHMoY2hpbGQpO1xuICAgICAgICAgICAgY2hpbGRTdGF0ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcuY29tYmluZU1lYXN1cmVkU3RhdGVzKGNoaWxkU3RhdGUsIGNoaWxkLmdldE1lYXN1cmVkU3RhdGUoKSk7XG4gICAgICAgICAgICBsYXJnZXN0V2lkdGhJbkNvbHVtbiA9IE1hdGgubWF4KGxhcmdlc3RXaWR0aEluQ29sdW1uLCBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCkgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lzV3JhcFJlcXVpcmVkKGNoaWxkLCBoZWlnaHRNb2RlLCBoZWlnaHRTaXplLCBmbGV4TGluZS5tYWluU2l6ZSwgY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcCArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSwgaSwgaW5kZXhJbkZsZXhMaW5lKSkge1xuICAgICAgICAgICAgICAgIGlmIChmbGV4TGluZS5faXRlbUNvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRGbGV4TGluZShmbGV4TGluZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX2l0ZW1Db3VudCA9IDE7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX21haW5TaXplID0gcGFkZGluZ1RvcCArIHBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICAgICAgbGFyZ2VzdFdpZHRoSW5Db2x1bW4gPSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCkgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICAgICAgaW5kZXhJbkZsZXhMaW5lID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9pdGVtQ291bnQrKztcbiAgICAgICAgICAgICAgICBpbmRleEluRmxleExpbmUrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZsZXhMaW5lLl9tYWluU2l6ZSArPSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wICsgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgZmxleExpbmUuX3RvdGFsRmxleEdyb3cgKz0gRmxleGJveExheW91dC5nZXRGbGV4R3JvdyhjaGlsZCk7XG4gICAgICAgICAgICBmbGV4TGluZS5fdG90YWxGbGV4U2hyaW5rICs9IEZsZXhib3hMYXlvdXQuZ2V0RmxleFNocmluayhjaGlsZCk7XG4gICAgICAgICAgICBmbGV4TGluZS5fY3Jvc3NTaXplID0gTWF0aC5tYXgoZmxleExpbmUuX2Nyb3NzU2l6ZSwgbGFyZ2VzdFdpZHRoSW5Db2x1bW4pO1xuICAgICAgICAgICAgdGhpcy5fYWRkRmxleExpbmVJZkxhc3RGbGV4SXRlbShpLCBjaGlsZENvdW50LCBmbGV4TGluZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGV0ZXJtaW5lTWFpblNpemUodGhpcy5mbGV4RGlyZWN0aW9uLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHRoaXMuX2RldGVybWluZUNyb3NzU2l6ZSh0aGlzLmZsZXhEaXJlY3Rpb24sIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjLCB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQpO1xuICAgICAgICB0aGlzLl9zdHJldGNoVmlld3ModGhpcy5mbGV4RGlyZWN0aW9uLCB0aGlzLmFsaWduSXRlbXMpO1xuICAgICAgICB0aGlzLl9zZXRNZWFzdXJlZERpbWVuc2lvbkZvckZsZXgodGhpcy5mbGV4RGlyZWN0aW9uLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYywgY2hpbGRTdGF0ZSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fY2hlY2tTaXplQ29uc3RyYWludHMgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgbmVlZHNNZWFzdXJlID0gZmFsc2U7XG4gICAgICAgIHZhciBjaGlsZFdpZHRoID0gdmlldy5nZXRNZWFzdXJlZFdpZHRoKCk7XG4gICAgICAgIHZhciBjaGlsZEhlaWdodCA9IHZpZXcuZ2V0TWVhc3VyZWRIZWlnaHQoKTtcbiAgICAgICAgdmFyIG1pbldpZHRoID0gdmlldy5lZmZlY3RpdmVNaW5XaWR0aDtcbiAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5XaWR0aCA9IDA7XG4gICAgICAgIGlmICh2aWV3LmdldE1lYXN1cmVkV2lkdGgoKSA8IG1pbldpZHRoKSB7XG4gICAgICAgICAgICBuZWVkc01lYXN1cmUgPSB0cnVlO1xuICAgICAgICAgICAgY2hpbGRXaWR0aCA9IG1pbldpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXcuZ2V0TWVhc3VyZWRXaWR0aCgpID4gTUFYX1NJWkUpIHtcbiAgICAgICAgICAgIG5lZWRzTWVhc3VyZSA9IHRydWU7XG4gICAgICAgICAgICBjaGlsZFdpZHRoID0gTUFYX1NJWkU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1pbkhlaWdodCA9IHZpZXcuZWZmZWN0aXZlTWluSGVpZ2h0O1xuICAgICAgICB2aWV3LmVmZmVjdGl2ZU1pbkhlaWdodCA9IDA7XG4gICAgICAgIGlmIChjaGlsZEhlaWdodCA8IG1pbkhlaWdodCkge1xuICAgICAgICAgICAgbmVlZHNNZWFzdXJlID0gdHJ1ZTtcbiAgICAgICAgICAgIGNoaWxkSGVpZ2h0ID0gbWluSGVpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNoaWxkSGVpZ2h0ID4gTUFYX1NJWkUpIHtcbiAgICAgICAgICAgIG5lZWRzTWVhc3VyZSA9IHRydWU7XG4gICAgICAgICAgICBjaGlsZEhlaWdodCA9IE1BWF9TSVpFO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZWVkc01lYXN1cmUpIHtcbiAgICAgICAgICAgIHZpZXcubWVhc3VyZShtYWtlTWVhc3VyZVNwZWMoY2hpbGRXaWR0aCwgRVhBQ1RMWSksIG1ha2VNZWFzdXJlU3BlYyhjaGlsZEhlaWdodCwgRVhBQ1RMWSkpO1xuICAgICAgICB9XG4gICAgICAgIHZpZXcuZWZmZWN0aXZlTWluV2lkdGggPSBtaW5XaWR0aDtcbiAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5IZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fYWRkRmxleExpbmVJZkxhc3RGbGV4SXRlbSA9IGZ1bmN0aW9uIChjaGlsZEluZGV4LCBjaGlsZENvdW50LCBmbGV4TGluZSkge1xuICAgICAgICBpZiAoY2hpbGRJbmRleCA9PT0gY2hpbGRDb3VudCAtIDEgJiYgZmxleExpbmUuaXRlbUNvdW50ICE9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9hZGRGbGV4TGluZShmbGV4TGluZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLl9hZGRGbGV4TGluZSA9IGZ1bmN0aW9uIChmbGV4TGluZSkge1xuICAgICAgICB0aGlzLl9mbGV4TGluZXMucHVzaChmbGV4TGluZSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fZGV0ZXJtaW5lTWFpblNpemUgPSBmdW5jdGlvbiAoZmxleERpcmVjdGlvbiwgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG1haW5TaXplO1xuICAgICAgICB2YXIgcGFkZGluZ0Fsb25nTWFpbkF4aXM7XG4gICAgICAgIHN3aXRjaCAoZmxleERpcmVjdGlvbikge1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPVzpcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRTpcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aFNpemUgPSBnZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgaWYgKHdpZHRoTW9kZSA9PT0gRVhBQ1RMWSkge1xuICAgICAgICAgICAgICAgICAgICBtYWluU2l6ZSA9IHdpZHRoU2l6ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW5TaXplID0gdGhpcy5fZ2V0TGFyZ2VzdE1haW5TaXplKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhZGRpbmdBbG9uZ01haW5BeGlzID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTjpcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5DT0xVTU5fUkVWRVJTRTpcbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodFNpemUgPSBnZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIGlmIChoZWlnaHRNb2RlID09PSBFWEFDVExZKSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW5TaXplID0gaGVpZ2h0U2l6ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1haW5TaXplID0gdGhpcy5fZ2V0TGFyZ2VzdE1haW5TaXplKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBhZGRpbmdBbG9uZ01haW5BeGlzID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZsZXggZGlyZWN0aW9uOiBcIiArIGZsZXhEaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fZmxleExpbmVzLmZvckVhY2goZnVuY3Rpb24gKGZsZXhMaW5lKSB7XG4gICAgICAgICAgICBpZiAoZmxleExpbmUubWFpblNpemUgPCBtYWluU2l6ZSkge1xuICAgICAgICAgICAgICAgIGNoaWxkSW5kZXggPSBfdGhpcy5fZXhwYW5kRmxleEl0ZW1zKGZsZXhMaW5lLCBmbGV4RGlyZWN0aW9uLCBtYWluU2l6ZSwgcGFkZGluZ0Fsb25nTWFpbkF4aXMsIGNoaWxkSW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY2hpbGRJbmRleCA9IF90aGlzLl9zaHJpbmtGbGV4SXRlbXMoZmxleExpbmUsIGZsZXhEaXJlY3Rpb24sIG1haW5TaXplLCBwYWRkaW5nQWxvbmdNYWluQXhpcywgY2hpbGRJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX2V4cGFuZEZsZXhJdGVtcyA9IGZ1bmN0aW9uIChmbGV4TGluZSwgZmxleERpcmVjdGlvbiwgbWF4TWFpblNpemUsIHBhZGRpbmdBbG9uZ01haW5BeGlzLCBzdGFydEluZGV4KSB7XG4gICAgICAgIHZhciBjaGlsZEluZGV4ID0gc3RhcnRJbmRleDtcbiAgICAgICAgaWYgKGZsZXhMaW5lLl90b3RhbEZsZXhHcm93IDw9IDAgfHwgbWF4TWFpblNpemUgPCBmbGV4TGluZS5fbWFpblNpemUpIHtcbiAgICAgICAgICAgIGNoaWxkSW5kZXggKz0gZmxleExpbmUuX2l0ZW1Db3VudDtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzaXplQmVmb3JlRXhwYW5kID0gZmxleExpbmUuX21haW5TaXplO1xuICAgICAgICB2YXIgbmVlZHNSZWV4cGFuZCA9IGZhbHNlO1xuICAgICAgICB2YXIgcGVuZGluZ1NwYWNlID0gbWF4TWFpblNpemUgLSBmbGV4TGluZS5fbWFpblNpemU7XG4gICAgICAgIHZhciB1bml0U3BhY2UgPSBwZW5kaW5nU3BhY2UgLyBmbGV4TGluZS5fdG90YWxGbGV4R3JvdztcbiAgICAgICAgZmxleExpbmUuX21haW5TaXplID0gcGFkZGluZ0Fsb25nTWFpbkF4aXMgKyBmbGV4TGluZS5fZGl2aWRlckxlbmd0aEluTWFpblNpemU7XG4gICAgICAgIHZhciBhY2N1bXVsYXRlZFJvdW5kRXJyb3IgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZsZXhMaW5lLml0ZW1Db3VudDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLl9nZXRSZW9yZGVyZWRDaGlsZEF0KGNoaWxkSW5kZXgpO1xuICAgICAgICAgICAgaWYgKGNoaWxkID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIGNoaWxkSW5kZXgrKztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBscCA9IGNoaWxkO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lzTWFpbkF4aXNEaXJlY3Rpb25Ib3Jpem9udGFsKGZsZXhEaXJlY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jaGlsZHJlbkZyb3plbltjaGlsZEluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmxleEdyb3cgPSBGbGV4Ym94TGF5b3V0LmdldEZsZXhHcm93KGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhd0NhbGN1bGF0ZWRXaWR0aCA9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIHVuaXRTcGFjZSAqIGZsZXhHcm93ICsgYWNjdW11bGF0ZWRSb3VuZEVycm9yO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm91bmRlZENhbGN1bGF0ZWRXaWR0aCA9IE1hdGgucm91bmQocmF3Q2FsY3VsYXRlZFdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdW5kZWRDYWxjdWxhdGVkV2lkdGggPiBNQVhfU0laRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVlZHNSZWV4cGFuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3VuZGVkQ2FsY3VsYXRlZFdpZHRoID0gTUFYX1NJWkU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGlsZHJlbkZyb3plbltjaGlsZEluZGV4XSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmbGV4TGluZS5fdG90YWxGbGV4R3JvdyAtPSBmbGV4R3JvdztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkUm91bmRFcnJvciA9IHJhd0NhbGN1bGF0ZWRXaWR0aCAtIHJvdW5kZWRDYWxjdWxhdGVkV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hpbGQubWVhc3VyZShtYWtlTWVhc3VyZVNwZWMocm91bmRlZENhbGN1bGF0ZWRXaWR0aCwgRVhBQ1RMWSksIG1ha2VNZWFzdXJlU3BlYyhjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpLCBFWEFDVExZKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9tYWluU2l6ZSArPSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCkgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NoaWxkcmVuRnJvemVuW2NoaWxkSW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbGV4R3JvdyA9IEZsZXhib3hMYXlvdXQuZ2V0RmxleEdyb3coY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmF3Q2FsY3VsYXRlZEhlaWdodCA9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyB1bml0U3BhY2UgKiBmbGV4R3JvdyArIGFjY3VtdWxhdGVkUm91bmRFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0ID0gTWF0aC5yb3VuZChyYXdDYWxjdWxhdGVkSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0ID4gTUFYX1NJWkUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lZWRzUmVleHBhbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcm91bmRlZENhbGN1bGF0ZWRIZWlnaHQgPSBNQVhfU0laRTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkcmVuRnJvemVuW2NoaWxkSW5kZXhdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lLl90b3RhbEZsZXhHcm93IC09IGZsZXhHcm93O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRSb3VuZEVycm9yID0gcmF3Q2FsY3VsYXRlZEhlaWdodCAtIHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLm1lYXN1cmUobWFrZU1lYXN1cmVTcGVjKGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSwgRVhBQ1RMWSksIG1ha2VNZWFzdXJlU3BlYyhyb3VuZGVkQ2FsY3VsYXRlZEhlaWdodCwgRVhBQ1RMWSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fbWFpblNpemUgKz0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcCArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoaWxkSW5kZXgrKztcbiAgICAgICAgfVxuICAgICAgICBpZiAobmVlZHNSZWV4cGFuZCAmJiBzaXplQmVmb3JlRXhwYW5kICE9PSBmbGV4TGluZS5fbWFpblNpemUpIHtcbiAgICAgICAgICAgIHRoaXMuX2V4cGFuZEZsZXhJdGVtcyhmbGV4TGluZSwgZmxleERpcmVjdGlvbiwgbWF4TWFpblNpemUsIHBhZGRpbmdBbG9uZ01haW5BeGlzLCBzdGFydEluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGRJbmRleDtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLl9zaHJpbmtGbGV4SXRlbXMgPSBmdW5jdGlvbiAoZmxleExpbmUsIGZsZXhEaXJlY3Rpb24sIG1heE1haW5TaXplLCBwYWRkaW5nQWxvbmdNYWluQXhpcywgc3RhcnRJbmRleCkge1xuICAgICAgICB2YXIgY2hpbGRJbmRleCA9IHN0YXJ0SW5kZXg7XG4gICAgICAgIHZhciBzaXplQmVmb3JlU2hyaW5rID0gZmxleExpbmUuX21haW5TaXplO1xuICAgICAgICBpZiAoZmxleExpbmUuX3RvdGFsRmxleFNocmluayA8PSAwIHx8IG1heE1haW5TaXplID4gZmxleExpbmUuX21haW5TaXplKSB7XG4gICAgICAgICAgICBjaGlsZEluZGV4ICs9IGZsZXhMaW5lLml0ZW1Db3VudDtcbiAgICAgICAgICAgIHJldHVybiBjaGlsZEluZGV4O1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZWVkc1Jlc2hyaW5rID0gZmFsc2U7XG4gICAgICAgIHZhciB1bml0U2hyaW5rID0gKGZsZXhMaW5lLl9tYWluU2l6ZSAtIG1heE1haW5TaXplKSAvIGZsZXhMaW5lLl90b3RhbEZsZXhTaHJpbms7XG4gICAgICAgIHZhciBhY2N1bXVsYXRlZFJvdW5kRXJyb3IgPSAwO1xuICAgICAgICBmbGV4TGluZS5fbWFpblNpemUgPSBwYWRkaW5nQWxvbmdNYWluQXhpcyArIGZsZXhMaW5lLl9kaXZpZGVyTGVuZ3RoSW5NYWluU2l6ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmbGV4TGluZS5pdGVtQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNoaWxkID0gdGhpcy5fZ2V0UmVvcmRlcmVkQ2hpbGRBdChjaGlsZEluZGV4KTtcbiAgICAgICAgICAgIGlmIChjaGlsZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2hpbGQuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICBjaGlsZEluZGV4Kys7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbHAgPSBjaGlsZDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc01haW5BeGlzRGlyZWN0aW9uSG9yaXpvbnRhbChmbGV4RGlyZWN0aW9uKSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY2hpbGRyZW5Gcm96ZW5bY2hpbGRJbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZsZXhTaHJpbmsgPSBGbGV4Ym94TGF5b3V0LmdldEZsZXhTaHJpbmsoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmF3Q2FsY3VsYXRlZFdpZHRoID0gY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpIC0gdW5pdFNocmluayAqIGZsZXhTaHJpbmsgKyBhY2N1bXVsYXRlZFJvdW5kRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3VuZGVkQ2FsY3VsYXRlZFdpZHRoID0gTWF0aC5yb3VuZChyYXdDYWxjdWxhdGVkV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWluV2lkdGggPSBjaGlsZC5lZmZlY3RpdmVNaW5XaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuZWZmZWN0aXZlTWluV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAocm91bmRlZENhbGN1bGF0ZWRXaWR0aCA8IG1pbldpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkc1Jlc2hyaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdW5kZWRDYWxjdWxhdGVkV2lkdGggPSBtaW5XaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkcmVuRnJvemVuW2NoaWxkSW5kZXhdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lLl90b3RhbEZsZXhTaHJpbmsgLT0gZmxleFNocmluaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkUm91bmRFcnJvciA9IHJhd0NhbGN1bGF0ZWRXaWR0aCAtIHJvdW5kZWRDYWxjdWxhdGVkV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkV2lkdGhNZWFzdXJlU3BlYyA9IG1ha2VNZWFzdXJlU3BlYyhyb3VuZGVkQ2FsY3VsYXRlZFdpZHRoLCBFWEFDVExZKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkSGVpZ2h0TWVhc3VyZVNwZWMgPSBGbGV4Ym94TGF5b3V0LmdldENoaWxkTWVhc3VyZVNwZWModGhpcy5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjLCBscC5lZmZlY3RpdmVQYWRkaW5nVG9wICsgbHAuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcFxuICAgICAgICAgICAgICAgICAgICAgICAgKyBscC5lZmZlY3RpdmVNYXJnaW5Cb3R0b20sIGxwLmVmZmVjdGl2ZUhlaWdodCA8IDAgPyBXUkFQX0NPTlRFTlQgOiBscC5lZmZlY3RpdmVIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZC5tZWFzdXJlKGNoaWxkV2lkdGhNZWFzdXJlU3BlYywgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmVmZmVjdGl2ZU1pbldpZHRoID0gbWluV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9jcm9zc1NpemUgPSBNYXRoLm1heChmbGV4TGluZS5fY3Jvc3NTaXplLCBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wICsgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX21haW5TaXplICs9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBscC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY2hpbGRyZW5Gcm96ZW5bY2hpbGRJbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZsZXhTaHJpbmsgPSBGbGV4Ym94TGF5b3V0LmdldEZsZXhTaHJpbmsoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmF3Q2FsY3VsYXRlZEhlaWdodCA9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgLSB1bml0U2hyaW5rICogZmxleFNocmluayArIGFjY3VtdWxhdGVkUm91bmRFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0ID0gTWF0aC5yb3VuZChyYXdDYWxjdWxhdGVkSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbkhlaWdodCA9IGNoaWxkLmVmZmVjdGl2ZU1pbkhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQuZWZmZWN0aXZlTWluSGVpZ2h0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0IDwgbWluSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkc1Jlc2hyaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0ID0gbWluSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW5Gcm96ZW5bY2hpbGRJbmRleF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmxleExpbmUuX3RvdGFsRmxleFNocmluayAtPSBmbGV4U2hyaW5rO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRSb3VuZEVycm9yID0gcmF3Q2FsY3VsYXRlZEhlaWdodCAtIHJvdW5kZWRDYWxjdWxhdGVkSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLm1lYXN1cmUobWFrZU1lYXN1cmVTcGVjKGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSwgRVhBQ1RMWSksIG1ha2VNZWFzdXJlU3BlYyhyb3VuZGVkQ2FsY3VsYXRlZEhlaWdodCwgRVhBQ1RMWSkpO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZC5lZmZlY3RpdmVNaW5IZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZsZXhMaW5lLl9tYWluU2l6ZSArPSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wICsgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpbGRJbmRleCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZWVkc1Jlc2hyaW5rICYmIHNpemVCZWZvcmVTaHJpbmsgIT09IGZsZXhMaW5lLl9tYWluU2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5fc2hyaW5rRmxleEl0ZW1zKGZsZXhMaW5lLCBmbGV4RGlyZWN0aW9uLCBtYXhNYWluU2l6ZSwgcGFkZGluZ0Fsb25nTWFpbkF4aXMsIHN0YXJ0SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjaGlsZEluZGV4O1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX2RldGVybWluZUNyb3NzU2l6ZSA9IGZ1bmN0aW9uIChmbGV4RGlyZWN0aW9uLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYywgcGFkZGluZ0Fsb25nQ3Jvc3NBeGlzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBtb2RlO1xuICAgICAgICB2YXIgc2l6ZTtcbiAgICAgICAgc3dpdGNoIChmbGV4RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XOlxuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFOlxuICAgICAgICAgICAgICAgIG1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIHNpemUgPSBnZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTjpcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5DT0xVTU5fUkVWRVJTRTpcbiAgICAgICAgICAgICAgICBtb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIHNpemUgPSBnZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZmxleCBkaXJlY3Rpb246IFwiICsgZmxleERpcmVjdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGUgPT09IEVYQUNUTFkpIHtcbiAgICAgICAgICAgIHZhciB0b3RhbENyb3NzU2l6ZV8xID0gdGhpcy5fZ2V0U3VtT2ZDcm9zc1NpemUoKSArIHBhZGRpbmdBbG9uZ0Nyb3NzQXhpcztcbiAgICAgICAgICAgIGlmICh0aGlzLl9mbGV4TGluZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmxleExpbmVzWzBdLl9jcm9zc1NpemUgPSBzaXplIC0gcGFkZGluZ0Fsb25nQ3Jvc3NBeGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5fZmxleExpbmVzLmxlbmd0aCA+PSAyICYmIHRvdGFsQ3Jvc3NTaXplXzEgPCBzaXplKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLmFsaWduQ29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5TVFJFVENIOlxuICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJlZVNwYWNlVW5pdCA9IChzaXplIC0gdG90YWxDcm9zc1NpemVfMSkgLyBfdGhpcy5fZmxleExpbmVzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjdW11bGF0ZWRFcnJvciA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGZsZXhMaW5lc1NpemUgPSBfdGhpcy5fZmxleExpbmVzLmxlbmd0aDsgaSA8IGZsZXhMaW5lc1NpemU7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmxleExpbmUgPSBfdGhpcy5fZmxleExpbmVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q3Jvc3NTaXplQXNGbG9hdCA9IGZsZXhMaW5lLl9jcm9zc1NpemUgKyBmcmVlU3BhY2VVbml0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gX3RoaXMuX2ZsZXhMaW5lcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDcm9zc1NpemVBc0Zsb2F0ICs9IGFjY3VtdWxhdGVkRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZEVycm9yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q3Jvc3NTaXplID0gTWF0aC5yb3VuZChuZXdDcm9zc1NpemVBc0Zsb2F0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRFcnJvciArPSAobmV3Q3Jvc3NTaXplQXNGbG9hdCAtIG5ld0Nyb3NzU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlZEVycm9yID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q3Jvc3NTaXplICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZEVycm9yIC09IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWNjdW11bGF0ZWRFcnJvciA8IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDcm9zc1NpemUgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkRXJyb3IgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGV4TGluZS5fY3Jvc3NTaXplID0gbmV3Q3Jvc3NTaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkNvbnRlbnQuU1BBQ0VfQVJPVU5EOlxuICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhY2VUb3BBbmRCb3R0b20gPSBzaXplIC0gdG90YWxDcm9zc1NpemVfMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbnVtYmVyT2ZTcGFjZXMgPSBfdGhpcy5fZmxleExpbmVzLmxlbmd0aCAqIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VUb3BBbmRCb3R0b20gPSBzcGFjZVRvcEFuZEJvdHRvbSAvIG51bWJlck9mU3BhY2VzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdGbGV4TGluZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtbXlTcGFjZUZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtbXlTcGFjZUZsZXhMaW5lLl9jcm9zc1NpemUgPSBzcGFjZVRvcEFuZEJvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZmxleExpbmVzLmZvckVhY2goZnVuY3Rpb24gKGZsZXhMaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZsZXhMaW5lcy5wdXNoKGR1bW15U3BhY2VGbGV4TGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZsZXhMaW5lcy5wdXNoKGZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmxleExpbmVzLnB1c2goZHVtbXlTcGFjZUZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZmxleExpbmVzID0gbmV3RmxleExpbmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5TUEFDRV9CRVRXRUVOOlxuICAgICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhY2VCZXR3ZWVuRmxleExpbmUgPSBzaXplIC0gdG90YWxDcm9zc1NpemVfMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbnVtYmVyT2ZTcGFjZXMgPSBfdGhpcy5fZmxleExpbmVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuRmxleExpbmUgPSBzcGFjZUJldHdlZW5GbGV4TGluZSAvIG51bWJlck9mU3BhY2VzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2N1bXVsYXRlZEVycm9yID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RmxleExpbmVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGZsZXhMaW5lU2l6ZSA9IF90aGlzLl9mbGV4TGluZXMubGVuZ3RoOyBpIDwgZmxleExpbmVTaXplOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZsZXhMaW5lID0gX3RoaXMuX2ZsZXhMaW5lc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmxleExpbmVzLnB1c2goZmxleExpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gX3RoaXMuX2ZsZXhMaW5lcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtbXlTcGFjZUZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gX3RoaXMuX2ZsZXhMaW5lcy5sZW5ndGggLSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVtbXlTcGFjZUZsZXhMaW5lLl9jcm9zc1NpemUgPSBNYXRoLnJvdW5kKHNwYWNlQmV0d2VlbkZsZXhMaW5lICsgYWNjdW11bGF0ZWRFcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRFcnJvciA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdW1teVNwYWNlRmxleExpbmUuX2Nyb3NzU2l6ZSA9IE1hdGgucm91bmQoc3BhY2VCZXR3ZWVuRmxleExpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRFcnJvciArPSAoc3BhY2VCZXR3ZWVuRmxleExpbmUgLSBkdW1teVNwYWNlRmxleExpbmUuX2Nyb3NzU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZWRFcnJvciA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdW1teVNwYWNlRmxleExpbmUuX2Nyb3NzU2l6ZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkRXJyb3IgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFjY3VtdWxhdGVkRXJyb3IgPCAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1bW15U3BhY2VGbGV4TGluZS5fY3Jvc3NTaXplIC09IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRFcnJvciArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmxleExpbmVzLnB1c2goZHVtbXlTcGFjZUZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZmxleExpbmVzID0gbmV3RmxleExpbmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5DRU5URVI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcGFjZUFib3ZlQW5kQm90dG9tID0gc2l6ZSAtIHRvdGFsQ3Jvc3NTaXplXzE7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFjZUFib3ZlQW5kQm90dG9tID0gc3BhY2VBYm92ZUFuZEJvdHRvbSAvIDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RmxleExpbmVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtbXlTcGFjZUZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkdW1teVNwYWNlRmxleExpbmUuX2Nyb3NzU2l6ZSA9IHNwYWNlQWJvdmVBbmRCb3R0b207XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgZmxleExpbmVTaXplID0gdGhpcy5fZmxleExpbmVzLmxlbmd0aDsgaSA8IGZsZXhMaW5lU2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmxleExpbmVzLnB1c2goZHVtbXlTcGFjZUZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZsZXhMaW5lID0gdGhpcy5fZmxleExpbmVzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZsZXhMaW5lcy5wdXNoKGZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gdGhpcy5fZmxleExpbmVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmxleExpbmVzLnB1c2goZHVtbXlTcGFjZUZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9mbGV4TGluZXMgPSBuZXdGbGV4TGluZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduQ29udGVudC5GTEVYX0VORDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYWNlVG9wID0gc2l6ZSAtIHRvdGFsQ3Jvc3NTaXplXzE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVtbXlTcGFjZUZsZXhMaW5lID0gbmV3IEZsZXhMaW5lKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkdW1teVNwYWNlRmxleExpbmUuX2Nyb3NzU2l6ZSA9IHNwYWNlVG9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmxleExpbmVzLnVuc2hpZnQoZHVtbXlTcGFjZUZsZXhMaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fc3RyZXRjaFZpZXdzID0gZnVuY3Rpb24gKGZsZXhEaXJlY3Rpb24sIGFsaWduSXRlbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGFsaWduSXRlbXMgPT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuU1RSRVRDSCkge1xuICAgICAgICAgICAgdmFyIHZpZXdJbmRleF8yID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2ZsZXhMaW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChmbGV4TGluZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmxleExpbmUuaXRlbUNvdW50OyBpKyssIHZpZXdJbmRleF8yKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBfdGhpcy5fZ2V0UmVvcmRlcmVkQ2hpbGRBdCh2aWV3SW5kZXhfMik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGlnblNlbGYgPSBGbGV4Ym94TGF5b3V0LmdldEFsaWduU2VsZih2aWV3KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsaWduU2VsZiAhPT0gXCJhdXRvXCIgJiYgYWxpZ25TZWxmICE9PSBcInN0cmV0Y2hcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChmbGV4RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdHJldGNoVmlld1ZlcnRpY2FsbHkodmlldywgZmxleExpbmUuX2Nyb3NzU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9zdHJldGNoVmlld0hvcml6b250YWxseSh2aWV3LCBmbGV4TGluZS5fY3Jvc3NTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBmbGV4IGRpcmVjdGlvbjogXCIgKyBmbGV4RGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZmxleExpbmVzLmZvckVhY2goZnVuY3Rpb24gKGZsZXhMaW5lKSB7XG4gICAgICAgICAgICAgICAgZmxleExpbmUuX2luZGljZXNBbGlnblNlbGZTdHJldGNoLmZvckVhY2goZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gX3RoaXMuX2dldFJlb3JkZXJlZENoaWxkQXQoaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGZsZXhEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1c6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XX1JFVkVSU0U6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0cmV0Y2hWaWV3VmVydGljYWxseSh2aWV3LCBmbGV4TGluZS5fY3Jvc3NTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5DT0xVTU46XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OX1JFVkVSU0U6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0cmV0Y2hWaWV3SG9yaXpvbnRhbGx5KHZpZXcsIGZsZXhMaW5lLl9jcm9zc1NpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZsZXggZGlyZWN0aW9uOiBcIiArIGZsZXhEaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX3N0cmV0Y2hWaWV3VmVydGljYWxseSA9IGZ1bmN0aW9uICh2aWV3LCBjcm9zc1NpemUpIHtcbiAgICAgICAgdmFyIG5ld0hlaWdodCA9IGNyb3NzU2l6ZSAtIHZpZXcuZWZmZWN0aXZlTWFyZ2luVG9wIC0gdmlldy5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgIG5ld0hlaWdodCA9IE1hdGgubWF4KG5ld0hlaWdodCwgMCk7XG4gICAgICAgIHZhciBvcmlnaW5hbE1lYXN1cmVkV2lkdGggPSB2aWV3LmdldE1lYXN1cmVkV2lkdGgoKTtcbiAgICAgICAgdmFyIGNoaWxkV2lkdGhNZWFzdXJlU3BlYyA9IEZsZXhib3hMYXlvdXQuZ2V0Q2hpbGRNZWFzdXJlU3BlYyh0aGlzLl9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYywgdmlldy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHZpZXcuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdmlldy5lZmZlY3RpdmVNYXJnaW5MZWZ0XG4gICAgICAgICAgICArIHZpZXcuZWZmZWN0aXZlTWFyZ2luUmlnaHQsIHZpZXcuZWZmZWN0aXZlV2lkdGggPCAwID8gV1JBUF9DT05URU5UIDogTWF0aC5taW4odmlldy5lZmZlY3RpdmVXaWR0aCwgb3JpZ2luYWxNZWFzdXJlZFdpZHRoKSk7XG4gICAgICAgIHZpZXcubWVhc3VyZShjaGlsZFdpZHRoTWVhc3VyZVNwZWMsIG1ha2VNZWFzdXJlU3BlYyhuZXdIZWlnaHQsIEVYQUNUTFkpKTtcbiAgICAgICAgaWYgKG9yaWdpbmFsTWVhc3VyZWRXaWR0aCA+IHZpZXcuZ2V0TWVhc3VyZWRXaWR0aCgpKSB7XG4gICAgICAgICAgICBjaGlsZFdpZHRoTWVhc3VyZVNwZWMgPSBtYWtlTWVhc3VyZVNwZWMob3JpZ2luYWxNZWFzdXJlZFdpZHRoLCBFWEFDVExZKTtcbiAgICAgICAgICAgIHZpZXcubWVhc3VyZShjaGlsZFdpZHRoTWVhc3VyZVNwZWMsIG1ha2VNZWFzdXJlU3BlYyhuZXdIZWlnaHQsIEVYQUNUTFkpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX3N0cmV0Y2hWaWV3SG9yaXpvbnRhbGx5ID0gZnVuY3Rpb24gKHZpZXcsIGNyb3NzU2l6ZSkge1xuICAgICAgICB2YXIgbmV3V2lkdGggPSBjcm9zc1NpemUgLSB2aWV3LmVmZmVjdGl2ZU1hcmdpbkxlZnQgLSB2aWV3LmVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICBuZXdXaWR0aCA9IE1hdGgubWF4KG5ld1dpZHRoLCAwKTtcbiAgICAgICAgdmlldy5tZWFzdXJlKG1ha2VNZWFzdXJlU3BlYyhuZXdXaWR0aCwgRVhBQ1RMWSksIG1ha2VNZWFzdXJlU3BlYyh2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCksIEVYQUNUTFkpKTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLl9zZXRNZWFzdXJlZERpbWVuc2lvbkZvckZsZXggPSBmdW5jdGlvbiAoZmxleERpcmVjdGlvbiwgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMsIGNoaWxkU3RhdGUpIHtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoU2l6ZSA9IGdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0U2l6ZSA9IGdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBjYWxjdWxhdGVkTWF4SGVpZ2h0O1xuICAgICAgICB2YXIgY2FsY3VsYXRlZE1heFdpZHRoO1xuICAgICAgICBzd2l0Y2ggKGZsZXhEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1c6XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XX1JFVkVSU0U6XG4gICAgICAgICAgICAgICAgY2FsY3VsYXRlZE1heEhlaWdodCA9IHRoaXMuX2dldFN1bU9mQ3Jvc3NTaXplKCkgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICAgICAgY2FsY3VsYXRlZE1heFdpZHRoID0gdGhpcy5fZ2V0TGFyZ2VzdE1haW5TaXplKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OOlxuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLkNPTFVNTl9SRVZFUlNFOlxuICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWRNYXhIZWlnaHQgPSB0aGlzLl9nZXRMYXJnZXN0TWFpblNpemUoKTtcbiAgICAgICAgICAgICAgICBjYWxjdWxhdGVkTWF4V2lkdGggPSB0aGlzLl9nZXRTdW1PZkNyb3NzU2l6ZSgpICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZsZXggZGlyZWN0aW9uOiBcIiArIGZsZXhEaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3aWR0aFNpemVBbmRTdGF0ZTtcbiAgICAgICAgc3dpdGNoICh3aWR0aE1vZGUpIHtcbiAgICAgICAgICAgIGNhc2UgRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICBpZiAod2lkdGhTaXplIDwgY2FsY3VsYXRlZE1heFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkU3RhdGUgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LmNvbWJpbmVNZWFzdXJlZFN0YXRlcyhjaGlsZFN0YXRlLCBNRUFTVVJFRF9TVEFURV9UT09fU01BTEwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB3aWR0aFNpemVBbmRTdGF0ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZSh3aWR0aFNpemUsIHdpZHRoU2l6ZSwgd2lkdGhNb2RlLCBjaGlsZFN0YXRlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQVRfTU9TVDoge1xuICAgICAgICAgICAgICAgIGlmICh3aWR0aFNpemUgPCBjYWxjdWxhdGVkTWF4V2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRTdGF0ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcuY29tYmluZU1lYXN1cmVkU3RhdGVzKGNoaWxkU3RhdGUsIE1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aFNpemUgPSBjYWxjdWxhdGVkTWF4V2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHdpZHRoU2l6ZUFuZFN0YXRlID0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHdpZHRoU2l6ZSwgd2lkdGhTaXplLCB3aWR0aE1vZGUsIGNoaWxkU3RhdGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBVTlNQRUNJRklFRDoge1xuICAgICAgICAgICAgICAgIHdpZHRoU2l6ZUFuZFN0YXRlID0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKGNhbGN1bGF0ZWRNYXhXaWR0aCwgd2lkdGhTaXplLCB3aWR0aE1vZGUsIGNoaWxkU3RhdGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIHdpZHRoIG1vZGUgaXMgc2V0OiBcIiArIHdpZHRoTW9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhlaWdodFNpemVBbmRTdGF0ZTtcbiAgICAgICAgc3dpdGNoIChoZWlnaHRNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIEVYQUNUTFk6XG4gICAgICAgICAgICAgICAgaWYgKGhlaWdodFNpemUgPCBjYWxjdWxhdGVkTWF4SGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkU3RhdGUgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LmNvbWJpbmVNZWFzdXJlZFN0YXRlcyhjaGlsZFN0YXRlLCBNRUFTVVJFRF9TVEFURV9UT09fU01BTEwgPj4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lk1FQVNVUkVEX0hFSUdIVF9TVEFURV9TSElGVCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlaWdodFNpemVBbmRTdGF0ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShoZWlnaHRTaXplLCBoZWlnaHRTaXplLCBoZWlnaHRNb2RlLCBjaGlsZFN0YXRlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgQVRfTU9TVDoge1xuICAgICAgICAgICAgICAgIGlmIChoZWlnaHRTaXplIDwgY2FsY3VsYXRlZE1heEhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZFN0YXRlID0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuVmlldy5jb21iaW5lTWVhc3VyZWRTdGF0ZXMoY2hpbGRTdGF0ZSwgTUVBU1VSRURfU1RBVEVfVE9PX1NNQUxMID4+IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0U2l6ZSA9IGNhbGN1bGF0ZWRNYXhIZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlaWdodFNpemVBbmRTdGF0ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShoZWlnaHRTaXplLCBoZWlnaHRTaXplLCBoZWlnaHRNb2RlLCBjaGlsZFN0YXRlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgVU5TUEVDSUZJRUQ6IHtcbiAgICAgICAgICAgICAgICBoZWlnaHRTaXplQW5kU3RhdGUgPSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUoY2FsY3VsYXRlZE1heEhlaWdodCwgaGVpZ2h0U2l6ZSwgaGVpZ2h0TW9kZSwgY2hpbGRTdGF0ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gaGVpZ2h0IG1vZGUgaXMgc2V0OiBcIiArIGhlaWdodE1vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhTaXplQW5kU3RhdGUsIGhlaWdodFNpemVBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5faXNXcmFwUmVxdWlyZWQgPSBmdW5jdGlvbiAoY2hpbGQsIG1vZGUsIG1heFNpemUsIGN1cnJlbnRMZW5ndGgsIGNoaWxkTGVuZ3RoLCBjaGlsZEFic29sdXRlSW5kZXgsIGNoaWxkUmVsYXRpdmVJbmRleEluRmxleExpbmUpIHtcbiAgICAgICAgaWYgKHRoaXMuZmxleFdyYXAgPT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLk5PV1JBUCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChGbGV4Ym94TGF5b3V0LmdldEZsZXhXcmFwQmVmb3JlKGNoaWxkKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGUgPT09IFVOU1BFQ0lGSUVEKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heFNpemUgPCBjdXJyZW50TGVuZ3RoICsgY2hpbGRMZW5ndGg7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fZ2V0TGFyZ2VzdE1haW5TaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmxleExpbmVzLnJlZHVjZShmdW5jdGlvbiAobWF4LCBmbGV4TGluZSkgeyByZXR1cm4gTWF0aC5tYXgobWF4LCBmbGV4TGluZS5tYWluU2l6ZSk7IH0sIE51bWJlci5NSU5fVkFMVUUpO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX2dldFN1bU9mQ3Jvc3NTaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZmxleExpbmVzLnJlZHVjZShmdW5jdGlvbiAoc3VtLCBmbGV4TGluZSkgeyByZXR1cm4gc3VtICsgZmxleExpbmUuX2Nyb3NzU2l6ZTsgfSwgMCk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5faXNNYWluQXhpc0RpcmVjdGlvbkhvcml6b250YWwgPSBmdW5jdGlvbiAoZmxleERpcmVjdGlvbikge1xuICAgICAgICByZXR1cm4gZmxleERpcmVjdGlvbiA9PT0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1cgfHwgZmxleERpcmVjdGlvbiA9PT0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleERpcmVjdGlvbi5ST1dfUkVWRVJTRTtcbiAgICB9O1xuICAgIEZsZXhib3hMYXlvdXQucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2YXIgaW5zZXRzID0gdGhpcy5nZXRTYWZlQXJlYUluc2V0cygpO1xuICAgICAgICB2YXIgaXNSdGw7XG4gICAgICAgIHN3aXRjaCAodGhpcy5mbGV4RGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uUk9XOlxuICAgICAgICAgICAgICAgIGlzUnRsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGF5b3V0SG9yaXpvbnRhbChpc1J0bCwgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4RGlyZWN0aW9uLlJPV19SRVZFUlNFOlxuICAgICAgICAgICAgICAgIGlzUnRsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXlvdXRIb3Jpem9udGFsKGlzUnRsLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIGluc2V0cyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OOlxuICAgICAgICAgICAgICAgIGlzUnRsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmxleFdyYXAgPT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBfUkVWRVJTRSkge1xuICAgICAgICAgICAgICAgICAgICBpc1J0bCA9ICFpc1J0bDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbGF5b3V0VmVydGljYWwoaXNSdGwsIGZhbHNlLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIGluc2V0cyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhEaXJlY3Rpb24uQ09MVU1OX1JFVkVSU0U6XG4gICAgICAgICAgICAgICAgaXNSdGwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mbGV4V3JhcCA9PT0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleFdyYXAuV1JBUF9SRVZFUlNFKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzUnRsID0gIWlzUnRsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9sYXlvdXRWZXJ0aWNhbChpc1J0bCwgdHJ1ZSwgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZsZXggZGlyZWN0aW9uIGlzIHNldDogXCIgKyB0aGlzLmZsZXhEaXJlY3Rpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fbGF5b3V0SG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChpc1J0bCwgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHBhZGRpbmdMZWZ0ID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGluc2V0cy5sZWZ0O1xuICAgICAgICB2YXIgcGFkZGluZ1RvcCA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGluc2V0cy50b3A7XG4gICAgICAgIHZhciBwYWRkaW5nUmlnaHQgPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIGluc2V0cy5yaWdodDtcbiAgICAgICAgdmFyIHBhZGRpbmdCb3R0b20gPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBpbnNldHMuYm90dG9tO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0O1xuICAgICAgICB2YXIgY3VycmVudFZpZXdJbmRleCA9IDA7XG4gICAgICAgIHZhciBoZWlnaHQgPSBib3R0b20gLSB0b3A7XG4gICAgICAgIHZhciB3aWR0aCA9IHJpZ2h0IC0gbGVmdDtcbiAgICAgICAgdmFyIGNoaWxkQm90dG9tID0gaGVpZ2h0IC0gcGFkZGluZ0JvdHRvbTtcbiAgICAgICAgdmFyIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgdmFyIGNoaWxkUmlnaHQ7XG4gICAgICAgIHRoaXMuX2ZsZXhMaW5lcy5mb3JFYWNoKGZ1bmN0aW9uIChmbGV4TGluZSwgaSkge1xuICAgICAgICAgICAgdmFyIHNwYWNlQmV0d2Vlbkl0ZW0gPSAwLjA7XG4gICAgICAgICAgICBzd2l0Y2ggKF90aGlzLmp1c3RpZnlDb250ZW50KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5GTEVYX1NUQVJUOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSBwYWRkaW5nTGVmdDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRSaWdodCA9IHdpZHRoIC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkZMRVhfRU5EOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSB3aWR0aCAtIGZsZXhMaW5lLl9tYWluU2l6ZSArIHBhZGRpbmdSaWdodDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRSaWdodCA9IGZsZXhMaW5lLl9tYWluU2l6ZSAtIHBhZGRpbmdMZWZ0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkNFTlRFUjpcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gcGFkZGluZ0xlZnQgKyAod2lkdGggLSBpbnNldHMubGVmdCAtIGluc2V0cy5yaWdodCAtIGZsZXhMaW5lLl9tYWluU2l6ZSkgLyAyLjA7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkUmlnaHQgPSB3aWR0aCAtIHBhZGRpbmdSaWdodCAtICh3aWR0aCAtIGluc2V0cy5sZWZ0IC0gaW5zZXRzLnJpZ2h0IC0gZmxleExpbmUuX21haW5TaXplKSAvIDIuMDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5TUEFDRV9BUk9VTkQ6XG4gICAgICAgICAgICAgICAgICAgIGlmIChmbGV4TGluZS5faXRlbUNvdW50ICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcGFjZUJldHdlZW5JdGVtID0gKHdpZHRoIC0gaW5zZXRzLmxlZnQgLSBpbnNldHMucmlnaHQgLSBmbGV4TGluZS5tYWluU2l6ZSkgLyBmbGV4TGluZS5faXRlbUNvdW50O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHBhZGRpbmdMZWZ0ICsgc3BhY2VCZXR3ZWVuSXRlbSAvIDIuMDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRSaWdodCA9IHdpZHRoIC0gcGFkZGluZ1JpZ2h0IC0gc3BhY2VCZXR3ZWVuSXRlbSAvIDIuMDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5TUEFDRV9CRVRXRUVOOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZExlZnQgPSBwYWRkaW5nTGVmdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZmxleExpbmUuaXRlbUNvdW50ICE9PSAxID8gZmxleExpbmUuaXRlbUNvdW50IC0gMSA6IDEuMDtcbiAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuSXRlbSA9ICh3aWR0aCAtIGluc2V0cy5sZWZ0IC0gaW5zZXRzLnJpZ2h0IC0gZmxleExpbmUubWFpblNpemUpIC8gZGVub21pbmF0b3I7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkUmlnaHQgPSB3aWR0aCAtIHBhZGRpbmdSaWdodDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBqdXN0aWZ5Q29udGVudCBpcyBzZXQ6IFwiICsgX3RoaXMuanVzdGlmeUNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuSXRlbSA9IE1hdGgubWF4KHNwYWNlQmV0d2Vlbkl0ZW0sIDApO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmbGV4TGluZS5pdGVtQ291bnQ7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IF90aGlzLl9nZXRSZW9yZGVyZWRDaGlsZEF0KGN1cnJlbnRWaWV3SW5kZXgpO1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hpbGQuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFZpZXdJbmRleCsrO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGxwID0gY2hpbGQ7XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ICs9IGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgICAgICAgICAgY2hpbGRSaWdodCAtPSBscC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZmxleFdyYXAgPT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBfUkVWRVJTRSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNSdGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9sYXlvdXRTaW5nbGVDaGlsZEhvcml6b250YWwoY2hpbGQsIGZsZXhMaW5lLCBfdGhpcy5mbGV4V3JhcCwgX3RoaXMuYWxpZ25JdGVtcywgTWF0aC5yb3VuZChjaGlsZFJpZ2h0KSAtIGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSwgY2hpbGRCb3R0b20gLSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpLCBNYXRoLnJvdW5kKGNoaWxkUmlnaHQpLCBjaGlsZEJvdHRvbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGF5b3V0U2luZ2xlQ2hpbGRIb3Jpem9udGFsKGNoaWxkLCBmbGV4TGluZSwgX3RoaXMuZmxleFdyYXAsIF90aGlzLmFsaWduSXRlbXMsIE1hdGgucm91bmQoY2hpbGRMZWZ0KSwgY2hpbGRCb3R0b20gLSBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpLCBNYXRoLnJvdW5kKGNoaWxkTGVmdCkgKyBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCksIGNoaWxkQm90dG9tKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzUnRsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGF5b3V0U2luZ2xlQ2hpbGRIb3Jpem9udGFsKGNoaWxkLCBmbGV4TGluZSwgX3RoaXMuZmxleFdyYXAsIF90aGlzLmFsaWduSXRlbXMsIE1hdGgucm91bmQoY2hpbGRSaWdodCkgLSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCksIGNoaWxkVG9wLCBNYXRoLnJvdW5kKGNoaWxkUmlnaHQpLCBjaGlsZFRvcCArIGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xheW91dFNpbmdsZUNoaWxkSG9yaXpvbnRhbChjaGlsZCwgZmxleExpbmUsIF90aGlzLmZsZXhXcmFwLCBfdGhpcy5hbGlnbkl0ZW1zLCBNYXRoLnJvdW5kKGNoaWxkTGVmdCksIGNoaWxkVG9wLCBNYXRoLnJvdW5kKGNoaWxkTGVmdCkgKyBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCksIGNoaWxkVG9wICsgY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ICs9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIHNwYWNlQmV0d2Vlbkl0ZW0gKyBscC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgICAgICBjaGlsZFJpZ2h0IC09IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIHNwYWNlQmV0d2Vlbkl0ZW0gKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0O1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWaWV3SW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gY2hpbGQuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fbGVmdCA9IE1hdGgubWluKGZsZXhMaW5lLl9sZWZ0LCBib3VuZHMubGVmdCAtIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQpO1xuICAgICAgICAgICAgICAgIGZsZXhMaW5lLl90b3AgPSBNYXRoLm1pbihmbGV4TGluZS5fdG9wLCBib3VuZHMudG9wIC0gbHAuZWZmZWN0aXZlTWFyZ2luVG9wKTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fcmlnaHQgPSBNYXRoLm1heChmbGV4TGluZS5fcmlnaHQsIGJvdW5kcy5yaWdodCArIGxwLmVmZmVjdGl2ZU1hcmdpblJpZ2h0KTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fYm90dG9tID0gTWF0aC5tYXgoZmxleExpbmUuX2JvdHRvbSwgYm91bmRzLmJvdHRvbSArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZFRvcCArPSBmbGV4TGluZS5fY3Jvc3NTaXplO1xuICAgICAgICAgICAgY2hpbGRCb3R0b20gLT0gZmxleExpbmUuX2Nyb3NzU2l6ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fbGF5b3V0U2luZ2xlQ2hpbGRIb3Jpem9udGFsID0gZnVuY3Rpb24gKHZpZXcsIGZsZXhMaW5lLCBmbGV4V3JhcCwgYWxpZ25JdGVtcywgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHZhciBscCA9IHZpZXc7XG4gICAgICAgIHZhciBhbGlnblNlbGYgPSBGbGV4Ym94TGF5b3V0LmdldEFsaWduU2VsZih2aWV3KTtcbiAgICAgICAgaWYgKGFsaWduU2VsZiAhPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIGFsaWduSXRlbXMgPSBhbGlnblNlbGY7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNyb3NzU2l6ZSA9IGZsZXhMaW5lLl9jcm9zc1NpemU7XG4gICAgICAgIHN3aXRjaCAoYWxpZ25JdGVtcykge1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkZMRVhfU1RBUlQ6XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuU1RSRVRDSDpcbiAgICAgICAgICAgICAgICBpZiAoZmxleFdyYXAgIT09IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkZsZXhXcmFwLldSQVBfUkVWRVJTRSkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0LCB0b3AgKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3AsIHJpZ2h0LCBib3R0b20gKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5sYXlvdXQobGVmdCwgdG9wIC0gbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tLCByaWdodCwgYm90dG9tIC0gbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuQkFTRUxJTkU6XG4gICAgICAgICAgICAgICAgaWYgKGZsZXhXcmFwICE9PSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4V3JhcC5XUkFQX1JFVkVSU0UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmdpblRvcCA9IGZsZXhMaW5lLl9tYXhCYXNlbGluZSAtIEZsZXhib3hMYXlvdXQuZ2V0QmFzZWxpbmUodmlldyk7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpblRvcCA9IE1hdGgubWF4KG1hcmdpblRvcCwgbHAuZWZmZWN0aXZlTWFyZ2luVG9wKTtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5sYXlvdXQobGVmdCwgdG9wICsgbWFyZ2luVG9wLCByaWdodCwgYm90dG9tICsgbWFyZ2luVG9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXJnaW5Cb3R0b20gPSBmbGV4TGluZS5fbWF4QmFzZWxpbmUgLSB2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBGbGV4Ym94TGF5b3V0LmdldEJhc2VsaW5lKHZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW5Cb3R0b20gPSBNYXRoLm1heChtYXJnaW5Cb3R0b20sIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcubGF5b3V0KGxlZnQsIHRvcCAtIG1hcmdpbkJvdHRvbSwgcmlnaHQsIGJvdHRvbSAtIG1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLkZMRVhfRU5EOlxuICAgICAgICAgICAgICAgIGlmIChmbGV4V3JhcCAhPT0gZmxleGJveF9sYXlvdXRfY29tbW9uXzEuRmxleFdyYXAuV1JBUF9SRVZFUlNFKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcubGF5b3V0KGxlZnQsIHRvcCArIGNyb3NzU2l6ZSAtIHZpZXcuZ2V0TWVhc3VyZWRIZWlnaHQoKSAtIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSwgcmlnaHQsIHRvcCArIGNyb3NzU2l6ZSAtIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0LCB0b3AgLSBjcm9zc1NpemUgKyB2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3AsIHJpZ2h0LCBib3R0b20gLSBjcm9zc1NpemUgKyB2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25JdGVtcy5DRU5URVI6XG4gICAgICAgICAgICAgICAgdmFyIHRvcEZyb21Dcm9zc0F4aXMgPSAoY3Jvc3NTaXplIC0gdmlldy5nZXRNZWFzdXJlZEhlaWdodCgpKSAvIDI7XG4gICAgICAgICAgICAgICAgaWYgKGZsZXhXcmFwICE9PSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4V3JhcC5XUkFQX1JFVkVSU0UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5sYXlvdXQobGVmdCwgdG9wICsgdG9wRnJvbUNyb3NzQXhpcyArIGxwLmVmZmVjdGl2ZU1hcmdpblRvcCAtIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSwgcmlnaHQsIHRvcCArIHRvcEZyb21Dcm9zc0F4aXMgKyB2aWV3LmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3BcbiAgICAgICAgICAgICAgICAgICAgICAgIC0gbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcubGF5b3V0KGxlZnQsIHRvcCAtIHRvcEZyb21Dcm9zc0F4aXMgKyBscC5lZmZlY3RpdmVNYXJnaW5Ub3AgLSBscC5lZmZlY3RpdmVNYXJnaW5Cb3R0b20sIHJpZ2h0LCB0b3AgLSB0b3BGcm9tQ3Jvc3NBeGlzICsgdmlldy5nZXRNZWFzdXJlZEhlaWdodCgpICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wXG4gICAgICAgICAgICAgICAgICAgICAgICAtIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGbGV4Ym94TGF5b3V0LnByb3RvdHlwZS5fbGF5b3V0VmVydGljYWwgPSBmdW5jdGlvbiAoaXNSdGwsIGZyb21Cb3R0b21Ub1RvcCwgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHBhZGRpbmdMZWZ0ID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGluc2V0cy5sZWZ0O1xuICAgICAgICB2YXIgcGFkZGluZ1RvcCA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGluc2V0cy50b3A7XG4gICAgICAgIHZhciBwYWRkaW5nUmlnaHQgPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIGluc2V0cy5yaWdodDtcbiAgICAgICAgdmFyIHBhZGRpbmdCb3R0b20gPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBpbnNldHMuYm90dG9tO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0ID0gcGFkZGluZ0xlZnQ7XG4gICAgICAgIHZhciBjdXJyZW50Vmlld0luZGV4ID0gMDtcbiAgICAgICAgdmFyIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xuICAgICAgICB2YXIgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xuICAgICAgICB2YXIgY2hpbGRSaWdodCA9IHdpZHRoIC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICB2YXIgY2hpbGRUb3A7XG4gICAgICAgIHZhciBjaGlsZEJvdHRvbTtcbiAgICAgICAgdGhpcy5fZmxleExpbmVzLmZvckVhY2goZnVuY3Rpb24gKGZsZXhMaW5lKSB7XG4gICAgICAgICAgICB2YXIgc3BhY2VCZXR3ZWVuSXRlbSA9IDAuMDtcbiAgICAgICAgICAgIHN3aXRjaCAoX3RoaXMuanVzdGlmeUNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkZMRVhfU1RBUlQ6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRCb3R0b20gPSBoZWlnaHQgLSBwYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkp1c3RpZnlDb250ZW50LkZMRVhfRU5EOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IGhlaWdodCAtIGZsZXhMaW5lLl9tYWluU2l6ZSArIHBhZGRpbmdCb3R0b207XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkQm90dG9tID0gZmxleExpbmUuX21haW5TaXplIC0gcGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5DRU5URVI6XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gcGFkZGluZ1RvcCArIChoZWlnaHQgLSBpbnNldHMudG9wIC0gaW5zZXRzLmJvdHRvbSAtIGZsZXhMaW5lLl9tYWluU2l6ZSkgLyAyLjA7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkQm90dG9tID0gaGVpZ2h0IC0gcGFkZGluZ0JvdHRvbSAtIChoZWlnaHQgLSBpbnNldHMudG9wIC0gaW5zZXRzLmJvdHRvbSAtIGZsZXhMaW5lLl9tYWluU2l6ZSkgLyAyLjA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuSnVzdGlmeUNvbnRlbnQuU1BBQ0VfQVJPVU5EOlxuICAgICAgICAgICAgICAgICAgICBpZiAoZmxleExpbmUuX2l0ZW1Db3VudCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuSXRlbSA9IChoZWlnaHQgLSBpbnNldHMudG9wIC0gaW5zZXRzLmJvdHRvbSAtIGZsZXhMaW5lLl9tYWluU2l6ZSkgLyBmbGV4TGluZS5pdGVtQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2hpbGRUb3AgPSBwYWRkaW5nVG9wICsgc3BhY2VCZXR3ZWVuSXRlbSAvIDIuMDtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRCb3R0b20gPSBoZWlnaHQgLSBwYWRkaW5nQm90dG9tIC0gc3BhY2VCZXR3ZWVuSXRlbSAvIDIuMDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5KdXN0aWZ5Q29udGVudC5TUEFDRV9CRVRXRUVOOlxuICAgICAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHBhZGRpbmdUb3A7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGZsZXhMaW5lLml0ZW1Db3VudCAhPT0gMSA/IGZsZXhMaW5lLml0ZW1Db3VudCAtIDEgOiAxLjA7XG4gICAgICAgICAgICAgICAgICAgIHNwYWNlQmV0d2Vlbkl0ZW0gPSAoaGVpZ2h0IC0gaW5zZXRzLnRvcCAtIGluc2V0cy5ib3R0b20gLSBmbGV4TGluZS5tYWluU2l6ZSkgLyBkZW5vbWluYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRCb3R0b20gPSBoZWlnaHQgLSBwYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGp1c3RpZnlDb250ZW50IGlzIHNldDogXCIgKyBfdGhpcy5qdXN0aWZ5Q29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzcGFjZUJldHdlZW5JdGVtID0gTWF0aC5tYXgoc3BhY2VCZXR3ZWVuSXRlbSwgMCk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZsZXhMaW5lLml0ZW1Db3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gX3RoaXMuX2dldFJlb3JkZXJlZENoaWxkQXQoY3VycmVudFZpZXdJbmRleCk7XG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Vmlld0luZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbHAgPSBjaGlsZDtcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCArPSBscC5lZmZlY3RpdmVNYXJnaW5Ub3A7XG4gICAgICAgICAgICAgICAgY2hpbGRCb3R0b20gLT0gbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgICAgIGlmIChpc1J0bCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnJvbUJvdHRvbVRvVG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGF5b3V0U2luZ2xlQ2hpbGRWZXJ0aWNhbChjaGlsZCwgZmxleExpbmUsIHRydWUsIF90aGlzLmFsaWduSXRlbXMsIGNoaWxkUmlnaHQgLSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCksIE1hdGgucm91bmQoY2hpbGRCb3R0b20pIC0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSwgY2hpbGRSaWdodCwgTWF0aC5yb3VuZChjaGlsZEJvdHRvbSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xheW91dFNpbmdsZUNoaWxkVmVydGljYWwoY2hpbGQsIGZsZXhMaW5lLCB0cnVlLCBfdGhpcy5hbGlnbkl0ZW1zLCBjaGlsZFJpZ2h0IC0gY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpLCBNYXRoLnJvdW5kKGNoaWxkVG9wKSwgY2hpbGRSaWdodCwgTWF0aC5yb3VuZChjaGlsZFRvcCkgKyBjaGlsZC5nZXRNZWFzdXJlZEhlaWdodCgpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZyb21Cb3R0b21Ub1RvcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xheW91dFNpbmdsZUNoaWxkVmVydGljYWwoY2hpbGQsIGZsZXhMaW5lLCBmYWxzZSwgX3RoaXMuYWxpZ25JdGVtcywgY2hpbGRMZWZ0LCBNYXRoLnJvdW5kKGNoaWxkQm90dG9tKSAtIGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCksIGNoaWxkTGVmdCArIGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSwgTWF0aC5yb3VuZChjaGlsZEJvdHRvbSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xheW91dFNpbmdsZUNoaWxkVmVydGljYWwoY2hpbGQsIGZsZXhMaW5lLCBmYWxzZSwgX3RoaXMuYWxpZ25JdGVtcywgY2hpbGRMZWZ0LCBNYXRoLnJvdW5kKGNoaWxkVG9wKSwgY2hpbGRMZWZ0ICsgY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpLCBNYXRoLnJvdW5kKGNoaWxkVG9wKSArIGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNoaWxkVG9wICs9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBzcGFjZUJldHdlZW5JdGVtICsgbHAuZWZmZWN0aXZlTWFyZ2luQm90dG9tO1xuICAgICAgICAgICAgICAgIGNoaWxkQm90dG9tIC09IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBzcGFjZUJldHdlZW5JdGVtICsgbHAuZWZmZWN0aXZlTWFyZ2luVG9wO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWaWV3SW5kZXgrKztcbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gY2hpbGQuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMoKTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fbGVmdCA9IE1hdGgubWluKGZsZXhMaW5lLl9sZWZ0LCBib3VuZHMubGVmdCAtIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQpO1xuICAgICAgICAgICAgICAgIGZsZXhMaW5lLl90b3AgPSBNYXRoLm1pbihmbGV4TGluZS5fdG9wLCBib3VuZHMudG9wIC0gbHAuZWZmZWN0aXZlTWFyZ2luVG9wKTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fcmlnaHQgPSBNYXRoLm1heChmbGV4TGluZS5fcmlnaHQsIGJvdW5kcy5yaWdodCArIGxwLmVmZmVjdGl2ZU1hcmdpblJpZ2h0KTtcbiAgICAgICAgICAgICAgICBmbGV4TGluZS5fYm90dG9tID0gTWF0aC5tYXgoZmxleExpbmUuX2JvdHRvbSwgYm91bmRzLmJvdHRvbSArIGxwLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZExlZnQgKz0gZmxleExpbmUuY3Jvc3NTaXplO1xuICAgICAgICAgICAgY2hpbGRSaWdodCAtPSBmbGV4TGluZS5jcm9zc1NpemU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmxleGJveExheW91dC5wcm90b3R5cGUuX2xheW91dFNpbmdsZUNoaWxkVmVydGljYWwgPSBmdW5jdGlvbiAodmlldywgZmxleExpbmUsIGlzUnRsLCBhbGlnbkl0ZW1zLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIGxwID0gdmlldztcbiAgICAgICAgdmFyIGFsaWduU2VsZiA9IEZsZXhib3hMYXlvdXQuZ2V0QWxpZ25TZWxmKHZpZXcpO1xuICAgICAgICBpZiAoYWxpZ25TZWxmICE9PSBcImF1dG9cIikge1xuICAgICAgICAgICAgYWxpZ25JdGVtcyA9IGFsaWduU2VsZjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3Jvc3NTaXplID0gZmxleExpbmUuY3Jvc3NTaXplO1xuICAgICAgICBzd2l0Y2ggKGFsaWduSXRlbXMpIHtcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25JdGVtcy5GTEVYX1NUQVJUOlxuICAgICAgICAgICAgY2FzZSBmbGV4Ym94X2xheW91dF9jb21tb25fMS5BbGlnbkl0ZW1zLlNUUkVUQ0g6XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuQkFTRUxJTkU6XG4gICAgICAgICAgICAgICAgaWYgKCFpc1J0bCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0ICsgbHAuZWZmZWN0aXZlTWFyZ2luTGVmdCwgdG9wLCByaWdodCArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQsIGJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0IC0gbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQsIHRvcCwgcmlnaHQgLSBscC5lZmZlY3RpdmVNYXJnaW5SaWdodCwgYm90dG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLkFsaWduSXRlbXMuRkxFWF9FTkQ6XG4gICAgICAgICAgICAgICAgaWYgKCFpc1J0bCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0ICsgY3Jvc3NTaXplIC0gdmlldy5nZXRNZWFzdXJlZFdpZHRoKCkgLSBscC5lZmZlY3RpdmVNYXJnaW5SaWdodCwgdG9wLCByaWdodCArIGNyb3NzU2l6ZSAtIHZpZXcuZ2V0TWVhc3VyZWRXaWR0aCgpIC0gbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQsIGJvdHRvbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0IC0gY3Jvc3NTaXplICsgdmlldy5nZXRNZWFzdXJlZFdpZHRoKCkgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0LCB0b3AsIHJpZ2h0IC0gY3Jvc3NTaXplICsgdmlldy5nZXRNZWFzdXJlZFdpZHRoKCkgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0LCBib3R0b20pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgZmxleGJveF9sYXlvdXRfY29tbW9uXzEuQWxpZ25JdGVtcy5DRU5URVI6XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRGcm9tQ3Jvc3NBeGlzID0gKGNyb3NzU2l6ZSAtIHZpZXcuZ2V0TWVhc3VyZWRXaWR0aCgpKSAvIDI7XG4gICAgICAgICAgICAgICAgaWYgKCFpc1J0bCkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LmxheW91dChsZWZ0ICsgbGVmdEZyb21Dcm9zc0F4aXMgKyBscC5lZmZlY3RpdmVNYXJnaW5MZWZ0IC0gbHAuZWZmZWN0aXZlTWFyZ2luUmlnaHQsIHRvcCwgcmlnaHQgKyBsZWZ0RnJvbUNyb3NzQXhpcyArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQgLSBscC5lZmZlY3RpdmVNYXJnaW5SaWdodCwgYm90dG9tKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcubGF5b3V0KGxlZnQgLSBsZWZ0RnJvbUNyb3NzQXhpcyArIGxwLmVmZmVjdGl2ZU1hcmdpbkxlZnQgLSBscC5lZmZlY3RpdmVNYXJnaW5SaWdodCwgdG9wLCByaWdodCAtIGxlZnRGcm9tQ3Jvc3NBeGlzICsgbHAuZWZmZWN0aXZlTWFyZ2luTGVmdCAtIGxwLmVmZmVjdGl2ZU1hcmdpblJpZ2h0LCBib3R0b20pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmxleGJveExheW91dC5nZXRDaGlsZE1lYXN1cmVTcGVjID0gZnVuY3Rpb24gKHNwZWMsIHBhZGRpbmcsIGNoaWxkRGltZW5zaW9uKSB7XG4gICAgICAgIHZhciBzcGVjTW9kZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoc3BlYyk7XG4gICAgICAgIHZhciBzcGVjU2l6ZSA9IGZsZXhib3hfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoc3BlYyk7XG4gICAgICAgIHZhciBzaXplID0gTWF0aC5tYXgoMCwgc3BlY1NpemUgLSBwYWRkaW5nKTtcbiAgICAgICAgdmFyIHJlc3VsdFNpemUgPSAwO1xuICAgICAgICB2YXIgcmVzdWx0TW9kZSA9IDA7XG4gICAgICAgIHN3aXRjaCAoc3BlY01vZGUpIHtcbiAgICAgICAgICAgIGNhc2UgRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGREaW1lbnNpb24gPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gY2hpbGREaW1lbnNpb247XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSBFWEFDVExZO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGlsZERpbWVuc2lvbiA9PT0gTUFUQ0hfUEFSRU5UKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBzaXplO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gRVhBQ1RMWTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hpbGREaW1lbnNpb24gPT09IFdSQVBfQ09OVEVOVCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IEFUX01PU1Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBBVF9NT1NUOlxuICAgICAgICAgICAgICAgIGlmIChjaGlsZERpbWVuc2lvbiA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBjaGlsZERpbWVuc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IEVYQUNUTFk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkRGltZW5zaW9uID09PSBNQVRDSF9QQVJFTlQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IHNpemU7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSBBVF9NT1NUO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGlsZERpbWVuc2lvbiA9PT0gV1JBUF9DT05URU5UKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBzaXplO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gQVRfTU9TVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFVOU1BFQ0lGSUVEOlxuICAgICAgICAgICAgICAgIGlmIChjaGlsZERpbWVuc2lvbiA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFNpemUgPSBjaGlsZERpbWVuc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IEVYQUNUTFk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkRGltZW5zaW9uID09PSBNQVRDSF9QQVJFTlQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IFZpZXdfc1VzZVplcm9VbnNwZWNpZmllZE1lYXN1cmVTcGVjID8gMCA6IHNpemU7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdE1vZGUgPSBVTlNQRUNJRklFRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hpbGREaW1lbnNpb24gPT09IFdSQVBfQ09OVEVOVCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gVmlld19zVXNlWmVyb1Vuc3BlY2lmaWVkTWVhc3VyZVNwZWMgPyAwIDogc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IFVOU1BFQ0lGSUVEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmxleGJveF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZXN1bHRTaXplLCByZXN1bHRNb2RlKTtcbiAgICB9O1xuICAgIHJldHVybiBGbGV4Ym94TGF5b3V0O1xufShmbGV4Ym94X2xheW91dF9jb21tb25fMS5GbGV4Ym94TGF5b3V0QmFzZSkpO1xuZXhwb3J0cy5GbGV4Ym94TGF5b3V0ID0gRmxleGJveExheW91dDtcbihmdW5jdGlvbiAoRmxleGJveExheW91dCkge1xuICAgIGZ1bmN0aW9uIGdldEJhc2VsaW5lKGNoaWxkKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBGbGV4Ym94TGF5b3V0LmdldEJhc2VsaW5lID0gZ2V0QmFzZWxpbmU7XG4gICAgZnVuY3Rpb24gZ2V0UGFkZGluZ1N0YXJ0KGNoaWxkKSB7XG4gICAgICAgIHJldHVybiBjaGlsZC5lZmZlY3RpdmVQYWRkaW5nTGVmdDtcbiAgICB9XG4gICAgRmxleGJveExheW91dC5nZXRQYWRkaW5nU3RhcnQgPSBnZXRQYWRkaW5nU3RhcnQ7XG4gICAgZnVuY3Rpb24gZ2V0UGFkZGluZ0VuZChjaGlsZCkge1xuICAgICAgICByZXR1cm4gY2hpbGQuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0O1xuICAgIH1cbiAgICBGbGV4Ym94TGF5b3V0LmdldFBhZGRpbmdFbmQgPSBnZXRQYWRkaW5nRW5kO1xufSkoRmxleGJveExheW91dCA9IGV4cG9ydHMuRmxleGJveExheW91dCB8fCAoZXhwb3J0cy5GbGV4Ym94TGF5b3V0ID0ge30pKTtcbmV4cG9ydHMuRmxleGJveExheW91dCA9IEZsZXhib3hMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mbGV4Ym94LWxheW91dC5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2xheW91dC1iYXNlXCIpKTtcbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhlbGVtZW50KSB7XG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImVsZW1lbnQgY2Fubm90IGJlIG51bGwgb3IgdW5kZWZpbmVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLnJvdyA9IDA7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLmNvbCA9IDA7XG5sYXlvdXRfYmFzZV8xLlZpZXcucHJvdG90eXBlLnJvd1NwYW4gPSAxO1xubGF5b3V0X2Jhc2VfMS5WaWV3LnByb3RvdHlwZS5jb2xTcGFuID0gMTtcbmZ1bmN0aW9uIHZhbGlkYXRlSXRlbVNwZWMoaXRlbVNwZWMpIHtcbiAgICBpZiAoIWl0ZW1TcGVjKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIGNhbm5vdCBiZSB1bmRlZmluZWQuXCIpO1xuICAgIH1cbiAgICBpZiAoaXRlbVNwZWMub3duZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaXRlbVNwZWMgaXMgYWxyZWFkeSBhZGRlZCB0byBHcmlkTGF5b3V0LlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0R3JpZExlbmd0aCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gR3JpZFVuaXRUeXBlLkFVVE8pIHtcbiAgICAgICAgcmV0dXJuIEl0ZW1TcGVjLmNyZWF0ZSgxLCBHcmlkVW5pdFR5cGUuQVVUTyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHZhbHVlLmluZGV4T2YoXCIqXCIpICE9PSAtMSkge1xuICAgICAgICB2YXIgc3RhckNvdW50ID0gcGFyc2VJbnQodmFsdWUucmVwbGFjZShcIipcIiwgXCJcIikgfHwgXCIxXCIpO1xuICAgICAgICByZXR1cm4gSXRlbVNwZWMuY3JlYXRlKHN0YXJDb3VudCwgR3JpZFVuaXRUeXBlLlNUQVIpO1xuICAgIH1cbiAgICBlbHNlIGlmICghaXNOYU4ocGFyc2VJbnQodmFsdWUpKSkge1xuICAgICAgICByZXR1cm4gSXRlbVNwZWMuY3JlYXRlKHBhcnNlSW50KHZhbHVlKSwgR3JpZFVuaXRUeXBlLlBJWEVMKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBwYXJzZSBpdGVtIHNwZWMgZnJvbSBzdHJpbmc6IFwiICsgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlQW5kQWRkSXRlbVNwZWNzKHZhbHVlLCBmdW5jKSB7XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXFxzLF0rLyk7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgdmFyIHN0ciA9IGFycltpXS50cmltKCk7XG4gICAgICAgIGlmIChzdHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZnVuYyhjb252ZXJ0R3JpZExlbmd0aChhcnJbaV0udHJpbSgpKSk7XG4gICAgICAgIH1cbiAgICB9XG59XG52YXIgSXRlbVNwZWMgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJdGVtU3BlYywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBJdGVtU3BlYygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FjdHVhbExlbmd0aCA9IDA7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBfdGhpcy5fdmFsdWUgPSAxO1xuICAgICAgICAgICAgX3RoaXMuX3VuaXRUeXBlID0gR3JpZFVuaXRUeXBlLlNUQVI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiICYmIHR5cGVvZiB0eXBlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCB8fCBpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBzaG91bGQgbm90IGJlIG5lZ2F0aXZlLCBOYU4gb3IgSW5maW5pdHk6IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fdW5pdFR5cGUgPSBHcmlkVW5pdFR5cGUucGFyc2UodHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGaXJzdCBhcmd1bWVudCBzaG91bGQgYmUgbnVtYmVyLCBzZWNvbmQgYXJndW1lbnQgc2hvdWxkIGJlIHN0cmluZy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJdGVtU3BlYyBleHBlY3RzIDAgb3IgMiBhcmd1bWVudHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuaW5kZXggPSAtMTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJdGVtU3BlYy5jcmVhdGUgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgICAgICAgdmFyIHNwZWMgPSBuZXcgSXRlbVNwZWMoKTtcbiAgICAgICAgc3BlYy5fdmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgc3BlYy5fdW5pdFR5cGUgPSB0eXBlO1xuICAgICAgICByZXR1cm4gc3BlYztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiYWN0dWFsTGVuZ3RoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0dWFsTGVuZ3RoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBJdGVtU3BlYy5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgcmV0dXJuICh2YWx1ZTEuZ3JpZFVuaXRUeXBlID09PSB2YWx1ZTIuZ3JpZFVuaXRUeXBlKSAmJiAodmFsdWUxLnZhbHVlID09PSB2YWx1ZTIudmFsdWUpICYmICh2YWx1ZTEub3duZXIgPT09IHZhbHVlMi5vd25lcikgJiYgKHZhbHVlMS5pbmRleCA9PT0gdmFsdWUyLmluZGV4KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiZ3JpZFVuaXRUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5pdFR5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiaXNBYnNvbHV0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlID09PSBHcmlkVW5pdFR5cGUuUElYRUw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJdGVtU3BlYy5wcm90b3R5cGUsIFwiaXNBdXRvXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5pdFR5cGUgPT09IEdyaWRVbml0VHlwZS5BVVRPO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSXRlbVNwZWMucHJvdG90eXBlLCBcImlzU3RhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuaXRUeXBlID09PSBHcmlkVW5pdFR5cGUuU1RBUjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEl0ZW1TcGVjLnByb3RvdHlwZSwgXCJ2YWx1ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gSXRlbVNwZWM7XG59KGxheW91dF9iYXNlXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5JdGVtU3BlYyA9IEl0ZW1TcGVjO1xudmFyIEdyaWRMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoR3JpZExheW91dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR3JpZExheW91dEJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fcm93cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5fY29scyA9IG5ldyBBcnJheSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEdyaWRMYXlvdXRCYXNlXzEgPSBHcmlkTGF5b3V0QmFzZTtcbiAgICBHcmlkTGF5b3V0QmFzZS5nZXRDb2x1bW4gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gdmFsaWRhdGVBcmdzKGVsZW1lbnQpLmNvbDtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnNldENvbHVtbiA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuY29sID0gdmFsdWU7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5nZXRDb2x1bW5TcGFuID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5jb2xTcGFuO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2Uuc2V0Q29sdW1uU3BhbiA9IGZ1bmN0aW9uIChlbGVtZW50LCB2YWx1ZSkge1xuICAgICAgICB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkuY29sU3BhbiA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Um93ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHZhbGlkYXRlQXJncyhlbGVtZW50KS5yb3c7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5zZXRSb3cgPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnJvdyA9IHZhbHVlO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UuZ2V0Um93U3BhbiA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZUFyZ3MoZWxlbWVudCkucm93U3BhbjtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnNldFJvd1NwYW4gPSBmdW5jdGlvbiAoZWxlbWVudCwgdmFsdWUpIHtcbiAgICAgICAgdmFsaWRhdGVBcmdzKGVsZW1lbnQpLnJvd1NwYW4gPSB2YWx1ZTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5hZGRSb3cgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgdmFsaWRhdGVJdGVtU3BlYyhpdGVtU3BlYyk7XG4gICAgICAgIGl0ZW1TcGVjLm93bmVyID0gdGhpcztcbiAgICAgICAgdGhpcy5fcm93cy5wdXNoKGl0ZW1TcGVjKTtcbiAgICAgICAgdGhpcy5fb25Sb3dBZGRlZChpdGVtU3BlYyk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmFkZENvbHVtbiA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICB2YWxpZGF0ZUl0ZW1TcGVjKGl0ZW1TcGVjKTtcbiAgICAgICAgaXRlbVNwZWMub3duZXIgPSB0aGlzO1xuICAgICAgICB0aGlzLl9jb2xzLnB1c2goaXRlbVNwZWMpO1xuICAgICAgICB0aGlzLl9vbkNvbHVtbkFkZGVkKGl0ZW1TcGVjKTtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuYWRkQ2hpbGRBdENlbGwgPSBmdW5jdGlvbiAodmlldywgcm93LCBjb2x1bW4sIHJvd1NwYW4sIGNvbHVtblNwYW4pIHtcbiAgICAgICAgdGhpcy5hZGRDaGlsZCh2aWV3KTtcbiAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRSb3codmlldywgcm93KTtcbiAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRDb2x1bW4odmlldywgY29sdW1uKTtcbiAgICAgICAgaWYgKHJvd1NwYW4pIHtcbiAgICAgICAgICAgIEdyaWRMYXlvdXRCYXNlXzEuc2V0Um93U3Bhbih2aWV3LCByb3dTcGFuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29sdW1uU3Bhbikge1xuICAgICAgICAgICAgR3JpZExheW91dEJhc2VfMS5zZXRDb2x1bW5TcGFuKHZpZXcsIGNvbHVtblNwYW4pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVtb3ZlUm93ID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgICAgIGlmICghaXRlbVNwZWMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIGlzIG51bGwuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3Jvd3MuaW5kZXhPZihpdGVtU3BlYyk7XG4gICAgICAgIGlmIChpdGVtU3BlYy5vd25lciAhPT0gdGhpcyB8fCBpbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJvdyBpcyBub3QgY2hpbGQgb2YgdGhpcyBHcmlkTGF5b3V0XCIpO1xuICAgICAgICB9XG4gICAgICAgIGl0ZW1TcGVjLmluZGV4ID0gLTE7XG4gICAgICAgIHRoaXMuX3Jvd3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fb25Sb3dSZW1vdmVkKGl0ZW1TcGVjLCBpbmRleCk7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLnJlbW92ZUNvbHVtbiA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICBpZiAoIWl0ZW1TcGVjKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBpcyBudWxsLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9jb2xzLmluZGV4T2YoaXRlbVNwZWMpO1xuICAgICAgICBpZiAoaXRlbVNwZWMub3duZXIgIT09IHRoaXMgfHwgaW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb2x1bW4gaXMgbm90IGNoaWxkIG9mIHRoaXMgR3JpZExheW91dFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpdGVtU3BlYy5pbmRleCA9IC0xO1xuICAgICAgICB0aGlzLl9jb2xzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIHRoaXMuX29uQ29sdW1uUmVtb3ZlZChpdGVtU3BlYywgaW5kZXgpO1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5yZW1vdmVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fY29scy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGNvbFNwZWMgPSB0aGlzLl9jb2xzW2ldO1xuICAgICAgICAgICAgdGhpcy5fb25Db2x1bW5SZW1vdmVkKGNvbFNwZWMsIGkpO1xuICAgICAgICAgICAgY29sU3BlYy5pbmRleCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVtb3ZlUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX3Jvd3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciByb3dTcGVjID0gdGhpcy5fcm93c1tpXTtcbiAgICAgICAgICAgIHRoaXMuX29uUm93UmVtb3ZlZChyb3dTcGVjLCBpKTtcbiAgICAgICAgICAgIHJvd1NwZWMuaW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yb3dzLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaW52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLm9uUm93Q2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUub25Sb3dTcGFuQ2hhbmdlZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUub25Db2x1bW5DaGFuZ2VkID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5vbkNvbHVtblNwYW5DaGFuZ2VkID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLmludmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5fb25Sb3dBZGRlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLl9vbkNvbHVtbkFkZGVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjKSB7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuX29uUm93UmVtb3ZlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYywgaW5kZXgpIHtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZS5fb25Db2x1bW5SZW1vdmVkID0gZnVuY3Rpb24gKGl0ZW1TcGVjLCBpbmRleCkge1xuICAgIH07XG4gICAgR3JpZExheW91dEJhc2UucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2xzLnNsaWNlKCk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jvd3Muc2xpY2UoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiY29sdW1uc0ludGVybmFsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29scztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRMYXlvdXRCYXNlLnByb3RvdHlwZSwgXCJyb3dzSW50ZXJuYWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yb3dzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwicm93c1wiLCB7XG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVSb3dzKCk7XG4gICAgICAgICAgICBwYXJzZUFuZEFkZEl0ZW1TcGVjcyh2YWx1ZSwgZnVuY3Rpb24gKHNwZWMpIHsgcmV0dXJuIF90aGlzLmFkZFJvdyhzcGVjKTsgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUsIFwiY29sdW1uc1wiLCB7XG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVDb2x1bW5zKCk7XG4gICAgICAgICAgICBwYXJzZUFuZEFkZEl0ZW1TcGVjcyh2YWx1ZSwgZnVuY3Rpb24gKHNwZWMpIHsgcmV0dXJuIF90aGlzLmFkZENvbHVtbihzcGVjKTsgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHZhciBHcmlkTGF5b3V0QmFzZV8xO1xuICAgIEdyaWRMYXlvdXRCYXNlID0gR3JpZExheW91dEJhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJHcmlkTGF5b3V0XCIpXG4gICAgXSwgR3JpZExheW91dEJhc2UpO1xuICAgIHJldHVybiBHcmlkTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLkdyaWRMYXlvdXRCYXNlID0gR3JpZExheW91dEJhc2U7XG5HcmlkTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuY29sdW1uUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJjb2xcIiwgZGVmYXVsdFZhbHVlOiAwLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vbkNvbHVtbkNoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIE1hdGgubWF4KDAsIHBhcnNlSW50KHYpKTsgfVxufSk7XG5leHBvcnRzLmNvbHVtblByb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLmNvbHVtblNwYW5Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImNvbFNwYW5cIiwgZGVmYXVsdFZhbHVlOiAxLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vbkNvbHVtblNwYW5DaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgxLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5jb2x1bW5TcGFuUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbmV4cG9ydHMucm93UHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJyb3dcIiwgZGVmYXVsdFZhbHVlOiAwLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vblJvd0NoYW5nZWQodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIE1hdGgubWF4KDAsIHBhcnNlSW50KHYpKTsgfVxufSk7XG5leHBvcnRzLnJvd1Byb3BlcnR5LnJlZ2lzdGVyKGxheW91dF9iYXNlXzEuVmlldyk7XG5leHBvcnRzLnJvd1NwYW5Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInJvd1NwYW5cIiwgZGVmYXVsdFZhbHVlOiAxLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBncmlkID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgaWYgKGdyaWQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgZ3JpZC5vblJvd1NwYW5DaGFuZ2VkKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBNYXRoLm1heCgxLCBwYXJzZUludCh2KSk7IH1cbn0pO1xuZXhwb3J0cy5yb3dTcGFuUHJvcGVydHkucmVnaXN0ZXIobGF5b3V0X2Jhc2VfMS5WaWV3KTtcbnZhciBHcmlkVW5pdFR5cGU7XG4oZnVuY3Rpb24gKEdyaWRVbml0VHlwZSkge1xuICAgIEdyaWRVbml0VHlwZS5QSVhFTCA9IFwicGl4ZWxcIjtcbiAgICBHcmlkVW5pdFR5cGUuU1RBUiA9IFwic3RhclwiO1xuICAgIEdyaWRVbml0VHlwZS5BVVRPID0gXCJhdXRvXCI7XG4gICAgR3JpZFVuaXRUeXBlLmlzVmFsaWQgPSBsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoR3JpZFVuaXRUeXBlLlBJWEVMLCBHcmlkVW5pdFR5cGUuU1RBUiwgR3JpZFVuaXRUeXBlLkFVVE8pO1xuICAgIEdyaWRVbml0VHlwZS5wYXJzZSA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihHcmlkVW5pdFR5cGUuaXNWYWxpZCk7XG59KShHcmlkVW5pdFR5cGUgPSBleHBvcnRzLkdyaWRVbml0VHlwZSB8fCAoZXhwb3J0cy5HcmlkVW5pdFR5cGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3JpZC1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZ3JpZF9sYXlvdXRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9ncmlkLWxheW91dC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9ncmlkLWxheW91dC1jb21tb25cIikpO1xudmFyIEdyaWRMYXlvdXQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhHcmlkTGF5b3V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEdyaWRMYXlvdXQoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvbHVtbk9mZnNldHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgX3RoaXMucm93T2Zmc2V0cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBfdGhpcy5tYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLmhlbHBlciA9IG5ldyBNZWFzdXJlSGVscGVyKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5fb25Sb3dBZGRlZCA9IGZ1bmN0aW9uIChpdGVtU3BlYykge1xuICAgICAgICB0aGlzLmhlbHBlci5yb3dzLnB1c2gobmV3IEl0ZW1Hcm91cChpdGVtU3BlYykpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuX29uQ29sdW1uQWRkZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMpIHtcbiAgICAgICAgdGhpcy5oZWxwZXIuY29sdW1ucy5wdXNoKG5ldyBJdGVtR3JvdXAoaXRlbVNwZWMpKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vblJvd1JlbW92ZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4KSB7XG4gICAgICAgIHRoaXMuaGVscGVyLnJvd3NbaW5kZXhdLmNoaWxkcmVuLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaGVscGVyLnJvd3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9vbkNvbHVtblJlbW92ZWQgPSBmdW5jdGlvbiAoaXRlbVNwZWMsIGluZGV4KSB7XG4gICAgICAgIHRoaXMuaGVscGVyLmNvbHVtbnNbaW5kZXhdLmNoaWxkcmVuLmxlbmd0aCA9IDA7XG4gICAgICAgIHRoaXMuaGVscGVyLmNvbHVtbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLl9yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuYWRkVG9NYXAoY2hpbGQpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICB0aGlzLnJlbW92ZUZyb21NYXAoY2hpbGQpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbnZhbGlkYXRlLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUuZ2V0Q29sdW1uSW5kZXggPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oR3JpZExheW91dC5nZXRDb2x1bW4odmlldyksIHRoaXMuY29sdW1uc0ludGVybmFsLmxlbmd0aCAtIDEpKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLmdldFJvd0luZGV4ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKEdyaWRMYXlvdXQuZ2V0Um93KHZpZXcpLCB0aGlzLnJvd3NJbnRlcm5hbC5sZW5ndGggLSAxKSk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5nZXRDb2x1bW5TcGFuID0gZnVuY3Rpb24gKHZpZXcsIGNvbHVtbkluZGV4KSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCgxLCBNYXRoLm1pbihHcmlkTGF5b3V0LmdldENvbHVtblNwYW4odmlldyksIHRoaXMuY29sdW1uc0ludGVybmFsLmxlbmd0aCAtIGNvbHVtbkluZGV4KSk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5nZXRSb3dTcGFuID0gZnVuY3Rpb24gKHZpZXcsIHJvd0luZGV4KSB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCgxLCBNYXRoLm1pbihHcmlkTGF5b3V0LmdldFJvd1NwYW4odmlldyksIHRoaXMucm93c0ludGVybmFsLmxlbmd0aCAtIHJvd0luZGV4KSk7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5nZXRDb2x1bW5TcGVjID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uc0ludGVybmFsW3RoaXMuZ2V0Q29sdW1uSW5kZXgodmlldyldIHx8IHRoaXMuaGVscGVyLnNpbmdsZUNvbHVtbjtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLmdldFJvd1NwZWMgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3dzSW50ZXJuYWxbdGhpcy5nZXRSb3dJbmRleCh2aWV3KV0gfHwgdGhpcy5oZWxwZXIuc2luZ2xlUm93O1xuICAgIH07XG4gICAgR3JpZExheW91dC5wcm90b3R5cGUudXBkYXRlTWVhc3VyZVNwZWNzID0gZnVuY3Rpb24gKGNoaWxkLCBtZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgY29sdW1uID0gdGhpcy5nZXRDb2x1bW5TcGVjKGNoaWxkKTtcbiAgICAgICAgdmFyIGNvbHVtbkluZGV4ID0gdGhpcy5nZXRDb2x1bW5JbmRleChjaGlsZCk7XG4gICAgICAgIHZhciBjb2x1bW5TcGFuID0gdGhpcy5nZXRDb2x1bW5TcGFuKGNoaWxkLCBjb2x1bW5JbmRleCk7XG4gICAgICAgIHZhciByb3cgPSB0aGlzLmdldFJvd1NwZWMoY2hpbGQpO1xuICAgICAgICB2YXIgcm93SW5kZXggPSB0aGlzLmdldFJvd0luZGV4KGNoaWxkKTtcbiAgICAgICAgdmFyIHJvd1NwYW4gPSB0aGlzLmdldFJvd1NwYW4oY2hpbGQsIHJvd0luZGV4KTtcbiAgICAgICAgbWVhc3VyZVNwZWMuc2V0Q29sdW1uKGNvbHVtbik7XG4gICAgICAgIG1lYXN1cmVTcGVjLnNldENvbHVtbkluZGV4KGNvbHVtbkluZGV4KTtcbiAgICAgICAgbWVhc3VyZVNwZWMuc2V0Q29sdW1uU3Bhbihjb2x1bW5TcGFuKTtcbiAgICAgICAgbWVhc3VyZVNwZWMuc2V0Um93KHJvdyk7XG4gICAgICAgIG1lYXN1cmVTcGVjLnNldFJvd0luZGV4KHJvd0luZGV4KTtcbiAgICAgICAgbWVhc3VyZVNwZWMuc2V0Um93U3Bhbihyb3dTcGFuKTtcbiAgICAgICAgbWVhc3VyZVNwZWMuYXV0b0NvbHVtbnNDb3VudCA9IDA7XG4gICAgICAgIG1lYXN1cmVTcGVjLmF1dG9Sb3dzQ291bnQgPSAwO1xuICAgICAgICBtZWFzdXJlU3BlYy5tZWFzdXJlZCA9IGZhbHNlO1xuICAgICAgICBtZWFzdXJlU3BlYy5waXhlbEhlaWdodCA9IDA7XG4gICAgICAgIG1lYXN1cmVTcGVjLnBpeGVsV2lkdGggPSAwO1xuICAgICAgICBtZWFzdXJlU3BlYy5zdGFyQ29sdW1uc0NvdW50ID0gMDtcbiAgICAgICAgbWVhc3VyZVNwZWMuc3RhclJvd3NDb3VudCA9IDA7XG4gICAgfTtcbiAgICBHcmlkTGF5b3V0LnByb3RvdHlwZS5hZGRUb01hcCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICB0aGlzLm1hcC5zZXQoY2hpbGQsIG5ldyBNZWFzdXJlU3BlY3MoY2hpbGQpKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLnJlbW92ZUZyb21NYXAgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdGhpcy5tYXAuZGVsZXRlKGNoaWxkKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTWVhc3VyZS5jYWxsKHRoaXMsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IDA7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gMDtcbiAgICAgICAgdmFyIHdpZHRoID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodE1vZGUgPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhvcml6b250YWxQYWRkaW5nc0FuZE1hcmdpbnMgPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgdmFyIHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIHZhciBpbmZpbml0eVdpZHRoID0gd2lkdGhNb2RlID09PSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQ7XG4gICAgICAgIHZhciBpbmZpbml0eUhlaWdodCA9IGhlaWdodE1vZGUgPT09IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRDtcbiAgICAgICAgdGhpcy5oZWxwZXIud2lkdGggPSBNYXRoLm1heCgwLCB3aWR0aCAtIGhvcml6b250YWxQYWRkaW5nc0FuZE1hcmdpbnMpO1xuICAgICAgICB0aGlzLmhlbHBlci5oZWlnaHQgPSBNYXRoLm1heCgwLCBoZWlnaHQgLSB2ZXJ0aWNhbFBhZGRpbmdzQW5kTWFyZ2lucyk7XG4gICAgICAgIHRoaXMuaGVscGVyLnN0cmV0Y2hlZEhvcml6b250YWxseSA9IHdpZHRoTW9kZSA9PT0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkgfHwgKHRoaXMuaG9yaXpvbnRhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIgJiYgIWluZmluaXR5V2lkdGgpO1xuICAgICAgICB0aGlzLmhlbHBlci5zdHJldGNoZWRWZXJ0aWNhbGx5ID0gaGVpZ2h0TW9kZSA9PT0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkgfHwgKHRoaXMudmVydGljYWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiICYmICFpbmZpbml0eUhlaWdodCk7XG4gICAgICAgIHRoaXMuaGVscGVyLnNldEluZmluaXR5V2lkdGgoaW5maW5pdHlXaWR0aCk7XG4gICAgICAgIHRoaXMuaGVscGVyLnNldEluZmluaXR5SGVpZ2h0KGluZmluaXR5SGVpZ2h0KTtcbiAgICAgICAgdGhpcy5oZWxwZXIuY2xlYXJNZWFzdXJlU3BlY3MoKTtcbiAgICAgICAgdGhpcy5oZWxwZXIuaW5pdCgpO1xuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBtZWFzdXJlU3BlY3MgPSBfdGhpcy5tYXAuZ2V0KGNoaWxkKTtcbiAgICAgICAgICAgIGlmICghbWVhc3VyZVNwZWNzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMudXBkYXRlTWVhc3VyZVNwZWNzKGNoaWxkLCBtZWFzdXJlU3BlY3MpO1xuICAgICAgICAgICAgX3RoaXMuaGVscGVyLmFkZE1lYXN1cmVTcGVjKG1lYXN1cmVTcGVjcyk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmhlbHBlci5tZWFzdXJlKCk7XG4gICAgICAgIG1lYXN1cmVXaWR0aCA9IHRoaXMuaGVscGVyLm1lYXN1cmVkV2lkdGggKyBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gdGhpcy5oZWxwZXIubWVhc3VyZWRIZWlnaHQgKyB2ZXJ0aWNhbFBhZGRpbmdzQW5kTWFyZ2lucztcbiAgICAgICAgbWVhc3VyZVdpZHRoID0gTWF0aC5tYXgobWVhc3VyZVdpZHRoLCB0aGlzLmVmZmVjdGl2ZU1pbldpZHRoKTtcbiAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KG1lYXN1cmVIZWlnaHQsIHRoaXMuZWZmZWN0aXZlTWluSGVpZ2h0KTtcbiAgICAgICAgdmFyIHdpZHRoU2l6ZUFuZFN0YXRlID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRTaXplQW5kU3RhdGUgPSBncmlkX2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aFNpemVBbmRTdGF0ZSwgaGVpZ2h0U2l6ZUFuZFN0YXRlKTtcbiAgICB9O1xuICAgIEdyaWRMYXlvdXQucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTGF5b3V0LmNhbGwodGhpcywgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tKTtcbiAgICAgICAgdmFyIGluc2V0cyA9IHRoaXMuZ2V0U2FmZUFyZWFJbnNldHMoKTtcbiAgICAgICAgdmFyIHBhZGRpbmdMZWZ0ID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgaW5zZXRzLmxlZnQ7XG4gICAgICAgIHZhciBwYWRkaW5nVG9wID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGluc2V0cy50b3A7XG4gICAgICAgIHRoaXMuY29sdW1uT2Zmc2V0cy5sZW5ndGggPSAwO1xuICAgICAgICB0aGlzLnJvd09mZnNldHMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5jb2x1bW5PZmZzZXRzLnB1c2gocGFkZGluZ0xlZnQpO1xuICAgICAgICB0aGlzLnJvd09mZnNldHMucHVzaChwYWRkaW5nVG9wKTtcbiAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMuY29sdW1uT2Zmc2V0c1swXTtcbiAgICAgICAgdmFyIHJvdW5kZWRPZmZzZXQgPSBwYWRkaW5nTGVmdDtcbiAgICAgICAgdmFyIHJvdW5kZWRMZW5ndGggPSAwO1xuICAgICAgICB2YXIgYWN0dWFsTGVuZ3RoID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSB0aGlzLmhlbHBlci5jb2x1bW5zLmxlbmd0aDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5oZWxwZXIuY29sdW1uc1tpXTtcbiAgICAgICAgICAgIG9mZnNldCArPSBjb2x1bW5Hcm91cC5sZW5ndGg7XG4gICAgICAgICAgICBhY3R1YWxMZW5ndGggPSBvZmZzZXQgLSByb3VuZGVkT2Zmc2V0O1xuICAgICAgICAgICAgcm91bmRlZExlbmd0aCA9IE1hdGgucm91bmQoYWN0dWFsTGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbHVtbkdyb3VwLnJvd09yQ29sdW1uLl9hY3R1YWxMZW5ndGggPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQucm91bmQoZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocm91bmRlZExlbmd0aCkpO1xuICAgICAgICAgICAgcm91bmRlZE9mZnNldCArPSByb3VuZGVkTGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5PZmZzZXRzLnB1c2gocm91bmRlZE9mZnNldCk7XG4gICAgICAgIH1cbiAgICAgICAgb2Zmc2V0ID0gdGhpcy5yb3dPZmZzZXRzWzBdO1xuICAgICAgICByb3VuZGVkT2Zmc2V0ID0gcGFkZGluZ1RvcDtcbiAgICAgICAgcm91bmRlZExlbmd0aCA9IDA7XG4gICAgICAgIGFjdHVhbExlbmd0aCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5oZWxwZXIucm93cy5sZW5ndGg7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMuaGVscGVyLnJvd3NbaV07XG4gICAgICAgICAgICBvZmZzZXQgKz0gcm93R3JvdXAubGVuZ3RoO1xuICAgICAgICAgICAgYWN0dWFsTGVuZ3RoID0gb2Zmc2V0IC0gcm91bmRlZE9mZnNldDtcbiAgICAgICAgICAgIHJvdW5kZWRMZW5ndGggPSBNYXRoLnJvdW5kKGFjdHVhbExlbmd0aCk7XG4gICAgICAgICAgICByb3dHcm91cC5yb3dPckNvbHVtbi5fYWN0dWFsTGVuZ3RoID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LnJvdW5kKGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHJvdW5kZWRMZW5ndGgpKTtcbiAgICAgICAgICAgIHJvdW5kZWRPZmZzZXQgKz0gcm91bmRlZExlbmd0aDtcbiAgICAgICAgICAgIHRoaXMucm93T2Zmc2V0cy5wdXNoKHJvdW5kZWRPZmZzZXQpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBjb2x1bW5zID0gdGhpcy5oZWxwZXIuY29sdW1ucy5sZW5ndGg7IGkgPCBjb2x1bW5zOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjb2x1bW5Hcm91cCA9IHRoaXMuaGVscGVyLmNvbHVtbnNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgY2hpbGRyZW4gPSBjb2x1bW5Hcm91cC5jaGlsZHJlbi5sZW5ndGg7IGogPCBjaGlsZHJlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lYXN1cmVTcGVjID0gY29sdW1uR3JvdXAuY2hpbGRyZW5bal07XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkTGVmdCA9IHRoaXMuY29sdW1uT2Zmc2V0c1ttZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpXTtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRSaWdodCA9IHRoaXMuY29sdW1uT2Zmc2V0c1ttZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpICsgbWVhc3VyZVNwZWMuZ2V0Q29sdW1uU3BhbigpXTtcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGRUb3AgPSB0aGlzLnJvd09mZnNldHNbbWVhc3VyZVNwZWMuZ2V0Um93SW5kZXgoKV07XG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkQm90dG9tID0gdGhpcy5yb3dPZmZzZXRzW21lYXN1cmVTcGVjLmdldFJvd0luZGV4KCkgKyBtZWFzdXJlU3BlYy5nZXRSb3dTcGFuKCldO1xuICAgICAgICAgICAgICAgIGdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgbWVhc3VyZVNwZWMuY2hpbGQsIGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkUmlnaHQsIGNoaWxkQm90dG9tKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEdyaWRMYXlvdXQ7XG59KGdyaWRfbGF5b3V0X2NvbW1vbl8xLkdyaWRMYXlvdXRCYXNlKSk7XG5leHBvcnRzLkdyaWRMYXlvdXQgPSBHcmlkTGF5b3V0O1xudmFyIE1lYXN1cmVTcGVjcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVhc3VyZVNwZWNzKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX2NvbHVtblNwYW4gPSAxO1xuICAgICAgICB0aGlzLl9yb3dTcGFuID0gMTtcbiAgICAgICAgdGhpcy5waXhlbFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5waXhlbEhlaWdodCA9IDA7XG4gICAgICAgIHRoaXMuc3RhckNvbHVtbnNDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuc3RhclJvd3NDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuYXV0b0NvbHVtbnNDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuYXV0b1Jvd3NDb3VudCA9IDA7XG4gICAgICAgIHRoaXMubWVhc3VyZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jb2x1bW5JbmRleCA9IDA7XG4gICAgICAgIHRoaXMucm93SW5kZXggPSAwO1xuICAgICAgICB0aGlzLmNoaWxkID0gY2hpbGQ7XG4gICAgfVxuICAgIE1lYXN1cmVTcGVjcy5wcm90b3R5cGUuZ2V0U3Bhbm5lZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbHVtblNwYW4gPiAxIHx8IHRoaXMuX3Jvd1NwYW4gPiAxO1xuICAgIH07XG4gICAgTWVhc3VyZVNwZWNzLnByb3RvdHlwZS5nZXRJc1N0YXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXJSb3dzQ291bnQgPiAwIHx8IHRoaXMuc3RhckNvbHVtbnNDb3VudCA+IDA7XG4gICAgfTtcbiAgICBNZWFzdXJlU3BlY3MucHJvdG90eXBlLmdldENvbHVtblNwYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb2x1bW5TcGFuO1xuICAgIH07XG4gICAgTWVhc3VyZVNwZWNzLnByb3RvdHlwZS5nZXRSb3dTcGFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcm93U3BhbjtcbiAgICB9O1xuICAgIE1lYXN1cmVTcGVjcy5wcm90b3R5cGUuc2V0Um93U3BhbiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9yb3dTcGFuID0gTWF0aC5tYXgoMSwgdmFsdWUpO1xuICAgIH07XG4gICAgTWVhc3VyZVNwZWNzLnByb3RvdHlwZS5zZXRDb2x1bW5TcGFuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2NvbHVtblNwYW4gPSBNYXRoLm1heCgxLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBNZWFzdXJlU3BlY3MucHJvdG90eXBlLmdldFJvd0luZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3dJbmRleDtcbiAgICB9O1xuICAgIE1lYXN1cmVTcGVjcy5wcm90b3R5cGUuZ2V0Q29sdW1uSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbHVtbkluZGV4O1xuICAgIH07XG4gICAgTWVhc3VyZVNwZWNzLnByb3RvdHlwZS5zZXRSb3dJbmRleCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnJvd0luZGV4ID0gdmFsdWU7XG4gICAgfTtcbiAgICBNZWFzdXJlU3BlY3MucHJvdG90eXBlLnNldENvbHVtbkluZGV4ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuY29sdW1uSW5kZXggPSB2YWx1ZTtcbiAgICB9O1xuICAgIE1lYXN1cmVTcGVjcy5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3c7XG4gICAgfTtcbiAgICBNZWFzdXJlU3BlY3MucHJvdG90eXBlLmdldENvbHVtbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uO1xuICAgIH07XG4gICAgTWVhc3VyZVNwZWNzLnByb3RvdHlwZS5zZXRSb3cgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5yb3cgPSB2YWx1ZTtcbiAgICB9O1xuICAgIE1lYXN1cmVTcGVjcy5wcm90b3R5cGUuc2V0Q29sdW1uID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuY29sdW1uID0gdmFsdWU7XG4gICAgfTtcbiAgICByZXR1cm4gTWVhc3VyZVNwZWNzO1xufSgpKTtcbnZhciBJdGVtR3JvdXAgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEl0ZW1Hcm91cChzcGVjKSB7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgICAgICAgdGhpcy5tZWFzdXJlZENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLm1lYXN1cmVUb0ZpeCA9IDA7XG4gICAgICAgIHRoaXMuY3VycmVudE1lYXN1cmVUb0ZpeENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5pbmZpbml0eUxlbmd0aCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJvd09yQ29sdW1uID0gc3BlYztcbiAgICB9XG4gICAgSXRlbUdyb3VwLnByb3RvdHlwZS5zZXRJc0xlbmd0aEluZmluaXR5ID0gZnVuY3Rpb24gKGluZmluaXR5TGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuaW5maW5pdHlMZW5ndGggPSBpbmZpbml0eUxlbmd0aDtcbiAgICB9O1xuICAgIEl0ZW1Hcm91cC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChkZW5zaXR5KSB7XG4gICAgICAgIHRoaXMubWVhc3VyZWRDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuY3VycmVudE1lYXN1cmVUb0ZpeENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLnJvd09yQ29sdW1uLmlzQWJzb2x1dGUgPyB0aGlzLnJvd09yQ29sdW1uLnZhbHVlICogZGVuc2l0eSA6IDA7XG4gICAgfTtcbiAgICBJdGVtR3JvdXAucHJvdG90eXBlLmdldEFsbE1lYXN1cmVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZWFzdXJlZENvdW50ID09PSB0aGlzLmNoaWxkcmVuLmxlbmd0aDtcbiAgICB9O1xuICAgIEl0ZW1Hcm91cC5wcm90b3R5cGUuZ2V0Q2FuQmVGaXhlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudE1lYXN1cmVUb0ZpeENvdW50ID09PSB0aGlzLm1lYXN1cmVUb0ZpeDtcbiAgICB9O1xuICAgIEl0ZW1Hcm91cC5wcm90b3R5cGUuZ2V0SXNBdXRvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3dPckNvbHVtbi5pc0F1dG8gfHwgKHRoaXMucm93T3JDb2x1bW4uaXNTdGFyICYmIHRoaXMuaW5maW5pdHlMZW5ndGgpO1xuICAgIH07XG4gICAgSXRlbUdyb3VwLnByb3RvdHlwZS5nZXRJc1N0YXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvd09yQ29sdW1uLmlzU3RhciAmJiAhdGhpcy5pbmZpbml0eUxlbmd0aDtcbiAgICB9O1xuICAgIEl0ZW1Hcm91cC5wcm90b3R5cGUuZ2V0SXNBYnNvbHV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm93T3JDb2x1bW4uaXNBYnNvbHV0ZTtcbiAgICB9O1xuICAgIHJldHVybiBJdGVtR3JvdXA7XG59KCkpO1xudmFyIE1lYXN1cmVIZWxwZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lYXN1cmVIZWxwZXIoZ3JpZCkge1xuICAgICAgICB0aGlzLmluZmluaXR5ID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYygwLCBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQpO1xuICAgICAgICB0aGlzLnJvd3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5jb2x1bW5zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMud2lkdGggPSAwO1xuICAgICAgICB0aGlzLmhlaWdodCA9IDA7XG4gICAgICAgIHRoaXMuc3RyZXRjaGVkSG9yaXpvbnRhbGx5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc3RyZXRjaGVkVmVydGljYWxseSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmluZmluaXR5V2lkdGggPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pbmZpbml0eUhlaWdodCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1pbkNvbHVtblN0YXJWYWx1ZSA9IDA7XG4gICAgICAgIHRoaXMubWF4Q29sdW1uU3RhclZhbHVlID0gMDtcbiAgICAgICAgdGhpcy5taW5Sb3dTdGFyVmFsdWUgPSAwO1xuICAgICAgICB0aGlzLm1heFJvd1N0YXJWYWx1ZSA9IDA7XG4gICAgICAgIHRoaXMubWVhc3VyZWRXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMubWVhc3VyZWRIZWlnaHQgPSAwO1xuICAgICAgICB0aGlzLmZha2VSb3dBZGRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmZha2VDb2x1bW5BZGRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmdyaWQgPSBncmlkO1xuICAgICAgICB0aGlzLnNpbmdsZVJvdyA9IG5ldyBncmlkX2xheW91dF9jb21tb25fMS5JdGVtU3BlYygpO1xuICAgICAgICB0aGlzLnNpbmdsZUNvbHVtbiA9IG5ldyBncmlkX2xheW91dF9jb21tb25fMS5JdGVtU3BlYygpO1xuICAgICAgICB0aGlzLnNpbmdsZVJvd0dyb3VwID0gbmV3IEl0ZW1Hcm91cCh0aGlzLnNpbmdsZVJvdyk7XG4gICAgICAgIHRoaXMuc2luZ2xlQ29sdW1uR3JvdXAgPSBuZXcgSXRlbUdyb3VwKHRoaXMuc2luZ2xlQ29sdW1uKTtcbiAgICB9XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuc2V0SW5maW5pdHlXaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmluZmluaXR5V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSB0aGlzLmNvbHVtbnMubGVuZ3RoOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uR3JvdXAgPSB0aGlzLmNvbHVtbnNbaV07XG4gICAgICAgICAgICBjb2x1bW5Hcm91cC5zZXRJc0xlbmd0aEluZmluaXR5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuc2V0SW5maW5pdHlIZWlnaHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5pbmZpbml0eUhlaWdodCA9IHZhbHVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgc2l6ZSA9IHRoaXMucm93cy5sZW5ndGg7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgIHJvd0dyb3VwLnNldElzTGVuZ3RoSW5maW5pdHkodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBNZWFzdXJlSGVscGVyLnByb3RvdHlwZS5hZGRNZWFzdXJlU3BlYyA9IGZ1bmN0aW9uIChtZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgc2l6ZSA9IG1lYXN1cmVTcGVjLmdldENvbHVtbkluZGV4KCkgKyBtZWFzdXJlU3BlYy5nZXRDb2x1bW5TcGFuKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uR3JvdXAgPSB0aGlzLmNvbHVtbnNbaV07XG4gICAgICAgICAgICBpZiAoY29sdW1uR3JvdXAuZ2V0SXNBdXRvKCkpIHtcbiAgICAgICAgICAgICAgICBtZWFzdXJlU3BlYy5hdXRvQ29sdW1uc0NvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb2x1bW5Hcm91cC5nZXRJc1N0YXIoKSkge1xuICAgICAgICAgICAgICAgIG1lYXN1cmVTcGVjLnN0YXJDb2x1bW5zQ291bnQgKz0gY29sdW1uR3JvdXAucm93T3JDb2x1bW4udmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjb2x1bW5Hcm91cC5nZXRJc0Fic29sdXRlKCkpIHtcbiAgICAgICAgICAgICAgICBtZWFzdXJlU3BlYy5waXhlbFdpZHRoICs9IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhjb2x1bW5Hcm91cC5yb3dPckNvbHVtbi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lYXN1cmVTcGVjLmF1dG9Db2x1bW5zQ291bnQgPiAwICYmIG1lYXN1cmVTcGVjLnN0YXJDb2x1bW5zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5Hcm91cC5nZXRJc0F1dG8oKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5Hcm91cC5tZWFzdXJlVG9GaXgrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2l6ZSA9IG1lYXN1cmVTcGVjLmdldFJvd0luZGV4KCkgKyBtZWFzdXJlU3BlYy5nZXRSb3dTcGFuKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcm93R3JvdXAgPSB0aGlzLnJvd3NbaV07XG4gICAgICAgICAgICBpZiAocm93R3JvdXAuZ2V0SXNBdXRvKCkpIHtcbiAgICAgICAgICAgICAgICBtZWFzdXJlU3BlYy5hdXRvUm93c0NvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyb3dHcm91cC5nZXRJc1N0YXIoKSkge1xuICAgICAgICAgICAgICAgIG1lYXN1cmVTcGVjLnN0YXJSb3dzQ291bnQgKz0gcm93R3JvdXAucm93T3JDb2x1bW4udmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyb3dHcm91cC5nZXRJc0Fic29sdXRlKCkpIHtcbiAgICAgICAgICAgICAgICBtZWFzdXJlU3BlYy5waXhlbEhlaWdodCArPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMocm93R3JvdXAucm93T3JDb2x1bW4udmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtZWFzdXJlU3BlYy5hdXRvUm93c0NvdW50ID4gMCAmJiBtZWFzdXJlU3BlYy5zdGFyUm93c0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbWVhc3VyZVNwZWMuZ2V0Um93SW5kZXgoKTsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgICAgICBpZiAocm93R3JvdXAuZ2V0SXNBdXRvKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93R3JvdXAubWVhc3VyZVRvRml4Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29sdW1uc1ttZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpXS5jaGlsZHJlbi5wdXNoKG1lYXN1cmVTcGVjKTtcbiAgICAgICAgdGhpcy5yb3dzW21lYXN1cmVTcGVjLmdldFJvd0luZGV4KCldLmNoaWxkcmVuLnB1c2gobWVhc3VyZVNwZWMpO1xuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuY2xlYXJNZWFzdXJlU3BlY3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5jb2x1bW5zLmxlbmd0aDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5zW2ldLmNoaWxkcmVuLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSB0aGlzLnJvd3MubGVuZ3RoOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnJvd3NbaV0uY2hpbGRyZW4ubGVuZ3RoID0gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5pbml0TGlzdCA9IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgICAgIHZhciBkZW5zaXR5ID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldERpc3BsYXlEZW5zaXR5KCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gbGlzdC5sZW5ndGg7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAgICAgIGl0ZW0uaW5pdChkZW5zaXR5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnJvd3MubGVuZ3RoO1xuICAgICAgICBpZiAocm93cyA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zaW5nbGVSb3dHcm91cC5zZXRJc0xlbmd0aEluZmluaXR5KHRoaXMuaW5maW5pdHlIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5yb3dzLnB1c2godGhpcy5zaW5nbGVSb3dHcm91cCk7XG4gICAgICAgICAgICB0aGlzLmZha2VSb3dBZGRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocm93cyA+IDEgJiYgdGhpcy5mYWtlUm93QWRkZWQpIHtcbiAgICAgICAgICAgIHRoaXMucm93cy5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICB0aGlzLmZha2VSb3dBZGRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xzID0gdGhpcy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgaWYgKGNvbHMgPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZmFrZUNvbHVtbkFkZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc2luZ2xlQ29sdW1uR3JvdXAuc2V0SXNMZW5ndGhJbmZpbml0eSh0aGlzLmluZmluaXR5V2lkdGgpO1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5zLnB1c2godGhpcy5zaW5nbGVDb2x1bW5Hcm91cCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29scyA+IDEgJiYgdGhpcy5mYWtlQ29sdW1uQWRkZWQpIHtcbiAgICAgICAgICAgIHRoaXMuY29sdW1ucy5zcGxpY2UoMCwgMSk7XG4gICAgICAgICAgICB0aGlzLmZha2VDb2x1bW5BZGRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIE1lYXN1cmVIZWxwZXIuaW5pdExpc3QodGhpcy5yb3dzKTtcbiAgICAgICAgTWVhc3VyZUhlbHBlci5pbml0TGlzdCh0aGlzLmNvbHVtbnMpO1xuICAgICAgICB0aGlzLm1pbkNvbHVtblN0YXJWYWx1ZSA9IC0xO1xuICAgICAgICB0aGlzLm1pblJvd1N0YXJWYWx1ZSA9IC0xO1xuICAgICAgICB0aGlzLm1heENvbHVtblN0YXJWYWx1ZSA9IC0xO1xuICAgICAgICB0aGlzLm1heFJvd1N0YXJWYWx1ZSA9IC0xO1xuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuaXRlbU1lYXN1cmVkID0gZnVuY3Rpb24gKG1lYXN1cmVTcGVjLCBpc0Zha2VNZWFzdXJlKSB7XG4gICAgICAgIGlmICghaXNGYWtlTWVhc3VyZSkge1xuICAgICAgICAgICAgdGhpcy5jb2x1bW5zW21lYXN1cmVTcGVjLmdldENvbHVtbkluZGV4KCldLm1lYXN1cmVkQ291bnQrKztcbiAgICAgICAgICAgIHRoaXMucm93c1ttZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpXS5tZWFzdXJlZENvdW50Kys7XG4gICAgICAgICAgICBtZWFzdXJlU3BlYy5tZWFzdXJlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lYXN1cmVTcGVjLmF1dG9Db2x1bW5zQ291bnQgPiAwICYmIG1lYXN1cmVTcGVjLnN0YXJDb2x1bW5zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gbWVhc3VyZVNwZWMuZ2V0Q29sdW1uSW5kZXgoKSArIG1lYXN1cmVTcGVjLmdldENvbHVtblNwYW4oKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjb2x1bW5Hcm91cC5nZXRJc0F1dG8oKSkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5Hcm91cC5jdXJyZW50TWVhc3VyZVRvRml4Q291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lYXN1cmVTcGVjLmF1dG9Sb3dzQ291bnQgPiAwICYmIG1lYXN1cmVTcGVjLnN0YXJSb3dzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gbWVhc3VyZVNwZWMuZ2V0Um93SW5kZXgoKSArIG1lYXN1cmVTcGVjLmdldFJvd1NwYW4oKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0dyb3VwID0gdGhpcy5yb3dzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChyb3dHcm91cC5nZXRJc0F1dG8oKSkge1xuICAgICAgICAgICAgICAgICAgICByb3dHcm91cC5jdXJyZW50TWVhc3VyZVRvRml4Q291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIucHJvdG90eXBlLmZpeENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjdXJyZW50Q29sdW1uV2lkdGggPSAwO1xuICAgICAgICB2YXIgY29sdW1uU3RhckNvdW50ID0gMDtcbiAgICAgICAgdmFyIGNvbHVtbkNvdW50ID0gdGhpcy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2x1bW5Db3VudDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuY29sdW1uc1tpXTtcbiAgICAgICAgICAgIGlmIChpdGVtLnJvd09yQ29sdW1uLmlzU3Rhcikge1xuICAgICAgICAgICAgICAgIGNvbHVtblN0YXJDb3VudCArPSBpdGVtLnJvd09yQ29sdW1uLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY3VycmVudENvbHVtbldpZHRoICs9IGl0ZW0ubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciB3aWR0aEZvclN0YXJDb2x1bW5zID0gTWF0aC5tYXgoMCwgdGhpcy53aWR0aCAtIGN1cnJlbnRDb2x1bW5XaWR0aCk7XG4gICAgICAgIHRoaXMubWF4Q29sdW1uU3RhclZhbHVlID0gY29sdW1uU3RhckNvdW50ID4gMCA/IHdpZHRoRm9yU3RhckNvbHVtbnMgLyBjb2x1bW5TdGFyQ291bnQgOiAwO1xuICAgICAgICBNZWFzdXJlSGVscGVyLnVwZGF0ZVN0YXJMZW5ndGgodGhpcy5jb2x1bW5zLCB0aGlzLm1heENvbHVtblN0YXJWYWx1ZSk7XG4gICAgfTtcbiAgICBNZWFzdXJlSGVscGVyLnByb3RvdHlwZS5maXhSb3dzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VycmVudFJvd0hlaWdodCA9IDA7XG4gICAgICAgIHZhciByb3dTdGFyQ291bnQgPSAwO1xuICAgICAgICB2YXIgcm93Q291bnQgPSB0aGlzLnJvd3MubGVuZ3RoO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvd0NvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5yb3dzW2ldO1xuICAgICAgICAgICAgaWYgKGl0ZW0ucm93T3JDb2x1bW4uaXNTdGFyKSB7XG4gICAgICAgICAgICAgICAgcm93U3RhckNvdW50ICs9IGl0ZW0ucm93T3JDb2x1bW4udmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Um93SGVpZ2h0ICs9IGl0ZW0ubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBoZWlnaHRGb3JTdGFyUm93cyA9IE1hdGgubWF4KDAsIHRoaXMuaGVpZ2h0IC0gY3VycmVudFJvd0hlaWdodCk7XG4gICAgICAgIHRoaXMubWF4Um93U3RhclZhbHVlID0gcm93U3RhckNvdW50ID4gMCA/IGhlaWdodEZvclN0YXJSb3dzIC8gcm93U3RhckNvdW50IDogMDtcbiAgICAgICAgTWVhc3VyZUhlbHBlci51cGRhdGVTdGFyTGVuZ3RoKHRoaXMucm93cywgdGhpcy5tYXhSb3dTdGFyVmFsdWUpO1xuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci51cGRhdGVTdGFyTGVuZ3RoID0gZnVuY3Rpb24gKGxpc3QsIHN0YXJWYWx1ZSkge1xuICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgdmFyIHJvdW5kZWRPZmZzZXQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgcm93Q291bnQgPSBsaXN0Lmxlbmd0aDsgaSA8IHJvd0NvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAgICAgIGlmIChpdGVtLmdldElzU3RhcigpKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGl0ZW0ucm93T3JDb2x1bW4udmFsdWUgKiBzdGFyVmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGFjdHVhbExlbmd0aCA9IG9mZnNldCAtIHJvdW5kZWRPZmZzZXQ7XG4gICAgICAgICAgICAgICAgdmFyIHJvdW5kZWRMZW5ndGggPSBNYXRoLnJvdW5kKGFjdHVhbExlbmd0aCk7XG4gICAgICAgICAgICAgICAgaXRlbS5sZW5ndGggPSByb3VuZGVkTGVuZ3RoO1xuICAgICAgICAgICAgICAgIHJvdW5kZWRPZmZzZXQgKz0gcm91bmRlZExlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUuZmFrZU1lYXN1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5jb2x1bW5zLmxlbmd0aDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgaWYgKGNvbHVtbkdyb3VwLmdldEFsbE1lYXN1cmVkKCkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjaGlsZHJlbkNvdW50ID0gY29sdW1uR3JvdXAuY2hpbGRyZW4ubGVuZ3RoOyBqIDwgY2hpbGRyZW5Db3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lYXN1cmVTcGVjID0gY29sdW1uR3JvdXAuY2hpbGRyZW5bal07XG4gICAgICAgICAgICAgICAgaWYgKG1lYXN1cmVTcGVjLnN0YXJSb3dzQ291bnQgPiAwICYmIG1lYXN1cmVTcGVjLmF1dG9Db2x1bW5zQ291bnQgPiAwICYmIG1lYXN1cmVTcGVjLnN0YXJDb2x1bW5zQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZWFzdXJlQ2hpbGQobWVhc3VyZVNwZWMsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUubWVhc3VyZUZpeGVkQ29sdW1uc05vU3RhclJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5jb2x1bW5zLmxlbmd0aDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGNoaWxkcmVuQ291bnQgPSBjb2x1bW5Hcm91cC5jaGlsZHJlbi5sZW5ndGg7IGogPCBjaGlsZHJlbkNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVhc3VyZVNwZWMgPSBjb2x1bW5Hcm91cC5jaGlsZHJlbltqXTtcbiAgICAgICAgICAgICAgICBpZiAobWVhc3VyZVNwZWMuc3RhckNvbHVtbnNDb3VudCA+IDAgJiYgbWVhc3VyZVNwZWMuc3RhclJvd3NDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lYXN1cmVDaGlsZEZpeGVkQ29sdW1ucyhtZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBNZWFzdXJlSGVscGVyLnByb3RvdHlwZS5tZWFzdXJlTm9TdGFyQ29sdW1uc0ZpeGVkUm93cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSB0aGlzLmNvbHVtbnMubGVuZ3RoOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uR3JvdXAgPSB0aGlzLmNvbHVtbnNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgY2hpbGRyZW5Db3VudCA9IGNvbHVtbkdyb3VwLmNoaWxkcmVuLmxlbmd0aDsgaiA8IGNoaWxkcmVuQ291bnQ7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBtZWFzdXJlU3BlYyA9IGNvbHVtbkdyb3VwLmNoaWxkcmVuW2pdO1xuICAgICAgICAgICAgICAgIGlmIChtZWFzdXJlU3BlYy5zdGFyUm93c0NvdW50ID4gMCAmJiBtZWFzdXJlU3BlYy5zdGFyQ29sdW1uc0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVhc3VyZUNoaWxkRml4ZWRSb3dzKG1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIuY2FuRml4ID0gZnVuY3Rpb24gKGxpc3QpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSBsaXN0Lmxlbmd0aDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBsaXN0W2ldO1xuICAgICAgICAgICAgaWYgKCFpdGVtLmdldENhbkJlRml4ZWQoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIuZ2V0TWVhc3VyZUxlbmd0aCA9IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgc2l6ZSA9IGxpc3QubGVuZ3RoOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgICAgICAgICByZXN1bHQgKz0gaXRlbS5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIucHJvdG90eXBlLm1lYXN1cmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzaXplID0gdGhpcy5jb2x1bW5zLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjb2x1bW5Hcm91cCA9IHRoaXMuY29sdW1uc1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBjaGlsZHJlbkNvdW50ID0gY29sdW1uR3JvdXAuY2hpbGRyZW4ubGVuZ3RoOyBqIDwgY2hpbGRyZW5Db3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1lYXN1cmVTcGVjID0gY29sdW1uR3JvdXAuY2hpbGRyZW5bal07XG4gICAgICAgICAgICAgICAgaWYgKG1lYXN1cmVTcGVjLmdldElzU3RhcigpIHx8IG1lYXN1cmVTcGVjLmdldFNwYW5uZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5tZWFzdXJlQ2hpbGQobWVhc3VyZVNwZWMsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDAsIGNoaWxkcmVuQ291bnQgPSBjb2x1bW5Hcm91cC5jaGlsZHJlbi5sZW5ndGg7IGogPCBjaGlsZHJlbkNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVhc3VyZVNwZWMgPSBjb2x1bW5Hcm91cC5jaGlsZHJlbltqXTtcbiAgICAgICAgICAgICAgICBpZiAobWVhc3VyZVNwZWMuZ2V0SXNTdGFyKCkgfHwgIW1lYXN1cmVTcGVjLmdldFNwYW5uZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5tZWFzdXJlQ2hpbGQobWVhc3VyZVNwZWMsIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZml4Q29sdW1ucyA9IE1lYXN1cmVIZWxwZXIuY2FuRml4KHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHZhciBmaXhSb3dzID0gTWVhc3VyZUhlbHBlci5jYW5GaXgodGhpcy5yb3dzKTtcbiAgICAgICAgaWYgKGZpeENvbHVtbnMpIHtcbiAgICAgICAgICAgIHRoaXMuZml4Q29sdW1ucygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaXhSb3dzKSB7XG4gICAgICAgICAgICB0aGlzLmZpeFJvd3MoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZpeENvbHVtbnMgJiYgIWZpeFJvd3MpIHtcbiAgICAgICAgICAgIHRoaXMuZmFrZU1lYXN1cmUoKTtcbiAgICAgICAgICAgIHRoaXMuZml4Q29sdW1ucygpO1xuICAgICAgICAgICAgdGhpcy5tZWFzdXJlRml4ZWRDb2x1bW5zTm9TdGFyUm93cygpO1xuICAgICAgICAgICAgdGhpcy5maXhSb3dzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZml4Q29sdW1ucyAmJiAhZml4Um93cykge1xuICAgICAgICAgICAgdGhpcy5tZWFzdXJlRml4ZWRDb2x1bW5zTm9TdGFyUm93cygpO1xuICAgICAgICAgICAgdGhpcy5maXhSb3dzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWZpeENvbHVtbnMgJiYgZml4Um93cykge1xuICAgICAgICAgICAgdGhpcy5tZWFzdXJlTm9TdGFyQ29sdW1uc0ZpeGVkUm93cygpO1xuICAgICAgICAgICAgdGhpcy5maXhDb2x1bW5zKCk7XG4gICAgICAgIH1cbiAgICAgICAgc2l6ZSA9IHRoaXMuY29sdW1ucy5sZW5ndGg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY29sdW1uR3JvdXAgPSB0aGlzLmNvbHVtbnNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMCwgY2hpbGRDb3VudCA9IGNvbHVtbkdyb3VwLmNoaWxkcmVuLmxlbmd0aDsgaiA8IGNoaWxkQ291bnQ7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBtZWFzdXJlU3BlYyA9IGNvbHVtbkdyb3VwLmNoaWxkcmVuW2pdO1xuICAgICAgICAgICAgICAgIGlmICghbWVhc3VyZVNwZWMubWVhc3VyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZWFzdXJlQ2hpbGRGaXhlZENvbHVtbnNBbmRSb3dzKG1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnN0cmV0Y2hlZEhvcml6b250YWxseSAmJiB0aGlzLm1pbkNvbHVtblN0YXJWYWx1ZSAhPT0gLTEgJiYgdGhpcy5taW5Db2x1bW5TdGFyVmFsdWUgPCB0aGlzLm1heENvbHVtblN0YXJWYWx1ZSkge1xuICAgICAgICAgICAgTWVhc3VyZUhlbHBlci51cGRhdGVTdGFyTGVuZ3RoKHRoaXMuY29sdW1ucywgdGhpcy5taW5Db2x1bW5TdGFyVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zdHJldGNoZWRWZXJ0aWNhbGx5ICYmIHRoaXMubWluUm93U3RhclZhbHVlICE9PSAtMSAmJiB0aGlzLm1pblJvd1N0YXJWYWx1ZSA8IHRoaXMubWF4Um93U3RhclZhbHVlKSB7XG4gICAgICAgICAgICBNZWFzdXJlSGVscGVyLnVwZGF0ZVN0YXJMZW5ndGgodGhpcy5yb3dzLCB0aGlzLm1pblJvd1N0YXJWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tZWFzdXJlZFdpZHRoID0gTWVhc3VyZUhlbHBlci5nZXRNZWFzdXJlTGVuZ3RoKHRoaXMuY29sdW1ucyk7XG4gICAgICAgIHRoaXMubWVhc3VyZWRIZWlnaHQgPSBNZWFzdXJlSGVscGVyLmdldE1lYXN1cmVMZW5ndGgodGhpcy5yb3dzKTtcbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIucHJvdG90eXBlLm1lYXN1cmVDaGlsZCA9IGZ1bmN0aW9uIChtZWFzdXJlU3BlYywgaXNGYWtlTWVhc3VyZSkge1xuICAgICAgICB2YXIgd2lkdGhNZWFzdXJlU3BlYyA9IChtZWFzdXJlU3BlYy5hdXRvQ29sdW1uc0NvdW50ID4gMCkgPyB0aGlzLmluZmluaXR5IDogZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhtZWFzdXJlU3BlYy5waXhlbFdpZHRoLCBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHZhciBoZWlnaHRNZWFzdXJlU3BlYyA9IChpc0Zha2VNZWFzdXJlIHx8IG1lYXN1cmVTcGVjLmF1dG9Sb3dzQ291bnQgPiAwKSA/IHRoaXMuaW5maW5pdHkgOiBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKG1lYXN1cmVTcGVjLnBpeGVsSGVpZ2h0LCBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHZhciBjaGlsZFNpemUgPSBncmlkX2xheW91dF9jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLmdyaWQsIG1lYXN1cmVTcGVjLmNoaWxkLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBjaGlsZE1lYXN1cmVkV2lkdGggPSBjaGlsZFNpemUubWVhc3VyZWRXaWR0aDtcbiAgICAgICAgdmFyIGNoaWxkTWVhc3VyZWRIZWlnaHQgPSBjaGlsZFNpemUubWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgIHZhciBjb2x1bW5TcGFuRW5kID0gbWVhc3VyZVNwZWMuZ2V0Q29sdW1uSW5kZXgoKSArIG1lYXN1cmVTcGVjLmdldENvbHVtblNwYW4oKTtcbiAgICAgICAgdmFyIHJvd1NwYW5FbmQgPSBtZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpICsgbWVhc3VyZVNwZWMuZ2V0Um93U3BhbigpO1xuICAgICAgICBpZiAobWVhc3VyZVNwZWMuYXV0b0NvbHVtbnNDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHZhciByZW1haW5pbmdTcGFjZSA9IGNoaWxkTWVhc3VyZWRXaWR0aDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpOyBpIDwgY29sdW1uU3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgIHJlbWFpbmluZ1NwYWNlIC09IGNvbHVtbkdyb3VwLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdTcGFjZSA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgZ3Jvd1NpemUgPSByZW1haW5pbmdTcGFjZSAvIG1lYXN1cmVTcGVjLmF1dG9Db2x1bW5zQ291bnQ7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IG1lYXN1cmVTcGVjLmdldENvbHVtbkluZGV4KCk7IGkgPCBjb2x1bW5TcGFuRW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uR3JvdXAuZ2V0SXNBdXRvKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbkdyb3VwLmxlbmd0aCArPSBncm93U2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzRmFrZU1lYXN1cmUgJiYgbWVhc3VyZVNwZWMuYXV0b1Jvd3NDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHZhciByZW1haW5pbmdTcGFjZSA9IGNoaWxkTWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbWVhc3VyZVNwZWMuZ2V0Um93SW5kZXgoKTsgaSA8IHJvd1NwYW5FbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgICAgICByZW1haW5pbmdTcGFjZSAtPSByb3dHcm91cC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nU3BhY2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdyb3dTaXplID0gcmVtYWluaW5nU3BhY2UgLyBtZWFzdXJlU3BlYy5hdXRvUm93c0NvdW50O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBtZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpOyBpIDwgcm93U3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0dyb3VwLmdldElzQXV0bygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3dHcm91cC5sZW5ndGggKz0gZ3Jvd1NpemU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtTWVhc3VyZWQobWVhc3VyZVNwZWMsIGlzRmFrZU1lYXN1cmUpO1xuICAgIH07XG4gICAgTWVhc3VyZUhlbHBlci5wcm90b3R5cGUubWVhc3VyZUNoaWxkRml4ZWRDb2x1bW5zID0gZnVuY3Rpb24gKG1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBjb2x1bW5JbmRleCA9IG1lYXN1cmVTcGVjLmdldENvbHVtbkluZGV4KCk7XG4gICAgICAgIHZhciBjb2x1bW5TcGFuRW5kID0gY29sdW1uSW5kZXggKyBtZWFzdXJlU3BlYy5nZXRDb2x1bW5TcGFuKCk7XG4gICAgICAgIHZhciByb3dJbmRleCA9IG1lYXN1cmVTcGVjLmdldFJvd0luZGV4KCk7XG4gICAgICAgIHZhciByb3dTcGFuRW5kID0gcm93SW5kZXggKyBtZWFzdXJlU3BlYy5nZXRSb3dTcGFuKCk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSAwO1xuICAgICAgICB2YXIgZ3Jvd1NpemUgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gY29sdW1uSW5kZXg7IGkgPCBjb2x1bW5TcGFuRW5kOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjb2x1bW5Hcm91cCA9IHRoaXMuY29sdW1uc1tpXTtcbiAgICAgICAgICAgIG1lYXN1cmVXaWR0aCArPSBjb2x1bW5Hcm91cC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdpZHRoTWVhc3VyZVNwZWMgPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKG1lYXN1cmVXaWR0aCwgdGhpcy5zdHJldGNoZWRIb3Jpem9udGFsbHkgPyBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSA6IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5BVF9NT1NUKTtcbiAgICAgICAgdmFyIGhlaWdodE1lYXN1cmVTcGVjID0gKG1lYXN1cmVTcGVjLmF1dG9Sb3dzQ291bnQgPiAwKSA/IHRoaXMuaW5maW5pdHkgOiBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKG1lYXN1cmVTcGVjLnBpeGVsSGVpZ2h0LCBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIHZhciBjaGlsZFNpemUgPSBncmlkX2xheW91dF9jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLmdyaWQsIG1lYXN1cmVTcGVjLmNoaWxkLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBjaGlsZE1lYXN1cmVkV2lkdGggPSBjaGlsZFNpemUubWVhc3VyZWRXaWR0aDtcbiAgICAgICAgdmFyIGNoaWxkTWVhc3VyZWRIZWlnaHQgPSBjaGlsZFNpemUubWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgIHRoaXMudXBkYXRlTWluQ29sdW1uU3RhclZhbHVlSWZOZWVkZWQobWVhc3VyZVNwZWMsIGNoaWxkTWVhc3VyZWRXaWR0aCk7XG4gICAgICAgIGlmIChtZWFzdXJlU3BlYy5hdXRvUm93c0NvdW50ID4gMCkge1xuICAgICAgICAgICAgdmFyIHJlbWFpbmluZ1NwYWNlID0gY2hpbGRNZWFzdXJlZEhlaWdodDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSByb3dJbmRleDsgaSA8IHJvd1NwYW5FbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgICAgICByZW1haW5pbmdTcGFjZSAtPSByb3dHcm91cC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nU3BhY2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgZ3Jvd1NpemUgPSByZW1haW5pbmdTcGFjZSAvIG1lYXN1cmVTcGVjLmF1dG9Sb3dzQ291bnQ7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJvd0luZGV4OyBpIDwgcm93U3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByb3dHcm91cCA9IHRoaXMucm93c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0dyb3VwLmdldElzQXV0bygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3dHcm91cC5sZW5ndGggKz0gZ3Jvd1NpemU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pdGVtTWVhc3VyZWQobWVhc3VyZVNwZWMsIGZhbHNlKTtcbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIucHJvdG90eXBlLm1lYXN1cmVDaGlsZEZpeGVkUm93cyA9IGZ1bmN0aW9uIChtZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgY29sdW1uSW5kZXggPSBtZWFzdXJlU3BlYy5nZXRDb2x1bW5JbmRleCgpO1xuICAgICAgICB2YXIgY29sdW1uU3BhbkVuZCA9IGNvbHVtbkluZGV4ICsgbWVhc3VyZVNwZWMuZ2V0Q29sdW1uU3BhbigpO1xuICAgICAgICB2YXIgcm93SW5kZXggPSBtZWFzdXJlU3BlYy5nZXRSb3dJbmRleCgpO1xuICAgICAgICB2YXIgcm93U3BhbkVuZCA9IHJvd0luZGV4ICsgbWVhc3VyZVNwZWMuZ2V0Um93U3BhbigpO1xuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSByb3dJbmRleDsgaSA8IHJvd1NwYW5FbmQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJvd0dyb3VwID0gdGhpcy5yb3dzW2ldO1xuICAgICAgICAgICAgbWVhc3VyZUhlaWdodCArPSByb3dHcm91cC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdpZHRoTWVhc3VyZVNwZWMgPSAobWVhc3VyZVNwZWMuYXV0b0NvbHVtbnNDb3VudCA+IDApID8gdGhpcy5pbmZpbml0eSA6IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMobWVhc3VyZVNwZWMucGl4ZWxXaWR0aCwgZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkpO1xuICAgICAgICB2YXIgaGVpZ2h0TWVhc3VyZVNwZWMgPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKG1lYXN1cmVIZWlnaHQsIHRoaXMuc3RyZXRjaGVkVmVydGljYWxseSA/IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5FWEFDVExZIDogZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkFUX01PU1QpO1xuICAgICAgICB2YXIgY2hpbGRTaXplID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEuVmlldy5tZWFzdXJlQ2hpbGQodGhpcy5ncmlkLCBtZWFzdXJlU3BlYy5jaGlsZCwgd2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgY2hpbGRNZWFzdXJlZFdpZHRoID0gY2hpbGRTaXplLm1lYXN1cmVkV2lkdGg7XG4gICAgICAgIHZhciBjaGlsZE1lYXN1cmVkSGVpZ2h0ID0gY2hpbGRTaXplLm1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICB2YXIgcmVtYWluaW5nU3BhY2UgPSAwO1xuICAgICAgICB2YXIgZ3Jvd1NpemUgPSAwO1xuICAgICAgICBpZiAobWVhc3VyZVNwZWMuYXV0b0NvbHVtbnNDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHJlbWFpbmluZ1NwYWNlID0gY2hpbGRNZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGNvbHVtbkluZGV4OyBpIDwgY29sdW1uU3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgIHJlbWFpbmluZ1NwYWNlIC09IGNvbHVtbkdyb3VwLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdTcGFjZSA+IDApIHtcbiAgICAgICAgICAgICAgICBncm93U2l6ZSA9IHJlbWFpbmluZ1NwYWNlIC8gbWVhc3VyZVNwZWMuYXV0b0NvbHVtbnNDb3VudDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gY29sdW1uSW5kZXg7IGkgPCBjb2x1bW5TcGFuRW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sdW1uR3JvdXAuZ2V0SXNBdXRvKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbkdyb3VwLmxlbmd0aCArPSBncm93U2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZU1pblJvd1N0YXJWYWx1ZUlmTmVlZGVkKG1lYXN1cmVTcGVjLCBjaGlsZE1lYXN1cmVkSGVpZ2h0KTtcbiAgICAgICAgdGhpcy5pdGVtTWVhc3VyZWQobWVhc3VyZVNwZWMsIGZhbHNlKTtcbiAgICB9O1xuICAgIE1lYXN1cmVIZWxwZXIucHJvdG90eXBlLm1lYXN1cmVDaGlsZEZpeGVkQ29sdW1uc0FuZFJvd3MgPSBmdW5jdGlvbiAobWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIGNvbHVtbkluZGV4ID0gbWVhc3VyZVNwZWMuZ2V0Q29sdW1uSW5kZXgoKTtcbiAgICAgICAgdmFyIGNvbHVtblNwYW5FbmQgPSBjb2x1bW5JbmRleCArIG1lYXN1cmVTcGVjLmdldENvbHVtblNwYW4oKTtcbiAgICAgICAgdmFyIHJvd0luZGV4ID0gbWVhc3VyZVNwZWMuZ2V0Um93SW5kZXgoKTtcbiAgICAgICAgdmFyIHJvd1NwYW5FbmQgPSByb3dJbmRleCArIG1lYXN1cmVTcGVjLmdldFJvd1NwYW4oKTtcbiAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSBjb2x1bW5JbmRleDsgaSA8IGNvbHVtblNwYW5FbmQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgbWVhc3VyZVdpZHRoICs9IGNvbHVtbkdyb3VwLmxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSByb3dJbmRleDsgaSA8IHJvd1NwYW5FbmQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJvd0dyb3VwID0gdGhpcy5yb3dzW2ldO1xuICAgICAgICAgICAgbWVhc3VyZUhlaWdodCArPSByb3dHcm91cC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdpZHRoTWVhc3VyZVNwZWMgPSBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKG1lYXN1cmVXaWR0aCwgKG1lYXN1cmVTcGVjLnN0YXJDb2x1bW5zQ291bnQgPiAwICYmICF0aGlzLnN0cmV0Y2hlZEhvcml6b250YWxseSkgPyBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuQVRfTU9TVCA6IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgdmFyIGhlaWdodE1lYXN1cmVTcGVjID0gZ3JpZF9sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhtZWFzdXJlSGVpZ2h0LCAobWVhc3VyZVNwZWMuc3RhclJvd3NDb3VudCA+IDAgJiYgIXRoaXMuc3RyZXRjaGVkVmVydGljYWxseSkgPyBncmlkX2xheW91dF9jb21tb25fMS5sYXlvdXQuQVRfTU9TVCA6IGdyaWRfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgdmFyIGNoaWxkU2l6ZSA9IGdyaWRfbGF5b3V0X2NvbW1vbl8xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMuZ3JpZCwgbWVhc3VyZVNwZWMuY2hpbGQsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGNoaWxkTWVhc3VyZWRXaWR0aCA9IGNoaWxkU2l6ZS5tZWFzdXJlZFdpZHRoO1xuICAgICAgICB2YXIgY2hpbGRNZWFzdXJlZEhlaWdodCA9IGNoaWxkU2l6ZS5tZWFzdXJlZEhlaWdodDtcbiAgICAgICAgdGhpcy51cGRhdGVNaW5Db2x1bW5TdGFyVmFsdWVJZk5lZWRlZChtZWFzdXJlU3BlYywgY2hpbGRNZWFzdXJlZFdpZHRoKTtcbiAgICAgICAgdGhpcy51cGRhdGVNaW5Sb3dTdGFyVmFsdWVJZk5lZWRlZChtZWFzdXJlU3BlYywgY2hpbGRNZWFzdXJlZEhlaWdodCk7XG4gICAgICAgIHRoaXMuaXRlbU1lYXN1cmVkKG1lYXN1cmVTcGVjLCBmYWxzZSk7XG4gICAgfTtcbiAgICBNZWFzdXJlSGVscGVyLnByb3RvdHlwZS51cGRhdGVNaW5Sb3dTdGFyVmFsdWVJZk5lZWRlZCA9IGZ1bmN0aW9uIChtZWFzdXJlU3BlYywgY2hpbGRNZWFzdXJlZEhlaWdodCkge1xuICAgICAgICBpZiAoIXRoaXMuc3RyZXRjaGVkVmVydGljYWxseSAmJiBtZWFzdXJlU3BlYy5zdGFyUm93c0NvdW50ID4gMCkge1xuICAgICAgICAgICAgdmFyIHJlbWFpbmluZ1NwYWNlID0gY2hpbGRNZWFzdXJlZEhlaWdodDtcbiAgICAgICAgICAgIHZhciByb3dJbmRleCA9IG1lYXN1cmVTcGVjLmdldFJvd0luZGV4KCk7XG4gICAgICAgICAgICB2YXIgcm93U3BhbkVuZCA9IHJvd0luZGV4ICsgbWVhc3VyZVNwZWMuZ2V0Um93U3BhbigpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJvd0luZGV4OyBpIDwgcm93U3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0dyb3VwID0gdGhpcy5yb3dzW2ldO1xuICAgICAgICAgICAgICAgIGlmICghcm93R3JvdXAuZ2V0SXNTdGFyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nU3BhY2UgLT0gcm93R3JvdXAubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdTcGFjZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pblJvd1N0YXJWYWx1ZSA9IE1hdGgubWF4KHJlbWFpbmluZ1NwYWNlIC8gbWVhc3VyZVNwZWMuc3RhclJvd3NDb3VudCwgdGhpcy5taW5Sb3dTdGFyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBNZWFzdXJlSGVscGVyLnByb3RvdHlwZS51cGRhdGVNaW5Db2x1bW5TdGFyVmFsdWVJZk5lZWRlZCA9IGZ1bmN0aW9uIChtZWFzdXJlU3BlYywgY2hpbGRNZWFzdXJlZFdpZHRoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdHJldGNoZWRIb3Jpem9udGFsbHkgJiYgbWVhc3VyZVNwZWMuc3RhckNvbHVtbnNDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHZhciByZW1haW5pbmdTcGFjZSA9IGNoaWxkTWVhc3VyZWRXaWR0aDtcbiAgICAgICAgICAgIHZhciBjb2x1bW5JbmRleCA9IG1lYXN1cmVTcGVjLmdldENvbHVtbkluZGV4KCk7XG4gICAgICAgICAgICB2YXIgY29sdW1uU3BhbkVuZCA9IGNvbHVtbkluZGV4ICsgbWVhc3VyZVNwZWMuZ2V0Q29sdW1uU3BhbigpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGNvbHVtbkluZGV4OyBpIDwgY29sdW1uU3BhbkVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbHVtbkdyb3VwID0gdGhpcy5jb2x1bW5zW2ldO1xuICAgICAgICAgICAgICAgIGlmICghY29sdW1uR3JvdXAuZ2V0SXNTdGFyKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nU3BhY2UgLT0gY29sdW1uR3JvdXAubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdTcGFjZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1pbkNvbHVtblN0YXJWYWx1ZSA9IE1hdGgubWF4KHJlbWFpbmluZ1NwYWNlIC8gbWVhc3VyZVNwZWMuc3RhckNvbHVtbnNDb3VudCwgdGhpcy5taW5Db2x1bW5TdGFyVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gTWVhc3VyZUhlbHBlcjtcbn0oKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ncmlkLWxheW91dC5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTGF5b3V0QmFzZUNvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExheW91dEJhc2VDb21tb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGF5b3V0QmFzZUNvbW1vbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9zdWJWaWV3cyA9IG5ldyBBcnJheSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRyZW5Db3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1YlZpZXdzLmxlbmd0aDtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YlZpZXdzLmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRBdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3NbaW5kZXhdO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuZ2V0Q2hpbGRJbmRleCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3ViVmlld3MuaW5kZXhPZihjaGlsZCk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5nZXRDaGlsZEJ5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHZpZXdfMS5nZXRWaWV3QnlJZCh0aGlzLCBpZCk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZS5fcmVnaXN0ZXJMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgIH07XG4gICAgTGF5b3V0QmFzZUNvbW1vbi5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgdGhpcy5fc3ViVmlld3MucHVzaChjaGlsZCk7XG4gICAgICAgIHRoaXMuX2FkZFZpZXcoY2hpbGQpO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmluc2VydENoaWxkID0gZnVuY3Rpb24gKGNoaWxkLCBhdEluZGV4KSB7XG4gICAgICAgIHRoaXMuX3N1YlZpZXdzLnNwbGljZShhdEluZGV4LCAwLCBjaGlsZCk7XG4gICAgICAgIHRoaXMuX2FkZFZpZXcoY2hpbGQsIGF0SW5kZXgpO1xuICAgICAgICB0aGlzLl9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX3JlbW92ZVZpZXcoY2hpbGQpO1xuICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9zdWJWaWV3cy5pbmRleE9mKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fc3ViVmlld3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgdGhpcy5fdW5yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLnJlbW92ZUNoaWxkcmVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3aGlsZSAodGhpcy5nZXRDaGlsZHJlbkNvdW50KCkgIT09IDApIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGQodGhpcy5fc3ViVmlld3NbdGhpcy5nZXRDaGlsZHJlbkNvdW50KCkgLSAxXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nVG9wO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nUmlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdSaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nQm90dG9tXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYXlvdXRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nTGVmdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdMZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLl9jaGlsZEluZGV4VG9OYXRpdmVDaGlsZEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGV4ICYmIGkgPCB0aGlzLl9zdWJWaWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IHRoaXMuX3N1YlZpZXdzW2ldLl9nZXROYXRpdmVWaWV3c0NvdW50KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdGhpcy5fc3ViVmlld3MubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHJldFZhbCA9IGNhbGxiYWNrKHRoaXMuX3N1YlZpZXdzW2ldKTtcbiAgICAgICAgICAgIGlmIChyZXRWYWwgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExheW91dEJhc2VDb21tb24ucHJvdG90eXBlLmVhY2hMYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgbGFzdENoaWxkID0gbnVsbDtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjdikge1xuICAgICAgICAgICAgY3YuX2VhY2hMYXlvdXRWaWV3KGZ1bmN0aW9uIChsdikge1xuICAgICAgICAgICAgICAgIGlmIChsYXN0Q2hpbGQgJiYgIWxhc3RDaGlsZC5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhsYXN0Q2hpbGQsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdENoaWxkID0gbHY7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGxhc3RDaGlsZCAmJiAhbGFzdENoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhsYXN0Q2hpbGQsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gTGF5b3V0QmFzZUNvbW1vbjtcbn0odmlld18xLkN1c3RvbUxheW91dFZpZXcpKTtcbmV4cG9ydHMuTGF5b3V0QmFzZUNvbW1vbiA9IExheW91dEJhc2VDb21tb247XG5leHBvcnRzLmNsaXBUb0JvdW5kc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiY2xpcFRvQm91bmRzXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5jbGlwVG9Cb3VuZHNQcm9wZXJ0eS5yZWdpc3RlcihMYXlvdXRCYXNlQ29tbW9uKTtcbmV4cG9ydHMuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImlzUGFzc1Rocm91Z2hQYXJlbnRFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihMYXlvdXRCYXNlQ29tbW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxheW91dC1iYXNlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vbGF5b3V0LWJhc2UtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbGF5b3V0LWJhc2UtY29tbW9uXCIpKTtcbnZhciBMYXlvdXRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMYXlvdXRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExheW91dEJhc2UucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkQ2hpbGQuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGUuaW5zZXJ0Q2hpbGQgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbnNlcnRDaGlsZC5jYWxsKHRoaXMsIGNoaWxkLCBhdEluZGV4KTtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZS5yZW1vdmVDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUNoaWxkLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmNsaXBUb0JvdW5kcykge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNsaXBzVG9Cb3VuZHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fc2V0TmF0aXZlQ2xpcFRvQm91bmRzLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExheW91dEJhc2UucHJvdG90eXBlW2xheW91dF9iYXNlX2NvbW1vbl8xLmNsaXBUb0JvdW5kc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBMYXlvdXRCYXNlLnByb3RvdHlwZVtsYXlvdXRfYmFzZV9jb21tb25fMS5jbGlwVG9Cb3VuZHNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcygpO1xuICAgIH07XG4gICAgTGF5b3V0QmFzZS5wcm90b3R5cGVbbGF5b3V0X2Jhc2VfY29tbW9uXzEuaXNQYXNzVGhyb3VnaFBhcmVudEVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5zZXRQYXNzVGhyb3VnaFBhcmVudCh2YWx1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfY29tbW9uXzEuTGF5b3V0QmFzZUNvbW1vbikpO1xuZXhwb3J0cy5MYXlvdXRCYXNlID0gTGF5b3V0QmFzZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxheW91dC1iYXNlLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vbGF5b3V0LWJhc2VcIikpO1xudmFyIFN0YWNrTGF5b3V0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN0YWNrTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdGFja0xheW91dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3RhY2tMYXlvdXRCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIlN0YWNrTGF5b3V0XCIpXG4gICAgXSwgU3RhY2tMYXlvdXRCYXNlKTtcbiAgICByZXR1cm4gU3RhY2tMYXlvdXRCYXNlO1xufShsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpKTtcbmV4cG9ydHMuU3RhY2tMYXlvdXRCYXNlID0gU3RhY2tMYXlvdXRCYXNlO1xuU3RhY2tMYXlvdXRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xudmFyIGNvbnZlcnRlciA9IGxheW91dF9iYXNlXzEubWFrZVBhcnNlcihsYXlvdXRfYmFzZV8xLm1ha2VWYWxpZGF0b3IoXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIikpO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcIm9yaWVudGF0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJ2ZXJ0aWNhbFwiLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogY29udmVydGVyIH0pO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5LnJlZ2lzdGVyKFN0YWNrTGF5b3V0QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdGFjay1sYXlvdXQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc3RhY2tfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc3RhY2stbGF5b3V0LWNvbW1vblwiKTtcbnZhciB0cmFjZSA9IHJlcXVpcmUoXCIuLi8uLi8uLi90cmFjZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3N0YWNrLWxheW91dC1jb21tb25cIikpO1xudmFyIFN0YWNrTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3RhY2tMYXlvdXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3RhY2tMYXlvdXQoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fdG90YWxMZW5ndGggPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN0YWNrTGF5b3V0LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbk1lYXN1cmUuY2FsbCh0aGlzLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSAwO1xuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IDA7XG4gICAgICAgIHZhciB3aWR0aCA9IHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSBzdGFja19sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaXNWZXJ0aWNhbCA9IHRoaXMub3JpZW50YXRpb24gPT09IFwidmVydGljYWxcIjtcbiAgICAgICAgdmFyIGhvcml6b250YWxQYWRkaW5nc0FuZE1hcmdpbnMgPSB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgdmFyIHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIHZhciBtZWFzdXJlU3BlYztcbiAgICAgICAgdmFyIG1vZGUgPSBpc1ZlcnRpY2FsID8gaGVpZ2h0TW9kZSA6IHdpZHRoTW9kZTtcbiAgICAgICAgdmFyIHJlbWFpbmluZ0xlbmd0aDtcbiAgICAgICAgaWYgKG1vZGUgPT09IHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQpIHtcbiAgICAgICAgICAgIG1lYXN1cmVTcGVjID0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRDtcbiAgICAgICAgICAgIHJlbWFpbmluZ0xlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtZWFzdXJlU3BlYyA9IHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQuQVRfTU9TVDtcbiAgICAgICAgICAgIHJlbWFpbmluZ0xlbmd0aCA9IGlzVmVydGljYWwgPyBoZWlnaHQgLSB2ZXJ0aWNhbFBhZGRpbmdzQW5kTWFyZ2lucyA6IHdpZHRoIC0gaG9yaXpvbnRhbFBhZGRpbmdzQW5kTWFyZ2lucztcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hpbGRNZWFzdXJlU3BlYztcbiAgICAgICAgaWYgKGlzVmVydGljYWwpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZFdpZHRoID0gKHdpZHRoTW9kZSA9PT0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRCkgPyAwIDogd2lkdGggLSBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICAgICAgY2hpbGRXaWR0aCA9IE1hdGgubWF4KDAsIGNoaWxkV2lkdGgpO1xuICAgICAgICAgICAgY2hpbGRNZWFzdXJlU3BlYyA9IHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKGNoaWxkV2lkdGgsIHdpZHRoTW9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgY2hpbGRIZWlnaHQgPSAoaGVpZ2h0TW9kZSA9PT0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRCkgPyAwIDogaGVpZ2h0IC0gdmVydGljYWxQYWRkaW5nc0FuZE1hcmdpbnM7XG4gICAgICAgICAgICBjaGlsZEhlaWdodCA9IE1hdGgubWF4KDAsIGNoaWxkSGVpZ2h0KTtcbiAgICAgICAgICAgIGNoaWxkTWVhc3VyZVNwZWMgPSBzdGFja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhjaGlsZEhlaWdodCwgaGVpZ2h0TW9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkU2l6ZTtcbiAgICAgICAgdGhpcy5lYWNoTGF5b3V0Q2hpbGQoZnVuY3Rpb24gKGNoaWxkLCBsYXN0KSB7XG4gICAgICAgICAgICBpZiAoaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgIGNoaWxkU2l6ZSA9IHN0YWNrX2xheW91dF9jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZChfdGhpcywgY2hpbGQsIGNoaWxkTWVhc3VyZVNwZWMsIHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHJlbWFpbmluZ0xlbmd0aCwgbWVhc3VyZVNwZWMpKTtcbiAgICAgICAgICAgICAgICBpZiAobWVhc3VyZVNwZWMgPT09IHN0YWNrX2xheW91dF9jb21tb25fMS5sYXlvdXQuQVRfTU9TVCAmJiBfdGhpcy5pc1Vuc2l6ZWRTY3JvbGxhYmxlVmlldyhjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2Uud3JpdGUoXCJBdm9pZCB1c2luZyBMaXN0VmlldyBvciBTY3JvbGxWaWV3IHdpdGggbm8gZXhwbGljaXQgaGVpZ2h0IHNldCBpbnNpZGUgU3RhY2tMYXlvdXQuIERvaW5nIHNvIG1pZ2h0IHJlc3VsdCBpbiBwb29yIHVzZXIgaW50ZXJmYWNlIHBlcmZvcm1hbmNlIGFuZCBwb29yIHVzZXIgZXhwZXJpZW5jZS5cIiwgdHJhY2UuY2F0ZWdvcmllcy5MYXlvdXQsIHRyYWNlLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChtZWFzdXJlV2lkdGgsIGNoaWxkU2l6ZS5tZWFzdXJlZFdpZHRoKTtcbiAgICAgICAgICAgICAgICB2YXIgdmlld0hlaWdodCA9IGNoaWxkU2l6ZS5tZWFzdXJlZEhlaWdodDtcbiAgICAgICAgICAgICAgICBtZWFzdXJlSGVpZ2h0ICs9IHZpZXdIZWlnaHQ7XG4gICAgICAgICAgICAgICAgcmVtYWluaW5nTGVuZ3RoID0gTWF0aC5tYXgoMCwgcmVtYWluaW5nTGVuZ3RoIC0gdmlld0hlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGlsZFNpemUgPSBzdGFja19sYXlvdXRfY29tbW9uXzEuVmlldy5tZWFzdXJlQ2hpbGQoX3RoaXMsIGNoaWxkLCBzdGFja19sYXlvdXRfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhyZW1haW5pbmdMZW5ndGgsIG1lYXN1cmVTcGVjKSwgY2hpbGRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KG1lYXN1cmVIZWlnaHQsIGNoaWxkU2l6ZS5tZWFzdXJlZEhlaWdodCk7XG4gICAgICAgICAgICAgICAgdmFyIHZpZXdXaWR0aCA9IGNoaWxkU2l6ZS5tZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgICAgIG1lYXN1cmVXaWR0aCArPSB2aWV3V2lkdGg7XG4gICAgICAgICAgICAgICAgcmVtYWluaW5nTGVuZ3RoID0gTWF0aC5tYXgoMCwgcmVtYWluaW5nTGVuZ3RoIC0gdmlld1dpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIG1lYXN1cmVXaWR0aCArPSBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ICs9IHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChtZWFzdXJlV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobWVhc3VyZUhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICB0aGlzLl90b3RhbExlbmd0aCA9IGlzVmVydGljYWwgPyBtZWFzdXJlSGVpZ2h0IDogbWVhc3VyZVdpZHRoO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IHN0YWNrX2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gc3RhY2tfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIFN0YWNrTGF5b3V0LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHZhciBpbnNldHMgPSB0aGlzLmdldFNhZmVBcmVhSW5zZXRzKCk7XG4gICAgICAgIGlmICh0aGlzLm9yaWVudGF0aW9uID09PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgICAgICAgIHRoaXMubGF5b3V0VmVydGljYWwobGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXRIb3Jpem9udGFsKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSwgaW5zZXRzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3RhY2tMYXlvdXQucHJvdG90eXBlLmxheW91dFZlcnRpY2FsID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSwgaW5zZXRzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBwYWRkaW5nTGVmdCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIGluc2V0cy5sZWZ0O1xuICAgICAgICB2YXIgcGFkZGluZ1RvcCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyBpbnNldHMudG9wO1xuICAgICAgICB2YXIgcGFkZGluZ1JpZ2h0ID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyBpbnNldHMucmlnaHQ7XG4gICAgICAgIHZhciBwYWRkaW5nQm90dG9tID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIGluc2V0cy5ib3R0b207XG4gICAgICAgIHZhciBjaGlsZFRvcDtcbiAgICAgICAgdmFyIGNoaWxkTGVmdCA9IHBhZGRpbmdMZWZ0O1xuICAgICAgICB2YXIgY2hpbGRSaWdodCA9IHJpZ2h0IC0gbGVmdCAtIHBhZGRpbmdSaWdodDtcbiAgICAgICAgc3dpdGNoICh0aGlzLnZlcnRpY2FsQWxpZ25tZW50KSB7XG4gICAgICAgICAgICBjYXNlIHN0YWNrX2xheW91dF9jb21tb25fMS5WZXJ0aWNhbEFsaWdubWVudC5NSURETEU6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSAoYm90dG9tIC0gdG9wIC0gdGhpcy5fdG90YWxMZW5ndGgpIC8gMiArIHBhZGRpbmdUb3AgLSBwYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBzdGFja19sYXlvdXRfY29tbW9uXzEuVmVydGljYWxBbGlnbm1lbnQuQk9UVE9NOlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gYm90dG9tIC0gdG9wIC0gdGhpcy5fdG90YWxMZW5ndGggKyBwYWRkaW5nVG9wIC0gcGFkZGluZ0JvdHRvbTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2Ugc3RhY2tfbGF5b3V0X2NvbW1vbl8xLlZlcnRpY2FsQWxpZ25tZW50LlRPUDpcbiAgICAgICAgICAgIGNhc2Ugc3RhY2tfbGF5b3V0X2NvbW1vbl8xLlZlcnRpY2FsQWxpZ25tZW50LlNUUkVUQ0g6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZEhlaWdodCA9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Ub3AgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgICAgICBzdGFja19sYXlvdXRfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZChfdGhpcywgY2hpbGQsIGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkUmlnaHQsIGNoaWxkVG9wICsgY2hpbGRIZWlnaHQpO1xuICAgICAgICAgICAgY2hpbGRUb3AgKz0gY2hpbGRIZWlnaHQ7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3RhY2tMYXlvdXQucHJvdG90eXBlLmxheW91dEhvcml6b250YWwgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tLCBpbnNldHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHBhZGRpbmdMZWZ0ID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgaW5zZXRzLmxlZnQ7XG4gICAgICAgIHZhciBwYWRkaW5nVG9wID0gdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIGluc2V0cy50b3A7XG4gICAgICAgIHZhciBwYWRkaW5nUmlnaHQgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIGluc2V0cy5yaWdodDtcbiAgICAgICAgdmFyIHBhZGRpbmdCb3R0b20gPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgaW5zZXRzLmJvdHRvbTtcbiAgICAgICAgdmFyIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgdmFyIGNoaWxkTGVmdDtcbiAgICAgICAgdmFyIGNoaWxkQm90dG9tID0gYm90dG9tIC0gdG9wIC0gcGFkZGluZ0JvdHRvbTtcbiAgICAgICAgc3dpdGNoICh0aGlzLmhvcml6b250YWxBbGlnbm1lbnQpIHtcbiAgICAgICAgICAgIGNhc2Ugc3RhY2tfbGF5b3V0X2NvbW1vbl8xLkhvcml6b250YWxBbGlnbm1lbnQuQ0VOVEVSOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IChyaWdodCAtIGxlZnQgLSB0aGlzLl90b3RhbExlbmd0aCkgLyAyICsgcGFkZGluZ0xlZnQgLSBwYWRkaW5nUmlnaHQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHN0YWNrX2xheW91dF9jb21tb25fMS5Ib3Jpem9udGFsQWxpZ25tZW50LlJJR0hUOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHJpZ2h0IC0gbGVmdCAtIHRoaXMuX3RvdGFsTGVuZ3RoICsgcGFkZGluZ0xlZnQgLSBwYWRkaW5nUmlnaHQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHN0YWNrX2xheW91dF9jb21tb25fMS5Ib3Jpem9udGFsQWxpZ25tZW50LkxFRlQ6XG4gICAgICAgICAgICBjYXNlIHN0YWNrX2xheW91dF9jb21tb25fMS5Ib3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0g6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHBhZGRpbmdMZWZ0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZWFjaExheW91dENoaWxkKGZ1bmN0aW9uIChjaGlsZCwgbGFzdCkge1xuICAgICAgICAgICAgdmFyIGNoaWxkV2lkdGggPSBjaGlsZC5nZXRNZWFzdXJlZFdpZHRoKCkgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5MZWZ0ICsgY2hpbGQuZWZmZWN0aXZlTWFyZ2luUmlnaHQ7XG4gICAgICAgICAgICBzdGFja19sYXlvdXRfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZChfdGhpcywgY2hpbGQsIGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkTGVmdCArIGNoaWxkV2lkdGgsIGNoaWxkQm90dG9tKTtcbiAgICAgICAgICAgIGNoaWxkTGVmdCArPSBjaGlsZFdpZHRoO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN0YWNrTGF5b3V0LnByb3RvdHlwZS5pc1Vuc2l6ZWRTY3JvbGxhYmxlVmlldyA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBpZiAoY2hpbGQuaGVpZ2h0ID09PSBcImF1dG9cIiAmJiAoY2hpbGQuaW9zIGluc3RhbmNlb2YgVUlUYWJsZVZpZXcgfHwgY2hpbGQuaW9zIGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgcmV0dXJuIFN0YWNrTGF5b3V0O1xufShzdGFja19sYXlvdXRfY29tbW9uXzEuU3RhY2tMYXlvdXRCYXNlKSk7XG5leHBvcnRzLlN0YWNrTGF5b3V0ID0gU3RhY2tMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdGFjay1sYXlvdXQuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGF5b3V0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXQtYmFzZVwiKSk7XG52YXIgV3JhcExheW91dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXcmFwTGF5b3V0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXcmFwTGF5b3V0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBXcmFwTGF5b3V0QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJXcmFwTGF5b3V0XCIpXG4gICAgXSwgV3JhcExheW91dEJhc2UpO1xuICAgIHJldHVybiBXcmFwTGF5b3V0QmFzZTtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLldyYXBMYXlvdXRCYXNlID0gV3JhcExheW91dEJhc2U7XG5XcmFwTGF5b3V0QmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuaXRlbVdpZHRoUHJvcGVydHkgPSBuZXcgbGF5b3V0X2Jhc2VfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtV2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBsYXlvdXRfYmFzZV8xLkxlbmd0aC5wYXJzZSh2KTsgfSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkgeyByZXR1cm4gdGFyZ2V0LmVmZmVjdGl2ZUl0ZW1XaWR0aCA9IGxheW91dF9iYXNlXzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAtMSk7IH1cbn0pO1xuZXhwb3J0cy5pdGVtV2lkdGhQcm9wZXJ0eS5yZWdpc3RlcihXcmFwTGF5b3V0QmFzZSk7XG5leHBvcnRzLml0ZW1IZWlnaHRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1IZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgYWZmZWN0c0xheW91dDogbGF5b3V0X2Jhc2VfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBsYXlvdXRfYmFzZV8xLkxlbmd0aC5wYXJzZSh2KTsgfSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkgeyByZXR1cm4gdGFyZ2V0LmVmZmVjdGl2ZUl0ZW1IZWlnaHQgPSBsYXlvdXRfYmFzZV8xLkxlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgLTEpOyB9XG59KTtcbmV4cG9ydHMuaXRlbUhlaWdodFByb3BlcnR5LnJlZ2lzdGVyKFdyYXBMYXlvdXRCYXNlKTtcbnZhciBjb252ZXJ0ZXIgPSBsYXlvdXRfYmFzZV8xLm1ha2VQYXJzZXIobGF5b3V0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCIpKTtcbmV4cG9ydHMub3JpZW50YXRpb25Qcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmllbnRhdGlvblwiLCBkZWZhdWx0VmFsdWU6IFwiaG9yaXpvbnRhbFwiLCBhZmZlY3RzTGF5b3V0OiBsYXlvdXRfYmFzZV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogY29udmVydGVyIH0pO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5LnJlZ2lzdGVyKFdyYXBMYXlvdXRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdyYXAtbGF5b3V0LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHdyYXBfbGF5b3V0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vd3JhcC1sYXlvdXQtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vd3JhcC1sYXlvdXQtY29tbW9uXCIpKTtcbnZhciBXcmFwTGF5b3V0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV3JhcExheW91dCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXcmFwTGF5b3V0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2xlbmd0aHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBXcmFwTGF5b3V0LmdldENoaWxkTWVhc3VyZVNwZWMgPSBmdW5jdGlvbiAocGFyZW50TW9kZSwgcGFyZW50TGVuZ3RoLCBpdGVtTGVuZ3RoKSB7XG4gICAgICAgIGlmIChpdGVtTGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHdyYXBfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoaXRlbUxlbmd0aCwgd3JhcF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHBhcmVudE1vZGUgPT09IHdyYXBfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRCkge1xuICAgICAgICAgICAgcmV0dXJuIHdyYXBfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoMCwgd3JhcF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LlVOU1BFQ0lGSUVEKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB3cmFwX2xheW91dF9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHBhcmVudExlbmd0aCwgd3JhcF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LkFUX01PU1QpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBXcmFwTGF5b3V0LnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbk1lYXN1cmUuY2FsbCh0aGlzLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSAwO1xuICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IDA7XG4gICAgICAgIHZhciB3aWR0aCA9IHdyYXBfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB3cmFwX2xheW91dF9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gd3JhcF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gd3JhcF9sYXlvdXRfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zID0gdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGg7XG4gICAgICAgIHZhciB2ZXJ0aWNhbFBhZGRpbmdzQW5kTWFyZ2lucyA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICB2YXIgYXZhaWxhYmxlV2lkdGggPSB3aWR0aE1vZGUgPT09IHdyYXBfbGF5b3V0X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRCA/IE51bWJlci5NQVhfVkFMVUUgOiB3aWR0aCAtIGhvcml6b250YWxQYWRkaW5nc0FuZE1hcmdpbnM7XG4gICAgICAgIHZhciBhdmFpbGFibGVIZWlnaHQgPSBoZWlnaHRNb2RlID09PSB3cmFwX2xheW91dF9jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyBOdW1iZXIuTUFYX1ZBTFVFIDogaGVpZ2h0IC0gdmVydGljYWxQYWRkaW5nc0FuZE1hcmdpbnM7XG4gICAgICAgIHZhciBjaGlsZFdpZHRoTWVhc3VyZVNwZWMgPSBXcmFwTGF5b3V0LmdldENoaWxkTWVhc3VyZVNwZWMod2lkdGhNb2RlLCBhdmFpbGFibGVXaWR0aCwgdGhpcy5lZmZlY3RpdmVJdGVtV2lkdGgpO1xuICAgICAgICB2YXIgY2hpbGRIZWlnaHRNZWFzdXJlU3BlYyA9IFdyYXBMYXlvdXQuZ2V0Q2hpbGRNZWFzdXJlU3BlYyhoZWlnaHRNb2RlLCBhdmFpbGFibGVIZWlnaHQsIHRoaXMuZWZmZWN0aXZlSXRlbUhlaWdodCk7XG4gICAgICAgIHZhciByZW1haW5pbmdXaWR0aCA9IGF2YWlsYWJsZVdpZHRoO1xuICAgICAgICB2YXIgcmVtYWluaW5nSGVpZ2h0ID0gYXZhaWxhYmxlSGVpZ2h0O1xuICAgICAgICB0aGlzLl9sZW5ndGhzLmxlbmd0aCA9IDA7XG4gICAgICAgIHZhciByb3dPckNvbHVtbiA9IDA7XG4gICAgICAgIHZhciBtYXhMZW5ndGggPSAwO1xuICAgICAgICB2YXIgaXNWZXJ0aWNhbCA9IHRoaXMub3JpZW50YXRpb24gPT09IFwidmVydGljYWxcIjtcbiAgICAgICAgdmFyIHVzZUl0ZW1XaWR0aCA9IHRoaXMuZWZmZWN0aXZlSXRlbVdpZHRoID4gMDtcbiAgICAgICAgdmFyIHVzZUl0ZW1IZWlnaHQgPSB0aGlzLmVmZmVjdGl2ZUl0ZW1IZWlnaHQgPiAwO1xuICAgICAgICB2YXIgaXRlbVdpZHRoID0gdGhpcy5lZmZlY3RpdmVJdGVtV2lkdGg7XG4gICAgICAgIHZhciBpdGVtSGVpZ2h0ID0gdGhpcy5lZmZlY3RpdmVJdGVtSGVpZ2h0O1xuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBkZXNpcmVkU2l6ZSA9IHdyYXBfbGF5b3V0X2NvbW1vbl8xLlZpZXcubWVhc3VyZUNoaWxkKF90aGlzLCBjaGlsZCwgY2hpbGRXaWR0aE1lYXN1cmVTcGVjLCBjaGlsZEhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBjaGlsZE1lYXN1cmVkV2lkdGggPSB1c2VJdGVtV2lkdGggPyBpdGVtV2lkdGggOiBkZXNpcmVkU2l6ZS5tZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgdmFyIGNoaWxkTWVhc3VyZWRIZWlnaHQgPSB1c2VJdGVtSGVpZ2h0ID8gaXRlbUhlaWdodCA6IGRlc2lyZWRTaXplLm1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICAgICAgdmFyIGlzRmlyc3QgPSBfdGhpcy5fbGVuZ3Rocy5sZW5ndGggPD0gcm93T3JDb2x1bW47XG4gICAgICAgICAgICBpZiAoaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZE1lYXN1cmVkSGVpZ2h0ID4gcmVtYWluaW5nSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJvd09yQ29sdW1uKys7XG4gICAgICAgICAgICAgICAgICAgIG1heExlbmd0aCA9IE1hdGgubWF4KG1heExlbmd0aCwgbWVhc3VyZUhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIG1lYXN1cmVIZWlnaHQgPSBjaGlsZE1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdIZWlnaHQgPSBhdmFpbGFibGVIZWlnaHQgLSBjaGlsZE1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGVuZ3Roc1tpc0ZpcnN0ID8gcm93T3JDb2x1bW4gLSAxIDogcm93T3JDb2x1bW5dID0gY2hpbGRNZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nSGVpZ2h0IC09IGNoaWxkTWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIG1lYXN1cmVIZWlnaHQgKz0gY2hpbGRNZWFzdXJlZEhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRNZWFzdXJlZFdpZHRoID4gcmVtYWluaW5nV2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgcm93T3JDb2x1bW4rKztcbiAgICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoID0gTWF0aC5tYXgobWF4TGVuZ3RoLCBtZWFzdXJlV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICBtZWFzdXJlV2lkdGggPSBjaGlsZE1lYXN1cmVkV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZ1dpZHRoID0gYXZhaWxhYmxlV2lkdGggLSBjaGlsZE1lYXN1cmVkV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9sZW5ndGhzW2lzRmlyc3QgPyByb3dPckNvbHVtbiAtIDEgOiByb3dPckNvbHVtbl0gPSBjaGlsZE1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nV2lkdGggLT0gY2hpbGRNZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICBtZWFzdXJlV2lkdGggKz0gY2hpbGRNZWFzdXJlZFdpZHRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0ZpcnN0KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2xlbmd0aHNbcm93T3JDb2x1bW5dID0gaXNWZXJ0aWNhbCA/IGNoaWxkTWVhc3VyZWRXaWR0aCA6IGNoaWxkTWVhc3VyZWRIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fbGVuZ3Roc1tyb3dPckNvbHVtbl0gPSBNYXRoLm1heChfdGhpcy5fbGVuZ3Roc1tyb3dPckNvbHVtbl0sIGlzVmVydGljYWwgPyBjaGlsZE1lYXN1cmVkV2lkdGggOiBjaGlsZE1lYXN1cmVkSGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChpc1ZlcnRpY2FsKSB7XG4gICAgICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobWF4TGVuZ3RoLCBtZWFzdXJlSGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuX2xlbmd0aHMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4LCBhcnJheSkge1xuICAgICAgICAgICAgICAgIG1lYXN1cmVXaWR0aCArPSB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbWVhc3VyZVdpZHRoID0gTWF0aC5tYXgobWF4TGVuZ3RoLCBtZWFzdXJlV2lkdGgpO1xuICAgICAgICAgICAgdGhpcy5fbGVuZ3Rocy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgsIGFycmF5KSB7XG4gICAgICAgICAgICAgICAgbWVhc3VyZUhlaWdodCArPSB2YWx1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIG1lYXN1cmVXaWR0aCArPSBob3Jpem9udGFsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ICs9IHZlcnRpY2FsUGFkZGluZ3NBbmRNYXJnaW5zO1xuICAgICAgICBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChtZWFzdXJlV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgobWVhc3VyZUhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IHdyYXBfbGF5b3V0X2NvbW1vbl8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSB3cmFwX2xheW91dF9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBXcmFwTGF5b3V0LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHZhciBpbnNldHMgPSB0aGlzLmdldFNhZmVBcmVhSW5zZXRzKCk7XG4gICAgICAgIHZhciBpc1ZlcnRpY2FsID0gdGhpcy5vcmllbnRhdGlvbiA9PT0gXCJ2ZXJ0aWNhbFwiO1xuICAgICAgICB2YXIgcGFkZGluZ0xlZnQgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyBpbnNldHMubGVmdDtcbiAgICAgICAgdmFyIHBhZGRpbmdUb3AgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgaW5zZXRzLnRvcDtcbiAgICAgICAgdmFyIHBhZGRpbmdSaWdodCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgaW5zZXRzLnJpZ2h0O1xuICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBpbnNldHMuYm90dG9tO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0ID0gcGFkZGluZ0xlZnQ7XG4gICAgICAgIHZhciBjaGlsZFRvcCA9IHBhZGRpbmdUb3A7XG4gICAgICAgIHZhciBjaGlsZHJlbkhlaWdodCA9IGJvdHRvbSAtIHRvcCAtIHBhZGRpbmdCb3R0b207XG4gICAgICAgIHZhciBjaGlsZHJlbldpZHRoID0gcmlnaHQgLSBsZWZ0IC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICB2YXIgcm93T3JDb2x1bW4gPSAwO1xuICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQsIGxhc3QpIHtcbiAgICAgICAgICAgIHZhciBjaGlsZEhlaWdodCA9IGNoaWxkLmdldE1lYXN1cmVkSGVpZ2h0KCkgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Ub3AgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgICAgICB2YXIgY2hpbGRXaWR0aCA9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKSArIGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBfdGhpcy5fbGVuZ3Roc1tyb3dPckNvbHVtbl07XG4gICAgICAgICAgICBpZiAoaXNWZXJ0aWNhbCkge1xuICAgICAgICAgICAgICAgIGNoaWxkV2lkdGggPSBsZW5ndGg7XG4gICAgICAgICAgICAgICAgY2hpbGRIZWlnaHQgPSBfdGhpcy5lZmZlY3RpdmVJdGVtSGVpZ2h0ID4gMCA/IF90aGlzLmVmZmVjdGl2ZUl0ZW1IZWlnaHQgOiBjaGlsZEhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgaXNGaXJzdCA9IGNoaWxkVG9wID09PSBwYWRkaW5nVG9wO1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZFRvcCArIGNoaWxkSGVpZ2h0ID4gY2hpbGRyZW5IZWlnaHQgJiYgY2hpbGRMZWZ0ICsgY2hpbGRXaWR0aCA8PSBjaGlsZHJlbldpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gcGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0ZpcnN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZExlZnQgKz0gbGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvd09yQ29sdW1uKys7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkV2lkdGggPSBfdGhpcy5fbGVuZ3Roc1tpc0ZpcnN0ID8gcm93T3JDb2x1bW4gLSAxIDogcm93T3JDb2x1bW5dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2hpbGRMZWZ0IDwgY2hpbGRyZW5XaWR0aCAmJiBjaGlsZFRvcCA8IGNoaWxkcmVuSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIHdyYXBfbGF5b3V0X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQoX3RoaXMsIGNoaWxkLCBjaGlsZExlZnQsIGNoaWxkVG9wLCBjaGlsZExlZnQgKyBjaGlsZFdpZHRoLCBjaGlsZFRvcCArIGNoaWxkSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgKz0gY2hpbGRIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGlsZFdpZHRoID0gX3RoaXMuZWZmZWN0aXZlSXRlbVdpZHRoID4gMCA/IF90aGlzLmVmZmVjdGl2ZUl0ZW1XaWR0aCA6IGNoaWxkV2lkdGg7XG4gICAgICAgICAgICAgICAgY2hpbGRIZWlnaHQgPSBsZW5ndGg7XG4gICAgICAgICAgICAgICAgdmFyIGlzRmlyc3QgPSBjaGlsZExlZnQgPT09IHBhZGRpbmdMZWZ0O1xuICAgICAgICAgICAgICAgIGlmIChjaGlsZExlZnQgKyBjaGlsZFdpZHRoID4gY2hpbGRyZW5XaWR0aCAmJiBjaGlsZFRvcCArIGNoaWxkSGVpZ2h0IDw9IGNoaWxkcmVuSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHBhZGRpbmdMZWZ0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzRmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkVG9wICs9IGxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByb3dPckNvbHVtbisrO1xuICAgICAgICAgICAgICAgICAgICBjaGlsZEhlaWdodCA9IF90aGlzLl9sZW5ndGhzW2lzRmlyc3QgPyByb3dPckNvbHVtbiAtIDEgOiByb3dPckNvbHVtbl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaGlsZExlZnQgPCBjaGlsZHJlbldpZHRoICYmIGNoaWxkVG9wIDwgY2hpbGRyZW5IZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgd3JhcF9sYXlvdXRfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZChfdGhpcywgY2hpbGQsIGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkTGVmdCArIGNoaWxkV2lkdGgsIGNoaWxkVG9wICsgY2hpbGRIZWlnaHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjaGlsZExlZnQgKz0gY2hpbGRXaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gV3JhcExheW91dDtcbn0od3JhcF9sYXlvdXRfY29tbW9uXzEuV3JhcExheW91dEJhc2UpKTtcbmV4cG9ydHMuV3JhcExheW91dCA9IFdyYXBMYXlvdXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13cmFwLWxheW91dC5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgTGlzdFBpY2tlckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMaXN0UGlja2VyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0UGlja2VyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUuX2dldEl0ZW1Bc1N0cmluZyA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gXCIgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLmlzSXRlbXNTb3VyY2UgPyB0aGlzLml0ZW1zLmdldEl0ZW0oaW5kZXgpIDogdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgIHJldHVybiAoaXRlbSA9PT0gdW5kZWZpbmVkIHx8IGl0ZW0gPT09IG51bGwpID8gaW5kZXggKyBcIlwiIDogdGhpcy5wYXJzZUl0ZW0oaXRlbSk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUucGFyc2VJdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZpZWxkID8gaXRlbVt0aGlzLnRleHRGaWVsZF0gKyBcIlwiIDogaXRlbSArIFwiXCI7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyQmFzZS5wcm90b3R5cGUudXBkYXRlU2VsZWN0ZWRWYWx1ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbmV3VmFsID0gbnVsbDtcbiAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgICAgICBuZXdWYWwgPSB0aGlzLnZhbHVlRmllbGQgPyBpdGVtW3RoaXMudmFsdWVGaWVsZF0gOiBpdGVtO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVmFsdWUgIT09IG5ld1ZhbCkge1xuICAgICAgICAgICAgdGhpcy5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIG5ld1ZhbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RQaWNrZXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiTGlzdFBpY2tlclwiKVxuICAgIF0sIExpc3RQaWNrZXJCYXNlKTtcbiAgICByZXR1cm4gTGlzdFBpY2tlckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLkxpc3RQaWNrZXJCYXNlID0gTGlzdFBpY2tlckJhc2U7XG5MaXN0UGlja2VyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfSxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGFyZ2V0Lml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSBpdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQudXBkYXRlU2VsZWN0ZWRWYWx1ZSh2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnJlZ2lzdGVyKExpc3RQaWNrZXJCYXNlKTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGdldEl0ZW0gPSBuZXdWYWx1ZSAmJiBuZXdWYWx1ZS5nZXRJdGVtO1xuICAgICAgICB0YXJnZXQuaXNJdGVtc1NvdXJjZSA9IHR5cGVvZiBnZXRJdGVtID09PSBcImZ1bmN0aW9uXCI7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidGV4dEZpZWxkXCIsXG4gICAgZGVmYXVsdFZhbHVlOiBcIlwiXG59KTtcbmV4cG9ydHMudGV4dEZpZWxkUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy52YWx1ZUZpZWxkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInZhbHVlRmllbGRcIixcbiAgICBkZWZhdWx0VmFsdWU6IFwiXCJcbn0pO1xuZXhwb3J0cy52YWx1ZUZpZWxkUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuZXhwb3J0cy5zZWxlY3RlZFZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNlbGVjdGVkVmFsdWVcIixcbiAgICBkZWZhdWx0VmFsdWU6IG51bGxcbn0pO1xuZXhwb3J0cy5zZWxlY3RlZFZhbHVlUHJvcGVydHkucmVnaXN0ZXIoTGlzdFBpY2tlckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGlzdC1waWNrZXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGlzdF9waWNrZXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9saXN0LXBpY2tlci1jb21tb25cIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbGlzdC1waWNrZXItY29tbW9uXCIpKTtcbnZhciBMaXN0UGlja2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFBpY2tlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0UGlja2VyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSVBpY2tlclZpZXcubmV3KCk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5kYXRhU291cmNlID0gdGhpcy5fZGF0YVNvdXJjZSA9IExpc3RQaWNrZXJEYXRhU291cmNlLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IExpc3RQaWNrZXJEZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RQaWNrZXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5pb3MuZGVsZWdhdGUgPSB0aGlzLl9kZWxlZ2F0ZTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW9zLmRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmlvcy5zZWxlY3RSb3dJbkNvbXBvbmVudEFuaW1hdGVkKHZhbHVlLCAwLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuaXRlbXNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW9zLnJlbG9hZEFsbENvbXBvbmVudHMoKTtcbiAgICAgICAgbGlzdF9waWNrZXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXIucHJvdG90eXBlW2xpc3RfcGlja2VyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MuYmFja2dyb3VuZENvbG9yO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmlvcy5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGxpc3RfcGlja2VyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyLnByb3RvdHlwZVtsaXN0X3BpY2tlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MudGludENvbG9yO1xuICAgIH07XG4gICAgTGlzdFBpY2tlci5wcm90b3R5cGVbbGlzdF9waWNrZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW9zLnRpbnRDb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgbGlzdF9waWNrZXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgTGlzdFBpY2tlci5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIExpc3RQaWNrZXI7XG59KGxpc3RfcGlja2VyX2NvbW1vbl8xLkxpc3RQaWNrZXJCYXNlKSk7XG5leHBvcnRzLkxpc3RQaWNrZXIgPSBMaXN0UGlja2VyO1xudmFyIExpc3RQaWNrZXJEYXRhU291cmNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFBpY2tlckRhdGFTb3VyY2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdFBpY2tlckRhdGFTb3VyY2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTGlzdFBpY2tlckRhdGFTb3VyY2UuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IExpc3RQaWNrZXJEYXRhU291cmNlLm5ldygpO1xuICAgICAgICBkYXRhU291cmNlLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gZGF0YVNvdXJjZTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXJEYXRhU291cmNlLnByb3RvdHlwZS5udW1iZXJPZkNvbXBvbmVudHNJblBpY2tlclZpZXcgPSBmdW5jdGlvbiAocGlja2VyVmlldykge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9O1xuICAgIExpc3RQaWNrZXJEYXRhU291cmNlLnByb3RvdHlwZS5waWNrZXJWaWV3TnVtYmVyT2ZSb3dzSW5Db21wb25lbnQgPSBmdW5jdGlvbiAocGlja2VyVmlldywgY29tcG9uZW50KSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICByZXR1cm4gKG93bmVyICYmIG93bmVyLml0ZW1zKSA/IG93bmVyLml0ZW1zLmxlbmd0aCA6IDA7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyRGF0YVNvdXJjZS5PYmpDUHJvdG9jb2xzID0gW1VJUGlja2VyVmlld0RhdGFTb3VyY2VdO1xuICAgIHJldHVybiBMaXN0UGlja2VyRGF0YVNvdXJjZTtcbn0oTlNPYmplY3QpKTtcbnZhciBMaXN0UGlja2VyRGVsZWdhdGVJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTGlzdFBpY2tlckRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0UGlja2VyRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExpc3RQaWNrZXJEZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBMaXN0UGlja2VyRGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBkZWxlZ2F0ZS5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlO1xuICAgIH07XG4gICAgTGlzdFBpY2tlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUucGlja2VyVmlld0F0dHJpYnV0ZWRUaXRsZUZvclJvd0ZvckNvbXBvbmVudCA9IGZ1bmN0aW9uIChwaWNrZXJWaWV3LCByb3csIGNvbXBvbmVudCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgdGl0bGUgPSBOU0F0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aFN0cmluZ0F0dHJpYnV0ZXMob3duZXIuX2dldEl0ZW1Bc1N0cmluZyhyb3cpLCAoX2EgPSB7fSwgX2FbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IHBpY2tlclZpZXcudGludENvbG9yLCBfYSkpO1xuICAgICAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOU0F0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aFN0cmluZ0F0dHJpYnV0ZXMocm93LnRvU3RyaW5nKCksIChfYiA9IHt9LCBfYltOU0ZvcmVncm91bmRDb2xvckF0dHJpYnV0ZU5hbWVdID0gcGlja2VyVmlldy50aW50Q29sb3IsIF9iKSk7XG4gICAgfTtcbiAgICBMaXN0UGlja2VyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5waWNrZXJWaWV3RGlkU2VsZWN0Um93SW5Db21wb25lbnQgPSBmdW5jdGlvbiAocGlja2VyVmlldywgcm93LCBjb21wb25lbnQpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgbGlzdF9waWNrZXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCByb3cpO1xuICAgICAgICAgICAgb3duZXIudXBkYXRlU2VsZWN0ZWRWYWx1ZShyb3cpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0UGlja2VyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlQaWNrZXJWaWV3RGVsZWdhdGVdO1xuICAgIHJldHVybiBMaXN0UGlja2VyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGlzdC1waWNrZXIuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlclwiKTtcbnZhciBsYWJlbF8xID0gcmVxdWlyZShcIi4uL2xhYmVsXCIpO1xudmFyIG9ic2VydmFibGVfYXJyYXlfMSA9IHJlcXVpcmUoXCIuLi8uLi9kYXRhL29ic2VydmFibGUtYXJyYXlcIik7XG52YXIgd2Vha19ldmVudF9saXN0ZW5lcl8xID0gcmVxdWlyZShcIi4uL2NvcmUvd2Vhay1ldmVudC1saXN0ZW5lclwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIGtub3duVGVtcGxhdGVzO1xuKGZ1bmN0aW9uIChrbm93blRlbXBsYXRlcykge1xuICAgIGtub3duVGVtcGxhdGVzLml0ZW1UZW1wbGF0ZSA9IFwiaXRlbVRlbXBsYXRlXCI7XG59KShrbm93blRlbXBsYXRlcyA9IGV4cG9ydHMua25vd25UZW1wbGF0ZXMgfHwgKGV4cG9ydHMua25vd25UZW1wbGF0ZXMgPSB7fSkpO1xudmFyIGtub3duTXVsdGlUZW1wbGF0ZXM7XG4oZnVuY3Rpb24gKGtub3duTXVsdGlUZW1wbGF0ZXMpIHtcbiAgICBrbm93bk11bHRpVGVtcGxhdGVzLml0ZW1UZW1wbGF0ZXMgPSBcIml0ZW1UZW1wbGF0ZXNcIjtcbn0pKGtub3duTXVsdGlUZW1wbGF0ZXMgPSBleHBvcnRzLmtub3duTXVsdGlUZW1wbGF0ZXMgfHwgKGV4cG9ydHMua25vd25NdWx0aVRlbXBsYXRlcyA9IHt9KSk7XG52YXIgYXV0b0VmZmVjdGl2ZVJvd0hlaWdodCA9IC0xO1xudmFyIExpc3RWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpc3RWaWV3QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0Vmlld0Jhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5faXRlbUlkR2VuZXJhdG9yID0gZnVuY3Rpb24gKF9pdGVtLCBpbmRleCkgeyByZXR1cm4gaW5kZXg7IH07XG4gICAgICAgIF90aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlID0gbmV3IGxhYmVsXzEuTGFiZWwoKTtcbiAgICAgICAgX3RoaXMuX2RlZmF1bHRUZW1wbGF0ZSA9IHtcbiAgICAgICAgICAgIGtleTogXCJkZWZhdWx0XCIsXG4gICAgICAgICAgICBjcmVhdGVWaWV3OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLml0ZW1UZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRlcl8xLnBhcnNlKF90aGlzLml0ZW1UZW1wbGF0ZSwgX3RoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsID0gbmV3IEFycmF5KF90aGlzLl9kZWZhdWx0VGVtcGxhdGUpO1xuICAgICAgICBfdGhpcy5fZWZmZWN0aXZlUm93SGVpZ2h0ID0gYXV0b0VmZmVjdGl2ZVJvd0hlaWdodDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdFZpZXdCYXNlLnByb3RvdHlwZSwgXCJzZXBhcmF0b3JDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc2VwYXJhdG9yQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnNlcGFyYXRvckNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0Vmlld0Jhc2UucHJvdG90eXBlLCBcIml0ZW1UZW1wbGF0ZVNlbGVjdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUuYmluZCh7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVByb3BlcnR5OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRQcm9wZXJ0eTogXCJ0ZW1wbGF0ZUtleVwiLFxuICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiB2YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4LCBpdGVtcykge1xuICAgICAgICAgICAgICAgICAgICBpdGVtW1wiJGluZGV4XCJdID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5faXRlbVRlbXBsYXRlU2VsZWN0b3JCaW5kYWJsZS5iaW5kaW5nQ29udGV4dCA9PT0gaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yQmluZGFibGUuYmluZGluZ0NvbnRleHQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlLmJpbmRpbmdDb250ZXh0ID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9pdGVtVGVtcGxhdGVTZWxlY3RvckJpbmRhYmxlLmdldChcInRlbXBsYXRlS2V5XCIpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0Vmlld0Jhc2UucHJvdG90eXBlLCBcIml0ZW1JZEdlbmVyYXRvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1JZEdlbmVyYXRvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoZ2VuZXJhdG9yRm4pIHtcbiAgICAgICAgICAgIHRoaXMuX2l0ZW1JZEdlbmVyYXRvciA9IGdlbmVyYXRvckZuO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLnNjcm9sbFRvSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuc2Nyb2xsVG9JbmRleEFuaW1hdGVkID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9nZXRJdGVtVGVtcGxhdGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdmFyIHRlbXBsYXRlS2V5ID0gXCJkZWZhdWx0XCI7XG4gICAgICAgIGlmICh0aGlzLml0ZW1UZW1wbGF0ZVNlbGVjdG9yKSB7XG4gICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSB0aGlzLl9nZXREYXRhSXRlbShpbmRleCk7XG4gICAgICAgICAgICB0ZW1wbGF0ZUtleSA9IHRoaXMuX2l0ZW1UZW1wbGF0ZVNlbGVjdG9yKGRhdGFJdGVtLCBpbmRleCwgdGhpcy5pdGVtcyk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdGhpcy5faXRlbVRlbXBsYXRlc0ludGVybmFsLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWxbaV0ua2V5ID09PSB0ZW1wbGF0ZUtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWxbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1UZW1wbGF0ZXNJbnRlcm5hbFswXTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX3ByZXBhcmVJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGlmIChpdGVtKSB7XG4gICAgICAgICAgICBpdGVtLmJpbmRpbmdDb250ZXh0ID0gdGhpcy5fZ2V0RGF0YUl0ZW0oaW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9nZXREYXRhSXRlbSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgdGhpc0l0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgcmV0dXJuIHRoaXNJdGVtcy5nZXRJdGVtID8gdGhpc0l0ZW1zLmdldEl0ZW0oaW5kZXgpIDogdGhpc0l0ZW1zW2luZGV4XTtcbiAgICB9O1xuICAgIExpc3RWaWV3QmFzZS5wcm90b3R5cGUuX2dldERlZmF1bHRJdGVtQ29udGVudCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbGJsID0gbmV3IGxhYmVsXzEuTGFiZWwoKTtcbiAgICAgICAgbGJsLmJpbmQoe1xuICAgICAgICAgICAgdGFyZ2V0UHJvcGVydHk6IFwidGV4dFwiLFxuICAgICAgICAgICAgc291cmNlUHJvcGVydHk6IFwiJHZhbHVlXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsYmw7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLl9vbkl0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5fb25Sb3dIZWlnaHRQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAob2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH07XG4gICAgTGlzdFZpZXdCYXNlLnByb3RvdHlwZS5pc0l0ZW1BdEluZGV4VmlzaWJsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UucHJvdG90eXBlLnVwZGF0ZUVmZmVjdGl2ZVJvd0hlaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZXhwb3J0cy5yb3dIZWlnaHRQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgfTtcbiAgICBMaXN0Vmlld0Jhc2UuaXRlbUxvYWRpbmdFdmVudCA9IFwiaXRlbUxvYWRpbmdcIjtcbiAgICBMaXN0Vmlld0Jhc2UuaXRlbVRhcEV2ZW50ID0gXCJpdGVtVGFwXCI7XG4gICAgTGlzdFZpZXdCYXNlLmxvYWRNb3JlSXRlbXNFdmVudCA9IFwibG9hZE1vcmVJdGVtc1wiO1xuICAgIExpc3RWaWV3QmFzZS5rbm93bkZ1bmN0aW9ucyA9IFtcIml0ZW1UZW1wbGF0ZVNlbGVjdG9yXCIsIFwiaXRlbUlkR2VuZXJhdG9yXCJdO1xuICAgIExpc3RWaWV3QmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkxpc3RWaWV3XCIpXG4gICAgXSwgTGlzdFZpZXdCYXNlKTtcbiAgICByZXR1cm4gTGlzdFZpZXdCYXNlO1xufSh2aWV3XzEuQ29udGFpbmVyVmlldykpO1xuZXhwb3J0cy5MaXN0Vmlld0Jhc2UgPSBMaXN0Vmlld0Jhc2U7XG5MaXN0Vmlld0Jhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChvbGRWYWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIob2xkVmFsdWUsIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIHRhcmdldC5fb25JdGVtc0NoYW5nZWQsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1ZhbHVlIGluc3RhbmNlb2Ygdmlld18xLk9ic2VydmFibGUpIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihuZXdWYWx1ZSwgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgdGFyZ2V0Ll9vbkl0ZW1zQ2hhbmdlZCwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICB0YXJnZXQucmVmcmVzaCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKExpc3RWaWV3QmFzZSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtVGVtcGxhdGVcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHRhcmdldC5yZWZyZXNoKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5LnJlZ2lzdGVyKExpc3RWaWV3QmFzZSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbVRlbXBsYXRlc1wiLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBidWlsZGVyXzEucGFyc2VNdWx0aXBsZVRlbXBsYXRlcyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtVGVtcGxhdGVzUHJvcGVydHkucmVnaXN0ZXIoTGlzdFZpZXdCYXNlKTtcbnZhciBkZWZhdWx0Um93SGVpZ2h0ID0gXCJhdXRvXCI7XG5leHBvcnRzLnJvd0hlaWdodFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJyb3dIZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBkZWZhdWx0Um93SGVpZ2h0LCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuTGVuZ3RoLmVxdWFscyxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkID8gdmFsdWUgOiBkZWZhdWx0Um93SGVpZ2h0O1xuICAgIH0sXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Ll9lZmZlY3RpdmVSb3dIZWlnaHQgPSB2aWV3XzEuTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCBhdXRvRWZmZWN0aXZlUm93SGVpZ2h0KTtcbiAgICAgICAgdGFyZ2V0Ll9vblJvd0hlaWdodFByb3BlcnR5Q2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMucm93SGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIoTGlzdFZpZXdCYXNlKTtcbmV4cG9ydHMuaW9zRXN0aW1hdGVkUm93SGVpZ2h0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImlvc0VzdGltYXRlZFJvd0hlaWdodFwiLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHZpZXdfMS5MZW5ndGgucGFyc2Uodik7IH1cbn0pO1xuZXhwb3J0cy5pb3NFc3RpbWF0ZWRSb3dIZWlnaHRQcm9wZXJ0eS5yZWdpc3RlcihMaXN0Vmlld0Jhc2UpO1xuZXhwb3J0cy5zZXBhcmF0b3JDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwic2VwYXJhdG9yQ29sb3JcIiwgY3NzTmFtZTogXCJzZXBhcmF0b3ItY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5zZXBhcmF0b3JDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1saXN0LXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGlzdF92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vbGlzdC12aWV3LWNvbW1vblwiKTtcbnZhciBzdGFja19sYXlvdXRfMSA9IHJlcXVpcmUoXCIuLi9sYXlvdXRzL3N0YWNrLWxheW91dFwiKTtcbnZhciBwcm94eV92aWV3X2NvbnRhaW5lcl8xID0gcmVxdWlyZShcIi4uL3Byb3h5LXZpZXctY29udGFpbmVyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciB0cmFjZSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2xpc3Qtdmlldy1jb21tb25cIikpO1xudmFyIElURU1MT0FESU5HID0gbGlzdF92aWV3X2NvbW1vbl8xLkxpc3RWaWV3QmFzZS5pdGVtTG9hZGluZ0V2ZW50O1xudmFyIExPQURNT1JFSVRFTVMgPSBsaXN0X3ZpZXdfY29tbW9uXzEuTGlzdFZpZXdCYXNlLmxvYWRNb3JlSXRlbXNFdmVudDtcbnZhciBJVEVNVEFQID0gbGlzdF92aWV3X2NvbW1vbl8xLkxpc3RWaWV3QmFzZS5pdGVtVGFwRXZlbnQ7XG52YXIgREVGQVVMVF9IRUlHSFQgPSA0NDtcbnZhciBpbmZpbml0eSA9IGxpc3Rfdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKDAsIGxpc3Rfdmlld19jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQpO1xudmFyIExpc3RWaWV3Q2VsbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExpc3RWaWV3Q2VsbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0Vmlld0NlbGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTGlzdFZpZXdDZWxsLmluaXRXaXRoRW1wdHlCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2VsbCA9IExpc3RWaWV3Q2VsbC5uZXcoKTtcbiAgICAgICAgY2VsbC5iYWNrZ3JvdW5kQ29sb3IgPSBudWxsO1xuICAgICAgICByZXR1cm4gY2VsbDtcbiAgICB9O1xuICAgIExpc3RWaWV3Q2VsbC5wcm90b3R5cGUuaW5pdFdpdGhTdHlsZVJldXNlSWRlbnRpZmllciA9IGZ1bmN0aW9uIChzdHlsZSwgcmV1c2VJZGVudGlmaWVyKSB7XG4gICAgICAgIHZhciBjZWxsID0gX3N1cGVyLnByb3RvdHlwZS5pbml0V2l0aFN0eWxlUmV1c2VJZGVudGlmaWVyLmNhbGwodGhpcywgc3R5bGUsIHJldXNlSWRlbnRpZmllcik7XG4gICAgICAgIGNlbGwuYmFja2dyb3VuZENvbG9yID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGNlbGw7XG4gICAgfTtcbiAgICBMaXN0Vmlld0NlbGwucHJvdG90eXBlLndpbGxNb3ZlVG9TdXBlcnZpZXcgPSBmdW5jdGlvbiAobmV3U3VwZXJ2aWV3KSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSAodGhpcy52aWV3ID8gdGhpcy52aWV3LnBhcmVudCA6IG51bGwpO1xuICAgICAgICBpZiAocGFyZW50ICYmICFuZXdTdXBlcnZpZXcpIHtcbiAgICAgICAgICAgIHBhcmVudC5fcmVtb3ZlQ29udGFpbmVyKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdFZpZXdDZWxsLnByb3RvdHlwZSwgXCJ2aWV3XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vd25lciA/IHRoaXMub3duZXIuZ2V0KCkgOiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gTGlzdFZpZXdDZWxsO1xufShVSVRhYmxlVmlld0NlbGwpKTtcbmZ1bmN0aW9uIG5vdGlmeUZvckl0ZW1BdEluZGV4KGxpc3RWaWV3LCBjZWxsLCB2aWV3LCBldmVudE5hbWUsIGluZGV4UGF0aCkge1xuICAgIHZhciBhcmdzID0geyBldmVudE5hbWU6IGV2ZW50TmFtZSwgb2JqZWN0OiBsaXN0VmlldywgaW5kZXg6IGluZGV4UGF0aC5yb3csIHZpZXc6IHZpZXcsIGlvczogY2VsbCwgYW5kcm9pZDogdW5kZWZpbmVkIH07XG4gICAgbGlzdFZpZXcubm90aWZ5KGFyZ3MpO1xuICAgIHJldHVybiBhcmdzO1xufVxudmFyIERhdGFTb3VyY2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhEYXRhU291cmNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIERhdGFTb3VyY2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgRGF0YVNvdXJjZS5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkYXRhU291cmNlID0gRGF0YVNvdXJjZS5uZXcoKTtcbiAgICAgICAgZGF0YVNvdXJjZS5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2U7XG4gICAgfTtcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS50YWJsZVZpZXdOdW1iZXJPZlJvd3NJblNlY3Rpb24gPSBmdW5jdGlvbiAodGFibGVWaWV3LCBzZWN0aW9uKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICByZXR1cm4gKG93bmVyICYmIG93bmVyLml0ZW1zKSA/IG93bmVyLml0ZW1zLmxlbmd0aCA6IDA7XG4gICAgfTtcbiAgICBEYXRhU291cmNlLnByb3RvdHlwZS50YWJsZVZpZXdDZWxsRm9yUm93QXRJbmRleFBhdGggPSBmdW5jdGlvbiAodGFibGVWaWV3LCBpbmRleFBhdGgpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIHZhciBjZWxsO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IG93bmVyLl9nZXRJdGVtVGVtcGxhdGUoaW5kZXhQYXRoLnJvdyk7XG4gICAgICAgICAgICBjZWxsID0gKHRhYmxlVmlldy5kZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXIodGVtcGxhdGUua2V5KSB8fCBMaXN0Vmlld0NlbGwuaW5pdFdpdGhFbXB0eUJhY2tncm91bmQoKSk7XG4gICAgICAgICAgICBvd25lci5fcHJlcGFyZUNlbGwoY2VsbCwgaW5kZXhQYXRoKTtcbiAgICAgICAgICAgIHZhciBjZWxsVmlldyA9IGNlbGwudmlldztcbiAgICAgICAgICAgIGlmIChjZWxsVmlldyAmJiBjZWxsVmlldy5pc0xheW91dFJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gbGlzdF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUob3duZXIud2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICAgICAgdmFyIHJvd0hlaWdodCA9IG93bmVyLl9lZmZlY3RpdmVSb3dIZWlnaHQ7XG4gICAgICAgICAgICAgICAgdmFyIGNlbGxIZWlnaHQgPSByb3dIZWlnaHQgPiAwID8gcm93SGVpZ2h0IDogb3duZXIuZ2V0SGVpZ2h0KGluZGV4UGF0aC5yb3cpO1xuICAgICAgICAgICAgICAgIGNlbGxWaWV3Lmlvc092ZXJmbG93U2FmZUFyZWFFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbGlzdF92aWV3X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQob3duZXIsIGNlbGxWaWV3LCAwLCAwLCB3aWR0aCwgY2VsbEhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjZWxsID0gTGlzdFZpZXdDZWxsLmluaXRXaXRoRW1wdHlCYWNrZ3JvdW5kKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNlbGw7XG4gICAgfTtcbiAgICBEYXRhU291cmNlLk9iakNQcm90b2NvbHMgPSBbVUlUYWJsZVZpZXdEYXRhU291cmNlXTtcbiAgICByZXR1cm4gRGF0YVNvdXJjZTtcbn0oTlNPYmplY3QpKTtcbnZhciBVSVRhYmxlVmlld0RlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gVUlUYWJsZVZpZXdEZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9vd25lciA9IG93bmVyO1xuICAgICAgICBkZWxlZ2F0ZS5fbWVhc3VyZUNlbGxNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLnByb3RvdHlwZS50YWJsZVZpZXdXaWxsRGlzcGxheUNlbGxGb3JSb3dBdEluZGV4UGF0aCA9IGZ1bmN0aW9uICh0YWJsZVZpZXcsIGNlbGwsIGluZGV4UGF0aCkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyICYmIChpbmRleFBhdGgucm93ID09PSBvd25lci5pdGVtcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgb3duZXIubm90aWZ5KHsgZXZlbnROYW1lOiBMT0FETU9SRUlURU1TLCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRhYmxlVmlld0RlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFibGVWaWV3V2lsbFNlbGVjdFJvd0F0SW5kZXhQYXRoID0gZnVuY3Rpb24gKHRhYmxlVmlldywgaW5kZXhQYXRoKSB7XG4gICAgICAgIHZhciBjZWxsID0gdGFibGVWaWV3LmNlbGxGb3JSb3dBdEluZGV4UGF0aChpbmRleFBhdGgpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBub3RpZnlGb3JJdGVtQXRJbmRleChvd25lciwgY2VsbCwgY2VsbC52aWV3LCBJVEVNVEFQLCBpbmRleFBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleFBhdGg7XG4gICAgfTtcbiAgICBVSVRhYmxlVmlld0RlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFibGVWaWV3RGlkU2VsZWN0Um93QXRJbmRleFBhdGggPSBmdW5jdGlvbiAodGFibGVWaWV3LCBpbmRleFBhdGgpIHtcbiAgICAgICAgdGFibGVWaWV3LmRlc2VsZWN0Um93QXRJbmRleFBhdGhBbmltYXRlZChpbmRleFBhdGgsIHRydWUpO1xuICAgICAgICByZXR1cm4gaW5kZXhQYXRoO1xuICAgIH07XG4gICAgVUlUYWJsZVZpZXdEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRhYmxlVmlld0hlaWdodEZvclJvd0F0SW5kZXhQYXRoID0gZnVuY3Rpb24gKHRhYmxlVmlldywgaW5kZXhQYXRoKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFibGVWaWV3LmVzdGltYXRlZFJvd0hlaWdodDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGVpZ2h0ID0gb3duZXIuZ2V0SGVpZ2h0KGluZGV4UGF0aC5yb3cpO1xuICAgICAgICBpZiAoaGVpZ2h0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IG93bmVyLl9nZXRJdGVtVGVtcGxhdGUoaW5kZXhQYXRoLnJvdyk7XG4gICAgICAgICAgICB2YXIgY2VsbCA9IHRoaXMuX21lYXN1cmVDZWxsTWFwLmdldCh0ZW1wbGF0ZS5rZXkpO1xuICAgICAgICAgICAgaWYgKCFjZWxsKSB7XG4gICAgICAgICAgICAgICAgY2VsbCA9IHRhYmxlVmlldy5kZXF1ZXVlUmV1c2FibGVDZWxsV2l0aElkZW50aWZpZXIodGVtcGxhdGUua2V5KSB8fCBMaXN0Vmlld0NlbGwuaW5pdFdpdGhFbXB0eUJhY2tncm91bmQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWFzdXJlQ2VsbE1hcC5zZXQodGVtcGxhdGUua2V5LCBjZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlaWdodCA9IG93bmVyLl9wcmVwYXJlQ2VsbChjZWxsLCBpbmRleFBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0X3ZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoaGVpZ2h0KTtcbiAgICB9O1xuICAgIFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlUYWJsZVZpZXdEZWxlZ2F0ZV07XG4gICAgcmV0dXJuIFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFVJVGFibGVWaWV3Um93SGVpZ2h0RGVsZWdhdGVJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBVSVRhYmxlVmlld1Jvd0hlaWdodERlbGVnYXRlSW1wbC5uZXcoKTtcbiAgICAgICAgZGVsZWdhdGUuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFVJVGFibGVWaWV3Um93SGVpZ2h0RGVsZWdhdGVJbXBsLnByb3RvdHlwZS50YWJsZVZpZXdXaWxsRGlzcGxheUNlbGxGb3JSb3dBdEluZGV4UGF0aCA9IGZ1bmN0aW9uICh0YWJsZVZpZXcsIGNlbGwsIGluZGV4UGF0aCkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyICYmIChpbmRleFBhdGgucm93ID09PSBvd25lci5pdGVtcy5sZW5ndGggLSAxKSkge1xuICAgICAgICAgICAgb3duZXIubm90aWZ5KHsgZXZlbnROYW1lOiBMT0FETU9SRUlURU1TLCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRhYmxlVmlld1Jvd0hlaWdodERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFibGVWaWV3V2lsbFNlbGVjdFJvd0F0SW5kZXhQYXRoID0gZnVuY3Rpb24gKHRhYmxlVmlldywgaW5kZXhQYXRoKSB7XG4gICAgICAgIHZhciBjZWxsID0gdGFibGVWaWV3LmNlbGxGb3JSb3dBdEluZGV4UGF0aChpbmRleFBhdGgpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBub3RpZnlGb3JJdGVtQXRJbmRleChvd25lciwgY2VsbCwgY2VsbC52aWV3LCBJVEVNVEFQLCBpbmRleFBhdGgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleFBhdGg7XG4gICAgfTtcbiAgICBVSVRhYmxlVmlld1Jvd0hlaWdodERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFibGVWaWV3RGlkU2VsZWN0Um93QXRJbmRleFBhdGggPSBmdW5jdGlvbiAodGFibGVWaWV3LCBpbmRleFBhdGgpIHtcbiAgICAgICAgdGFibGVWaWV3LmRlc2VsZWN0Um93QXRJbmRleFBhdGhBbmltYXRlZChpbmRleFBhdGgsIHRydWUpO1xuICAgICAgICByZXR1cm4gaW5kZXhQYXRoO1xuICAgIH07XG4gICAgVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRhYmxlVmlld0hlaWdodEZvclJvd0F0SW5kZXhQYXRoID0gZnVuY3Rpb24gKHRhYmxlVmlldywgaW5kZXhQYXRoKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFibGVWaWV3LmVzdGltYXRlZFJvd0hlaWdodDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdF92aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG93bmVyLl9lZmZlY3RpdmVSb3dIZWlnaHQpO1xuICAgIH07XG4gICAgVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSVRhYmxlVmlld0RlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlUYWJsZVZpZXdSb3dIZWlnaHREZWxlZ2F0ZUltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgTGlzdFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMaXN0VmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0VmlldygpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMud2lkdGhNZWFzdXJlU3BlYyA9IDA7XG4gICAgICAgIF90aGlzLl9tYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIF90aGlzLl9oZWlnaHRzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSVRhYmxlVmlldy5uZXcoKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldy5yZWdpc3RlckNsYXNzRm9yQ2VsbFJldXNlSWRlbnRpZmllcihMaXN0Vmlld0NlbGwuY2xhc3MoKSwgdGhpcy5fZGVmYXVsdFRlbXBsYXRlLmtleSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuZXN0aW1hdGVkUm93SGVpZ2h0ID0gREVGQVVMVF9IRUlHSFQ7XG4gICAgICAgIG5hdGl2ZVZpZXcucm93SGVpZ2h0ID0gVUlUYWJsZVZpZXdBdXRvbWF0aWNEaW1lbnNpb247XG4gICAgICAgIG5hdGl2ZVZpZXcuZGF0YVNvdXJjZSA9IHRoaXMuX2RhdGFTb3VyY2UgPSBEYXRhU291cmNlLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB0aGlzLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMoKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW9zLmNsaXBzVG9Cb3VuZHMgPSB0cnVlO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLl9pc0RhdGFEaXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pb3MuZGVsZWdhdGUgPSB0aGlzLl9kZWxlZ2F0ZTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlvcy5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25VbmxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RWaWV3LnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0Vmlldy5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXAuc2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5fbWFwLmZvckVhY2goZnVuY3Rpb24gKHZpZXcsIGtleSkge1xuICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnNjcm9sbFRvSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgdGhpcy5fc2Nyb2xsVG9JbmRleChpbmRleCwgZmFsc2UpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnNjcm9sbFRvSW5kZXhBbmltYXRlZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB0aGlzLl9zY3JvbGxUb0luZGV4KGluZGV4KTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5fc2Nyb2xsVG9JbmRleCA9IGZ1bmN0aW9uIChpbmRleCwgYW5pbWF0ZWQpIHtcbiAgICAgICAgaWYgKGFuaW1hdGVkID09PSB2b2lkIDApIHsgYW5pbWF0ZWQgPSB0cnVlOyB9XG4gICAgICAgIGlmICghdGhpcy5pb3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXRlbXNMZW5ndGggPSB0aGlzLml0ZW1zID8gdGhpcy5pdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICBpZiAoaXRlbXNMZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5kZXggPj0gaXRlbXNMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGl0ZW1zTGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW9zLnNjcm9sbFRvUm93QXRJbmRleFBhdGhBdFNjcm9sbFBvc2l0aW9uQW5pbWF0ZWQoTlNJbmRleFBhdGguaW5kZXhQYXRoRm9ySXRlbUluU2VjdGlvbihpbmRleCwgMCksIDEsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0cmFjZS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgdHJhY2Uud3JpdGUoXCJDYW5ub3Qgc2Nyb2xsIGxpc3R2aWV3IHRvIGluZGV4IFwiICsgaW5kZXggKyBcIiB3aGVuIGxpc3R2aWV3IGl0ZW1zIG5vdCBzZXRcIiwgdHJhY2UuY2F0ZWdvcmllcy5CaW5kaW5nKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX21hcC5mb3JFYWNoKGZ1bmN0aW9uICh2aWV3LCBuYXRpdmVWaWV3LCBtYXApIHtcbiAgICAgICAgICAgIGlmICghKHZpZXcuYmluZGluZ0NvbnRleHQgaW5zdGFuY2VvZiBsaXN0X3ZpZXdfY29tbW9uXzEuT2JzZXJ2YWJsZSkpIHtcbiAgICAgICAgICAgICAgICB2aWV3LmJpbmRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLmlvcy5yZWxvYWREYXRhKCk7XG4gICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgIHRoaXMuX2lzRGF0YURpcnR5ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9pc0RhdGFEaXJ0eSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5pc0l0ZW1BdEluZGV4VmlzaWJsZSA9IGZ1bmN0aW9uIChpdGVtSW5kZXgpIHtcbiAgICAgICAgdmFyIGluZGV4ZXMgPSBBcnJheS5mcm9tKHRoaXMuaW9zLmluZGV4UGF0aHNGb3JWaXNpYmxlUm93cyk7XG4gICAgICAgIHJldHVybiBpbmRleGVzLnNvbWUoZnVuY3Rpb24gKHZpc0luZGV4KSB7IHJldHVybiB2aXNJbmRleC5yb3cgPT09IGl0ZW1JbmRleDsgfSk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHRzW2luZGV4XTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5zZXRIZWlnaHQgPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2hlaWdodHNbaW5kZXhdID0gdmFsdWU7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuX29uUm93SGVpZ2h0UHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBsaXN0X3ZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5fZWZmZWN0aXZlUm93SGVpZ2h0KTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLmlvcztcbiAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5yb3dIZWlnaHQgPSBVSVRhYmxlVmlld0F1dG9tYXRpY0RpbWVuc2lvbjtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuZXN0aW1hdGVkUm93SGVpZ2h0ID0gREVGQVVMVF9IRUlHSFQ7XG4gICAgICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGFibGVWaWV3RGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5yb3dIZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuZXN0aW1hdGVkUm93SGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGFibGVWaWV3Um93SGVpZ2h0RGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmRlbGVnYXRlID0gdGhpcy5fZGVsZWdhdGU7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb3dIZWlnaHRQcm9wZXJ0eUNoYW5nZWQuY2FsbCh0aGlzLCBvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLnJlcXVlc3RMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fcHJlcGFyaW5nQ2VsbCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0LmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHRoaXMud2lkdGhNZWFzdXJlU3BlYyA9IHdpZHRoTWVhc3VyZVNwZWM7XG4gICAgICAgIHZhciBjaGFuZ2VkID0gdGhpcy5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUubWVhc3VyZS5jYWxsKHRoaXMsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuaW9zLnJlbG9hZERhdGEoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTWVhc3VyZS5jYWxsKHRoaXMsIHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdGhpcy5fbWFwLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkVmlldywgbGlzdFZpZXdDZWxsKSB7XG4gICAgICAgICAgICBsaXN0X3ZpZXdfY29tbW9uXzEuVmlldy5tZWFzdXJlQ2hpbGQoX3RoaXMsIGNoaWxkVmlldywgY2hpbGRWaWV3Ll9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYywgY2hpbGRWaWV3Ll9jdXJyZW50SGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxheW91dC5jYWxsKHRoaXMsIGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHRoaXMuX21hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZFZpZXcsIGxpc3RWaWV3Q2VsbCkge1xuICAgICAgICAgICAgdmFyIHJvd0hlaWdodCA9IF90aGlzLl9lZmZlY3RpdmVSb3dIZWlnaHQ7XG4gICAgICAgICAgICB2YXIgY2VsbEhlaWdodCA9IHJvd0hlaWdodCA+IDAgPyByb3dIZWlnaHQgOiBfdGhpcy5nZXRIZWlnaHQoY2hpbGRWaWV3Ll9saXN0Vmlld0l0ZW1JbmRleCk7XG4gICAgICAgICAgICBpZiAoY2VsbEhlaWdodCkge1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGxpc3Rfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKF90aGlzLndpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICAgICAgICAgIGNoaWxkVmlldy5pb3NPdmVyZmxvd1NhZmVBcmVhRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxpc3Rfdmlld19jb21tb25fMS5WaWV3LmxheW91dENoaWxkKF90aGlzLCBjaGlsZFZpZXcsIDAsIDAsIHdpZHRoLCBjZWxsSGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBMaXN0Vmlldy5wcm90b3R5cGUuX2xheW91dENlbGwgPSBmdW5jdGlvbiAoY2VsbFZpZXcsIGluZGV4UGF0aCkge1xuICAgICAgICBpZiAoY2VsbFZpZXcpIHtcbiAgICAgICAgICAgIHZhciByb3dIZWlnaHQgPSB0aGlzLl9lZmZlY3RpdmVSb3dIZWlnaHQ7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0TWVhc3VyZVNwZWMgPSByb3dIZWlnaHQgPj0gMCA/IGxpc3Rfdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHJvd0hlaWdodCwgbGlzdF92aWV3X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKSA6IGluZmluaXR5O1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVkU2l6ZSA9IGxpc3Rfdmlld19jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCBjZWxsVmlldywgdGhpcy53aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gbWVhc3VyZWRTaXplLm1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5zZXRIZWlnaHQoaW5kZXhQYXRoLnJvdywgaGVpZ2h0KTtcbiAgICAgICAgICAgIHJldHVybiBoZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuaW9zLmVzdGltYXRlZFJvd0hlaWdodDtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5fcHJlcGFyZUNlbGwgPSBmdW5jdGlvbiAoY2VsbCwgaW5kZXhQYXRoKSB7XG4gICAgICAgIHZhciBjZWxsSGVpZ2h0O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fcHJlcGFyaW5nQ2VsbCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdmlldyA9IGNlbGwudmlldztcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcgPSB0aGlzLl9nZXRJdGVtVGVtcGxhdGUoaW5kZXhQYXRoLnJvdykuY3JlYXRlVmlldygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBub3RpZnlGb3JJdGVtQXRJbmRleCh0aGlzLCBjZWxsLCB2aWV3LCBJVEVNTE9BRElORywgaW5kZXhQYXRoKTtcbiAgICAgICAgICAgIHZpZXcgPSBhcmdzLnZpZXcgfHwgdGhpcy5fZ2V0RGVmYXVsdEl0ZW1Db250ZW50KGluZGV4UGF0aC5yb3cpO1xuICAgICAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBwcm94eV92aWV3X2NvbnRhaW5lcl8xLlByb3h5Vmlld0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHZhciBzcCA9IG5ldyBzdGFja19sYXlvdXRfMS5TdGFja0xheW91dCgpO1xuICAgICAgICAgICAgICAgIHNwLmFkZENoaWxkKHZpZXcpO1xuICAgICAgICAgICAgICAgIHZpZXcgPSBzcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY2VsbC52aWV3KSB7XG4gICAgICAgICAgICAgICAgY2VsbC5vd25lciA9IG5ldyBXZWFrUmVmKHZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY2VsbC52aWV3ICE9PSB2aWV3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlQ29udGFpbmVyKGNlbGwpO1xuICAgICAgICAgICAgICAgIGNlbGwudmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZUZyb21TdXBlcnZpZXcoKTtcbiAgICAgICAgICAgICAgICBjZWxsLm93bmVyID0gbmV3IFdlYWtSZWYodmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9wcmVwYXJlSXRlbSh2aWV3LCBpbmRleFBhdGgucm93KTtcbiAgICAgICAgICAgIHZpZXcuX2xpc3RWaWV3SXRlbUluZGV4ID0gaW5kZXhQYXRoLnJvdztcbiAgICAgICAgICAgIHRoaXMuX21hcC5zZXQoY2VsbCwgdmlldyk7XG4gICAgICAgICAgICBpZiAodmlldyAmJiAhdmlldy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZpZXcpO1xuICAgICAgICAgICAgICAgIGNlbGwuY29udGVudFZpZXcuYWRkU3Vidmlldyh2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2VsbEhlaWdodCA9IHRoaXMuX2xheW91dENlbGwodmlldywgaW5kZXhQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuX3ByZXBhcmluZ0NlbGwgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2VsbEhlaWdodDtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZS5fcmVtb3ZlQ29udGFpbmVyID0gZnVuY3Rpb24gKGNlbGwpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBjZWxsLnZpZXc7XG4gICAgICAgIGlmICghKHZpZXcucGFyZW50IGluc3RhbmNlb2YgTGlzdFZpZXcpKSB7XG4gICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KHZpZXcucGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlcGFyaW5nID0gdGhpcy5fcHJlcGFyaW5nQ2VsbDtcbiAgICAgICAgdGhpcy5fcHJlcGFyaW5nQ2VsbCA9IHRydWU7XG4gICAgICAgIHZpZXcucGFyZW50Ll9yZW1vdmVWaWV3KHZpZXcpO1xuICAgICAgICB2aWV3Ll9saXN0Vmlld0l0ZW1JbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fcHJlcGFyaW5nQ2VsbCA9IHByZXBhcmluZztcbiAgICAgICAgdGhpcy5fbWFwLmRlbGV0ZShjZWxsKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuc2VwYXJhdG9yQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW9zLnNlcGFyYXRvckNvbG9yO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlW2xpc3Rfdmlld19jb21tb25fMS5zZXBhcmF0b3JDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5pb3Muc2VwYXJhdG9yQ29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGxpc3Rfdmlld19jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlW2xpc3Rfdmlld19jb21tb25fMS5pdGVtVGVtcGxhdGVzUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgTGlzdFZpZXcucHJvdG90eXBlW2xpc3Rfdmlld19jb21tb25fMS5pdGVtVGVtcGxhdGVzUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwgPSBuZXcgQXJyYXkodGhpcy5fZGVmYXVsdFRlbXBsYXRlKTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB2YWx1ZS5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pb3MucmVnaXN0ZXJDbGFzc0ZvckNlbGxSZXVzZUlkZW50aWZpZXIoTGlzdFZpZXdDZWxsLmNsYXNzKCksIHZhbHVlW2ldLmtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwgPSB0aGlzLl9pdGVtVGVtcGxhdGVzSW50ZXJuYWwuY29uY2F0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuaW9zRXN0aW1hdGVkUm93SGVpZ2h0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBERUZBVUxUX0hFSUdIVDtcbiAgICB9O1xuICAgIExpc3RWaWV3LnByb3RvdHlwZVtsaXN0X3ZpZXdfY29tbW9uXzEuaW9zRXN0aW1hdGVkUm93SGVpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMuaW9zO1xuICAgICAgICB2YXIgZXN0aW1hdGVkSGVpZ2h0ID0gbGlzdF92aWV3X2NvbW1vbl8xLkxlbmd0aC50b0RldmljZVBpeGVscyh2YWx1ZSwgMCk7XG4gICAgICAgIG5hdGl2ZVZpZXcuZXN0aW1hdGVkUm93SGVpZ2h0ID0gZXN0aW1hdGVkSGVpZ2h0IDwgMCA/IERFRkFVTFRfSEVJR0hUIDogZXN0aW1hdGVkSGVpZ2h0O1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBMaXN0Vmlldy5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIExpc3RWaWV3O1xufShsaXN0X3ZpZXdfY29tbW9uXzEuTGlzdFZpZXdCYXNlKSk7XG5leHBvcnRzLkxpc3RWaWV3ID0gTGlzdFZpZXc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1saXN0LXZpZXcuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29udGVudF92aWV3XzEgPSByZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgYWN0aW9uX2Jhcl8xID0gcmVxdWlyZShcIi4uL2FjdGlvbi1iYXJcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvbnRlbnQtdmlld1wiKSk7XG52YXIgUGFnZUJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQYWdlQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQYWdlQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQYWdlQmFzZV8xID0gUGFnZUJhc2U7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJuYXZpZ2F0aW9uQ29udGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hdmlnYXRpb25Db250ZXh0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcImFjdGlvbkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0FjdGlvbkJhciA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9uQmFyID0gbmV3IGFjdGlvbl9iYXJfMS5BY3Rpb25CYXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHRoaXMuX2FjdGlvbkJhcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYWN0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFjdGlvbkJhciBjYW5ub3QgYmUgbnVsbCBvciB1bmRlZmluZWQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGlvbkJhciAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVZpZXcodGhpcy5fYWN0aW9uQmFyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNBY3Rpb25CYXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodGhpcy5fYWN0aW9uQmFyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJzdGF0dXNCYXJTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc3RhdHVzQmFyU3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnN0YXR1c0JhclN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFnZUJhc2UucHJvdG90eXBlLCBcInBhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgYWN0aW9uX2Jhcl8xLkFjdGlvbkJhcikge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIuY2FsbCh0aGlzLCBuYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5nZXRLZXlmcmFtZUFuaW1hdGlvbldpdGhOYW1lID0gZnVuY3Rpb24gKGFuaW1hdGlvbk5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlU2NvcGUuZ2V0S2V5ZnJhbWVBbmltYXRpb25XaXRoTmFtZShhbmltYXRpb25OYW1lKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiZnJhbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBmcmFtZSA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgcmV0dXJuIGZyYW1lIGluc3RhbmNlb2YgZnJhbWVfMS5GcmFtZSA/IGZyYW1lIDogdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUuY3JlYXRlTmF2aWdhdGVkRGF0YSA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogZXZlbnROYW1lLFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5uYXZpZ2F0aW9uQ29udGV4dCxcbiAgICAgICAgICAgIGlzQmFja05hdmlnYXRpb246IGlzQmFja05hdmlnYXRpb25cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5vbk5hdmlnYXRpbmdUbyA9IGZ1bmN0aW9uIChjb250ZXh0LCBpc0JhY2tOYXZpZ2F0aW9uLCBiaW5kaW5nQ29udGV4dCkge1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQ29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgIGlmIChpc0JhY2tOYXZpZ2F0aW9uICYmIHRoaXMuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlU2NvcGUuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2Nzc1N0YXRlLmlzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzQmFja05hdmlnYXRpb24gJiYgYmluZGluZ0NvbnRleHQgIT09IHVuZGVmaW5lZCAmJiBiaW5kaW5nQ29udGV4dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRpbmdUb0V2ZW50LCBpc0JhY2tOYXZpZ2F0aW9uKSk7XG4gICAgfTtcbiAgICBQYWdlQmFzZS5wcm90b3R5cGUub25OYXZpZ2F0ZWRUbyA9IGZ1bmN0aW9uIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRlZFRvRXZlbnQsIGlzQmFja05hdmlnYXRpb24pKTtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5vbk5hdmlnYXRpbmdGcm9tID0gZnVuY3Rpb24gKGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5jcmVhdGVOYXZpZ2F0ZWREYXRhKFBhZ2VCYXNlXzEubmF2aWdhdGluZ0Zyb21FdmVudCwgaXNCYWNrTmF2aWdhdGlvbikpO1xuICAgIH07XG4gICAgUGFnZUJhc2UucHJvdG90eXBlLm9uTmF2aWdhdGVkRnJvbSA9IGZ1bmN0aW9uIChpc0JhY2tOYXZpZ2F0aW9uKSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuY3JlYXRlTmF2aWdhdGVkRGF0YShQYWdlQmFzZV8xLm5hdmlnYXRlZEZyb21FdmVudCwgaXNCYWNrTmF2aWdhdGlvbikpO1xuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uQ29udGV4dCA9IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFBhZ2VCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZWFjaENoaWxkVmlldy5jYWxsKHRoaXMsIGNhbGxiYWNrKTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aW9uQmFyKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmFjdGlvbkJhcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYWdlQmFzZS5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5jb250ZW50ID8gMSA6IDApICsgKHRoaXMuX2FjdGlvbkJhciA/IDEgOiAwKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgdmFyIFBhZ2VCYXNlXzE7XG4gICAgUGFnZUJhc2UubmF2aWdhdGluZ1RvRXZlbnQgPSBcIm5hdmlnYXRpbmdUb1wiO1xuICAgIFBhZ2VCYXNlLm5hdmlnYXRlZFRvRXZlbnQgPSBcIm5hdmlnYXRlZFRvXCI7XG4gICAgUGFnZUJhc2UubmF2aWdhdGluZ0Zyb21FdmVudCA9IFwibmF2aWdhdGluZ0Zyb21cIjtcbiAgICBQYWdlQmFzZS5uYXZpZ2F0ZWRGcm9tRXZlbnQgPSBcIm5hdmlnYXRlZEZyb21cIjtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJvbk5hdmlnYXRpbmdUb1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFBhZ2VCYXNlLnByb3RvdHlwZSwgXCJvbk5hdmlnYXRlZFRvXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgUGFnZUJhc2UucHJvdG90eXBlLCBcIm9uTmF2aWdhdGluZ0Zyb21cIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBQYWdlQmFzZS5wcm90b3R5cGUsIFwib25OYXZpZ2F0ZWRGcm9tXCIsIG51bGwpO1xuICAgIFBhZ2VCYXNlID0gUGFnZUJhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb250ZW50X3ZpZXdfMS5DU1NUeXBlKFwiUGFnZVwiKVxuICAgIF0sIFBhZ2VCYXNlKTtcbiAgICByZXR1cm4gUGFnZUJhc2U7XG59KGNvbnRlbnRfdmlld18xLkNvbnRlbnRWaWV3KSk7XG5leHBvcnRzLlBhZ2VCYXNlID0gUGFnZUJhc2U7XG5QYWdlQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcIm5ldmVyXCI7XG5leHBvcnRzLmFjdGlvbkJhckhpZGRlblByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJhY3Rpb25CYXJIaWRkZW5cIiwgYWZmZWN0c0xheW91dDogY29udGVudF92aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5hY3Rpb25CYXJIaWRkZW5Qcm9wZXJ0eS5yZWdpc3RlcihQYWdlQmFzZSk7XG5leHBvcnRzLmJhY2tncm91bmRTcGFuVW5kZXJTdGF0dXNCYXJQcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYmFja2dyb3VuZFNwYW5VbmRlclN0YXR1c0JhclwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCBhZmZlY3RzTGF5b3V0OiBjb250ZW50X3ZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGNvbnRlbnRfdmlld18xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmJhY2tncm91bmRTcGFuVW5kZXJTdGF0dXNCYXJQcm9wZXJ0eS5yZWdpc3RlcihQYWdlQmFzZSk7XG5leHBvcnRzLmVuYWJsZVN3aXBlQmFja05hdmlnYXRpb25Qcm9wZXJ0eSA9IG5ldyBjb250ZW50X3ZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZW5hYmxlU3dpcGVCYWNrTmF2aWdhdGlvblwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5lbmFibGVTd2lwZUJhY2tOYXZpZ2F0aW9uUHJvcGVydHkucmVnaXN0ZXIoUGFnZUJhc2UpO1xuZXhwb3J0cy5zdGF0dXNCYXJTdHlsZVByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJzdGF0dXNCYXJTdHlsZVwiLCBjc3NOYW1lOiBcInN0YXR1cy1iYXItc3R5bGVcIiB9KTtcbmV4cG9ydHMuc3RhdHVzQmFyU3R5bGVQcm9wZXJ0eS5yZWdpc3Rlcihjb250ZW50X3ZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmFuZHJvaWRTdGF0dXNCYXJCYWNrZ3JvdW5kUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYW5kcm9pZFN0YXR1c0JhckJhY2tncm91bmRcIiwgY3NzTmFtZTogXCJhbmRyb2lkLXN0YXR1cy1iYXItYmFja2dyb3VuZFwiLFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGNvbnRlbnRfdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgY29udGVudF92aWV3XzEuQ29sb3Iodik7IH1cbn0pO1xuZXhwb3J0cy5hbmRyb2lkU3RhdHVzQmFyQmFja2dyb3VuZFByb3BlcnR5LnJlZ2lzdGVyKGNvbnRlbnRfdmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2UtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZnJhbWVfY29tbW9uXzEgPSByZXF1aXJlKFwiLi4vZnJhbWUvZnJhbWUtY29tbW9uXCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgcGFnZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3BhZ2UtY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vcGFnZS1jb21tb25cIikpO1xudmFyIEVOVFJZID0gXCJfZW50cnlcIjtcbnZhciBERUxFR0FURSA9IFwiX2RlbGVnYXRlXCI7XG52YXIgVFJBTlNJVElPTiA9IFwiX3RyYW5zaXRpb25cIjtcbnZhciBOT05fQU5JTUFURURfVFJBTlNJVElPTiA9IFwibm9uLWFuaW1hdGVkXCI7XG52YXIgbWFqb3JWZXJzaW9uID0gdXRpbHNfMS5pb3MuTWFqb3JWZXJzaW9uO1xuZnVuY3Rpb24gaXNCYWNrTmF2aWdhdGlvblRvKHBhZ2UsIGVudHJ5KSB7XG4gICAgdmFyIGZyYW1lID0gcGFnZS5mcmFtZTtcbiAgICBpZiAoIWZyYW1lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIG5hdmlnYXRpb25Db250ZXh0ID0gZnJhbWUuX2V4ZWN1dGluZ0NvbnRleHQgfHwgeyBuYXZpZ2F0aW9uVHlwZTogZnJhbWVfY29tbW9uXzEuTmF2aWdhdGlvblR5cGUuYmFjayB9O1xuICAgIHZhciBpc1JlcGxhY2UgPSBuYXZpZ2F0aW9uQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gZnJhbWVfY29tbW9uXzEuTmF2aWdhdGlvblR5cGUucmVwbGFjZTtcbiAgICBpZiAoaXNSZXBsYWNlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGZyYW1lLm5hdmlnYXRpb25RdWV1ZUlzRW1wdHkoKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIG5hdmlnYXRpb25RdWV1ZSA9IGZyYW1lLl9uYXZpZ2F0aW9uUXVldWU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuYXZpZ2F0aW9uUXVldWUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKG5hdmlnYXRpb25RdWV1ZVtpXS5lbnRyeSA9PT0gZW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiBuYXZpZ2F0aW9uUXVldWVbaV0ubmF2aWdhdGlvblR5cGUgPT09IGZyYW1lX2NvbW1vbl8xLk5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gaXNCYWNrTmF2aWdhdGlvbkZyb20oY29udHJvbGxlciwgcGFnZSkge1xuICAgIGlmICghcGFnZS5mcmFtZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChjb250cm9sbGVyLmlzQmFja3N0YWNrQ2xlYXJlZCB8fCBjb250cm9sbGVyLmlzQmFja3N0YWNrU2tpcHBlZCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChjb250cm9sbGVyLm5hdmlnYXRpb25Db250cm9sbGVyICYmIGNvbnRyb2xsZXIubmF2aWdhdGlvbkNvbnRyb2xsZXIudmlld0NvbnRyb2xsZXJzLmNvbnRhaW5zT2JqZWN0KGNvbnRyb2xsZXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG52YXIgVUlWaWV3Q29udHJvbGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVZpZXdDb250cm9sbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVZpZXdDb250cm9sbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSVZpZXdDb250cm9sbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBjb250cm9sbGVyID0gVUlWaWV3Q29udHJvbGxlckltcGwubmV3KCk7XG4gICAgICAgIGNvbnRyb2xsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBjb250cm9sbGVyO1xuICAgIH07XG4gICAgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLnZpZXdEaWRMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWRMb2FkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZXh0ZW5kZWRMYXlvdXRJbmNsdWRlc09wYXF1ZUJhcnMgPSB0cnVlO1xuICAgIH07XG4gICAgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld1dpbGxBcHBlYXIuY2FsbCh0aGlzLCBhbmltYXRlZCk7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZyYW1lID0gdGhpcy5uYXZpZ2F0aW9uQ29udHJvbGxlciA/IHRoaXMubmF2aWdhdGlvbkNvbnRyb2xsZXIub3duZXIgOiBudWxsO1xuICAgICAgICB2YXIgbmV3RW50cnkgPSB0aGlzW0VOVFJZXTtcbiAgICAgICAgaWYgKCFvd25lci5fcHJlc2VudGVkVmlld0NvbnRyb2xsZXIgJiYgbmV3RW50cnkgJiYgKCFmcmFtZSB8fCBmcmFtZS5jdXJyZW50UGFnZSAhPT0gb3duZXIpKSB7XG4gICAgICAgICAgICB2YXIgaXNCYWNrID0gaXNCYWNrTmF2aWdhdGlvblRvKG93bmVyLCBuZXdFbnRyeSk7XG4gICAgICAgICAgICBvd25lci5vbk5hdmlnYXRpbmdUbyhuZXdFbnRyeS5lbnRyeS5jb250ZXh0LCBpc0JhY2ssIG5ld0VudHJ5LmVudHJ5LmJpbmRpbmdDb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJhbWUpIHtcbiAgICAgICAgICAgIGlmICghb3duZXIucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgb3duZXIuX2ZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICAgICAgaWYgKCFmcmFtZS5fc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5fdXBkYXRlU3R5bGVTY29wZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmcmFtZS5fYWRkVmlldyhvd25lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvd25lci5wYXJlbnQgIT09IGZyYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFnZSBpcyBhbHJlYWR5IHNob3duIG9uIGFub3RoZXIgZnJhbWUuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnJhbWUuX3VwZGF0ZUFjdGlvbkJhcihvd25lcik7XG4gICAgICAgIH1cbiAgICAgICAgdmlld18xLmlvcy51cGRhdGVBdXRvQWRqdXN0U2Nyb2xsSW5zZXRzKHRoaXMsIG93bmVyKTtcbiAgICAgICAgaWYgKCFvd25lci5pc0xvYWRlZCkge1xuICAgICAgICAgICAgb3duZXIuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVZpZXdDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld0RpZEFwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWRBcHBlYXIuY2FsbCh0aGlzLCBhbmltYXRlZCk7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25Db250cm9sbGVyID0gdGhpcy5uYXZpZ2F0aW9uQ29udHJvbGxlcjtcbiAgICAgICAgdmFyIGZyYW1lID0gbmF2aWdhdGlvbkNvbnRyb2xsZXIgPyBuYXZpZ2F0aW9uQ29udHJvbGxlci5vd25lciA6IG51bGw7XG4gICAgICAgIGlmICghb3duZXIuX3ByZXNlbnRlZFZpZXdDb250cm9sbGVyICYmIGZyYW1lKSB7XG4gICAgICAgICAgICB2YXIgbmV3RW50cnkgPSB0aGlzW0VOVFJZXTtcbiAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dCA9IGZyYW1lLl9leGVjdXRpbmdDb250ZXh0IHx8IHsgbmF2aWdhdGlvblR5cGU6IGZyYW1lX2NvbW1vbl8xLk5hdmlnYXRpb25UeXBlLmJhY2sgfTtcbiAgICAgICAgICAgIHZhciBpc1JlcGxhY2UgPSBuYXZpZ2F0aW9uQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gZnJhbWVfY29tbW9uXzEuTmF2aWdhdGlvblR5cGUucmVwbGFjZTtcbiAgICAgICAgICAgIGZyYW1lLnNldEN1cnJlbnQobmV3RW50cnksIG5hdmlnYXRpb25Db250ZXh0Lm5hdmlnYXRpb25UeXBlKTtcbiAgICAgICAgICAgIGlmIChpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udHJvbGxlciA9IG5ld0VudHJ5LnJlc29sdmVkUGFnZS5pb3M7XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGVkXzEgPSBmcmFtZS5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24obmV3RW50cnkuZW50cnkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0ZWRfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcltUUkFOU0lUSU9OXSA9IGZyYW1lLl9nZXROYXZpZ2F0aW9uVHJhbnNpdGlvbihuZXdFbnRyeS5lbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyW1RSQU5TSVRJT05dID0geyBuYW1lOiBOT05fQU5JTUFURURfVFJBTlNJVElPTiB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnJhbWUuaW9zLmNvbnRyb2xsZXIuZGVsZWdhdGUgPSB0aGlzW0RFTEVHQVRFXTtcbiAgICAgICAgICAgIGZyYW1lLl9wcm9jZXNzTmF2aWdhdGlvblF1ZXVlKG93bmVyKTtcbiAgICAgICAgICAgIGlmIChmcmFtZS5jYW5Hb0JhY2soKSkge1xuICAgICAgICAgICAgICAgIG5hdmlnYXRpb25Db250cm9sbGVyLmludGVyYWN0aXZlUG9wR2VzdHVyZVJlY29nbml6ZXIuZGVsZWdhdGUgPSBuYXZpZ2F0aW9uQ29udHJvbGxlcjtcbiAgICAgICAgICAgICAgICBuYXZpZ2F0aW9uQ29udHJvbGxlci5pbnRlcmFjdGl2ZVBvcEdlc3R1cmVSZWNvZ25pemVyLmVuYWJsZWQgPSBvd25lci5lbmFibGVTd2lwZUJhY2tOYXZpZ2F0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkNvbnRyb2xsZXIuaW50ZXJhY3RpdmVQb3BHZXN0dXJlUmVjb2duaXplci5lbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBvd25lci5fcHJlc2VudGVkVmlld0NvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVZpZXdDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld1dpbGxEaXNhcHBlYXIgPSBmdW5jdGlvbiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3V2lsbERpc2FwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW93bmVyLl9wcmVzZW50ZWRWaWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgb3duZXIuX3ByZXNlbnRlZFZpZXdDb250cm9sbGVyID0gdGhpcy5wcmVzZW50ZWRWaWV3Q29udHJvbGxlcjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZnJhbWUgPSBvd25lci5mcmFtZTtcbiAgICAgICAgdmFyIHRhYiA9IHRoaXMudGFiQmFyQ29udHJvbGxlcjtcbiAgICAgICAgaWYgKG93bmVyLm9uTmF2aWdhdGluZ0Zyb20gJiYgIW93bmVyLl9wcmVzZW50ZWRWaWV3Q29udHJvbGxlciAmJiAhdGhpcy5wcmVzZW50aW5nVmlld0NvbnRyb2xsZXIgJiYgZnJhbWUgJiYgZnJhbWUuY3VycmVudFBhZ2UgPT09IG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgd2lsbFNlbGVjdFZpZXdDb250cm9sbGVyID0gdGFiICYmIHRhYi5fd2lsbFNlbGVjdFZpZXdDb250cm9sbGVyO1xuICAgICAgICAgICAgaWYgKCF3aWxsU2VsZWN0Vmlld0NvbnRyb2xsZXJcbiAgICAgICAgICAgICAgICB8fCB3aWxsU2VsZWN0Vmlld0NvbnRyb2xsZXIgPT09IHRhYi5zZWxlY3RlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlzQmFjayA9IGlzQmFja05hdmlnYXRpb25Gcm9tKHRoaXMsIG93bmVyKTtcbiAgICAgICAgICAgICAgICBvd25lci5vbk5hdmlnYXRpbmdGcm9tKGlzQmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJVmlld0NvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld0RpZERpc2FwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKCFwYWdlIHx8IHBhZ2UubW9kYWwgfHwgcGFnZS5fcHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocGFnZS5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcGFnZS5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLnZpZXdXaWxsTGF5b3V0U3Vidmlld3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld1dpbGxMYXlvdXRTdWJ2aWV3cy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2aWV3XzEuaW9zLnVwZGF0ZUNvbnN0cmFpbnRzKHRoaXMsIG93bmVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLnZpZXdEaWRMYXlvdXRTdWJ2aWV3cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3RGlkTGF5b3V0U3Vidmlld3MuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA+PSAxMSkge1xuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IG93bmVyLnBhcmVudDtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWVQYXJlbnQgPSBmcmFtZSAmJiBmcmFtZS5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGZyYW1lUGFyZW50ICYmICFmcmFtZVBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyYW1lUGFyZW50ID0gZnJhbWVQYXJlbnQucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVQYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudFBhZ2VJbnNldHNUb3AgPSBmcmFtZVBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkLnNhZmVBcmVhSW5zZXRzLnRvcDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnNldHNUb3AgPSB0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMudG9wO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0c1RvcCA9IE1hdGgubWF4KHBhcmVudFBhZ2VJbnNldHNUb3AgLSBjdXJyZW50SW5zZXRzVG9wLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudFBhZ2VJbnNldHNCb3R0b20gPSBmcmFtZVBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkLnNhZmVBcmVhSW5zZXRzLmJvdHRvbTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRJbnNldHNCb3R0b20gPSB0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMuYm90dG9tO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0c0JvdHRvbSA9IE1hdGgubWF4KHBhcmVudFBhZ2VJbnNldHNCb3R0b20gLSBjdXJyZW50SW5zZXRzQm90dG9tLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFkZGl0aW9uYWxJbnNldHNUb3AgPiAwIHx8IGFkZGl0aW9uYWxJbnNldHNCb3R0b20gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0cyA9IG5ldyBVSUVkZ2VJbnNldHMoeyB0b3A6IGFkZGl0aW9uYWxJbnNldHNUb3AsIGxlZnQ6IDAsIGJvdHRvbTogYWRkaXRpb25hbEluc2V0c0JvdHRvbSwgcmlnaHQ6IDAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZGl0aW9uYWxTYWZlQXJlYUluc2V0cyA9IGFkZGl0aW9uYWxJbnNldHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3XzEuaW9zLmxheW91dFZpZXcodGhpcywgb3duZXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFVJVmlld0NvbnRyb2xsZXJJbXBsLnByb3RvdHlwZSwgXCJ2aWV3RGlkQXBwZWFyXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLCBcInZpZXdXaWxsRGlzYXBwZWFyXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVUlWaWV3Q29udHJvbGxlckltcGwucHJvdG90eXBlLCBcInZpZXdEaWREaXNhcHBlYXJcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFVJVmlld0NvbnRyb2xsZXJJbXBsO1xufShVSVZpZXdDb250cm9sbGVyKSk7XG52YXIgd2hpdGVDb2xvciA9IG5ldyBwYWdlX2NvbW1vbl8xLkNvbG9yKFwid2hpdGVcIikuaW9zO1xudmFyIFBhZ2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQYWdlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBhZ2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIHZhciBjb250cm9sbGVyID0gVUlWaWV3Q29udHJvbGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICBfdGhpcy52aWV3Q29udHJvbGxlciA9IF90aGlzLl9pb3MgPSBjb250cm9sbGVyO1xuICAgICAgICBjb250cm9sbGVyLnZpZXcuYmFja2dyb3VuZENvbG9yID0gd2hpdGVDb2xvcjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBQYWdlLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3Q29udHJvbGxlci52aWV3O1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2UucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lvcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhZ2UucHJvdG90eXBlLCBcImZyYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFBhZ2UucHJvdG90eXBlLmxheW91dE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5oYXNBY3Rpb25CYXIpIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uQmFyLnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS51cGRhdGVTdGF0dXNCYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXR1c0JhclN0eWxlKHRoaXMuc3RhdHVzQmFyU3R5bGUpO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUuX3VwZGF0ZVN0YXR1c0JhclN0eWxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBmcmFtZSA9IHRoaXMuZnJhbWU7XG4gICAgICAgIGlmICh0aGlzLmZyYW1lICYmIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRyb2xsZXIgPSBmcmFtZS5pb3MuY29udHJvbGxlcjtcbiAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uQmFyID0gbmF2aWdhdGlvbkNvbnRyb2xsZXIubmF2aWdhdGlvbkJhcjtcbiAgICAgICAgICAgIG5hdmlnYXRpb25CYXIuYmFyU3R5bGUgPSB2YWx1ZSA9PT0gXCJkYXJrXCIgPyAxIDogMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGUuX3VwZGF0ZUVuYWJsZVN3aXBlQmFja05hdmlnYXRpb24gPSBmdW5jdGlvbiAoZW5hYmxlZCkge1xuICAgICAgICB2YXIgbmF2Q29udHJvbGxlciA9IHRoaXMuX2lvcy5uYXZpZ2F0aW9uQ29udHJvbGxlcjtcbiAgICAgICAgaWYgKHRoaXMuZnJhbWUgJiYgbmF2Q29udHJvbGxlciAmJiBuYXZDb250cm9sbGVyLmludGVyYWN0aXZlUG9wR2VzdHVyZVJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgIGVuYWJsZWQgPSBlbmFibGVkICYmIHRoaXMuZnJhbWUuY2FuR29CYWNrKCk7XG4gICAgICAgICAgICBuYXZDb250cm9sbGVyLmludGVyYWN0aXZlUG9wR2VzdHVyZVJlY29nbml6ZXIuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSBwYWdlX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSBwYWdlX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSBwYWdlX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHBhZ2VfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIGlmICh0aGlzLmZyYW1lICYmIHRoaXMuZnJhbWUuX2dldE5hdkJhclZpc2libGUodGhpcykpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IHRoaXMuYWN0aW9uQmFyLl9nZXRBY3R1YWxTaXplLCB3aWR0aF8xID0gX2Eud2lkdGgsIGhlaWdodF8xID0gX2EuaGVpZ2h0O1xuICAgICAgICAgICAgdmFyIHdpZHRoU3BlYyA9IHBhZ2VfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyh3aWR0aF8xLCBwYWdlX2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRTcGVjID0gcGFnZV9jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKGhlaWdodF8xLCBwYWdlX2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgICAgIHBhZ2VfY29tbW9uXzEuVmlldy5tZWFzdXJlQ2hpbGQodGhpcywgdGhpcy5hY3Rpb25CYXIsIHdpZHRoU3BlYywgaGVpZ2h0U3BlYyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IHBhZ2VfY29tbW9uXzEuVmlldy5tZWFzdXJlQ2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChyZXN1bHQubWVhc3VyZWRXaWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgIHZhciBtZWFzdXJlSGVpZ2h0ID0gTWF0aC5tYXgocmVzdWx0Lm1lYXN1cmVkSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gcGFnZV9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gcGFnZV9jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZUhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZS5vbkxheW91dCA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIF9hID0gdGhpcy5hY3Rpb25CYXIuX2dldEFjdHVhbFNpemUsIGFjdGlvbkJhcldpZHRoID0gX2Eud2lkdGgsIGFjdGlvbkJhckhlaWdodCA9IF9hLmhlaWdodDtcbiAgICAgICAgcGFnZV9jb21tb25fMS5WaWV3LmxheW91dENoaWxkKHRoaXMsIHRoaXMuYWN0aW9uQmFyLCAwLCAwLCBhY3Rpb25CYXJXaWR0aCwgYWN0aW9uQmFySGVpZ2h0KTtcbiAgICAgICAgdmFyIGluc2V0cyA9IHRoaXMuZ2V0U2FmZUFyZWFJbnNldHMoKTtcbiAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgaW5zZXRzLnRvcCA9IHBhZ2VfY29tbW9uXzEubGF5b3V0LnJvdW5kKHBhZ2VfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHRoaXMudmlld0NvbnRyb2xsZXIudmlldy5zYWZlQXJlYUxheW91dEd1aWRlLmxheW91dEZyYW1lLm9yaWdpbi55KSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkTGVmdCA9IDAgKyBpbnNldHMubGVmdDtcbiAgICAgICAgdmFyIGNoaWxkVG9wID0gMCArIGluc2V0cy50b3A7XG4gICAgICAgIHZhciBjaGlsZFJpZ2h0ID0gcmlnaHQgLSBpbnNldHMucmlnaHQ7XG4gICAgICAgIHZhciBjaGlsZEJvdHRvbSA9IGJvdHRvbSAtIGluc2V0cy5ib3R0b207XG4gICAgICAgIHBhZ2VfY29tbW9uXzEuVmlldy5sYXlvdXRDaGlsZCh0aGlzLCB0aGlzLmxheW91dFZpZXcsIGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkUmlnaHQsIGNoaWxkQm90dG9tKTtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkLCBhdEluZGV4KSB7XG4gICAgICAgIGlmIChjaGlsZCA9PT0gdGhpcy5hY3Rpb25CYXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVQYXJlbnQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBuYXRpdmVDaGlsZCA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlciA9IGNoaWxkLmlvcyBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIgPyBjaGlsZC5pb3MgOiBjaGlsZC52aWV3Q29udHJvbGxlcjtcbiAgICAgICAgaWYgKHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52aWV3Q29udHJvbGxlci5wcmVzZW50ZWRWaWV3Q29udHJvbGxlciA9PT0gdmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmlld0NvbnRyb2xsZXIuYWRkQ2hpbGRWaWV3Q29udHJvbGxlcih2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hdGl2ZVBhcmVudCAmJiBuYXRpdmVDaGlsZCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhdEluZGV4ICE9PSBcIm51bWJlclwiIHx8IGF0SW5kZXggPj0gbmF0aXZlUGFyZW50LnN1YnZpZXdzLmNvdW50KSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlUGFyZW50LmFkZFN1YnZpZXcobmF0aXZlQ2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlUGFyZW50Lmluc2VydFN1YnZpZXdBdEluZGV4KG5hdGl2ZUNoaWxkLCBhdEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFBhZ2UucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgaWYgKGNoaWxkID09PSB0aGlzLmFjdGlvbkJhcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlciA9IGNoaWxkLmlvcyBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIgPyBjaGlsZC5pb3MgOiBjaGlsZC52aWV3Q29udHJvbGxlcjtcbiAgICAgICAgaWYgKHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlci5yZW1vdmVGcm9tUGFyZW50Vmlld0NvbnRyb2xsZXIoKTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZVtwYWdlX2NvbW1vbl8xLmFjdGlvbkJhckhpZGRlblByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlRW5hYmxlU3dpcGVCYWNrTmF2aWdhdGlvbih2YWx1ZSk7XG4gICAgICAgIGludmFsaWRhdGVUb3Btb3N0Q29udHJvbGxlcih0aGlzLnZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgdmFyIGZyYW1lID0gdGhpcy5mcmFtZTtcbiAgICAgICAgaWYgKGZyYW1lKSB7XG4gICAgICAgICAgICBmcmFtZS5fdXBkYXRlQWN0aW9uQmFyKHRoaXMsIHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQYWdlLnByb3RvdHlwZVtwYWdlX2NvbW1vbl8xLnN0YXR1c0JhclN0eWxlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgUGFnZS5wcm90b3R5cGVbcGFnZV9jb21tb25fMS5zdGF0dXNCYXJTdHlsZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGZyYW1lID0gdGhpcy5mcmFtZTtcbiAgICAgICAgaWYgKGZyYW1lKSB7XG4gICAgICAgICAgICB2YXIgbmF2aWdhdGlvbkJhciA9IGZyYW1lLmlvcy5jb250cm9sbGVyLm5hdmlnYXRpb25CYXI7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkJhci5iYXJTdHlsZSA9IHZhbHVlID09PSBcImRhcmtcIiA/IDEgOiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkJhci5iYXJTdHlsZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gUGFnZTtcbn0ocGFnZV9jb21tb25fMS5QYWdlQmFzZSkpO1xuZXhwb3J0cy5QYWdlID0gUGFnZTtcbmZ1bmN0aW9uIGludmFsaWRhdGVUb3Btb3N0Q29udHJvbGxlcihjb250cm9sbGVyKSB7XG4gICAgaWYgKCFjb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29udHJvbGxlci52aWV3LnNldE5lZWRzTGF5b3V0KCk7XG4gICAgdmFyIHByZXNlbnRlZFZpZXdDb250cm9sbGVyID0gY29udHJvbGxlci5wcmVzZW50ZWRWaWV3Q29udHJvbGxlcjtcbiAgICBpZiAocHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuIGludmFsaWRhdGVUb3Btb3N0Q29udHJvbGxlcihwcmVzZW50ZWRWaWV3Q29udHJvbGxlcik7XG4gICAgfVxuICAgIHZhciBjaGlsZENvbnRyb2xsZXJzID0gY29udHJvbGxlci5jaGlsZFZpZXdDb250cm9sbGVycztcbiAgICB2YXIgc2l6ZSA9IGNvbnRyb2xsZXIuY2hpbGRWaWV3Q29udHJvbGxlcnMuY291bnQ7XG4gICAgd2hpbGUgKHNpemUgPiAwKSB7XG4gICAgICAgIHZhciBjaGlsZENvbnRyb2xsZXIgPSBjaGlsZENvbnRyb2xsZXJzWy0tc2l6ZV07XG4gICAgICAgIGlmIChjaGlsZENvbnRyb2xsZXIgaW5zdGFuY2VvZiBVSVRhYkJhckNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGludmFsaWRhdGVUb3Btb3N0Q29udHJvbGxlcihjaGlsZENvbnRyb2xsZXIuc2VsZWN0ZWRWaWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2hpbGRDb250cm9sbGVyIGluc3RhbmNlb2YgVUlOYXZpZ2F0aW9uQ29udHJvbGxlcikge1xuICAgICAgICAgICAgaW52YWxpZGF0ZVRvcG1vc3RDb250cm9sbGVyKGNoaWxkQ29udHJvbGxlci50b3BWaWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2hpbGRDb250cm9sbGVyIGluc3RhbmNlb2YgVUlTcGxpdFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpbnZhbGlkYXRlVG9wbW9zdENvbnRyb2xsZXIoY2hpbGRDb250cm9sbGVyLnZpZXdDb250cm9sbGVycy5sYXN0T2JqZWN0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGludmFsaWRhdGVUb3Btb3N0Q29udHJvbGxlcihjaGlsZENvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZS5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgUGxhY2Vob2xkZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQbGFjZWhvbGRlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQbGFjZWhvbGRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBQbGFjZWhvbGRlci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7IGV2ZW50TmFtZTogUGxhY2Vob2xkZXIuY3JlYXRpbmdWaWV3RXZlbnQsIG9iamVjdDogdGhpcywgdmlldzogdW5kZWZpbmVkLCBjb250ZXh0OiB0aGlzLl9jb250ZXh0IH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgICAgICByZXR1cm4gYXJncy52aWV3O1xuICAgIH07XG4gICAgUGxhY2Vob2xkZXIuY3JlYXRpbmdWaWV3RXZlbnQgPSBcImNyZWF0aW5nVmlld1wiO1xuICAgIHJldHVybiBQbGFjZWhvbGRlcjtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuUGxhY2Vob2xkZXIgPSBQbGFjZWhvbGRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBsYWNlaG9sZGVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIFByb2dyZXNzQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByb2dyZXNzQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQcm9ncmVzc0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUHJvZ3Jlc3NCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiUHJvZ3Jlc3NcIilcbiAgICBdLCBQcm9ncmVzc0Jhc2UpO1xuICAgIHJldHVybiBQcm9ncmVzc0Jhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlByb2dyZXNzQmFzZSA9IFByb2dyZXNzQmFzZTtcblByb2dyZXNzQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMudmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidmFsdWVcIixcbiAgICBkZWZhdWx0VmFsdWU6IDAsXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0LCB2KSB7XG4gICAgICAgIHJldHVybiB2IDwgMCA/IDAgOiBNYXRoLm1pbih2LCB0Lm1heFZhbHVlKTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy52YWx1ZVByb3BlcnR5LnJlZ2lzdGVyKFByb2dyZXNzQmFzZSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heFZhbHVlXCIsXG4gICAgZGVmYXVsdFZhbHVlOiAxMDAsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgZXhwb3J0cy52YWx1ZVByb3BlcnR5LmNvZXJjZSh0YXJnZXQpO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkucmVnaXN0ZXIoUHJvZ3Jlc3NCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb2dyZXNzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb2dyZXNzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vcHJvZ3Jlc3MtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vcHJvZ3Jlc3MtY29tbW9uXCIpKTtcbnZhciBQcm9ncmVzcyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFByb2dyZXNzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFByb2dyZXNzKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFByb2dyZXNzLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVUlQcm9ncmVzc1ZpZXcubmV3KCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJvZ3Jlc3MucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmlvcy5wcm9ncmVzcyA9IHZhbHVlIC8gdGhpcy5tYXhWYWx1ZTtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5tYXhWYWx1ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTAwO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmlvcy5wcm9ncmVzcyA9IHRoaXMudmFsdWUgLyB2YWx1ZTtcbiAgICB9O1xuICAgIFByb2dyZXNzLnByb3RvdHlwZVtwcm9ncmVzc19jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MucHJvZ3Jlc3NUaW50Q29sb3I7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW9zLnByb2dyZXNzVGludENvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBwcm9ncmVzc19jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MudHJhY2tUaW50Q29sb3I7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHByb2dyZXNzX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIHRoaXMuaW9zLnRyYWNrVGludENvbG9yID0gY29sb3I7XG4gICAgfTtcbiAgICBQcm9ncmVzcy5wcm90b3R5cGVbcHJvZ3Jlc3NfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUHJvZ3Jlc3MucHJvdG90eXBlW3Byb2dyZXNzX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIHJldHVybiBQcm9ncmVzcztcbn0ocHJvZ3Jlc3NfY29tbW9uXzEuUHJvZ3Jlc3NCYXNlKSk7XG5leHBvcnRzLlByb2dyZXNzID0gUHJvZ3Jlc3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9ncmVzcy5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxheW91dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9sYXlvdXQtYmFzZVwiKTtcbnZhciBQcm94eVZpZXdDb250YWluZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQcm94eVZpZXdDb250YWluZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUHJveHlWaWV3Q29udGFpbmVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVlc3RlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9nZXROYXRpdmVWaWV3c0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gMDtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjdikge1xuICAgICAgICAgICAgcmVzdWx0ICs9IGN2Ll9nZXROYXRpdmVWaWV3c0NvdW50KCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9lYWNoTGF5b3V0VmlldyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVhY2hDaGlsZFZpZXcoZnVuY3Rpb24gKGN2KSB7XG4gICAgICAgICAgICBpZiAoIWN2LmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICAgICAgY3YuX2VhY2hMYXlvdXRWaWV3KGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFByb3h5Vmlld0NvbnRhaW5lci5wcm90b3R5cGUuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgPSBmdW5jdGlvbiAoY2hpbGQsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKGxheW91dF9iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGxheW91dF9iYXNlXzEudHJhY2VXcml0ZShcIlZpZXdDb250YWluZXIuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgZm9yIGEgY2hpbGQgXCIgKyBjaGlsZCArIFwiIFZpZXdDb250YWluZXIucGFyZW50OiBcIiArIHRoaXMucGFyZW50LCBsYXlvdXRfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQpO1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLlZpZXcpIHtcbiAgICAgICAgICAgIHZhciBiYXNlSW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIGluc2lkZUluZGV4ID0gMDtcbiAgICAgICAgICAgIGlmIChwYXJlbnQgaW5zdGFuY2VvZiBsYXlvdXRfYmFzZV8xLkxheW91dEJhc2UpIHtcbiAgICAgICAgICAgICAgICBiYXNlSW5kZXggPSBwYXJlbnQuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXgocGFyZW50LmdldENoaWxkSW5kZXgodGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc2lkZUluZGV4ID0gdGhpcy5fY2hpbGRJbmRleFRvTmF0aXZlQ2hpbGRJbmRleChhdEluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluc2lkZUluZGV4ID0gdGhpcy5fZ2V0TmF0aXZlVmlld3NDb3VudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxheW91dF9iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBsYXlvdXRfYmFzZV8xLnRyYWNlV3JpdGUoXCJQcm94eVZpZXdDb250YWluZXIuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUgYXQ6IFwiICsgYXRJbmRleCArIFwiIGJhc2U6IFwiICsgYmFzZUluZGV4ICsgXCIgYWRkaXRpb25hbDogXCIgKyBpbnNpZGVJbmRleCwgbGF5b3V0X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50Ll9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlKGNoaWxkLCBiYXNlSW5kZXggKyBpbnNpZGVJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZS5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGlmIChsYXlvdXRfYmFzZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBsYXlvdXRfYmFzZV8xLnRyYWNlV3JpdGUoXCJQcm94eVZpZXdDb250YWluZXIuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSBmb3IgYSBjaGlsZCBcIiArIGNoaWxkICsgXCIgVmlld0NvbnRhaW5lci5wYXJlbnQ6IFwiICsgdGhpcy5wYXJlbnQsIGxheW91dF9iYXNlXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHkpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZS5jYWxsKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5WaWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50Ll9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUoY2hpbGQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgcGFyZW50Ll9yZWdpc3RlckxheW91dENoaWxkKGNoaWxkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyLnByb3RvdHlwZS5fdW5yZWdpc3RlckxheW91dENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCBpbnN0YW5jZW9mIGxheW91dF9iYXNlXzEuTGF5b3V0QmFzZSkge1xuICAgICAgICAgICAgcGFyZW50Ll91bnJlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBQcm94eVZpZXdDb250YWluZXIucHJvdG90eXBlLl9wYXJlbnRDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZFBhcmVudCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9wYXJlbnRDaGFuZ2VkLmNhbGwodGhpcywgb2xkUGFyZW50KTtcbiAgICAgICAgdmFyIGFkZGluZ1RvUGFyZW50ID0gdGhpcy5wYXJlbnQgJiYgIW9sZFBhcmVudDtcbiAgICAgICAgdmFyIG5ld0xheW91dCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgb2xkTGF5b3V0ID0gb2xkUGFyZW50O1xuICAgICAgICBpZiAoYWRkaW5nVG9QYXJlbnQgJiYgbmV3TGF5b3V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBuZXdMYXlvdXQuX3JlZ2lzdGVyTGF5b3V0Q2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAob2xkTGF5b3V0IGluc3RhbmNlb2YgbGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSB7XG4gICAgICAgICAgICB0aGlzLmVhY2hMYXlvdXRDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBvbGRMYXlvdXQuX3VucmVnaXN0ZXJMYXlvdXRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUHJveHlWaWV3Q29udGFpbmVyID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGxheW91dF9iYXNlXzEuQ1NTVHlwZShcIlByb3h5Vmlld0NvbnRhaW5lclwiKVxuICAgIF0sIFByb3h5Vmlld0NvbnRhaW5lcik7XG4gICAgcmV0dXJuIFByb3h5Vmlld0NvbnRhaW5lcjtcbn0obGF5b3V0X2Jhc2VfMS5MYXlvdXRCYXNlKSk7XG5leHBvcnRzLlByb3h5Vmlld0NvbnRhaW5lciA9IFByb3h5Vmlld0NvbnRhaW5lcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb3h5LXZpZXctY29udGFpbmVyLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGFiZWxfMSA9IHJlcXVpcmUoXCIuLi9sYWJlbFwiKTtcbnZhciBsYXlvdXRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2xheW91dHMvbGF5b3V0LWJhc2VcIik7XG52YXIgc3RhY2tfbGF5b3V0XzEgPSByZXF1aXJlKFwiLi4vbGF5b3V0cy9zdGFjay1sYXlvdXRcIik7XG52YXIgb2JzZXJ2YWJsZV9hcnJheV8xID0gcmVxdWlyZShcIi4uLy4uL2RhdGEvb2JzZXJ2YWJsZS1hcnJheVwiKTtcbnZhciB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEgPSByZXF1aXJlKFwiLi4vY29yZS93ZWFrLWV2ZW50LWxpc3RlbmVyXCIpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9idWlsZGVyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9sYXlvdXRzL2xheW91dC1iYXNlXCIpKTtcbnZhciBrbm93blRlbXBsYXRlcztcbihmdW5jdGlvbiAoa25vd25UZW1wbGF0ZXMpIHtcbiAgICBrbm93blRlbXBsYXRlcy5pdGVtVGVtcGxhdGUgPSBcIml0ZW1UZW1wbGF0ZVwiO1xufSkoa25vd25UZW1wbGF0ZXMgPSBleHBvcnRzLmtub3duVGVtcGxhdGVzIHx8IChleHBvcnRzLmtub3duVGVtcGxhdGVzID0ge30pKTtcbnZhciBSZXBlYXRlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFJlcGVhdGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJlcGVhdGVyKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5faXNEaXJ0eSA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5pdGVtc0xheW91dCA9IG5ldyBzdGFja19sYXlvdXRfMS5TdGFja0xheW91dCgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzRGlydHkpIHtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5fcmVxdWVzdFJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzRGlydHkgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pdGVtc0xheW91dCkge1xuICAgICAgICAgICAgdGhpcy5pdGVtc0xheW91dC5yZW1vdmVDaGlsZHJlbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pdGVtcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLml0ZW1zLmxlbmd0aDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIHZpZXdUb0FkZCA9IHRoaXMuaXRlbVRlbXBsYXRlID8gYnVpbGRlcl8xLnBhcnNlKHRoaXMuaXRlbVRlbXBsYXRlLCB0aGlzKSA6IHRoaXMuX2dldERlZmF1bHRJdGVtQ29udGVudChpKTtcbiAgICAgICAgICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuX2dldERhdGFJdGVtKGkpO1xuICAgICAgICAgICAgdmlld1RvQWRkLmJpbmRpbmdDb250ZXh0ID0gZGF0YUl0ZW07XG4gICAgICAgICAgICB0aGlzLml0ZW1zTGF5b3V0LmFkZENoaWxkKHZpZXdUb0FkZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faXNEaXJ0eSA9IGZhbHNlO1xuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLl9vbkl0ZW1zQ2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RSZWZyZXNoKCk7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUuX2dldERlZmF1bHRJdGVtQ29udGVudCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICB2YXIgbGJsID0gbmV3IGxhYmVsXzEuTGFiZWwoKTtcbiAgICAgICAgbGJsLmJpbmQoe1xuICAgICAgICAgICAgdGFyZ2V0UHJvcGVydHk6IFwidGV4dFwiLFxuICAgICAgICAgICAgc291cmNlUHJvcGVydHk6IFwiJHZhbHVlXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsYmw7XG4gICAgfTtcbiAgICBSZXBlYXRlci5wcm90b3R5cGUuX2dldERhdGFJdGVtID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIHJldHVybiBpdGVtcy5nZXRJdGVtID8gaXRlbXMuZ2V0SXRlbShpbmRleCkgOiB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXBlYXRlci5wcm90b3R5cGUsIFwiX2NoaWxkcmVuQ291bnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zTGF5b3V0ID8gMSA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFJlcGVhdGVyLnByb3RvdHlwZS5lYWNoQ2hpbGRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zTGF5b3V0KSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLml0ZW1zTGF5b3V0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2YXIgaW5zZXRzID0gdGhpcy5nZXRTYWZlQXJlYUluc2V0cygpO1xuICAgICAgICB2YXIgcGFkZGluZ0xlZnQgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyBpbnNldHMubGVmdDtcbiAgICAgICAgdmFyIHBhZGRpbmdUb3AgPSB0aGlzLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgdGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgaW5zZXRzLnRvcDtcbiAgICAgICAgdmFyIHBhZGRpbmdSaWdodCA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgaW5zZXRzLnJpZ2h0O1xuICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyBpbnNldHMuYm90dG9tO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0ID0gcGFkZGluZ0xlZnQ7XG4gICAgICAgIHZhciBjaGlsZFRvcCA9IHBhZGRpbmdUb3A7XG4gICAgICAgIHZhciBjaGlsZFJpZ2h0ID0gcmlnaHQgLSBsZWZ0IC0gcGFkZGluZ1JpZ2h0O1xuICAgICAgICB2YXIgY2hpbGRCb3R0b20gPSBib3R0b20gLSB0b3AgLSBwYWRkaW5nQm90dG9tO1xuICAgICAgICBsYXlvdXRfYmFzZV8xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgdGhpcy5pdGVtc0xheW91dCwgY2hpbGRMZWZ0LCBjaGlsZFRvcCwgY2hpbGRSaWdodCwgY2hpbGRCb3R0b20pO1xuICAgIH07XG4gICAgUmVwZWF0ZXIucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbGF5b3V0X2Jhc2VfMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCB0aGlzLml0ZW1zTGF5b3V0LCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aCA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoTW9kZSA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IGxheW91dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gbGF5b3V0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBsYXlvdXRfYmFzZV8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShyZXN1bHQubWVhc3VyZWRXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IGxheW91dF9iYXNlXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHJlc3VsdC5tZWFzdXJlZEhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFJlcGVhdGVyLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICBSZXBlYXRlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBsYXlvdXRfYmFzZV8xLkNTU1R5cGUoXCJSZXBlYXRlclwiKVxuICAgIF0sIFJlcGVhdGVyKTtcbiAgICByZXR1cm4gUmVwZWF0ZXI7XG59KGxheW91dF9iYXNlXzEuQ3VzdG9tTGF5b3V0VmlldykpO1xuZXhwb3J0cy5SZXBlYXRlciA9IFJlcGVhdGVyO1xuUmVwZWF0ZXIucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5ID0gbmV3IGxheW91dF9iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbVRlbXBsYXRlXCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICB0YXJnZXQuX3JlcXVlc3RSZWZyZXNoKCk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1UZW1wbGF0ZVByb3BlcnR5LnJlZ2lzdGVyKFJlcGVhdGVyKTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChvbGRWYWx1ZSBpbnN0YW5jZW9mIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkpIHtcbiAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5yZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcihvbGRWYWx1ZSwgb2JzZXJ2YWJsZV9hcnJheV8xLk9ic2VydmFibGVBcnJheS5jaGFuZ2VFdmVudCwgdGFyZ2V0Ll9vbkl0ZW1zQ2hhbmdlZCwgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VmFsdWUgaW5zdGFuY2VvZiBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KSB7XG4gICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEuYWRkV2Vha0V2ZW50TGlzdGVuZXIobmV3VmFsdWUsIG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIHRhcmdldC5fb25JdGVtc0NoYW5nZWQsIHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0Ll9yZXF1ZXN0UmVmcmVzaCgpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFJlcGVhdGVyKTtcbmV4cG9ydHMuaXRlbXNMYXlvdXRQcm9wZXJ0eSA9IG5ldyBsYXlvdXRfYmFzZV8xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zTGF5b3V0XCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChvbGRWYWx1ZSkge1xuICAgICAgICAgICAgdGFyZ2V0Ll9yZW1vdmVWaWV3KG9sZFZhbHVlKTtcbiAgICAgICAgICAgIG9sZFZhbHVlLnJlbW92ZUNoaWxkcmVuKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0YXJnZXQuX2FkZFZpZXcobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRhcmdldC5fcmVxdWVzdFJlZnJlc2goKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNMYXlvdXRQcm9wZXJ0eS5yZWdpc3RlcihSZXBlYXRlcik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXBlYXRlci5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbnRlbnRfdmlld18xID0gcmVxdWlyZShcIi4uL2NvbnRlbnQtdmlld1wiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29udGVudC12aWV3XCIpKTtcbnZhciBTY3JvbGxWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNjcm9sbFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNjcm9sbFZpZXdCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3Njcm9sbENoYW5nZUNvdW50ID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTY3JvbGxWaWV3QmFzZV8xID0gU2Nyb2xsVmlld0Jhc2U7XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoYXJnLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgaWYgKGFyZyA9PT0gU2Nyb2xsVmlld0Jhc2VfMS5zY3JvbGxFdmVudCkge1xuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsQ2hhbmdlQ291bnQrKztcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwodGhpcywgYXJnLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgIGlmIChhcmcgPT09IFNjcm9sbFZpZXdCYXNlXzEuc2Nyb2xsRXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njcm9sbENoYW5nZUNvdW50LS07XG4gICAgICAgICAgICB0aGlzLmRldHRhY2goKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0YWNoKCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGV0dGFjaCgpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmF0dGFjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbENoYW5nZUNvdW50ID4gMCAmJiB0aGlzLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaE5hdGl2ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuZGV0dGFjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbENoYW5nZUNvdW50ID09PSAwICYmIHRoaXMuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZGV0dGFjaE5hdGl2ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUuYXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLmRldHRhY2hOYXRpdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcImhvcml6b250YWxPZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcInZlcnRpY2FsT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXdCYXNlLnByb3RvdHlwZSwgXCJzY3JvbGxhYmxlV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2Nyb2xsVmlld0Jhc2UucHJvdG90eXBlLCBcInNjcm9sbGFibGVIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICB2YXIgU2Nyb2xsVmlld0Jhc2VfMTtcbiAgICBTY3JvbGxWaWV3QmFzZS5zY3JvbGxFdmVudCA9IFwic2Nyb2xsXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTY3JvbGxWaWV3QmFzZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgU2Nyb2xsVmlld0Jhc2UgPSBTY3JvbGxWaWV3QmFzZV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvbnRlbnRfdmlld18xLkNTU1R5cGUoXCJTY3JvbGxWaWV3XCIpXG4gICAgXSwgU2Nyb2xsVmlld0Jhc2UpO1xuICAgIHJldHVybiBTY3JvbGxWaWV3QmFzZTtcbn0oY29udGVudF92aWV3XzEuQ29udGVudFZpZXcpKTtcbmV4cG9ydHMuU2Nyb2xsVmlld0Jhc2UgPSBTY3JvbGxWaWV3QmFzZTtcbnZhciBjb252ZXJ0ZXIgPSBjb250ZW50X3ZpZXdfMS5tYWtlUGFyc2VyKGNvbnRlbnRfdmlld18xLm1ha2VWYWxpZGF0b3IoXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIikpO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm9yaWVudGF0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJ2ZXJ0aWNhbFwiLCBhZmZlY3RzTGF5b3V0OiB0cnVlLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5fb25PcmllbnRhdGlvbkNoYW5nZWQoKTtcbiAgICB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBjb252ZXJ0ZXJcbn0pO1xuZXhwb3J0cy5vcmllbnRhdGlvblByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbmV4cG9ydHMuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVByb3BlcnR5ID0gbmV3IGNvbnRlbnRfdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNjcm9sbEJhckluZGljYXRvclZpc2libGVcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgIHZhbHVlQ29udmVydGVyOiBjb250ZW50X3ZpZXdfMS5ib29sZWFuQ29udmVydGVyXG59KTtcbmV4cG9ydHMuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZVByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbmV4cG9ydHMuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkgPSBuZXcgY29udGVudF92aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXNTY3JvbGxFbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogY29udGVudF92aWV3XzEuYm9vbGVhbkNvbnZlcnRlclxufSk7XG5leHBvcnRzLmlzU2Nyb2xsRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFNjcm9sbFZpZXdCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNjcm9sbC12aWV3LWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNjcm9sbF92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vc2Nyb2xsLXZpZXctY29tbW9uXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdXRpbHNcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zY3JvbGwtdmlldy1jb21tb25cIikpO1xudmFyIG1ham9yVmVyc2lvbiA9IHV0aWxzXzEuaW9zLk1ham9yVmVyc2lvbjtcbnZhciBVSVNjcm9sbFZpZXdEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVNjcm9sbFZpZXdEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlTY3JvbGxWaWV3RGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJU2Nyb2xsVmlld0RlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBpbXBsID0gVUlTY3JvbGxWaWV3RGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBpbXBsLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gaW1wbDtcbiAgICB9O1xuICAgIFVJU2Nyb2xsVmlld0RlbGVnYXRlSW1wbC5wcm90b3R5cGUuc2Nyb2xsVmlld0RpZFNjcm9sbCA9IGZ1bmN0aW9uIChzdikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5ub3RpZnkoe1xuICAgICAgICAgICAgICAgIG9iamVjdDogb3duZXIsXG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBcInNjcm9sbFwiLFxuICAgICAgICAgICAgICAgIHNjcm9sbFg6IG93bmVyLmhvcml6b250YWxPZmZzZXQsXG4gICAgICAgICAgICAgICAgc2Nyb2xsWTogb3duZXIudmVydGljYWxPZmZzZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVNjcm9sbFZpZXdEZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSVNjcm9sbFZpZXdEZWxlZ2F0ZV07XG4gICAgcmV0dXJuIFVJU2Nyb2xsVmlld0RlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbnZhciBTY3JvbGxWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2Nyb2xsVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTY3JvbGxWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRNZWFzdXJlZFdpZHRoID0gMDtcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRNZWFzdXJlZEhlaWdodCA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBVSVNjcm9sbFZpZXcubmV3KCk7XG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVTY3JvbGxCYXJWaXNpYmlsaXR5KHRoaXMuc2Nyb2xsQmFySW5kaWNhdG9yVmlzaWJsZSk7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcygpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNsaXBzVG9Cb3VuZHMgPSB0cnVlO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuYXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJU2Nyb2xsVmlld0RlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmRlbGVnYXRlID0gdGhpcy5fZGVsZWdhdGU7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5kZXR0YWNoTmF0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZGVsZWdhdGUgPSBudWxsO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUudXBkYXRlU2Nyb2xsQmFyVmlzaWJpbGl0eSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNob3dzSG9yaXpvbnRhbFNjcm9sbEluZGljYXRvciA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNob3dzVmVydGljYWxTY3JvbGxJbmRpY2F0b3IgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcImhvcml6b250YWxPZmZzZXRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgPyB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudE9mZnNldC54IDogMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcInZlcnRpY2FsT2Zmc2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkID8gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRPZmZzZXQueSA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTY3JvbGxWaWV3LnByb3RvdHlwZSwgXCJzY3JvbGxhYmxlV2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8IHRoaXMub3JpZW50YXRpb24gIT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRTaXplLndpZHRoIC0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmJvdW5kcy5zaXplLndpZHRoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjcm9sbFZpZXcucHJvdG90eXBlLCBcInNjcm9sbGFibGVIZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8IHRoaXMub3JpZW50YXRpb24gIT09IFwidmVydGljYWxcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50U2l6ZS5oZWlnaHQgLSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLnNpemUuaGVpZ2h0KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGVbc2Nyb2xsX3ZpZXdfY29tbW9uXzEuaXNTY3JvbGxFbmFibGVkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2Nyb2xsRW5hYmxlZDtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlW3Njcm9sbF92aWV3X2NvbW1vbl8xLmlzU2Nyb2xsRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNjcm9sbEVuYWJsZWQgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlW3Njcm9sbF92aWV3X2NvbW1vbl8xLnNjcm9sbEJhckluZGljYXRvclZpc2libGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZVtzY3JvbGxfdmlld19jb21tb25fMS5zY3JvbGxCYXJJbmRpY2F0b3JWaXNpYmxlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbEJhclZpc2liaWxpdHkodmFsdWUpO1xuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuc2Nyb2xsVG9WZXJ0aWNhbE9mZnNldCA9IGZ1bmN0aW9uICh2YWx1ZSwgYW5pbWF0ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiB0aGlzLm9yaWVudGF0aW9uID09PSBcInZlcnRpY2FsXCIgJiYgdGhpcy5pc1Njcm9sbEVuYWJsZWQpIHtcbiAgICAgICAgICAgIHZhciBib3VuZHMgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYm91bmRzLnNpemU7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2Nyb2xsUmVjdFRvVmlzaWJsZUFuaW1hdGVkKENHUmVjdE1ha2UoMCwgdmFsdWUsIGJvdW5kcy53aWR0aCwgYm91bmRzLmhlaWdodCksIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2Nyb2xsVmlldy5wcm90b3R5cGUuc2Nyb2xsVG9Ib3Jpem9udGFsT2Zmc2V0ID0gZnVuY3Rpb24gKHZhbHVlLCBhbmltYXRlZCkge1xuICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiICYmIHRoaXMuaXNTY3JvbGxFbmFibGVkKSB7XG4gICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmJvdW5kcy5zaXplO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNjcm9sbFJlY3RUb1Zpc2libGVBbmltYXRlZChDR1JlY3RNYWtlKHZhbHVlLCAwLCBib3VuZHMud2lkdGgsIGJvdW5kcy5oZWlnaHQpLCBhbmltYXRlZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgd2lkdGhNb2RlID0gc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGhlaWdodCA9IHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgY2hpbGQgPSB0aGlzLmxheW91dFZpZXc7XG4gICAgICAgIHRoaXMuX2NvbnRlbnRNZWFzdXJlZFdpZHRoID0gdGhpcy5lZmZlY3RpdmVNaW5XaWR0aDtcbiAgICAgICAgdGhpcy5fY29udGVudE1lYXN1cmVkSGVpZ2h0ID0gdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQ7XG4gICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgICAgdmFyIGNoaWxkU2l6ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmICh0aGlzLm9yaWVudGF0aW9uID09PSBcInZlcnRpY2FsXCIpIHtcbiAgICAgICAgICAgICAgICBjaGlsZFNpemUgPSBzY3JvbGxfdmlld19jb21tb25fMS5WaWV3Lm1lYXN1cmVDaGlsZCh0aGlzLCBjaGlsZCwgd2lkdGhNZWFzdXJlU3BlYywgc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYygwLCBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQuVU5TUEVDSUZJRUQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoaWxkU2l6ZSA9IHNjcm9sbF92aWV3X2NvbW1vbl8xLlZpZXcubWVhc3VyZUNoaWxkKHRoaXMsIGNoaWxkLCBzY3JvbGxfdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKDAsIHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC5VTlNQRUNJRklFRCksIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRNZWFzdXJlZFdpZHRoID0gTWF0aC5tYXgoY2hpbGRTaXplLm1lYXN1cmVkV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICAgICAgdGhpcy5fY29udGVudE1lYXN1cmVkSGVpZ2h0ID0gTWF0aC5tYXgoY2hpbGRTaXplLm1lYXN1cmVkSGVpZ2h0LCB0aGlzLmVmZmVjdGl2ZU1pbkhlaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBzY3JvbGxfdmlld19jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUodGhpcy5fY29udGVudE1lYXN1cmVkV2lkdGgsIHdpZHRoLCB3aWR0aE1vZGUsIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBzY3JvbGxfdmlld19jb21tb25fMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUodGhpcy5fY29udGVudE1lYXN1cmVkSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIFNjcm9sbFZpZXcucHJvdG90eXBlLm9uTGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB2YXIgaW5zZXRzID0gdGhpcy5nZXRTYWZlQXJlYUluc2V0cygpO1xuICAgICAgICB2YXIgd2lkdGggPSAocmlnaHQgLSBsZWZ0IC0gaW5zZXRzLnJpZ2h0IC0gaW5zZXRzLmxlZnQpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gKGJvdHRvbSAtIHRvcCAtIGluc2V0cy5ib3R0b20gLSBpbnNldHMudG9wKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChtYWpvclZlcnNpb24gPiAxMCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5jb250ZW50SW5zZXRBZGp1c3RtZW50QmVoYXZpb3IgPSAyO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzY3JvbGxXaWR0aCA9IHdpZHRoICsgaW5zZXRzLmxlZnQgKyBpbnNldHMucmlnaHQ7XG4gICAgICAgIHZhciBzY3JvbGxIZWlnaHQgPSBoZWlnaHQgKyBpbnNldHMudG9wICsgaW5zZXRzLmJvdHRvbTtcbiAgICAgICAgaWYgKHRoaXMub3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICAgICAgICBzY3JvbGxXaWR0aCA9IE1hdGgubWF4KHRoaXMuX2NvbnRlbnRNZWFzdXJlZFdpZHRoICsgaW5zZXRzLmxlZnQgKyBpbnNldHMucmlnaHQsIHNjcm9sbFdpZHRoKTtcbiAgICAgICAgICAgIHdpZHRoID0gTWF0aC5tYXgodGhpcy5fY29udGVudE1lYXN1cmVkV2lkdGgsIHdpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNjcm9sbEhlaWdodCA9IE1hdGgubWF4KHRoaXMuX2NvbnRlbnRNZWFzdXJlZEhlaWdodCArIGluc2V0cy50b3AgKyBpbnNldHMuYm90dG9tLCBzY3JvbGxIZWlnaHQpO1xuICAgICAgICAgICAgaGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5fY29udGVudE1lYXN1cmVkSGVpZ2h0LCBoZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIG5hdGl2ZVZpZXcuY29udGVudFNpemUgPSBDR1NpemVNYWtlKHNjcm9sbF92aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHNjcm9sbFdpZHRoKSwgc2Nyb2xsX3ZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoc2Nyb2xsSGVpZ2h0KSk7XG4gICAgICAgIHNjcm9sbF92aWV3X2NvbW1vbl8xLlZpZXcubGF5b3V0Q2hpbGQodGhpcywgdGhpcy5sYXlvdXRWaWV3LCBpbnNldHMubGVmdCwgaW5zZXRzLnRvcCwgaW5zZXRzLmxlZnQgKyB3aWR0aCwgaW5zZXRzLnRvcCArIGhlaWdodCk7XG4gICAgfTtcbiAgICBTY3JvbGxWaWV3LnByb3RvdHlwZS5fb25PcmllbnRhdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlU2Nyb2xsQmFyVmlzaWJpbGl0eSh0aGlzLnNjcm9sbEJhckluZGljYXRvclZpc2libGUpO1xuICAgIH07XG4gICAgcmV0dXJuIFNjcm9sbFZpZXc7XG59KHNjcm9sbF92aWV3X2NvbW1vbl8xLlNjcm9sbFZpZXdCYXNlKSk7XG5leHBvcnRzLlNjcm9sbFZpZXcgPSBTY3JvbGxWaWV3O1xuU2Nyb2xsVmlldy5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNjcm9sbC12aWV3Lmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBTZWFyY2hCYXJCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VhcmNoQmFyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWFyY2hCYXJCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNlYXJjaEJhckJhc2Uuc3VibWl0RXZlbnQgPSBcInN1Ym1pdFwiO1xuICAgIFNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCA9IFwiY2xlYXJcIjtcbiAgICBTZWFyY2hCYXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VhcmNoQmFyXCIpXG4gICAgXSwgU2VhcmNoQmFyQmFzZSk7XG4gICAgcmV0dXJuIFNlYXJjaEJhckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlNlYXJjaEJhckJhc2UgPSBTZWFyY2hCYXJCYXNlO1xuU2VhcmNoQmFyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyB9KTtcbmV4cG9ydHMudGV4dFByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy5oaW50UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJoaW50XCIsIGRlZmF1bHRWYWx1ZTogXCJcIiB9KTtcbmV4cG9ydHMuaGludFByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRGaWVsZEhpbnRDb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRleHRGaWVsZEhpbnRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuZXhwb3J0cy50ZXh0RmllbGRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRGaWVsZEJhY2tncm91bmRDb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRleHRGaWVsZEJhY2tncm91bmRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFNlYXJjaEJhckJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VhcmNoLWJhci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmb250XzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9mb250XCIpO1xudmFyIHNlYXJjaF9iYXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zZWFyY2gtYmFyLWNvbW1vblwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc2VhcmNoLWJhci1jb21tb25cIikpO1xudmFyIG1ham9yVmVyc2lvbiA9IHV0aWxzXzEuaW9zLk1ham9yVmVyc2lvbjtcbnZhciBVSVNlYXJjaEJhckRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gVUlTZWFyY2hCYXJEZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGU7XG4gICAgfTtcbiAgICBVSVNlYXJjaEJhckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuc2VhcmNoQmFyVGV4dERpZENoYW5nZSA9IGZ1bmN0aW9uIChzZWFyY2hCYXIsIHNlYXJjaFRleHQpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgc2VhcmNoVGV4dCk7XG4gICAgICAgIGlmIChzZWFyY2hUZXh0ID09PSBcIlwiKSB7XG4gICAgICAgICAgICBvd25lci5fZW1pdChzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5zZWFyY2hCYXJDYW5jZWxCdXR0b25DbGlja2VkID0gZnVuY3Rpb24gKHNlYXJjaEJhcikge1xuICAgICAgICBzZWFyY2hCYXIucmVzaWduRmlyc3RSZXNwb25kZXIoKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBvd25lci5fZW1pdChzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2UuY2xlYXJFdmVudCk7XG4gICAgfTtcbiAgICBVSVNlYXJjaEJhckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuc2VhcmNoQmFyU2VhcmNoQnV0dG9uQ2xpY2tlZCA9IGZ1bmN0aW9uIChzZWFyY2hCYXIpIHtcbiAgICAgICAgc2VhcmNoQmFyLnJlc2lnbkZpcnN0UmVzcG9uZGVyKCk7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgb3duZXIuX2VtaXQoc2VhcmNoX2Jhcl9jb21tb25fMS5TZWFyY2hCYXJCYXNlLnN1Ym1pdEV2ZW50KTtcbiAgICB9O1xuICAgIFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlTZWFyY2hCYXJEZWxlZ2F0ZV07XG4gICAgcmV0dXJuIFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFVJU2VhcmNoQmFySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJU2VhcmNoQmFySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVNlYXJjaEJhckltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlTZWFyY2hCYXJJbXBsLnByb3RvdHlwZS5zaXplVGhhdEZpdHMgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICBpZiAobWFqb3JWZXJzaW9uID49IDExICYmIHNpemUud2lkdGggPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgICAgICAgc2l6ZS53aWR0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuc2l6ZVRoYXRGaXRzLmNhbGwodGhpcywgc2l6ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gVUlTZWFyY2hCYXJJbXBsO1xufShVSVNlYXJjaEJhcikpO1xudmFyIFNlYXJjaEJhciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNlYXJjaEJhciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWFyY2hCYXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVUlTZWFyY2hCYXJJbXBsLm5ldygpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJU2VhcmNoQmFyRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuaW9zLmRlbGVnYXRlID0gdGhpcy5fZGVsZWdhdGU7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW9zLmRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlLmRpc21pc3NTb2Z0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW9zLnJlc2lnbkZpcnN0UmVzcG9uZGVyKCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VhcmNoQmFyLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWFyY2hCYXIucHJvdG90eXBlLCBcIl90ZXh0RmllbGRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fX3RleHRGaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX190ZXh0RmllbGQgPSB0aGlzLmlvcy52YWx1ZUZvcktleShcInNlYXJjaEZpZWxkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX190ZXh0RmllbGQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5pc0VuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQ29udHJvbCkge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5lbmFibGVkID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRleHRGaWVsZCA9IHRoaXMuX3RleHRGaWVsZDtcbiAgICAgICAgaWYgKHRleHRGaWVsZCkge1xuICAgICAgICAgICAgdGV4dEZpZWxkLmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MuYmFyVGludENvbG9yO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzZWFyY2hfYmFyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIHRoaXMuaW9zLmJhclRpbnRDb2xvciA9IGNvbG9yO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZiA9IHRoaXMuX3RleHRGaWVsZDtcbiAgICAgICAgaWYgKHNmKSB7XG4gICAgICAgICAgICByZXR1cm4gc2YudGV4dENvbG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgc2YgPSB0aGlzLl90ZXh0RmllbGQ7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2Ygc2VhcmNoX2Jhcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICBpZiAoc2YpIHtcbiAgICAgICAgICAgIHNmLnRleHRDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgc2YudGludENvbG9yID0gY29sb3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNmID0gdGhpcy5fdGV4dEZpZWxkO1xuICAgICAgICByZXR1cm4gc2YgPyBzZi5mb250IDogbnVsbDtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBzZiA9IHRoaXMuX3RleHRGaWVsZDtcbiAgICAgICAgaWYgKHNmKSB7XG4gICAgICAgICAgICBzZi5mb250ID0gdmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCA/IHZhbHVlLmdldFVJRm9udChzZi5mb250KSA6IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpID8gXCJcIiA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIHRoaXMuaW9zLnRleHQgPSB0ZXh0O1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEuaGludFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlQXR0cmlidXRlZFBsYWNlaG9sZGVyKCk7XG4gICAgfTtcbiAgICBTZWFyY2hCYXIucHJvdG90eXBlW3NlYXJjaF9iYXJfY29tbW9uXzEudGV4dEZpZWxkQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ZXh0RmllbGQgPSB0aGlzLl90ZXh0RmllbGQ7XG4gICAgICAgIGlmICh0ZXh0RmllbGQpIHtcbiAgICAgICAgICAgIHJldHVybiB0ZXh0RmllbGQuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzZWFyY2hfYmFyX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIHZhciB0ZXh0RmllbGQgPSB0aGlzLl90ZXh0RmllbGQ7XG4gICAgICAgIGlmICh0ZXh0RmllbGQpIHtcbiAgICAgICAgICAgIHRleHRGaWVsZC5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZVtzZWFyY2hfYmFyX2NvbW1vbl8xLnRleHRGaWVsZEhpbnRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFNlYXJjaEJhci5wcm90b3R5cGVbc2VhcmNoX2Jhcl9jb21tb25fMS50ZXh0RmllbGRIaW50Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUF0dHJpYnV0ZWRQbGFjZWhvbGRlcigpO1xuICAgIH07XG4gICAgU2VhcmNoQmFyLnByb3RvdHlwZS5fdXBkYXRlQXR0cmlidXRlZFBsYWNlaG9sZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RyaW5nVmFsdWUgPSB0aGlzLmhpbnQ7XG4gICAgICAgIGlmIChzdHJpbmdWYWx1ZSA9PT0gbnVsbCB8fCBzdHJpbmdWYWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZSA9IHN0cmluZ1ZhbHVlICsgXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyaW5nVmFsdWUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gXCIgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMudGV4dEZpZWxkSGludENvbG9yKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzW05TRm9yZWdyb3VuZENvbG9yQXR0cmlidXRlTmFtZV0gPSB0aGlzLnRleHRGaWVsZEhpbnRDb2xvci5pb3M7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZWRQbGFjZWhvbGRlciA9IE5TQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXRXaXRoU3RyaW5nQXR0cmlidXRlcyhzdHJpbmdWYWx1ZSwgYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMuX3RleHRGaWVsZC5hdHRyaWJ1dGVkUGxhY2Vob2xkZXIgPSBhdHRyaWJ1dGVkUGxhY2Vob2xkZXI7XG4gICAgfTtcbiAgICByZXR1cm4gU2VhcmNoQmFyO1xufShzZWFyY2hfYmFyX2NvbW1vbl8xLlNlYXJjaEJhckJhc2UpKTtcbmV4cG9ydHMuU2VhcmNoQmFyID0gU2VhcmNoQmFyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VhcmNoLWJhci5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuaXRlbXMgPSBcIml0ZW1zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIFNlZ21lbnRlZEJhckl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VnbWVudGVkQmFySXRlbUJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VnbWVudGVkQmFySXRlbUJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fdGl0bGUgPSBcIlwiO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWdtZW50ZWRCYXJJdGVtQmFzZS5wcm90b3R5cGUsIFwidGl0bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aXRsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBzdHJWYWx1ZSA9ICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSA/IHZhbHVlLnRvU3RyaW5nKCkgOiBcIlwiO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpdGxlICE9PSBzdHJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RpdGxlID0gc3RyVmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNlZ21lbnRlZEJhckl0ZW1CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VnbWVudGVkQmFySXRlbVwiKVxuICAgIF0sIFNlZ21lbnRlZEJhckl0ZW1CYXNlKTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFySXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5TZWdtZW50ZWRCYXJJdGVtQmFzZSA9IFNlZ21lbnRlZEJhckl0ZW1CYXNlO1xudmFyIFNlZ21lbnRlZEJhckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWdtZW50ZWRCYXJCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlZ21lbnRlZEJhckJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlZ21lbnRlZEJhckJhc2UucHJvdG90eXBlLCBcInNlbGVjdGVkQmFja2dyb3VuZENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5zZWxlY3RlZEJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXJCYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJTZWdtZW50ZWRCYXJJdGVtXCIpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gdmFsdWU7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICAgICAgaWYgKCFpdGVtcykge1xuICAgICAgICAgICAgICAgIGl0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICAgICAgaXRlbXMucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpc1tleHBvcnRzLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXShpdGVtcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckJhc2UucHJvdG90eXBlLm9uSXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEl0ZW1zLCBuZXdJdGVtcykge1xuICAgICAgICBpZiAob2xkSXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IG9sZEl0ZW1zLmxlbmd0aDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVWaWV3KG9sZEl0ZW1zW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3SXRlbXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBjb3VudCA9IG5ld0l0ZW1zLmxlbmd0aDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KG5ld0l0ZW1zW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhckJhc2Uuc2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudCA9IFwic2VsZWN0ZWRJbmRleENoYW5nZWRcIjtcbiAgICBTZWdtZW50ZWRCYXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2VnbWVudGVkQmFyXCIpXG4gICAgXSwgU2VnbWVudGVkQmFyQmFzZSk7XG4gICAgcmV0dXJuIFNlZ21lbnRlZEJhckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlNlZ21lbnRlZEJhckJhc2UgPSBTZWdtZW50ZWRCYXJCYXNlO1xuU2VnbWVudGVkQmFyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm5vdGlmeSh7IGV2ZW50TmFtZTogU2VnbWVudGVkQmFyQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50LCBvYmplY3Q6IHRhcmdldCwgb2xkSW5kZXg6IG9sZFZhbHVlLCBuZXdJbmRleDogbmV3VmFsdWUgfSk7XG4gICAgfSxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGFyZ2V0Lml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSBpdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnJlZ2lzdGVyKFNlZ21lbnRlZEJhckJhc2UpO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJpdGVtc1wiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25JdGVtc0NoYW5nZWQob2xkVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eS5yZWdpc3RlcihTZWdtZW50ZWRCYXJCYXNlKTtcbmV4cG9ydHMuc2VsZWN0ZWRCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoeyBuYW1lOiBcInNlbGVjdGVkQmFja2dyb3VuZENvbG9yXCIsIGNzc05hbWU6IFwic2VsZWN0ZWQtYmFja2dyb3VuZC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnNlbGVjdGVkQmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNlZ21lbnRlZC1iYXItY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgc2VnbWVudGVkX2Jhcl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3NlZ21lbnRlZC1iYXItY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc2VnbWVudGVkLWJhci1jb21tb25cIikpO1xudmFyIFNlZ21lbnRlZEJhckl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWdtZW50ZWRCYXJJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNlZ21lbnRlZEJhckl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2VnbWVudGVkQmFySXRlbS5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICB2YXIgdGFiSW5kZXggPSBwYXJlbnQuaXRlbXMuaW5kZXhPZih0aGlzKTtcbiAgICAgICAgICAgIHZhciB0aXRsZSA9IHRoaXMudGl0bGU7XG4gICAgICAgICAgICB0aXRsZSA9ICh0aXRsZSA9PT0gbnVsbCB8fCB0aXRsZSA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0aXRsZTtcbiAgICAgICAgICAgIHBhcmVudC5pb3Muc2V0VGl0bGVGb3JTZWdtZW50QXRJbmRleCh0aXRsZSwgdGFiSW5kZXgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU2VnbWVudGVkQmFySXRlbTtcbn0oc2VnbWVudGVkX2Jhcl9jb21tb25fMS5TZWdtZW50ZWRCYXJJdGVtQmFzZSkpO1xuZXhwb3J0cy5TZWdtZW50ZWRCYXJJdGVtID0gU2VnbWVudGVkQmFySXRlbTtcbnZhciBTZWdtZW50ZWRCYXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWdtZW50ZWRCYXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VnbWVudGVkQmFyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFVJU2VnbWVudGVkQ29udHJvbC5uZXcoKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fc2VsZWN0aW9uSGFuZGxlciA9IFNlbGVjdGlvbkhhbmRsZXJJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkVGFyZ2V0QWN0aW9uRm9yQ29udHJvbEV2ZW50cyh0aGlzLl9zZWxlY3Rpb25IYW5kbGVyLCBcInNlbGVjdGVkXCIsIDQwOTYpO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc2VsZWN0aW9uSGFuZGxlciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZWdtZW50ZWRCYXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW9zLnNlbGVjdGVkU2VnbWVudEluZGV4ID0gdmFsdWU7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuaXRlbXNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuaXRlbXNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBzZWdtZW50ZWRDb250cm9sID0gdGhpcy5pb3M7XG4gICAgICAgIHNlZ21lbnRlZENvbnRyb2wucmVtb3ZlQWxsU2VnbWVudHMoKTtcbiAgICAgICAgdmFyIG5ld0l0ZW1zID0gdmFsdWU7XG4gICAgICAgIGlmIChuZXdJdGVtcyAmJiBuZXdJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG5ld0l0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGluZGV4LCBhcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBpdGVtLnRpdGxlO1xuICAgICAgICAgICAgICAgIHRpdGxlID0gKHRpdGxlID09PSBudWxsIHx8IHRpdGxlID09PSB1bmRlZmluZWQpID8gXCJcIiA6IHRpdGxlO1xuICAgICAgICAgICAgICAgIHNlZ21lbnRlZENvbnRyb2wuaW5zZXJ0U2VnbWVudFdpdGhUaXRsZUF0SW5kZXhBbmltYXRlZCh0aXRsZSwgaW5kZXgsIGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHNlZ21lbnRlZF9iYXJfY29tbW9uXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5zZWxlY3RlZEJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MudGludENvbG9yO1xuICAgIH07XG4gICAgU2VnbWVudGVkQmFyLnByb3RvdHlwZVtzZWdtZW50ZWRfYmFyX2NvbW1vbl8xLnNlbGVjdGVkQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHNlZ21lbnRlZF9iYXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5pb3MudGludENvbG9yID0gY29sb3I7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2Ygc2VnbWVudGVkX2Jhcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICB2YXIgYmFyID0gdGhpcy5pb3M7XG4gICAgICAgIHZhciBjdXJyZW50QXR0cnMgPSBiYXIudGl0bGVUZXh0QXR0cmlidXRlc0ZvclN0YXRlKDApO1xuICAgICAgICB2YXIgYXR0cnMgPSBjdXJyZW50QXR0cnMgPyBjdXJyZW50QXR0cnMubXV0YWJsZUNvcHkoKSA6IE5TTXV0YWJsZURpY3Rpb25hcnkubmV3KCk7XG4gICAgICAgIGF0dHJzLnNldFZhbHVlRm9yS2V5KGNvbG9yLCBOU0ZvcmVncm91bmRDb2xvckF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBiYXIuc2V0VGl0bGVUZXh0QXR0cmlidXRlc0ZvclN0YXRlKGF0dHJzLCAwKTtcbiAgICB9O1xuICAgIFNlZ21lbnRlZEJhci5wcm90b3R5cGVbc2VnbWVudGVkX2Jhcl9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTZWdtZW50ZWRCYXIucHJvdG90eXBlW3NlZ21lbnRlZF9iYXJfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgZm9udCA9IHZhbHVlID8gdmFsdWUuZ2V0VUlGb250KFVJRm9udC5zeXN0ZW1Gb250T2ZTaXplKFVJRm9udC5sYWJlbEZvbnRTaXplKSkgOiBudWxsO1xuICAgICAgICB2YXIgYmFyID0gdGhpcy5pb3M7XG4gICAgICAgIHZhciBjdXJyZW50QXR0cnMgPSBiYXIudGl0bGVUZXh0QXR0cmlidXRlc0ZvclN0YXRlKDApO1xuICAgICAgICB2YXIgYXR0cnMgPSBjdXJyZW50QXR0cnMgPyBjdXJyZW50QXR0cnMubXV0YWJsZUNvcHkoKSA6IE5TTXV0YWJsZURpY3Rpb25hcnkubmV3KCk7XG4gICAgICAgIGF0dHJzLnNldFZhbHVlRm9yS2V5KGZvbnQsIE5TRm9udEF0dHJpYnV0ZU5hbWUpO1xuICAgICAgICBiYXIuc2V0VGl0bGVUZXh0QXR0cmlidXRlc0ZvclN0YXRlKGF0dHJzLCAwKTtcbiAgICB9O1xuICAgIHJldHVybiBTZWdtZW50ZWRCYXI7XG59KHNlZ21lbnRlZF9iYXJfY29tbW9uXzEuU2VnbWVudGVkQmFyQmFzZSkpO1xuZXhwb3J0cy5TZWdtZW50ZWRCYXIgPSBTZWdtZW50ZWRCYXI7XG52YXIgU2VsZWN0aW9uSGFuZGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWxlY3Rpb25IYW5kbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWxlY3Rpb25IYW5kbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTZWxlY3Rpb25IYW5kbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gU2VsZWN0aW9uSGFuZGxlckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgU2VsZWN0aW9uSGFuZGxlckltcGwucHJvdG90eXBlLnNlbGVjdGVkID0gZnVuY3Rpb24gKHNlbmRlcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5zZWxlY3RlZEluZGV4ID0gc2VuZGVyLnNlbGVjdGVkU2VnbWVudEluZGV4O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWxlY3Rpb25IYW5kbGVySW1wbC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwic2VsZWN0ZWRcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW1VJU2VnbWVudGVkQ29udHJvbF0gfVxuICAgIH07XG4gICAgcmV0dXJuIFNlbGVjdGlvbkhhbmRsZXJJbXBsO1xufShOU09iamVjdCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2VnbWVudGVkLWJhci5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgU2xpZGVyQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNsaWRlckJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2xpZGVyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTbGlkZXJCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU2xpZGVyXCIpXG4gICAgXSwgU2xpZGVyQmFzZSk7XG4gICAgcmV0dXJuIFNsaWRlckJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlNsaWRlckJhc2UgPSBTbGlkZXJCYXNlO1xuU2xpZGVyQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMudmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ29lcmNpYmxlUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidmFsdWVcIiwgZGVmYXVsdFZhbHVlOiAwLCBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBNYXRoLm1heCh2YWx1ZSwgdGFyZ2V0Lm1pblZhbHVlKTtcbiAgICAgICAgdmFsdWUgPSBNYXRoLm1pbih2YWx1ZSwgdGFyZ2V0Lm1heFZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdmlld18xLmlzSU9TID8gcGFyc2VGbG9hdCh2KSA6IHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMudmFsdWVQcm9wZXJ0eS5yZWdpc3RlcihTbGlkZXJCYXNlKTtcbmV4cG9ydHMubWluVmFsdWVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluVmFsdWVcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBleHBvcnRzLm1heFZhbHVlUHJvcGVydHkuY29lcmNlKHRhcmdldCk7XG4gICAgICAgIGV4cG9ydHMudmFsdWVQcm9wZXJ0eS5jb2VyY2UodGFyZ2V0KTtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHZpZXdfMS5pc0lPUyA/IHBhcnNlRmxvYXQodikgOiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1pblZhbHVlUHJvcGVydHkucmVnaXN0ZXIoU2xpZGVyQmFzZSk7XG5leHBvcnRzLm1heFZhbHVlUHJvcGVydHkgPSBuZXcgdmlld18xLkNvZXJjaWJsZVByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heFZhbHVlXCIsIGRlZmF1bHRWYWx1ZTogMTAwLCBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIG1pblZhbHVlID0gdGFyZ2V0Lm1pblZhbHVlO1xuICAgICAgICBpZiAodmFsdWUgPCBtaW5WYWx1ZSkge1xuICAgICAgICAgICAgdmFsdWUgPSBtaW5WYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkgeyByZXR1cm4gZXhwb3J0cy52YWx1ZVByb3BlcnR5LmNvZXJjZSh0YXJnZXQpOyB9LFxuICAgIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gdmlld18xLmlzSU9TID8gcGFyc2VGbG9hdCh2KSA6IHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWF4VmFsdWVQcm9wZXJ0eS5yZWdpc3RlcihTbGlkZXJCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNsaWRlci1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzbGlkZXJfY29tbW9uXzEgPSByZXF1aXJlKFwiLi9zbGlkZXItY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vc2xpZGVyLWNvbW1vblwiKSk7XG52YXIgU2xpZGVyQ2hhbmdlSGFuZGxlckltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTbGlkZXJDaGFuZ2VIYW5kbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTbGlkZXJDaGFuZ2VIYW5kbGVySW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTbGlkZXJDaGFuZ2VIYW5kbGVySW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gU2xpZGVyQ2hhbmdlSGFuZGxlckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgU2xpZGVyQ2hhbmdlSGFuZGxlckltcGwucHJvdG90eXBlLnNsaWRlclZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChzZW5kZXIpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgc2xpZGVyX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIHNlbmRlci52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNsaWRlckNoYW5nZUhhbmRsZXJJbXBsLk9iakNFeHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgICAgXCJzbGlkZXJWYWx1ZUNoYW5nZWRcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW1VJU2xpZGVyXSB9XG4gICAgfTtcbiAgICByZXR1cm4gU2xpZGVyQ2hhbmdlSGFuZGxlckltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgU2xpZGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2xpZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNsaWRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTbGlkZXIucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSVNsaWRlci5uZXcoKTtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIG5hdGl2ZVZpZXcubWluaW11bVZhbHVlID0gMDtcbiAgICAgICAgbmF0aXZlVmlldy5tYXhpbXVtVmFsdWUgPSB0aGlzLm1heFZhbHVlO1xuICAgICAgICB0aGlzLl9jaGFuZ2VIYW5kbGVyID0gU2xpZGVyQ2hhbmdlSGFuZGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVGFyZ2V0QWN0aW9uRm9yQ29udHJvbEV2ZW50cyh0aGlzLl9jaGFuZ2VIYW5kbGVyLCBcInNsaWRlclZhbHVlQ2hhbmdlZFwiLCA0MDk2KTtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NoYW5nZUhhbmRsZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2xpZGVyLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLnZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEudmFsdWVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaW9zLnZhbHVlID0gdmFsdWU7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5taW5WYWx1ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLm1pblZhbHVlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLmlvcy5taW5pbXVtVmFsdWUgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLm1heFZhbHVlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAxMDA7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5tYXhWYWx1ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5pb3MubWF4aW11bVZhbHVlID0gdmFsdWU7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MudGh1bWJUaW50Q29sb3I7XG4gICAgfTtcbiAgICBTbGlkZXIucHJvdG90eXBlW3NsaWRlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzbGlkZXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5pb3MudGh1bWJUaW50Q29sb3IgPSBjb2xvcjtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MubWluaW11bVRyYWNrVGludENvbG9yO1xuICAgIH07XG4gICAgU2xpZGVyLnByb3RvdHlwZVtzbGlkZXJfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHNsaWRlcl9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICB0aGlzLmlvcy5taW5pbXVtVHJhY2tUaW50Q29sb3IgPSBjb2xvcjtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFNsaWRlci5wcm90b3R5cGVbc2xpZGVyX2NvbW1vbl8xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIHJldHVybiBTbGlkZXI7XG59KHNsaWRlcl9jb21tb25fMS5TbGlkZXJCYXNlKSk7XG5leHBvcnRzLlNsaWRlciA9IFNsaWRlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNsaWRlci5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgQmFja2dyb3VuZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmFja2dyb3VuZCgpIHtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyUmlnaHRXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tV2lkdGggPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckxlZnRXaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSAwO1xuICAgICAgICB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gMDtcbiAgICB9XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IG5ldyBCYWNrZ3JvdW5kKCk7XG4gICAgICAgIGNsb25lLmNvbG9yID0gdGhpcy5jb2xvcjtcbiAgICAgICAgY2xvbmUuaW1hZ2UgPSB0aGlzLmltYWdlO1xuICAgICAgICBjbG9uZS5yZXBlYXQgPSB0aGlzLnJlcGVhdDtcbiAgICAgICAgY2xvbmUucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uO1xuICAgICAgICBjbG9uZS5zaXplID0gdGhpcy5zaXplO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BDb2xvciA9IHRoaXMuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0Q29sb3IgPSB0aGlzLmJvcmRlclJpZ2h0Q29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUNvbG9yID0gdGhpcy5ib3JkZXJCb3R0b21Db2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyTGVmdENvbG9yID0gdGhpcy5ib3JkZXJMZWZ0Q29sb3I7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcFdpZHRoID0gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyUmlnaHRXaWR0aCA9IHRoaXMuYm9yZGVyUmlnaHRXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tV2lkdGggPSB0aGlzLmJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0V2lkdGggPSB0aGlzLmJvcmRlckxlZnRXaWR0aDtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wTGVmdFJhZGl1cyA9IHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cztcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSB0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyA9IHRoaXMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgICAgIGNsb25lLmNsaXBQYXRoID0gdGhpcy5jbGlwUGF0aDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuY29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEltYWdlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuaW1hZ2UgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aFJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnJlcGVhdCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoUG9zaXRpb24gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5wb3NpdGlvbiA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoU2l6ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnNpemUgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclJpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodENvbG9yID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21Db2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbUNvbG9yID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJMZWZ0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcFdpZHRoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclJpZ2h0V2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21XaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVdpZHRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJMZWZ0V2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcExlZnRSYWRpdXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJUb3BSaWdodFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21SaWdodFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhCb3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQ2xpcFBhdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5jbGlwUGF0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5pc0VtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuY29sb3JcbiAgICAgICAgICAgICYmICF0aGlzLmltYWdlXG4gICAgICAgICAgICAmJiAhdGhpcy5oYXNCb3JkZXJXaWR0aCgpXG4gICAgICAgICAgICAmJiAhdGhpcy5oYXNCb3JkZXJSYWRpdXMoKVxuICAgICAgICAgICAgJiYgIXRoaXMuY2xpcFBhdGg7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLmVxdWFscyA9IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAoIXZhbHVlMSAmJiAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGltYWdlc0VxdWFsID0gZmFsc2U7XG4gICAgICAgIGlmICh2YWx1ZTEgaW5zdGFuY2VvZiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudCAmJiB2YWx1ZTIgaW5zdGFuY2VvZiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgaW1hZ2VzRXF1YWwgPSBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5lcXVhbHModmFsdWUxLCB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaW1hZ2VzRXF1YWwgPSB2YWx1ZTEuaW1hZ2UgPT09IHZhbHVlMi5pbWFnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmNvbG9yLCB2YWx1ZTIuY29sb3IpXG4gICAgICAgICAgICAmJiBpbWFnZXNFcXVhbFxuICAgICAgICAgICAgJiYgdmFsdWUxLnBvc2l0aW9uID09PSB2YWx1ZTIucG9zaXRpb25cbiAgICAgICAgICAgICYmIHZhbHVlMS5yZXBlYXQgPT09IHZhbHVlMi5yZXBlYXRcbiAgICAgICAgICAgICYmIHZhbHVlMS5zaXplID09PSB2YWx1ZTIuc2l6ZVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmJvcmRlclRvcENvbG9yLCB2YWx1ZTIuYm9yZGVyVG9wQ29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyUmlnaHRDb2xvciwgdmFsdWUyLmJvcmRlclJpZ2h0Q29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyQm90dG9tQ29sb3IsIHZhbHVlMi5ib3JkZXJCb3R0b21Db2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJMZWZ0Q29sb3IsIHZhbHVlMi5ib3JkZXJMZWZ0Q29sb3IpXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wV2lkdGggPT09IHZhbHVlMi5ib3JkZXJUb3BXaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlclJpZ2h0V2lkdGggPT09IHZhbHVlMi5ib3JkZXJSaWdodFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyQm90dG9tV2lkdGggPT09IHZhbHVlMi5ib3JkZXJCb3R0b21XaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckxlZnRXaWR0aCA9PT0gdmFsdWUyLmJvcmRlckxlZnRXaWR0aFxuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJUb3BMZWZ0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJUb3BSaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID09PSB2YWx1ZTIuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID09PSB2YWx1ZTIuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmNsaXBQYXRoID09PSB2YWx1ZTIuY2xpcFBhdGg7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNCb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5ib3JkZXJUb3BDb2xvciB8fCAhIXRoaXMuYm9yZGVyUmlnaHRDb2xvciB8fCAhIXRoaXMuYm9yZGVyQm90dG9tQ29sb3IgfHwgISF0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyUmlnaHRXaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyQm90dG9tV2lkdGggPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlckxlZnRXaWR0aCA+IDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNCb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA+IDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlclJpZ2h0Q29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckJvdHRvbUNvbG9yKVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJMZWZ0Q29sb3IpO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzVW5pZm9ybUJvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aCA9PT0gdGhpcy5ib3JkZXJSaWdodFdpZHRoXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlckJvdHRvbVdpZHRoXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlckxlZnRXaWR0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXNcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID09PSB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYXNVbmlmb3JtQm9yZGVyQ29sb3IoKVxuICAgICAgICAgICAgJiYgdGhpcy5oYXNVbmlmb3JtQm9yZGVyV2lkdGgoKVxuICAgICAgICAgICAgJiYgdGhpcy5oYXNVbmlmb3JtQm9yZGVyUmFkaXVzKCk7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJDb2xvcigpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuZ2V0VW5pZm9ybUJvcmRlcldpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNVbmlmb3JtQm9yZGVyV2lkdGgoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyUmFkaXVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNVbmlmb3JtQm9yZGVyUmFkaXVzKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiaXNFbXB0eTogXCIgKyB0aGlzLmlzRW1wdHkoKSArIFwiOyBjb2xvcjogXCIgKyB0aGlzLmNvbG9yICsgXCI7IGltYWdlOiBcIiArIHRoaXMuaW1hZ2UgKyBcIjsgcmVwZWF0OiBcIiArIHRoaXMucmVwZWF0ICsgXCI7IHBvc2l0aW9uOiBcIiArIHRoaXMucG9zaXRpb24gKyBcIjsgc2l6ZTogXCIgKyB0aGlzLnNpemUgKyBcIjsgYm9yZGVyVG9wQ29sb3I6IFwiICsgdGhpcy5ib3JkZXJUb3BDb2xvciArIFwiOyBib3JkZXJSaWdodENvbG9yOiBcIiArIHRoaXMuYm9yZGVyUmlnaHRDb2xvciArIFwiOyBib3JkZXJCb3R0b21Db2xvcjogXCIgKyB0aGlzLmJvcmRlckJvdHRvbUNvbG9yICsgXCI7IGJvcmRlckxlZnRDb2xvcjogXCIgKyB0aGlzLmJvcmRlckxlZnRDb2xvciArIFwiOyBib3JkZXJUb3BXaWR0aDogXCIgKyB0aGlzLmJvcmRlclRvcFdpZHRoICsgXCI7IGJvcmRlclJpZ2h0V2lkdGg6IFwiICsgdGhpcy5ib3JkZXJSaWdodFdpZHRoICsgXCI7IGJvcmRlckJvdHRvbVdpZHRoOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tV2lkdGggKyBcIjsgYm9yZGVyTGVmdFdpZHRoOiBcIiArIHRoaXMuYm9yZGVyTGVmdFdpZHRoICsgXCI7IGJvcmRlclRvcExlZnRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzICsgXCI7IGJvcmRlclRvcFJpZ2h0UmFkaXVzOiBcIiArIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgKyBcIjsgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cyArIFwiOyBib3JkZXJCb3R0b21MZWZ0UmFkaXVzOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyArIFwiOyBjbGlwUGF0aDogXCIgKyB0aGlzLmNsaXBQYXRoICsgXCI7XCI7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLmRlZmF1bHQgPSBuZXcgQmFja2dyb3VuZCgpO1xuICAgIHJldHVybiBCYWNrZ3JvdW5kO1xufSgpKTtcbmV4cG9ydHMuQmFja2dyb3VuZCA9IEJhY2tncm91bmQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYWNrZ3JvdW5kLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG52YXIgY3NzX3ZhbHVlXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzLXZhbHVlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vYmFja2dyb3VuZC1jb21tb25cIikpO1xudmFyIGNsZWFyQ0dDb2xvciA9IFVJQ29sb3IuY2xlYXJDb2xvci5DR0NvbG9yO1xudmFyIHN5bWJvbFVybCA9IFN5bWJvbChcImJhY2tncm91bmRJbWFnZVVybFwiKTtcbnZhciBpb3M7XG4oZnVuY3Rpb24gKGlvcykge1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJhY2tncm91bmRVSUNvbG9yKHZpZXcsIGNhbGxiYWNrLCBmbGlwKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdmlldy5zdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldy5oYXNOb25Vbmlmb3JtQm9yZGVyKSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZUZyb21TY3JvbGxOb3RpZmljYXRpb25zKHZpZXcpO1xuICAgICAgICAgICAgY2xlYXJOb25Vbmlmb3JtQm9yZGVycyhuYXRpdmVWaWV3KTtcbiAgICAgICAgfVxuICAgICAgICBjbGVhckdyYWRpZW50KG5hdGl2ZVZpZXcpO1xuICAgICAgICBpZiAoYmFja2dyb3VuZC5pbWFnZSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICBkcmF3R3JhZGllbnQobmF0aXZlVmlldywgYmFja2dyb3VuZC5pbWFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhc05vblVuaWZvcm1Cb3JkZXJXaWR0aHMgPSBiYWNrZ3JvdW5kLmhhc0JvcmRlcldpZHRoKCkgJiYgIWJhY2tncm91bmQuaGFzVW5pZm9ybUJvcmRlcigpO1xuICAgICAgICB2YXIgaGFzTm9uVW5pZm9ybUJvcmRlclJhZGl1c2VzID0gYmFja2dyb3VuZC5oYXNCb3JkZXJSYWRpdXMoKSAmJiAhYmFja2dyb3VuZC5oYXNVbmlmb3JtQm9yZGVyUmFkaXVzKCk7XG4gICAgICAgIGlmIChiYWNrZ3JvdW5kLmhhc1VuaWZvcm1Cb3JkZXJDb2xvcigpICYmIChoYXNOb25Vbmlmb3JtQm9yZGVyV2lkdGhzIHx8IGhhc05vblVuaWZvcm1Cb3JkZXJSYWRpdXNlcykpIHtcbiAgICAgICAgICAgIGRyYXdVbmlmb3JtQ29sb3JOb25Vbmlmb3JtQm9yZGVycyhuYXRpdmVWaWV3LCBiYWNrZ3JvdW5kKTtcbiAgICAgICAgICAgIHN1YnNjcmliZUZvclNjcm9sbE5vdGlmaWNhdGlvbnModmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYmFja2dyb3VuZC5oYXNVbmlmb3JtQm9yZGVyKCkpIHtcbiAgICAgICAgICAgIHZhciBsYXllciA9IG5hdGl2ZVZpZXcubGF5ZXI7XG4gICAgICAgICAgICB2YXIgYm9yZGVyQ29sb3IgPSBiYWNrZ3JvdW5kLmdldFVuaWZvcm1Cb3JkZXJDb2xvcigpO1xuICAgICAgICAgICAgbGF5ZXIuYm9yZGVyQ29sb3IgPSAhYm9yZGVyQ29sb3IgPyB1bmRlZmluZWQgOiBib3JkZXJDb2xvci5pb3MuQ0dDb2xvcjtcbiAgICAgICAgICAgIGxheWVyLmJvcmRlcldpZHRoID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmdldFVuaWZvcm1Cb3JkZXJXaWR0aCgpKTtcbiAgICAgICAgICAgIHZhciByZW5kZXJTaXplID0gdmlldy5nZXRBY3R1YWxTaXplKCkgfHwgeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH07XG4gICAgICAgICAgICB2YXIgY29ybmVyUmFkaXVzID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmdldFVuaWZvcm1Cb3JkZXJSYWRpdXMoKSk7XG4gICAgICAgICAgICBsYXllci5jb3JuZXJSYWRpdXMgPSBNYXRoLm1pbihNYXRoLm1pbihyZW5kZXJTaXplLndpZHRoIC8gMiwgcmVuZGVyU2l6ZS5oZWlnaHQgLyAyKSwgY29ybmVyUmFkaXVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRyYXdOb1JhZGl1c05vblVuaWZvcm1Cb3JkZXJzKG5hdGl2ZVZpZXcsIGJhY2tncm91bmQpO1xuICAgICAgICAgICAgc3Vic2NyaWJlRm9yU2Nyb2xsTm90aWZpY2F0aW9ucyh2aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYmFja2dyb3VuZC5jbGlwUGF0aCkge1xuICAgICAgICAgICAgZHJhd0NsaXBQYXRoKG5hdGl2ZVZpZXcsIGJhY2tncm91bmQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYmFja2dyb3VuZC5pbWFnZSB8fCBiYWNrZ3JvdW5kLmltYWdlIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQpIHtcbiAgICAgICAgICAgIHZhciB1aUNvbG9yID0gYmFja2dyb3VuZC5jb2xvciA/IGJhY2tncm91bmQuY29sb3IuaW9zIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgY2FsbGJhY2sodWlDb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXRVSUNvbG9yRnJvbUltYWdlKHZpZXcsIG5hdGl2ZVZpZXcsIGNhbGxiYWNrLCBmbGlwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpb3MuY3JlYXRlQmFja2dyb3VuZFVJQ29sb3IgPSBjcmVhdGVCYWNrZ3JvdW5kVUlDb2xvcjtcbn0pKGlvcyA9IGV4cG9ydHMuaW9zIHx8IChleHBvcnRzLmlvcyA9IHt9KSk7XG5mdW5jdGlvbiBvblNjcm9sbChhcmdzKSB7XG4gICAgdmFyIHZpZXcgPSBhcmdzLm9iamVjdDtcbiAgICB2YXIgbmF0aXZlVmlldyA9IHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJU2Nyb2xsVmlldykge1xuICAgICAgICBhZGp1c3RMYXllcnNGb3JTY3JvbGxWaWV3KG5hdGl2ZVZpZXcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkanVzdExheWVyc0ZvclNjcm9sbFZpZXcobmF0aXZlVmlldykge1xuICAgIHZhciBsYXllciA9IG5hdGl2ZVZpZXcuYm9yZGVyTGF5ZXI7XG4gICAgaWYgKGxheWVyIGluc3RhbmNlb2YgQ0FMYXllcikge1xuICAgICAgICBDQVRyYW5zYWN0aW9uLmJlZ2luKCk7XG4gICAgICAgIENBVHJhbnNhY3Rpb24uc2V0VmFsdWVGb3JLZXkoa0NGQm9vbGVhblRydWUsIGtDQVRyYW5zYWN0aW9uRGlzYWJsZUFjdGlvbnMpO1xuICAgICAgICB2YXIgb2Zmc2V0ID0gbmF0aXZlVmlldy5jb250ZW50T2Zmc2V0O1xuICAgICAgICB2YXIgdHJhbnNmb3JtID0geyBhOiAxLCBiOiAwLCBjOiAwLCBkOiAxLCB0eDogb2Zmc2V0LngsIHR5OiBvZmZzZXQueSB9O1xuICAgICAgICBsYXllci5zZXRBZmZpbmVUcmFuc2Zvcm0odHJhbnNmb3JtKTtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcubGF5ZXIubWFzaykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5tYXNrLnNldEFmZmluZVRyYW5zZm9ybSh0cmFuc2Zvcm0pO1xuICAgICAgICB9XG4gICAgICAgIENBVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdW5zdWJzY3JpYmVGcm9tU2Nyb2xsTm90aWZpY2F0aW9ucyh2aWV3KSB7XG4gICAgaWYgKHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJU2Nyb2xsVmlldykge1xuICAgICAgICB2aWV3Lm9mZihcInNjcm9sbFwiLCBvblNjcm9sbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gc3Vic2NyaWJlRm9yU2Nyb2xsTm90aWZpY2F0aW9ucyh2aWV3KSB7XG4gICAgaWYgKHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJU2Nyb2xsVmlldykge1xuICAgICAgICB2aWV3Lm9uKFwic2Nyb2xsXCIsIG9uU2Nyb2xsKTtcbiAgICAgICAgYWRqdXN0TGF5ZXJzRm9yU2Nyb2xsVmlldyh2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsZWFyTm9uVW5pZm9ybUJvcmRlcnMobmF0aXZlVmlldykge1xuICAgIGlmIChuYXRpdmVWaWV3LmJvcmRlckxheWVyKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm9yZGVyTGF5ZXIucmVtb3ZlRnJvbVN1cGVybGF5ZXIoKTtcbiAgICB9XG4gICAgaWYgKG5hdGl2ZVZpZXcuaGFzQm9yZGVyTWFzaykge1xuICAgICAgICBuYXRpdmVWaWV3LmxheWVyLm1hc2sgPSBuYXRpdmVWaWV3LmJvcmRlck9yaWdpbmFsTWFzaztcbiAgICAgICAgbmF0aXZlVmlldy5oYXNCb3JkZXJNYXNrID0gZmFsc2U7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm9yZGVyT3JpZ2luYWxNYXNrID0gbnVsbDtcbiAgICB9XG4gICAgaWYgKG5hdGl2ZVZpZXcudG9wQm9yZGVyTGF5ZXIpIHtcbiAgICAgICAgbmF0aXZlVmlldy50b3BCb3JkZXJMYXllci5yZW1vdmVGcm9tU3VwZXJsYXllcigpO1xuICAgIH1cbiAgICBpZiAobmF0aXZlVmlldy5yaWdodEJvcmRlckxheWVyKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcucmlnaHRCb3JkZXJMYXllci5yZW1vdmVGcm9tU3VwZXJsYXllcigpO1xuICAgIH1cbiAgICBpZiAobmF0aXZlVmlldy5ib3R0b21Cb3JkZXJMYXllcikge1xuICAgICAgICBuYXRpdmVWaWV3LmJvdHRvbUJvcmRlckxheWVyLnJlbW92ZUZyb21TdXBlcmxheWVyKCk7XG4gICAgfVxuICAgIGlmIChuYXRpdmVWaWV3LmxlZnRCb3JkZXJMYXllcikge1xuICAgICAgICBuYXRpdmVWaWV3LmxlZnRCb3JkZXJMYXllci5yZW1vdmVGcm9tU3VwZXJsYXllcigpO1xuICAgIH1cbn1cbnZhciBwYXR0ZXJuID0gL3VybFxcKCgnfFwiKSguKj8pXFwxXFwpLztcbmZ1bmN0aW9uIHNldFVJQ29sb3JGcm9tSW1hZ2UodmlldywgbmF0aXZlVmlldywgY2FsbGJhY2ssIGZsaXApIHtcbiAgICB2YXIgZnJhbWUgPSBuYXRpdmVWaWV3LmZyYW1lO1xuICAgIHZhciBib3VuZHNXaWR0aCA9IHZpZXcuc2NhbGVYID8gZnJhbWUuc2l6ZS53aWR0aCAvIHZpZXcuc2NhbGVYIDogZnJhbWUuc2l6ZS53aWR0aDtcbiAgICB2YXIgYm91bmRzSGVpZ2h0ID0gdmlldy5zY2FsZVkgPyBmcmFtZS5zaXplLmhlaWdodCAvIHZpZXcuc2NhbGVZIDogZnJhbWUuc2l6ZS5oZWlnaHQ7XG4gICAgaWYgKCFib3VuZHNXaWR0aCB8fCAhYm91bmRzSGVpZ2h0KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgdmFyIGJhY2tncm91bmQgPSBzdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgdmFyIGltYWdlVXJpID0gYmFja2dyb3VuZC5pbWFnZTtcbiAgICBpZiAoaW1hZ2VVcmkpIHtcbiAgICAgICAgdmFyIG1hdGNoID0gaW1hZ2VVcmkubWF0Y2gocGF0dGVybik7XG4gICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsyXSkge1xuICAgICAgICAgICAgaW1hZ2VVcmkgPSBtYXRjaFsyXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgYml0bWFwO1xuICAgIGlmICh1dGlsc18xLmlzRGF0YVVSSShpbWFnZVVyaSkpIHtcbiAgICAgICAgdmFyIGJhc2U2NERhdGEgPSBpbWFnZVVyaS5zcGxpdChcIixcIilbMV07XG4gICAgICAgIGlmIChiYXNlNjREYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZVNvdXJjZSA9IGltYWdlX3NvdXJjZV8xLmZyb21CYXNlNjQoYmFzZTY0RGF0YSk7XG4gICAgICAgICAgICBiaXRtYXAgPSBpbWFnZVNvdXJjZSAmJiBpbWFnZVNvdXJjZS5pb3M7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAodXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aChpbWFnZVVyaSkpIHtcbiAgICAgICAgdmFyIGltYWdlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGltYWdlVXJpKTtcbiAgICAgICAgYml0bWFwID0gaW1hZ2VTb3VyY2UgJiYgaW1hZ2VTb3VyY2UuaW9zO1xuICAgIH1cbiAgICBlbHNlIGlmIChpbWFnZVVyaS5pbmRleE9mKFwiaHR0cFwiKSAhPT0gLTEpIHtcbiAgICAgICAgc3R5bGVbc3ltYm9sVXJsXSA9IGltYWdlVXJpO1xuICAgICAgICBpbWFnZV9zb3VyY2VfMS5mcm9tVXJsKGltYWdlVXJpKS50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICBpZiAoc3R5bGUgJiYgc3R5bGVbc3ltYm9sVXJsXSA9PT0gaW1hZ2VVcmkpIHtcbiAgICAgICAgICAgICAgICB1aUNvbG9yRnJvbUltYWdlKHIuaW9zLCB2aWV3LCBjYWxsYmFjaywgZmxpcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICB1aUNvbG9yRnJvbUltYWdlKGJpdG1hcCwgdmlldywgY2FsbGJhY2ssIGZsaXApO1xufVxuZnVuY3Rpb24gcGFyc2VQb3NpdGlvbihwb3MpIHtcbiAgICB2YXIgdmFsdWVzID0gY3NzX3ZhbHVlXzEucGFyc2UocG9zKTtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMikge1xuICAgICAgICByZXR1cm4geyB4OiB2YWx1ZXNbMF0sIHk6IHZhbHVlc1sxXSB9O1xuICAgIH1cbiAgICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMSAmJiB2YWx1ZXNbMF0udHlwZSA9PT0gXCJpZGVudFwiKSB7XG4gICAgICAgIHZhciB2YWwgPSB2YWx1ZXNbMF0uc3RyaW5nLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBjZW50ZXIgPSB7IHR5cGU6IFwiaWRlbnRcIiwgc3RyaW5nOiBcImNlbnRlclwiIH07XG4gICAgICAgIGlmICh2YWwgPT09IFwibGVmdFwiIHx8IHZhbCA9PT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICByZXR1cm4geyB4OiB2YWx1ZXNbMF0sIHk6IGNlbnRlciB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbCA9PT0gXCJ0b3BcIiB8fCB2YWwgPT09IFwiYm90dG9tXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHg6IGNlbnRlciwgeTogdmFsdWVzWzBdIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4geyB4OiBjZW50ZXIsIHk6IGNlbnRlciB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gZ2V0RHJhd1BhcmFtcyhpbWFnZSwgYmFja2dyb3VuZCwgd2lkdGgsIGhlaWdodCkge1xuICAgIGlmICghaW1hZ2UpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciByZXMgPSB7XG4gICAgICAgIHJlcGVhdFg6IHRydWUsXG4gICAgICAgIHJlcGVhdFk6IHRydWUsXG4gICAgICAgIHBvc1g6IDAsXG4gICAgICAgIHBvc1k6IDAsXG4gICAgfTtcbiAgICBpZiAoYmFja2dyb3VuZC5yZXBlYXQpIHtcbiAgICAgICAgc3dpdGNoIChiYWNrZ3JvdW5kLnJlcGVhdC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgICAgICBjYXNlIFwibm8tcmVwZWF0XCI6XG4gICAgICAgICAgICAgICAgcmVzLnJlcGVhdFggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXMucmVwZWF0WSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJlcGVhdC14XCI6XG4gICAgICAgICAgICAgICAgcmVzLnJlcGVhdFkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyZXBlYXQteVwiOlxuICAgICAgICAgICAgICAgIHJlcy5yZXBlYXRYID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIGltYWdlU2l6ZSA9IGltYWdlLnNpemU7XG4gICAgdmFyIGltYWdlV2lkdGggPSBpbWFnZVNpemUud2lkdGg7XG4gICAgdmFyIGltYWdlSGVpZ2h0ID0gaW1hZ2VTaXplLmhlaWdodDtcbiAgICB2YXIgc2l6ZSA9IGJhY2tncm91bmQuc2l6ZTtcbiAgICBpZiAoc2l6ZSkge1xuICAgICAgICB2YXIgdmFsdWVzID0gY3NzX3ZhbHVlXzEucGFyc2Uoc2l6ZSk7XG4gICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB2YXIgdnggPSB2YWx1ZXNbMF07XG4gICAgICAgICAgICB2YXIgdnkgPSB2YWx1ZXNbMV07XG4gICAgICAgICAgICBpZiAodngudW5pdCA9PT0gXCIlXCIgJiYgdnkudW5pdCA9PT0gXCIlXCIpIHtcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoID0gd2lkdGggKiB2eC52YWx1ZSAvIDEwMDtcbiAgICAgICAgICAgICAgICBpbWFnZUhlaWdodCA9IGhlaWdodCAqIHZ5LnZhbHVlIC8gMTAwO1xuICAgICAgICAgICAgICAgIHJlcy5zaXplWCA9IGltYWdlV2lkdGg7XG4gICAgICAgICAgICAgICAgcmVzLnNpemVZID0gaW1hZ2VIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2eC50eXBlID09PSBcIm51bWJlclwiICYmIHZ5LnR5cGUgPT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgICAgICAgICAoKHZ4LnVuaXQgPT09IFwicHhcIiAmJiB2eS51bml0ID09PSBcInB4XCIpIHx8ICh2eC51bml0ID09PSBcIlwiICYmIHZ5LnVuaXQgPT09IFwiXCIpKSkge1xuICAgICAgICAgICAgICAgIGltYWdlV2lkdGggPSB2eC52YWx1ZTtcbiAgICAgICAgICAgICAgICBpbWFnZUhlaWdodCA9IHZ5LnZhbHVlO1xuICAgICAgICAgICAgICAgIHJlcy5zaXplWCA9IGltYWdlV2lkdGg7XG4gICAgICAgICAgICAgICAgcmVzLnNpemVZID0gaW1hZ2VIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMSAmJiB2YWx1ZXNbMF0udHlwZSA9PT0gXCJpZGVudFwiKSB7XG4gICAgICAgICAgICB2YXIgc2NhbGUgPSAwO1xuICAgICAgICAgICAgaWYgKHZhbHVlc1swXS5zdHJpbmcgPT09IFwiY292ZXJcIikge1xuICAgICAgICAgICAgICAgIHNjYWxlID0gTWF0aC5tYXgod2lkdGggLyBpbWFnZVdpZHRoLCBoZWlnaHQgLyBpbWFnZUhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZXNbMF0uc3RyaW5nID09PSBcImNvbnRhaW5cIikge1xuICAgICAgICAgICAgICAgIHNjYWxlID0gTWF0aC5taW4od2lkdGggLyBpbWFnZVdpZHRoLCBoZWlnaHQgLyBpbWFnZUhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2NhbGUgPiAwKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VXaWR0aCAqPSBzY2FsZTtcbiAgICAgICAgICAgICAgICBpbWFnZUhlaWdodCAqPSBzY2FsZTtcbiAgICAgICAgICAgICAgICByZXMuc2l6ZVggPSBpbWFnZVdpZHRoO1xuICAgICAgICAgICAgICAgIHJlcy5zaXplWSA9IGltYWdlSGVpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBwb3NpdGlvbiA9IGJhY2tncm91bmQucG9zaXRpb247XG4gICAgaWYgKHBvc2l0aW9uKSB7XG4gICAgICAgIHZhciB2ID0gcGFyc2VQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICAgIGlmICh2KSB7XG4gICAgICAgICAgICB2YXIgc3BhY2VYID0gd2lkdGggLSBpbWFnZVdpZHRoO1xuICAgICAgICAgICAgdmFyIHNwYWNlWSA9IGhlaWdodCAtIGltYWdlSGVpZ2h0O1xuICAgICAgICAgICAgaWYgKHYueC51bml0ID09PSBcIiVcIiAmJiB2LnkudW5pdCA9PT0gXCIlXCIpIHtcbiAgICAgICAgICAgICAgICByZXMucG9zWCA9IHNwYWNlWCAqIHYueC52YWx1ZSAvIDEwMDtcbiAgICAgICAgICAgICAgICByZXMucG9zWSA9IHNwYWNlWSAqIHYueS52YWx1ZSAvIDEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHYueC50eXBlID09PSBcIm51bWJlclwiICYmIHYueS50eXBlID09PSBcIm51bWJlclwiICYmXG4gICAgICAgICAgICAgICAgKCh2LngudW5pdCA9PT0gXCJweFwiICYmIHYueS51bml0ID09PSBcInB4XCIpIHx8ICh2LngudW5pdCA9PT0gXCJcIiAmJiB2LnkudW5pdCA9PT0gXCJcIikpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnBvc1ggPSB2LngudmFsdWU7XG4gICAgICAgICAgICAgICAgcmVzLnBvc1kgPSB2LnkudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2LngudHlwZSA9PT0gXCJpZGVudFwiICYmIHYueS50eXBlID09PSBcImlkZW50XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodi54LnN0cmluZy50b0xvd2VyQ2FzZSgpID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5wb3NYID0gc3BhY2VYIC8gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodi54LnN0cmluZy50b0xvd2VyQ2FzZSgpID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnBvc1ggPSBzcGFjZVg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2Lnkuc3RyaW5nLnRvTG93ZXJDYXNlKCkgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnBvc1kgPSBzcGFjZVkgLyAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2Lnkuc3RyaW5nLnRvTG93ZXJDYXNlKCkgPT09IFwiYm90dG9tXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnBvc1kgPSBzcGFjZVk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5mdW5jdGlvbiB1aUNvbG9yRnJvbUltYWdlKGltZywgdmlldywgY2FsbGJhY2ssIGZsaXApIHtcbiAgICB2YXIgYmFja2dyb3VuZCA9IHZpZXcuc3R5bGUuYmFja2dyb3VuZEludGVybmFsO1xuICAgIGlmICghaW1nKSB7XG4gICAgICAgIGNhbGxiYWNrKGJhY2tncm91bmQuY29sb3IgJiYgYmFja2dyb3VuZC5jb2xvci5pb3MpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBuYXRpdmVWaWV3ID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgIHZhciBmcmFtZSA9IG5hdGl2ZVZpZXcuZnJhbWU7XG4gICAgdmFyIGJvdW5kc1dpZHRoID0gdmlldy5zY2FsZVggPyBmcmFtZS5zaXplLndpZHRoIC8gdmlldy5zY2FsZVggOiBmcmFtZS5zaXplLndpZHRoO1xuICAgIHZhciBib3VuZHNIZWlnaHQgPSB2aWV3LnNjYWxlWSA/IGZyYW1lLnNpemUuaGVpZ2h0IC8gdmlldy5zY2FsZVkgOiBmcmFtZS5zaXplLmhlaWdodDtcbiAgICB2YXIgcGFyYW1zID0gZ2V0RHJhd1BhcmFtcyhpbWcsIGJhY2tncm91bmQsIGJvdW5kc1dpZHRoLCBib3VuZHNIZWlnaHQpO1xuICAgIGlmIChwYXJhbXMuc2l6ZVggPiAwICYmIHBhcmFtcy5zaXplWSA+IDApIHtcbiAgICAgICAgdmFyIHJlc2l6ZVJlY3QgPSBDR1JlY3RNYWtlKDAsIDAsIHBhcmFtcy5zaXplWCwgcGFyYW1zLnNpemVZKTtcbiAgICAgICAgVUlHcmFwaGljc0JlZ2luSW1hZ2VDb250ZXh0V2l0aE9wdGlvbnMocmVzaXplUmVjdC5zaXplLCBmYWxzZSwgMC4wKTtcbiAgICAgICAgaW1nLmRyYXdJblJlY3QocmVzaXplUmVjdCk7XG4gICAgICAgIGltZyA9IFVJR3JhcGhpY3NHZXRJbWFnZUZyb21DdXJyZW50SW1hZ2VDb250ZXh0KCk7XG4gICAgICAgIFVJR3JhcGhpY3NFbmRJbWFnZUNvbnRleHQoKTtcbiAgICB9XG4gICAgVUlHcmFwaGljc0JlZ2luSW1hZ2VDb250ZXh0V2l0aE9wdGlvbnMoQ0dTaXplRnJvbVN0cmluZyhcIntcIiArIGJvdW5kc1dpZHRoICsgXCIsXCIgKyBib3VuZHNIZWlnaHQgKyBcIn1cIiksIGZhbHNlLCAwLjApO1xuICAgIHZhciBjb250ZXh0ID0gVUlHcmFwaGljc0dldEN1cnJlbnRDb250ZXh0KCk7XG4gICAgaWYgKGJhY2tncm91bmQuY29sb3IgJiYgYmFja2dyb3VuZC5jb2xvci5pb3MpIHtcbiAgICAgICAgQ0dDb250ZXh0U2V0RmlsbENvbG9yV2l0aENvbG9yKGNvbnRleHQsIGJhY2tncm91bmQuY29sb3IuaW9zLkNHQ29sb3IpO1xuICAgICAgICBDR0NvbnRleHRGaWxsUmVjdChjb250ZXh0LCBDR1JlY3RNYWtlKDAsIDAsIGJvdW5kc1dpZHRoLCBib3VuZHNIZWlnaHQpKTtcbiAgICB9XG4gICAgaWYgKCFwYXJhbXMucmVwZWF0WCAmJiAhcGFyYW1zLnJlcGVhdFkpIHtcbiAgICAgICAgaW1nLmRyYXdBdFBvaW50KENHUG9pbnRNYWtlKHBhcmFtcy5wb3NYLCBwYXJhbXMucG9zWSkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHcgPSBwYXJhbXMucmVwZWF0WCA/IGJvdW5kc1dpZHRoIDogaW1nLnNpemUud2lkdGg7XG4gICAgICAgIHZhciBoID0gcGFyYW1zLnJlcGVhdFkgPyBib3VuZHNIZWlnaHQgOiBpbWcuc2l6ZS5oZWlnaHQ7XG4gICAgICAgIENHQ29udGV4dFNldFBhdHRlcm5QaGFzZShjb250ZXh0LCBDR1NpemVNYWtlKHBhcmFtcy5wb3NYLCBwYXJhbXMucG9zWSkpO1xuICAgICAgICBwYXJhbXMucG9zWCA9IHBhcmFtcy5yZXBlYXRYID8gMCA6IHBhcmFtcy5wb3NYO1xuICAgICAgICBwYXJhbXMucG9zWSA9IHBhcmFtcy5yZXBlYXRZID8gMCA6IHBhcmFtcy5wb3NZO1xuICAgICAgICB2YXIgcGF0dGVyblJlY3QgPSBDR1JlY3RNYWtlKHBhcmFtcy5wb3NYLCBwYXJhbXMucG9zWSwgdywgaCk7XG4gICAgICAgIGltZy5kcmF3QXNQYXR0ZXJuSW5SZWN0KHBhdHRlcm5SZWN0KTtcbiAgICB9XG4gICAgdmFyIGJrZ0ltYWdlID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICBVSUdyYXBoaWNzRW5kSW1hZ2VDb250ZXh0KCk7XG4gICAgaWYgKGZsaXApIHtcbiAgICAgICAgdmFyIGZsaXBwZWRJbWFnZSA9IF9mbGlwSW1hZ2UoYmtnSW1hZ2UpO1xuICAgICAgICBjYWxsYmFjayhVSUNvbG9yLmFsbG9jKCkuaW5pdFdpdGhQYXR0ZXJuSW1hZ2UoZmxpcHBlZEltYWdlKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjYWxsYmFjayhVSUNvbG9yLmFsbG9jKCkuaW5pdFdpdGhQYXR0ZXJuSW1hZ2UoYmtnSW1hZ2UpKTtcbiAgICB9XG59XG5mdW5jdGlvbiBfZmxpcEltYWdlKG9yaWdpbmFsSW1hZ2UpIHtcbiAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhvcmlnaW5hbEltYWdlLnNpemUsIGZhbHNlLCAwLjApO1xuICAgIHZhciBjb250ZXh0ID0gVUlHcmFwaGljc0dldEN1cnJlbnRDb250ZXh0KCk7XG4gICAgQ0dDb250ZXh0U2F2ZUdTdGF0ZShjb250ZXh0KTtcbiAgICBDR0NvbnRleHRUcmFuc2xhdGVDVE0oY29udGV4dCwgMC4wLCBvcmlnaW5hbEltYWdlLnNpemUuaGVpZ2h0KTtcbiAgICBDR0NvbnRleHRTY2FsZUNUTShjb250ZXh0LCAxLjAsIC0xLjApO1xuICAgIG9yaWdpbmFsSW1hZ2UuZHJhd0luUmVjdChDR1JlY3RNYWtlKDAsIDAsIG9yaWdpbmFsSW1hZ2Uuc2l6ZS53aWR0aCwgb3JpZ2luYWxJbWFnZS5zaXplLmhlaWdodCkpO1xuICAgIENHQ29udGV4dFJlc3RvcmVHU3RhdGUoY29udGV4dCk7XG4gICAgdmFyIGZsaXBwZWRJbWFnZSA9IFVJR3JhcGhpY3NHZXRJbWFnZUZyb21DdXJyZW50SW1hZ2VDb250ZXh0KCk7XG4gICAgVUlHcmFwaGljc0VuZEltYWdlQ29udGV4dCgpO1xuICAgIHJldHVybiBmbGlwcGVkSW1hZ2U7XG59XG5mdW5jdGlvbiBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoc291cmNlLCB0b3RhbCkge1xuICAgIHNvdXJjZSA9IHNvdXJjZS50cmltKCk7XG4gICAgaWYgKHNvdXJjZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBhcnNlRmxvYXQoc291cmNlLnJlcGxhY2UoXCJweFwiLCBcIlwiKSkpO1xuICAgIH1cbiAgICBlbHNlIGlmIChzb3VyY2UuaW5kZXhPZihcIiVcIikgIT09IC0xICYmIHRvdGFsID4gMCkge1xuICAgICAgICByZXR1cm4gKHBhcnNlRmxvYXQoc291cmNlLnJlcGxhY2UoXCIlXCIsIFwiXCIpKSAvIDEwMCkgKiB0b3RhbDtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHNvdXJjZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZHJhd1VuaWZvcm1Db2xvck5vblVuaWZvcm1Cb3JkZXJzKG5hdGl2ZVZpZXcsIGJhY2tncm91bmQpIHtcbiAgICB2YXIgbGF5ZXIgPSBuYXRpdmVWaWV3LmxheWVyO1xuICAgIGxheWVyLmJhY2tncm91bmRDb2xvciA9IHVuZGVmaW5lZDtcbiAgICBsYXllci5ib3JkZXJDb2xvciA9IHVuZGVmaW5lZDtcbiAgICBsYXllci5ib3JkZXJXaWR0aCA9IDA7XG4gICAgbGF5ZXIuY29ybmVyUmFkaXVzID0gMDtcbiAgICB2YXIgX2EgPSBsYXllci5ib3VuZHMuc2l6ZSwgd2lkdGggPSBfYS53aWR0aCwgaGVpZ2h0ID0gX2EuaGVpZ2h0O1xuICAgIHZhciBfYiA9IGxheWVyLmJvdW5kcy5vcmlnaW4sIHggPSBfYi54LCB5ID0gX2IueTtcbiAgICB2YXIgbGVmdCA9IHg7XG4gICAgdmFyIHRvcCA9IHk7XG4gICAgdmFyIHJpZ2h0ID0geCArIHdpZHRoO1xuICAgIHZhciBib3R0b20gPSB5ICsgaGVpZ2h0O1xuICAgIHZhciBtaW4gPSBNYXRoLm1pbiwgbWF4ID0gTWF0aC5tYXg7XG4gICAgdmFyIGJvcmRlclRvcFdpZHRoID0gbWF4KDAsIHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJUb3BXaWR0aCkpO1xuICAgIHZhciBib3JkZXJSaWdodFdpZHRoID0gbWF4KDAsIHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJSaWdodFdpZHRoKSk7XG4gICAgdmFyIGJvcmRlckJvdHRvbVdpZHRoID0gbWF4KDAsIHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJCb3R0b21XaWR0aCkpO1xuICAgIHZhciBib3JkZXJMZWZ0V2lkdGggPSBtYXgoMCwgdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlckxlZnRXaWR0aCkpO1xuICAgIHZhciBib3JkZXJWV2lkdGggPSBib3JkZXJUb3BXaWR0aCArIGJvcmRlckJvdHRvbVdpZHRoO1xuICAgIHZhciBib3JkZXJIV2lkdGggPSBib3JkZXJMZWZ0V2lkdGggKyBib3JkZXJSaWdodFdpZHRoO1xuICAgIHZhciBjYXBwZWRCb3JkZXJUb3BXaWR0aCA9IGJvcmRlclRvcFdpZHRoICYmIGJvcmRlclRvcFdpZHRoICogbWluKDEsIGhlaWdodCAvIGJvcmRlclZXaWR0aCk7XG4gICAgdmFyIGNhcHBlZEJvcmRlclJpZ2h0V2lkdGggPSBib3JkZXJSaWdodFdpZHRoICYmIGJvcmRlclJpZ2h0V2lkdGggKiBtaW4oMSwgd2lkdGggLyBib3JkZXJIV2lkdGgpO1xuICAgIHZhciBjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCA9IGJvcmRlckJvdHRvbVdpZHRoICYmIGJvcmRlckJvdHRvbVdpZHRoICogbWluKDEsIGhlaWdodCAvIGJvcmRlclZXaWR0aCk7XG4gICAgdmFyIGNhcHBlZEJvcmRlckxlZnRXaWR0aCA9IGJvcmRlckxlZnRXaWR0aCAmJiBib3JkZXJMZWZ0V2lkdGggKiBtaW4oMSwgd2lkdGggLyBib3JkZXJIV2lkdGgpO1xuICAgIHZhciBvdXRlclRvcExlZnRSYWRpdXMgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyVG9wTGVmdFJhZGl1cyk7XG4gICAgdmFyIG91dGVyVG9wUmlnaHRSYWRpdXMgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyVG9wUmlnaHRSYWRpdXMpO1xuICAgIHZhciBvdXRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKTtcbiAgICB2YXIgb3V0ZXJCb3R0b21MZWZ0UmFkaXVzID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMpO1xuICAgIHZhciB0b3BSYWRpaSA9IG91dGVyVG9wTGVmdFJhZGl1cyArIG91dGVyVG9wUmlnaHRSYWRpdXM7XG4gICAgdmFyIHJpZ2h0UmFkaWkgPSBvdXRlclRvcFJpZ2h0UmFkaXVzICsgb3V0ZXJCb3R0b21SaWdodFJhZGl1cztcbiAgICB2YXIgYm90dG9tUmFkaWkgPSBvdXRlckJvdHRvbVJpZ2h0UmFkaXVzICsgb3V0ZXJCb3R0b21MZWZ0UmFkaXVzO1xuICAgIHZhciBsZWZ0UmFkaWkgPSBvdXRlckJvdHRvbUxlZnRSYWRpdXMgKyBvdXRlclRvcExlZnRSYWRpdXM7XG4gICAgZnVuY3Rpb24gY2FwUmFkaXVzKGEsIGIsIGMpIHtcbiAgICAgICAgcmV0dXJuIGEgJiYgTWF0aC5taW4oYSwgTWF0aC5taW4oYiwgYykpO1xuICAgIH1cbiAgICB2YXIgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzID0gY2FwUmFkaXVzKG91dGVyVG9wTGVmdFJhZGl1cywgb3V0ZXJUb3BMZWZ0UmFkaXVzIC8gdG9wUmFkaWkgKiB3aWR0aCwgb3V0ZXJUb3BMZWZ0UmFkaXVzIC8gbGVmdFJhZGlpICogaGVpZ2h0KTtcbiAgICB2YXIgY2FwcGVkT3V0ZXJUb3BSaWdodFJhZGl1cyA9IGNhcFJhZGl1cyhvdXRlclRvcFJpZ2h0UmFkaXVzLCBvdXRlclRvcFJpZ2h0UmFkaXVzIC8gdG9wUmFkaWkgKiB3aWR0aCwgb3V0ZXJUb3BSaWdodFJhZGl1cyAvIHJpZ2h0UmFkaWkgKiBoZWlnaHQpO1xuICAgIHZhciBjYXBwZWRPdXRlckJvdHRvbVJpZ2h0UmFkaXVzID0gY2FwUmFkaXVzKG91dGVyQm90dG9tUmlnaHRSYWRpdXMsIG91dGVyQm90dG9tUmlnaHRSYWRpdXMgLyBib3R0b21SYWRpaSAqIHdpZHRoLCBvdXRlckJvdHRvbVJpZ2h0UmFkaXVzIC8gcmlnaHRSYWRpaSAqIGhlaWdodCk7XG4gICAgdmFyIGNhcHBlZE91dGVyQm90dG9tTGVmdFJhZGl1cyA9IGNhcFJhZGl1cyhvdXRlckJvdHRvbUxlZnRSYWRpdXMsIG91dGVyQm90dG9tTGVmdFJhZGl1cyAvIGJvdHRvbVJhZGlpICogd2lkdGgsIG91dGVyQm90dG9tTGVmdFJhZGl1cyAvIGxlZnRSYWRpaSAqIGhlaWdodCk7XG4gICAgdmFyIGNsaXBQYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgIENHUGF0aE1vdmVUb1BvaW50KGNsaXBQYXRoLCBudWxsLCBsZWZ0ICsgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzLCB0b3ApO1xuICAgIENHUGF0aEFkZEFyY1RvUG9pbnQoY2xpcFBhdGgsIG51bGwsIHJpZ2h0LCB0b3AsIHJpZ2h0LCB0b3AgKyBjYXBwZWRPdXRlclRvcFJpZ2h0UmFkaXVzLCBjYXBwZWRPdXRlclRvcFJpZ2h0UmFkaXVzKTtcbiAgICBDR1BhdGhBZGRBcmNUb1BvaW50KGNsaXBQYXRoLCBudWxsLCByaWdodCwgYm90dG9tLCByaWdodCAtIGNhcHBlZE91dGVyQm90dG9tUmlnaHRSYWRpdXMsIGJvdHRvbSwgY2FwcGVkT3V0ZXJCb3R0b21SaWdodFJhZGl1cyk7XG4gICAgQ0dQYXRoQWRkQXJjVG9Qb2ludChjbGlwUGF0aCwgbnVsbCwgbGVmdCwgYm90dG9tLCBsZWZ0LCBib3R0b20gLSBjYXBwZWRPdXRlckJvdHRvbUxlZnRSYWRpdXMsIGNhcHBlZE91dGVyQm90dG9tTGVmdFJhZGl1cyk7XG4gICAgQ0dQYXRoQWRkQXJjVG9Qb2ludChjbGlwUGF0aCwgbnVsbCwgbGVmdCwgdG9wLCBsZWZ0ICsgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzLCB0b3AsIGNhcHBlZE91dGVyVG9wTGVmdFJhZGl1cyk7XG4gICAgQ0dQYXRoQ2xvc2VTdWJwYXRoKGNsaXBQYXRoKTtcbiAgICBuYXRpdmVWaWV3LmJvcmRlck9yaWdpbmFsTWFzayA9IGxheWVyLm1hc2s7XG4gICAgdmFyIGNsaXBTaGFwZUxheWVyID0gQ0FTaGFwZUxheWVyLmxheWVyKCk7XG4gICAgY2xpcFNoYXBlTGF5ZXIucGF0aCA9IGNsaXBQYXRoO1xuICAgIGxheWVyLm1hc2sgPSBjbGlwU2hhcGVMYXllcjtcbiAgICBuYXRpdmVWaWV3Lmhhc0JvcmRlck1hc2sgPSB0cnVlO1xuICAgIGlmIChjYXBwZWRCb3JkZXJMZWZ0V2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlclRvcFdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJSaWdodFdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCA+IDApIHtcbiAgICAgICAgdmFyIGJvcmRlclBhdGggPSBDR1BhdGhDcmVhdGVNdXRhYmxlKCk7XG4gICAgICAgIENHUGF0aEFkZFJlY3QoYm9yZGVyUGF0aCwgbnVsbCwgQ0dSZWN0TWFrZShsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTtcbiAgICAgICAgaWYgKGNhcHBlZEJvcmRlclRvcFdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJMZWZ0V2lkdGggPiAwKSB7XG4gICAgICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludChib3JkZXJQYXRoLCBudWxsLCBsZWZ0ICsgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzLCB0b3AgKyBjYXBwZWRCb3JkZXJUb3BXaWR0aCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludChib3JkZXJQYXRoLCBudWxsLCBsZWZ0LCB0b3ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXBwZWRCb3JkZXJUb3BXaWR0aCA+IDAgfHwgY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcFJpZ2h0V1JhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlclRvcFJpZ2h0UmFkaXVzIC0gY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJUb3BSaWdodEhSYWRpdXMgPSBtYXgoMCwgY2FwcGVkT3V0ZXJUb3BSaWdodFJhZGl1cyAtIGNhcHBlZEJvcmRlclRvcFdpZHRoKTtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcFJpZ2h0TWF4UmFkaXVzID0gbWF4KGlubmVyVG9wUmlnaHRXUmFkaXVzLCBpbm5lclRvcFJpZ2h0SFJhZGl1cyk7XG4gICAgICAgICAgICB2YXIgaW5uZXJUb3BSaWdodFRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZShpbm5lclRvcFJpZ2h0TWF4UmFkaXVzICYmIGlubmVyVG9wUmlnaHRXUmFkaXVzIC8gaW5uZXJUb3BSaWdodE1heFJhZGl1cywgMCwgMCwgaW5uZXJUb3BSaWdodE1heFJhZGl1cyAmJiBpbm5lclRvcFJpZ2h0SFJhZGl1cyAvIGlubmVyVG9wUmlnaHRNYXhSYWRpdXMsIHJpZ2h0IC0gY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCAtIGlubmVyVG9wUmlnaHRXUmFkaXVzLCB0b3AgKyBjYXBwZWRCb3JkZXJUb3BXaWR0aCArIGlubmVyVG9wUmlnaHRIUmFkaXVzKTtcbiAgICAgICAgICAgIENHUGF0aEFkZEFyYyhib3JkZXJQYXRoLCBpbm5lclRvcFJpZ2h0VHJhbnNmb3JtLCAwLCAwLCBpbm5lclRvcFJpZ2h0TWF4UmFkaXVzLCBNYXRoLlBJICogMyAvIDIsIDAsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIENHUGF0aE1vdmVUb1BvaW50KGJvcmRlclBhdGgsIG51bGwsIHJpZ2h0LCB0b3ApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCA+IDAgfHwgY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbVJpZ2h0V1JhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlckJvdHRvbVJpZ2h0UmFkaXVzIC0gY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJCb3R0b21SaWdodEhSYWRpdXMgPSBtYXgoMCwgY2FwcGVkT3V0ZXJCb3R0b21SaWdodFJhZGl1cyAtIGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoKTtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbVJpZ2h0TWF4UmFkaXVzID0gbWF4KGlubmVyQm90dG9tUmlnaHRXUmFkaXVzLCBpbm5lckJvdHRvbVJpZ2h0SFJhZGl1cyk7XG4gICAgICAgICAgICB2YXIgaW5uZXJCb3R0b21SaWdodFRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZShpbm5lckJvdHRvbVJpZ2h0TWF4UmFkaXVzICYmIGlubmVyQm90dG9tUmlnaHRXUmFkaXVzIC8gaW5uZXJCb3R0b21SaWdodE1heFJhZGl1cywgMCwgMCwgaW5uZXJCb3R0b21SaWdodE1heFJhZGl1cyAmJiBpbm5lckJvdHRvbVJpZ2h0SFJhZGl1cyAvIGlubmVyQm90dG9tUmlnaHRNYXhSYWRpdXMsIHJpZ2h0IC0gY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCAtIGlubmVyQm90dG9tUmlnaHRXUmFkaXVzLCBib3R0b20gLSBjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCAtIGlubmVyQm90dG9tUmlnaHRIUmFkaXVzKTtcbiAgICAgICAgICAgIENHUGF0aEFkZEFyYyhib3JkZXJQYXRoLCBpbm5lckJvdHRvbVJpZ2h0VHJhbnNmb3JtLCAwLCAwLCBpbm5lckJvdHRvbVJpZ2h0TWF4UmFkaXVzLCAwLCBNYXRoLlBJIC8gMiwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm9yZGVyUGF0aCwgbnVsbCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJMZWZ0V2lkdGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgaW5uZXJCb3R0b21MZWZ0V1JhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlckJvdHRvbUxlZnRSYWRpdXMgLSBjYXBwZWRCb3JkZXJMZWZ0V2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyQm90dG9tTGVmdEhSYWRpdXMgPSBtYXgoMCwgY2FwcGVkT3V0ZXJCb3R0b21MZWZ0UmFkaXVzIC0gY2FwcGVkQm9yZGVyQm90dG9tV2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyQm90dG9tTGVmdE1heFJhZGl1cyA9IG1heChpbm5lckJvdHRvbUxlZnRXUmFkaXVzLCBpbm5lckJvdHRvbUxlZnRIUmFkaXVzKTtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbUxlZnRUcmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybU1ha2UoaW5uZXJCb3R0b21MZWZ0TWF4UmFkaXVzICYmIGlubmVyQm90dG9tTGVmdFdSYWRpdXMgLyBpbm5lckJvdHRvbUxlZnRNYXhSYWRpdXMsIDAsIDAsIGlubmVyQm90dG9tTGVmdE1heFJhZGl1cyAmJiBpbm5lckJvdHRvbUxlZnRIUmFkaXVzIC8gaW5uZXJCb3R0b21MZWZ0TWF4UmFkaXVzLCBsZWZ0ICsgY2FwcGVkQm9yZGVyTGVmdFdpZHRoICsgaW5uZXJCb3R0b21MZWZ0V1JhZGl1cywgYm90dG9tIC0gY2FwcGVkQm9yZGVyQm90dG9tV2lkdGggLSBpbm5lckJvdHRvbUxlZnRIUmFkaXVzKTtcbiAgICAgICAgICAgIENHUGF0aEFkZEFyYyhib3JkZXJQYXRoLCBpbm5lckJvdHRvbUxlZnRUcmFuc2Zvcm0sIDAsIDAsIGlubmVyQm90dG9tTGVmdE1heFJhZGl1cywgTWF0aC5QSSAvIDIsIE1hdGguUEksIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KGJvcmRlclBhdGgsIG51bGwsIGxlZnQsIGJvdHRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhcHBlZEJvcmRlclRvcFdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJMZWZ0V2lkdGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgaW5uZXJUb3BMZWZ0V1JhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMgLSBjYXBwZWRCb3JkZXJMZWZ0V2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyVG9wTGVmdEhSYWRpdXMgPSBtYXgoMCwgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzIC0gY2FwcGVkQm9yZGVyVG9wV2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyVG9wTGVmdE1heFJhZGl1cyA9IG1heChpbm5lclRvcExlZnRXUmFkaXVzLCBpbm5lclRvcExlZnRIUmFkaXVzKTtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcExlZnRUcmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybU1ha2UoaW5uZXJUb3BMZWZ0TWF4UmFkaXVzICYmIGlubmVyVG9wTGVmdFdSYWRpdXMgLyBpbm5lclRvcExlZnRNYXhSYWRpdXMsIDAsIDAsIGlubmVyVG9wTGVmdE1heFJhZGl1cyAmJiBpbm5lclRvcExlZnRIUmFkaXVzIC8gaW5uZXJUb3BMZWZ0TWF4UmFkaXVzLCBsZWZ0ICsgY2FwcGVkQm9yZGVyTGVmdFdpZHRoICsgaW5uZXJUb3BMZWZ0V1JhZGl1cywgdG9wICsgY2FwcGVkQm9yZGVyVG9wV2lkdGggKyBpbm5lclRvcExlZnRIUmFkaXVzKTtcbiAgICAgICAgICAgIENHUGF0aEFkZEFyYyhib3JkZXJQYXRoLCBpbm5lclRvcExlZnRUcmFuc2Zvcm0sIDAsIDAsIGlubmVyVG9wTGVmdE1heFJhZGl1cywgTWF0aC5QSSwgTWF0aC5QSSAqIDMgLyAyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3JkZXJQYXRoLCBudWxsLCBsZWZ0LCB0b3ApO1xuICAgICAgICB9XG4gICAgICAgIENHUGF0aENsb3NlU3VicGF0aChib3JkZXJQYXRoKTtcbiAgICAgICAgdmFyIGJvcmRlckxheWVyID0gQ0FTaGFwZUxheWVyLmxheWVyKCk7XG4gICAgICAgIGJvcmRlckxheWVyLmZpbGxDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyVG9wQ29sb3IgJiYgYmFja2dyb3VuZC5ib3JkZXJUb3BDb2xvci5pb3MuQ0dDb2xvciB8fCBVSUNvbG9yLmJsYWNrQ29sb3IuQ0dDb2xvcjtcbiAgICAgICAgYm9yZGVyTGF5ZXIuZmlsbFJ1bGUgPSBrQ0FGaWxsUnVsZUV2ZW5PZGQ7XG4gICAgICAgIGJvcmRlckxheWVyLnBhdGggPSBib3JkZXJQYXRoO1xuICAgICAgICBsYXllci5hZGRTdWJsYXllcihib3JkZXJMYXllcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm9yZGVyTGF5ZXIgPSBib3JkZXJMYXllcjtcbiAgICB9XG4gICAgbmF0aXZlVmlldy5oYXNOb25Vbmlmb3JtQm9yZGVyID0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGRyYXdOb1JhZGl1c05vblVuaWZvcm1Cb3JkZXJzKG5hdGl2ZVZpZXcsIGJhY2tncm91bmQpIHtcbiAgICB2YXIgYm9yZGVyTGF5ZXIgPSBDQUxheWVyLmxheWVyKCk7XG4gICAgbmF0aXZlVmlldy5sYXllci5hZGRTdWJsYXllcihib3JkZXJMYXllcik7XG4gICAgbmF0aXZlVmlldy5ib3JkZXJMYXllciA9IGJvcmRlckxheWVyO1xuICAgIGJvcmRlckxheWVyLmJvcmRlckNvbG9yID0gdW5kZWZpbmVkO1xuICAgIGJvcmRlckxheWVyLmJvcmRlcldpZHRoID0gMDtcbiAgICBib3JkZXJMYXllci5jb3JuZXJSYWRpdXMgPSAwO1xuICAgIHZhciBsYXllckJvdW5kcyA9IG5hdGl2ZVZpZXcubGF5ZXIuYm91bmRzO1xuICAgIHZhciBsYXllck9yaWdpbiA9IGxheWVyQm91bmRzLm9yaWdpbjtcbiAgICB2YXIgbGF5ZXJTaXplID0gbGF5ZXJCb3VuZHMuc2l6ZTtcbiAgICB2YXIgbmF0aXZlVmlld0xheWVyQm91bmRzID0ge1xuICAgICAgICBsZWZ0OiBsYXllck9yaWdpbi54LFxuICAgICAgICB0b3A6IGxheWVyT3JpZ2luLnksXG4gICAgICAgIGJvdHRvbTogbGF5ZXJTaXplLmhlaWdodCxcbiAgICAgICAgcmlnaHQ6IGxheWVyU2l6ZS53aWR0aFxuICAgIH07XG4gICAgdmFyIHRvcCA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJUb3BXaWR0aCk7XG4gICAgdmFyIHJpZ2h0ID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0V2lkdGgpO1xuICAgIHZhciBib3R0b20gPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyQm90dG9tV2lkdGgpO1xuICAgIHZhciBsZWZ0ID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlckxlZnRXaWR0aCk7XG4gICAgdmFyIGx0byA9IHsgeDogbmF0aXZlVmlld0xheWVyQm91bmRzLmxlZnQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy50b3AgfTtcbiAgICB2YXIgbHRpID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMubGVmdCArIGxlZnQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy50b3AgKyB0b3AgfTtcbiAgICB2YXIgcnRvID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMucmlnaHQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy50b3AgfTtcbiAgICB2YXIgcnRpID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMucmlnaHQgLSByaWdodCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLnRvcCArIHRvcCB9O1xuICAgIHZhciByYm8gPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5yaWdodCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLmJvdHRvbSB9O1xuICAgIHZhciByYmkgPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5yaWdodCAtIHJpZ2h0LCB5OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMuYm90dG9tIC0gYm90dG9tIH07XG4gICAgdmFyIGxibyA9IHsgeDogbmF0aXZlVmlld0xheWVyQm91bmRzLmxlZnQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5ib3R0b20gfTtcbiAgICB2YXIgbGJpID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMubGVmdCArIGxlZnQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5ib3R0b20gLSBib3R0b20gfTtcbiAgICB2YXIgaGFzTm9uVW5pZm9ybUJvcmRlcjtcbiAgICB2YXIgYm9yZGVyVG9wQ29sb3IgPSBiYWNrZ3JvdW5kLmJvcmRlclRvcENvbG9yO1xuICAgIGlmICh0b3AgPiAwICYmIGJvcmRlclRvcENvbG9yICYmIGJvcmRlclRvcENvbG9yLmlvcykge1xuICAgICAgICB2YXIgdG9wQm9yZGVyUGF0aCA9IENHUGF0aENyZWF0ZU11dGFibGUoKTtcbiAgICAgICAgQ0dQYXRoTW92ZVRvUG9pbnQodG9wQm9yZGVyUGF0aCwgbnVsbCwgbHRvLngsIGx0by55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQodG9wQm9yZGVyUGF0aCwgbnVsbCwgcnRvLngsIHJ0by55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQodG9wQm9yZGVyUGF0aCwgbnVsbCwgcnRpLngsIHJ0aS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQodG9wQm9yZGVyUGF0aCwgbnVsbCwgbHRpLngsIGx0aS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQodG9wQm9yZGVyUGF0aCwgbnVsbCwgbHRvLngsIGx0by55KTtcbiAgICAgICAgdmFyIHRvcEJvcmRlckxheWVyID0gQ0FTaGFwZUxheWVyLmxheWVyKCk7XG4gICAgICAgIHRvcEJvcmRlckxheWVyLmZpbGxDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyVG9wQ29sb3IuaW9zLkNHQ29sb3I7XG4gICAgICAgIHRvcEJvcmRlckxheWVyLnBhdGggPSB0b3BCb3JkZXJQYXRoO1xuICAgICAgICBib3JkZXJMYXllci5hZGRTdWJsYXllcih0b3BCb3JkZXJMYXllcik7XG4gICAgICAgIG5hdGl2ZVZpZXcudG9wQm9yZGVyTGF5ZXIgPSB0b3BCb3JkZXJMYXllcjtcbiAgICAgICAgaGFzTm9uVW5pZm9ybUJvcmRlciA9IHRydWU7XG4gICAgfVxuICAgIHZhciBib3JkZXJSaWdodENvbG9yID0gYmFja2dyb3VuZC5ib3JkZXJSaWdodENvbG9yO1xuICAgIGlmIChyaWdodCA+IDAgJiYgYm9yZGVyUmlnaHRDb2xvciAmJiBib3JkZXJSaWdodENvbG9yLmlvcykge1xuICAgICAgICB2YXIgcmlnaHRCb3JkZXJQYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludChyaWdodEJvcmRlclBhdGgsIG51bGwsIHJ0by54LCBydG8ueSk7XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KHJpZ2h0Qm9yZGVyUGF0aCwgbnVsbCwgcmJvLngsIHJiby55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQocmlnaHRCb3JkZXJQYXRoLCBudWxsLCByYmkueCwgcmJpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChyaWdodEJvcmRlclBhdGgsIG51bGwsIHJ0aS54LCBydGkueSk7XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KHJpZ2h0Qm9yZGVyUGF0aCwgbnVsbCwgcnRvLngsIHJ0by55KTtcbiAgICAgICAgdmFyIHJpZ2h0Qm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgcmlnaHRCb3JkZXJMYXllci5maWxsQ29sb3IgPSBiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0Q29sb3IuaW9zLkNHQ29sb3I7XG4gICAgICAgIHJpZ2h0Qm9yZGVyTGF5ZXIucGF0aCA9IHJpZ2h0Qm9yZGVyUGF0aDtcbiAgICAgICAgYm9yZGVyTGF5ZXIuYWRkU3VibGF5ZXIocmlnaHRCb3JkZXJMYXllcik7XG4gICAgICAgIG5hdGl2ZVZpZXcucmlnaHRCb3JkZXJMYXllciA9IHJpZ2h0Qm9yZGVyTGF5ZXI7XG4gICAgICAgIGhhc05vblVuaWZvcm1Cb3JkZXIgPSB0cnVlO1xuICAgIH1cbiAgICB2YXIgYm9yZGVyQm90dG9tQ29sb3IgPSBiYWNrZ3JvdW5kLmJvcmRlckJvdHRvbUNvbG9yO1xuICAgIGlmIChib3R0b20gPiAwICYmIGJvcmRlckJvdHRvbUNvbG9yICYmIGJvcmRlckJvdHRvbUNvbG9yLmlvcykge1xuICAgICAgICB2YXIgYm90dG9tQm9yZGVyUGF0aCA9IENHUGF0aENyZWF0ZU11dGFibGUoKTtcbiAgICAgICAgQ0dQYXRoTW92ZVRvUG9pbnQoYm90dG9tQm9yZGVyUGF0aCwgbnVsbCwgcmJvLngsIHJiby55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm90dG9tQm9yZGVyUGF0aCwgbnVsbCwgbGJvLngsIGxiby55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm90dG9tQm9yZGVyUGF0aCwgbnVsbCwgbGJpLngsIGxiaS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm90dG9tQm9yZGVyUGF0aCwgbnVsbCwgcmJpLngsIHJiaS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm90dG9tQm9yZGVyUGF0aCwgbnVsbCwgcmJvLngsIHJiby55KTtcbiAgICAgICAgdmFyIGJvdHRvbUJvcmRlckxheWVyID0gQ0FTaGFwZUxheWVyLmxheWVyKCk7XG4gICAgICAgIGJvdHRvbUJvcmRlckxheWVyLmZpbGxDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyQm90dG9tQ29sb3IuaW9zLkNHQ29sb3I7XG4gICAgICAgIGJvdHRvbUJvcmRlckxheWVyLnBhdGggPSBib3R0b21Cb3JkZXJQYXRoO1xuICAgICAgICBib3JkZXJMYXllci5hZGRTdWJsYXllcihib3R0b21Cb3JkZXJMYXllcik7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm90dG9tQm9yZGVyTGF5ZXIgPSBib3R0b21Cb3JkZXJMYXllcjtcbiAgICAgICAgaGFzTm9uVW5pZm9ybUJvcmRlciA9IHRydWU7XG4gICAgfVxuICAgIHZhciBib3JkZXJMZWZ0Q29sb3IgPSBiYWNrZ3JvdW5kLmJvcmRlckxlZnRDb2xvcjtcbiAgICBpZiAobGVmdCA+IDAgJiYgYm9yZGVyTGVmdENvbG9yICYmIGJvcmRlckxlZnRDb2xvci5pb3MpIHtcbiAgICAgICAgdmFyIGxlZnRCb3JkZXJQYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludChsZWZ0Qm9yZGVyUGF0aCwgbnVsbCwgbGJvLngsIGxiby55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQobGVmdEJvcmRlclBhdGgsIG51bGwsIGx0by54LCBsdG8ueSk7XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KGxlZnRCb3JkZXJQYXRoLCBudWxsLCBsdGkueCwgbHRpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChsZWZ0Qm9yZGVyUGF0aCwgbnVsbCwgbGJpLngsIGxiaS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQobGVmdEJvcmRlclBhdGgsIG51bGwsIGxiby54LCBsYm8ueSk7XG4gICAgICAgIHZhciBsZWZ0Qm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgbGVmdEJvcmRlckxheWVyLmZpbGxDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyTGVmdENvbG9yLmlvcy5DR0NvbG9yO1xuICAgICAgICBsZWZ0Qm9yZGVyTGF5ZXIucGF0aCA9IGxlZnRCb3JkZXJQYXRoO1xuICAgICAgICBib3JkZXJMYXllci5hZGRTdWJsYXllcihsZWZ0Qm9yZGVyTGF5ZXIpO1xuICAgICAgICBuYXRpdmVWaWV3LmxlZnRCb3JkZXJMYXllciA9IGxlZnRCb3JkZXJMYXllcjtcbiAgICAgICAgaGFzTm9uVW5pZm9ybUJvcmRlciA9IHRydWU7XG4gICAgfVxuICAgIG5hdGl2ZVZpZXcuaGFzTm9uVW5pZm9ybUJvcmRlciA9IGhhc05vblVuaWZvcm1Cb3JkZXI7XG59XG5mdW5jdGlvbiBkcmF3R3JhZGllbnQobmF0aXZlVmlldywgZ3JhZGllbnQpIHtcbiAgICB2YXIgZ3JhZGllbnRMYXllciA9IENBR3JhZGllbnRMYXllci5sYXllcigpO1xuICAgIGdyYWRpZW50TGF5ZXIuZnJhbWUgPSBuYXRpdmVWaWV3LmJvdW5kcztcbiAgICBuYXRpdmVWaWV3LmdyYWRpZW50TGF5ZXIgPSBncmFkaWVudExheWVyO1xuICAgIHZhciBpb3NDb2xvcnMgPSBOU011dGFibGVBcnJheS5hbGxvYygpLmluaXRXaXRoQ2FwYWNpdHkoZ3JhZGllbnQuY29sb3JTdG9wcy5sZW5ndGgpO1xuICAgIHZhciBpb3NTdG9wcyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhDYXBhY2l0eShncmFkaWVudC5jb2xvclN0b3BzLmxlbmd0aCk7XG4gICAgdmFyIGhhc1N0b3BzID0gZmFsc2U7XG4gICAgZ3JhZGllbnQuY29sb3JTdG9wcy5mb3JFYWNoKGZ1bmN0aW9uIChzdG9wKSB7XG4gICAgICAgIGlvc0NvbG9ycy5hZGRPYmplY3Qoc3RvcC5jb2xvci5pb3MuQ0dDb2xvcik7XG4gICAgICAgIGlmIChzdG9wLm9mZnNldCkge1xuICAgICAgICAgICAgaW9zU3RvcHMuYWRkT2JqZWN0KHN0b3Aub2Zmc2V0LnZhbHVlKTtcbiAgICAgICAgICAgIGhhc1N0b3BzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGdyYWRpZW50TGF5ZXIuY29sb3JzID0gaW9zQ29sb3JzO1xuICAgIGlmIChoYXNTdG9wcykge1xuICAgICAgICBncmFkaWVudExheWVyLmxvY2F0aW9ucyA9IGlvc1N0b3BzO1xuICAgIH1cbiAgICB2YXIgYWxwaGEgPSBncmFkaWVudC5hbmdsZSAvIChNYXRoLlBJICogMik7XG4gICAgdmFyIHN0YXJ0WCA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiAoYWxwaGEgKyAwLjc1KSksIDIpO1xuICAgIHZhciBzdGFydFkgPSBNYXRoLnBvdyhNYXRoLnNpbihNYXRoLlBJICogKGFscGhhICsgMC41KSksIDIpO1xuICAgIHZhciBlbmRYID0gTWF0aC5wb3coTWF0aC5zaW4oTWF0aC5QSSAqIChhbHBoYSArIDAuMjUpKSwgMik7XG4gICAgdmFyIGVuZFkgPSBNYXRoLnBvdyhNYXRoLnNpbihNYXRoLlBJICogYWxwaGEpLCAyKTtcbiAgICBncmFkaWVudExheWVyLnN0YXJ0UG9pbnQgPSB7IHg6IHN0YXJ0WCwgeTogc3RhcnRZIH07XG4gICAgZ3JhZGllbnRMYXllci5lbmRQb2ludCA9IHsgeDogZW5kWCwgeTogZW5kWSB9O1xuICAgIG5hdGl2ZVZpZXcubGF5ZXIuaW5zZXJ0U3VibGF5ZXJBdEluZGV4KGdyYWRpZW50TGF5ZXIsIDApO1xufVxuZnVuY3Rpb24gY2xlYXJHcmFkaWVudChuYXRpdmVWaWV3KSB7XG4gICAgaWYgKG5hdGl2ZVZpZXcuZ3JhZGllbnRMYXllcikge1xuICAgICAgICBuYXRpdmVWaWV3LmdyYWRpZW50TGF5ZXIucmVtb3ZlRnJvbVN1cGVybGF5ZXIoKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkcmF3Q2xpcFBhdGgobmF0aXZlVmlldywgYmFja2dyb3VuZCkge1xuICAgIHZhciBsYXllciA9IG5hdGl2ZVZpZXcubGF5ZXI7XG4gICAgdmFyIGxheWVyQm91bmRzID0gbGF5ZXIuYm91bmRzO1xuICAgIHZhciBsYXllck9yaWdpbiA9IGxheWVyQm91bmRzLm9yaWdpbjtcbiAgICB2YXIgbGF5ZXJTaXplID0gbGF5ZXJCb3VuZHMuc2l6ZTtcbiAgICB2YXIgYm91bmRzID0ge1xuICAgICAgICBsZWZ0OiBsYXllck9yaWdpbi54LFxuICAgICAgICB0b3A6IGxheWVyT3JpZ2luLnksXG4gICAgICAgIGJvdHRvbTogbGF5ZXJTaXplLmhlaWdodCxcbiAgICAgICAgcmlnaHQ6IGxheWVyU2l6ZS53aWR0aFxuICAgIH07XG4gICAgaWYgKGJvdW5kcy5yaWdodCA9PT0gMCB8fCBib3VuZHMuYm90dG9tID09PSAwKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHBhdGg7XG4gICAgdmFyIGNsaXBQYXRoID0gYmFja2dyb3VuZC5jbGlwUGF0aDtcbiAgICB2YXIgZnVuY3Rpb25OYW1lID0gY2xpcFBhdGguc3Vic3RyaW5nKDAsIGNsaXBQYXRoLmluZGV4T2YoXCIoXCIpKTtcbiAgICB2YXIgdmFsdWUgPSBjbGlwUGF0aC5yZXBsYWNlKGZ1bmN0aW9uTmFtZSArIFwiKFwiLCBcIlwiKS5yZXBsYWNlKFwiKVwiLCBcIlwiKTtcbiAgICBzd2l0Y2ggKGZ1bmN0aW9uTmFtZSkge1xuICAgICAgICBjYXNlIFwicmVjdFwiOlxuICAgICAgICAgICAgcGF0aCA9IHJlY3RQYXRoKHZhbHVlLCBib3VuZHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJpbnNldFwiOlxuICAgICAgICAgICAgcGF0aCA9IGluc2V0UGF0aCh2YWx1ZSwgYm91bmRzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiY2lyY2xlXCI6XG4gICAgICAgICAgICBwYXRoID0gY2lyY2xlUGF0aCh2YWx1ZSwgYm91bmRzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZWxsaXBzZVwiOlxuICAgICAgICAgICAgcGF0aCA9IGVsbGlwc2VQYXRoKHZhbHVlLCBib3VuZHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJwb2x5Z29uXCI6XG4gICAgICAgICAgICBwYXRoID0gcG9seWdvblBhdGgodmFsdWUsIGJvdW5kcyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKHBhdGgpIHtcbiAgICAgICAgdmFyIHNoYXBlID0gQ0FTaGFwZUxheWVyLmxheWVyKCk7XG4gICAgICAgIHNoYXBlLnBhdGggPSBwYXRoO1xuICAgICAgICBsYXllci5tYXNrID0gc2hhcGU7XG4gICAgICAgIG5hdGl2ZVZpZXcuY2xpcHNUb0JvdW5kcyA9IHRydWU7XG4gICAgICAgIHZhciBib3JkZXJXaWR0aCA9IGJhY2tncm91bmQuZ2V0VW5pZm9ybUJvcmRlcldpZHRoKCk7XG4gICAgICAgIHZhciBib3JkZXJDb2xvciA9IGJhY2tncm91bmQuZ2V0VW5pZm9ybUJvcmRlckNvbG9yKCk7XG4gICAgICAgIGlmIChib3JkZXJXaWR0aCA+IDAgJiYgYm9yZGVyQ29sb3IgaW5zdGFuY2VvZiBjb2xvcl8xLkNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgYm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgICAgIGJvcmRlckxheWVyLnBhdGggPSBwYXRoO1xuICAgICAgICAgICAgYm9yZGVyTGF5ZXIubGluZVdpZHRoID0gYm9yZGVyV2lkdGggKiAyO1xuICAgICAgICAgICAgYm9yZGVyTGF5ZXIuc3Ryb2tlQ29sb3IgPSBib3JkZXJDb2xvci5pb3MuQ0dDb2xvcjtcbiAgICAgICAgICAgIGJvcmRlckxheWVyLmZpbGxDb2xvciA9IGNsZWFyQ0dDb2xvcjtcbiAgICAgICAgICAgIGJvcmRlckxheWVyLmZyYW1lID0gbmF0aXZlVmlldy5ib3VuZHM7XG4gICAgICAgICAgICBsYXllci5ib3JkZXJDb2xvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGxheWVyLmJvcmRlcldpZHRoID0gMDtcbiAgICAgICAgICAgIGxheWVyLmFkZFN1YmxheWVyKGJvcmRlckxheWVyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHJlY3RQYXRoKHZhbHVlLCBib3VuZHMpIHtcbiAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1tcXHNdKy8pO1xuICAgIHZhciB0b3AgPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzBdLCBib3VuZHMudG9wKTtcbiAgICB2YXIgcmlnaHQgPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzFdLCBib3VuZHMucmlnaHQpO1xuICAgIHZhciBib3R0b20gPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzJdLCBib3VuZHMuYm90dG9tKTtcbiAgICB2YXIgbGVmdCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbM10sIGJvdW5kcy5sZWZ0KTtcbiAgICByZXR1cm4gVUlCZXppZXJQYXRoLmJlemllclBhdGhXaXRoUmVjdChDR1JlY3RNYWtlKGxlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0LCBib3R0b20gLSB0b3ApKS5DR1BhdGg7XG59XG5mdW5jdGlvbiBpbnNldFBhdGgodmFsdWUsIGJvdW5kcykge1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvW1xcc10rLyk7XG4gICAgdmFyIHRvcFN0cmluZztcbiAgICB2YXIgcmlnaHRTdHJpbmc7XG4gICAgdmFyIGJvdHRvbVN0cmluZztcbiAgICB2YXIgbGVmdFN0cmluZztcbiAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB0b3BTdHJpbmcgPSByaWdodFN0cmluZyA9IGJvdHRvbVN0cmluZyA9IGxlZnRTdHJpbmcgPSBhcnJbMF07XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgdG9wU3RyaW5nID0gYm90dG9tU3RyaW5nID0gYXJyWzBdO1xuICAgICAgICByaWdodFN0cmluZyA9IGxlZnRTdHJpbmcgPSBhcnJbMV07XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgdG9wU3RyaW5nID0gYXJyWzBdO1xuICAgICAgICByaWdodFN0cmluZyA9IGxlZnRTdHJpbmcgPSBhcnJbMV07XG4gICAgICAgIGJvdHRvbVN0cmluZyA9IGFyclsyXTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJyLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICB0b3BTdHJpbmcgPSBhcnJbMF07XG4gICAgICAgIHJpZ2h0U3RyaW5nID0gYXJyWzFdO1xuICAgICAgICBib3R0b21TdHJpbmcgPSBhcnJbMl07XG4gICAgICAgIGxlZnRTdHJpbmcgPSBhcnJbM107XG4gICAgfVxuICAgIHZhciB0b3AgPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModG9wU3RyaW5nLCBib3VuZHMuYm90dG9tKTtcbiAgICB2YXIgcmlnaHQgPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoXCIxMDAlXCIsIGJvdW5kcy5yaWdodCkgLSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocmlnaHRTdHJpbmcsIGJvdW5kcy5yaWdodCk7XG4gICAgdmFyIGJvdHRvbSA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhcIjEwMCVcIiwgYm91bmRzLmJvdHRvbSkgLSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYm90dG9tU3RyaW5nLCBib3VuZHMuYm90dG9tKTtcbiAgICB2YXIgbGVmdCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhsZWZ0U3RyaW5nLCBib3VuZHMucmlnaHQpO1xuICAgIHJldHVybiBVSUJlemllclBhdGguYmV6aWVyUGF0aFdpdGhSZWN0KENHUmVjdE1ha2UobGVmdCwgdG9wLCByaWdodCAtIGxlZnQsIGJvdHRvbSAtIHRvcCkpLkNHUGF0aDtcbn1cbmZ1bmN0aW9uIGNpcmNsZVBhdGgodmFsdWUsIGJvdW5kcykge1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvW1xcc10rLyk7XG4gICAgdmFyIHJhZGl1cyA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMF0sIChib3VuZHMucmlnaHQgPiBib3VuZHMuYm90dG9tID8gYm91bmRzLmJvdHRvbSA6IGJvdW5kcy5yaWdodCkgLyAyKTtcbiAgICB2YXIgeSA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMl0sIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciB4ID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFyclszXSwgYm91bmRzLnJpZ2h0KTtcbiAgICByZXR1cm4gVUlCZXppZXJQYXRoLmJlemllclBhdGhXaXRoQXJjQ2VudGVyUmFkaXVzU3RhcnRBbmdsZUVuZEFuZ2xlQ2xvY2t3aXNlKENHUG9pbnRNYWtlKHgsIHkpLCByYWRpdXMsIDAsIDM2MCwgdHJ1ZSkuQ0dQYXRoO1xufVxuZnVuY3Rpb24gZWxsaXBzZVBhdGgodmFsdWUsIGJvdW5kcykge1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvW1xcc10rLyk7XG4gICAgdmFyIHJYID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFyclswXSwgYm91bmRzLnJpZ2h0KTtcbiAgICB2YXIgclkgPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzFdLCBib3VuZHMuYm90dG9tKTtcbiAgICB2YXIgY1ggPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzNdLCBib3VuZHMucmlnaHQpO1xuICAgIHZhciBjWSA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbNF0sIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciBsZWZ0ID0gY1ggLSByWDtcbiAgICB2YXIgdG9wID0gY1kgLSByWTtcbiAgICB2YXIgd2lkdGggPSByWCAqIDI7XG4gICAgdmFyIGhlaWdodCA9IHJZICogMjtcbiAgICByZXR1cm4gVUlCZXppZXJQYXRoLmJlemllclBhdGhXaXRoT3ZhbEluUmVjdChDR1JlY3RNYWtlKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkpLkNHUGF0aDtcbn1cbmZ1bmN0aW9uIHBvbHlnb25QYXRoKHZhbHVlLCBib3VuZHMpIHtcbiAgICB2YXIgcGF0aCA9IENHUGF0aENyZWF0ZU11dGFibGUoKTtcbiAgICB2YXIgZmlyc3RQb2ludDtcbiAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1ssXSsvKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgeHkgPSBhcnJbaV0udHJpbSgpLnNwbGl0KC9bXFxzXSsvKTtcbiAgICAgICAgdmFyIHBvaW50ID0ge1xuICAgICAgICAgICAgeDogY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHh5WzBdLCBib3VuZHMucmlnaHQpLFxuICAgICAgICAgICAgeTogY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHh5WzFdLCBib3VuZHMuYm90dG9tKVxuICAgICAgICB9O1xuICAgICAgICBpZiAoIWZpcnN0UG9pbnQpIHtcbiAgICAgICAgICAgIGZpcnN0UG9pbnQgPSBwb2ludDtcbiAgICAgICAgICAgIENHUGF0aE1vdmVUb1BvaW50KHBhdGgsIG51bGwsIHBvaW50LngsIHBvaW50LnkpO1xuICAgICAgICB9XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KHBhdGgsIG51bGwsIHBvaW50LngsIHBvaW50LnkpO1xuICAgIH1cbiAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChwYXRoLCBudWxsLCBmaXJzdFBvaW50LngsIGZpcnN0UG9pbnQueSk7XG4gICAgcmV0dXJuIHBhdGg7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iYWNrZ3JvdW5kLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW51bXNfMSA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciBTVFlMRV9DVVJWRV9NQVAgPSBPYmplY3QuZnJlZXplKHtcbiAgICBcImVhc2VcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlLFxuICAgIFwibGluZWFyXCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUubGluZWFyLFxuICAgIFwiZWFzZS1pblwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2VJbixcbiAgICBcImVhc2Utb3V0XCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZU91dCxcbiAgICBcImVhc2UtaW4tb3V0XCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZUluT3V0LFxuICAgIFwic3ByaW5nXCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuc3ByaW5nLFxufSk7XG5mdW5jdGlvbiB0aW1lQ29udmVydGVyKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmICh2YWx1ZS5pbmRleE9mKFwibXNcIikgPT09IC0xKSB7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAqIDEwMDA7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLm1heCgwLjAsIHJlc3VsdCk7XG59XG5leHBvcnRzLnRpbWVDb252ZXJ0ZXIgPSB0aW1lQ29udmVydGVyO1xuZnVuY3Rpb24gYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgP1xuICAgICAgICBTVFlMRV9DVVJWRV9NQVBbdmFsdWVdIHx8IHBhcnNlQ3ViaWNCZXppZXJDdXJ2ZSh2YWx1ZSkgOlxuICAgICAgICBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2U7XG59XG5leHBvcnRzLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyID0gYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXI7XG5mdW5jdGlvbiBwYXJzZUN1YmljQmV6aWVyQ3VydmUodmFsdWUpIHtcbiAgICB2YXIgY29vcmRzU3RyaW5nID0gL1xcKCguKj8pXFwpLy5leGVjKHZhbHVlKTtcbiAgICB2YXIgY29vcmRzID0gY29vcmRzU3RyaW5nICYmIGNvb3Jkc1N0cmluZ1sxXVxuICAgICAgICAuc3BsaXQoXCIsXCIpXG4gICAgICAgIC5tYXAoc3RyaW5nVG9CZXppZUNvb3Jkcyk7XG4gICAgaWYgKHZhbHVlLnN0YXJ0c1dpdGgoXCJjdWJpYy1iZXppZXJcIikgJiZcbiAgICAgICAgY29vcmRzU3RyaW5nICYmXG4gICAgICAgIGNvb3Jkcy5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgdmFyIF9hID0gY29vcmRzLnNsaWNlKCksIHgxID0gX2FbMF0sIHgyID0gX2FbMV0sIHkxXzEgPSBfYVsyXSwgeTIgPSBfYVszXTtcbiAgICAgICAgcmV0dXJuIGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuY3ViaWNCZXppZXIoeDEsIHgyLCB5MV8xLCB5Mik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlIGZvciBhbmltYXRpb246IFwiICsgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN0cmluZ1RvQmV6aWVDb29yZHModmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKHJlc3VsdCA8IDApIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlc3VsdCA+IDEpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb252ZXJ0ZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xudmFyIGtleWZyYW1lX2FuaW1hdGlvbl8xID0gcmVxdWlyZShcIi4uL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb25cIik7XG52YXIgY29udmVydGVyc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvY29udmVydGVyc1wiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIEFOSU1BVElPTl9QUk9QRVJUWV9IQU5ETEVSUyA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwiYW5pbWF0aW9uLW5hbWVcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLm5hbWUgPSB2YWx1ZTsgfSxcbiAgICBcImFuaW1hdGlvbi1kdXJhdGlvblwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uZHVyYXRpb24gPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcih2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24tZGVsYXlcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmRlbGF5ID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvblwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uY3VydmUgPSBjb252ZXJ0ZXJzXzEuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIodmFsdWUpOyB9LFxuICAgIFwiYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudFwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uaXRlcmF0aW9ucyA9IHZhbHVlID09PSBcImluZmluaXRlXCIgPyBOdW1iZXIuTUFYX1ZBTFVFIDogcGFyc2VGbG9hdCh2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24tZGlyZWN0aW9uXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5pc1JldmVyc2UgPSB2YWx1ZSA9PT0gXCJyZXZlcnNlXCI7IH0sXG4gICAgXCJhbmltYXRpb24tZmlsbC1tb2RlXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5pc0ZvcndhcmRzID0gdmFsdWUgPT09IFwiZm9yd2FyZHNcIjsgfVxufSk7XG52YXIgQ3NzQW5pbWF0aW9uUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NBbmltYXRpb25QYXJzZXIoKSB7XG4gICAgfVxuICAgIENzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTRGVjbGFyYXRpb25zID0gZnVuY3Rpb24gKGRlY2xhcmF0aW9ucykge1xuICAgICAgICBpZiAoZGVjbGFyYXRpb25zID09PSBudWxsIHx8IGRlY2xhcmF0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBhbmltYXRpb25JbmZvID0gdW5kZWZpbmVkO1xuICAgICAgICBkZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IF9hLnByb3BlcnR5LCB2YWx1ZSA9IF9hLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHByb3BlcnR5ID09PSBcImFuaW1hdGlvblwiKSB7XG4gICAgICAgICAgICAgICAga2V5ZnJhbWVBbmltYXRpb25zRnJvbUNTU1Byb3BlcnR5KHZhbHVlLCBhbmltYXRpb25zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0eUhhbmRsZXIgPSBBTklNQVRJT05fUFJPUEVSVFlfSEFORExFUlNbcHJvcGVydHldO1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eUhhbmRsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkluZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mbyA9IG5ldyBrZXlmcmFtZV9hbmltYXRpb25fMS5LZXlmcmFtZUFuaW1hdGlvbkluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb25JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUhhbmRsZXIoYW5pbWF0aW9uSW5mbywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25zLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IGFuaW1hdGlvbnM7XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25QYXJzZXIua2V5ZnJhbWVzQXJyYXlGcm9tQ1NTID0gZnVuY3Rpb24gKGtleWZyYW1lcykge1xuICAgICAgICB2YXIgcGFyc2VkS2V5ZnJhbWVzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwga2V5ZnJhbWVzXzEgPSBrZXlmcmFtZXM7IF9pIDwga2V5ZnJhbWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ZnJhbWUgPSBrZXlmcmFtZXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgZGVjbGFyYXRpb25zID0gcGFyc2VLZXlmcmFtZURlY2xhcmF0aW9ucyhrZXlmcmFtZS5kZWNsYXJhdGlvbnMpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBfYiA9IGtleWZyYW1lLnZhbHVlczsgX2EgPCBfYi5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZV8xID0gX2JbX2FdO1xuICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPT09IFwiZnJvbVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRpbWVfMSA9PT0gXCJ0b1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSBwYXJzZUZsb2F0KHRpbWVfMSkgLyAxMDA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lXzEgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lXzEgPiAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDEwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudCA9IHBhcnNlZEtleWZyYW1lc1t0aW1lXzFdO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmR1cmF0aW9uID0gdGltZV8xO1xuICAgICAgICAgICAgICAgICAgICBwYXJzZWRLZXlmcmFtZXNbdGltZV8xXSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9jID0gMCwgX2QgPSBrZXlmcmFtZS5kZWNsYXJhdGlvbnM7IF9jIDwgX2QubGVuZ3RoOyBfYysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbiA9IF9kW19jXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlY2xhcmF0aW9uLnByb3BlcnR5ID09PSBcImFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jdXJ2ZSA9IGNvbnZlcnRlcnNfMS5hbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcihkZWNsYXJhdGlvbi52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VycmVudC5kZWNsYXJhdGlvbnMgPSBkZWNsYXJhdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIHBhcnNlZEtleWZyYW1lIGluIHBhcnNlZEtleWZyYW1lcykge1xuICAgICAgICAgICAgYXJyYXkucHVzaChwYXJzZWRLZXlmcmFtZXNbcGFyc2VkS2V5ZnJhbWVdKTtcbiAgICAgICAgfVxuICAgICAgICBhcnJheS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmR1cmF0aW9uIC0gYi5kdXJhdGlvbjsgfSk7XG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICB9O1xuICAgIHJldHVybiBDc3NBbmltYXRpb25QYXJzZXI7XG59KCkpO1xuZXhwb3J0cy5Dc3NBbmltYXRpb25QYXJzZXIgPSBDc3NBbmltYXRpb25QYXJzZXI7XG5mdW5jdGlvbiBrZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTUHJvcGVydHkodmFsdWUsIGFuaW1hdGlvbnMpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB2YWx1ZS5zcGxpdCgvWyxdKy8pO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlc18xID0gdmFsdWVzOyBfaSA8IHZhbHVlc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHBhcnNlZFZhbHVlID0gdmFsdWVzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkluZm8gPSBuZXcga2V5ZnJhbWVfYW5pbWF0aW9uXzEuS2V5ZnJhbWVBbmltYXRpb25JbmZvKCk7XG4gICAgICAgICAgICB2YXIgYXJyID0gcGFyc2VkVmFsdWUudHJpbSgpLnNwbGl0KC9bIF0rLyk7XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLm5hbWUgPSBhcnJbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLmR1cmF0aW9uID0gY29udmVydGVyc18xLnRpbWVDb252ZXJ0ZXIoYXJyWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uY3VydmUgPSBjb252ZXJ0ZXJzXzEuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIoYXJyWzJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uZGVsYXkgPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcihhcnJbM10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA0KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5pdGVyYXRpb25zID0gcGFyc2VJbnQoYXJyWzRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uaXNSZXZlcnNlID0gYXJyWzRdID09PSBcInJldmVyc2VcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gNikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uaXNGb3J3YXJkcyA9IGFycls1XSA9PT0gXCJmb3J3YXJkc1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA3KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZSBmb3IgYW5pbWF0aW9uOiBcIiArIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb25JbmZvKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnModW5wYXJzZWRLZXlmcmFtZURlY2xhcmF0aW9ucykge1xuICAgIHZhciBkZWNsYXJhdGlvbnMgPSB1bnBhcnNlZEtleWZyYW1lRGVjbGFyYXRpb25zXG4gICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGRlY2xhcmF0aW9ucywgX2EpIHtcbiAgICAgICAgdmFyIHVucGFyc2VkUHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdW5wYXJzZWRWYWx1ZSA9IF9hLnZhbHVlO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkuX2dldEJ5Q3NzTmFtZSh1bnBhcnNlZFByb3BlcnR5KTtcbiAgICAgICAgaWYgKHR5cGVvZiB1bnBhcnNlZFByb3BlcnR5ID09PSBcInN0cmluZ1wiICYmIHByb3BlcnR5ICYmIHByb3BlcnR5Ll92YWx1ZUNvbnZlcnRlcikge1xuICAgICAgICAgICAgZGVjbGFyYXRpb25zW3Byb3BlcnR5Lm5hbWVdID0gcHJvcGVydHkuX3ZhbHVlQ29udmVydGVyKHVucGFyc2VkVmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB1bnBhcnNlZFZhbHVlID09PSBcInN0cmluZ1wiICYmIHVucGFyc2VkUHJvcGVydHkgPT09IFwidHJhbnNmb3JtXCIpIHtcbiAgICAgICAgICAgIHZhciB0cmFuc2Zvcm1hdGlvbnMgPSBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNmb3JtQ29udmVydGVyKHVucGFyc2VkVmFsdWUpO1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkZWNsYXJhdGlvbnMsIHRyYW5zZm9ybWF0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlY2xhcmF0aW9ucztcbiAgICB9LCB7fSk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGRlY2xhcmF0aW9ucykubWFwKGZ1bmN0aW9uIChwcm9wZXJ0eSkgeyByZXR1cm4gKHsgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogZGVjbGFyYXRpb25zW3Byb3BlcnR5XSB9KTsgfSk7XG59XG5leHBvcnRzLnBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnMgPSBwYXJzZUtleWZyYW1lRGVjbGFyYXRpb25zO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3NzLWFuaW1hdGlvbi1wYXJzZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgdXRpbHNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdXRpbHMvdXRpbHMtY29tbW9uXCIpO1xudmFyIHBhcnNlciA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jc3MvcGFyc2VyXCIpO1xudmFyIE1hdGNoO1xuKGZ1bmN0aW9uIChNYXRjaCkge1xuICAgIE1hdGNoLkR5bmFtaWMgPSB0cnVlO1xuICAgIE1hdGNoLlN0YXRpYyA9IGZhbHNlO1xufSkoTWF0Y2ggfHwgKE1hdGNoID0ge30pKTtcbmZ1bmN0aW9uIGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUucGFyZW50IHx8ICFub2RlLnBhcmVudC5nZXRDaGlsZEluZGV4IHx8ICFub2RlLnBhcmVudC5nZXRDaGlsZEF0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgbm9kZUluZGV4ID0gbm9kZS5wYXJlbnQuZ2V0Q2hpbGRJbmRleChub2RlKTtcbiAgICBpZiAobm9kZUluZGV4ID09PSAwKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gbm9kZS5wYXJlbnQuZ2V0Q2hpbGRBdChub2RlSW5kZXggLSAxKTtcbn1cbmZ1bmN0aW9uIFNlbGVjdG9yUHJvcGVydGllcyhzcGVjaWZpY2l0eSwgcmFyaXR5LCBkeW5hbWljKSB7XG4gICAgaWYgKGR5bmFtaWMgPT09IHZvaWQgMCkgeyBkeW5hbWljID0gZmFsc2U7IH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBjbHMucHJvdG90eXBlLnNwZWNpZmljaXR5ID0gc3BlY2lmaWNpdHk7XG4gICAgICAgIGNscy5wcm90b3R5cGUucmFyaXR5ID0gcmFyaXR5O1xuICAgICAgICBjbHMucHJvdG90eXBlLmNvbWJpbmF0b3IgPSB1bmRlZmluZWQ7XG4gICAgICAgIGNscy5wcm90b3R5cGUuZHluYW1pYyA9IGR5bmFtaWM7XG4gICAgICAgIHJldHVybiBjbHM7XG4gICAgfTtcbn1cbnZhciBTZWxlY3RvckNvcmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yQ29yZSgpIHtcbiAgICB9XG4gICAgU2VsZWN0b3JDb3JlLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEFzVW5pdmVyc2FsKGJhc2UgfHwgdGhpcyk7IH07XG4gICAgU2VsZWN0b3JDb3JlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygwLCAwLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgU2VsZWN0b3JDb3JlKTtcbiAgICByZXR1cm4gU2VsZWN0b3JDb3JlO1xufSgpKTtcbmV4cG9ydHMuU2VsZWN0b3JDb3JlID0gU2VsZWN0b3JDb3JlO1xudmFyIFNpbXBsZVNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2ltcGxlU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2ltcGxlU2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU2ltcGxlU2VsZWN0b3IucHJvdG90eXBlLmFjY3VtdWxhdGVDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICBpZiAoIXRoaXMuZHluYW1pYykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5tYXlNYXRjaChub2RlKSkge1xuICAgICAgICAgICAgdGhpcy50cmFja0NoYW5nZXMobm9kZSwgbWFwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFNpbXBsZVNlbGVjdG9yLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0aGlzLm1hdGNoKG5vZGUpOyB9O1xuICAgIFNpbXBsZVNlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgfTtcbiAgICByZXR1cm4gU2ltcGxlU2VsZWN0b3I7XG59KFNlbGVjdG9yQ29yZSkpO1xuZXhwb3J0cy5TaW1wbGVTZWxlY3RvciA9IFNpbXBsZVNlbGVjdG9yO1xuZnVuY3Rpb24gd3JhcCh0ZXh0KSB7XG4gICAgcmV0dXJuIHRleHQgPyBcIiBcIiArIHRleHQgKyBcIiBcIiA6IFwiXCI7XG59XG52YXIgSW52YWxpZFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW52YWxpZFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEludmFsaWRTZWxlY3RvcihlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmUgPSBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEludmFsaWRTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIjxlcnJvcjogXCIgKyB0aGlzLmUgKyBcIj5cIjsgfTtcbiAgICBJbnZhbGlkU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgIEludmFsaWRTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICB9O1xuICAgIEludmFsaWRTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMCwgNCwgTWF0Y2guU3RhdGljKVxuICAgIF0sIEludmFsaWRTZWxlY3Rvcik7XG4gICAgcmV0dXJuIEludmFsaWRTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuSW52YWxpZFNlbGVjdG9yID0gSW52YWxpZFNlbGVjdG9yO1xudmFyIFVuaXZlcnNhbFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVW5pdmVyc2FsU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVW5pdmVyc2FsU2VsZWN0b3IoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCIqXCIgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgVW5pdmVyc2FsU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDAsIDAsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBVbml2ZXJzYWxTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFVuaXZlcnNhbFNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5Vbml2ZXJzYWxTZWxlY3RvciA9IFVuaXZlcnNhbFNlbGVjdG9yO1xudmFyIElkU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJZFNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIElkU2VsZWN0b3IoaWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaWQgPSBpZDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBJZFNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiI1wiICsgdGhpcy5pZCArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBJZFNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmlkID09PSB0aGlzLmlkOyB9O1xuICAgIElkU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7IHNvcnRlci5zb3J0QnlJZCh0aGlzLmlkLCBiYXNlIHx8IHRoaXMpOyB9O1xuICAgIElkU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDY1NTM2LCAzLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgSWRTZWxlY3Rvcik7XG4gICAgcmV0dXJuIElkU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLklkU2VsZWN0b3IgPSBJZFNlbGVjdG9yO1xudmFyIFR5cGVTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFR5cGVTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUeXBlU2VsZWN0b3IoY3NzVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jc3NUeXBlID0gY3NzVHlwZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBUeXBlU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJcIiArIHRoaXMuY3NzVHlwZSArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBUeXBlU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuY3NzVHlwZSA9PT0gdGhpcy5jc3NUeXBlOyB9O1xuICAgIFR5cGVTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHsgc29ydGVyLnNvcnRCeVR5cGUodGhpcy5jc3NUeXBlLCBiYXNlIHx8IHRoaXMpOyB9O1xuICAgIFR5cGVTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMSwgMSwgTWF0Y2guU3RhdGljKVxuICAgIF0sIFR5cGVTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFR5cGVTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuVHlwZVNlbGVjdG9yID0gVHlwZVNlbGVjdG9yO1xudmFyIENsYXNzU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDbGFzc1NlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENsYXNzU2VsZWN0b3IoY3NzQ2xhc3MpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY3NzQ2xhc3MgPSBjc3NDbGFzcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiLlwiICsgdGhpcy5jc3NDbGFzcyArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmNzc0NsYXNzZXMgJiYgbm9kZS5jc3NDbGFzc2VzLmhhcyh0aGlzLmNzc0NsYXNzKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEJ5Q2xhc3ModGhpcy5jc3NDbGFzcywgYmFzZSB8fCB0aGlzKTsgfTtcbiAgICBDbGFzc1NlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDIsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBDbGFzc1NlbGVjdG9yKTtcbiAgICByZXR1cm4gQ2xhc3NTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuQ2xhc3NTZWxlY3RvciA9IENsYXNzU2VsZWN0b3I7XG52YXIgQXR0cmlidXRlU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhBdHRyaWJ1dGVTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBdHRyaWJ1dGVTZWxlY3RvcihhdHRyaWJ1dGUsIHRlc3QsIHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmF0dHJpYnV0ZSA9IGF0dHJpYnV0ZTtcbiAgICAgICAgX3RoaXMudGVzdCA9IHRlc3Q7XG4gICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIGlmICghdGVzdCkge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gIXR5cGVzXzEuaXNOdWxsT3JVbmRlZmluZWQobm9kZVthdHRyaWJ1dGVdKTsgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXNjYXBlZFZhbHVlID0gdXRpbHNfY29tbW9uXzEuZXNjYXBlUmVnZXhTeW1ib2xzKHZhbHVlKTtcbiAgICAgICAgdmFyIHJlZ2V4cCA9IG51bGw7XG4gICAgICAgIHN3aXRjaCAodGVzdCkge1xuICAgICAgICAgICAgY2FzZSBcIl49XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIl5cIiArIGVzY2FwZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiJD1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKGVzY2FwZWRWYWx1ZSArIFwiJFwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIqPVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCI9XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIl5cIiArIGVzY2FwZWRWYWx1ZSArIFwiJFwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ+PVwiOlxuICAgICAgICAgICAgICAgIGlmICgvXFxzLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIgKyBlc2NhcGVkVmFsdWUgKyBcIihcXFxcc3wkKVwiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ8PVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBlc2NhcGVkVmFsdWUgKyBcIigtfCQpXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZWdleHApIHtcbiAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHJlZ2V4cC50ZXN0KG5vZGVbYXR0cmlidXRlXSArIFwiXCIpOyB9O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJbXCIgKyB0aGlzLmF0dHJpYnV0ZSArIHdyYXAodGhpcy50ZXN0KSArICgodGhpcy50ZXN0ICYmIHRoaXMudmFsdWUpIHx8IFwiXCIpICsgXCJdXCIgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0cnVlOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7IG1hcC5hZGRBdHRyaWJ1dGUobm9kZSwgdGhpcy5hdHRyaWJ1dGUpOyB9O1xuICAgIEF0dHJpYnV0ZVNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDAsIE1hdGNoLkR5bmFtaWMpXG4gICAgXSwgQXR0cmlidXRlU2VsZWN0b3IpO1xuICAgIHJldHVybiBBdHRyaWJ1dGVTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuQXR0cmlidXRlU2VsZWN0b3IgPSBBdHRyaWJ1dGVTZWxlY3RvcjtcbnZhciBQc2V1ZG9DbGFzc1NlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoUHNldWRvQ2xhc3NTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQc2V1ZG9DbGFzc1NlbGVjdG9yKGNzc1BzZXVkb0NsYXNzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNzc1BzZXVkb0NsYXNzID0gY3NzUHNldWRvQ2xhc3M7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIjpcIiArIHRoaXMuY3NzUHNldWRvQ2xhc3MgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5jc3NQc2V1ZG9DbGFzc2VzICYmIG5vZGUuY3NzUHNldWRvQ2xhc3Nlcy5oYXModGhpcy5jc3NQc2V1ZG9DbGFzcyk7IH07XG4gICAgUHNldWRvQ2xhc3NTZWxlY3Rvci5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdHJ1ZTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7IG1hcC5hZGRQc2V1ZG9DbGFzcyhub2RlLCB0aGlzLmNzc1BzZXVkb0NsYXNzKTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygyNTYsIDAsIE1hdGNoLkR5bmFtaWMpXG4gICAgXSwgUHNldWRvQ2xhc3NTZWxlY3Rvcik7XG4gICAgcmV0dXJuIFBzZXVkb0NsYXNzU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlBzZXVkb0NsYXNzU2VsZWN0b3IgPSBQc2V1ZG9DbGFzc1NlbGVjdG9yO1xudmFyIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTaW1wbGVTZWxlY3RvclNlcXVlbmNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2Uoc2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgX3RoaXMuc3BlY2lmaWNpdHkgPSBzZWxlY3RvcnMucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHNlbCkgeyByZXR1cm4gc2VsLnNwZWNpZmljaXR5ICsgc3VtOyB9LCAwKTtcbiAgICAgICAgX3RoaXMuaGVhZCA9IF90aGlzLnNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIGN1cnIpIHsgcmV0dXJuICFwcmV2IHx8IChjdXJyLnJhcml0eSA+IHByZXYucmFyaXR5KSA/IGN1cnIgOiBwcmV2OyB9LCBudWxsKTtcbiAgICAgICAgX3RoaXMuZHluYW1pYyA9IHNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljOyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiXCIgKyB0aGlzLnNlbGVjdG9ycy5qb2luKFwiXCIpICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5tYXRjaChub2RlKTsgfSk7IH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLm1heU1hdGNoKG5vZGUpOyB9KTtcbiAgICB9O1xuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7IH0pO1xuICAgIH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICAgICAgdGhpcy5oZWFkLmxvb2t1cFNvcnQoc29ydGVyLCBiYXNlIHx8IHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2U7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBTaW1wbGVTZWxlY3RvclNlcXVlbmNlO1xudmFyIFNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3Ioc2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgdmFyIHN1cHBvcnRlZENvbWJpbmF0b3IgPSBbdW5kZWZpbmVkLCBcIiBcIiwgXCI+XCIsIFwiK1wiXTtcbiAgICAgICAgdmFyIHNpYmxpbmdHcm91cDtcbiAgICAgICAgdmFyIGxhc3RHcm91cDtcbiAgICAgICAgdmFyIGdyb3VwcyA9IFtdO1xuICAgICAgICBzZWxlY3RvcnMucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICAgICAgaWYgKHN1cHBvcnRlZENvbWJpbmF0b3IuaW5kZXhPZihzZWwuY29tYmluYXRvcikgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5zdXBwb3J0ZWQgY29tYmluYXRvciBcXFwiXCIgKyBzZWwuY29tYmluYXRvciArIFwiXFxcIi5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsLmNvbWJpbmF0b3IgPT09IHVuZGVmaW5lZCB8fCBzZWwuY29tYmluYXRvciA9PT0gXCIgXCIpIHtcbiAgICAgICAgICAgICAgICBncm91cHMucHVzaChsYXN0R3JvdXAgPSBbc2libGluZ0dyb3VwID0gW11dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWwuY29tYmluYXRvciA9PT0gXCI+XCIpIHtcbiAgICAgICAgICAgICAgICBsYXN0R3JvdXAucHVzaChzaWJsaW5nR3JvdXAgPSBbXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzaWJsaW5nR3JvdXAucHVzaChzZWwpO1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMuZ3JvdXBzID0gZ3JvdXBzLm1hcChmdW5jdGlvbiAoZykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rvci5DaGlsZEdyb3VwKGcubWFwKGZ1bmN0aW9uIChzZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2VsZWN0b3IuU2libGluZ0dyb3VwKHNnKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzLmxhc3QgPSBzZWxlY3RvcnNbMF07XG4gICAgICAgIF90aGlzLnNwZWNpZmljaXR5ID0gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAoc3VtLCBzZWwpIHsgcmV0dXJuIHNlbC5zcGVjaWZpY2l0eSArIHN1bTsgfSwgMCk7XG4gICAgICAgIF90aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5zZWxlY3RvcnMuam9pbihcIlwiKTsgfTtcbiAgICBTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cHMuZXZlcnkoZnVuY3Rpb24gKGdyb3VwLCBpKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIG5vZGUgPSBncm91cC5tYXRjaChub2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gISFub2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGFuY2VzdG9yID0gbm9kZTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUgPSBncm91cC5tYXRjaChhbmNlc3RvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHtcbiAgICAgICAgdGhpcy5sYXN0Lmxvb2t1cFNvcnQoc29ydGVyLCB0aGlzKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yLnByb3RvdHlwZS5hY2N1bXVsYXRlQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgaWYgKCF0aGlzLmR5bmFtaWMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBib3VuZHMgPSBbXTtcbiAgICAgICAgdmFyIG1heU1hdGNoID0gdGhpcy5ncm91cHMuZXZlcnkoZnVuY3Rpb24gKGdyb3VwLCBpKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXh0Tm9kZSA9IGdyb3VwLm1heU1hdGNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIGJvdW5kcy5wdXNoKHsgbGVmdDogbm9kZSwgcmlnaHQ6IG5vZGUgfSk7XG4gICAgICAgICAgICAgICAgbm9kZSA9IG5leHROb2RlO1xuICAgICAgICAgICAgICAgIHJldHVybiAhIW5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3IgPSBub2RlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dE5vZGUgPSBncm91cC5tYXlNYXRjaChhbmNlc3Rvcik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Tm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRzLnB1c2goeyBsZWZ0OiBhbmNlc3RvciwgcmlnaHQ6IG51bGwgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlID0gbmV4dE5vZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIW1heU1hdGNoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFtYXApIHtcbiAgICAgICAgICAgIHJldHVybiBtYXlNYXRjaDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZ3JvdXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZ3JvdXBfMSA9IHRoaXMuZ3JvdXBzW2ldO1xuICAgICAgICAgICAgaWYgKCFncm91cF8xLmR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBib3VuZCA9IGJvdW5kc1tpXTtcbiAgICAgICAgICAgIHZhciBub2RlXzEgPSBib3VuZC5sZWZ0O1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGlmIChncm91cF8xLm1heU1hdGNoKG5vZGVfMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBfMS50cmFja0NoYW5nZXMobm9kZV8xLCBtYXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKChub2RlXzEgIT09IGJvdW5kLnJpZ2h0KSAmJiAobm9kZV8xID0gbm9kZV8xLnBhcmVudCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXlNYXRjaDtcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3Rvcjtcbn0oU2VsZWN0b3JDb3JlKSk7XG5leHBvcnRzLlNlbGVjdG9yID0gU2VsZWN0b3I7XG4oZnVuY3Rpb24gKFNlbGVjdG9yKSB7XG4gICAgdmFyIENoaWxkR3JvdXAgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDaGlsZEdyb3VwKHNlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgICAgICB0aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgQ2hpbGRHcm91cC5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBub2RlLnBhcmVudCkgJiYgISFzZWwubWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIENoaWxkR3JvdXAucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gbm9kZS5wYXJlbnQpICYmICEhc2VsLm1heU1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBDaGlsZEdyb3VwLnByb3RvdHlwZS50cmFja0NoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBub2RlLnBhcmVudCkgJiYgc2VsLnRyYWNrQ2hhbmdlcyhub2RlLCBtYXApOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIENoaWxkR3JvdXA7XG4gICAgfSgpKTtcbiAgICBTZWxlY3Rvci5DaGlsZEdyb3VwID0gQ2hpbGRHcm91cDtcbiAgICB2YXIgU2libGluZ0dyb3VwID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2libGluZ0dyb3VwKHNlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgICAgICB0aGlzLmR5bmFtaWMgPSBzZWxlY3RvcnMuc29tZShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYzsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgU2libGluZ0dyb3VwLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpKSAmJiBzZWwubWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIFNpYmxpbmdHcm91cC5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBnZXROb2RlRGlyZWN0U2libGluZyhub2RlKSkgJiYgc2VsLm1heU1hdGNoKG5vZGUpOyB9KSA/IG5vZGUgOiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBTaWJsaW5nR3JvdXAucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpKSAmJiBzZWwudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU2libGluZ0dyb3VwO1xuICAgIH0oKSk7XG4gICAgU2VsZWN0b3IuU2libGluZ0dyb3VwID0gU2libGluZ0dyb3VwO1xufSkoU2VsZWN0b3IgPSBleHBvcnRzLlNlbGVjdG9yIHx8IChleHBvcnRzLlNlbGVjdG9yID0ge30pKTtcbmV4cG9ydHMuU2VsZWN0b3IgPSBTZWxlY3RvcjtcbnZhciBSdWxlU2V0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSdWxlU2V0KHNlbGVjdG9ycywgZGVjbGFyYXRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICB0aGlzLmRlY2xhcmF0aW9ucyA9IGRlY2xhcmF0aW9ucztcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwucnVsZXNldCA9IF90aGlzOyB9KTtcbiAgICB9XG4gICAgUnVsZVNldC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnNlbGVjdG9ycy5qb2luKFwiLCBcIikgKyBcIiB7XCIgKyB0aGlzLmRlY2xhcmF0aW9ucy5tYXAoZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuIFwiXCIgKyAoaSA9PT0gMCA/IFwiIFwiIDogXCJcIikgKyBkLnByb3BlcnR5ICsgXCI6IFwiICsgZC52YWx1ZTsgfSkuam9pbihcIjsgXCIpICsgXCIgfVwiOyB9O1xuICAgIFJ1bGVTZXQucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyKSB7IHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmxvb2t1cFNvcnQoc29ydGVyKTsgfSk7IH07XG4gICAgcmV0dXJuIFJ1bGVTZXQ7XG59KCkpO1xuZXhwb3J0cy5SdWxlU2V0ID0gUnVsZVNldDtcbmZ1bmN0aW9uIGZyb21Bc3ROb2Rlcyhhc3RSdWxlcykge1xuICAgIHJldHVybiBhc3RSdWxlcy5maWx0ZXIoaXNSdWxlKS5tYXAoZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgdmFyIGRlY2xhcmF0aW9ucyA9IHJ1bGUuZGVjbGFyYXRpb25zLmZpbHRlcihpc0RlY2xhcmF0aW9uKS5tYXAoY3JlYXRlRGVjbGFyYXRpb24pO1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gcnVsZS5zZWxlY3RvcnMubWFwKGNyZWF0ZVNlbGVjdG9yKTtcbiAgICAgICAgdmFyIHJ1bGVzZXQgPSBuZXcgUnVsZVNldChzZWxlY3RvcnMsIGRlY2xhcmF0aW9ucyk7XG4gICAgICAgIHJldHVybiBydWxlc2V0O1xuICAgIH0pO1xufVxuZXhwb3J0cy5mcm9tQXN0Tm9kZXMgPSBmcm9tQXN0Tm9kZXM7XG5mdW5jdGlvbiBjcmVhdGVEZWNsYXJhdGlvbihkZWNsKSB7XG4gICAgcmV0dXJuIHsgcHJvcGVydHk6IGRlY2wucHJvcGVydHkudG9Mb3dlckNhc2UoKSwgdmFsdWU6IGRlY2wudmFsdWUgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZVNlbGVjdG9yRnJvbUFzdChhc3QpIHtcbiAgICBzd2l0Y2ggKGFzdC50eXBlKSB7XG4gICAgICAgIGNhc2UgXCIqXCI6IHJldHVybiBuZXcgVW5pdmVyc2FsU2VsZWN0b3IoKTtcbiAgICAgICAgY2FzZSBcIiNcIjogcmV0dXJuIG5ldyBJZFNlbGVjdG9yKGFzdC5pZGVudGlmaWVyKTtcbiAgICAgICAgY2FzZSBcIlwiOiByZXR1cm4gbmV3IFR5cGVTZWxlY3Rvcihhc3QuaWRlbnRpZmllci5yZXBsYWNlKC8tLywgXCJcIikudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGNhc2UgXCIuXCI6IHJldHVybiBuZXcgQ2xhc3NTZWxlY3Rvcihhc3QuaWRlbnRpZmllcik7XG4gICAgICAgIGNhc2UgXCI6XCI6IHJldHVybiBuZXcgUHNldWRvQ2xhc3NTZWxlY3Rvcihhc3QuaWRlbnRpZmllcik7XG4gICAgICAgIGNhc2UgXCJbXVwiOiByZXR1cm4gYXN0LnRlc3QgPyBuZXcgQXR0cmlidXRlU2VsZWN0b3IoYXN0LnByb3BlcnR5LCBhc3QudGVzdCwgYXN0LnZhbHVlKSA6IG5ldyBBdHRyaWJ1dGVTZWxlY3Rvcihhc3QucHJvcGVydHkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2VGcm9tQXN0KGFzdCkge1xuICAgIGlmIChhc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW52YWxpZFNlbGVjdG9yKG5ldyBFcnJvcihcIkVtcHR5IHNpbXBsZSBzZWxlY3RvciBzZXF1ZW5jZS5cIikpO1xuICAgIH1cbiAgICBlbHNlIGlmIChhc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVTaW1wbGVTZWxlY3RvckZyb21Bc3QoYXN0WzBdKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBuZXcgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZShhc3QubWFwKGNyZWF0ZVNpbXBsZVNlbGVjdG9yRnJvbUFzdCkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVNlbGVjdG9yRnJvbUFzdChhc3QpIHtcbiAgICBpZiAoYXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihuZXcgRXJyb3IoXCJFbXB0eSBzZWxlY3Rvci5cIikpO1xuICAgIH1cbiAgICBlbHNlIGlmIChhc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVTaW1wbGVTZWxlY3RvclNlcXVlbmNlRnJvbUFzdChhc3RbMF1bMF0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2VzID0gW107XG4gICAgICAgIHZhciBzaW1wbGVTZWxlY3RvclNlcXVlbmNlID0gdm9pZCAwO1xuICAgICAgICB2YXIgY29tYmluYXRvciA9IHZvaWQgMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBjcmVhdGVTaW1wbGVTZWxlY3RvclNlcXVlbmNlRnJvbUFzdChhc3RbaV1bMF0pO1xuICAgICAgICAgICAgY29tYmluYXRvciA9IGFzdFtpXVsxXTtcbiAgICAgICAgICAgIGlmIChjb21iaW5hdG9yKSB7XG4gICAgICAgICAgICAgICAgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5jb21iaW5hdG9yID0gY29tYmluYXRvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2VzLnB1c2goc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3RvcihzaW1wbGVTZWxlY3RvclNlcXVlbmNlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlU2VsZWN0b3Ioc2VsKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIHBhcnNlZFNlbGVjdG9yID0gcGFyc2VyLnBhcnNlU2VsZWN0b3Ioc2VsKTtcbiAgICAgICAgaWYgKCFwYXJzZWRTZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnZhbGlkU2VsZWN0b3IobmV3IEVycm9yKFwiRW1wdHkgc2VsZWN0b3JcIikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVTZWxlY3RvckZyb21Bc3QocGFyc2VkU2VsZWN0b3IudmFsdWUpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihlKTtcbiAgICB9XG59XG5leHBvcnRzLmNyZWF0ZVNlbGVjdG9yID0gY3JlYXRlU2VsZWN0b3I7XG5mdW5jdGlvbiBpc1J1bGUobm9kZSkge1xuICAgIHJldHVybiBub2RlLnR5cGUgPT09IFwicnVsZVwiO1xufVxuZnVuY3Rpb24gaXNEZWNsYXJhdGlvbihub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gXCJkZWNsYXJhdGlvblwiO1xufVxudmFyIFNlbGVjdG9yc01hcCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3JzTWFwKHJ1bGVzZXRzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuaWQgPSB7fTtcbiAgICAgICAgdGhpcy5jbGFzcyA9IHt9O1xuICAgICAgICB0aGlzLnR5cGUgPSB7fTtcbiAgICAgICAgdGhpcy51bml2ZXJzYWwgPSBbXTtcbiAgICAgICAgdGhpcy5wb3NpdGlvbiA9IDA7XG4gICAgICAgIHJ1bGVzZXRzLmZvckVhY2goZnVuY3Rpb24gKHJ1bGUpIHsgcmV0dXJuIHJ1bGUubG9va3VwU29ydChfdGhpcyk7IH0pO1xuICAgIH1cbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHNlbGVjdG9yQ2xhc3NlcyA9IFtcbiAgICAgICAgICAgIHRoaXMudW5pdmVyc2FsLFxuICAgICAgICAgICAgdGhpcy5pZFtub2RlLmlkXSxcbiAgICAgICAgICAgIHRoaXMudHlwZVtub2RlLmNzc1R5cGVdXG4gICAgICAgIF07XG4gICAgICAgIGlmIChub2RlLmNzc0NsYXNzZXMpIHtcbiAgICAgICAgICAgIG5vZGUuY3NzQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7IHJldHVybiBzZWxlY3RvckNsYXNzZXMucHVzaChfdGhpcy5jbGFzc1tjXSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWxlY3RvcnMgPSBzZWxlY3RvckNsYXNzZXNcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFycikgeyByZXR1cm4gISFhcnI7IH0pXG4gICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChjdXIsIG5leHQpIHsgcmV0dXJuIGN1ci5jb25jYXQobmV4dCk7IH0sIFtdKTtcbiAgICAgICAgdmFyIHNlbGVjdG9yc01hdGNoID0gbmV3IFNlbGVjdG9yc01hdGNoKCk7XG4gICAgICAgIHNlbGVjdG9yc01hdGNoLnNlbGVjdG9ycyA9IHNlbGVjdG9yc1xuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuc2VsLmFjY3VtdWxhdGVDaGFuZ2VzKG5vZGUsIHNlbGVjdG9yc01hdGNoKTsgfSlcbiAgICAgICAgICAgIC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLnNlbC5zcGVjaWZpY2l0eSAtIGIuc2VsLnNwZWNpZmljaXR5IHx8IGEucG9zIC0gYi5wb3M7IH0pXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkb2NTZWwpIHsgcmV0dXJuIGRvY1NlbC5zZWw7IH0pO1xuICAgICAgICByZXR1cm4gc2VsZWN0b3JzTWF0Y2g7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRCeUlkID0gZnVuY3Rpb24gKGlkLCBzZWwpIHsgdGhpcy5hZGRUb01hcCh0aGlzLmlkLCBpZCwgc2VsKTsgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRCeUNsYXNzID0gZnVuY3Rpb24gKGNzc0NsYXNzLCBzZWwpIHtcbiAgICAgICAgdGhpcy5hZGRUb01hcCh0aGlzLmNsYXNzLCBjc3NDbGFzcywgc2VsKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuc29ydEJ5VHlwZSA9IGZ1bmN0aW9uIChjc3NUeXBlLCBzZWwpIHtcbiAgICAgICAgdGhpcy5hZGRUb01hcCh0aGlzLnR5cGUsIGNzc1R5cGUsIHNlbCk7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLnNvcnRBc1VuaXZlcnNhbCA9IGZ1bmN0aW9uIChzZWwpIHsgdGhpcy51bml2ZXJzYWwucHVzaCh0aGlzLm1ha2VEb2NTZWxlY3RvcihzZWwpKTsgfTtcbiAgICBTZWxlY3RvcnNNYXAucHJvdG90eXBlLmFkZFRvTWFwID0gZnVuY3Rpb24gKG1hcCwgaGVhZCwgc2VsKSB7XG4gICAgICAgIHRoaXMucG9zaXRpb24rKztcbiAgICAgICAgdmFyIGxpc3QgPSBtYXBbaGVhZF07XG4gICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICBsaXN0LnB1c2godGhpcy5tYWtlRG9jU2VsZWN0b3Ioc2VsKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBtYXBbaGVhZF0gPSBbdGhpcy5tYWtlRG9jU2VsZWN0b3Ioc2VsKV07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUubWFrZURvY1NlbGVjdG9yID0gZnVuY3Rpb24gKHNlbCkge1xuICAgICAgICByZXR1cm4geyBzZWw6IHNlbCwgcG9zOiB0aGlzLnBvc2l0aW9uKysgfTtcbiAgICB9O1xuICAgIHJldHVybiBTZWxlY3RvcnNNYXA7XG59KCkpO1xuZXhwb3J0cy5TZWxlY3RvcnNNYXAgPSBTZWxlY3RvcnNNYXA7XG52YXIgU2VsZWN0b3JzTWF0Y2ggPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlbGVjdG9yc01hdGNoKCkge1xuICAgICAgICB0aGlzLmNoYW5nZU1hcCA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLmFkZEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChub2RlLCBhdHRyaWJ1dGUpIHtcbiAgICAgICAgdmFyIGRlcHMgPSB0aGlzLnByb3BlcnRpZXMobm9kZSk7XG4gICAgICAgIGlmICghZGVwcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBkZXBzLmF0dHJpYnV0ZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZGVwcy5hdHRyaWJ1dGVzLmFkZChhdHRyaWJ1dGUpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLmFkZFBzZXVkb0NsYXNzID0gZnVuY3Rpb24gKG5vZGUsIHBzZXVkb0NsYXNzKSB7XG4gICAgICAgIHZhciBkZXBzID0gdGhpcy5wcm9wZXJ0aWVzKG5vZGUpO1xuICAgICAgICBpZiAoIWRlcHMucHNldWRvQ2xhc3Nlcykge1xuICAgICAgICAgICAgZGVwcy5wc2V1ZG9DbGFzc2VzID0gbmV3IFNldCgpO1xuICAgICAgICB9XG4gICAgICAgIGRlcHMucHNldWRvQ2xhc3Nlcy5hZGQocHNldWRvQ2xhc3MpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWF0Y2gucHJvdG90eXBlLnByb3BlcnRpZXMgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB2YXIgc2V0ID0gdGhpcy5jaGFuZ2VNYXAuZ2V0KG5vZGUpO1xuICAgICAgICBpZiAoIXNldCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VNYXAuc2V0KG5vZGUsIHNldCA9IHt9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2V0O1xuICAgIH07XG4gICAgcmV0dXJuIFNlbGVjdG9yc01hdGNoO1xufSgpKTtcbmV4cG9ydHMuU2VsZWN0b3JzTWF0Y2ggPSBTZWxlY3RvcnNNYXRjaDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNzcy1zZWxlY3Rvci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBGb250ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGb250KGZvbnRGYW1pbHksIGZvbnRTaXplLCBmb250U3R5bGUsIGZvbnRXZWlnaHQpIHtcbiAgICAgICAgdGhpcy5mb250RmFtaWx5ID0gZm9udEZhbWlseTtcbiAgICAgICAgdGhpcy5mb250U2l6ZSA9IGZvbnRTaXplO1xuICAgICAgICB0aGlzLmZvbnRTdHlsZSA9IGZvbnRTdHlsZTtcbiAgICAgICAgdGhpcy5mb250V2VpZ2h0ID0gZm9udFdlaWdodDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvbnQucHJvdG90eXBlLCBcImlzSXRhbGljXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb250U3R5bGUgPT09IEZvbnRTdHlsZS5JVEFMSUM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb250LnByb3RvdHlwZSwgXCJpc0JvbGRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuU0VNSV9CT0xEIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5mb250V2VpZ2h0ID09PSBGb250V2VpZ2h0LkJPTEQgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IFwiNzAwXCIgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuRVhUUkFfQk9MRCB8fFxuICAgICAgICAgICAgICAgIHRoaXMuZm9udFdlaWdodCA9PT0gRm9udFdlaWdodC5CTEFDSztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRm9udC5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKCF2YWx1ZTEgJiYgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2YWx1ZTEgfHwgIXZhbHVlMikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTEuZm9udEZhbWlseSA9PT0gdmFsdWUyLmZvbnRGYW1pbHkgJiZcbiAgICAgICAgICAgIHZhbHVlMS5mb250U2l6ZSA9PT0gdmFsdWUyLmZvbnRTaXplICYmXG4gICAgICAgICAgICB2YWx1ZTEuZm9udFN0eWxlID09PSB2YWx1ZTIuZm9udFN0eWxlICYmXG4gICAgICAgICAgICB2YWx1ZTEuZm9udFdlaWdodCA9PT0gdmFsdWUyLmZvbnRXZWlnaHQ7XG4gICAgfTtcbiAgICBGb250LmRlZmF1bHQgPSB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIEZvbnQ7XG59KCkpO1xuZXhwb3J0cy5Gb250ID0gRm9udDtcbnZhciBGb250U3R5bGU7XG4oZnVuY3Rpb24gKEZvbnRTdHlsZSkge1xuICAgIEZvbnRTdHlsZS5OT1JNQUwgPSBcIm5vcm1hbFwiO1xuICAgIEZvbnRTdHlsZS5JVEFMSUMgPSBcIml0YWxpY1wiO1xuICAgIEZvbnRTdHlsZS5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoRm9udFN0eWxlLk5PUk1BTCwgRm9udFN0eWxlLklUQUxJQyk7XG4gICAgRm9udFN0eWxlLnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoRm9udFN0eWxlLmlzVmFsaWQpO1xufSkoRm9udFN0eWxlID0gZXhwb3J0cy5Gb250U3R5bGUgfHwgKGV4cG9ydHMuRm9udFN0eWxlID0ge30pKTtcbnZhciBGb250V2VpZ2h0O1xuKGZ1bmN0aW9uIChGb250V2VpZ2h0KSB7XG4gICAgRm9udFdlaWdodC5USElOID0gXCIxMDBcIjtcbiAgICBGb250V2VpZ2h0LkVYVFJBX0xJR0hUID0gXCIyMDBcIjtcbiAgICBGb250V2VpZ2h0LkxJR0hUID0gXCIzMDBcIjtcbiAgICBGb250V2VpZ2h0Lk5PUk1BTCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFdlaWdodC5NRURJVU0gPSBcIjUwMFwiO1xuICAgIEZvbnRXZWlnaHQuU0VNSV9CT0xEID0gXCI2MDBcIjtcbiAgICBGb250V2VpZ2h0LkJPTEQgPSBcImJvbGRcIjtcbiAgICBGb250V2VpZ2h0LkVYVFJBX0JPTEQgPSBcIjgwMFwiO1xuICAgIEZvbnRXZWlnaHQuQkxBQ0sgPSBcIjkwMFwiO1xuICAgIEZvbnRXZWlnaHQuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKEZvbnRXZWlnaHQuVEhJTiwgRm9udFdlaWdodC5FWFRSQV9MSUdIVCwgRm9udFdlaWdodC5MSUdIVCwgRm9udFdlaWdodC5OT1JNQUwsIFwiNDAwXCIsIEZvbnRXZWlnaHQuTUVESVVNLCBGb250V2VpZ2h0LlNFTUlfQk9MRCwgRm9udFdlaWdodC5CT0xELCBcIjcwMFwiLCBGb250V2VpZ2h0LkVYVFJBX0JPTEQsIEZvbnRXZWlnaHQuQkxBQ0spO1xuICAgIEZvbnRXZWlnaHQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihGb250V2VpZ2h0LmlzVmFsaWQpO1xufSkoRm9udFdlaWdodCA9IGV4cG9ydHMuRm9udFdlaWdodCB8fCAoZXhwb3J0cy5Gb250V2VpZ2h0ID0ge30pKTtcbmZ1bmN0aW9uIHBhcnNlRm9udEZhbWlseSh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoKTtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZhciBzcGxpdCA9IHZhbHVlLnNwbGl0KFwiLFwiKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwbGl0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBzdHIgPSBzcGxpdFtpXS50cmltKCkucmVwbGFjZSgvWydcIl0rL2csIFwiXCIpO1xuICAgICAgICBpZiAoc3RyKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChzdHIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLnBhcnNlRm9udEZhbWlseSA9IHBhcnNlRm9udEZhbWlseTtcbnZhciBnZW5lcmljRm9udEZhbWlsaWVzO1xuKGZ1bmN0aW9uIChnZW5lcmljRm9udEZhbWlsaWVzKSB7XG4gICAgZ2VuZXJpY0ZvbnRGYW1pbGllcy5zZXJpZiA9IFwic2VyaWZcIjtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLnNhbnNTZXJpZiA9IFwic2Fucy1zZXJpZlwiO1xuICAgIGdlbmVyaWNGb250RmFtaWxpZXMubW9ub3NwYWNlID0gXCJtb25vc3BhY2VcIjtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLnN5c3RlbSA9IFwic3lzdGVtXCI7XG59KShnZW5lcmljRm9udEZhbWlsaWVzID0gZXhwb3J0cy5nZW5lcmljRm9udEZhbWlsaWVzIHx8IChleHBvcnRzLmdlbmVyaWNGb250RmFtaWxpZXMgPSB7fSkpO1xudmFyIHN0eWxlcyA9IG5ldyBTZXQoKTtcbltcbiAgICBGb250U3R5bGUuTk9STUFMLFxuICAgIEZvbnRTdHlsZS5JVEFMSUNcbl0uZm9yRWFjaChmdW5jdGlvbiAodmFsLCBpLCBhKSB7IHJldHVybiBzdHlsZXMuYWRkKHZhbCk7IH0pO1xudmFyIHdlaWdodHMgPSBuZXcgU2V0KCk7XG5bXG4gICAgRm9udFdlaWdodC5USElOLFxuICAgIEZvbnRXZWlnaHQuRVhUUkFfTElHSFQsXG4gICAgRm9udFdlaWdodC5MSUdIVCxcbiAgICBGb250V2VpZ2h0Lk5PUk1BTCxcbiAgICBcIjQwMFwiLFxuICAgIEZvbnRXZWlnaHQuTUVESVVNLFxuICAgIEZvbnRXZWlnaHQuU0VNSV9CT0xELFxuICAgIEZvbnRXZWlnaHQuQk9MRCxcbiAgICBcIjcwMFwiLFxuICAgIEZvbnRXZWlnaHQuRVhUUkFfQk9MRCxcbiAgICBGb250V2VpZ2h0LkJMQUNLXG5dLmZvckVhY2goZnVuY3Rpb24gKHZhbCwgaSwgYSkgeyByZXR1cm4gd2VpZ2h0cy5hZGQodmFsKTsgfSk7XG5mdW5jdGlvbiBwYXJzZUZvbnQoZm9udFZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgZm9udFN0eWxlOiBcIm5vcm1hbFwiLFxuICAgICAgICBmb250VmFyaWFudDogXCJub3JtYWxcIixcbiAgICAgICAgZm9udFdlaWdodDogXCJub3JtYWxcIlxuICAgIH07XG4gICAgdmFyIHBhcnRzID0gZm9udFZhbHVlLnNwbGl0KC9cXHMrLyk7XG4gICAgdmFyIHBhcnQ7XG4gICAgd2hpbGUgKHBhcnQgPSBwYXJ0cy5zaGlmdCgpKSB7XG4gICAgICAgIGlmIChwYXJ0ID09PSBcIm5vcm1hbFwiKSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGFydCA9PT0gXCJzbWFsbC1jYXBzXCIpIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250VmFyaWFudCA9IHBhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3R5bGVzLmhhcyhwYXJ0KSkge1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRTdHlsZSA9IHBhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAod2VpZ2h0cy5oYXMocGFydCkpIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250V2VpZ2h0ID0gcGFydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghcmVzdWx0LmZvbnRTaXplKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZXMgPSBwYXJ0LnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIHJlc3VsdC5mb250U2l6ZSA9IHNpemVzWzBdO1xuICAgICAgICAgICAgcmVzdWx0LmxpbmVIZWlnaHQgPSBzaXplcy5sZW5ndGggPiAxID8gc2l6ZXNbMV0gOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQuZm9udEZhbWlseSA9IHBhcnQ7XG4gICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmZvbnRGYW1pbHkgKz0gXCIgXCIgKyBwYXJ0cy5qb2luKFwiIFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLnBhcnNlRm9udCA9IHBhcnNlRm9udDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvbnQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZm9udF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2ZvbnQtY29tbW9uXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBmcyA9IHJlcXVpcmUoXCIuLi8uLi9maWxlLXN5c3RlbVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ZvbnQtY29tbW9uXCIpKTtcbnZhciBFTVVMQVRFX09CTElRVUUgPSB0cnVlO1xudmFyIE9CTElRVUVfVFJBTlNGT1JNID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlKDEsIDAsIDAuMiwgMSwgMCwgMCk7XG52YXIgREVGQVVMVF9TRVJJRiA9IFwiVGltZXMgTmV3IFJvbWFuXCI7XG52YXIgREVGQVVMVF9NT05PU1BBQ0UgPSBcIkNvdXJpZXIgTmV3XCI7XG52YXIgU1VQUE9SVF9GT05UX1dFSUdIVFMgPSBwYXJzZUZsb2F0KHBsYXRmb3JtXzEuZGV2aWNlLm9zVmVyc2lvbikgPj0gMTAuMDtcbnZhciBGb250ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRm9udCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGb250KGZhbWlseSwgc2l6ZSwgc3R5bGUsIHdlaWdodCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZmFtaWx5LCBzaXplLCBzdHlsZSwgd2VpZ2h0KSB8fCB0aGlzO1xuICAgIH1cbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udEZhbWlseSA9IGZ1bmN0aW9uIChmYW1pbHkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KGZhbWlseSwgdGhpcy5mb250U2l6ZSwgdGhpcy5mb250U3R5bGUsIHRoaXMuZm9udFdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udFN0eWxlID0gZnVuY3Rpb24gKHN0eWxlKSB7XG4gICAgICAgIHJldHVybiBuZXcgRm9udCh0aGlzLmZvbnRGYW1pbHksIHRoaXMuZm9udFNpemUsIHN0eWxlLCB0aGlzLmZvbnRXZWlnaHQpO1xuICAgIH07XG4gICAgRm9udC5wcm90b3R5cGUud2l0aEZvbnRXZWlnaHQgPSBmdW5jdGlvbiAod2VpZ2h0KSB7XG4gICAgICAgIHJldHVybiBuZXcgRm9udCh0aGlzLmZvbnRGYW1pbHksIHRoaXMuZm9udFNpemUsIHRoaXMuZm9udFN0eWxlLCB3ZWlnaHQpO1xuICAgIH07XG4gICAgRm9udC5wcm90b3R5cGUud2l0aEZvbnRTaXplID0gZnVuY3Rpb24gKHNpemUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KHRoaXMuZm9udEZhbWlseSwgc2l6ZSwgdGhpcy5mb250U3R5bGUsIHRoaXMuZm9udFdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS5nZXRVSUZvbnQgPSBmdW5jdGlvbiAoZGVmYXVsdEZvbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLl91aUZvbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX3VpRm9udCA9IGNyZWF0ZVVJRm9udCh0aGlzLCBkZWZhdWx0Rm9udCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3VpRm9udDtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLmdldEFuZHJvaWRUeXBlZmFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIEZvbnQuZGVmYXVsdCA9IG5ldyBGb250KHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBmb250X2NvbW1vbl8xLkZvbnRTdHlsZS5OT1JNQUwsIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5OT1JNQUwpO1xuICAgIHJldHVybiBGb250O1xufShmb250X2NvbW1vbl8xLkZvbnQpKTtcbmV4cG9ydHMuRm9udCA9IEZvbnQ7XG5mdW5jdGlvbiBnZXRGb250RmFtaWx5UmVzcGVjdGluZ0dlbmVyaWNGb250cyhmb250RmFtaWx5KSB7XG4gICAgaWYgKCFmb250RmFtaWx5KSB7XG4gICAgICAgIHJldHVybiBmb250RmFtaWx5O1xuICAgIH1cbiAgICBzd2l0Y2ggKGZvbnRGYW1pbHkudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5zZXJpZjpcbiAgICAgICAgICAgIHJldHVybiBERUZBVUxUX1NFUklGO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5tb25vc3BhY2U6XG4gICAgICAgICAgICByZXR1cm4gREVGQVVMVF9NT05PU1BBQ0U7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZm9udEZhbWlseTtcbiAgICB9XG59XG5mdW5jdGlvbiBzaG91bGRVc2VTeXN0ZW1Gb250KGZvbnRGYW1pbHkpIHtcbiAgICByZXR1cm4gIWZvbnRGYW1pbHkgfHxcbiAgICAgICAgZm9udEZhbWlseSA9PT0gZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLnNhbnNTZXJpZiB8fFxuICAgICAgICBmb250RmFtaWx5ID09PSBmb250X2NvbW1vbl8xLmdlbmVyaWNGb250RmFtaWxpZXMuc3lzdGVtO1xufVxuZnVuY3Rpb24gZ2V0TmF0aXZlRm9udFdlaWdodChmb250V2VpZ2h0KSB7XG4gICAgc3dpdGNoIChmb250V2VpZ2h0KSB7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LlRISU46XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0VWx0cmFMaWdodDtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuRVhUUkFfTElHSFQ6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0VGhpbjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTElHSFQ6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0TGlnaHQ7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0Lk5PUk1BTDpcbiAgICAgICAgY2FzZSBcIjQwMFwiOlxuICAgICAgICBjYXNlIHVuZGVmaW5lZDpcbiAgICAgICAgY2FzZSBudWxsOlxuICAgICAgICAgICAgcmV0dXJuIFVJRm9udFdlaWdodFJlZ3VsYXI7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0Lk1FRElVTTpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRNZWRpdW07XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LlNFTUlfQk9MRDpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRTZW1pYm9sZDtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuQk9MRDpcbiAgICAgICAgY2FzZSBcIjcwMFwiOlxuICAgICAgICAgICAgcmV0dXJuIFVJRm9udFdlaWdodEJvbGQ7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LkVYVFJBX0JPTEQ6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0SGVhdnk7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0LkJMQUNLOlxuICAgICAgICAgICAgcmV0dXJuIFVJRm9udFdlaWdodEJsYWNrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBmb250IHdlaWdodDogXFxcIlwiICsgZm9udFdlaWdodCArIFwiXFxcIlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRTeXN0ZW1Gb250KHNpemUsIG5hdGl2ZVdlaWdodCwgaXRhbGljLCBzeW1ib2xpY1RyYWl0cykge1xuICAgIHZhciByZXN1bHQgPSBVSUZvbnQuc3lzdGVtRm9udE9mU2l6ZVdlaWdodChzaXplLCBuYXRpdmVXZWlnaHQpO1xuICAgIGlmIChpdGFsaWMpIHtcbiAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSByZXN1bHQuZm9udERlc2NyaXB0b3IuZm9udERlc2NyaXB0b3JXaXRoU3ltYm9saWNUcmFpdHMoc3ltYm9saWNUcmFpdHMpO1xuICAgICAgICByZXN1bHQgPSBVSUZvbnQuZm9udFdpdGhEZXNjcmlwdG9yU2l6ZShkZXNjcmlwdG9yLCBzaXplKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVVJRm9udChmb250LCBkZWZhdWx0Rm9udCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgdmFyIHJlc3VsdDtcbiAgICB2YXIgc2l6ZSA9IGZvbnQuZm9udFNpemUgfHwgZGVmYXVsdEZvbnQucG9pbnRTaXplO1xuICAgIHZhciBuYXRpdmVXZWlnaHQgPSBnZXROYXRpdmVGb250V2VpZ2h0KGZvbnQuZm9udFdlaWdodCk7XG4gICAgdmFyIGZvbnRGYW1pbGllcyA9IGZvbnRfY29tbW9uXzEucGFyc2VGb250RmFtaWx5KGZvbnQuZm9udEZhbWlseSk7XG4gICAgdmFyIHN5bWJvbGljVHJhaXRzID0gMDtcbiAgICBpZiAoZm9udC5pc0JvbGQpIHtcbiAgICAgICAgc3ltYm9saWNUcmFpdHMgfD0gMjtcbiAgICB9XG4gICAgaWYgKGZvbnQuaXNJdGFsaWMpIHtcbiAgICAgICAgc3ltYm9saWNUcmFpdHMgfD0gMTtcbiAgICB9XG4gICAgdmFyIGZvbnREZXNjcmlwdG9yVHJhaXRzID0gKF9hID0ge30sXG4gICAgICAgIF9hW1VJRm9udFN5bWJvbGljVHJhaXRdID0gc3ltYm9saWNUcmFpdHMsXG4gICAgICAgIF9hKTtcbiAgICBpZiAoU1VQUE9SVF9GT05UX1dFSUdIVFMpIHtcbiAgICAgICAgZm9udERlc2NyaXB0b3JUcmFpdHNbVUlGb250V2VpZ2h0VHJhaXRdID0gbmF0aXZlV2VpZ2h0O1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvbnRGYW1pbGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZm9udEZhbWlseSA9IGdldEZvbnRGYW1pbHlSZXNwZWN0aW5nR2VuZXJpY0ZvbnRzKGZvbnRGYW1pbGllc1tpXSk7XG4gICAgICAgIGlmIChzaG91bGRVc2VTeXN0ZW1Gb250KGZvbnRGYW1pbHkpKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBnZXRTeXN0ZW1Gb250KHNpemUsIG5hdGl2ZVdlaWdodCwgZm9udC5pc0l0YWxpYywgc3ltYm9saWNUcmFpdHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZm9udEF0dHJpYnV0ZXMgPSAoX2IgPSB7fSxcbiAgICAgICAgICAgICAgICBfYltVSUZvbnREZXNjcmlwdG9yRmFtaWx5QXR0cmlidXRlXSA9IGZvbnRGYW1pbHksXG4gICAgICAgICAgICAgICAgX2JbVUlGb250RGVzY3JpcHRvclRyYWl0c0F0dHJpYnV0ZV0gPSBmb250RGVzY3JpcHRvclRyYWl0cyxcbiAgICAgICAgICAgICAgICBfYik7XG4gICAgICAgICAgICB2YXIgZGVzY3JpcHRvciA9IFVJRm9udERlc2NyaXB0b3IuZm9udERlc2NyaXB0b3JXaXRoRm9udEF0dHJpYnV0ZXMoZm9udEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgcmVzdWx0ID0gVUlGb250LmZvbnRXaXRoRGVzY3JpcHRvclNpemUoZGVzY3JpcHRvciwgc2l6ZSk7XG4gICAgICAgICAgICB2YXIgYWN0dWFsSXRhbGljID0gcmVzdWx0LmZvbnREZXNjcmlwdG9yLnN5bWJvbGljVHJhaXRzICYgMTtcbiAgICAgICAgICAgIGlmIChmb250LmlzSXRhbGljICYmICFhY3R1YWxJdGFsaWMgJiYgRU1VTEFURV9PQkxJUVVFKSB7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRvciA9IGRlc2NyaXB0b3IuZm9udERlc2NyaXB0b3JXaXRoTWF0cml4KE9CTElRVUVfVFJBTlNGT1JNKTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBVSUZvbnQuZm9udFdpdGhEZXNjcmlwdG9yU2l6ZShkZXNjcmlwdG9yLCBzaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQuZmFtaWx5TmFtZSA9PT0gZm9udEZhbWlseSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXN1bHQgPSBnZXRTeXN0ZW1Gb250KHNpemUsIG5hdGl2ZVdlaWdodCwgZm9udC5pc0l0YWxpYywgc3ltYm9saWNUcmFpdHMpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxudmFyIGlvcztcbihmdW5jdGlvbiAoaW9zKSB7XG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJGb250KGZvbnRGaWxlKSB7XG4gICAgICAgIHZhciBmaWxlUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIFwiZm9udHNcIiwgZm9udEZpbGUpO1xuICAgICAgICBpZiAoIWZzLkZpbGUuZXhpc3RzKGZpbGVQYXRoKSkge1xuICAgICAgICAgICAgZmlsZVBhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBmb250RmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZvbnREYXRhID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlci5jb250ZW50c0F0UGF0aChmaWxlUGF0aCk7XG4gICAgICAgIGlmICghZm9udERhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBsb2FkIGZvbnQgZnJvbTogXCIgKyBmb250RmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByb3ZpZGVyID0gQ0dEYXRhUHJvdmlkZXJDcmVhdGVXaXRoQ0ZEYXRhKGZvbnREYXRhKTtcbiAgICAgICAgdmFyIGZvbnQgPSBDR0ZvbnRDcmVhdGVXaXRoRGF0YVByb3ZpZGVyKHByb3ZpZGVyKTtcbiAgICAgICAgaWYgKCFmb250KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgbG9hZCBmb250IGZyb206IFwiICsgZm9udEZpbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlcnJvciA9IG5ldyBpbnRlcm9wLlJlZmVyZW5jZSgpO1xuICAgICAgICBpZiAoIUNURm9udE1hbmFnZXJSZWdpc3RlckdyYXBoaWNzRm9udChmb250LCBlcnJvcikpIHtcbiAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIG9jY3VyIHdoaWxlIHJlZ2lzdGVyaW5nIGZvbnQ6IFwiICsgQ0ZFcnJvckNvcHlEZXNjcmlwdGlvbihlcnJvci52YWx1ZSksIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW9zLnJlZ2lzdGVyRm9udCA9IHJlZ2lzdGVyRm9udDtcbn0pKGlvcyA9IGV4cG9ydHMuaW9zIHx8IChleHBvcnRzLmlvcyA9IHt9KSk7XG5mdW5jdGlvbiByZWdpc3RlckZvbnRzSW5Gb2xkZXIoZm9udHNGb2xkZXJQYXRoKSB7XG4gICAgdmFyIGZvbnRzRm9sZGVyID0gZnMuRm9sZGVyLmZyb21QYXRoKGZvbnRzRm9sZGVyUGF0aCk7XG4gICAgZm9udHNGb2xkZXIuZWFjaEVudGl0eShmdW5jdGlvbiAoZmlsZUVudGl0eSkge1xuICAgICAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyhmcy5wYXRoLmpvaW4oZm9udHNGb2xkZXJQYXRoLCBmaWxlRW50aXR5Lm5hbWUpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbGVFbnRpdHkgaW5zdGFuY2VvZiBmcy5GaWxlICYmXG4gICAgICAgICAgICAoZmlsZUVudGl0eS5leHRlbnNpb24gPT09IFwiLnR0ZlwiIHx8IGZpbGVFbnRpdHkuZXh0ZW5zaW9uID09PSBcIi5vdGZcIikpIHtcbiAgICAgICAgICAgIGlvcy5yZWdpc3RlckZvbnQoZmlsZUVudGl0eS5uYW1lKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIHJlZ2lzdGVyQ3VzdG9tRm9udHMoKSB7XG4gICAgdmFyIGFwcERpciA9IGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICB2YXIgZm9udHNEaXIgPSBmcy5wYXRoLmpvaW4oYXBwRGlyLCBcImZvbnRzXCIpO1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKGZvbnRzRGlyKSkge1xuICAgICAgICByZWdpc3RlckZvbnRzSW5Gb2xkZXIoZm9udHNEaXIpO1xuICAgIH1cbn1cbnJlZ2lzdGVyQ3VzdG9tRm9udHMoKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvbnQuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xudmFyIExpbmVhckdyYWRpZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMaW5lYXJHcmFkaWVudCgpIHtcbiAgICB9XG4gICAgTGluZWFyR3JhZGllbnQucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBMaW5lYXJHcmFkaWVudCgpO1xuICAgICAgICByZXN1bHQuYW5nbGUgPSB2YWx1ZS5hbmdsZTtcbiAgICAgICAgcmVzdWx0LmNvbG9yU3RvcHMgPSB2YWx1ZS5jb2xvcnMubWFwKGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9IGNvbG9yLm9mZnNldCB8fCBudWxsO1xuICAgICAgICAgICAgdmFyIG9mZnNldFVuaXQ7XG4gICAgICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgICAgIG9mZnNldFVuaXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiJVwiLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb2Zmc2V0LnZhbHVlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY29sb3I6IG5ldyBjb2xvcl8xLkNvbG9yKGNvbG9yLmFyZ2IpLFxuICAgICAgICAgICAgICAgIG9mZnNldDogb2Zmc2V0VW5pdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBMaW5lYXJHcmFkaWVudC5lcXVhbHMgPSBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoIWZpcnN0ICYmICFzZWNvbmQpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFmaXJzdCB8fCAhc2Vjb25kKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpcnN0LmFuZ2xlICE9PSBzZWNvbmQuYW5nbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3QuY29sb3JTdG9wcy5sZW5ndGggIT09IHNlY29uZC5jb2xvclN0b3BzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlyc3QuY29sb3JTdG9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGZpcnN0U3RvcCA9IGZpcnN0LmNvbG9yU3RvcHNbaV07XG4gICAgICAgICAgICB2YXIgc2Vjb25kU3RvcCA9IHNlY29uZC5jb2xvclN0b3BzW2ldO1xuICAgICAgICAgICAgaWYgKGZpcnN0U3RvcC5vZmZzZXQgIT09IHNlY29uZFN0b3Aub2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFjb2xvcl8xLkNvbG9yLmVxdWFscyhmaXJzdFN0b3AuY29sb3IsIHNlY29uZFN0b3AuY29sb3IpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIExpbmVhckdyYWRpZW50O1xufSgpKTtcbmV4cG9ydHMuTGluZWFyR3JhZGllbnQgPSBMaW5lYXJHcmFkaWVudDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpbmVhci1ncmFkaWVudC5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uL2NvbG9yXCIpO1xudmFyIGZvbnRfMSA9IHJlcXVpcmUoXCIuLi8uLi91aS9zdHlsaW5nL2ZvbnRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBiYWNrZ3JvdW5kXzEgPSByZXF1aXJlKFwiLi4vLi4vdWkvc3R5bGluZy9iYWNrZ3JvdW5kXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgbnVtYmVyX3V0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvbnVtYmVyLXV0aWxzXCIpO1xudmFyIG1hdHJpeF8xID0gcmVxdWlyZShcIi4uLy4uL21hdHJpeFwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHBhcnNlciA9IHJlcXVpcmUoXCIuLi8uLi9jc3MvcGFyc2VyXCIpO1xudmFyIGxpbmVhcl9ncmFkaWVudF8xID0gcmVxdWlyZShcIi4vbGluZWFyLWdyYWRpZW50XCIpO1xuZnVuY3Rpb24gZXF1YWxzQ29tbW9uKGEsIGIpIHtcbiAgICBpZiAoYSA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gYiA9PSBcImF1dG9cIjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBhID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIGlmIChiID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBiID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gYSA9PSBiO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiLnVuaXQgPT0gXCJkaXBcIiAmJiBhID09IGIudmFsdWU7XG4gICAgfVxuICAgIGlmIChiID09IFwiYXV0b1wiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBiID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiBhID8gKGEudW5pdCA9PSBcImRpcFwiICYmIGEudmFsdWUgPT0gYikgOiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCFhIHx8ICFiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIGEudmFsdWUgPT0gYi52YWx1ZSAmJiBhLnVuaXQgPT0gYi51bml0O1xufVxuZnVuY3Rpb24gY29udmVydFRvU3RyaW5nQ29tbW9uKGxlbmd0aCkge1xuICAgIGlmIChsZW5ndGggPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIFwiYXV0b1wiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICByZXR1cm4gbGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHZhciB2YWwgPSBsZW5ndGgudmFsdWU7XG4gICAgaWYgKGxlbmd0aC51bml0ID09PSBcIiVcIikge1xuICAgICAgICB2YWwgKj0gMTAwO1xuICAgIH1cbiAgICByZXR1cm4gdmFsICsgbGVuZ3RoLnVuaXQ7XG59XG5mdW5jdGlvbiB0b0RldmljZVBpeGVsc0NvbW1vbihsZW5ndGgsIGF1dG8sIHBhcmVudEF2YWlsYWJsZVdpZHRoKSB7XG4gICAgaWYgKGF1dG8gPT09IHZvaWQgMCkgeyBhdXRvID0gTnVtYmVyLk5hTjsgfVxuICAgIGlmIChwYXJlbnRBdmFpbGFibGVXaWR0aCA9PT0gdm9pZCAwKSB7IHBhcmVudEF2YWlsYWJsZVdpZHRoID0gTnVtYmVyLk5hTjsgfVxuICAgIGlmIChsZW5ndGggPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIGF1dG87XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZCh1dGlsc18xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgpKTtcbiAgICB9XG4gICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIGF1dG87XG4gICAgfVxuICAgIHN3aXRjaCAobGVuZ3RoLnVuaXQpIHtcbiAgICAgICAgY2FzZSBcInB4XCI6XG4gICAgICAgICAgICByZXR1cm4gdXRpbHNfMS5sYXlvdXQucm91bmQobGVuZ3RoLnZhbHVlKTtcbiAgICAgICAgY2FzZSBcIiVcIjpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZChwYXJlbnRBdmFpbGFibGVXaWR0aCAqIGxlbmd0aC52YWx1ZSk7XG4gICAgICAgIGNhc2UgXCJkaXBcIjpcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZCh1dGlsc18xLmxheW91dC50b0RldmljZVBpeGVscyhsZW5ndGgudmFsdWUpKTtcbiAgICB9XG59XG52YXIgUGVyY2VudExlbmd0aDtcbihmdW5jdGlvbiAoUGVyY2VudExlbmd0aCkge1xuICAgIGZ1bmN0aW9uIHBhcnNlKGZyb21WYWx1ZSkge1xuICAgICAgICBpZiAoZnJvbVZhbHVlID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmcm9tVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9IGZyb21WYWx1ZS50cmltKCk7XG4gICAgICAgICAgICB2YXIgcGVyY2VudEluZGV4ID0gc3RyaW5nVmFsdWUuaW5kZXhPZihcIiVcIik7XG4gICAgICAgICAgICBpZiAocGVyY2VudEluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAocGVyY2VudEluZGV4ICE9PSAoc3RyaW5nVmFsdWUubGVuZ3RoIC0gMSkgfHwgcGVyY2VudEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gTnVtYmVyLk5hTjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcGFyc2VGbG9hdChzdHJpbmdWYWx1ZS5zdWJzdHJpbmcoMCwgc3RyaW5nVmFsdWUubGVuZ3RoIC0gMSkudHJpbSgpKSAvIDEwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSB8fCAhaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgZnJvbVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdW5pdDogXCIlXCIsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nVmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gc3RyaW5nVmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4geyB1bml0OiBcInB4XCIsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gcGFyc2VGbG9hdChzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKHZhbHVlKSB8fCAhaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgZnJvbVZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21WYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBQZXJjZW50TGVuZ3RoLnBhcnNlID0gcGFyc2U7XG4gICAgUGVyY2VudExlbmd0aC5lcXVhbHMgPSBlcXVhbHNDb21tb247XG4gICAgUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzQ29tbW9uO1xuICAgIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nID0gY29udmVydFRvU3RyaW5nQ29tbW9uO1xufSkoUGVyY2VudExlbmd0aCA9IGV4cG9ydHMuUGVyY2VudExlbmd0aCB8fCAoZXhwb3J0cy5QZXJjZW50TGVuZ3RoID0ge30pKTtcbnZhciBMZW5ndGg7XG4oZnVuY3Rpb24gKExlbmd0aCkge1xuICAgIGZ1bmN0aW9uIHBhcnNlKGZyb21WYWx1ZSkge1xuICAgICAgICBpZiAoZnJvbVZhbHVlID09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBmcm9tVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHJpbmdWYWx1ZSA9IGZyb21WYWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAoc3RyaW5nVmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gc3RyaW5nVmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHVuaXQ6IFwicHhcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBzdHJpbmdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmcm9tVmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgTGVuZ3RoLnBhcnNlID0gcGFyc2U7XG4gICAgTGVuZ3RoLmVxdWFscyA9IGVxdWFsc0NvbW1vbjtcbiAgICBMZW5ndGgudG9EZXZpY2VQaXhlbHMgPSB0b0RldmljZVBpeGVsc0NvbW1vbjtcbiAgICBMZW5ndGguY29udmVydFRvU3RyaW5nID0gY29udmVydFRvU3RyaW5nQ29tbW9uO1xufSkoTGVuZ3RoID0gZXhwb3J0cy5MZW5ndGggfHwgKGV4cG9ydHMuTGVuZ3RoID0ge30pKTtcbmV4cG9ydHMuemVyb0xlbmd0aCA9IHsgdmFsdWU6IDAsIHVuaXQ6IFwicHhcIiB9O1xuZXhwb3J0cy5taW5XaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtaW5XaWR0aFwiLCBjc3NOYW1lOiBcIm1pbi13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5XaWR0aCA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLm1pbldpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMubWluSGVpZ2h0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbkhlaWdodFwiLCBjc3NOYW1lOiBcIm1pbi1oZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlTWluSGVpZ2h0ID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMubWluSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMud2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoe1xuICAgIG5hbWU6IFwid2lkdGhcIiwgY3NzTmFtZTogXCJ3aWR0aFwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b1wiLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzSU9TKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2aWV3LnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMud2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5oZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaGVpZ2h0XCIsIGNzc05hbWU6IFwiaGVpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UsXG59KTtcbmV4cG9ydHMuaGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBtYXJnaW5Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWFyZ2luXCIsIGNzc05hbWU6IFwibWFyZ2luXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChQZXJjZW50TGVuZ3RoLmVxdWFscyh0aGlzLm1hcmdpblRvcCwgdGhpcy5tYXJnaW5SaWdodCkgJiZcbiAgICAgICAgICAgIFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpbkJvdHRvbSkgJiZcbiAgICAgICAgICAgIFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpbkxlZnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXJnaW5Ub3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMubWFyZ2luVG9wKSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5SaWdodCkgKyBcIiBcIiArIFBlcmNlbnRMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMubWFyZ2luQm90dG9tKSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5MZWZ0KTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvTWFyZ2luc1xufSk7XG5tYXJnaW5Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJtYXJnaW5MZWZ0XCIsIGNzc05hbWU6IFwibWFyZ2luLWxlZnRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpblJpZ2h0XCIsIGNzc05hbWU6IFwibWFyZ2luLXJpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogUGVyY2VudExlbmd0aC5wYXJzZSB9KTtcbmV4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpblRvcFwiLCBjc3NOYW1lOiBcIm1hcmdpbi10b3BcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpbkJvdHRvbVwiLCBjc3NOYW1lOiBcIm1hcmdpbi1ib3R0b21cIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIHBhZGRpbmdQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1wiLCBjc3NOYW1lOiBcInBhZGRpbmdcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdSaWdodCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdCb3R0b20pICYmXG4gICAgICAgICAgICBMZW5ndGguZXF1YWxzKHRoaXMucGFkZGluZ1RvcCwgdGhpcy5wYWRkaW5nTGVmdCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZGRpbmdUb3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5wYWRkaW5nVG9wKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdSaWdodCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5wYWRkaW5nQm90dG9tKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdMZWZ0KTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvUGFkZGluZ3Ncbn0pO1xucGFkZGluZ1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInBhZGRpbmdMZWZ0XCIsIGNzc05hbWU6IFwicGFkZGluZy1sZWZ0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1JpZ2h0XCIsIGNzc05hbWU6IFwicGFkZGluZy1yaWdodFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInBhZGRpbmdUb3BcIiwgY3NzTmFtZTogXCJwYWRkaW5nLXRvcFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVQYWRkaW5nVG9wID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ0JvdHRvbVwiLCBjc3NOYW1lOiBcInBhZGRpbmctYm90dG9tXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nQm90dG9tUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBIb3Jpem9udGFsQWxpZ25tZW50O1xuKGZ1bmN0aW9uIChIb3Jpem9udGFsQWxpZ25tZW50KSB7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5MRUZUID0gXCJsZWZ0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5DRU5URVIgPSBcImNlbnRlclwiO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQuUklHSFQgPSBcInJpZ2h0XCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoSG9yaXpvbnRhbEFsaWdubWVudC5MRUZULCBIb3Jpem9udGFsQWxpZ25tZW50LkNFTlRFUiwgSG9yaXpvbnRhbEFsaWdubWVudC5SSUdIVCwgSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENIKTtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoSG9yaXpvbnRhbEFsaWdubWVudC5pc1ZhbGlkKTtcbn0pKEhvcml6b250YWxBbGlnbm1lbnQgPSBleHBvcnRzLkhvcml6b250YWxBbGlnbm1lbnQgfHwgKGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCA9IHt9KSk7XG5leHBvcnRzLmhvcml6b250YWxBbGlnbm1lbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImhvcml6b250YWxBbGlnbm1lbnRcIiwgY3NzTmFtZTogXCJob3Jpem9udGFsLWFsaWduXCIsIGRlZmF1bHRWYWx1ZTogSG9yaXpvbnRhbEFsaWdubWVudC5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogSG9yaXpvbnRhbEFsaWdubWVudC5wYXJzZSB9KTtcbmV4cG9ydHMuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgVmVydGljYWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKFZlcnRpY2FsQWxpZ25tZW50KSB7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuVE9QID0gXCJ0b3BcIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5NSURETEUgPSBcIm1pZGRsZVwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LkJPVFRPTSA9IFwiYm90dG9tXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuU1RSRVRDSCA9IFwic3RyZXRjaFwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihWZXJ0aWNhbEFsaWdubWVudC5UT1AsIFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSwgVmVydGljYWxBbGlnbm1lbnQuQk9UVE9NLCBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENIKTtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjZW50ZXJcIiA/IFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSA6IHBhcnNlU3RyaWN0KHZhbHVlKTsgfTtcbiAgICB2YXIgcGFyc2VTdHJpY3QgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihWZXJ0aWNhbEFsaWdubWVudC5pc1ZhbGlkKTtcbn0pKFZlcnRpY2FsQWxpZ25tZW50ID0gZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5WZXJ0aWNhbEFsaWdubWVudCA9IHt9KSk7XG5leHBvcnRzLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ2ZXJ0aWNhbEFsaWdubWVudFwiLCBjc3NOYW1lOiBcInZlcnRpY2FsLWFsaWduXCIsIGRlZmF1bHRWYWx1ZTogVmVydGljYWxBbGlnbm1lbnQuU1RSRVRDSCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IFZlcnRpY2FsQWxpZ25tZW50LnBhcnNlIH0pO1xuZXhwb3J0cy52ZXJ0aWNhbEFsaWdubWVudFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBwYXJzZVRoaWNrbmVzcyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bICxdKy8pO1xuICAgICAgICB2YXIgdG9wXzE7XG4gICAgICAgIHZhciByaWdodCA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGJvdHRvbSA9IHZvaWQgMDtcbiAgICAgICAgdmFyIGxlZnQgPSB2b2lkIDA7XG4gICAgICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzBdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzBdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIGJvdHRvbSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclsxXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclsxXTtcbiAgICAgICAgICAgIGJvdHRvbSA9IGFyclsyXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICB0b3BfMSA9IGFyclswXTtcbiAgICAgICAgICAgIHJpZ2h0ID0gYXJyWzFdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzJdO1xuICAgICAgICAgICAgbGVmdCA9IGFyclszXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEsIDIsIDMgb3IgNCBwYXJhbWV0ZXJzLiBBY3R1YWw6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0b3A6IHRvcF8xLFxuICAgICAgICAgICAgcmlnaHQ6IHJpZ2h0LFxuICAgICAgICAgICAgYm90dG9tOiBib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiBsZWZ0XG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufVxuZnVuY3Rpb24gY29udmVydFRvTWFyZ2lucyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgIHZhciB0aGlja25lc3MgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSwgUGVyY2VudExlbmd0aC5wYXJzZSh0aGlja25lc3MudG9wKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5yaWdodCldLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luQm90dG9tUHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLmJvdHRvbSldLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luTGVmdFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5sZWZ0KV1cbiAgICAgICAgXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Ub3BQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luUmlnaHRQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luQm90dG9tUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgIF07XG4gICAgfVxufVxuZnVuY3Rpb24gY29udmVydFRvUGFkZGluZ3ModmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlICE9PSBcImF1dG9cIikge1xuICAgICAgICB2YXIgdGhpY2tuZXNzID0gcGFyc2VUaGlja25lc3ModmFsdWUpO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LCBMZW5ndGgucGFyc2UodGhpY2tuZXNzLnRvcCldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1JpZ2h0UHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MucmlnaHQpXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5ib3R0b20pXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MubGVmdCldXG4gICAgICAgIF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ1RvcFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nTGVmdFByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5leHBvcnRzLnJvdGF0ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwicm90YXRlXCIsIGNzc05hbWU6IFwicm90YXRlXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnJvdGF0ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnNjYWxlWFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwic2NhbGVYXCIsIGNzc05hbWU6IFwic2NhbGVYXCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnNjYWxlWFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnNjYWxlWVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwic2NhbGVZXCIsIGNzc05hbWU6IFwic2NhbGVZXCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLnNjYWxlWVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBwYXJzZURJUHModmFsdWUpIHtcbiAgICBpZiAodmFsdWUuaW5kZXhPZihcInB4XCIpICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhwYXJzZUZsb2F0KHZhbHVlLnJlcGxhY2UoXCJweFwiLCBcIlwiKS50cmltKCkpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KHZhbHVlLnJlcGxhY2UoXCJkaXBcIiwgXCJcIikudHJpbSgpKTtcbiAgICB9XG59XG5leHBvcnRzLnRyYW5zbGF0ZVhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcInRyYW5zbGF0ZVhcIiwgY3NzTmFtZTogXCJ0cmFuc2xhdGVYXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRElQcyB9KTtcbmV4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnRyYW5zbGF0ZVlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcInRyYW5zbGF0ZVlcIiwgY3NzTmFtZTogXCJ0cmFuc2xhdGVZXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRElQcyB9KTtcbmV4cG9ydHMudHJhbnNsYXRlWVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgdHJhbnNmb3JtUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcInRyYW5zZm9ybVwiLCBjc3NOYW1lOiBcInRyYW5zZm9ybVwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2NhbGVYID0gdGhpcy5zY2FsZVg7XG4gICAgICAgIHZhciBzY2FsZVkgPSB0aGlzLnNjYWxlWTtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZVggPSB0aGlzLnRyYW5zbGF0ZVg7XG4gICAgICAgIHZhciB0cmFuc2xhdGVZID0gdGhpcy50cmFuc2xhdGVZO1xuICAgICAgICB2YXIgcm90YXRlID0gdGhpcy5yb3RhdGU7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICBpZiAodHJhbnNsYXRlWCAhPT0gMCB8fCB0cmFuc2xhdGVZICE9PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJ0cmFuc2xhdGUoXCIgKyB0cmFuc2xhdGVYICsgXCIsIFwiICsgdHJhbnNsYXRlWSArIFwiKSBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2NhbGVYICE9PSAxIHx8IHNjYWxlWSAhPT0gMSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwic2NhbGUoXCIgKyBzY2FsZVggKyBcIiwgXCIgKyBzY2FsZVkgKyBcIikgXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwicm90YXRlIChcIiArIHJvdGF0ZSArIFwiKVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQudHJpbSgpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9UcmFuc2Zvcm1cbn0pO1xudHJhbnNmb3JtUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBJREVOVElUWV9UUkFOU0ZPUk1BVElPTiA9IHtcbiAgICB0cmFuc2xhdGU6IHsgeDogMCwgeTogMCB9LFxuICAgIHJvdGF0ZTogMCxcbiAgICBzY2FsZTogeyB4OiAxLCB5OiAxIH0sXG59O1xudmFyIFRSQU5TRk9STV9TUExJVFRFUiA9IG5ldyBSZWdFeHAoL1xccyooLis/KVxcKCguKj8pXFwpL2cpO1xudmFyIFRSQU5TRk9STUFUSU9OUyA9IE9iamVjdC5mcmVlemUoW1xuICAgIFwicm90YXRlXCIsXG4gICAgXCJ0cmFuc2xhdGVcIixcbiAgICBcInRyYW5zbGF0ZTNkXCIsXG4gICAgXCJ0cmFuc2xhdGVYXCIsXG4gICAgXCJ0cmFuc2xhdGVZXCIsXG4gICAgXCJzY2FsZVwiLFxuICAgIFwic2NhbGUzZFwiLFxuICAgIFwic2NhbGVYXCIsXG4gICAgXCJzY2FsZVlcIixcbl0pO1xudmFyIFNUWUxFX1RSQU5TRk9STUFUSU9OX01BUCA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwic2NhbGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJzY2FsZTNkXCI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gKHsgcHJvcGVydHk6IFwic2NhbGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwic2NhbGVYXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLng7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogeyB4OiB4LCB5OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi5zY2FsZS55IH0gfSk7XG4gICAgfSxcbiAgICBcInNjYWxlWVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwic2NhbGVcIiwgdmFsdWU6IHsgeTogeSwgeDogSURFTlRJVFlfVFJBTlNGT1JNQVRJT04uc2NhbGUueCB9IH0pO1xuICAgIH0sXG4gICAgXCJ0cmFuc2xhdGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwidHJhbnNsYXRlM2RcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxuICAgIFwidHJhbnNsYXRlWFwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHggPSBfYS54O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwidHJhbnNsYXRlXCIsIHZhbHVlOiB7IHg6IHgsIHk6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnRyYW5zbGF0ZS55IH0gfSk7XG4gICAgfSxcbiAgICBcInRyYW5zbGF0ZVlcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB5ID0gX2EueTtcbiAgICAgICAgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogeyB5OiB5LCB4OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi50cmFuc2xhdGUueCB9IH0pO1xuICAgIH0sXG4gICAgXCJyb3RhdGVcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJyb3RhdGVcIiwgdmFsdWU6IHZhbHVlIH0pOyB9LFxufSk7XG5mdW5jdGlvbiBjb252ZXJ0VG9UcmFuc2Zvcm0odmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IHByb3BlcnRpZXNfMS51bnNldFZhbHVlKSB7XG4gICAgICAgIHZhbHVlID0gXCJub25lXCI7XG4gICAgfVxuICAgIHZhciBfYSA9IHRyYW5zZm9ybUNvbnZlcnRlcih2YWx1ZSksIHRyYW5zbGF0ZSA9IF9hLnRyYW5zbGF0ZSwgcm90YXRlID0gX2Eucm90YXRlLCBzY2FsZSA9IF9hLnNjYWxlO1xuICAgIHJldHVybiBbXG4gICAgICAgIFtleHBvcnRzLnRyYW5zbGF0ZVhQcm9wZXJ0eSwgdHJhbnNsYXRlLnhdLFxuICAgICAgICBbZXhwb3J0cy50cmFuc2xhdGVZUHJvcGVydHksIHRyYW5zbGF0ZS55XSxcbiAgICAgICAgW2V4cG9ydHMuc2NhbGVYUHJvcGVydHksIHNjYWxlLnhdLFxuICAgICAgICBbZXhwb3J0cy5zY2FsZVlQcm9wZXJ0eSwgc2NhbGUueV0sXG4gICAgICAgIFtleHBvcnRzLnJvdGF0ZVByb3BlcnR5LCByb3RhdGVdLFxuICAgIF07XG59XG5mdW5jdGlvbiB0cmFuc2Zvcm1Db252ZXJ0ZXIodGV4dCkge1xuICAgIHZhciB0cmFuc2Zvcm1hdGlvbnMgPSBwYXJzZVRyYW5zZm9ybVN0cmluZyh0ZXh0KTtcbiAgICBpZiAodGV4dCA9PT0gXCJub25lXCIgfHwgdGV4dCA9PT0gXCJcIiB8fCAhdHJhbnNmb3JtYXRpb25zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gSURFTlRJVFlfVFJBTlNGT1JNQVRJT047XG4gICAgfVxuICAgIHZhciB1c2VkVHJhbnNmb3JtcyA9IHRyYW5zZm9ybWF0aW9ucy5tYXAoZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQucHJvcGVydHk7IH0pO1xuICAgIGlmICghdXRpbHNfMS5oYXNEdXBsaWNhdGVzKHVzZWRUcmFuc2Zvcm1zKSkge1xuICAgICAgICB2YXIgZnVsbFRyYW5zZm9ybWF0aW9uc18xID0gX19hc3NpZ24oe30sIElERU5USVRZX1RSQU5TRk9STUFUSU9OKTtcbiAgICAgICAgdHJhbnNmb3JtYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xuICAgICAgICAgICAgZnVsbFRyYW5zZm9ybWF0aW9uc18xW3RyYW5zZm9ybS5wcm9wZXJ0eV0gPSB0cmFuc2Zvcm0udmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVsbFRyYW5zZm9ybWF0aW9uc18xO1xuICAgIH1cbiAgICB2YXIgYWZmaW5lTWF0cml4ID0gdHJhbnNmb3JtYXRpb25zXG4gICAgICAgIC5tYXAobWF0cml4XzEuZ2V0VHJhbnNmb3JtTWF0cml4KVxuICAgICAgICAucmVkdWNlKG1hdHJpeF8xLm11bHRpcGx5QWZmaW5lMmQpO1xuICAgIHZhciBjc3NNYXRyaXggPSBtYXRyaXhfMS5tYXRyaXhBcnJheVRvQ3NzTWF0cml4KGFmZmluZU1hdHJpeCk7XG4gICAgcmV0dXJuIG1hdHJpeF8xLmRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4KGNzc01hdHJpeCk7XG59XG5leHBvcnRzLnRyYW5zZm9ybUNvbnZlcnRlciA9IHRyYW5zZm9ybUNvbnZlcnRlcjtcbmZ1bmN0aW9uIHBhcnNlVHJhbnNmb3JtU3RyaW5nKHRleHQpIHtcbiAgICB2YXIgbWF0Y2hlcyA9IFtdO1xuICAgIHZhciBtYXRjaDtcbiAgICB3aGlsZSAoKG1hdGNoID0gVFJBTlNGT1JNX1NQTElUVEVSLmV4ZWModGV4dCkpICE9PSBudWxsKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IG1hdGNoWzFdO1xuICAgICAgICB2YXIgdmFsdWUgPSBjb252ZXJ0VHJhbnNmb3JtVmFsdWUocHJvcGVydHksIG1hdGNoWzJdKTtcbiAgICAgICAgaWYgKFRSQU5TRk9STUFUSU9OUy5pbmRleE9mKHByb3BlcnR5KSAhPT0gLTEpIHtcbiAgICAgICAgICAgIG1hdGNoZXMucHVzaChub3JtYWxpemVUcmFuc2Zvcm1hdGlvbih7IHByb3BlcnR5OiBwcm9wZXJ0eSwgdmFsdWU6IHZhbHVlIH0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWF0Y2hlcztcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVRyYW5zZm9ybWF0aW9uKF9hKSB7XG4gICAgdmFyIHByb3BlcnR5ID0gX2EucHJvcGVydHksIHZhbHVlID0gX2EudmFsdWU7XG4gICAgcmV0dXJuIFNUWUxFX1RSQU5TRk9STUFUSU9OX01BUFtwcm9wZXJ0eV0odmFsdWUpO1xufVxuZnVuY3Rpb24gY29udmVydFRyYW5zZm9ybVZhbHVlKHByb3BlcnR5LCBzdHJpbmdWYWx1ZSkge1xuICAgIHZhciBfYSA9IHN0cmluZ1ZhbHVlLnNwbGl0KFwiLFwiKS5tYXAocGFyc2VGbG9hdCksIHggPSBfYVswXSwgX2IgPSBfYVsxXSwgeSA9IF9iID09PSB2b2lkIDAgPyB4IDogX2I7XG4gICAgaWYgKHByb3BlcnR5ID09PSBcInJvdGF0ZVwiKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmdWYWx1ZS5zbGljZSgtMykgPT09IFwicmFkXCIgPyBudW1iZXJfdXRpbHNfMS5yYWRpYW5zVG9EZWdyZWVzKHgpIDogeDtcbiAgICB9XG4gICAgcmV0dXJuIHsgeDogeCwgeTogeSB9O1xufVxudmFyIGJhY2tncm91bmRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFwiLCBjc3NOYW1lOiBcImJhY2tncm91bmRcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFja2dyb3VuZENvbG9yICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRJbWFnZSArIFwiIFwiICsgdGhpcy5iYWNrZ3JvdW5kUmVwZWF0ICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRQb3NpdGlvbjtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogY29udmVydFRvQmFja2dyb3VuZHNcbn0pO1xuYmFja2dyb3VuZFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kSW50ZXJuYWxcIixcbiAgICBjc3NOYW1lOiBcIl9iYWNrZ3JvdW5kSW50ZXJuYWxcIixcbiAgICBkZWZhdWx0VmFsdWU6IGJhY2tncm91bmRfMS5CYWNrZ3JvdW5kLmRlZmF1bHRcbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZEltYWdlXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1pbWFnZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEltYWdlKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSxcbiAgICBlcXVhbGl0eUNvbXBhcmVyOiBmdW5jdGlvbiAodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKHZhbHVlMSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50ICYmIHZhbHVlMiBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQuZXF1YWxzKHZhbHVlMSwgdmFsdWUyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTEgPT09IHZhbHVlMjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgcGFyc2VkID0gcGFyc2VyLnBhcnNlQmFja2dyb3VuZCh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAocGFyc2VkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhY2tncm91bmQgPSBwYXJzZWQudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAodHlwZW9mIGJhY2tncm91bmQuaW1hZ2UgPT09IFwib2JqZWN0XCIpID8gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQucGFyc2UoYmFja2dyb3VuZC5pbWFnZSkgOiB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kQ29sb3JcIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQ29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBCYWNrZ3JvdW5kUmVwZWF0O1xuKGZ1bmN0aW9uIChCYWNrZ3JvdW5kUmVwZWF0KSB7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVQgPSBcInJlcGVhdFwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1ggPSBcInJlcGVhdC14XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWSA9IFwicmVwZWF0LXlcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0Lk5PX1JFUEVBVCA9IFwibm8tcmVwZWF0XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoQmFja2dyb3VuZFJlcGVhdC5SRVBFQVQsIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1gsIEJhY2tncm91bmRSZXBlYXQuUkVQRUFUX1ksIEJhY2tncm91bmRSZXBlYXQuTk9fUkVQRUFUKTtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnBhcnNlID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoQmFja2dyb3VuZFJlcGVhdC5pc1ZhbGlkKTtcbn0pKEJhY2tncm91bmRSZXBlYXQgPSBleHBvcnRzLkJhY2tncm91bmRSZXBlYXQgfHwgKGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCA9IHt9KSk7XG5leHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFJlcGVhdFwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtcmVwZWF0XCIsIHZhbHVlQ29udmVydGVyOiBCYWNrZ3JvdW5kUmVwZWF0LnBhcnNlLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoUmVwZWF0KG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU2l6ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kU2l6ZVwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtc2l6ZVwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aFNpemUobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFNpemVQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYmFja2dyb3VuZFBvc2l0aW9uXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1wb3NpdGlvblwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aFBvc2l0aW9uKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBjb252ZXJ0VG9CYWNrZ3JvdW5kcyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmRzID0gcGFyc2VyLnBhcnNlQmFja2dyb3VuZCh2YWx1ZSkudmFsdWU7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kcy5jb2xvciA/IG5ldyBjb2xvcl8xLkNvbG9yKGJhY2tncm91bmRzLmNvbG9yKSA6IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB2YXIgYmFja2dyb3VuZEltYWdlID0gdm9pZCAwO1xuICAgICAgICBpZiAodHlwZW9mIGJhY2tncm91bmRzLmltYWdlID09PSBcIm9iamVjdFwiICYmIGJhY2tncm91bmRzLmltYWdlKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2UgPSBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5wYXJzZShiYWNrZ3JvdW5kcy5pbWFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2UgPSBiYWNrZ3JvdW5kcy5pbWFnZSB8fCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZFJlcGVhdCA9IGJhY2tncm91bmRzLnJlcGVhdCB8fCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRQb3NpdGlvbiA9IGJhY2tncm91bmRzLnBvc2l0aW9uID8gYmFja2dyb3VuZHMucG9zaXRpb24udGV4dCA6IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHksIGJhY2tncm91bmRDb2xvcl0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSwgYmFja2dyb3VuZEltYWdlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRSZXBlYXRQcm9wZXJ0eSwgYmFja2dyb3VuZFJlcGVhdF0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSwgYmFja2dyb3VuZFBvc2l0aW9uXVxuICAgICAgICBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRDb2xvclByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kSW1hZ2VQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUG9zaXRpb25Qcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdXG4gICAgICAgIF07XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VCb3JkZXJDb2xvcih2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSB7IHRvcDogdW5kZWZpbmVkLCByaWdodDogdW5kZWZpbmVkLCBib3R0b206IHVuZGVmaW5lZCwgbGVmdDogdW5kZWZpbmVkIH07XG4gICAgaWYgKHZhbHVlLmluZGV4T2YoXCJyZ2JcIikgPT09IDApIHtcbiAgICAgICAgcmVzdWx0LnRvcCA9IHJlc3VsdC5yaWdodCA9IHJlc3VsdC5ib3R0b20gPSByZXN1bHQubGVmdCA9IG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bICxdKy8pO1xuICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIwO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjA7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHJlc3VsdC50b3AgPSBhcnIwO1xuICAgICAgICByZXN1bHQucmlnaHQgPSBhcnIxO1xuICAgICAgICByZXN1bHQuYm90dG9tID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LmxlZnQgPSBhcnIxO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgdmFyIGFycjEgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMV0pO1xuICAgICAgICB2YXIgYXJyMiA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsyXSk7XG4gICAgICAgIHJlc3VsdC50b3AgPSBhcnIwO1xuICAgICAgICByZXN1bHQucmlnaHQgPSBhcnIxO1xuICAgICAgICByZXN1bHQuYm90dG9tID0gYXJyMjtcbiAgICAgICAgcmVzdWx0LmxlZnQgPSBhcnIxO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgIHZhciBhcnIwID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzBdKTtcbiAgICAgICAgdmFyIGFycjEgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMV0pO1xuICAgICAgICB2YXIgYXJyMiA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsyXSk7XG4gICAgICAgIHZhciBhcnIzID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzNdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIyO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCAxLCAyLCAzIG9yIDQgcGFyYW1ldGVycy4gQWN0dWFsOiBcIiArIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbnZhciBib3JkZXJDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1jb2xvclwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJSaWdodENvbG9yKSAmJlxuICAgICAgICAgICAgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJCb3R0b21Db2xvcikgJiZcbiAgICAgICAgICAgIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyTGVmdENvbG9yKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvciArIFwiIFwiICsgdGhpcy5ib3JkZXJSaWdodENvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlckJvdHRvbUNvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGZvdXJDb2xvcnMgPSBwYXJzZUJvcmRlckNvbG9yKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy50b3BdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy5yaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tQ29sb3JQcm9wZXJ0eSwgZm91ckNvbG9ycy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLmxlZnRdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tQ29sb3JQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmJvcmRlckNvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyVG9wQ29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItdG9wLWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyVG9wQ29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJSaWdodENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclJpZ2h0Q29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItcmlnaHQtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJSaWdodENvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21Db2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1ib3R0b20tY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21Db2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJMZWZ0Q29sb3JcIiwgY3NzTmFtZTogXCJib3JkZXItbGVmdC1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckxlZnRDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJMZWZ0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGJvcmRlcldpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlcldpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXdpZHRoXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wV2lkdGgsIHRoaXMuYm9yZGVyUmlnaHRXaWR0aCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJMZWZ0V2lkdGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyVG9wV2lkdGgpICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyUmlnaHRXaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21XaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJMZWZ0V2lkdGgpO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiICYmIHZhbHVlICE9PSBcImF1dG9cIikge1xuICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRocyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eSwgYm9yZGVyV2lkdGhzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMucmlnaHRdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMubGVmdF1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BXaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci10b3Atd2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcFdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyUmlnaHRXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJSaWdodFdpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1yaWdodC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyUmlnaHRXaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyQm90dG9tV2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20td2lkdGggc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21XaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJMZWZ0V2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItbGVmdC13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItbGVmdC13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJMZWZ0V2lkdGgodmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBib3JkZXJSYWRpdXNQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyUmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXJhZGl1c1wiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMsIHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMpICYmXG4gICAgICAgICAgICBMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cywgdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cykgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzLCB0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cykgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzKTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBib3JkZXJSYWRpdXMgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcExlZnRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wUmlnaHRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLnJpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMuYm90dG9tXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHksIGJvcmRlclJhZGl1cy5sZWZ0XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wUmlnaHRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyUmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BMZWZ0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC1sZWZ0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci10b3AtbGVmdC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BMZWZ0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcExlZnRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BSaWdodFJhZGl1c1wiLCBjc3NOYW1lOiBcImJvcmRlci10b3AtcmlnaHQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BSaWdodFJhZGl1cyh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXNcIiwgZGVmYXVsdFZhbHVlOiAwLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21MZWZ0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXMgc2hvdWxkIGJlIE5vbi1OZWdhdGl2ZSBGaW5pdGUgbnVtYmVyLiBWYWx1ZTogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJCb3R0b21MZWZ0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZnVuY3Rpb24gaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiBpc0Zpbml0ZSh2YWx1ZSkgJiYgIWlzTmFOKHZhbHVlKSAmJiB2YWx1ZSA+PSAwO1xufVxudmFyIHN1cHBvcnRlZFBhdGhzID0gW1wicmVjdFwiLCBcImNpcmNsZVwiLCBcImVsbGlwc2VcIiwgXCJwb2x5Z29uXCIsIFwiaW5zZXRcIl07XG5mdW5jdGlvbiBpc0NsaXBQYXRoVmFsaWQodmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICB2YXIgZnVuY3Rpb25OYW1lID0gdmFsdWUuc3Vic3RyaW5nKDAsIHZhbHVlLmluZGV4T2YoXCIoXCIpKS50cmltKCk7XG4gICAgcmV0dXJuIHN1cHBvcnRlZFBhdGhzLmluZGV4T2YoZnVuY3Rpb25OYW1lKSAhPT0gLTE7XG59XG5leHBvcnRzLmNsaXBQYXRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImNsaXBQYXRoXCIsIGNzc05hbWU6IFwiY2xpcC1wYXRoXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNDbGlwUGF0aFZhbGlkKG5ld1ZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY2xpcC1wYXRoIGlzIG5vdCB2YWxpZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhDbGlwUGF0aChuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5jbGlwUGF0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBpc0Zsb2F0VmFsdWVDb252ZXJ0ZXIodmFsdWUpIHtcbiAgICB2YXIgbmV3VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICBpZiAoaXNOYU4obmV3VmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWU6IFwiICsgbmV3VmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3VmFsdWU7XG59XG5leHBvcnRzLnpJbmRleFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiekluZGV4XCIsIGNzc05hbWU6IFwiei1pbmRleFwiLCB2YWx1ZUNvbnZlcnRlcjogaXNGbG9hdFZhbHVlQ29udmVydGVyIH0pO1xuZXhwb3J0cy56SW5kZXhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZnVuY3Rpb24gb3BhY2l0eUNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmICghaXNOYU4obmV3VmFsdWUpICYmIDAgPD0gbmV3VmFsdWUgJiYgbmV3VmFsdWUgPD0gMSkge1xuICAgICAgICByZXR1cm4gbmV3VmFsdWU7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihcIk9wYWNpdHkgc2hvdWxkIGJlIGJldHdlZW4gWzAsIDFdLiBWYWx1ZTogXCIgKyBuZXdWYWx1ZSk7XG59XG5leHBvcnRzLm9wYWNpdHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzQW5pbWF0aW9uUHJvcGVydHkoeyBuYW1lOiBcIm9wYWNpdHlcIiwgY3NzTmFtZTogXCJvcGFjaXR5XCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IG9wYWNpdHlDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLm9wYWNpdHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5jb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwiY29sb3JcIiwgY3NzTmFtZTogXCJjb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuY29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250SW50ZXJuYWxQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImZvbnRJbnRlcm5hbFwiLCBjc3NOYW1lOiBcIl9mb250SW50ZXJuYWxcIiwgZGVmYXVsdFZhbHVlOiBmb250XzEuRm9udC5kZWZhdWx0IH0pO1xuZXhwb3J0cy5mb250SW50ZXJuYWxQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZENzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImZvbnRGYW1pbHlcIiwgY3NzTmFtZTogXCJmb250LWZhbWlseVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udEZhbWlseSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBuZXdGb250ID0gY3VycmVudEZvbnQud2l0aEZvbnRGYW1pbHkobmV3VmFsdWUpO1xuICAgICAgICAgICAgdGFyZ2V0LmZvbnRJbnRlcm5hbCA9IGZvbnRfMS5Gb250LmVxdWFscyhmb250XzEuRm9udC5kZWZhdWx0LCBuZXdGb250KSA/IHByb3BlcnRpZXNfMS51bnNldFZhbHVlIDogbmV3Rm9udDtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuZm9udFNpemVQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFNpemVcIiwgY3NzTmFtZTogXCJmb250LXNpemVcIiwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRTaXplICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFNpemUobmV3VmFsdWUpO1xuICAgICAgICAgICAgdGFyZ2V0LmZvbnRJbnRlcm5hbCA9IGZvbnRfMS5Gb250LmVxdWFscyhmb250XzEuRm9udC5kZWZhdWx0LCBuZXdGb250KSA/IHByb3BlcnRpZXNfMS51bnNldFZhbHVlIDogbmV3Rm9udDtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9XG59KTtcbmV4cG9ydHMuZm9udFNpemVQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFN0eWxlXCIsIGNzc05hbWU6IFwiZm9udC1zdHlsZVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBkZWZhdWx0VmFsdWU6IGZvbnRfMS5Gb250U3R5bGUuTk9STUFMLCB2YWx1ZUNvbnZlcnRlcjogZm9udF8xLkZvbnRTdHlsZS5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRTdHlsZSAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBuZXdGb250ID0gY3VycmVudEZvbnQud2l0aEZvbnRTdHlsZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRTdHlsZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFdlaWdodFwiLCBjc3NOYW1lOiBcImZvbnQtd2VpZ2h0XCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGRlZmF1bHRWYWx1ZTogZm9udF8xLkZvbnRXZWlnaHQuTk9STUFMLCB2YWx1ZUNvbnZlcnRlcjogZm9udF8xLkZvbnRXZWlnaHQucGFyc2UsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjdXJyZW50Rm9udCA9IHRhcmdldC5mb250SW50ZXJuYWw7XG4gICAgICAgIGlmIChjdXJyZW50Rm9udC5mb250V2VpZ2h0ICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFdlaWdodChuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGZvbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udFwiLCBjc3NOYW1lOiBcImZvbnRcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9udFN0eWxlICsgXCIgXCIgKyB0aGlzLmZvbnRXZWlnaHQgKyBcIiBcIiArIHRoaXMuZm9udFNpemUgKyBcIiBcIiArIHRoaXMuZm9udEZhbWlseTtcbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gcHJvcGVydGllc18xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFN0eWxlUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250V2VpZ2h0UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udEZhbWlseVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgZm9udCA9IGZvbnRfMS5wYXJzZUZvbnQodmFsdWUpO1xuICAgICAgICAgICAgdmFyIGZvbnRTaXplID0gcGFyc2VGbG9hdChmb250LmZvbnRTaXplKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFN0eWxlUHJvcGVydHksIGZvbnQuZm9udFN0eWxlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250V2VpZ2h0UHJvcGVydHksIGZvbnQuZm9udFdlaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udFNpemVQcm9wZXJ0eSwgZm9udFNpemVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eSwgZm9udC5mb250RmFtaWx5XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZm9udFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgVmlzaWJpbGl0eTtcbihmdW5jdGlvbiAoVmlzaWJpbGl0eSkge1xuICAgIFZpc2liaWxpdHkuVklTSUJMRSA9IFwidmlzaWJsZVwiO1xuICAgIFZpc2liaWxpdHkuSElEREVOID0gXCJoaWRkZW5cIjtcbiAgICBWaXNpYmlsaXR5LkNPTExBUFNFID0gXCJjb2xsYXBzZVwiO1xuICAgIFZpc2liaWxpdHkuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKFZpc2liaWxpdHkuVklTSUJMRSwgVmlzaWJpbGl0eS5ISURERU4sIFZpc2liaWxpdHkuQ09MTEFQU0UpO1xuICAgIFZpc2liaWxpdHkucGFyc2UgPSBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwiY29sbGFwc2VkXCIgPyBWaXNpYmlsaXR5LkNPTExBUFNFIDogcGFyc2VTdHJpY3QodmFsdWUpOyB9O1xuICAgIHZhciBwYXJzZVN0cmljdCA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKFZpc2liaWxpdHkuaXNWYWxpZCk7XG59KShWaXNpYmlsaXR5ID0gZXhwb3J0cy5WaXNpYmlsaXR5IHx8IChleHBvcnRzLlZpc2liaWxpdHkgPSB7fSkpO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcInZpc2liaWxpdHlcIiwgY3NzTmFtZTogXCJ2aXNpYmlsaXR5XCIsIGRlZmF1bHRWYWx1ZTogVmlzaWJpbGl0eS5WSVNJQkxFLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogVmlzaWJpbGl0eS5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuaXNDb2xsYXBzZWQgPSAobmV3VmFsdWUgPT09IFZpc2liaWxpdHkuQ09MTEFQU0UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZXhwb3J0cy52aXNpYmlsaXR5UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYW5kcm9pZEVsZXZhdGlvblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZEVsZXZhdGlvblwiLCBjc3NOYW1lOiBcImFuZHJvaWQtZWxldmF0aW9uXCIsIHZhbHVlQ29udmVydGVyOiBwYXJzZUZsb2F0IH0pO1xuZXhwb3J0cy5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0XCIsIGNzc05hbWU6IFwiYW5kcm9pZC1keW5hbWljLWVsZXZhdGlvbi1vZmZzZXRcIiwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLXByb3BlcnRpZXMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgY3NzXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzXCIpO1xudmFyIHBhcnNlcl8xID0gcmVxdWlyZShcIi4uLy4uL2Nzcy9wYXJzZXJcIik7XG52YXIgY3NzX3NlbGVjdG9yXzEgPSByZXF1aXJlKFwiLi9jc3Mtc2VsZWN0b3JcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xudmFyIGFwcGxpY2F0aW9uQ29tbW9uID0gcmVxdWlyZShcIi4uLy4uL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGU7XG5mdW5jdGlvbiBlbnN1cmVLZXlmcmFtZUFuaW1hdGlvbk1vZHVsZSgpIHtcbiAgICBpZiAoIWtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKSB7XG4gICAgICAgIGtleWZyYW1lQW5pbWF0aW9uTW9kdWxlID0gcmVxdWlyZShcInVpL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb25cIik7XG4gICAgfVxufVxudmFyIGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpIHtcbiAgICBpZiAoIWNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSkge1xuICAgICAgICBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGUgPSByZXF1aXJlKFwiLi9jc3MtYW5pbWF0aW9uLXBhcnNlclwiKTtcbiAgICB9XG59XG52YXIgcGFyc2VyID0gXCJyZXdvcmtcIjtcbnRyeSB7XG4gICAgdmFyIGFwcENvbmZpZyA9IHJlcXVpcmUoXCJ+L3BhY2thZ2UuanNvblwiKTtcbiAgICBpZiAoYXBwQ29uZmlnICYmIGFwcENvbmZpZy5jc3NQYXJzZXIgPT09IFwibmF0aXZlc2NyaXB0XCIpIHtcbiAgICAgICAgcGFyc2VyID0gXCJuYXRpdmVzY3JpcHRcIjtcbiAgICB9XG59XG5jYXRjaCAoZSkge1xufVxuZnVuY3Rpb24gbWVyZ2VDc3NTZWxlY3RvcnMoKSB7XG4gICAgYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMgPSBhcHBsaWNhdGlvblNlbGVjdG9ycy5zbGljZSgpO1xuICAgIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzLnB1c2guYXBwbHkoYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMsIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycyk7XG4gICAgYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb24rKztcbn1cbmV4cG9ydHMubWVyZ2VDc3NTZWxlY3RvcnMgPSBtZXJnZUNzc1NlbGVjdG9ycztcbnZhciBhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uID0gMDtcbnZhciBhcHBsaWNhdGlvblNlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycyA9IFtdO1xudmFyIGFwcGxpY2F0aW9uS2V5ZnJhbWVzID0ge307XG52YXIgYW5pbWF0aW9uc1N5bWJvbCA9IFN5bWJvbChcImFuaW1hdGlvbnNcIik7XG52YXIgcGF0dGVybiA9IC8oJ3xcIikoLio/KVxcMS87XG52YXIgQ1NTU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDU1NTb3VyY2UoX2FzdCwgX3VybCwgX2ZpbGUsIF9rZXlmcmFtZXMsIF9zb3VyY2UpIHtcbiAgICAgICAgdGhpcy5fYXN0ID0gX2FzdDtcbiAgICAgICAgdGhpcy5fdXJsID0gX3VybDtcbiAgICAgICAgdGhpcy5fZmlsZSA9IF9maWxlO1xuICAgICAgICB0aGlzLl9rZXlmcmFtZXMgPSBfa2V5ZnJhbWVzO1xuICAgICAgICB0aGlzLl9zb3VyY2UgPSBfc291cmNlO1xuICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wYXJzZSgpO1xuICAgIH1cbiAgICBDU1NTb3VyY2UuZnJvbVVSSSA9IGZ1bmN0aW9uICh1cmksIGtleWZyYW1lcykge1xuICAgICAgICB2YXIgYXBwUmVsYXRpdmVVcmkgPSBDU1NTb3VyY2UucGF0aFJlbGF0aXZlVG9BcHAodXJpKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjc3NPckFzdCA9IGdsb2JhbC5sb2FkTW9kdWxlKGFwcFJlbGF0aXZlVXJpLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChjc3NPckFzdCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY3NzT3JBc3QgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENTU1NvdXJjZS5mcm9tU291cmNlKGNzc09yQXN0LCBrZXlmcmFtZXMsIGFwcFJlbGF0aXZlVXJpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGNzc09yQXN0ID09PSBcIm9iamVjdFwiICYmIGNzc09yQXN0LnR5cGUgPT09IFwic3R5bGVzaGVldFwiICYmIGNzc09yQXN0LnN0eWxlc2hlZXQgJiYgY3NzT3JBc3Quc3R5bGVzaGVldC5ydWxlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ1NTU291cmNlLmZyb21BU1QoY3NzT3JBc3QsIGtleWZyYW1lcywgYXBwUmVsYXRpdmVVcmkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENTU1NvdXJjZS5mcm9tU291cmNlKGNzc09yQXN0LnRvU3RyaW5nKCksIGtleWZyYW1lcywgYXBwUmVsYXRpdmVVcmkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbUZpbGUoYXBwUmVsYXRpdmVVcmksIGtleWZyYW1lcyk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucGF0aFJlbGF0aXZlVG9BcHAgPSBmdW5jdGlvbiAodXJpKSB7XG4gICAgICAgIGlmICghdXJpLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhcHBQYXRoID0gZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGg7XG4gICAgICAgIGlmICghdXJpLnN0YXJ0c1dpdGgoYXBwUGF0aCkpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUodXJpICsgXCIgZG9lcyBub3Qgc3RhcnQgd2l0aCBcIiArIGFwcFBhdGgsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWxhdGl2ZVVyaSA9IFwiLlwiICsgdXJpLnN1YnN0cihhcHBQYXRoLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiByZWxhdGl2ZVVyaTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tRmlsZSA9IGZ1bmN0aW9uICh1cmwsIGtleWZyYW1lcykge1xuICAgICAgICB2YXIgY3NzRmlsZVVybCA9IHVybC5yZXBsYWNlKC9cXC4uXFx3KyQvLCBcIi5jc3NcIik7XG4gICAgICAgIGlmIChjc3NGaWxlVXJsICE9PSB1cmwpIHtcbiAgICAgICAgICAgIHZhciBjc3NGaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTChjc3NGaWxlVXJsKTtcbiAgICAgICAgICAgIGlmIChjc3NGaWxlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGNzc0ZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZSA9IENTU1NvdXJjZS5yZXNvbHZlQ1NTUGF0aEZyb21VUkwodXJsKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tRmlsZUltcG9ydCA9IGZ1bmN0aW9uICh1cmwsIGtleWZyYW1lcywgaW1wb3J0U291cmNlKSB7XG4gICAgICAgIHZhciBmaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTCh1cmwsIGltcG9ydFNvdXJjZSk7XG4gICAgICAgIHJldHVybiBuZXcgQ1NTU291cmNlKHVuZGVmaW5lZCwgdXJsLCBmaWxlLCBrZXlmcmFtZXMsIHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMID0gZnVuY3Rpb24gKHVybCwgaW1wb3J0U291cmNlKSB7XG4gICAgICAgIHZhciBhcHAgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICAgICAgdmFyIGZpbGUgPSByZXNvbHZlRmlsZU5hbWVGcm9tVXJsKHVybCwgYXBwLCBmaWxlX3N5c3RlbV8xLkZpbGUuZXhpc3RzLCBpbXBvcnRTb3VyY2UpO1xuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5mcm9tU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSwga2V5ZnJhbWVzLCB1cmwpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIHVuZGVmaW5lZCwga2V5ZnJhbWVzLCBzb3VyY2UpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21BU1QgPSBmdW5jdGlvbiAoYXN0LCBrZXlmcmFtZXMsIHVybCkge1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZShhc3QsIHVybCwgdW5kZWZpbmVkLCBrZXlmcmFtZXMsIHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ1NTU291cmNlLnByb3RvdHlwZSwgXCJzZWxlY3RvcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3NlbGVjdG9yczsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENTU1NvdXJjZS5wcm90b3R5cGUsIFwic291cmNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9zb3VyY2U7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBmaWxlX3N5c3RlbV8xLkZpbGUuZnJvbVBhdGgodGhpcy5fZmlsZSk7XG4gICAgICAgIHRoaXMuX3NvdXJjZSA9IGZpbGUucmVhZFRleHRTeW5jKCk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvdXJjZSAmJiB0aGlzLl9maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc291cmNlICYmIHRoaXMuc291cmNlICE9PSBcIltvYmplY3QgT2JqZWN0XVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VDU1NBc3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fYXN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTZWxlY3RvcnMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ3NzIHN0eWxpbmcgZmFpbGVkOiBcIiArIGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5wYXJzZUNTU0FzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3NvdXJjZSkge1xuICAgICAgICAgICAgc3dpdGNoIChwYXJzZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwibmF0aXZlc2NyaXB0XCI6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NwYXJzZXIgPSBuZXcgcGFyc2VyXzEuQ1NTM1BhcnNlcih0aGlzLl9zb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3R5bGVzaGVldCA9IGNzc3BhcnNlci5wYXJzZUFTdHlsZXNoZWV0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NOUyA9IG5ldyBwYXJzZXJfMS5DU1NOYXRpdmVTY3JpcHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXN0ID0gY3NzTlMucGFyc2VTdHlsZXNoZWV0KHN0eWxlc2hlZXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgY2FzZSBcInJld29ya1wiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hc3QgPSBjc3NfMS5wYXJzZSh0aGlzLl9zb3VyY2UsIHsgc291cmNlOiB0aGlzLl9maWxlIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fYXN0KSB7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSB0aGlzLmNyZWF0ZVNlbGVjdG9yc0Zyb21JbXBvcnRzKCkuY29uY2F0KHRoaXMuY3JlYXRlU2VsZWN0b3JzRnJvbVN5bnRheFRyZWUoKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzRnJvbUltcG9ydHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpbXBvcnRzID0gdGhpcy5fYXN0W1wic3R5bGVzaGVldFwiXVtcInJ1bGVzXCJdLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gci50eXBlID09PSBcImltcG9ydFwiOyB9KTtcbiAgICAgICAgdmFyIHVybEZyb21JbXBvcnRPYmplY3QgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaW1wb3J0SXRlbSA9IGltcG9ydE9iamVjdFtcImltcG9ydFwiXTtcbiAgICAgICAgICAgIHZhciB1cmxNYXRjaCA9IGltcG9ydEl0ZW0gJiYgaW1wb3J0SXRlbS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIHJldHVybiB1cmxNYXRjaCAmJiB1cmxNYXRjaFsyXTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNvdXJjZUZyb21JbXBvcnRPYmplY3QgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gaW1wb3J0T2JqZWN0W1wicG9zaXRpb25cIl0gJiYgaW1wb3J0T2JqZWN0W1wicG9zaXRpb25cIl1bXCJzb3VyY2VcIl07XG4gICAgICAgIH07XG4gICAgICAgIHZhciB0b1VybFNvdXJjZVBhaXIgPSBmdW5jdGlvbiAoaW1wb3J0T2JqZWN0KSB7IHJldHVybiAoe1xuICAgICAgICAgICAgdXJsOiB1cmxGcm9tSW1wb3J0T2JqZWN0KGltcG9ydE9iamVjdCksXG4gICAgICAgICAgICBzb3VyY2U6IHNvdXJjZUZyb21JbXBvcnRPYmplY3QoaW1wb3J0T2JqZWN0KSxcbiAgICAgICAgfSk7IH07XG4gICAgICAgIHZhciBnZXRDc3NGaWxlID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gX2EudXJsLCBzb3VyY2UgPSBfYS5zb3VyY2U7XG4gICAgICAgICAgICByZXR1cm4gc291cmNlID9cbiAgICAgICAgICAgICAgICBDU1NTb3VyY2UuZnJvbUZpbGVJbXBvcnQodXJsLCBfdGhpcy5fa2V5ZnJhbWVzLCBzb3VyY2UpIDpcbiAgICAgICAgICAgICAgICBDU1NTb3VyY2UuZnJvbVVSSSh1cmwsIF90aGlzLl9rZXlmcmFtZXMpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgY3NzRmlsZXMgPSBpbXBvcnRzXG4gICAgICAgICAgICAubWFwKHRvVXJsU291cmNlUGFpcilcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gX2EudXJsO1xuICAgICAgICAgICAgcmV0dXJuICEhdXJsO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLm1hcChnZXRDc3NGaWxlKTtcbiAgICAgICAgdmFyIHNlbGVjdG9ycyA9IGNzc0ZpbGVzLm1hcChmdW5jdGlvbiAoZmlsZSkgeyByZXR1cm4gKGZpbGUgJiYgZmlsZS5zZWxlY3RvcnMpIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgdmFsKSB7IHJldHVybiBhY2MuY29uY2F0KHZhbCk7IH0sIFtdKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUuY3JlYXRlU2VsZWN0b3JzRnJvbVN5bnRheFRyZWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBub2RlcyA9IHRoaXMuX2FzdC5zdHlsZXNoZWV0LnJ1bGVzO1xuICAgICAgICBub2Rlcy5maWx0ZXIoaXNLZXlmcmFtZSkuZm9yRWFjaChmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gX3RoaXMuX2tleWZyYW1lc1tub2RlLm5hbWVdID0gbm9kZTsgfSk7XG4gICAgICAgIHZhciBydWxlc2V0cyA9IGNzc19zZWxlY3Rvcl8xLmZyb21Bc3ROb2Rlcyhub2Rlcyk7XG4gICAgICAgIGlmIChydWxlc2V0cyAmJiBydWxlc2V0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpO1xuICAgICAgICAgICAgcnVsZXNldHMuZm9yRWFjaChmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgICAgIHJ1bGVbYW5pbWF0aW9uc1N5bWJvbF0gPSBjc3NBbmltYXRpb25QYXJzZXJNb2R1bGUuQ3NzQW5pbWF0aW9uUGFyc2VyXG4gICAgICAgICAgICAgICAgICAgIC5rZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTRGVjbGFyYXRpb25zKHJ1bGUuZGVjbGFyYXRpb25zKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBydWxlc2V0cztcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maWxlIHx8IHRoaXMuX3VybCB8fCBcIihpbi1tZW1vcnkpXCI7XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwibG9hZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwicGFyc2VcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UucHJvdG90eXBlLCBcInBhcnNlQ1NTQXN0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJjcmVhdGVTZWxlY3RvcnNcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UsIFwicmVzb2x2ZUNTU1BhdGhGcm9tVVJMXCIsIG51bGwpO1xuICAgIHJldHVybiBDU1NTb3VyY2U7XG59KCkpO1xuZnVuY3Rpb24gcmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUyh0YWcpIHtcbiAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnNbaV0udGFnID09PSB0YWcpIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICBpLS07XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbiAgICByZXR1cm4gY2hhbmdlZDtcbn1cbmV4cG9ydHMucmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUyA9IHJlbW92ZVRhZ2dlZEFkZGl0aW9uYWxDU1M7XG5mdW5jdGlvbiBhZGRUYWdnZWRBZGRpdGlvbmFsQ1NTKGNzc1RleHQsIHRhZykge1xuICAgIHZhciBwYXJzZWQgPSBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NUZXh0LCBhcHBsaWNhdGlvbktleWZyYW1lcywgdW5kZWZpbmVkKS5zZWxlY3RvcnM7XG4gICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcbiAgICBpZiAocGFyc2VkICYmIHBhcnNlZC5sZW5ndGgpIHtcbiAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgIGlmICh0YWcgIT0gbnVsbCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJzZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwYXJzZWRbaV0udGFnID0gdGFnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5wdXNoLmFwcGx5KGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycywgcGFyc2VkKTtcbiAgICAgICAgbWVyZ2VDc3NTZWxlY3RvcnMoKTtcbiAgICB9XG4gICAgcmV0dXJuIGNoYW5nZWQ7XG59XG5leHBvcnRzLmFkZFRhZ2dlZEFkZGl0aW9uYWxDU1MgPSBhZGRUYWdnZWRBZGRpdGlvbmFsQ1NTO1xudmFyIG9uQ3NzQ2hhbmdlZCA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLm9uQ3NzQ2hhbmdlZFwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGlmIChhcmdzLmNzc1RleHQpIHtcbiAgICAgICAgdmFyIHBhcnNlZCA9IENTU1NvdXJjZS5mcm9tU291cmNlKGFyZ3MuY3NzVGV4dCwgYXBwbGljYXRpb25LZXlmcmFtZXMsIGFyZ3MuY3NzRmlsZSkuc2VsZWN0b3JzO1xuICAgICAgICBpZiAocGFyc2VkKSB7XG4gICAgICAgICAgICBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMucHVzaC5hcHBseShhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMsIHBhcnNlZCk7XG4gICAgICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3MuY3NzRmlsZSkge1xuICAgICAgICBsb2FkQ3NzKGFyZ3MuY3NzRmlsZSk7XG4gICAgfVxufSk7XG5mdW5jdGlvbiBvbkxpdmVTeW5jKGFyZ3MpIHtcbiAgICBsb2FkQ3NzKGFwcGxpY2F0aW9uQ29tbW9uLmdldENzc0ZpbGVOYW1lKCkpO1xufVxudmFyIGxvYWRDc3MgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiXFxcInN0eWxlLXNjb3BlXFxcIi5sb2FkQ3NzXCIsIGZ1bmN0aW9uIChjc3NGaWxlKSB7XG4gICAgaWYgKCFjc3NGaWxlKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBDU1NTb3VyY2UuZnJvbVVSSShjc3NGaWxlLCBhcHBsaWNhdGlvbktleWZyYW1lcykuc2VsZWN0b3JzO1xuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICBhcHBsaWNhdGlvblNlbGVjdG9ycyA9IHJlc3VsdDtcbiAgICAgICAgbWVyZ2VDc3NTZWxlY3RvcnMoKTtcbiAgICB9XG59KTtcbmFwcGxpY2F0aW9uQ29tbW9uLm9uKFwiY3NzQ2hhbmdlZFwiLCBvbkNzc0NoYW5nZWQpO1xuYXBwbGljYXRpb25Db21tb24ub24oXCJsaXZlc3luY1wiLCBvbkxpdmVTeW5jKTtcbmV4cG9ydHMubG9hZEFwcENTUyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLmxvYWRBcHBDU1NcIiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICBsb2FkQ3NzKGFyZ3MuY3NzRmlsZSk7XG4gICAgYXBwbGljYXRpb25Db21tb24ub2ZmKFwibG9hZEFwcENzc1wiLCBleHBvcnRzLmxvYWRBcHBDU1MpO1xufSk7XG5pZiAoYXBwbGljYXRpb25Db21tb24uaGFzTGF1bmNoZWQoKSkge1xuICAgIGV4cG9ydHMubG9hZEFwcENTUyh7IGV2ZW50TmFtZTogXCJsb2FkQXBwQ3NzXCIsIG9iamVjdDogYXBwbGljYXRpb25Db21tb24sIGNzc0ZpbGU6IGFwcGxpY2F0aW9uQ29tbW9uLmdldENzc0ZpbGVOYW1lKCkgfSk7XG59XG5lbHNlIHtcbiAgICBhcHBsaWNhdGlvbkNvbW1vbi5vbihcImxvYWRBcHBDc3NcIiwgZXhwb3J0cy5sb2FkQXBwQ1NTKTtcbn1cbnZhciBDc3NTdGF0ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ3NzU3RhdGUodmlld1JlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnZpZXdSZWYgPSB2aWV3UmVmO1xuICAgICAgICB0aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy51cGRhdGVEeW5hbWljU3RhdGUoKTsgfTtcbiAgICB9XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy51bnN1YnNjcmliZUZyb21EeW5hbWljVXBkYXRlcygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVNYXRjaCgpO1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVGb3JEeW5hbWljVXBkYXRlcygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVEeW5hbWljU3RhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX21hdGNoSW52YWxpZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5pc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiaXNTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCByZXR1cm5zIGRlZmF1bHQgdmFsdWUgXFxcImZhbHNlXFxcIiBiZWNhdXNlIFxcXCJ0aGlzLnZpZXdSZWZcXFwiIGNsZWFyZWQuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy52aWV3UmVmLmdldCgpLl9zdHlsZVNjb3BlLl9nZXRTZWxlY3RvcnNWZXJzaW9uKCkgPT09IHRoaXMuX2FwcGxpZWRTZWxlY3RvcnNWZXJzaW9uO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fbWF0Y2hJbnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1hdGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzY3JpYmVGb3JEeW5hbWljVXBkYXRlcygpO1xuICAgICAgICB0aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudW5zdWJzY3JpYmVGcm9tRHluYW1pY1VwZGF0ZXMoKTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS51cGRhdGVNYXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX21hdGNoID0gdmlldy5fc3R5bGVTY29wZS5tYXRjaFNlbGVjdG9ycyh2aWV3KTtcbiAgICAgICAgICAgIHRoaXMuX2FwcGxpZWRTZWxlY3RvcnNWZXJzaW9uID0gdmlldy5fc3R5bGVTY29wZS5fZ2V0U2VsZWN0b3JzVmVyc2lvbigpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2ggPSBDc3NTdGF0ZS5lbXB0eU1hdGNoO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX21hdGNoSW52YWxpZCA9IGZhbHNlO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVwZGF0ZUR5bmFtaWNTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInVwZGF0ZUR5bmFtaWNTdGF0ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1hdGNoaW5nU2VsZWN0b3JzID0gdGhpcy5fbWF0Y2guc2VsZWN0b3JzLmZpbHRlcihmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwuZHluYW1pYyA/IHNlbC5tYXRjaCh2aWV3KSA6IHRydWU7IH0pO1xuICAgICAgICB2aWV3Ll9iYXRjaFVwZGF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zdG9wS2V5ZnJhbWVBbmltYXRpb25zKCk7XG4gICAgICAgICAgICBfdGhpcy5zZXRQcm9wZXJ0eVZhbHVlcyhtYXRjaGluZ1NlbGVjdG9ycyk7XG4gICAgICAgICAgICBfdGhpcy5wbGF5S2V5ZnJhbWVBbmltYXRpb25zKG1hdGNoaW5nU2VsZWN0b3JzKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUucGxheUtleWZyYW1lQW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChtYXRjaGluZ1NlbGVjdG9ycykge1xuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IFtdO1xuICAgICAgICBtYXRjaGluZ1NlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgdmFyIHJ1bGVBbmltYXRpb25zID0gc2VsZWN0b3IucnVsZXNldFthbmltYXRpb25zU3ltYm9sXTtcbiAgICAgICAgICAgIGlmIChydWxlQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgICAgIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBydWxlQW5pbWF0aW9uc18xID0gcnVsZUFuaW1hdGlvbnM7IF9pIDwgcnVsZUFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbkluZm8gPSBydWxlQW5pbWF0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGtleWZyYW1lQW5pbWF0aW9uTW9kdWxlLktleWZyYW1lQW5pbWF0aW9uLmtleWZyYW1lQW5pbWF0aW9uRnJvbUluZm8oYW5pbWF0aW9uSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zID0gYW5pbWF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgdmlld18xID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3XzEpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiS2V5ZnJhbWVBbmltYXRpb25zIGNhbm5vdCBwbGF5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5pbWF0aW9ucy5tYXAoZnVuY3Rpb24gKGFuaW1hdGlvbikgeyByZXR1cm4gYW5pbWF0aW9uLnBsYXkodmlld18xKTsgfSk7XG4gICAgICAgICAgICBPYmplY3QuZnJlZXplKGFuaW1hdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5fYXBwbGllZEFuaW1hdGlvbnMgPSBhbmltYXRpb25zO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUuc3RvcEtleWZyYW1lQW5pbWF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9wbGF5c0tleWZyYW1lQW5pbWF0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FwcGxpZWRBbmltYXRpb25zXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhbmltYXRpb24pIHsgcmV0dXJuIGFuaW1hdGlvbi5pc1BsYXlpbmc7IH0pXG4gICAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAoYW5pbWF0aW9uKSB7IHJldHVybiBhbmltYXRpb24uY2FuY2VsKCk7IH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQW5pbWF0aW9ucyA9IENzc1N0YXRlLmVtcHR5QW5pbWF0aW9uQXJyYXk7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnJvdGF0ZVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnNjYWxlWFwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnNjYWxlWVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnRyYW5zbGF0ZVhcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTp0cmFuc2xhdGVZXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6YmFja2dyb3VuZENvbG9yXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6b3BhY2l0eVwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lQW5pbWF0aW9ucyBjYW5ub3QgYmUgc3RvcHBlZCBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zID0gZmFsc2U7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUuc2V0UHJvcGVydHlWYWx1ZXMgPSBmdW5jdGlvbiAobWF0Y2hpbmdTZWxlY3RvcnMpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShtYXRjaGluZ1NlbGVjdG9ycyArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3UHJvcGVydHlWYWx1ZXMgPSBuZXcgdmlldy5zdHlsZS5Qcm9wZXJ0eUJhZygpO1xuICAgICAgICBtYXRjaGluZ1NlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIHNlbGVjdG9yLnJ1bGVzZXQuZGVjbGFyYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGRlY2xhcmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1Byb3BlcnR5VmFsdWVzW2RlY2xhcmF0aW9uLnByb3BlcnR5XSA9IGRlY2xhcmF0aW9uLnZhbHVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZnJlZXplKG5ld1Byb3BlcnR5VmFsdWVzKTtcbiAgICAgICAgdmFyIG9sZFByb3BlcnRpZXMgPSB0aGlzLl9hcHBsaWVkUHJvcGVydHlWYWx1ZXM7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBvbGRQcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBpZiAoIShrZXkgaW4gbmV3UHJvcGVydHlWYWx1ZXMpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGtleSBpbiB2aWV3LnN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJjc3M6XCIgKyBrZXldID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBuZXdQcm9wZXJ0eVZhbHVlcykge1xuICAgICAgICAgICAgaWYgKG9sZFByb3BlcnRpZXMgJiYgcHJvcGVydHkgaW4gb2xkUHJvcGVydGllcyAmJiBvbGRQcm9wZXJ0aWVzW3Byb3BlcnR5XSA9PT0gbmV3UHJvcGVydHlWYWx1ZXNbcHJvcGVydHldKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBuZXdQcm9wZXJ0eVZhbHVlc1twcm9wZXJ0eV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eSBpbiB2aWV3LnN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJjc3M6XCIgKyBwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYW1lbENhc2VkUHJvcGVydHkgPSBwcm9wZXJ0eS5yZXBsYWNlKC8tKFthLXpdKS9nLCBmdW5jdGlvbiAoZykgeyByZXR1cm4gZ1sxXS50b1VwcGVyQ2FzZSgpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgdmlld1tjYW1lbENhc2VkUHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRmFpbGVkIHRvIGFwcGx5IHByb3BlcnR5IFtcIiArIHByb3BlcnR5ICsgXCJdIHdpdGggdmFsdWUgW1wiICsgdmFsdWUgKyBcIl0gdG8gXCIgKyB2aWV3ICsgXCIuIFwiICsgZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hcHBsaWVkUHJvcGVydHlWYWx1ZXMgPSBuZXdQcm9wZXJ0eVZhbHVlcztcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5zdWJzY3JpYmVGb3JEeW5hbWljVXBkYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNoYW5nZU1hcCA9IHRoaXMuX21hdGNoLmNoYW5nZU1hcDtcbiAgICAgICAgY2hhbmdlTWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZXMsIHZpZXcpIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLmF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuYWRkRXZlbnRMaXN0ZW5lcihhdHRyaWJ1dGUgKyBcIkNoYW5nZVwiLCBfdGhpcy5fb25EeW5hbWljU3RhdGVDaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLnBzZXVkb0NsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnBzZXVkb0NsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAocHNldWRvQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IFwiOlwiICsgcHNldWRvQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcuYWRkRXZlbnRMaXN0ZW5lcihcIjpcIiArIHBzZXVkb0NsYXNzLCBfdGhpcy5fb25EeW5hbWljU3RhdGVDaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tldmVudE5hbWVdKCsxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYXBwbGllZENoYW5nZU1hcCA9IGNoYW5nZU1hcDtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS51bnN1YnNjcmliZUZyb21EeW5hbWljVXBkYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fYXBwbGllZENoYW5nZU1hcC5mb3JFYWNoKGZ1bmN0aW9uIChjaGFuZ2VzLCB2aWV3KSB7XG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5hdHRyaWJ1dGVzLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnJlbW92ZUV2ZW50TGlzdGVuZXIoYXR0cmlidXRlICsgXCJDaGFuZ2VcIiwgX3RoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hhbmdlcy5wc2V1ZG9DbGFzc2VzKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5wc2V1ZG9DbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKHBzZXVkb0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBldmVudE5hbWUgPSBcIjpcIiArIHBzZXVkb0NsYXNzO1xuICAgICAgICAgICAgICAgICAgICB2aWV3LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBfdGhpcy5fb25EeW5hbWljU3RhdGVDaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbZXZlbnROYW1lXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tldmVudE5hbWVdKC0xKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fYXBwbGllZENoYW5nZU1hcCA9IENzc1N0YXRlLmVtcHR5Q2hhbmdlTWFwO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwidG9TdHJpbmcoKSBvZiBDc3NTdGF0ZSBjYW5ub3QgZXhlY3V0ZSBjb3JyZWN0bHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3ICsgXCIuX2Nzc1N0YXRlXCI7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5lbXB0eUNoYW5nZU1hcCA9IE9iamVjdC5mcmVlemUobmV3IE1hcCgpKTtcbiAgICBDc3NTdGF0ZS5lbXB0eVByb3BlcnR5QmFnID0gT2JqZWN0LmZyZWV6ZSh7fSk7XG4gICAgQ3NzU3RhdGUuZW1wdHlBbmltYXRpb25BcnJheSA9IE9iamVjdC5mcmVlemUoW10pO1xuICAgIENzc1N0YXRlLmVtcHR5TWF0Y2ggPSB7IHNlbGVjdG9yczogW10sIGNoYW5nZU1hcDogbmV3IE1hcCgpIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDc3NTdGF0ZS5wcm90b3R5cGUsIFwidXBkYXRlTWF0Y2hcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDc3NTdGF0ZS5wcm90b3R5cGUsIFwidXBkYXRlRHluYW1pY1N0YXRlXCIsIG51bGwpO1xuICAgIHJldHVybiBDc3NTdGF0ZTtcbn0oKSk7XG5leHBvcnRzLkNzc1N0YXRlID0gQ3NzU3RhdGU7XG5Dc3NTdGF0ZS5wcm90b3R5cGUuX2FwcGxpZWRDaGFuZ2VNYXAgPSBDc3NTdGF0ZS5lbXB0eUNoYW5nZU1hcDtcbkNzc1N0YXRlLnByb3RvdHlwZS5fYXBwbGllZFByb3BlcnR5VmFsdWVzID0gQ3NzU3RhdGUuZW1wdHlQcm9wZXJ0eUJhZztcbkNzc1N0YXRlLnByb3RvdHlwZS5fYXBwbGllZEFuaW1hdGlvbnMgPSBDc3NTdGF0ZS5lbXB0eUFuaW1hdGlvbkFycmF5O1xuQ3NzU3RhdGUucHJvdG90eXBlLl9tYXRjaEludmFsaWQgPSB0cnVlO1xudmFyIFN0eWxlU2NvcGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0eWxlU2NvcGUoKSB7XG4gICAgICAgIHRoaXMuX2NzcyA9IFwiXCI7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzID0gW107XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMuX2FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9rZXlmcmFtZXMgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJjc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jc3M7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnNldENzcyh2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmFkZENzcyA9IGZ1bmN0aW9uIChjc3NTdHJpbmcsIGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuYXBwZW5kQ3NzKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuYWRkQ3NzRmlsZSA9IGZ1bmN0aW9uIChjc3NGaWxlTmFtZSkge1xuICAgICAgICB0aGlzLmFwcGVuZENzcyhudWxsLCBjc3NGaWxlTmFtZSk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5jaGFuZ2VDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIGlmICghY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY3NzU2VsZWN0b3JzID0gQ1NTU291cmNlLmZyb21VUkkoY3NzRmlsZU5hbWUsIHRoaXMuX2tleWZyYW1lcyk7XG4gICAgICAgIHRoaXMuX2NzcyA9IGNzc1NlbGVjdG9ycy5zb3VyY2U7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzID0gY3NzU2VsZWN0b3JzLnNlbGVjdG9ycztcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24rKztcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLnNldENzcyA9IGZ1bmN0aW9uIChjc3NTdHJpbmcsIGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuX2NzcyA9IGNzc1N0cmluZztcbiAgICAgICAgdmFyIGNzc0ZpbGUgPSBDU1NTb3VyY2UuZnJvbVNvdXJjZShjc3NTdHJpbmcsIHRoaXMuX2tleWZyYW1lcywgY3NzRmlsZU5hbWUpO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9ycyA9IGNzc0ZpbGUuc2VsZWN0b3JzO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbisrO1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuYXBwZW5kQ3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgaWYgKCFjc3NTdHJpbmcgJiYgIWNzc0ZpbGVOYW1lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcnNlZENzc1NlbGVjdG9ycyA9IGNzc1N0cmluZyA/IENTU1NvdXJjZS5mcm9tU291cmNlKGNzc1N0cmluZywgdGhpcy5fa2V5ZnJhbWVzLCBjc3NGaWxlTmFtZSkgOiBDU1NTb3VyY2UuZnJvbVVSSShjc3NGaWxlTmFtZSwgdGhpcy5fa2V5ZnJhbWVzKTtcbiAgICAgICAgdGhpcy5fY3NzID0gdGhpcy5fY3NzICsgcGFyc2VkQ3NzU2VsZWN0b3JzLnNvdXJjZTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMucHVzaC5hcHBseSh0aGlzLl9sb2NhbENzc1NlbGVjdG9ycywgcGFyc2VkQ3NzU2VsZWN0b3JzLnNlbGVjdG9ycyk7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uKys7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5nZXRLZXlmcmFtZUFuaW1hdGlvbldpdGhOYW1lID0gZnVuY3Rpb24gKGFuaW1hdGlvbk5hbWUpIHtcbiAgICAgICAgdmFyIGNzc0tleWZyYW1lcyA9IHRoaXMuX2tleWZyYW1lc1thbmltYXRpb25OYW1lXTtcbiAgICAgICAgaWYgKCFjc3NLZXlmcmFtZXMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbnN1cmVLZXlmcmFtZUFuaW1hdGlvbk1vZHVsZSgpO1xuICAgICAgICB2YXIgYW5pbWF0aW9uID0gbmV3IGtleWZyYW1lQW5pbWF0aW9uTW9kdWxlLktleWZyYW1lQW5pbWF0aW9uSW5mbygpO1xuICAgICAgICBlbnN1cmVDc3NBbmltYXRpb25QYXJzZXJNb2R1bGUoKTtcbiAgICAgICAgYW5pbWF0aW9uLmtleWZyYW1lcyA9IGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZVxuICAgICAgICAgICAgLkNzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZXNBcnJheUZyb21DU1MoY3NzS2V5ZnJhbWVzLmtleWZyYW1lcyk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5lbnN1cmVTZWxlY3RvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQoKSB8fFxuICAgICAgICAgICAgIXRoaXMuaXNMb2NhbENzc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkKCkgfHxcbiAgICAgICAgICAgICF0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVNlbGVjdG9ycygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRTZWxlY3RvcnNWZXJzaW9uKCk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5pc0FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID09PSBhcHBsaWNhdGlvbkNzc1NlbGVjdG9yVmVyc2lvbjtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmlzTG9jYWxDc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPT09IHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuX2NyZWF0ZVNlbGVjdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRvTWVyZ2UgPSBbXTtcbiAgICAgICAgdG9NZXJnZS5wdXNoKGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzKTtcbiAgICAgICAgdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9IGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uO1xuICAgICAgICB0b01lcmdlLnB1c2godGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMpO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb247XG4gICAgICAgIGZvciAodmFyIGtleWZyYW1lIGluIGFwcGxpY2F0aW9uS2V5ZnJhbWVzKSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlmcmFtZXNba2V5ZnJhbWVdID0gYXBwbGljYXRpb25LZXlmcmFtZXNba2V5ZnJhbWVdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0b01lcmdlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuX21lcmdlZENzc1NlbGVjdG9ycyA9IHRvTWVyZ2UuZmlsdGVyKGZ1bmN0aW9uIChtKSB7IHJldHVybiAhIW07IH0pLnJlZHVjZShmdW5jdGlvbiAobWVyZ2VkLCBuZXh0KSB7IHJldHVybiBtZXJnZWQuY29uY2F0KG5leHQpOyB9LCBbXSk7XG4gICAgICAgICAgICB0aGlzLl9hcHBseUtleWZyYW1lc09uU2VsZWN0b3JzKCk7XG4gICAgICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBuZXcgY3NzX3NlbGVjdG9yXzEuU2VsZWN0b3JzTWFwKHRoaXMuX21lcmdlZENzc1NlbGVjdG9ycyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLm1hdGNoU2VsZWN0b3JzID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdG9ycy5xdWVyeSh2aWV3KTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLnF1ZXJ5ID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdG9ycy5xdWVyeShub2RlKS5zZWxlY3RvcnM7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5fZ2V0U2VsZWN0b3JzVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDEwMDAwMCAqIHRoaXMuX2FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gKyB0aGlzLl9sb2NhbENzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuX2FwcGx5S2V5ZnJhbWVzT25TZWxlY3RvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBydWxlc2V0ID0gdGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzW2ldO1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbnMgPSBydWxlc2V0W2FuaW1hdGlvbnNTeW1ib2xdO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbnMgIT09IHVuZGVmaW5lZCAmJiBhbmltYXRpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgYW5pbWF0aW9uc18xID0gYW5pbWF0aW9uczsgX2kgPCBhbmltYXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSBhbmltYXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3NzS2V5ZnJhbWUgPSB0aGlzLl9rZXlmcmFtZXNbYW5pbWF0aW9uLm5hbWVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3NzS2V5ZnJhbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLmtleWZyYW1lcyA9IGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5Dc3NBbmltYXRpb25QYXJzZXIua2V5ZnJhbWVzQXJyYXlGcm9tQ1NTKGNzc0tleWZyYW1lLmtleWZyYW1lcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmdldEFuaW1hdGlvbnMgPSBmdW5jdGlvbiAocnVsZXNldCkge1xuICAgICAgICByZXR1cm4gcnVsZXNldFthbmltYXRpb25zU3ltYm9sXTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgU3R5bGVTY29wZS5wcm90b3R5cGUsIFwic2V0Q3NzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgU3R5bGVTY29wZS5wcm90b3R5cGUsIFwiYXBwZW5kQ3NzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgU3R5bGVTY29wZS5wcm90b3R5cGUsIFwiX2NyZWF0ZVNlbGVjdG9yc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFN0eWxlU2NvcGUucHJvdG90eXBlLCBcIm1hdGNoU2VsZWN0b3JzXCIsIG51bGwpO1xuICAgIHJldHVybiBTdHlsZVNjb3BlO1xufSgpKTtcbmV4cG9ydHMuU3R5bGVTY29wZSA9IFN0eWxlU2NvcGU7XG5mdW5jdGlvbiByZXNvbHZlRmlsZU5hbWVGcm9tVXJsKHVybCwgYXBwRGlyZWN0b3J5LCBmaWxlRXhpc3RzLCBpbXBvcnRTb3VyY2UpIHtcbiAgICB2YXIgZmlsZU5hbWUgPSB0eXBlb2YgdXJsID09PSBcInN0cmluZ1wiID8gdXJsLnRyaW0oKSA6IFwiXCI7XG4gICAgaWYgKGZpbGVOYW1lLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCkge1xuICAgICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lLnJlcGxhY2UoXCJ+L1wiLCBcIlwiKTtcbiAgICB9XG4gICAgdmFyIGlzQWJzb2x1dGVQYXRoID0gZmlsZU5hbWUuaW5kZXhPZihcIi9cIikgPT09IDA7XG4gICAgdmFyIGFic29sdXRlUGF0aCA9IGlzQWJzb2x1dGVQYXRoID8gZmlsZU5hbWUgOiBmaWxlX3N5c3RlbV8xLnBhdGguam9pbihhcHBEaXJlY3RvcnksIGZpbGVOYW1lKTtcbiAgICBpZiAoZmlsZUV4aXN0cyhhYnNvbHV0ZVBhdGgpKSB7XG4gICAgICAgIHJldHVybiBhYnNvbHV0ZVBhdGg7XG4gICAgfVxuICAgIGlmICghaXNBYnNvbHV0ZVBhdGgpIHtcbiAgICAgICAgaWYgKGZpbGVOYW1lWzBdID09PSBcIn5cIiAmJiBmaWxlTmFtZVsxXSAhPT0gXCIvXCIgJiYgZmlsZU5hbWVbMV0gIT09IFwiXFxcIlwiKSB7XG4gICAgICAgICAgICBmaWxlTmFtZSA9IGZpbGVOYW1lLnN1YnN0cigxKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW1wb3J0U291cmNlKSB7XG4gICAgICAgICAgICB2YXIgaW1wb3J0RmlsZSA9IHJlc29sdmVGaWxlUGF0aEZyb21JbXBvcnQoaW1wb3J0U291cmNlLCBmaWxlTmFtZSk7XG4gICAgICAgICAgICBpZiAoZmlsZUV4aXN0cyhpbXBvcnRGaWxlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbXBvcnRGaWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBleHRlcm5hbF8xID0gZmlsZV9zeXN0ZW1fMS5wYXRoLmpvaW4oYXBwRGlyZWN0b3J5LCBcInRuc19tb2R1bGVzXCIsIGZpbGVOYW1lKTtcbiAgICAgICAgaWYgKGZpbGVFeGlzdHMoZXh0ZXJuYWxfMSkpIHtcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF8xO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5yZXNvbHZlRmlsZU5hbWVGcm9tVXJsID0gcmVzb2x2ZUZpbGVOYW1lRnJvbVVybDtcbmZ1bmN0aW9uIHJlc29sdmVGaWxlUGF0aEZyb21JbXBvcnQoaW1wb3J0U291cmNlLCBmaWxlTmFtZSkge1xuICAgIHZhciBpbXBvcnRTb3VyY2VQYXJ0cyA9IGltcG9ydFNvdXJjZS5zcGxpdChmaWxlX3N5c3RlbV8xLnBhdGguc2VwYXJhdG9yKTtcbiAgICB2YXIgZmlsZU5hbWVQYXJ0cyA9IGZpbGVOYW1lLnNwbGl0KGZpbGVfc3lzdGVtXzEucGF0aC5zZXBhcmF0b3IpXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuICFpc0N1cnJlbnREaXJlY3RvcnkocCk7IH0pO1xuICAgIGltcG9ydFNvdXJjZVBhcnRzLnBvcCgpO1xuICAgIGZpbGVOYW1lUGFydHMuZm9yRWFjaChmdW5jdGlvbiAocCkgeyByZXR1cm4gaXNQYXJlbnREaXJlY3RvcnkocCkgPyBpbXBvcnRTb3VyY2VQYXJ0cy5wb3AoKSA6IGltcG9ydFNvdXJjZVBhcnRzLnB1c2gocCk7IH0pO1xuICAgIHJldHVybiBpbXBvcnRTb3VyY2VQYXJ0cy5qb2luKGZpbGVfc3lzdGVtXzEucGF0aC5zZXBhcmF0b3IpO1xufVxuZXhwb3J0cy5hcHBseUlubGluZVN0eWxlID0gcHJvZmlsaW5nXzEucHJvZmlsZShmdW5jdGlvbiBhcHBseUlubGluZVN0eWxlKHZpZXcsIHN0eWxlU3RyKSB7XG4gICAgdmFyIGxvY2FsU3R5bGUgPSBcImxvY2FsIHsgXCIgKyBzdHlsZVN0ciArIFwiIH1cIjtcbiAgICB2YXIgaW5saW5lUnVsZVNldCA9IENTU1NvdXJjZS5mcm9tU291cmNlKGxvY2FsU3R5bGUsIG5ldyBNYXAoKSkuc2VsZWN0b3JzO1xuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgaW5saW5lUnVsZVNldFswXS5kZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgICB2YXIgbmFtZSA9IGQucHJvcGVydHk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAobmFtZSBpbiBzdHlsZSkge1xuICAgICAgICAgICAgICAgIHN0eWxlW25hbWVdID0gZC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZpZXdbbmFtZV0gPSBkLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRmFpbGVkIHRvIGFwcGx5IHByb3BlcnR5IFtcIiArIGQucHJvcGVydHkgKyBcIl0gd2l0aCB2YWx1ZSBbXCIgKyBkLnZhbHVlICsgXCJdIHRvIFwiICsgdmlldyArIFwiLiBcIiArIGUsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuZnVuY3Rpb24gaXNDdXJyZW50RGlyZWN0b3J5KHVyaVBhcnQpIHtcbiAgICByZXR1cm4gdXJpUGFydCA9PT0gXCIuXCI7XG59XG5mdW5jdGlvbiBpc1BhcmVudERpcmVjdG9yeSh1cmlQYXJ0KSB7XG4gICAgcmV0dXJuIHVyaVBhcnQgPT09IFwiLi5cIjtcbn1cbmZ1bmN0aW9uIGlzS2V5ZnJhbWUobm9kZSkge1xuICAgIHJldHVybiBub2RlLnR5cGUgPT09IFwia2V5ZnJhbWVzXCI7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdHlsZS1zY29wZS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL3RyYWNlXCIpO1xudmFyIFN0eWxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3R5bGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3R5bGUob3duZXJWaWV3KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmIChvd25lclZpZXcuY29uc3RydWN0b3IudG9TdHJpbmcoKS5pbmRleE9mKFwiW25hdGl2ZSBjb2RlXVwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIF90aGlzLnZpZXdSZWYgPSBvd25lclZpZXc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy52aWV3UmVmID0gbmV3IFdlYWtSZWYob3duZXJWaWV3KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN0eWxlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcInRvU3RyaW5nKCkgb2YgU3R5bGUgY2Fubm90IGV4ZWN1dGUgY29ycmVjdGx5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmlldyArIFwiLnN0eWxlXCI7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3R5bGUucHJvdG90eXBlLCBcInZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZpZXdSZWYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFN0eWxlO1xufShvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkpO1xuZXhwb3J0cy5TdHlsZSA9IFN0eWxlO1xuU3R5bGUucHJvdG90eXBlLlByb3BlcnR5QmFnID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc18xKCkge1xuICAgIH1cbiAgICByZXR1cm4gY2xhc3NfMTtcbn0oKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdHlsZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb2xvclwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xudmFyIFN3aXRjaEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTd2l0Y2hCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN3aXRjaEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3dpdGNoQmFzZS5wcm90b3R5cGUuX29uQ2hlY2tlZFByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgIH07XG4gICAgU3dpdGNoQmFzZS5jaGVja2VkQ2hhbmdlRXZlbnQgPSBcImNoZWNrZWRDaGFuZ2VcIjtcbiAgICBTd2l0Y2hCYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiU3dpdGNoXCIpXG4gICAgXSwgU3dpdGNoQmFzZSk7XG4gICAgcmV0dXJuIFN3aXRjaEJhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlN3aXRjaEJhc2UgPSBTd2l0Y2hCYXNlO1xuU3dpdGNoQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmZ1bmN0aW9uIG9uQ2hlY2tlZFByb3BlcnR5Q2hhbmdlZChzd2l0Y2hCYXNlLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBzd2l0Y2hCYXNlLl9vbkNoZWNrZWRQcm9wZXJ0eUNoYW5nZWQobmV3VmFsdWUpO1xufVxuZXhwb3J0cy5jaGVja2VkUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJjaGVja2VkXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciwgdmFsdWVDaGFuZ2VkOiBvbkNoZWNrZWRQcm9wZXJ0eUNoYW5nZWQgfSk7XG5leHBvcnRzLmNoZWNrZWRQcm9wZXJ0eS5yZWdpc3RlcihTd2l0Y2hCYXNlKTtcbmV4cG9ydHMub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJvZmZCYWNrZ3JvdW5kQ29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLm9mZkJhY2tncm91bmRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFN3aXRjaEJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3dpdGNoLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHN3aXRjaF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3N3aXRjaC1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9zd2l0Y2gtY29tbW9uXCIpKTtcbnZhciBTd2l0Y2hDaGFuZ2VIYW5kbGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFN3aXRjaENoYW5nZUhhbmRsZXJJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN3aXRjaENoYW5nZUhhbmRsZXJJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN3aXRjaENoYW5nZUhhbmRsZXJJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBTd2l0Y2hDaGFuZ2VIYW5kbGVySW1wbC5uZXcoKTtcbiAgICAgICAgaGFuZGxlci5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGhhbmRsZXI7XG4gICAgfTtcbiAgICBTd2l0Y2hDaGFuZ2VIYW5kbGVySW1wbC5wcm90b3R5cGUudmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gKHNlbmRlcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBzd2l0Y2hfY29tbW9uXzEuY2hlY2tlZFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBzZW5kZXIub24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTd2l0Y2hDaGFuZ2VIYW5kbGVySW1wbC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwidmFsdWVDaGFuZ2VkXCI6IHsgcmV0dXJuczogaW50ZXJvcC50eXBlcy52b2lkLCBwYXJhbXM6IFtVSVN3aXRjaF0gfVxuICAgIH07XG4gICAgcmV0dXJuIFN3aXRjaENoYW5nZUhhbmRsZXJJbXBsO1xufShOU09iamVjdCkpO1xudmFyIHplcm9TaXplID0geyB3aWR0aDogMCwgaGVpZ2h0OiAwIH07XG52YXIgU3dpdGNoID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3dpdGNoLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN3aXRjaCgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMud2lkdGggPSA1MTtcbiAgICAgICAgX3RoaXMuaGVpZ2h0ID0gMzE7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3dpdGNoLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVUlTd2l0Y2gubmV3KCk7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0aGlzLl9oYW5kbGVyID0gU3dpdGNoQ2hhbmdlSGFuZGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVGFyZ2V0QWN0aW9uRm9yQ29udHJvbEV2ZW50cyh0aGlzLl9oYW5kbGVyLCBcInZhbHVlQ2hhbmdlZFwiLCA0MDk2KTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3dpdGNoLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN3aXRjaC5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBuYXRpdmVTaXplID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNpemVUaGF0Rml0cyh6ZXJvU2l6ZSk7XG4gICAgICAgIHRoaXMud2lkdGggPSBuYXRpdmVTaXplLndpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IG5hdGl2ZVNpemUuaGVpZ2h0O1xuICAgICAgICB2YXIgd2lkdGhBbmRTdGF0ZSA9IFN3aXRjaC5yZXNvbHZlU2l6ZUFuZFN0YXRlKHN3aXRjaF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMobmF0aXZlU2l6ZS53aWR0aCksIHN3aXRjaF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoNTEpLCBzd2l0Y2hfY29tbW9uXzEubGF5b3V0LkVYQUNUTFksIDApO1xuICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBTd2l0Y2gucmVzb2x2ZVNpemVBbmRTdGF0ZShzd2l0Y2hfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG5hdGl2ZVNpemUuaGVpZ2h0KSwgc3dpdGNoX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscygzMSksIHN3aXRjaF9jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuY2hlY2tlZFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jaGVja2VkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQub24gPSB2YWx1ZTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGh1bWJUaW50Q29sb3I7XG4gICAgfTtcbiAgICBTd2l0Y2gucHJvdG90eXBlW3N3aXRjaF9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRodW1iVGludENvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBzd2l0Y2hfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICB9O1xuICAgIFN3aXRjaC5wcm90b3R5cGVbc3dpdGNoX2NvbW1vbl8xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm9uVGludENvbG9yO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQub25UaW50Q29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHN3aXRjaF9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYmFja2dyb3VuZENvbG9yO1xuICAgIH07XG4gICAgU3dpdGNoLnByb3RvdHlwZVtzd2l0Y2hfY29tbW9uXzEub2ZmQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmFsdWUgPSB2YWx1ZSBpbnN0YW5jZW9mIHN3aXRjaF9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudGludENvbG9yID0gbmF0aXZlVmFsdWU7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5iYWNrZ3JvdW5kQ29sb3IgPSBuYXRpdmVWYWx1ZTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheWVyLmNvcm5lclJhZGl1cyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5mcmFtZS5zaXplLmhlaWdodCAvIDI7XG4gICAgfTtcbiAgICByZXR1cm4gU3dpdGNoO1xufShzd2l0Y2hfY29tbW9uXzEuU3dpdGNoQmFzZSkpO1xuZXhwb3J0cy5Td2l0Y2ggPSBTd2l0Y2g7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zd2l0Y2guaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xuZXhwb3J0cy50cmFjZUNhdGVnb3J5ID0gXCJUYWJWaWV3XCI7XG52YXIgVGFiQ29udGVudEl0ZW1CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiQ29udGVudEl0ZW1CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYkNvbnRlbnRJdGVtQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJDb250ZW50SXRlbUJhc2UucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHZpZXdfMS5WaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYkNvbnRlbnRJdGVtQmFzZS5wcm90b3R5cGUsIFwidmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdmlldyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDaGFuZ2luZyB0aGUgdmlldyBvZiBhbiBhbHJlYWR5IGxvYWRlZCBUYWJDb250ZW50SXRlbSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiQ29udGVudEl0ZW1CYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLl92aWV3O1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgY2FsbGJhY2sodmlldyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYkNvbnRlbnRJdGVtQmFzZS5wcm90b3R5cGUubG9hZFZpZXcgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgdGFiVmlldyA9IHRoaXMucGFyZW50O1xuICAgICAgICBpZiAodGFiVmlldyAmJiB0YWJWaWV3Lml0ZW1zKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW5CZUxvYWRlZCkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUubG9hZFZpZXcuY2FsbCh0aGlzLCB2aWV3KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW1CYXNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiQ29udGVudEl0ZW1cIilcbiAgICBdLCBUYWJDb250ZW50SXRlbUJhc2UpO1xuICAgIHJldHVybiBUYWJDb250ZW50SXRlbUJhc2U7XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5UYWJDb250ZW50SXRlbUJhc2UgPSBUYWJDb250ZW50SXRlbUJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItY29udGVudC1pdGVtLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRhYl9jb250ZW50X2l0ZW1fY29tbW9uXzEgPSByZXF1aXJlKFwiLi90YWItY29udGVudC1pdGVtLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RhYi1jb250ZW50LWl0ZW0tY29tbW9uXCIpKTtcbnZhciBUYWJDb250ZW50SXRlbSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYkNvbnRlbnRJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYkNvbnRlbnRJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYkNvbnRlbnRJdGVtLnByb3RvdHlwZS5zZXRWaWV3Q29udHJvbGxlciA9IGZ1bmN0aW9uIChjb250cm9sbGVyLCBuYXRpdmVWaWV3KSB7XG4gICAgICAgIHRoaXMuX19jb250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KG5hdGl2ZVZpZXcpO1xuICAgIH07XG4gICAgVGFiQ29udGVudEl0ZW0ucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9fY29udHJvbGxlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICByZXR1cm4gVGFiQ29udGVudEl0ZW07XG59KHRhYl9jb250ZW50X2l0ZW1fY29tbW9uXzEuVGFiQ29udGVudEl0ZW1CYXNlKSk7XG5leHBvcnRzLlRhYkNvbnRlbnRJdGVtID0gVGFiQ29udGVudEl0ZW07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItY29udGVudC1pdGVtLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKTtcbnZhciBrbm93bkNvbGxlY3Rpb25zO1xuKGZ1bmN0aW9uIChrbm93bkNvbGxlY3Rpb25zKSB7XG4gICAga25vd25Db2xsZWN0aW9ucy5pdGVtcyA9IFwiaXRlbXNcIjtcbn0pKGtub3duQ29sbGVjdGlvbnMgPSBleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgfHwgKGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyA9IHt9KSk7XG52YXIgVGFiTmF2aWdhdGlvbkJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJOYXZpZ2F0aW9uQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJOYXZpZ2F0aW9uQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuX2FkZEFycmF5RnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiaXRlbXNcIikge1xuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiVGFiQ29udGVudEl0ZW1cIikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWUgPT09IFwiVGFiU3RyaXBcIikge1xuICAgICAgICAgICAgdGhpcy50YWJTdHJpcCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUsIFwiX3NlbGVjdGVkVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRJbmRleCA+IC0xID8gdGhpcy5pdGVtc1tzZWxlY3RlZEluZGV4XS52aWV3IDogbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGFiU3RyaXAgPSB0aGlzLnRhYlN0cmlwO1xuICAgICAgICBpZiAodGFiU3RyaXApIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRhYlN0cmlwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbS52aWV3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgb2xkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZVZpZXcoaXRlbSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdJdGVtcykge1xuICAgICAgICAgICAgbmV3SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmICghaXRlbS52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRhYkNvbnRlbnRJdGVtIG11c3QgaGF2ZSBhIHZpZXcuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5fYWRkVmlldyhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUub25UYWJTdHJpcENoYW5nZWQgPSBmdW5jdGlvbiAob2xkVGFiU3RyaXAsIG5ld1RhYlN0cmlwKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChvbGRUYWJTdHJpcCAmJiBvbGRUYWJTdHJpcC5pdGVtcyAmJiBvbGRUYWJTdHJpcC5pdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIG9sZFRhYlN0cmlwLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIF90aGlzLl9yZW1vdmVWaWV3KGl0ZW0pOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmV3VGFiU3RyaXAgJiYgbmV3VGFiU3RyaXAuaXRlbXMgJiYgbmV3VGFiU3RyaXAuaXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBuZXdUYWJTdHJpcC5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2FkZFZpZXcoaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQgPSBmdW5jdGlvbiAob2xkSW5kZXgsIG5ld0luZGV4KSB7XG4gICAgICAgIHRoaXMubm90aWZ5KHsgZXZlbnROYW1lOiBUYWJOYXZpZ2F0aW9uQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50LCBvYmplY3Q6IHRoaXMsIG9sZEluZGV4OiBvbGRJbmRleCwgbmV3SW5kZXg6IG5ld0luZGV4IH0pO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckJhY2tncm91bmRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFyRm9udEludGVybmFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJGb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJUZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJUZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuc2V0VGFiQmFyQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJJdGVtQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSwgdmFsdWUpIHtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5nZXRUYWJCYXJJdGVtQ29sb3IgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Db2xvciA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuZ2V0VGFiQmFySXRlbUZvbnRTaXplID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtRm9udFNpemUgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLnNldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodGFiU3RyaXBJdGVtLCB2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiTmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLmdldFRhYkJhckl0ZW1UZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYk5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5zZXRUYWJCYXJJdGVtVGV4dFRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0YWJTdHJpcEl0ZW0sIHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJOYXZpZ2F0aW9uQmFzZS5zZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50ID0gXCJzZWxlY3RlZEluZGV4Q2hhbmdlZFwiO1xuICAgIHJldHVybiBUYWJOYXZpZ2F0aW9uQmFzZTtcbn0odmlld18xLlZpZXcpKTtcbmV4cG9ydHMuVGFiTmF2aWdhdGlvbkJhc2UgPSBUYWJOYXZpZ2F0aW9uQmFzZTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Db2VyY2libGVQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzZWxlY3RlZEluZGV4XCIsIGRlZmF1bHRWYWx1ZTogLTEsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB0YXJnZXQub25TZWxlY3RlZEluZGV4Q2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH0sXG4gICAgY29lcmNlVmFsdWU6IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRhcmdldC5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gaXRlbXMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5yZWdpc3RlcihUYWJOYXZpZ2F0aW9uQmFzZSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIml0ZW1zXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vbkl0ZW1zQ2hhbmdlZChvbGRWYWx1ZSwgbmV3VmFsdWUpO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5pdGVtc1Byb3BlcnR5LnJlZ2lzdGVyKFRhYk5hdmlnYXRpb25CYXNlKTtcbmV4cG9ydHMudGFiU3RyaXBQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidGFiU3RyaXBcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uVGFiU3RyaXBDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfVxufSk7XG5leHBvcnRzLnRhYlN0cmlwUHJvcGVydHkucmVnaXN0ZXIoVGFiTmF2aWdhdGlvbkJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFiLW5hdmlnYXRpb24tYmFzZS5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb3JlL3ZpZXdcIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdGV4dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uLy4uL2NvcmUvdmlld1wiKSk7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcnkgPSBcIlRhYlZpZXdcIjtcbnZhciBUYWJTdHJpcEl0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJTdHJpcEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFiU3RyaXBJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYlN0cmlwSXRlbV8xID0gVGFiU3RyaXBJdGVtO1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiSW1hZ2VcIikge1xuICAgICAgICAgICAgdGhpcy5pbWFnZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5pY29uU291cmNlID0gdmFsdWUuc3JjO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT09IFwiTGFiZWxcIikge1xuICAgICAgICAgICAgdGhpcy5sYWJlbCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9IHZhbHVlLnRleHQ7XG4gICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGUuX3VwZGF0ZVRhYlN0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHN1YnNjcmliZSkge1xuICAgICAgICAgICAgdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyID0gdGhpcy5faGlnaGxpZ2h0ZWRIYW5kbGVyIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9ub3JtYWxIYW5kbGVyID0gdGhpcy5fbm9ybWFsSGFuZGxlciB8fCAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJub3JtYWxcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMub24oVGFiU3RyaXBJdGVtXzEuc2VsZWN0RXZlbnQsIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLm9uKFRhYlN0cmlwSXRlbV8xLnVuc2VsZWN0RXZlbnQsIHRoaXMuX25vcm1hbEhhbmRsZXIpO1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnRfMSAmJiBwYXJlbnRfMS5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5pbmRleCA9PT0gdGFiU3RyaXBQYXJlbnQuc2VsZWN0ZWRJbmRleCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2dvVG9WaXN1YWxTdGF0ZShcImhpZ2hsaWdodGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vZmYoVGFiU3RyaXBJdGVtXzEuc2VsZWN0RXZlbnQsIHRoaXMuX2hpZ2hsaWdodGVkSGFuZGxlcik7XG4gICAgICAgICAgICB0aGlzLm9mZihUYWJTdHJpcEl0ZW1fMS51bnNlbGVjdEV2ZW50LCB0aGlzLl9ub3JtYWxIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5nZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1CYWNrZ3JvdW5kQ29sb3IodGhpcywgdmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGFiU3RyaXBJdGVtLnByb3RvdHlwZVt2aWV3XzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LmdldFRhYkJhckl0ZW1Db2xvcih0aGlzKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGVbdmlld18xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuc2V0VGFiQmFySXRlbUNvbG9yKHRoaXMsIHZhbHVlKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGVbdmlld18xLmZvbnRTaXplUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5nZXRUYWJCYXJJdGVtRm9udFNpemUodGhpcyk7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5mb250U2l6ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LnNldFRhYkJhckl0ZW1Gb250U2l6ZSh0aGlzLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgdGFiU3RyaXBQYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50LnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRhYlN0cmlwUGFyZW50ICYmIHRhYlN0cmlwUGFyZW50LmdldFRhYkJhckl0ZW1Gb250SW50ZXJuYWwodGhpcyk7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3ZpZXdfMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJdGVtRm9udEludGVybmFsKHRoaXMsIHZhbHVlKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwSXRlbS5wcm90b3R5cGVbdGV4dF9iYXNlXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHZhciB0YWJTdHJpcFBhcmVudCA9IHBhcmVudCAmJiBwYXJlbnQucGFyZW50O1xuICAgICAgICByZXR1cm4gdGFiU3RyaXBQYXJlbnQgJiYgdGFiU3RyaXBQYXJlbnQuZ2V0VGFiQmFySXRlbVRleHRUcmFuc2Zvcm0odGhpcyk7XG4gICAgfTtcbiAgICBUYWJTdHJpcEl0ZW0ucHJvdG90eXBlW3RleHRfYmFzZV8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdmFyIHRhYlN0cmlwUGFyZW50ID0gcGFyZW50ICYmIHBhcmVudC5wYXJlbnQ7XG4gICAgICAgIHJldHVybiB0YWJTdHJpcFBhcmVudCAmJiB0YWJTdHJpcFBhcmVudC5zZXRUYWJCYXJJdGVtVGV4dFRyYW5zZm9ybSh0aGlzLCB2YWx1ZSk7XG4gICAgfTtcbiAgICB2YXIgVGFiU3RyaXBJdGVtXzE7XG4gICAgVGFiU3RyaXBJdGVtLnRhcEV2ZW50ID0gXCJ0YXBcIjtcbiAgICBUYWJTdHJpcEl0ZW0uc2VsZWN0RXZlbnQgPSBcInNlbGVjdFwiO1xuICAgIFRhYlN0cmlwSXRlbS51bnNlbGVjdEV2ZW50ID0gXCJ1bnNlbGVjdFwiO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuUHNldWRvQ2xhc3NIYW5kbGVyKFwibm9ybWFsXCIsIFwiaGlnaGxpZ2h0ZWRcIiwgXCJwcmVzc2VkXCIsIFwiYWN0aXZlXCIpXG4gICAgXSwgVGFiU3RyaXBJdGVtLnByb3RvdHlwZSwgXCJfdXBkYXRlVGFiU3RhdGVDaGFuZ2VIYW5kbGVyXCIsIG51bGwpO1xuICAgIFRhYlN0cmlwSXRlbSA9IFRhYlN0cmlwSXRlbV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiU3RyaXBJdGVtXCIpXG4gICAgXSwgVGFiU3RyaXBJdGVtKTtcbiAgICByZXR1cm4gVGFiU3RyaXBJdGVtO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5UYWJTdHJpcEl0ZW0gPSBUYWJTdHJpcEl0ZW07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItc3RyaXAtaXRlbS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jb2xvclwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vLi4vY29yZS92aWV3XCIpO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uLy4uL3RleHQtYmFzZVwiKTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yeSA9IFwiVGFiVmlld1wiO1xuZXhwb3J0cy5oaWdobGlnaHRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaGlnaGxpZ2h0Q29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3Iodik7IH0gfSk7XG52YXIgVGFiU3RyaXAgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJTdHJpcCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJTdHJpcCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJTdHJpcC5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmIChpdGVtcykge1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGl0ZW0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJpdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJUYWJTdHJpcEl0ZW1cIikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmJhY2tncm91bmRDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhckJhY2tncm91bmRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyQmFja2dyb3VuZENvbG9yKHZhbHVlKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5iYWNrZ3JvdW5kSW50ZXJuYWxQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdmlld18xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuZ2V0VGFiQmFyQ29sb3IoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFyQ29sb3IodmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW3ZpZXdfMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5nZXRUYWJCYXJGb250SW50ZXJuYWwoKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt2aWV3XzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNldFRhYkJhckZvbnRJbnRlcm5hbCh2YWx1ZSk7XG4gICAgfTtcbiAgICBUYWJTdHJpcC5wcm90b3R5cGVbdGV4dF9iYXNlXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LmdldFRhYkJhclRleHRUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFRhYlN0cmlwLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS50ZXh0VHJhbnNmb3JtUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQgJiYgcGFyZW50LnNldFRhYkJhclRleHRUcmFuc2Zvcm0odmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW2V4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5nZXRUYWJCYXJIaWdobGlnaHRDb2xvcigpO1xuICAgIH07XG4gICAgVGFiU3RyaXAucHJvdG90eXBlW2V4cG9ydHMuaGlnaGxpZ2h0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IodmFsdWUpO1xuICAgIH07XG4gICAgVGFiU3RyaXAgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUYWJTdHJpcFwiKVxuICAgIF0sIFRhYlN0cmlwKTtcbiAgICByZXR1cm4gVGFiU3RyaXA7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRhYlN0cmlwID0gVGFiU3RyaXA7XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJpb3NJY29uUmVuZGVyaW5nTW9kZVwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b21hdGljXCIgfSk7XG5leHBvcnRzLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkucmVnaXN0ZXIoVGFiU3RyaXApO1xuZXhwb3J0cy5oaWdobGlnaHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKFRhYlN0cmlwKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYi1zdHJpcC5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbmV4cG9ydHMudHJhY2VDYXRlZ29yeSA9IFwiVGFiVmlld1wiO1xudmFyIFRhYlZpZXdJdGVtQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYlZpZXdJdGVtQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3SXRlbUJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fdGl0bGUgPSBcIlwiO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLCBcInRleHRUcmFuc2Zvcm1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHRUcmFuc2Zvcm07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHRUcmFuc2Zvcm0gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFiVmlld0l0ZW1CYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiB2aWV3XzEuVmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLCBcInRpdGxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGl0bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdGl0bGUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdGl0bGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUsIFwidmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdmlldyAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDaGFuZ2luZyB0aGUgdmlldyBvZiBhbiBhbHJlYWR5IGxvYWRlZCBUYWJWaWV3SXRlbSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZC5cIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRWaWV3KHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUsIFwiaWNvblNvdXJjZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ljb25Tb3VyY2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faWNvblNvdXJjZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pY29uU291cmNlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYlZpZXdJdGVtQmFzZS5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5fdmlldztcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbUJhc2UucHJvdG90eXBlLmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIHRhYlZpZXcgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHRhYlZpZXcgJiYgdGFiVmlldy5pdGVtcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuQmVMb2FkZWQpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmxvYWRWaWV3LmNhbGwodGhpcywgdmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRhYlZpZXdJdGVtXCIpXG4gICAgXSwgVGFiVmlld0l0ZW1CYXNlKTtcbiAgICByZXR1cm4gVGFiVmlld0l0ZW1CYXNlO1xufSh2aWV3XzEuVmlld0Jhc2UpKTtcbmV4cG9ydHMuVGFiVmlld0l0ZW1CYXNlID0gVGFiVmlld0l0ZW1CYXNlO1xudmFyIGtub3duQ29sbGVjdGlvbnM7XG4oZnVuY3Rpb24gKGtub3duQ29sbGVjdGlvbnMpIHtcbiAgICBrbm93bkNvbGxlY3Rpb25zLml0ZW1zID0gXCJpdGVtc1wiO1xufSkoa25vd25Db2xsZWN0aW9ucyA9IGV4cG9ydHMua25vd25Db2xsZWN0aW9ucyB8fCAoZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zID0ge30pKTtcbnZhciBUYWJWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRhYlZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYlZpZXdCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRhYlZpZXdCYXNlXzEgPSBUYWJWaWV3QmFzZTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcImFuZHJvaWRTZWxlY3RlZFRhYkhpZ2hsaWdodENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJ0YWJUZXh0Rm9udFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRhYlRleHRGb250U2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGFiVGV4dEZvbnRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwidGFiVGV4dENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50YWJUZXh0Q29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRhYlRleHRDb2xvciA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGFiVmlld0Jhc2UucHJvdG90eXBlLCBcInRhYkJhY2tncm91bmRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGFiQmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50YWJCYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJzZWxlY3RlZFRhYlRleHRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuc2VsZWN0ZWRUYWJUZXh0Q29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnNlbGVjdGVkVGFiVGV4dENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5fYWRkQXJyYXlGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJpdGVtc1wiKSB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gXCJUYWJWaWV3SXRlbVwiKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXRlbXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gbmV3IEFycmF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLml0ZW1zLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fYWRkVmlldyh2YWx1ZSk7XG4gICAgICAgICAgICBleHBvcnRzLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3QmFzZS5wcm90b3R5cGUsIFwiX3NlbGVjdGVkVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRJbmRleCA+IC0xID8gdGhpcy5pdGVtc1tzZWxlY3RlZEluZGV4XS52aWV3IDogbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYlZpZXdCYXNlLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgICAgIHJldHVybiBpdGVtcyA/IGl0ZW1zLmxlbmd0aCA6IDA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYlZpZXdCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0Jhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbS52aWV3KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUub25JdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAob2xkSXRlbXMsIG5ld0l0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmIChvbGRJdGVtcykge1xuICAgICAgICAgICAgb2xkSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZVZpZXcoaXRlbSk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdJdGVtcykge1xuICAgICAgICAgICAgbmV3SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIGlmICghaXRlbS52aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRhYlZpZXdJdGVtIG11c3QgaGF2ZSBhIHZpZXcuXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBfdGhpcy5fYWRkVmlldyhpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3QmFzZS5wcm90b3R5cGUub25TZWxlY3RlZEluZGV4Q2hhbmdlZCA9IGZ1bmN0aW9uIChvbGRJbmRleCwgbmV3SW5kZXgpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IFRhYlZpZXdCYXNlXzEuc2VsZWN0ZWRJbmRleENoYW5nZWRFdmVudCwgb2JqZWN0OiB0aGlzLCBvbGRJbmRleDogb2xkSW5kZXgsIG5ld0luZGV4OiBuZXdJbmRleCB9KTtcbiAgICB9O1xuICAgIHZhciBUYWJWaWV3QmFzZV8xO1xuICAgIFRhYlZpZXdCYXNlLnNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnQgPSBcInNlbGVjdGVkSW5kZXhDaGFuZ2VkXCI7XG4gICAgVGFiVmlld0Jhc2UgPSBUYWJWaWV3QmFzZV8xID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHZpZXdfMS5DU1NUeXBlKFwiVGFiVmlld1wiKVxuICAgIF0sIFRhYlZpZXdCYXNlKTtcbiAgICByZXR1cm4gVGFiVmlld0Jhc2U7XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRhYlZpZXdCYXNlID0gVGFiVmlld0Jhc2U7XG5mdW5jdGlvbiB0cmFjZU1pc3NpbmdJY29uKGljb24pIHtcbiAgICB2aWV3XzEudHJhY2VXcml0ZShcIkNvdWxkIG5vdCBsb2FkIHRhYiBiYXIgaWNvbjogXCIgKyBpY29uLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLkVycm9yLCB2aWV3XzEudHJhY2VNZXNzYWdlVHlwZS5lcnJvcik7XG59XG5leHBvcnRzLnRyYWNlTWlzc2luZ0ljb24gPSB0cmFjZU1pc3NpbmdJY29uO1xuZXhwb3J0cy5zZWxlY3RlZEluZGV4UHJvcGVydHkgPSBuZXcgdmlld18xLkNvZXJjaWJsZVByb3BlcnR5KHtcbiAgICBuYW1lOiBcInNlbGVjdGVkSW5kZXhcIiwgZGVmYXVsdFZhbHVlOiAtMSwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5vblNlbGVjdGVkSW5kZXhDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfSxcbiAgICBjb2VyY2VWYWx1ZTogZnVuY3Rpb24gKHRhcmdldCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGFyZ2V0Lml0ZW1zO1xuICAgICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSBpdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IG1heCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gbWF4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsdWUgPSAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMuaXRlbXNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXRlbXNcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdGFyZ2V0Lm9uSXRlbXNDaGFuZ2VkKG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgfVxufSk7XG5leHBvcnRzLml0ZW1zUHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaW9zSWNvblJlbmRlcmluZ01vZGVcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9tYXRpY1wiIH0pO1xuZXhwb3J0cy5pb3NJY29uUmVuZGVyaW5nTW9kZVByb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMuYW5kcm9pZE9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImFuZHJvaWRPZmZzY3JlZW5UYWJMaW1pdFwiLCBkZWZhdWx0VmFsdWU6IDEsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUyxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMuYW5kcm9pZE9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkucmVnaXN0ZXIoVGFiVmlld0Jhc2UpO1xuZXhwb3J0cy5hbmRyb2lkVGFic1Bvc2l0aW9uUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJhbmRyb2lkVGFic1Bvc2l0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJ0b3BcIiB9KTtcbmV4cG9ydHMuYW5kcm9pZFRhYnNQb3NpdGlvblByb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMuYW5kcm9pZFN3aXBlRW5hYmxlZFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZFN3aXBlRW5hYmxlZFwiLCBkZWZhdWx0VmFsdWU6IHRydWUsIHZhbHVlQ29udmVydGVyOiB2aWV3XzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuYW5kcm9pZFN3aXBlRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFRhYlZpZXdCYXNlKTtcbmV4cG9ydHMudGFiVGV4dEZvbnRTaXplUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ0YWJUZXh0Rm9udFNpemVcIiwgY3NzTmFtZTogXCJ0YWItdGV4dC1mb250LXNpemVcIiwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy50YWJUZXh0Q29sb3JQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRhYlRleHRDb2xvclwiLCBjc3NOYW1lOiBcInRhYi10ZXh0LWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMudGFiVGV4dENvbG9yUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMudGFiQmFja2dyb3VuZENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ0YWJCYWNrZ3JvdW5kQ29sb3JcIiwgY3NzTmFtZTogXCJ0YWItYmFja2dyb3VuZC1jb2xvclwiLCBlcXVhbGl0eUNvbXBhcmVyOiB2aWV3XzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyB2aWV3XzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnRhYkJhY2tncm91bmRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLnNlbGVjdGVkVGFiVGV4dENvbG9yUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJzZWxlY3RlZFRhYlRleHRDb2xvclwiLCBjc3NOYW1lOiBcInNlbGVjdGVkLXRhYi10ZXh0LWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHZpZXdfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IHZpZXdfMS5Db2xvcih2KTsgfSB9KTtcbmV4cG9ydHMuc2VsZWN0ZWRUYWJUZXh0Q29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZFNlbGVjdGVkVGFiSGlnaGxpZ2h0Q29sb3JcIiwgY3NzTmFtZTogXCJhbmRyb2lkLXNlbGVjdGVkLXRhYi1oaWdobGlnaHQtY29sb3JcIiwgZXF1YWxpdHlDb21wYXJlcjogdmlld18xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdmlld18xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5hbmRyb2lkU2VsZWN0ZWRUYWJIaWdobGlnaHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItdmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIHRhYl92aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGFiLXZpZXctY29tbW9uXCIpO1xudmFyIHRleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIGZyYW1lXzEgPSByZXF1aXJlKFwiLi4vZnJhbWVcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdGFiLXZpZXctY29tbW9uXCIpKTtcbnZhciBtYWpvclZlcnNpb24gPSB1dGlsc18xLmlvcy5NYWpvclZlcnNpb247XG52YXIgaXNQaG9uZSA9IHBsYXRmb3JtXzEuZGV2aWNlLmRldmljZVR5cGUgPT09IFwiUGhvbmVcIjtcbnZhciBVSVRhYkJhckNvbnRyb2xsZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlUYWJCYXJDb250cm9sbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVRhYkJhckNvbnRyb2xsZXJJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGFiQmFyQ29udHJvbGxlckltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgaGFuZGxlciA9IFVJVGFiQmFyQ29udHJvbGxlckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVUlUYWJCYXJDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld0RpZExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld0RpZExvYWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5leHRlbmRlZExheW91dEluY2x1ZGVzT3BhcXVlQmFycyA9IHRydWU7XG4gICAgfTtcbiAgICBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZpZXdfMS5pb3MudXBkYXRlQXV0b0FkanVzdFNjcm9sbEluc2V0cyh0aGlzLCBvd25lcik7XG4gICAgICAgIGlmICghb3duZXIucGFyZW50KSB7XG4gICAgICAgICAgICBvd25lci5jYWxsTG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJVGFiQmFyQ29udHJvbGxlckltcGwucHJvdG90eXBlLnZpZXdEaWREaXNhcHBlYXIgPSBmdW5jdGlvbiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyICYmICFvd25lci5wYXJlbnQgJiYgb3duZXIuaXNMb2FkZWQgJiYgIXRoaXMucHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIG93bmVyLmNhbGxVbmxvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3V2lsbFRyYW5zaXRpb25Ub1NpemVXaXRoVHJhbnNpdGlvbkNvb3JkaW5hdG9yID0gZnVuY3Rpb24gKHNpemUsIGNvb3JkaW5hdG9yKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld1dpbGxUcmFuc2l0aW9uVG9TaXplV2l0aFRyYW5zaXRpb25Db29yZGluYXRvci5jYWxsKHRoaXMsIHNpemUsIGNvb3JkaW5hdG9yKTtcbiAgICAgICAgVUlWaWV3Q29udHJvbGxlclRyYW5zaXRpb25Db29yZGluYXRvci5wcm90b3R5cGUuYW5pbWF0ZUFsb25nc2lkZVRyYW5zaXRpb25Db21wbGV0aW9uXG4gICAgICAgICAgICAuY2FsbChjb29yZGluYXRvciwgbnVsbCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gX3RoaXMuX293bmVyLmdldCgpO1xuICAgICAgICAgICAgaWYgKG93bmVyICYmIG93bmVyLml0ZW1zKSB7XG4gICAgICAgICAgICAgICAgb3duZXIuaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAodGFiSXRlbSkgeyByZXR1cm4gdGFiSXRlbS5fdXBkYXRlVGl0bGVBbmRJY29uUG9zaXRpb25zKCk7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVUlUYWJCYXJDb250cm9sbGVySW1wbC5wcm90b3R5cGUsIFwidmlld1dpbGxBcHBlYXJcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZSwgXCJ2aWV3RGlkRGlzYXBwZWFyXCIsIG51bGwpO1xuICAgIHJldHVybiBVSVRhYkJhckNvbnRyb2xsZXJJbXBsO1xufShVSVRhYkJhckNvbnRyb2xsZXIpKTtcbnZhciBVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5uZXcoKTtcbiAgICAgICAgZGVsZWdhdGUuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFiQmFyQ29udHJvbGxlclNob3VsZFNlbGVjdFZpZXdDb250cm9sbGVyID0gZnVuY3Rpb24gKHRhYkJhckNvbnRyb2xsZXIsIHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIGlmICh0YWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIlRhYlZpZXcuZGVsZWdhdGUuU0hPVUxEX3NlbGVjdChcIiArIHRhYkJhckNvbnRyb2xsZXIgKyBcIiwgXCIgKyB2aWV3Q29udHJvbGxlciArIFwiKTtcIiwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgYmFja1RvTW9yZVdpbGxCZVZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIG93bmVyLl9oYW5kbGVUd29OYXZpZ2F0aW9uQmFycyhiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhYkJhckNvbnRyb2xsZXIuc2VsZWN0ZWRWaWV3Q29udHJvbGxlciA9PT0gdmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB0YWJCYXJDb250cm9sbGVyLl93aWxsU2VsZWN0Vmlld0NvbnRyb2xsZXIgPSB2aWV3Q29udHJvbGxlcjtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRhYkJhckNvbnRyb2xsZXJEaWRTZWxlY3RWaWV3Q29udHJvbGxlciA9IGZ1bmN0aW9uICh0YWJCYXJDb250cm9sbGVyLCB2aWV3Q29udHJvbGxlcikge1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3LmRlbGVnYXRlLkRJRF9zZWxlY3QoXCIgKyB0YWJCYXJDb250cm9sbGVyICsgXCIsIFwiICsgdmlld0NvbnRyb2xsZXIgKyBcIik7XCIsIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgb3duZXIuX29uVmlld0NvbnRyb2xsZXJTaG93bih2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgdGFiQmFyQ29udHJvbGxlci5fd2lsbFNlbGVjdFZpZXdDb250cm9sbGVyID0gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlUYWJCYXJDb250cm9sbGVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSVRhYkJhckNvbnRyb2xsZXJEZWxlZ2F0ZUltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5uZXcoKTtcbiAgICAgICAgZGVsZWdhdGUuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLm5hdmlnYXRpb25Db250cm9sbGVyV2lsbFNob3dWaWV3Q29udHJvbGxlckFuaW1hdGVkID0gZnVuY3Rpb24gKG5hdmlnYXRpb25Db250cm9sbGVyLCB2aWV3Q29udHJvbGxlciwgYW5pbWF0ZWQpIHtcbiAgICAgICAgaWYgKHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiVGFiVmlldy5tb3JlTmF2aWdhdGlvbkNvbnRyb2xsZXIuV0lMTF9zaG93KFwiICsgbmF2aWdhdGlvbkNvbnRyb2xsZXIgKyBcIiwgXCIgKyB2aWV3Q29udHJvbGxlciArIFwiLCBcIiArIGFuaW1hdGVkICsgXCIpO1wiLCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSA9IG93bmVyLl9pb3Mudmlld0NvbnRyb2xsZXJzLmNvbnRhaW5zT2JqZWN0KHZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgICAgIG93bmVyLl9oYW5kbGVUd29OYXZpZ2F0aW9uQmFycyhiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLm5hdmlnYXRpb25Db250cm9sbGVyRGlkU2hvd1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQgPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRyb2xsZXIsIHZpZXdDb250cm9sbGVyLCBhbmltYXRlZCkge1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3Lm1vcmVOYXZpZ2F0aW9uQ29udHJvbGxlci5ESURfc2hvdyhcIiArIG5hdmlnYXRpb25Db250cm9sbGVyICsgXCIsIFwiICsgdmlld0NvbnRyb2xsZXIgKyBcIiwgXCIgKyBhbmltYXRlZCArIFwiKTtcIiwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgfVxuICAgICAgICBuYXZpZ2F0aW9uQ29udHJvbGxlci5uYXZpZ2F0aW9uQmFyLnRvcEl0ZW0ucmlnaHRCYXJCdXR0b25JdGVtID0gbnVsbDtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgb3duZXIuX29uVmlld0NvbnRyb2xsZXJTaG93bih2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xuZnVuY3Rpb24gdXBkYXRlVGl0bGVBbmRJY29uUG9zaXRpb25zKHRhYkl0ZW0sIHRhYkJhckl0ZW0sIGNvbnRyb2xsZXIpIHtcbiAgICBpZiAoIXRhYkl0ZW0gfHwgIXRhYkJhckl0ZW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgb3JpZW50YXRpb24gPSBjb250cm9sbGVyLmludGVyZmFjZU9yaWVudGF0aW9uO1xuICAgIHZhciBpc1BvcnRyYWl0ID0gb3JpZW50YXRpb24gIT09IDQgJiYgb3JpZW50YXRpb24gIT09IDM7XG4gICAgdmFyIGlzSWNvbkFib3ZlVGl0bGUgPSAobWFqb3JWZXJzaW9uIDwgMTEpIHx8IChpc1Bob25lICYmIGlzUG9ydHJhaXQpO1xuICAgIGlmICghdGFiSXRlbS5pY29uU291cmNlKSB7XG4gICAgICAgIGlmIChpc0ljb25BYm92ZVRpdGxlKSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLnRpdGxlUG9zaXRpb25BZGp1c3RtZW50ID0geyBob3Jpem9udGFsOiAwLCB2ZXJ0aWNhbDogLTIwIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YWJCYXJJdGVtLnRpdGxlUG9zaXRpb25BZGp1c3RtZW50ID0geyBob3Jpem9udGFsOiAwLCB2ZXJ0aWNhbDogMCB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghdGFiSXRlbS50aXRsZSkge1xuICAgICAgICBpZiAoaXNJY29uQWJvdmVUaXRsZSkge1xuICAgICAgICAgICAgdGFiQmFySXRlbS5pbWFnZUluc2V0cyA9IG5ldyBVSUVkZ2VJbnNldHMoeyB0b3A6IDYsIGxlZnQ6IDAsIGJvdHRvbTogLTYsIHJpZ2h0OiAwIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGFiQmFySXRlbS5pbWFnZUluc2V0cyA9IG5ldyBVSUVkZ2VJbnNldHMoeyB0b3A6IDAsIGxlZnQ6IDAsIGJvdHRvbTogMCwgcmlnaHQ6IDAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59XG52YXIgVGFiVmlld0l0ZW0gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJWaWV3SXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3SXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuc2V0Vmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoY29udHJvbGxlciwgbmF0aXZlVmlldykge1xuICAgICAgICB0aGlzLl9fY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyhuYXRpdmVWaWV3KTtcbiAgICB9O1xuICAgIFRhYlZpZXdJdGVtLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fX2NvbnRyb2xsZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyh1bmRlZmluZWQpO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlLmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIHRhYlZpZXcgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHRhYlZpZXcgJiYgdGFiVmlldy5pdGVtcykge1xuICAgICAgICAgICAgdmFyIGluZGV4XzEgPSB0YWJWaWV3Lml0ZW1zLmluZGV4T2YodGhpcyk7XG4gICAgICAgICAgICBpZiAoaW5kZXhfMSA9PT0gdGFiVmlldy5zZWxlY3RlZEluZGV4KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5sb2FkVmlldy5jYWxsKHRoaXMsIHZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3SXRlbS5wcm90b3R5cGUuX3VwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB2YXIgY29udHJvbGxlciA9IHRoaXMuX19jb250cm9sbGVyO1xuICAgICAgICBpZiAocGFyZW50ICYmIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBpY29uID0gcGFyZW50Ll9nZXRJY29uKHRoaXMuaWNvblNvdXJjZSk7XG4gICAgICAgICAgICB2YXIgaW5kZXhfMiA9IHBhcmVudC5pdGVtcy5pbmRleE9mKHRoaXMpO1xuICAgICAgICAgICAgdmFyIHRpdGxlID0gdGV4dF9iYXNlXzEuZ2V0VHJhbnNmb3JtZWRUZXh0KHRoaXMudGl0bGUsIHRoaXMuc3R5bGUudGV4dFRyYW5zZm9ybSk7XG4gICAgICAgICAgICB2YXIgdGFiQmFySXRlbSA9IFVJVGFiQmFySXRlbS5hbGxvYygpLmluaXRXaXRoVGl0bGVJbWFnZVRhZyh0aXRsZSwgaWNvbiwgaW5kZXhfMik7XG4gICAgICAgICAgICB1cGRhdGVUaXRsZUFuZEljb25Qb3NpdGlvbnModGhpcywgdGFiQmFySXRlbSwgY29udHJvbGxlcik7XG4gICAgICAgICAgICB2YXIgc3RhdGVzID0gZ2V0VGl0bGVBdHRyaWJ1dGVzRm9yU3RhdGVzKHBhcmVudCk7XG4gICAgICAgICAgICBhcHBseVN0YXRlc1RvSXRlbSh0YWJCYXJJdGVtLCBzdGF0ZXMpO1xuICAgICAgICAgICAgY29udHJvbGxlci50YWJCYXJJdGVtID0gdGFiQmFySXRlbTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlLl91cGRhdGVUaXRsZUFuZEljb25Qb3NpdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fX2NvbnRyb2xsZXIgfHwgIXRoaXMuX19jb250cm9sbGVyLnRhYkJhckl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVUaXRsZUFuZEljb25Qb3NpdGlvbnModGhpcywgdGhpcy5fX2NvbnRyb2xsZXIudGFiQmFySXRlbSwgdGhpcy5fX2NvbnRyb2xsZXIpO1xuICAgIH07XG4gICAgVGFiVmlld0l0ZW0ucHJvdG90eXBlW3RleHRfYmFzZV8xLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZSgpO1xuICAgIH07XG4gICAgcmV0dXJuIFRhYlZpZXdJdGVtO1xufSh0YWJfdmlld19jb21tb25fMS5UYWJWaWV3SXRlbUJhc2UpKTtcbmV4cG9ydHMuVGFiVmlld0l0ZW0gPSBUYWJWaWV3SXRlbTtcbnZhciBUYWJWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFiVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUYWJWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5faWNvbnNDYWNoZSA9IHt9O1xuICAgICAgICBfdGhpcy52aWV3Q29udHJvbGxlciA9IF90aGlzLl9pb3MgPSBVSVRhYkJhckNvbnRyb2xsZXJJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYoX3RoaXMpKTtcbiAgICAgICAgX3RoaXMubmF0aXZlVmlld1Byb3RlY3RlZCA9IF90aGlzLl9pb3MudmlldztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBUYWJWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGFiQmFyQ29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICAgICAgdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGUgPSBVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IHRoaXMuaXRlbXMgJiYgdGhpcy5pdGVtc1tzZWxlY3RlZEluZGV4XSAmJiB0aGlzLml0ZW1zW3NlbGVjdGVkSW5kZXhdLnZpZXc7XG4gICAgICAgIGlmIChzZWxlY3RlZFZpZXcgaW5zdGFuY2VvZiBmcmFtZV8xLkZyYW1lKSB7XG4gICAgICAgICAgICBzZWxlY3RlZFZpZXcuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pb3MuZGVsZWdhdGUgPSB0aGlzLl9kZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lvcy5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lvcy5tb3JlTmF2aWdhdGlvbkNvbnRyb2xsZXIuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWJWaWV3LnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhYlZpZXcucHJvdG90eXBlLmxheW91dE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5vblNlbGVjdGVkSW5kZXhDaGFuZ2VkID0gZnVuY3Rpb24gKG9sZEluZGV4LCBuZXdJbmRleCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9sZEl0ZW0gPSBpdGVtc1tvbGRJbmRleF07XG4gICAgICAgIGlmIChvbGRJdGVtKSB7XG4gICAgICAgICAgICBvbGRJdGVtLnVubG9hZFZpZXcob2xkSXRlbS52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3SXRlbSA9IGl0ZW1zW25ld0luZGV4XTtcbiAgICAgICAgaWYgKG5ld0l0ZW0gJiYgdGhpcy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkVmlldyA9IGl0ZW1zW25ld0luZGV4XS52aWV3O1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFZpZXcuX3B1c2hJbkZyYW1lU3RhY2tSZWN1cnNpdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0l0ZW0ubG9hZFZpZXcobmV3SXRlbS52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQuY2FsbCh0aGlzLCBvbGRJbmRleCwgbmV3SW5kZXgpO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IHRhYl92aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB0YWJfdmlld19jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdGFiX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gdGFiX3ZpZXdfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gdGFiX3ZpZXdfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gdGFiX3ZpZXdfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKGhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5fb25WaWV3Q29udHJvbGxlclNob3duID0gZnVuY3Rpb24gKHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIGlmICh0YWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIlRhYlZpZXcuX29uVmlld0NvbnRyb2xsZXJTaG93bihcIiArIHZpZXdDb250cm9sbGVyICsgXCIpO1wiLCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzICYmIHRoaXMuX2lvcy52aWV3Q29udHJvbGxlcnMuY29udGFpbnNPYmplY3Qodmlld0NvbnRyb2xsZXIpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzLmluZGV4T2ZPYmplY3Qodmlld0NvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIlRhYlZpZXcuX29uVmlld0NvbnRyb2xsZXJTaG93bjogdmlld0NvbnRyb2xsZXIgaXMgbm90IG9uZSBvZiBvdXIgdmlld0NvbnRyb2xsZXJzXCIsIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLl9oYW5kbGVUd29OYXZpZ2F0aW9uQmFycyA9IGZ1bmN0aW9uIChiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSkge1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3Ll9oYW5kbGVUd29OYXZpZ2F0aW9uQmFycyhiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZTogXCIgKyBiYWNrVG9Nb3JlV2lsbEJlVmlzaWJsZSArIFwiKVwiLCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYWdlID0gdGhpcy5wYWdlIHx8IHRoaXMuX3NlbGVjdGVkVmlldy5wYWdlIHx8IHRoaXMuX3NlbGVjdGVkVmlldy5jdXJyZW50UGFnZTtcbiAgICAgICAgaWYgKCFwYWdlIHx8ICFwYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFjdGlvbkJhclZpc2libGUgPSBwYWdlLmZyYW1lLl9nZXROYXZCYXJWaXNpYmxlKHBhZ2UpO1xuICAgICAgICBpZiAoYmFja1RvTW9yZVdpbGxCZVZpc2libGUgJiYgYWN0aW9uQmFyVmlzaWJsZSkge1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgcGFnZS5hY3Rpb25CYXJIaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhckhpZGRlbkJ5VGFiVmlldyA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiVGFiVmlldyBoaWQgYWN0aW9uIGJhclwiLCB0YWJfdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuRGVidWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYmFja1RvTW9yZVdpbGxCZVZpc2libGUgJiYgdGhpcy5fYWN0aW9uQmFySGlkZGVuQnlUYWJWaWV3KSB7XG4gICAgICAgICAgICBwYWdlLmZyYW1lLmlvcy5fZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9IHRydWU7XG4gICAgICAgICAgICBwYWdlLmFjdGlvbkJhckhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgcGFnZS5mcmFtZS5pb3MuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2FjdGlvbkJhckhpZGRlbkJ5VGFiVmlldyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmICh0YWJfdmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3IHJlc3RvcmVkIGFjdGlvbiBiYXJcIiwgdGFiX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGUuZ2V0Vmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICB2YXIgbmV3Q29udHJvbGxlciA9IGl0ZW0udmlldyA/IGl0ZW0udmlldy52aWV3Q29udHJvbGxlciA6IG51bGw7XG4gICAgICAgIGlmIChuZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpdGVtLnNldFZpZXdDb250cm9sbGVyKG5ld0NvbnRyb2xsZXIsIG5ld0NvbnRyb2xsZXIudmlldyk7XG4gICAgICAgICAgICByZXR1cm4gbmV3Q29udHJvbGxlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS52aWV3LmlvcyBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIG5ld0NvbnRyb2xsZXIgPSBpdGVtLnZpZXcuaW9zO1xuICAgICAgICAgICAgaXRlbS5zZXRWaWV3Q29udHJvbGxlcihuZXdDb250cm9sbGVyLCBuZXdDb250cm9sbGVyLnZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGl0ZW0udmlldy5pb3MgJiYgaXRlbS52aWV3Lmlvcy5jb250cm9sbGVyIGluc3RhbmNlb2YgVUlWaWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlciA9IGl0ZW0udmlldy5pb3MuY29udHJvbGxlcjtcbiAgICAgICAgICAgIGl0ZW0uc2V0Vmlld0NvbnRyb2xsZXIobmV3Q29udHJvbGxlciwgbmV3Q29udHJvbGxlci52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5ld0NvbnRyb2xsZXIgPSB2aWV3XzEuaW9zLlVJTGF5b3V0Vmlld0NvbnRyb2xsZXIuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZihpdGVtLnZpZXcpKTtcbiAgICAgICAgICAgIG5ld0NvbnRyb2xsZXIudmlldy5hZGRTdWJ2aWV3KGl0ZW0udmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgICAgIGl0ZW0udmlldy52aWV3Q29udHJvbGxlciA9IG5ld0NvbnRyb2xsZXI7XG4gICAgICAgICAgICBpdGVtLnNldFZpZXdDb250cm9sbGVyKG5ld0NvbnRyb2xsZXIsIGl0ZW0udmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3Q29udHJvbGxlcjtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLnNldFZpZXdDb250cm9sbGVycyA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgbGVuZ3RoID0gaXRlbXMgPyBpdGVtcy5sZW5ndGggOiAwO1xuICAgICAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29udHJvbGxlcnMgPSBOU011dGFibGVBcnJheS5hbGxvYygpLmluaXRXaXRoQ2FwYWNpdHkobGVuZ3RoKTtcbiAgICAgICAgdmFyIHN0YXRlcyA9IGdldFRpdGxlQXR0cmlidXRlc0ZvclN0YXRlcyh0aGlzKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBfdGhpcy5nZXRWaWV3Q29udHJvbGxlcihpdGVtKTtcbiAgICAgICAgICAgIHZhciBpY29uID0gX3RoaXMuX2dldEljb24oaXRlbS5pY29uU291cmNlKTtcbiAgICAgICAgICAgIHZhciB0YWJCYXJJdGVtID0gVUlUYWJCYXJJdGVtLmFsbG9jKCkuaW5pdFdpdGhUaXRsZUltYWdlVGFnKChpdGVtLnRpdGxlIHx8IFwiXCIpLCBpY29uLCBpKTtcbiAgICAgICAgICAgIHVwZGF0ZVRpdGxlQW5kSWNvblBvc2l0aW9ucyhpdGVtLCB0YWJCYXJJdGVtLCBjb250cm9sbGVyKTtcbiAgICAgICAgICAgIGFwcGx5U3RhdGVzVG9JdGVtKHRhYkJhckl0ZW0sIHN0YXRlcyk7XG4gICAgICAgICAgICBjb250cm9sbGVyLnRhYkJhckl0ZW0gPSB0YWJCYXJJdGVtO1xuICAgICAgICAgICAgY29udHJvbGxlcnMuYWRkT2JqZWN0KGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgaXRlbS5jYW5CZUxvYWRlZCA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9pb3Mudmlld0NvbnRyb2xsZXJzID0gY29udHJvbGxlcnM7XG4gICAgICAgIHRoaXMuX2lvcy5jdXN0b21pemFibGVWaWV3Q29udHJvbGxlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9pb3MubW9yZU5hdmlnYXRpb25Db250cm9sbGVyLmRlbGVnYXRlID0gdGhpcy5fbW9yZU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGU7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZS5fZ2V0SWNvblJlbmRlcmluZ01vZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5pb3NJY29uUmVuZGVyaW5nTW9kZSkge1xuICAgICAgICAgICAgY2FzZSBcImFsd2F5c09yaWdpbmFsXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIFwiYWx3YXlzVGVtcGxhdGVcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgICAgIGNhc2UgXCJhdXRvbWF0aWNcIjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLl9nZXRJY29uID0gZnVuY3Rpb24gKGljb25Tb3VyY2UpIHtcbiAgICAgICAgaWYgKCFpY29uU291cmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLl9pY29uc0NhY2hlW2ljb25Tb3VyY2VdO1xuICAgICAgICBpZiAoIWltYWdlKSB7XG4gICAgICAgICAgICB2YXIgaXMgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRmlsZU9yUmVzb3VyY2UoaWNvblNvdXJjZSk7XG4gICAgICAgICAgICBpZiAoaXMgJiYgaXMuaW9zKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsUmVuZGVyZWRJbWFnZSA9IGlzLmlvcy5pbWFnZVdpdGhSZW5kZXJpbmdNb2RlKHRoaXMuX2dldEljb25SZW5kZXJpbmdNb2RlKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ljb25zQ2FjaGVbaWNvblNvdXJjZV0gPSBvcmlnaW5hbFJlbmRlcmVkSW1hZ2U7XG4gICAgICAgICAgICAgICAgaW1hZ2UgPSBvcmlnaW5hbFJlbmRlcmVkSW1hZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YWJfdmlld19jb21tb25fMS50cmFjZU1pc3NpbmdJY29uKGljb25Tb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbWFnZTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlLl91cGRhdGVJT1NUYWJCYXJDb2xvcnNBbmRGb250cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYkJhciA9IHRoaXMuaW9zLnRhYkJhcjtcbiAgICAgICAgdmFyIHN0YXRlcyA9IGdldFRpdGxlQXR0cmlidXRlc0ZvclN0YXRlcyh0aGlzKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJCYXIuaXRlbXMuY291bnQ7IGkrKykge1xuICAgICAgICAgICAgYXBwbHlTdGF0ZXNUb0l0ZW0odGFiQmFyLml0ZW1zW2ldLCBzdGF0ZXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5zZWxlY3RlZEluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGFiX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJUYWJWaWV3Ll9vblNlbGVjdGVkSW5kZXhQcm9wZXJ0eUNoYW5nZWRTZXROYXRpdmVWYWx1ZShcIiArIHZhbHVlICsgXCIpXCIsIHRhYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5fd2lsbFNlbGVjdFZpZXdDb250cm9sbGVyID0gdGhpcy5faW9zLnZpZXdDb250cm9sbGVyc1t2YWx1ZV07XG4gICAgICAgICAgICB0aGlzLl9pb3Muc2VsZWN0ZWRJbmRleCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLml0ZW1zUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNldFZpZXdDb250cm9sbGVycyh2YWx1ZSk7XG4gICAgICAgIHRhYl92aWV3X2NvbW1vbl8xLnNlbGVjdGVkSW5kZXhQcm9wZXJ0eS5jb2VyY2UodGhpcyk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Rm9udFNpemVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUlPU1RhYkJhckNvbG9yc0FuZEZvbnRzKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Q29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJUZXh0Q29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUlPU1RhYkJhckNvbG9yc0FuZEZvbnRzKCk7XG4gICAgfTtcbiAgICBUYWJWaWV3LnByb3RvdHlwZVt0YWJfdmlld19jb21tb25fMS50YWJCYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lvcy50YWJCYXIuYmFyVGludENvbG9yO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEudGFiQmFja2dyb3VuZENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pb3MudGFiQmFyLmJhclRpbnRDb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLnNlbGVjdGVkVGFiVGV4dENvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pb3MudGFiQmFyLnRpbnRDb2xvcjtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLnNlbGVjdGVkVGFiVGV4dENvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9pb3MudGFiQmFyLnRpbnRDb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5fdXBkYXRlSU9TVGFiQmFyQ29sb3JzQW5kRm9udHMoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmZvbnRJbnRlcm5hbFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmZvbnRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlSU9TVGFiQmFyQ29sb3JzQW5kRm9udHMoKTtcbiAgICB9O1xuICAgIFRhYlZpZXcucHJvdG90eXBlW3RhYl92aWV3X2NvbW1vbl8xLmlvc0ljb25SZW5kZXJpbmdNb2RlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcImF1dG9tYXRpY1wiO1xuICAgIH07XG4gICAgVGFiVmlldy5wcm90b3R5cGVbdGFiX3ZpZXdfY29tbW9uXzEuaW9zSWNvblJlbmRlcmluZ01vZGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2ljb25zQ2FjaGUgPSB7fTtcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKGl0ZW1zICYmIGl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gaXRlbXMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaV07XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0uaWNvblNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLl91cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVGFiVmlldy5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFRhYlZpZXc7XG59KHRhYl92aWV3X2NvbW1vbl8xLlRhYlZpZXdCYXNlKSk7XG5leHBvcnRzLlRhYlZpZXcgPSBUYWJWaWV3O1xuZnVuY3Rpb24gZ2V0VGl0bGVBdHRyaWJ1dGVzRm9yU3RhdGVzKHRhYlZpZXcpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIgZGVmYXVsdFRhYkl0ZW1Gb250U2l6ZSA9IDEwO1xuICAgIHZhciB0YWJJdGVtRm9udFNpemUgPSB0YWJWaWV3LnN0eWxlLnRhYlRleHRGb250U2l6ZSB8fCBkZWZhdWx0VGFiSXRlbUZvbnRTaXplO1xuICAgIHZhciBmb250ID0gdGFiVmlldy5zdHlsZS5mb250SW50ZXJuYWwuZ2V0VUlGb250KFVJRm9udC5zeXN0ZW1Gb250T2ZTaXplKHRhYkl0ZW1Gb250U2l6ZSkpO1xuICAgIHZhciB0YWJJdGVtVGV4dENvbG9yID0gdGFiVmlldy5zdHlsZS50YWJUZXh0Q29sb3I7XG4gICAgdmFyIHRleHRDb2xvciA9IHRhYkl0ZW1UZXh0Q29sb3IgaW5zdGFuY2VvZiB0YWJfdmlld19jb21tb25fMS5Db2xvciA/IHRhYkl0ZW1UZXh0Q29sb3IuaW9zIDogbnVsbDtcbiAgICByZXN1bHQubm9ybWFsU3RhdGUgPSAoX2EgPSB7fSwgX2FbTlNGb250QXR0cmlidXRlTmFtZV0gPSBmb250LCBfYSk7XG4gICAgaWYgKHRleHRDb2xvcikge1xuICAgICAgICByZXN1bHQubm9ybWFsU3RhdGVbVUlUZXh0QXR0cmlidXRlVGV4dENvbG9yXSA9IHRleHRDb2xvcjtcbiAgICB9XG4gICAgdmFyIHRhYlNlbGVjdGVkSXRlbVRleHRDb2xvciA9IHRhYlZpZXcuc3R5bGUuc2VsZWN0ZWRUYWJUZXh0Q29sb3I7XG4gICAgdmFyIHNlbGVjdGVkVGV4dENvbG9yID0gdGFiU2VsZWN0ZWRJdGVtVGV4dENvbG9yIGluc3RhbmNlb2YgdGFiX3ZpZXdfY29tbW9uXzEuQ29sb3IgPyB0YWJTZWxlY3RlZEl0ZW1UZXh0Q29sb3IuaW9zIDogbnVsbDtcbiAgICByZXN1bHQuc2VsZWN0ZWRTdGF0ZSA9IChfYiA9IHt9LCBfYltOU0ZvbnRBdHRyaWJ1dGVOYW1lXSA9IGZvbnQsIF9iKTtcbiAgICBpZiAoc2VsZWN0ZWRUZXh0Q29sb3IpIHtcbiAgICAgICAgcmVzdWx0LnNlbGVjdGVkU3RhdGVbVUlUZXh0QXR0cmlidXRlVGV4dENvbG9yXSA9IHNlbGVjdGVkVGV4dENvbG9yO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gYXBwbHlTdGF0ZXNUb0l0ZW0oaXRlbSwgc3RhdGVzKSB7XG4gICAgaXRlbS5zZXRUaXRsZVRleHRBdHRyaWJ1dGVzRm9yU3RhdGUoc3RhdGVzLm5vcm1hbFN0YXRlLCAwKTtcbiAgICBpdGVtLnNldFRpdGxlVGV4dEF0dHJpYnV0ZXNGb3JTdGF0ZShzdGF0ZXMuc2VsZWN0ZWRTdGF0ZSwgNCk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWItdmlldy5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0YWJfbmF2aWdhdGlvbl9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItbmF2aWdhdGlvbi1iYXNlXCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW1cIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKSk7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXBcIikpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLXN0cmlwLWl0ZW1cIikpO1xuZXhwb3J0cy50cmFjZUNhdGVnb3J5ID0gXCJUYWJWaWV3XCI7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuaXRlbXMgPSBcIml0ZW1zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIFRhYnNCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFic0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFic0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFic0Jhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgdmlld18xLkNTU1R5cGUoXCJUYWJzXCIpXG4gICAgXSwgVGFic0Jhc2UpO1xuICAgIHJldHVybiBUYWJzQmFzZTtcbn0odGFiX25hdmlnYXRpb25fYmFzZV8xLlRhYk5hdmlnYXRpb25CYXNlKSk7XG5leHBvcnRzLlRhYnNCYXNlID0gVGFic0Jhc2U7XG5leHBvcnRzLnN3aXBlRW5hYmxlZFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJzd2lwZUVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld18xLmJvb2xlYW5Db252ZXJ0ZXJcbn0pO1xuZXhwb3J0cy5zd2lwZUVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihUYWJzQmFzZSk7XG5leHBvcnRzLm9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm9mZnNjcmVlblRhYkxpbWl0XCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm9mZnNjcmVlblRhYkxpbWl0UHJvcGVydHkucmVnaXN0ZXIoVGFic0Jhc2UpO1xuZXhwb3J0cy50YWJzUG9zaXRpb25Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuUHJvcGVydHkoeyBuYW1lOiBcInRhYnNQb3NpdGlvblwiLCBkZWZhdWx0VmFsdWU6IFwidG9wXCIgfSk7XG5leHBvcnRzLnRhYnNQb3NpdGlvblByb3BlcnR5LnJlZ2lzdGVyKFRhYnNCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRhYnMtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGFiX25hdmlnYXRpb25fYmFzZV8xID0gcmVxdWlyZShcIi4uL3RhYi1uYXZpZ2F0aW9uLWJhc2UvdGFiLW5hdmlnYXRpb24tYmFzZVwiKTtcbnZhciB0YWJzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGFicy1jb21tb25cIik7XG52YXIgZnJhbWVfMSA9IHJlcXVpcmUoXCIuLi9mcmFtZVwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBpbWFnZV9zb3VyY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi9pbWFnZS1zb3VyY2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90YWJzLWNvbW1vblwiKSk7XG52YXIgTURDVGFiQmFyRGVsZWdhdGVJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoTURDVGFiQmFyRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE1EQ1RhYkJhckRlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBNRENUYWJCYXJEZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgZGVsZWdhdGUgPSBNRENUYWJCYXJEZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGU7XG4gICAgfTtcbiAgICBNRENUYWJCYXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRhYkJhclNob3VsZFNlbGVjdEl0ZW0gPSBmdW5jdGlvbiAodGFiQmFyLCBpdGVtKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICB2YXIgc2hvdWxkU2VsZWN0SXRlbSA9IG93bmVyLl9jYW5TZWxlY3RJdGVtO1xuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IG93bmVyLnRhYkJhckl0ZW1zLmluZGV4T2YoaXRlbSk7XG4gICAgICAgIGlmIChvd25lci5zZWxlY3RlZEluZGV4ICE9PSBzZWxlY3RlZEluZGV4KSB7XG4gICAgICAgICAgICBvd25lci5fY2FuU2VsZWN0SXRlbSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaG91bGRTZWxlY3RJdGVtO1xuICAgIH07XG4gICAgTURDVGFiQmFyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS50YWJCYXJXaWxsU2VsZWN0SXRlbSA9IGZ1bmN0aW9uICh0YWJCYXIsIGl0ZW0pIHtcbiAgICB9O1xuICAgIE1EQ1RhYkJhckRlbGVnYXRlSW1wbC5wcm90b3R5cGUudGFiQmFyRGlkU2VsZWN0SXRlbSA9IGZ1bmN0aW9uICh0YWJCYXIsIHNlbGVjdGVkSXRlbSkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgdmFyIHRhYkJhckl0ZW1zID0gb3duZXIudGFiQmFySXRlbXM7XG4gICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGFiQmFySXRlbXMuaW5kZXhPZihzZWxlY3RlZEl0ZW0pO1xuICAgICAgICBvd25lci5zZWxlY3RlZEluZGV4ID0gc2VsZWN0ZWRJbmRleDtcbiAgICB9O1xuICAgIE1EQ1RhYkJhckRlbGVnYXRlSW1wbC5PYmpDUHJvdG9jb2xzID0gW01EQ1RhYkJhckRlbGVnYXRlXTtcbiAgICByZXR1cm4gTURDVGFiQmFyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFVJUGFnZVZpZXdDb250cm9sbGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJUGFnZVZpZXdDb250cm9sbGVySW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVBhZ2VWaWV3Q29udHJvbGxlckltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBVSVBhZ2VWaWV3Q29udHJvbGxlckltcGwuYWxsb2MoKS5pbml0V2l0aFRyYW5zaXRpb25TdHlsZU5hdmlnYXRpb25PcmllbnRhdGlvbk9wdGlvbnMoMSwgMCwgbnVsbCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3RGlkTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIHZhciB0YWJCYXJJdGVtcyA9IG93bmVyLnRhYkJhckl0ZW1zO1xuICAgICAgICB2YXIgdGFiQmFyID0gTURDVGFiQmFyLmFsbG9jKCkuaW5pdFdpdGhGcmFtZSh0aGlzLnZpZXcuYm91bmRzKTtcbiAgICAgICAgaWYgKHRhYkJhckl0ZW1zICYmIHRhYkJhckl0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgdGFiQmFyLml0ZW1zID0gTlNBcnJheS5hcnJheVdpdGhBcnJheSh0YWJCYXJJdGVtcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGFiQmFyLmRlbGVnYXRlID0gdGhpcy50YWJCYXJEZWxlZ2F0ZSA9IE1EQ1RhYkJhckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKG93bmVyKSk7XG4gICAgICAgIHRhYkJhci50aW50Q29sb3IgPSBVSUNvbG9yLmJsdWVDb2xvcjtcbiAgICAgICAgdGFiQmFyLmJhclRpbnRDb2xvciA9IFVJQ29sb3Iud2hpdGVDb2xvcjtcbiAgICAgICAgdGFiQmFyLnNldFRpdGxlQ29sb3JGb3JTdGF0ZShVSUNvbG9yLmJsYWNrQ29sb3IsIDApO1xuICAgICAgICB0YWJCYXIuc2V0VGl0bGVDb2xvckZvclN0YXRlKFVJQ29sb3IuYmxhY2tDb2xvciwgMSk7XG4gICAgICAgIHRhYkJhci5hdXRvcmVzaXppbmdNYXNrID0gMiB8IDMyO1xuICAgICAgICB0YWJCYXIuYWxpZ25tZW50ID0gMDtcbiAgICAgICAgdGFiQmFyLnNpemVUb0ZpdCgpO1xuICAgICAgICB0aGlzLnRhYkJhciA9IHRhYkJhcjtcbiAgICAgICAgdGhpcy52aWV3LmFkZFN1YnZpZXcodGFiQmFyKTtcbiAgICB9O1xuICAgIFVJUGFnZVZpZXdDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld1dpbGxBcHBlYXIgPSBmdW5jdGlvbiAoYW5pbWF0ZWQpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW93bmVyLmlzTG9hZGVkKSB7XG4gICAgICAgICAgICBvd25lci5jYWxsTG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJUGFnZVZpZXdDb250cm9sbGVySW1wbC5wcm90b3R5cGUudmlld0RpZExheW91dFN1YnZpZXdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWRMYXlvdXRTdWJ2aWV3cy5jYWxsKHRoaXMpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgdmFyIHRhYnNQb3NpdGlvbiA9IG93bmVyLnRhYnNQb3NpdGlvbjtcbiAgICAgICAgdmFyIHRhYkJhclRvcCA9IHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy50b3A7XG4gICAgICAgIHZhciB0YWJCYXJIZWlnaHQgPSB0aGlzLnRhYkJhci5mcmFtZS5zaXplLmhlaWdodDtcbiAgICAgICAgdmFyIHNjcm9sbFZpZXdUb3AgPSB0aGlzLnRhYkJhci5mcmFtZS5zaXplLmhlaWdodDtcbiAgICAgICAgdmFyIHNjcm9sbFZpZXdIZWlnaHQgPSB0aGlzLnZpZXcuYm91bmRzLnNpemUuaGVpZ2h0IC0gdGhpcy50YWJCYXIuZnJhbWUuc2l6ZS5oZWlnaHQgKyB0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMuYm90dG9tO1xuICAgICAgICBpZiAodGFic1Bvc2l0aW9uID09PSBcImJvdHRvbVwiKSB7XG4gICAgICAgICAgICB0YWJCYXJUb3AgPSB0aGlzLnZpZXcuZnJhbWUuc2l6ZS5oZWlnaHQgLSB0aGlzLnRhYkJhci5mcmFtZS5zaXplLmhlaWdodCAtIHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy5ib3R0b207XG4gICAgICAgICAgICBzY3JvbGxWaWV3VG9wID0gdGhpcy52aWV3LmZyYW1lLm9yaWdpbi55O1xuICAgICAgICAgICAgc2Nyb2xsVmlld0hlaWdodCA9IHRoaXMudmlldy5mcmFtZS5zaXplLmhlaWdodCAtIHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy5ib3R0b207XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YWJCYXIuZnJhbWUgPSBDR1JlY3RNYWtlKHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy5sZWZ0LCB0YWJCYXJUb3AsIHRoaXMudGFiQmFyLmZyYW1lLnNpemUud2lkdGgsIHRhYkJhckhlaWdodCk7XG4gICAgICAgIHZhciBzdWJWaWV3cyA9IHRoaXMudmlldy5zdWJ2aWV3cztcbiAgICAgICAgdmFyIHNjcm9sbFZpZXcgPSBudWxsO1xuICAgICAgICB2YXIgbWRjQmFyID0gbnVsbDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJWaWV3cy5jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHN1YlZpZXdzW2ldO1xuICAgICAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBVSVNjcm9sbFZpZXcpIHtcbiAgICAgICAgICAgICAgICBzY3JvbGxWaWV3ID0gdmlldztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2aWV3IGluc3RhbmNlb2YgTURDVGFiQmFyKSB7XG4gICAgICAgICAgICAgICAgbWRjQmFyID0gdmlldztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2Nyb2xsVmlldykge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxWaWV3ID0gc2Nyb2xsVmlldztcbiAgICAgICAgICAgIGlmICghb3duZXIuc3dpcGVFbmFibGVkKSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVmlldy5zY3JvbGxFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY3JvbGxWaWV3LmZyYW1lID0gQ0dSZWN0TWFrZSh0aGlzLnZpZXcuc2FmZUFyZWFJbnNldHMubGVmdCwgc2Nyb2xsVmlld1RvcCwgdGhpcy52aWV3LmJvdW5kcy5zaXplLndpZHRoLCBzY3JvbGxWaWV3SGVpZ2h0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFVJUGFnZVZpZXdDb250cm9sbGVySW1wbDtcbn0oVUlQYWdlVmlld0NvbnRyb2xsZXIpKTtcbnZhciBVSVBhZ2VWaWV3Q29udHJvbGxlckRhdGFTb3VyY2VJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlQYWdlVmlld0NvbnRyb2xsZXJEYXRhU291cmNlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVBhZ2VWaWV3Q29udHJvbGxlckRhdGFTb3VyY2VJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJUGFnZVZpZXdDb250cm9sbGVyRGF0YVNvdXJjZUltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IFVJUGFnZVZpZXdDb250cm9sbGVyRGF0YVNvdXJjZUltcGwubmV3KCk7XG4gICAgICAgIGRhdGFTb3VyY2UuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBkYXRhU291cmNlO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJEYXRhU291cmNlSW1wbC5wcm90b3R5cGUucGFnZVZpZXdDb250cm9sbGVyVmlld0NvbnRyb2xsZXJCZWZvcmVWaWV3Q29udHJvbGxlciA9IGZ1bmN0aW9uIChwYWdlVmlld0NvbnRyb2xsZXIsIHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IG93bmVyLnNlbGVjdGVkSW5kZXg7XG4gICAgICAgIGlmIChzZWxlY3RlZEluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBzZWxlY3RlZEluZGV4LS07XG4gICAgICAgIHZhciBwcmV2SXRlbSA9IG93bmVyLml0ZW1zW3NlbGVjdGVkSW5kZXhdO1xuICAgICAgICB2YXIgcHJldlZpZXdDb250cm9sbGVyID0gcHJldkl0ZW0uX19jb250cm9sbGVyO1xuICAgICAgICBwcmV2SXRlbS5jYW5CZUxvYWRlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBwcmV2Vmlld0NvbnRyb2xsZXI7XG4gICAgfTtcbiAgICBVSVBhZ2VWaWV3Q29udHJvbGxlckRhdGFTb3VyY2VJbXBsLnByb3RvdHlwZS5wYWdlVmlld0NvbnRyb2xsZXJWaWV3Q29udHJvbGxlckFmdGVyVmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAocGFnZVZpZXdDb250cm9sbGVyLCB2aWV3Q29udHJvbGxlcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgdmFyIHNlbGVjdGVkSW5kZXggPSBvd25lci5zZWxlY3RlZEluZGV4O1xuICAgICAgICBpZiAoc2VsZWN0ZWRJbmRleCA9PT0gb3duZXIuaXRlbXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0ZWRJbmRleCsrO1xuICAgICAgICB2YXIgbmV4dEl0ZW0gPSBvd25lci5pdGVtc1tzZWxlY3RlZEluZGV4XTtcbiAgICAgICAgdmFyIG5leHRWaWV3Q29udHJvbGxlciA9IG5leHRJdGVtLl9fY29udHJvbGxlcjtcbiAgICAgICAgbmV4dEl0ZW0uY2FuQmVMb2FkZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gbmV4dFZpZXdDb250cm9sbGVyO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJEYXRhU291cmNlSW1wbC5wcm90b3R5cGUucHJlc2VudGF0aW9uQ291bnRGb3JQYWdlVmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAocGFnZVZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJEYXRhU291cmNlSW1wbC5wcm90b3R5cGUucHJlc2VudGF0aW9uSW5kZXhGb3JQYWdlVmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAocGFnZVZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJEYXRhU291cmNlSW1wbC5PYmpDUHJvdG9jb2xzID0gW1VJUGFnZVZpZXdDb250cm9sbGVyRGF0YVNvdXJjZV07XG4gICAgcmV0dXJuIFVJUGFnZVZpZXdDb250cm9sbGVyRGF0YVNvdXJjZUltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgVUlQYWdlVmlld0NvbnRyb2xsZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVBhZ2VWaWV3Q29udHJvbGxlckRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVBhZ2VWaWV3Q29udHJvbGxlckRlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSVBhZ2VWaWV3Q29udHJvbGxlckRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFVJUGFnZVZpZXdDb250cm9sbGVyRGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBkZWxlZ2F0ZS5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlO1xuICAgIH07XG4gICAgVUlQYWdlVmlld0NvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnBhZ2VWaWV3Q29udHJvbGxlcldpbGxUcmFuc2l0aW9uVG9WaWV3Q29udHJvbGxlcnMgPSBmdW5jdGlvbiAocGFnZVZpZXdDb250cm9sbGVyLCB2aWV3Q29udHJvbGxlcnMpIHtcbiAgICB9O1xuICAgIFVJUGFnZVZpZXdDb250cm9sbGVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5wYWdlVmlld0NvbnRyb2xsZXJEaWRGaW5pc2hBbmltYXRpbmdQcmV2aW91c1ZpZXdDb250cm9sbGVyc1RyYW5zaXRpb25Db21wbGV0ZWQgPSBmdW5jdGlvbiAocGFnZVZpZXdDb250cm9sbGVyLCBkaWRGaW5pc2hBbmltYXRpbmcsIHByZXZpb3VzVmlld0NvbnRyb2xsZXJzLCB0cmFuc2l0aW9uQ29tcGxldGVkKSB7XG4gICAgICAgIGlmICghdHJhbnNpdGlvbkNvbXBsZXRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICB2YXIgb3duZXJWaWV3Q29udHJvbGxlcnMgPSBvd25lci52aWV3Q29udHJvbGxlcnM7XG4gICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gb3duZXIuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgdmFyIG5leHRWaWV3Q29udHJvbGxlciA9IHBhZ2VWaWV3Q29udHJvbGxlci52aWV3Q29udHJvbGxlcnNbMF07XG4gICAgICAgIHZhciBuZXh0Vmlld0NvbnRyb2xsZXJJbmRleCA9IG93bmVyVmlld0NvbnRyb2xsZXJzLmluZGV4T2YobmV4dFZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkSW5kZXggIT09IG5leHRWaWV3Q29udHJvbGxlckluZGV4KSB7XG4gICAgICAgICAgICBvd25lci5zZWxlY3RlZEluZGV4ID0gbmV4dFZpZXdDb250cm9sbGVySW5kZXg7XG4gICAgICAgICAgICBvd25lci5fY2FuU2VsZWN0SXRlbSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJUGFnZVZpZXdDb250cm9sbGVyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlQYWdlVmlld0NvbnRyb2xsZXJEZWxlZ2F0ZV07XG4gICAgcmV0dXJuIFVJUGFnZVZpZXdDb250cm9sbGVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xuZnVuY3Rpb24gaXRlcmF0ZUluZGV4UmFuZ2UoaW5kZXgsIGVwcywgbGFzdEluZGV4LCBjYWxsYmFjaykge1xuICAgIHZhciByYW5nZVN0YXJ0ID0gTWF0aC5tYXgoMCwgaW5kZXggLSBlcHMpO1xuICAgIHZhciByYW5nZUVuZCA9IE1hdGgubWluKGluZGV4ICsgZXBzLCBsYXN0SW5kZXgpO1xuICAgIGZvciAodmFyIGkgPSByYW5nZVN0YXJ0OyBpIDw9IHJhbmdlRW5kOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2soaSk7XG4gICAgfVxufVxudmFyIFRhYnMgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUYWJzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhYnMoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9pY29uc0NhY2hlID0ge307XG4gICAgICAgIF90aGlzLnZpZXdDb250cm9sbGVyID0gX3RoaXMuX2lvcyA9IFVJUGFnZVZpZXdDb250cm9sbGVySW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKF90aGlzKSk7XG4gICAgICAgIF90aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgPSBfdGhpcy5faW9zLnZpZXc7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgVGFicy5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IFVJUGFnZVZpZXdDb250cm9sbGVyRGF0YVNvdXJjZUltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gVUlQYWdlVmlld0NvbnRyb2xsZXJEZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW9zLnRhYkJhckRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW9zLnRhYkJhciA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuICAgICAgICB2YXIgc2VsZWN0ZWRWaWV3ID0gdGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zW3NlbGVjdGVkSW5kZXhdICYmIHRoaXMuaXRlbXNbc2VsZWN0ZWRJbmRleF0udmlldztcbiAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkVmlldy5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lvcy5kYXRhU291cmNlID0gdGhpcy5fZGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5faW9zLmRlbGVnYXRlID0gdGhpcy5fZGVsZWdhdGU7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9pb3MuZGF0YVNvdXJjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lvcy5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25VbmxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRhYnMucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lvcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGFicy5wcm90b3R5cGUubGF5b3V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLl9zZXROYXRpdmVWaWV3RnJhbWUgPSBmdW5jdGlvbiAobmF0aXZlVmlldywgZnJhbWUpIHtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQgPSBmdW5jdGlvbiAob2xkSW5kZXgsIG5ld0luZGV4KSB7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XG4gICAgICAgIGlmICghaXRlbXMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sb2FkVW5sb2FkVGFiSXRlbXMobmV3SW5kZXgpO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uU2VsZWN0ZWRJbmRleENoYW5nZWQuY2FsbCh0aGlzLCBvbGRJbmRleCwgbmV3SW5kZXgpO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuX2xvYWRVbmxvYWRUYWJJdGVtcyA9IGZ1bmN0aW9uIChuZXdJbmRleCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICB2YXIgbGFzdEluZGV4ID0gdGhpcy5pdGVtcy5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgb2Zmc2lkZUl0ZW1zID0gdGhpcy5vZmZzY3JlZW5UYWJMaW1pdDtcbiAgICAgICAgdmFyIHRvVW5sb2FkID0gW107XG4gICAgICAgIHZhciB0b0xvYWQgPSBbXTtcbiAgICAgICAgaXRlcmF0ZUluZGV4UmFuZ2UobmV3SW5kZXgsIG9mZnNpZGVJdGVtcywgbGFzdEluZGV4LCBmdW5jdGlvbiAoaSkgeyByZXR1cm4gdG9Mb2FkLnB1c2goaSk7IH0pO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhPZkkgPSB0b0xvYWQuaW5kZXhPZihpKTtcbiAgICAgICAgICAgIGlmIChpbmRleE9mSSA8IDApIHtcbiAgICAgICAgICAgICAgICB0b1VubG9hZC5wdXNoKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdG9VbmxvYWQuZm9yRWFjaChmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGl0ZW1zW2luZGV4XSkge1xuICAgICAgICAgICAgICAgIGl0ZW0udW5sb2FkVmlldyhpdGVtLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG5ld0l0ZW0gPSBpdGVtc1tuZXdJbmRleF07XG4gICAgICAgIHZhciBzZWxlY3RlZFZpZXcgPSBuZXdJdGVtICYmIG5ld0l0ZW0udmlldztcbiAgICAgICAgaWYgKHNlbGVjdGVkVmlldyBpbnN0YW5jZW9mIGZyYW1lXzEuRnJhbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkVmlldy5fcHVzaEluRnJhbWVTdGFja1JlY3Vyc2l2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRvTG9hZC5mb3JFYWNoKGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoX3RoaXMuaXNMb2FkZWQgJiYgaXRlbXNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5jYW5CZUxvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaXRlbS5sb2FkVmlldyhpdGVtLnZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLm9uTWVhc3VyZSA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgd2lkdGggPSB1dGlsc18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB1dGlsc18xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSB1dGlsc18xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHV0aWxzXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gdmlld18xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZSh3aWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IHZpZXdfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUoaGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLl9vblZpZXdDb250cm9sbGVyU2hvd24gPSBmdW5jdGlvbiAodmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lvcy52aWV3Q29udHJvbGxlcnMgJiYgdGhpcy5faW9zLnZpZXdDb250cm9sbGVycy5jb250YWluc09iamVjdCh2aWV3Q29udHJvbGxlcikpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuX2lvcy52aWV3Q29udHJvbGxlcnMuaW5kZXhPZk9iamVjdCh2aWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmdldFZpZXdDb250cm9sbGVyID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIG5ld0NvbnRyb2xsZXIgPSBpdGVtLnZpZXcgPyBpdGVtLnZpZXcudmlld0NvbnRyb2xsZXIgOiBudWxsO1xuICAgICAgICBpZiAobmV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgaXRlbS5zZXRWaWV3Q29udHJvbGxlcihuZXdDb250cm9sbGVyLCBuZXdDb250cm9sbGVyLnZpZXcpO1xuICAgICAgICAgICAgcmV0dXJuIG5ld0NvbnRyb2xsZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGl0ZW0udmlldy5pb3MgaW5zdGFuY2VvZiBVSVZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVyID0gaXRlbS52aWV3LmlvcztcbiAgICAgICAgICAgIGl0ZW0uc2V0Vmlld0NvbnRyb2xsZXIobmV3Q29udHJvbGxlciwgbmV3Q29udHJvbGxlci52aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpdGVtLnZpZXcuaW9zICYmIGl0ZW0udmlldy5pb3MuY29udHJvbGxlciBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIG5ld0NvbnRyb2xsZXIgPSBpdGVtLnZpZXcuaW9zLmNvbnRyb2xsZXI7XG4gICAgICAgICAgICBpdGVtLnNldFZpZXdDb250cm9sbGVyKG5ld0NvbnRyb2xsZXIsIG5ld0NvbnRyb2xsZXIudmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVyID0gdmlld18xLmlvcy5VSUxheW91dFZpZXdDb250cm9sbGVyLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYoaXRlbS52aWV3KSk7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVyLnZpZXcuYWRkU3VidmlldyhpdGVtLnZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgICAgICAgICBpdGVtLnZpZXcudmlld0NvbnRyb2xsZXIgPSBuZXdDb250cm9sbGVyO1xuICAgICAgICAgICAgaXRlbS5zZXRWaWV3Q29udHJvbGxlcihuZXdDb250cm9sbGVyLCBpdGVtLnZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ld0NvbnRyb2xsZXI7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRWaWV3Q29udHJvbGxlcnMgPSBmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGxlbmd0aCA9IGl0ZW1zID8gaXRlbXMubGVuZ3RoIDogMDtcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlcnMgPSBbXTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBfdGhpcy5nZXRWaWV3Q29udHJvbGxlcihpdGVtKTtcbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVycy5wdXNoKGNvbnRyb2xsZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlcnMgPSB2aWV3Q29udHJvbGxlcnM7XG4gICAgICAgIGl0ZXJhdGVJbmRleFJhbmdlKHRoaXMuc2VsZWN0ZWRJbmRleCwgMSwgdGhpcy5pdGVtcy5sZW5ndGgsIGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgaXRlbXNbaW5kZXhdLmNhbkJlTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJTdHJpcEl0ZW1zID0gZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB0YWJCYXJJdGVtcyA9IFtdO1xuICAgICAgICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG4gICAgICAgICAgICBpdGVtLmluZGV4ID0gaTtcbiAgICAgICAgICAgIHZhciB0YWJCYXJJdGVtID0gX3RoaXMuY3JlYXRlVGFiQmFySXRlbShpdGVtLCBpKTtcbiAgICAgICAgICAgIHRhYkJhckl0ZW1zLnB1c2godGFiQmFySXRlbSk7XG4gICAgICAgICAgICBpdGVtLnNldE5hdGl2ZVZpZXcodGFiQmFySXRlbSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnRhYkJhckl0ZW1zID0gdGFiQmFySXRlbXM7XG4gICAgICAgIGlmICh0aGlzLnZpZXdDb250cm9sbGVyICYmIHRoaXMudmlld0NvbnRyb2xsZXIudGFiQmFyKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdDb250cm9sbGVyLnRhYkJhci5pdGVtQXBwZWFyYW5jZSA9IHRoaXMuX2dldFRhYkJhckl0ZW1BcHBlYXJhbmNlKCk7XG4gICAgICAgICAgICB0aGlzLnZpZXdDb250cm9sbGVyLnRhYkJhci5pdGVtcyA9IE5TQXJyYXkuYXJyYXlXaXRoQXJyYXkodGFiQmFySXRlbXMpO1xuICAgICAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlci50YWJCYXIuc2l6ZVRvRml0KCk7XG4gICAgICAgICAgICB0aGlzLnRhYlN0cmlwLnNldE5hdGl2ZVZpZXcodGhpcy52aWV3Q29udHJvbGxlci50YWJCYXIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5jcmVhdGVUYWJCYXJJdGVtID0gZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgIHZhciBpbWFnZTtcbiAgICAgICAgdmFyIHRpdGxlO1xuICAgICAgICBpbWFnZSA9IHRoaXMuX2dldEljb24oaXRlbSk7XG4gICAgICAgIHRpdGxlID0gaXRlbS5sYWJlbCA/IGl0ZW0ubGFiZWwudGV4dCA6IGl0ZW0udGl0bGU7XG4gICAgICAgIGlmICghdGhpcy50YWJTdHJpcC5faGFzSW1hZ2UpIHtcbiAgICAgICAgICAgIHRoaXMudGFiU3RyaXAuX2hhc0ltYWdlID0gISFpbWFnZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMudGFiU3RyaXAuX2hhc1RpdGxlKSB7XG4gICAgICAgICAgICB0aGlzLnRhYlN0cmlwLl9oYXNUaXRsZSA9ICEhdGl0bGU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRhYkJhckl0ZW0gPSBVSVRhYkJhckl0ZW0uYWxsb2MoKS5pbml0V2l0aFRpdGxlSW1hZ2VUYWcodGl0bGUsIGltYWdlLCBpbmRleCk7XG4gICAgICAgIHJldHVybiB0YWJCYXJJdGVtO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuX2dldFRhYkJhckl0ZW1BcHBlYXJhbmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXRlbUFwcGVhcmFuY2U7XG4gICAgICAgIGlmICh0aGlzLnRhYlN0cmlwLl9oYXNJbWFnZSAmJiB0aGlzLnRhYlN0cmlwLl9oYXNUaXRsZSkge1xuICAgICAgICAgICAgaXRlbUFwcGVhcmFuY2UgPSAyO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMudGFiU3RyaXAuX2hhc0ltYWdlKSB7XG4gICAgICAgICAgICBpdGVtQXBwZWFyYW5jZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpdGVtQXBwZWFyYW5jZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGl0ZW1BcHBlYXJhbmNlO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuX2dldEljb25SZW5kZXJpbmdNb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLl9nZXRJY29uID0gZnVuY3Rpb24gKHRhYlN0cmlwSXRlbSkge1xuICAgICAgICB2YXIgaWNvblNvdXJjZSA9IHRhYlN0cmlwSXRlbS5pbWFnZSA/IHRhYlN0cmlwSXRlbS5pbWFnZS5zcmMgOiB0YWJTdHJpcEl0ZW0uaWNvblNvdXJjZTtcbiAgICAgICAgaWYgKCFpY29uU291cmNlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLl9pY29uc0NhY2hlW2ljb25Tb3VyY2VdO1xuICAgICAgICBpZiAoIWltYWdlKSB7XG4gICAgICAgICAgICB2YXIgaXMgPSBuZXcgaW1hZ2Vfc291cmNlXzEuSW1hZ2VTb3VyY2U7XG4gICAgICAgICAgICBpZiAodXRpbHNfMS5pc0ZvbnRJY29uVVJJKGljb25Tb3VyY2UpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvbnRJY29uQ29kZSA9IGljb25Tb3VyY2Uuc3BsaXQoXCIvL1wiKVsxXTtcbiAgICAgICAgICAgICAgICB2YXIgZm9udCA9IHRhYlN0cmlwSXRlbS5zdHlsZS5mb250SW50ZXJuYWw7XG4gICAgICAgICAgICAgICAgdmFyIGNvbG9yID0gdGFiU3RyaXBJdGVtLnN0eWxlLmNvbG9yO1xuICAgICAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZvbnRJY29uQ29kZShmb250SWNvbkNvZGUsIGZvbnQsIGNvbG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzID0gaW1hZ2Vfc291cmNlXzEuZnJvbUZpbGVPclJlc291cmNlKGljb25Tb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzICYmIGlzLmlvcykge1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbFJlbmRlcmVkSW1hZ2UgPSBpcy5pb3MuaW1hZ2VXaXRoUmVuZGVyaW5nTW9kZSh0aGlzLl9nZXRJY29uUmVuZGVyaW5nTW9kZSgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pY29uc0NhY2hlW2ljb25Tb3VyY2VdID0gb3JpZ2luYWxSZW5kZXJlZEltYWdlO1xuICAgICAgICAgICAgICAgIGltYWdlID0gb3JpZ2luYWxSZW5kZXJlZEltYWdlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuZ2V0VGFiQmFyQmFja2dyb3VuZENvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW9zLnRhYkJhci5iYXJUaW50Q29sb3I7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5faW9zLnRhYkJhci5iYXJUaW50Q29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGNvbG9yXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmdldFRhYkJhckZvbnRJbnRlcm5hbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lvcy50YWJCYXIudW5zZWxlY3RlZEl0ZW1UaXRsZUZvbnQ7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJGb250SW50ZXJuYWwgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGRlZmF1bHRUYWJJdGVtRm9udFNpemUgPSAxMDtcbiAgICAgICAgdmFyIHRhYkl0ZW1Gb250U2l6ZSA9IHRoaXMudGFiU3RyaXAuc3R5bGUuZm9udFNpemUgfHwgZGVmYXVsdFRhYkl0ZW1Gb250U2l6ZTtcbiAgICAgICAgdmFyIGZvbnQgPSB0aGlzLnRhYlN0cmlwLnN0eWxlLmZvbnRJbnRlcm5hbC5nZXRVSUZvbnQoVUlGb250LnN5c3RlbUZvbnRPZlNpemUodGFiSXRlbUZvbnRTaXplKSk7XG4gICAgICAgIHRoaXMuX2lvcy50YWJCYXIudW5zZWxlY3RlZEl0ZW1UaXRsZUZvbnQgPSBmb250O1xuICAgICAgICB0aGlzLl9pb3MudGFiQmFyLnNlbGVjdGVkSXRlbVRpdGxlRm9udCA9IGZvbnQ7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5nZXRUYWJCYXJUZXh0VHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLnNldFRhYkJhclRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBcIm5vbmVcIikge1xuICAgICAgICAgICAgdGhpcy5faW9zLnRhYkJhci50aXRsZVRleHRUcmFuc2Zvcm0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID09PSBcInVwcGVyY2FzZVwiKSB7XG4gICAgICAgICAgICB0aGlzLl9pb3MudGFiQmFyLnRpdGxlVGV4dFRyYW5zZm9ybSA9IDI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlLmdldFRhYkJhckNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW9zLnRhYkJhci50aXRsZUNvbG9yRm9yU3RhdGUoMCk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5zZXRUYWJCYXJDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlQ29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIGNvbG9yXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5faW9zLnRhYkJhci5zZXRUaXRsZUNvbG9yRm9yU3RhdGUobmF0aXZlQ29sb3IsIDApO1xuICAgICAgICB0aGlzLl9pb3MudGFiQmFyLnNldFRpdGxlQ29sb3JGb3JTdGF0ZShuYXRpdmVDb2xvciwgMSk7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZS5nZXRUYWJCYXJIaWdobGlnaHRDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lvcy50YWJCYXIudGludENvbG9yO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGUuc2V0VGFiQmFySGlnaGxpZ2h0Q29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZUNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiBjb2xvcl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIHRoaXMuX2lvcy50YWJCYXIudGludENvbG9yID0gbmF0aXZlQ29sb3I7XG4gICAgfTtcbiAgICBUYWJzLnByb3RvdHlwZVt0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICBpZiAodmFsdWUgPiAtMSkge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLml0ZW1zW3ZhbHVlXTtcbiAgICAgICAgICAgIHZhciBjb250cm9sbGVycyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhDYXBhY2l0eSgxKTtcbiAgICAgICAgICAgIHZhciBpdGVtQ29udHJvbGxlciA9IGl0ZW0uX19jb250cm9sbGVyO1xuICAgICAgICAgICAgY29udHJvbGxlcnMuYWRkT2JqZWN0KGl0ZW1Db250cm9sbGVyKTtcbiAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uRGlyZWN0aW9uID0gMDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50TmF0aXZlU2VsZWN0ZWRJbmRleCAmJiB0aGlzLl9jdXJyZW50TmF0aXZlU2VsZWN0ZWRJbmRleCA+IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkRpcmVjdGlvbiA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50TmF0aXZlU2VsZWN0ZWRJbmRleCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlci5zZXRWaWV3Q29udHJvbGxlcnNEaXJlY3Rpb25BbmltYXRlZENvbXBsZXRpb24oY29udHJvbGxlcnMsIG5hdmlnYXRpb25EaXJlY3Rpb24sIHRydWUsIGZ1bmN0aW9uIChmaW5pc2hlZCkge1xuICAgICAgICAgICAgICAgIGlmIChmaW5pc2hlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9jYW5TZWxlY3RJdGVtID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhYkJhckl0ZW1zICYmIHRoaXMudGFiQmFySXRlbXMubGVuZ3RoICYmIHRoaXMudmlld0NvbnRyb2xsZXIgJiYgdGhpcy52aWV3Q29udHJvbGxlci50YWJCYXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdDb250cm9sbGVyLnRhYkJhci5zZXRTZWxlY3RlZEl0ZW1BbmltYXRlZCh0aGlzLnRhYkJhckl0ZW1zW3ZhbHVlXSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS5pdGVtc1Byb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRWaWV3Q29udHJvbGxlcnModmFsdWUpO1xuICAgICAgICB0YWJfbmF2aWdhdGlvbl9iYXNlXzEuc2VsZWN0ZWRJbmRleFByb3BlcnR5LmNvZXJjZSh0aGlzKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS50YWJTdHJpcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYl9uYXZpZ2F0aW9uX2Jhc2VfMS50YWJTdHJpcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZXRUYWJTdHJpcEl0ZW1zKHZhbHVlLml0ZW1zKTtcbiAgICB9O1xuICAgIFRhYnMucHJvdG90eXBlW3RhYnNfY29tbW9uXzEuc3dpcGVFbmFibGVkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVGFicy5wcm90b3R5cGVbdGFic19jb21tb25fMS5zd2lwZUVuYWJsZWRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXdDb250cm9sbGVyICYmIHRoaXMudmlld0NvbnRyb2xsZXIuc2Nyb2xsVmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlci5zY3JvbGxWaWV3LnNjcm9sbEVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFRhYnM7XG59KHRhYnNfY29tbW9uXzEuVGFic0Jhc2UpKTtcbmV4cG9ydHMuVGFicyA9IFRhYnM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10YWJzLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgZm9ybWF0dGVkX3N0cmluZ18xID0gcmVxdWlyZShcIi4uLy4uL3RleHQvZm9ybWF0dGVkLXN0cmluZ1wiKTtcbmV4cG9ydHMuRm9ybWF0dGVkU3RyaW5nID0gZm9ybWF0dGVkX3N0cmluZ18xLkZvcm1hdHRlZFN0cmluZztcbmV4cG9ydHMuU3BhbiA9IGZvcm1hdHRlZF9zdHJpbmdfMS5TcGFuO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKSk7XG52YXIgQ0hJTERfU1BBTiA9IFwiU3BhblwiO1xudmFyIENISUxEX0ZPUk1BVFRFRF9URVhUID0gXCJmb3JtYXR0ZWRUZXh0XCI7XG52YXIgQ0hJTERfRk9STUFUVEVEX1NUUklORyA9IFwiRm9ybWF0dGVkU3RyaW5nXCI7XG52YXIgVGV4dEJhc2VDb21tb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0QmFzZUNvbW1vbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUZXh0QmFzZUNvbW1vbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcIm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImZvbnRGYW1pbHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRGYW1pbHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRGYW1pbHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJmb250U2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udFN0eWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U3R5bGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTdHlsZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImZvbnRXZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRXZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRXZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJsZXR0ZXJTcGFjaW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5sZXR0ZXJTcGFjaW5nO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5sZXR0ZXJTcGFjaW5nID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwibGluZUhlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubGluZUhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubGluZUhlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInRleHRBbGlnbm1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHRBbGlnbm1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHRBbGlnbm1lbnQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJ0ZXh0RGVjb3JhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwidGV4dFRyYW5zZm9ybVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dFRyYW5zZm9ybTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dFRyYW5zZm9ybSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcIndoaXRlU3BhY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLndoaXRlU3BhY2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndoaXRlU3BhY2UgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ1RvcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ1RvcDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucGFkZGluZ1RvcCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdSaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ1JpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nUmlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nQm90dG9tXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nQm90dG9tID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ0xlZnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdMZWZ0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nTGVmdCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX29uRm9ybWF0dGVkVGV4dENvbnRlbnRzQ2hhbmdlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXNbZXhwb3J0cy5mb3JtYXR0ZWRUZXh0UHJvcGVydHkuc2V0TmF0aXZlXShkYXRhLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBDSElMRF9TUEFOKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRUZXh0ID0gbmV3IGZvcm1hdHRlZF9zdHJpbmdfMS5Gb3JtYXR0ZWRTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICBmb3JtYXR0ZWRUZXh0LnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0dGVkVGV4dCA9IGZvcm1hdHRlZFRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdHRlZFRleHQuc3BhbnMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobmFtZSA9PT0gQ0hJTERfRk9STUFUVEVEX1RFWFQgfHwgbmFtZSA9PT0gQ0hJTERfRk9STUFUVEVEX1NUUklORykge1xuICAgICAgICAgICAgdGhpcy5mb3JtYXR0ZWRUZXh0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fcmVxdWVzdExheW91dE9uVGV4dENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVxdWVzdExheW91dCgpO1xuICAgIH07XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGV4dCA9IHRoaXMuZm9ybWF0dGVkVGV4dDtcbiAgICAgICAgaWYgKHRleHQpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRleHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX3NldE5hdGl2ZVRleHQgPSBmdW5jdGlvbiAocmVzZXQpIHtcbiAgICAgICAgaWYgKHJlc2V0ID09PSB2b2lkIDApIHsgcmVzZXQgPSBmYWxzZTsgfVxuICAgIH07XG4gICAgcmV0dXJuIFRleHRCYXNlQ29tbW9uO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5UZXh0QmFzZUNvbW1vbiA9IFRleHRCYXNlQ29tbW9uO1xuVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9pc1NpbmdsZUxpbmUgPSBmYWxzZTtcbmZ1bmN0aW9uIGlzQm9sZChmb250V2VpZ2h0KSB7XG4gICAgcmV0dXJuIGZvbnRXZWlnaHQgPT09IFwiYm9sZFwiIHx8IGZvbnRXZWlnaHQgPT09IFwiNzAwXCIgfHwgZm9udFdlaWdodCA9PT0gXCI4MDBcIiB8fCBmb250V2VpZ2h0ID09PSBcIjkwMFwiO1xufVxuZXhwb3J0cy5pc0JvbGQgPSBpc0JvbGQ7XG5leHBvcnRzLnRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInRleHRcIiwgZGVmYXVsdFZhbHVlOiBcIlwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNBbmRyb2lkIH0pO1xuZXhwb3J0cy50ZXh0UHJvcGVydHkucmVnaXN0ZXIoVGV4dEJhc2VDb21tb24pO1xuZXhwb3J0cy5mb3JtYXR0ZWRUZXh0UHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHsgbmFtZTogXCJmb3JtYXR0ZWRUZXh0XCIsIGFmZmVjdHNMYXlvdXQ6IHRydWUsIHZhbHVlQ2hhbmdlZDogb25Gb3JtYXR0ZWRUZXh0UHJvcGVydHlDaGFuZ2VkIH0pO1xuZXhwb3J0cy5mb3JtYXR0ZWRUZXh0UHJvcGVydHkucmVnaXN0ZXIoVGV4dEJhc2VDb21tb24pO1xuZnVuY3Rpb24gb25Gb3JtYXR0ZWRUZXh0UHJvcGVydHlDaGFuZ2VkKHRleHRCYXNlLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICBpZiAob2xkVmFsdWUpIHtcbiAgICAgICAgb2xkVmFsdWUub2ZmKHZpZXdfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRleHRCYXNlLl9vbkZvcm1hdHRlZFRleHRDb250ZW50c0NoYW5nZWQsIHRleHRCYXNlKTtcbiAgICAgICAgdGV4dEJhc2UuX3JlbW92ZVZpZXcob2xkVmFsdWUpO1xuICAgIH1cbiAgICBpZiAobmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIG9sZFBhcmVudCA9IG5ld1ZhbHVlLnBhcmVudDtcbiAgICAgICAgaWYgKG9sZFBhcmVudCkge1xuICAgICAgICAgICAgb2xkUGFyZW50Ll9yZW1vdmVWaWV3KG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB0ZXh0QmFzZS5fYWRkVmlldyhuZXdWYWx1ZSk7XG4gICAgICAgIG5ld1ZhbHVlLm9uKHZpZXdfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRleHRCYXNlLl9vbkZvcm1hdHRlZFRleHRDb250ZW50c0NoYW5nZWQsIHRleHRCYXNlKTtcbiAgICB9XG59XG52YXIgdGV4dEFsaWdubWVudENvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwiaW5pdGlhbFwiLCBcImxlZnRcIiwgXCJjZW50ZXJcIiwgXCJyaWdodFwiKSk7XG5leHBvcnRzLnRleHRBbGlnbm1lbnRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRleHRBbGlnbm1lbnRcIiwgY3NzTmFtZTogXCJ0ZXh0LWFsaWduXCIsIGRlZmF1bHRWYWx1ZTogXCJpbml0aWFsXCIsIHZhbHVlQ29udmVydGVyOiB0ZXh0QWxpZ25tZW50Q29udmVydGVyIH0pO1xuZXhwb3J0cy50ZXh0QWxpZ25tZW50UHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbnZhciB0ZXh0VHJhbnNmb3JtQ29udmVydGVyID0gdmlld18xLm1ha2VQYXJzZXIodmlld18xLm1ha2VWYWxpZGF0b3IoXCJpbml0aWFsXCIsIFwibm9uZVwiLCBcImNhcGl0YWxpemVcIiwgXCJ1cHBlcmNhc2VcIiwgXCJsb3dlcmNhc2VcIikpO1xuZXhwb3J0cy50ZXh0VHJhbnNmb3JtUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ0ZXh0VHJhbnNmb3JtXCIsIGNzc05hbWU6IFwidGV4dC10cmFuc2Zvcm1cIiwgZGVmYXVsdFZhbHVlOiBcImluaXRpYWxcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHRUcmFuc2Zvcm1Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xudmFyIHdoaXRlU3BhY2VDb252ZXJ0ZXIgPSB2aWV3XzEubWFrZVBhcnNlcih2aWV3XzEubWFrZVZhbGlkYXRvcihcImluaXRpYWxcIiwgXCJub3JtYWxcIiwgXCJub3dyYXBcIikpO1xuZXhwb3J0cy53aGl0ZVNwYWNlUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ3aGl0ZVNwYWNlXCIsIGNzc05hbWU6IFwid2hpdGUtc3BhY2VcIiwgZGVmYXVsdFZhbHVlOiBcImluaXRpYWxcIiwgYWZmZWN0c0xheW91dDogdmlld18xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogd2hpdGVTcGFjZUNvbnZlcnRlciB9KTtcbmV4cG9ydHMud2hpdGVTcGFjZVByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG52YXIgdGV4dERlY29yYXRpb25Db252ZXJ0ZXIgPSB2aWV3XzEubWFrZVBhcnNlcih2aWV3XzEubWFrZVZhbGlkYXRvcihcIm5vbmVcIiwgXCJ1bmRlcmxpbmVcIiwgXCJsaW5lLXRocm91Z2hcIiwgXCJ1bmRlcmxpbmUgbGluZS10aHJvdWdoXCIpKTtcbmV4cG9ydHMudGV4dERlY29yYXRpb25Qcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRleHREZWNvcmF0aW9uXCIsIGNzc05hbWU6IFwidGV4dC1kZWNvcmF0aW9uXCIsIGRlZmF1bHRWYWx1ZTogXCJub25lXCIsIHZhbHVlQ29udmVydGVyOiB0ZXh0RGVjb3JhdGlvbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xuZXhwb3J0cy5sZXR0ZXJTcGFjaW5nUHJvcGVydHkgPSBuZXcgdmlld18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJsZXR0ZXJTcGFjaW5nXCIsIGNzc05hbWU6IFwibGV0dGVyLXNwYWNpbmdcIiwgZGVmYXVsdFZhbHVlOiAwLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KTsgfSB9KTtcbmV4cG9ydHMubGV0dGVyU3BhY2luZ1Byb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmxpbmVIZWlnaHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImxpbmVIZWlnaHRcIiwgY3NzTmFtZTogXCJsaW5lLWhlaWdodFwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KTsgfSB9KTtcbmV4cG9ydHMubGluZUhlaWdodFByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLnJlc2V0U3ltYm9sID0gU3ltYm9sKFwidGV4dFByb3BlcnR5RGVmYXVsdFwiKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRleHQtYmFzZS1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmb250XzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9mb250XCIpO1xudmFyIHRleHRfYmFzZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RleHQtYmFzZS1jb21tb25cIik7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RleHQtYmFzZS1jb21tb25cIikpO1xudmFyIFRleHRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0ZXh0X2Jhc2VfY29tbW9uXzEucmVzZXRTeW1ib2w7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciByZXNldCA9IHZhbHVlID09PSB0ZXh0X2Jhc2VfY29tbW9uXzEucmVzZXRTeW1ib2w7XG4gICAgICAgIGlmICghcmVzZXQgJiYgdGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dChyZXNldCk7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RMYXlvdXRPblRleHRDaGFuZ2VkKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmZvcm1hdHRlZFRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQoKTtcbiAgICAgICAgdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZSh0aGlzLCAhdmFsdWUgPyBcIlwiIDogdmFsdWUudG9TdHJpbmcoKSk7XG4gICAgICAgIHRoaXMuX3JlcXVlc3RMYXlvdXRPblRleHRDaGFuZ2VkKCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUJ1dHRvbikge1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcudGl0bGVDb2xvckZvclN0YXRlKDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcudGV4dENvbG9yO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY29sb3IgPSB2YWx1ZSBpbnN0YW5jZW9mIHRleHRfYmFzZV9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgVUlCdXR0b24pIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0VGl0bGVDb2xvckZvclN0YXRlKGNvbG9yLCAwKTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcudGl0bGVMYWJlbC50ZXh0Q29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcudGV4dENvbG9yID0gY29sb3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgbmF0aXZlVmlldyA9IG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUJ1dHRvbiA/IG5hdGl2ZVZpZXcudGl0bGVMYWJlbCA6IG5hdGl2ZVZpZXc7XG4gICAgICAgIHJldHVybiBuYXRpdmVWaWV3LmZvbnQ7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmZvbnRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKCEodmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCkgfHwgIXRoaXMuZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgbmF0aXZlVmlldyA9IG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUJ1dHRvbiA/IG5hdGl2ZVZpZXcudGl0bGVMYWJlbCA6IG5hdGl2ZVZpZXc7XG4gICAgICAgICAgICB2YXIgZm9udCA9IHZhbHVlIGluc3RhbmNlb2YgZm9udF8xLkZvbnQgPyB2YWx1ZS5nZXRVSUZvbnQobmF0aXZlVmlldy5mb250KSA6IHZhbHVlO1xuICAgICAgICAgICAgbmF0aXZlVmlldy5mb250ID0gZm9udDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0QWxpZ25tZW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJpbml0aWFsXCI6XG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcudGV4dEFsaWdubWVudCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy50ZXh0QWxpZ25tZW50ID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcudGV4dEFsaWdubWVudCA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFRyYW5zZm9ybVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCgpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5sZXR0ZXJTcGFjaW5nUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXROYXRpdmVUZXh0KCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxpbmVIZWlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5fc2V0TmF0aXZlVGV4dCA9IGZ1bmN0aW9uIChyZXNldCkge1xuICAgICAgICBpZiAocmVzZXQgPT09IHZvaWQgMCkgeyByZXNldCA9IGZhbHNlOyB9XG4gICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgaWYgKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUJ1dHRvbikge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuc2V0QXR0cmlidXRlZFRpdGxlRm9yU3RhdGUobnVsbCwgMCk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUaXRsZUZvclN0YXRlKG51bGwsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hdHRyaWJ1dGVkVGV4dCA9IG51bGw7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy50ZXh0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICB0aGlzLnNldEZvcm1hdHRlZFRleHREZWNvcmF0aW9uQW5kVHJhbnNmb3JtKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldFRleHREZWNvcmF0aW9uQW5kVHJhbnNmb3JtKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5zZXRGb3JtYXR0ZWRUZXh0RGVjb3JhdGlvbkFuZFRyYW5zZm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF0dHJUZXh0ID0gdGhpcy5jcmVhdGVOU011dGFibGVBdHRyaWJ1dGVkU3RyaW5nKHRoaXMuZm9ybWF0dGVkVGV4dCk7XG4gICAgICAgIGlmICh0aGlzLmxldHRlclNwYWNpbmcgIT09IDApIHtcbiAgICAgICAgICAgIGF0dHJUZXh0LmFkZEF0dHJpYnV0ZVZhbHVlUmFuZ2UoTlNLZXJuQXR0cmlidXRlTmFtZSwgdGhpcy5sZXR0ZXJTcGFjaW5nICogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5mb250LnBvaW50U2l6ZSwgeyBsb2NhdGlvbjogMCwgbGVuZ3RoOiBhdHRyVGV4dC5sZW5ndGggfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc3R5bGUubGluZUhlaWdodCkge1xuICAgICAgICAgICAgdmFyIHBhcmFncmFwaFN0eWxlID0gTlNNdXRhYmxlUGFyYWdyYXBoU3R5bGUuYWxsb2MoKS5pbml0KCk7XG4gICAgICAgICAgICBwYXJhZ3JhcGhTdHlsZS5saW5lU3BhY2luZyA9IHRoaXMubGluZUhlaWdodDtcbiAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmFsaWdubWVudCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dEFsaWdubWVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlMYWJlbCkge1xuICAgICAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmxpbmVCcmVha01vZGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmxpbmVCcmVha01vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhdHRyVGV4dC5hZGRBdHRyaWJ1dGVWYWx1ZVJhbmdlKE5TUGFyYWdyYXBoU3R5bGVBdHRyaWJ1dGVOYW1lLCBwYXJhZ3JhcGhTdHlsZSwgeyBsb2NhdGlvbjogMCwgbGVuZ3RoOiBhdHRyVGV4dC5sZW5ndGggfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJVGV4dFZpZXcpIHtcbiAgICAgICAgICAgIHZhciBwYXJhZ3JhcGhTdHlsZSA9IE5TTXV0YWJsZVBhcmFncmFwaFN0eWxlLmFsbG9jKCkuaW5pdCgpO1xuICAgICAgICAgICAgcGFyYWdyYXBoU3R5bGUuYWxpZ25tZW50ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0QWxpZ25tZW50O1xuICAgICAgICAgICAgYXR0clRleHQuYWRkQXR0cmlidXRlVmFsdWVSYW5nZShOU1BhcmFncmFwaFN0eWxlQXR0cmlidXRlTmFtZSwgcGFyYWdyYXBoU3R5bGUsIHsgbG9jYXRpb246IDAsIGxlbmd0aDogYXR0clRleHQubGVuZ3RoIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0QXR0cmlidXRlZFRpdGxlRm9yU3RhdGUoYXR0clRleHQsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdHRyaWJ1dGVkVGV4dCA9IGF0dHJUZXh0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGUuc2V0VGV4dERlY29yYXRpb25BbmRUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHRoaXMuc3R5bGU7XG4gICAgICAgIHZhciBkaWN0ID0gbmV3IE1hcCgpO1xuICAgICAgICBzd2l0Y2ggKHN0eWxlLnRleHREZWNvcmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwibm9uZVwiOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVuZGVybGluZVwiOlxuICAgICAgICAgICAgICAgIGRpY3Quc2V0KE5TVW5kZXJsaW5lU3R5bGVBdHRyaWJ1dGVOYW1lLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJsaW5lLXRocm91Z2hcIjpcbiAgICAgICAgICAgICAgICBkaWN0LnNldChOU1N0cmlrZXRocm91Z2hTdHlsZUF0dHJpYnV0ZU5hbWUsIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInVuZGVybGluZSBsaW5lLXRocm91Z2hcIjpcbiAgICAgICAgICAgICAgICBkaWN0LnNldChOU1VuZGVybGluZVN0eWxlQXR0cmlidXRlTmFtZSwgMSk7XG4gICAgICAgICAgICAgICAgZGljdC5zZXQoTlNTdHJpa2V0aHJvdWdoU3R5bGVBdHRyaWJ1dGVOYW1lLCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0ZXh0IGRlY29yYXRpb24gdmFsdWU6IFwiICsgc3R5bGUudGV4dERlY29yYXRpb24gKyBcIi4gVmFsaWQgdmFsdWVzIGFyZTogJ25vbmUnLCAndW5kZXJsaW5lJywgJ2xpbmUtdGhyb3VnaCcsICd1bmRlcmxpbmUgbGluZS10aHJvdWdoJy5cIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0eWxlLmxldHRlclNwYWNpbmcgIT09IDApIHtcbiAgICAgICAgICAgIGRpY3Quc2V0KE5TS2VybkF0dHJpYnV0ZU5hbWUsIHN0eWxlLmxldHRlclNwYWNpbmcgKiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmZvbnQucG9pbnRTaXplKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaXNUZXh0VmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSVRleHRWaWV3O1xuICAgICAgICBpZiAoc3R5bGUubGluZUhlaWdodCkge1xuICAgICAgICAgICAgdmFyIHBhcmFncmFwaFN0eWxlID0gTlNNdXRhYmxlUGFyYWdyYXBoU3R5bGUuYWxsb2MoKS5pbml0KCk7XG4gICAgICAgICAgICBwYXJhZ3JhcGhTdHlsZS5saW5lU3BhY2luZyA9IHN0eWxlLmxpbmVIZWlnaHQ7XG4gICAgICAgICAgICBwYXJhZ3JhcGhTdHlsZS5hbGlnbm1lbnQgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRBbGlnbm1lbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJTGFiZWwpIHtcbiAgICAgICAgICAgICAgICBwYXJhZ3JhcGhTdHlsZS5saW5lQnJlYWtNb2RlID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5saW5lQnJlYWtNb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGljdC5zZXQoTlNQYXJhZ3JhcGhTdHlsZUF0dHJpYnV0ZU5hbWUsIHBhcmFncmFwaFN0eWxlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1RleHRWaWV3KSB7XG4gICAgICAgICAgICB2YXIgcGFyYWdyYXBoU3R5bGUgPSBOU011dGFibGVQYXJhZ3JhcGhTdHlsZS5hbGxvYygpLmluaXQoKTtcbiAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmFsaWdubWVudCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dEFsaWdubWVudDtcbiAgICAgICAgICAgIGRpY3Quc2V0KE5TUGFyYWdyYXBoU3R5bGVBdHRyaWJ1dGVOYW1lLCBwYXJhZ3JhcGhTdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0eWxlLmNvbG9yICYmIChkaWN0LnNpemUgPiAwIHx8IGlzVGV4dFZpZXcpKSB7XG4gICAgICAgICAgICBkaWN0LnNldChOU0ZvcmVncm91bmRDb2xvckF0dHJpYnV0ZU5hbWUsIHN0eWxlLmNvbG9yLmlvcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnRleHQ7XG4gICAgICAgIHZhciBzdHJpbmcgPSAodGV4dCA9PT0gdW5kZWZpbmVkIHx8IHRleHQgPT09IG51bGwpID8gXCJcIiA6IHRleHQudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGdldFRyYW5zZm9ybWVkVGV4dChzdHJpbmcsIHRoaXMudGV4dFRyYW5zZm9ybSk7XG4gICAgICAgIGlmIChkaWN0LnNpemUgPiAwIHx8IGlzVGV4dFZpZXcpIHtcbiAgICAgICAgICAgIGlmIChpc1RleHRWaWV3KSB7XG4gICAgICAgICAgICAgICAgZGljdC5zZXQoTlNGb250QXR0cmlidXRlTmFtZSwgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5mb250KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBOU011dGFibGVBdHRyaWJ1dGVkU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmcoc291cmNlKTtcbiAgICAgICAgICAgIHJlc3VsdC5zZXRBdHRyaWJ1dGVzUmFuZ2UoZGljdCwgeyBsb2NhdGlvbjogMCwgbGVuZ3RoOiBzb3VyY2UubGVuZ3RoIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSUJ1dHRvbikge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0QXR0cmlidXRlZFRpdGxlRm9yU3RhdGUocmVzdWx0LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXR0cmlidXRlZFRleHQgPSByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRBdHRyaWJ1dGVkVGl0bGVGb3JTdGF0ZShudWxsLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldFRpdGxlRm9yU3RhdGUoc291cmNlLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXR0cmlidXRlZFRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0ID0gc291cmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGUuY3JlYXRlTlNNdXRhYmxlQXR0cmlidXRlZFN0cmluZyA9IGZ1bmN0aW9uIChmb3JtYXR0ZWRTdHJpbmcpIHtcbiAgICAgICAgdmFyIG1hcyA9IE5TTXV0YWJsZUF0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0KCk7XG4gICAgICAgIGlmIChmb3JtYXR0ZWRTdHJpbmcgJiYgZm9ybWF0dGVkU3RyaW5nLnBhcmVudCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIHNwYW5TdGFydCA9IDAsIGxlbmd0aF8xID0gZm9ybWF0dGVkU3RyaW5nLnNwYW5zLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BhbiA9IGZvcm1hdHRlZFN0cmluZy5zcGFucy5nZXRJdGVtKGkpO1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gc3Bhbi50ZXh0O1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0VHJhbnNmb3JtID0gZm9ybWF0dGVkU3RyaW5nLnBhcmVudC50ZXh0VHJhbnNmb3JtO1xuICAgICAgICAgICAgICAgIHZhciBzcGFuVGV4dCA9ICh0ZXh0ID09PSBudWxsIHx8IHRleHQgPT09IHVuZGVmaW5lZCkgPyBcIlwiIDogdGV4dC50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0VHJhbnNmb3JtICE9PSBcIm5vbmVcIiAmJiB0ZXh0VHJhbnNmb3JtICE9PSBcImluaXRpYWxcIikge1xuICAgICAgICAgICAgICAgICAgICBzcGFuVGV4dCA9IGdldFRyYW5zZm9ybWVkVGV4dChzcGFuVGV4dCwgdGV4dFRyYW5zZm9ybSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBuc0F0dHJpYnV0ZWRTdHJpbmcgPSB0aGlzLmNyZWF0ZU11dGFibGVTdHJpbmdGb3JTcGFuKHNwYW4sIHNwYW5UZXh0KTtcbiAgICAgICAgICAgICAgICBtYXMuaW5zZXJ0QXR0cmlidXRlZFN0cmluZ0F0SW5kZXgobnNBdHRyaWJ1dGVkU3RyaW5nLCBzcGFuU3RhcnQpO1xuICAgICAgICAgICAgICAgIHNwYW5TdGFydCArPSBzcGFuVGV4dC5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1hcztcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5jcmVhdGVNdXRhYmxlU3RyaW5nRm9yU3BhbiA9IGZ1bmN0aW9uIChzcGFuLCB0ZXh0KSB7XG4gICAgICAgIHZhciB2aWV3Rm9udCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZm9udDtcbiAgICAgICAgdmFyIGF0dHJEaWN0ID0ge307XG4gICAgICAgIHZhciBzdHlsZSA9IHNwYW4uc3R5bGU7XG4gICAgICAgIHZhciBib2xkID0gdGV4dF9iYXNlX2NvbW1vbl8xLmlzQm9sZChzdHlsZS5mb250V2VpZ2h0KTtcbiAgICAgICAgdmFyIGl0YWxpYyA9IHN0eWxlLmZvbnRTdHlsZSA9PT0gXCJpdGFsaWNcIjtcbiAgICAgICAgdmFyIGZvbnRGYW1pbHkgPSBzcGFuLmZvbnRGYW1pbHk7XG4gICAgICAgIHZhciBmb250U2l6ZSA9IHNwYW4uZm9udFNpemU7XG4gICAgICAgIGlmIChib2xkIHx8IGl0YWxpYyB8fCBmb250RmFtaWx5IHx8IGZvbnRTaXplKSB7XG4gICAgICAgICAgICB2YXIgZm9udCA9IG5ldyBmb250XzEuRm9udChzdHlsZS5mb250RmFtaWx5LCBzdHlsZS5mb250U2l6ZSwgc3R5bGUuZm9udFN0eWxlLCBzdHlsZS5mb250V2VpZ2h0KTtcbiAgICAgICAgICAgIHZhciBpb3NGb250ID0gZm9udC5nZXRVSUZvbnQodmlld0ZvbnQpO1xuICAgICAgICAgICAgYXR0ckRpY3RbTlNGb250QXR0cmlidXRlTmFtZV0gPSBpb3NGb250O1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb2xvciA9IHNwYW4uY29sb3I7XG4gICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgYXR0ckRpY3RbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGNvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZENvbG9yID0gKHN0eWxlLmJhY2tncm91bmRDb2xvclxuICAgICAgICAgICAgfHwgc3Bhbi5wYXJlbnQuYmFja2dyb3VuZENvbG9yXG4gICAgICAgICAgICB8fCBzcGFuLnBhcmVudC5wYXJlbnQuYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgaWYgKGJhY2tncm91bmRDb2xvcikge1xuICAgICAgICAgICAgYXR0ckRpY3RbTlNCYWNrZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGJhY2tncm91bmRDb2xvci5pb3M7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlU291cmNlO1xuICAgICAgICBpZiAodGV4dF9iYXNlX2NvbW1vbl8xLnRleHREZWNvcmF0aW9uUHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICB2YWx1ZVNvdXJjZSA9IHN0eWxlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LmlzU2V0KHNwYW4ucGFyZW50LnN0eWxlKSkge1xuICAgICAgICAgICAgdmFsdWVTb3VyY2UgPSBzcGFuLnBhcmVudC5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5pc1NldChzcGFuLnBhcmVudC5wYXJlbnQuc3R5bGUpKSB7XG4gICAgICAgICAgICB2YWx1ZVNvdXJjZSA9IHNwYW4ucGFyZW50LnBhcmVudC5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVTb3VyY2UpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0RGVjb3JhdGlvbnMgPSB2YWx1ZVNvdXJjZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgICAgIHZhciB1bmRlcmxpbmVfMSA9IHRleHREZWNvcmF0aW9ucy5pbmRleE9mKFwidW5kZXJsaW5lXCIpICE9PSAtMTtcbiAgICAgICAgICAgIGlmICh1bmRlcmxpbmVfMSkge1xuICAgICAgICAgICAgICAgIGF0dHJEaWN0W05TVW5kZXJsaW5lU3R5bGVBdHRyaWJ1dGVOYW1lXSA9IHVuZGVybGluZV8xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHN0cmlrZXRocm91Z2ggPSB0ZXh0RGVjb3JhdGlvbnMuaW5kZXhPZihcImxpbmUtdGhyb3VnaFwiKSAhPT0gLTE7XG4gICAgICAgICAgICBpZiAoc3RyaWtldGhyb3VnaCkge1xuICAgICAgICAgICAgICAgIGF0dHJEaWN0W05TU3RyaWtldGhyb3VnaFN0eWxlQXR0cmlidXRlTmFtZV0gPSBzdHJpa2V0aHJvdWdoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOU011dGFibGVBdHRyaWJ1dGVkU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmdBdHRyaWJ1dGVzKHRleHQsIGF0dHJEaWN0KTtcbiAgICB9O1xuICAgIHJldHVybiBUZXh0QmFzZTtcbn0odGV4dF9iYXNlX2NvbW1vbl8xLlRleHRCYXNlQ29tbW9uKSk7XG5leHBvcnRzLlRleHRCYXNlID0gVGV4dEJhc2U7XG5mdW5jdGlvbiBnZXRUcmFuc2Zvcm1lZFRleHQodGV4dCwgdGV4dFRyYW5zZm9ybSkge1xuICAgIGlmICghdGV4dCB8fCAhdHlwZXNfMS5pc1N0cmluZyh0ZXh0KSkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgc3dpdGNoICh0ZXh0VHJhbnNmb3JtKSB7XG4gICAgICAgIGNhc2UgXCJ1cHBlcmNhc2VcIjpcbiAgICAgICAgICAgIHJldHVybiBOU1N0cmluZ0Zyb21OU0F0dHJpYnV0ZWRTdHJpbmcodGV4dCkudXBwZXJjYXNlU3RyaW5nO1xuICAgICAgICBjYXNlIFwibG93ZXJjYXNlXCI6XG4gICAgICAgICAgICByZXR1cm4gTlNTdHJpbmdGcm9tTlNBdHRyaWJ1dGVkU3RyaW5nKHRleHQpLmxvd2VyY2FzZVN0cmluZztcbiAgICAgICAgY2FzZSBcImNhcGl0YWxpemVcIjpcbiAgICAgICAgICAgIHJldHVybiBOU1N0cmluZ0Zyb21OU0F0dHJpYnV0ZWRTdHJpbmcodGV4dCkuY2FwaXRhbGl6ZWRTdHJpbmc7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG59XG5leHBvcnRzLmdldFRyYW5zZm9ybWVkVGV4dCA9IGdldFRyYW5zZm9ybWVkVGV4dDtcbmZ1bmN0aW9uIE5TU3RyaW5nRnJvbU5TQXR0cmlidXRlZFN0cmluZyhzb3VyY2UpIHtcbiAgICByZXR1cm4gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhzb3VyY2UgaW5zdGFuY2VvZiBOU0F0dHJpYnV0ZWRTdHJpbmcgJiYgc291cmNlLnN0cmluZyB8fCBzb3VyY2UpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1iYXNlLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVkaXRhYmxlX3RleHRfYmFzZV8xID0gcmVxdWlyZShcIi4uL2VkaXRhYmxlLXRleHQtYmFzZVwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9lZGl0YWJsZS10ZXh0LWJhc2VcIikpO1xudmFyIFRleHRGaWVsZEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0RmllbGRCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRGaWVsZEJhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dEZpZWxkQmFzZS5yZXR1cm5QcmVzc0V2ZW50ID0gXCJyZXR1cm5QcmVzc1wiO1xuICAgIFRleHRGaWVsZEJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgZWRpdGFibGVfdGV4dF9iYXNlXzEuQ1NTVHlwZShcIlRleHRGaWVsZFwiKVxuICAgIF0sIFRleHRGaWVsZEJhc2UpO1xuICAgIHJldHVybiBUZXh0RmllbGRCYXNlO1xufShlZGl0YWJsZV90ZXh0X2Jhc2VfMS5FZGl0YWJsZVRleHRCYXNlKSk7XG5leHBvcnRzLlRleHRGaWVsZEJhc2UgPSBUZXh0RmllbGRCYXNlO1xuVGV4dEZpZWxkQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbmV4cG9ydHMuc2VjdXJlUHJvcGVydHkgPSBuZXcgZWRpdGFibGVfdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcInNlY3VyZVwiLCBkZWZhdWx0VmFsdWU6IGZhbHNlLCB2YWx1ZUNvbnZlcnRlcjogZWRpdGFibGVfdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuc2VjdXJlUHJvcGVydHkucmVnaXN0ZXIoVGV4dEZpZWxkQmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWZpZWxkLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRleHRfZmllbGRfY29tbW9uXzEgPSByZXF1aXJlKFwiLi90ZXh0LWZpZWxkLWNvbW1vblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi90ZXh0LWZpZWxkLWNvbW1vblwiKSk7XG52YXIgemVyb0xlbmd0aCA9IHtcbiAgICB2YWx1ZTogMCxcbiAgICB1bml0OiBcInB4XCJcbn07XG52YXIgVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSVRleHRGaWVsZERlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVRleHRGaWVsZERlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyID0gZnVuY3Rpb24gKG93bmVyKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBkZWxlZ2F0ZS5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlO1xuICAgIH07XG4gICAgVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRleHRGaWVsZFNob3VsZEJlZ2luRWRpdGluZyA9IGZ1bmN0aW9uICh0ZXh0RmllbGQpIHtcbiAgICAgICAgdGhpcy5maXJzdEVkaXQgPSB0cnVlO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gb3duZXIuZWRpdGFibGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkRGlkQmVnaW5FZGl0aW5nID0gZnVuY3Rpb24gKHRleHRGaWVsZCkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5ub3RpZnkoeyBldmVudE5hbWU6IFRleHRGaWVsZC5mb2N1c0V2ZW50LCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkRGlkRW5kRWRpdGluZyA9IGZ1bmN0aW9uICh0ZXh0RmllbGQpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgaWYgKG93bmVyLnVwZGF0ZVRleHRUcmlnZ2VyID09PSBcImZvY3VzTG9zdFwiKSB7XG4gICAgICAgICAgICAgICAgdGV4dF9maWVsZF9jb21tb25fMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIHRleHRGaWVsZC50ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG93bmVyLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRleHRGaWVsZFNob3VsZENsZWFyID0gZnVuY3Rpb24gKHRleHRGaWVsZCkge1xuICAgICAgICB0aGlzLmZpcnN0RWRpdCA9IGZhbHNlO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB0ZXh0X2ZpZWxkX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkU2hvdWxkUmV0dXJuID0gZnVuY3Rpb24gKHRleHRGaWVsZCkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5kaXNtaXNzU29mdElucHV0KCk7XG4gICAgICAgICAgICBvd25lci5ub3RpZnkoeyBldmVudE5hbWU6IFRleHRGaWVsZC5yZXR1cm5QcmVzc0V2ZW50LCBvYmplY3Q6IG93bmVyIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRleHRGaWVsZFNob3VsZENoYW5nZUNoYXJhY3RlcnNJblJhbmdlUmVwbGFjZW1lbnRTdHJpbmcgPSBmdW5jdGlvbiAodGV4dEZpZWxkLCByYW5nZSwgcmVwbGFjZW1lbnRTdHJpbmcpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgdmFyIGRlbHRhID0gcmVwbGFjZW1lbnRTdHJpbmcubGVuZ3RoIC0gcmFuZ2UubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGRlbHRhID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0RmllbGQudGV4dC5sZW5ndGggKyBkZWx0YSA+IG93bmVyLm1heExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG93bmVyLnVwZGF0ZVRleHRUcmlnZ2VyID09PSBcInRleHRDaGFuZ2VkXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGV4dEZpZWxkLnNlY3VyZVRleHRFbnRyeSAmJiB0aGlzLmZpcnN0RWRpdCkge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0X2ZpZWxkX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgcmVwbGFjZW1lbnRTdHJpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlLmxvY2F0aW9uIDw9IHRleHRGaWVsZC50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1RleHQgPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKHRleHRGaWVsZC50ZXh0KS5zdHJpbmdCeVJlcGxhY2luZ0NoYXJhY3RlcnNJblJhbmdlV2l0aFN0cmluZyhyYW5nZSwgcmVwbGFjZW1lbnRTdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dF9maWVsZF9jb21tb25fMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ld1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG93bmVyLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgICAgICB0ZXh0X2ZpZWxkX2NvbW1vbl8xLl91cGRhdGVDaGFyYWN0ZXJzSW5SYW5nZVJlcGxhY2VtZW50U3RyaW5nKG93bmVyLmZvcm1hdHRlZFRleHQsIHJhbmdlLmxvY2F0aW9uLCByYW5nZS5sZW5ndGgsIHJlcGxhY2VtZW50U3RyaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZpcnN0RWRpdCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlUZXh0RmllbGREZWxlZ2F0ZV07XG4gICAgcmV0dXJuIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFVJVGV4dEZpZWxkSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJVGV4dEZpZWxkSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSVRleHRGaWVsZEltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlUZXh0RmllbGRJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBVSVRleHRGaWVsZEltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVUlUZXh0RmllbGRJbXBsLnByb3RvdHlwZS5fZ2V0VGV4dFJlY3RGb3JCb3VuZHMgPSBmdW5jdGlvbiAoYm91bmRzKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyID8gdGhpcy5fb3duZXIuZ2V0KCkgOiBudWxsO1xuICAgICAgICBpZiAoIW93bmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gYm91bmRzO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzaXplID0gYm91bmRzLnNpemU7XG4gICAgICAgIHZhciB4ID0gdGV4dF9maWVsZF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhvd25lci5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGggKyBvd25lci5lZmZlY3RpdmVQYWRkaW5nTGVmdCk7XG4gICAgICAgIHZhciB5ID0gdGV4dF9maWVsZF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhvd25lci5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIG93bmVyLmVmZmVjdGl2ZVBhZGRpbmdUb3ApO1xuICAgICAgICB2YXIgd2lkdGggPSB0ZXh0X2ZpZWxkX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRleHRfZmllbGRfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNpemUud2lkdGgpIC0gKG93bmVyLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIG93bmVyLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgb3duZXIuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgb3duZXIuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCkpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdGV4dF9maWVsZF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0ZXh0X2ZpZWxkX2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzaXplLmhlaWdodCkgLSAob3duZXIuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyBvd25lci5lZmZlY3RpdmVQYWRkaW5nVG9wICsgb3duZXIuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIG93bmVyLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoKSk7XG4gICAgICAgIHJldHVybiBDR1JlY3RNYWtlKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xuICAgIH07XG4gICAgVUlUZXh0RmllbGRJbXBsLnByb3RvdHlwZS50ZXh0UmVjdEZvckJvdW5kcyA9IGZ1bmN0aW9uIChib3VuZHMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRleHRSZWN0Rm9yQm91bmRzKGJvdW5kcyk7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZEltcGwucHJvdG90eXBlLmVkaXRpbmdSZWN0Rm9yQm91bmRzID0gZnVuY3Rpb24gKGJvdW5kcykge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VGV4dFJlY3RGb3JCb3VuZHMoYm91bmRzKTtcbiAgICB9O1xuICAgIHJldHVybiBVSVRleHRGaWVsZEltcGw7XG59KFVJVGV4dEZpZWxkKSk7XG52YXIgVGV4dEZpZWxkID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dEZpZWxkLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRGaWVsZCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUZXh0RmllbGQucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVSVRleHRGaWVsZEltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5pb3MuZGVsZWdhdGUgPSB0aGlzLl9kZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pb3MuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0RmllbGQucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLmhpbnRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQucGxhY2Vob2xkZXI7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuaGludFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlQXR0cmlidXRlZFBsYWNlaG9sZGVyKCk7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuc2VjdXJlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNlY3VyZVRleHRFbnRyeTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5zZWN1cmVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2VjdXJlVGV4dEVudHJ5ID0gdmFsdWU7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRleHRDb2xvcjogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29sb3IsXG4gICAgICAgICAgICB0aW50Q29sb3I6IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGludENvbG9yXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHRleHRfZmllbGRfY29tbW9uXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGV4dF9maWVsZF9jb21tb25fMS5Db2xvciA/IHZhbHVlLmlvcyA6IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29sb3IgPSBjb2xvcjtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGludENvbG9yID0gY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb2xvciA9IHZhbHVlLnRleHRDb2xvcjtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGludENvbG9yID0gdmFsdWUudGludENvbG9yO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGxhY2Vob2xkZXJDb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl91cGRhdGVBdHRyaWJ1dGVkUGxhY2Vob2xkZXIoKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGUuX3VwZGF0ZUF0dHJpYnV0ZWRQbGFjZWhvbGRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gdGhpcy5oaW50O1xuICAgICAgICBpZiAoc3RyaW5nVmFsdWUgPT09IG51bGwgfHwgc3RyaW5nVmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZSArIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0cmluZ1ZhbHVlID09PSBcIlwiKSB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZSA9IFwiIFwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhdHRyaWJ1dGVzID0ge307XG4gICAgICAgIGlmICh0aGlzLnN0eWxlLnBsYWNlaG9sZGVyQ29sb3IpIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXNbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IHRoaXMuc3R5bGUucGxhY2Vob2xkZXJDb2xvci5pb3M7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZWRQbGFjZWhvbGRlciA9IE5TQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXRXaXRoU3RyaW5nQXR0cmlidXRlcyhzdHJpbmdWYWx1ZSwgYXR0cmlidXRlcyk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXR0cmlidXRlZFBsYWNlaG9sZGVyID0gYXR0cmlidXRlZFBsYWNlaG9sZGVyO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHplcm9MZW5ndGg7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHplcm9MZW5ndGg7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHplcm9MZW5ndGg7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gemVyb0xlbmd0aDtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nTGVmdFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVGV4dEZpZWxkLnByb3RvdHlwZSwgXCJvbkxvYWRlZFwiLCBudWxsKTtcbiAgICByZXR1cm4gVGV4dEZpZWxkO1xufSh0ZXh0X2ZpZWxkX2NvbW1vbl8xLlRleHRGaWVsZEJhc2UpKTtcbmV4cG9ydHMuVGV4dEZpZWxkID0gVGV4dEZpZWxkO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1maWVsZC5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlZGl0YWJsZV90ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi9lZGl0YWJsZS10ZXh0LWJhc2VcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2VkaXRhYmxlLXRleHQtYmFzZVwiKSk7XG52YXIgVUlUZXh0Vmlld0RlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJVGV4dFZpZXdEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlUZXh0Vmlld0RlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSVRleHRWaWV3RGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGltcGwgPSBVSVRleHRWaWV3RGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBpbXBsLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gaW1wbDtcbiAgICB9O1xuICAgIFVJVGV4dFZpZXdEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnRleHRWaWV3U2hvdWxkQmVnaW5FZGl0aW5nID0gZnVuY3Rpb24gKHRleHRWaWV3KSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIG93bmVyLnNob3dUZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBVSVRleHRWaWV3RGVsZWdhdGVJbXBsLnByb3RvdHlwZS50ZXh0Vmlld0RpZEJlZ2luRWRpdGluZyA9IGZ1bmN0aW9uICh0ZXh0Vmlldykge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5faXNFZGl0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogVGV4dFZpZXcuZm9jdXNFdmVudCwgb2JqZWN0OiBvd25lciB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlUZXh0Vmlld0RlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dFZpZXdEaWRFbmRFZGl0aW5nID0gZnVuY3Rpb24gKHRleHRWaWV3KSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIGlmIChvd25lci51cGRhdGVUZXh0VHJpZ2dlciA9PT0gXCJmb2N1c0xvc3RcIikge1xuICAgICAgICAgICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgdGV4dFZpZXcudGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5faXNFZGl0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICBvd25lci5kaXNtaXNzU29mdElucHV0KCk7XG4gICAgICAgICAgICBvd25lci5fcmVmcmVzaEhpbnRTdGF0ZShvd25lci5oaW50LCB0ZXh0Vmlldy50ZXh0KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlUZXh0Vmlld0RlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dFZpZXdEaWRDaGFuZ2UgPSBmdW5jdGlvbiAodGV4dFZpZXcpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgaWYgKG93bmVyLnVwZGF0ZVRleHRUcmlnZ2VyID09PSBcInRleHRDaGFuZ2VkXCIpIHtcbiAgICAgICAgICAgICAgICBlZGl0YWJsZV90ZXh0X2Jhc2VfMS50ZXh0UHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIHRleHRWaWV3LnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3duZXIucmVxdWVzdExheW91dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRleHRWaWV3RGVsZWdhdGVJbXBsLnByb3RvdHlwZS50ZXh0Vmlld1Nob3VsZENoYW5nZVRleHRJblJhbmdlUmVwbGFjZW1lbnRUZXh0ID0gZnVuY3Rpb24gKHRleHRWaWV3LCByYW5nZSwgcmVwbGFjZW1lbnRTdHJpbmcpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgdmFyIGRlbHRhID0gcmVwbGFjZW1lbnRTdHJpbmcubGVuZ3RoIC0gcmFuZ2UubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGRlbHRhID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0Vmlldy50ZXh0Lmxlbmd0aCArIGRlbHRhID4gb3duZXIubWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3duZXIuZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV8xLl91cGRhdGVDaGFyYWN0ZXJzSW5SYW5nZVJlcGxhY2VtZW50U3RyaW5nKG93bmVyLmZvcm1hdHRlZFRleHQsIHJhbmdlLmxvY2F0aW9uLCByYW5nZS5sZW5ndGgsIHJlcGxhY2VtZW50U3RyaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFVJVGV4dFZpZXdEZWxlZ2F0ZUltcGwucHJvdG90eXBlLnNjcm9sbFZpZXdEaWRTY3JvbGwgPSBmdW5jdGlvbiAoc3YpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgdmFyIGNvbnRlbnRPZmZzZXQgPSBvd25lci5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRPZmZzZXQ7XG4gICAgICAgICAgICBvd25lci5ub3RpZnkoe1xuICAgICAgICAgICAgICAgIG9iamVjdDogb3duZXIsXG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBcInNjcm9sbFwiLFxuICAgICAgICAgICAgICAgIHNjcm9sbFg6IGNvbnRlbnRPZmZzZXQueCxcbiAgICAgICAgICAgICAgICBzY3JvbGxZOiBjb250ZW50T2Zmc2V0LnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRleHRWaWV3RGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlUZXh0Vmlld0RlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlUZXh0Vmlld0RlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbnZhciBOb1Njcm9sbEFuaW1hdGlvblVJVGV4dFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOb1Njcm9sbEFuaW1hdGlvblVJVGV4dFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTm9TY3JvbGxBbmltYXRpb25VSVRleHRWaWV3KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE5vU2Nyb2xsQW5pbWF0aW9uVUlUZXh0Vmlldy5wcm90b3R5cGUuc2V0Q29udGVudE9mZnNldEFuaW1hdGVkID0gZnVuY3Rpb24gKGNvbnRlbnRPZmZzZXQsIGFuaW1hdGVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0Q29udGVudE9mZnNldEFuaW1hdGVkLmNhbGwodGhpcywgY29udGVudE9mZnNldCwgZmFsc2UpO1xuICAgIH07XG4gICAgcmV0dXJuIE5vU2Nyb2xsQW5pbWF0aW9uVUlUZXh0Vmlldztcbn0oVUlUZXh0VmlldykpO1xudmFyIFRleHRWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGV4dFZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGV4dFZpZXcucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ZXh0VmlldyA9IE5vU2Nyb2xsQW5pbWF0aW9uVUlUZXh0Vmlldy5uZXcoKTtcbiAgICAgICAgaWYgKCF0ZXh0Vmlldy5mb250KSB7XG4gICAgICAgICAgICB0ZXh0Vmlldy5mb250ID0gVUlGb250LnN5c3RlbUZvbnRPZlNpemUoMTIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZXh0VmlldztcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFVJVGV4dFZpZXdEZWxlZ2F0ZUltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuaW9zLmRlbGVnYXRlID0gdGhpcy5fZGVsZWdhdGU7XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pb3MuZGVsZWdhdGUgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uVW5sb2FkZWQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0Vmlldy5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGUuX3JlZnJlc2hIaW50U3RhdGUgPSBmdW5jdGlvbiAoaGludCwgdGV4dCkge1xuICAgICAgICBpZiAodGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRleHQgIT09IG51bGwgJiYgdGV4dCAhPT0gdW5kZWZpbmVkICYmIHRleHQgIT09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd1RleHQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGhpcy5faXNFZGl0aW5nICYmIGhpbnQgIT09IG51bGwgJiYgaGludCAhPT0gdW5kZWZpbmVkICYmIGhpbnQgIT09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0hpbnQoaGludCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9pc1Nob3dpbmdIaW50ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHQgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGUuX3JlZnJlc2hDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzU2hvd2luZ0hpbnQpIHtcbiAgICAgICAgICAgIHZhciBwbGFjZWhvbGRlckNvbG9yID0gdGhpcy5zdHlsZS5wbGFjZWhvbGRlckNvbG9yO1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdGhpcy5zdHlsZS5jb2xvcjtcbiAgICAgICAgICAgIGlmIChwbGFjZWhvbGRlckNvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29sb3IgPSBwbGFjZWhvbGRlckNvbG9yLmlvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29sb3IgPSBjb2xvci5pb3MuY29sb3JXaXRoQWxwaGFDb21wb25lbnQoMC4yMik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb2xvciA9IFVJQ29sb3IuYmxhY2tDb2xvci5jb2xvcldpdGhBbHBoYUNvbXBvbmVudCgwLjIyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBjb2xvciA9IHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb2xvciA9IGNvbG9yLmlvcztcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRpbnRDb2xvciA9IGNvbG9yLmlvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbG9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRpbnRDb2xvciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZS5zaG93SGludCA9IGZ1bmN0aW9uIChoaW50KSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdGhpcy5faXNTaG93aW5nSGludCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hDb2xvcigpO1xuICAgICAgICB2YXIgaGludEFzU3RyaW5nID0gKGhpbnQgPT09IG51bGwgfHwgaGludCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiBoaW50LnRvU3RyaW5nKCk7XG4gICAgICAgIG5hdGl2ZVZpZXcudGV4dCA9IGhpbnRBc1N0cmluZztcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZS5zaG93VGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNTaG93aW5nSGludCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWZyZXNoQ29sb3IoKTtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCgpO1xuICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfMS50ZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnRleHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hIaW50U3RhdGUodGhpcy5oaW50LCB2YWx1ZSk7XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlXzEuaGludFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfMS5oaW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9yZWZyZXNoSGludFN0YXRlKHZhbHVlLCB0aGlzLnRleHQpO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmVkaXRhYmxlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmVkaXRhYmxlO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmVkaXRhYmxlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmVkaXRhYmxlID0gdmFsdWU7XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hDb2xvcigpO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBsYWNlaG9sZGVyQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3JlZnJlc2hDb2xvcigpO1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmJvcmRlclRvcFdpZHRoUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29udGFpbmVySW5zZXQudG9wLFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlXzEuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0O1xuICAgICAgICB2YXIgdG9wID0gZWRpdGFibGVfdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0ID0geyB0b3A6IHRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldC5yaWdodCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0O1xuICAgICAgICB2YXIgcmlnaHQgPSBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0ID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiByaWdodCB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29udGFpbmVySW5zZXQuYm90dG9tLFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlXzEuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0O1xuICAgICAgICB2YXIgYm90dG9tID0gZWRpdGFibGVfdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0ID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLmJvcmRlckxlZnRXaWR0aFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0LmxlZnQsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfMS5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0O1xuICAgICAgICB2YXIgbGVmdCA9IGVkaXRhYmxlX3RleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0ID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogbGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldC50b3AsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldDtcbiAgICAgICAgdmFyIHRvcCA9IGVkaXRhYmxlX3RleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGgpO1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldCA9IHsgdG9wOiB0b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIFRleHRWaWV3LnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldC5yaWdodCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBhZGRpbmdSaWdodFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGluc2V0ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29udGFpbmVySW5zZXQ7XG4gICAgICAgIHZhciByaWdodCA9IGVkaXRhYmxlX3RleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29udGFpbmVySW5zZXQgPSB7IHRvcDogaW5zZXQudG9wLCBsZWZ0OiBpbnNldC5sZWZ0LCBib3R0b206IGluc2V0LmJvdHRvbSwgcmlnaHQ6IHJpZ2h0IH07XG4gICAgfTtcbiAgICBUZXh0Vmlldy5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0LmJvdHRvbSxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0O1xuICAgICAgICB2YXIgYm90dG9tID0gZWRpdGFibGVfdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbnRhaW5lckluc2V0ID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBib3R0b20sIHJpZ2h0OiBpbnNldC5yaWdodCB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0Q29udGFpbmVySW5zZXQubGVmdCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgVGV4dFZpZXcucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldDtcbiAgICAgICAgdmFyIGxlZnQgPSBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGgpO1xuICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb250YWluZXJJbnNldCA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVGV4dFZpZXcucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIFRleHRWaWV3ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGVkaXRhYmxlX3RleHRfYmFzZV8xLkNTU1R5cGUoXCJUZXh0Vmlld1wiKVxuICAgIF0sIFRleHRWaWV3KTtcbiAgICByZXR1cm4gVGV4dFZpZXc7XG59KGVkaXRhYmxlX3RleHRfYmFzZV8xLkVkaXRhYmxlVGV4dEJhc2UpKTtcbmV4cG9ydHMuVGV4dFZpZXcgPSBUZXh0VmlldztcblRleHRWaWV3LnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC12aWV3Lmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBkYXRlQ29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPD0geSAmJiB4ID49IHkpOyB9O1xuZnVuY3Rpb24gZ2V0VmFsaWRUaW1lKHBpY2tlciwgaG91ciwgbWludXRlKSB7XG4gICAgaWYgKHBpY2tlci5taW51dGVJbnRlcnZhbCA+IDEpIHtcbiAgICAgICAgdmFyIG1pbnV0ZUZsb29yID0gbWludXRlIC0gKG1pbnV0ZSAlIHBpY2tlci5taW51dGVJbnRlcnZhbCk7XG4gICAgICAgIG1pbnV0ZSA9IG1pbnV0ZUZsb29yICsgKG1pbnV0ZSA9PT0gbWludXRlRmxvb3IgKyAxID8gcGlja2VyLm1pbnV0ZUludGVydmFsIDogMCk7XG4gICAgICAgIGlmIChtaW51dGUgPT09IDYwKSB7XG4gICAgICAgICAgICBob3VyKys7XG4gICAgICAgICAgICBtaW51dGUgPSAwO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciB0aW1lID0geyBob3VyOiBob3VyLCBtaW51dGU6IG1pbnV0ZSB9O1xuICAgIGlmICghaXNMZXNzVGhhbk1heFRpbWUocGlja2VyLCBob3VyLCBtaW51dGUpKSB7XG4gICAgICAgIHRpbWUgPSB7IGhvdXI6IHBpY2tlci5tYXhIb3VyLCBtaW51dGU6IHBpY2tlci5tYXhNaW51dGUgfTtcbiAgICB9XG4gICAgaWYgKCFpc0dyZWF0ZXJUaGFuTWluVGltZShwaWNrZXIsIGhvdXIsIG1pbnV0ZSkpIHtcbiAgICAgICAgdGltZSA9IHsgaG91cjogcGlja2VyLm1pbkhvdXIsIG1pbnV0ZTogcGlja2VyLm1pbk1pbnV0ZSB9O1xuICAgIH1cbiAgICByZXR1cm4gdGltZTtcbn1cbmV4cG9ydHMuZ2V0VmFsaWRUaW1lID0gZ2V0VmFsaWRUaW1lO1xuZnVuY3Rpb24gaXNWYWxpZFRpbWUocGlja2VyKSB7XG4gICAgcmV0dXJuIGlzR3JlYXRlclRoYW5NaW5UaW1lKHBpY2tlcikgJiYgaXNMZXNzVGhhbk1heFRpbWUocGlja2VyKTtcbn1cbmZ1bmN0aW9uIGlzSG91clZhbGlkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiB2YWx1ZSA+PSAwICYmIHZhbHVlIDw9IDIzO1xufVxuZnVuY3Rpb24gaXNNaW51dGVWYWxpZCh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgdmFsdWUgPj0gMCAmJiB2YWx1ZSA8PSA1OTtcbn1cbmZ1bmN0aW9uIGlzTWludXRlSW50ZXJ2YWxWYWxpZCh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgJiYgdmFsdWUgPj0gMSAmJiB2YWx1ZSA8PSAzMCAmJiA2MCAlIHZhbHVlID09PSAwO1xufVxuZnVuY3Rpb24gZ2V0TWludXRlcyhob3VyKSB7XG4gICAgcmV0dXJuIGhvdXIgKiA2MDtcbn1cbmZ1bmN0aW9uIGlzRGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5pc0RlZmluZWQgPSBpc0RlZmluZWQ7XG5mdW5jdGlvbiBpc0dyZWF0ZXJUaGFuTWluVGltZShwaWNrZXIsIGhvdXIsIG1pbnV0ZSkge1xuICAgIGlmIChwaWNrZXIubWluSG91ciA9PT0gdW5kZWZpbmVkIHx8IHBpY2tlci5taW5NaW51dGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGdldE1pbnV0ZXMoaG91ciAhPT0gdW5kZWZpbmVkID8gaG91ciA6IHBpY2tlci5ob3VyKSArIChtaW51dGUgIT09IHVuZGVmaW5lZCA/IG1pbnV0ZSA6IHBpY2tlci5taW51dGUpID49IGdldE1pbnV0ZXMocGlja2VyLm1pbkhvdXIpICsgcGlja2VyLm1pbk1pbnV0ZTtcbn1cbmZ1bmN0aW9uIGlzTGVzc1RoYW5NYXhUaW1lKHBpY2tlciwgaG91ciwgbWludXRlKSB7XG4gICAgaWYgKCFpc0RlZmluZWQocGlja2VyLm1heEhvdXIpIHx8ICFpc0RlZmluZWQocGlja2VyLm1heE1pbnV0ZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBnZXRNaW51dGVzKGlzRGVmaW5lZChob3VyKSA/IGhvdXIgOiBwaWNrZXIuaG91cikgKyAoaXNEZWZpbmVkKG1pbnV0ZSkgPyBtaW51dGUgOiBwaWNrZXIubWludXRlKSA8PSBnZXRNaW51dGVzKHBpY2tlci5tYXhIb3VyKSArIHBpY2tlci5tYXhNaW51dGU7XG59XG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICsgXCJcIjtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlIDwgMTAgPyBcIjBcIiArIHZhbHVlIDogXCJcIiArIHZhbHVlO1xufVxuZnVuY3Rpb24gZ2V0TWluTWF4VGltZUVycm9yTWVzc2FnZShwaWNrZXIpIHtcbiAgICByZXR1cm4gXCJNaW4gdGltZTogKFwiICsgdG9TdHJpbmcocGlja2VyLm1pbkhvdXIpICsgXCI6XCIgKyB0b1N0cmluZyhwaWNrZXIubWluTWludXRlKSArIFwiKSwgbWF4IHRpbWU6IChcIiArIHRvU3RyaW5nKHBpY2tlci5tYXhIb3VyKSArIFwiOlwiICsgdG9TdHJpbmcocGlja2VyLm1heE1pbnV0ZSkgKyBcIilcIjtcbn1cbmZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZShwaWNrZXIsIHByb3BlcnR5TmFtZSwgbmV3VmFsdWUpIHtcbiAgICByZXR1cm4gcHJvcGVydHlOYW1lICsgXCIgcHJvcGVydHkgdmFsdWUgKFwiICsgdG9TdHJpbmcobmV3VmFsdWUpICsgXCI6XCIgKyB0b1N0cmluZyhwaWNrZXIubWludXRlKSArIFwiKSBpcyBub3QgdmFsaWQuIFwiICsgZ2V0TWluTWF4VGltZUVycm9yTWVzc2FnZShwaWNrZXIpICsgXCIuXCI7XG59XG52YXIgVGltZVBpY2tlckJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUaW1lUGlja2VyQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUaW1lUGlja2VyQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUaW1lUGlja2VyQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIlRpbWVQaWNrZXJcIilcbiAgICBdLCBUaW1lUGlja2VyQmFzZSk7XG4gICAgcmV0dXJuIFRpbWVQaWNrZXJCYXNlO1xufSh2aWV3XzEuVmlldykpO1xuZXhwb3J0cy5UaW1lUGlja2VyQmFzZSA9IFRpbWVQaWNrZXJCYXNlO1xuVGltZVBpY2tlckJhc2UucHJvdG90eXBlLnJlY3ljbGVOYXRpdmVWaWV3ID0gXCJhdXRvXCI7XG5leHBvcnRzLm1pbkhvdXJQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluSG91clwiLCBkZWZhdWx0VmFsdWU6IDAsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNIb3VyVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtaW5Ib3VyXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWluSG91clByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMubWF4SG91clByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtYXhIb3VyXCIsIGRlZmF1bHRWYWx1ZTogMjMsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNIb3VyVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtYXhIb3VyXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMubWF4SG91clByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMubWluTWludXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbk1pbnV0ZVwiLCBkZWZhdWx0VmFsdWU6IDAsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNNaW51dGVWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIm1pbk1pbnV0ZVwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1pbk1pbnV0ZVByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMubWF4TWludXRlUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1heE1pbnV0ZVwiLCBkZWZhdWx0VmFsdWU6IDU5LCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uIChwaWNrZXIsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAoIWlzTWludXRlVmFsaWQobmV3VmFsdWUpIHx8ICFpc1ZhbGlkVGltZShwaWNrZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtYXhNaW51dGVcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VJbnQodik7IH1cbn0pO1xuZXhwb3J0cy5tYXhNaW51dGVQcm9wZXJ0eS5yZWdpc3RlcihUaW1lUGlja2VyQmFzZSk7XG5leHBvcnRzLm1pbnV0ZUludGVydmFsUHJvcGVydHkgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbnV0ZUludGVydmFsXCIsIGRlZmF1bHRWYWx1ZTogMSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc01pbnV0ZUludGVydmFsVmFsaWQobmV3VmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0RXJyb3JNZXNzYWdlKHBpY2tlciwgXCJtaW51dGVJbnRlcnZhbFwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1pbnV0ZUludGVydmFsUHJvcGVydHkucmVnaXN0ZXIoVGltZVBpY2tlckJhc2UpO1xuZXhwb3J0cy5taW51dGVQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWludXRlXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc01pbnV0ZVZhbGlkKG5ld1ZhbHVlKSB8fCAhaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwibWludXRlXCIsIG5ld1ZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcGlja2VyLnRpbWUgPSBuZXcgRGF0ZSgwLCAwLCAwLCBwaWNrZXIuaG91ciwgcGlja2VyLm1pbnV0ZSk7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUludCh2KTsgfVxufSk7XG5leHBvcnRzLm1pbnV0ZVByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMuaG91clByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJob3VyXCIsIGRlZmF1bHRWYWx1ZTogMCwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAocGlja2VyLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0hvdXJWYWxpZChuZXdWYWx1ZSkgfHwgIWlzVmFsaWRUaW1lKHBpY2tlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnZXRFcnJvck1lc3NhZ2UocGlja2VyLCBcIkhvdXJcIiwgbmV3VmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBwaWNrZXIudGltZSA9IG5ldyBEYXRlKDAsIDAsIDAsIHBpY2tlci5ob3VyLCBwaWNrZXIubWludXRlKTtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlSW50KHYpOyB9XG59KTtcbmV4cG9ydHMuaG91clByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbmV4cG9ydHMudGltZVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ0aW1lXCIsIGRlZmF1bHRWYWx1ZTogbmV3IERhdGUoKSwgZXF1YWxpdHlDb21wYXJlcjogZGF0ZUNvbXBhcmVyLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHBpY2tlciwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICghaXNWYWxpZFRpbWUocGlja2VyKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGdldEVycm9yTWVzc2FnZShwaWNrZXIsIFwidGltZVwiLCBuZXdWYWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIHBpY2tlci5ob3VyID0gbmV3VmFsdWUuZ2V0SG91cnMoKTtcbiAgICAgICAgcGlja2VyLm1pbnV0ZSA9IG5ld1ZhbHVlLmdldE1pbnV0ZXMoKTtcbiAgICB9XG59KTtcbmV4cG9ydHMudGltZVByb3BlcnR5LnJlZ2lzdGVyKFRpbWVQaWNrZXJCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRpbWUtcGlja2VyLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRpbWVfcGlja2VyX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGltZS1waWNrZXItY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdGltZS1waWNrZXItY29tbW9uXCIpKTtcbmZ1bmN0aW9uIGdldERhdGUoaG91ciwgbWludXRlKSB7XG4gICAgdmFyIGNvbXBvbmVudHMgPSBOU0RhdGVDb21wb25lbnRzLmFsbG9jKCkuaW5pdCgpO1xuICAgIGNvbXBvbmVudHMuaG91ciA9IGhvdXI7XG4gICAgY29tcG9uZW50cy5taW51dGUgPSBtaW51dGU7XG4gICAgcmV0dXJuIE5TQ2FsZW5kYXIuY3VycmVudENhbGVuZGFyLmRhdGVGcm9tQ29tcG9uZW50cyhjb21wb25lbnRzKTtcbn1cbmZ1bmN0aW9uIGdldENvbXBvbmVudHMoZGF0ZSkge1xuICAgIHJldHVybiBOU0NhbGVuZGFyLmN1cnJlbnRDYWxlbmRhci5jb21wb25lbnRzRnJvbURhdGUoMzIgfCA2NCwgZGF0ZSk7XG59XG52YXIgVGltZVBpY2tlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRpbWVQaWNrZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGltZVBpY2tlcigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgdmFyIGNvbXBvbmVudHMgPSBnZXRDb21wb25lbnRzKE5TRGF0ZS5kYXRlKCkpO1xuICAgICAgICBfdGhpcy5ob3VyID0gY29tcG9uZW50cy5ob3VyO1xuICAgICAgICBfdGhpcy5taW51dGUgPSBjb21wb25lbnRzLm1pbnV0ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGlja2VyID0gVUlEYXRlUGlja2VyLm5ldygpO1xuICAgICAgICBwaWNrZXIuZGF0ZVBpY2tlck1vZGUgPSAwO1xuICAgICAgICByZXR1cm4gcGlja2VyO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fY2hhbmdlSGFuZGxlciA9IFVJVGltZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYodGhpcykpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkVGFyZ2V0QWN0aW9uRm9yQ29udHJvbEV2ZW50cyh0aGlzLl9jaGFuZ2VIYW5kbGVyLCBcInZhbHVlQ2hhbmdlZFwiLCA0MDk2KTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jaGFuZ2VIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpbWVQaWNrZXIucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEudGltZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmRhdGU7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS50aW1lUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuZGF0ZSA9IGdldERhdGUodGhpcy5ob3VyLCB0aGlzLm1pbnV0ZSk7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5taW51dGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5kYXRlLmdldE1pbnV0ZXMoKTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1pbnV0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmRhdGUgPSBnZXREYXRlKHRoaXMuaG91ciwgdmFsdWUpO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEuaG91clByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmRhdGUuZ2V0SG91cnMoKTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLmhvdXJQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5kYXRlID0gZ2V0RGF0ZSh2YWx1ZSwgdGhpcy5taW51dGUpO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEubWluSG91clByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbmltdW1EYXRlID8gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbmltdW1EYXRlLmdldEhvdXJzKCkgOiAwO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEubWluSG91clByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbmltdW1EYXRlID0gZ2V0RGF0ZSh2YWx1ZSwgdGhpcy5taW51dGUpO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEubWF4SG91clByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1heGltdW1EYXRlID8gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1heGltdW1EYXRlLmdldEhvdXJzKCkgOiAyNDtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1heEhvdXJQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5tYXhpbXVtRGF0ZSA9IGdldERhdGUodmFsdWUsIHRoaXMubWludXRlKTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1pbk1pbnV0ZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbmltdW1EYXRlID8gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbmltdW1EYXRlLmdldE1pbnV0ZXMoKSA6IDA7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5taW5NaW51dGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5taW5pbXVtRGF0ZSA9IGdldERhdGUodGhpcy5ob3VyLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5tYXhNaW51dGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5tYXhpbXVtRGF0ZSA/IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5tYXhpbXVtRGF0ZS5nZXRNaW51dGVzKCkgOiA2MDtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1heE1pbnV0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1heGltdW1EYXRlID0gZ2V0RGF0ZSh0aGlzLmhvdXIsIHZhbHVlKTtcbiAgICB9O1xuICAgIFRpbWVQaWNrZXIucHJvdG90eXBlW3RpbWVfcGlja2VyX2NvbW1vbl8xLm1pbnV0ZUludGVydmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubWludXRlSW50ZXJ2YWw7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5taW51dGVJbnRlcnZhbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLm1pbnV0ZUludGVydmFsID0gdmFsdWU7XG4gICAgfTtcbiAgICBUaW1lUGlja2VyLnByb3RvdHlwZVt0aW1lX3BpY2tlcl9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnZhbHVlRm9yS2V5KFwidGV4dENvbG9yXCIpO1xuICAgIH07XG4gICAgVGltZVBpY2tlci5wcm90b3R5cGVbdGltZV9waWNrZXJfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGltZV9waWNrZXJfY29tbW9uXzEuQ29sb3IgPyB2YWx1ZS5pb3MgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnNldFZhbHVlRm9yS2V5KGNvbG9yLCBcInRleHRDb2xvclwiKTtcbiAgICB9O1xuICAgIHJldHVybiBUaW1lUGlja2VyO1xufSh0aW1lX3BpY2tlcl9jb21tb25fMS5UaW1lUGlja2VyQmFzZSkpO1xuZXhwb3J0cy5UaW1lUGlja2VyID0gVGltZVBpY2tlcjtcbnZhciBVSVRpbWVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJVGltZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJVGltZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGltZVBpY2tlckNoYW5nZUhhbmRsZXJJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBVSVRpbWVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbC5uZXcoKTtcbiAgICAgICAgaGFuZGxlci5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGhhbmRsZXI7XG4gICAgfTtcbiAgICBVSVRpbWVQaWNrZXJDaGFuZ2VIYW5kbGVySW1wbC5wcm90b3R5cGUudmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gKHNlbmRlcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKCFvd25lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb21wb25lbnRzID0gZ2V0Q29tcG9uZW50cyhzZW5kZXIuZGF0ZSk7XG4gICAgICAgIHZhciB0aW1lQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBpZiAoY29tcG9uZW50cy5ob3VyICE9PSBvd25lci5ob3VyKSB7XG4gICAgICAgICAgICB0aW1lX3BpY2tlcl9jb21tb25fMS5ob3VyUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIGNvbXBvbmVudHMuaG91cik7XG4gICAgICAgICAgICB0aW1lQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBvbmVudHMubWludXRlICE9PSBvd25lci5taW51dGUpIHtcbiAgICAgICAgICAgIHRpbWVfcGlja2VyX2NvbW1vbl8xLm1pbnV0ZVByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBjb21wb25lbnRzLm1pbnV0ZSk7XG4gICAgICAgICAgICB0aW1lQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRpbWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aW1lX3BpY2tlcl9jb21tb25fMS50aW1lUHJvcGVydHkubmF0aXZlVmFsdWVDaGFuZ2Uob3duZXIsIG5ldyBEYXRlKDAsIDAsIDAsIGNvbXBvbmVudHMuaG91ciwgY29tcG9uZW50cy5taW51dGUpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVUlUaW1lUGlja2VyQ2hhbmdlSGFuZGxlckltcGwuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcInZhbHVlQ2hhbmdlZFwiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbVUlEYXRlUGlja2VyXSB9XG4gICAgfTtcbiAgICByZXR1cm4gVUlUaW1lUGlja2VyQ2hhbmdlSGFuZGxlckltcGw7XG59KE5TT2JqZWN0KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10aW1lLXBpY2tlci5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuL3RyYW5zaXRpb25cIik7XG52YXIgRmFkZVRyYW5zaXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGYWRlVHJhbnNpdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGYWRlVHJhbnNpdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBGYWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuYW5pbWF0ZUlPU1RyYW5zaXRpb24gPSBmdW5jdGlvbiAoY29udGFpbmVyVmlldywgZnJvbVZpZXcsIHRvVmlldywgb3BlcmF0aW9uLCBjb21wbGV0aW9uKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbFRvVmlld0FscGhhID0gdG9WaWV3LmFscGhhO1xuICAgICAgICB2YXIgb3JpZ2luYWxGcm9tVmlld0FscGhhID0gZnJvbVZpZXcuYWxwaGE7XG4gICAgICAgIHRvVmlldy5hbHBoYSA9IDAuMDtcbiAgICAgICAgZnJvbVZpZXcuYWxwaGEgPSAxLjA7XG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgY29udGFpbmVyVmlldy5pbnNlcnRTdWJ2aWV3QWJvdmVTdWJ2aWV3KHRvVmlldywgZnJvbVZpZXcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGNvbnRhaW5lclZpZXcuaW5zZXJ0U3Vidmlld0JlbG93U3Vidmlldyh0b1ZpZXcsIGZyb21WaWV3KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCk7XG4gICAgICAgIHZhciBjdXJ2ZSA9IHRoaXMuZ2V0Q3VydmUoKTtcbiAgICAgICAgVUlWaWV3LmFuaW1hdGVXaXRoRHVyYXRpb25BbmltYXRpb25zQ29tcGxldGlvbihkdXJhdGlvbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgVUlWaWV3LnNldEFuaW1hdGlvbkN1cnZlKGN1cnZlKTtcbiAgICAgICAgICAgIHRvVmlldy5hbHBoYSA9IDEuMDtcbiAgICAgICAgICAgIGZyb21WaWV3LmFscGhhID0gMC4wO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZmluaXNoZWQpIHtcbiAgICAgICAgICAgIHRvVmlldy5hbHBoYSA9IG9yaWdpbmFsVG9WaWV3QWxwaGE7XG4gICAgICAgICAgICBmcm9tVmlldy5hbHBoYSA9IG9yaWdpbmFsRnJvbVZpZXdBbHBoYTtcbiAgICAgICAgICAgIGNvbXBsZXRpb24oZmluaXNoZWQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBGYWRlVHJhbnNpdGlvbjtcbn0odHJhbnNpdGlvbl8xLlRyYW5zaXRpb24pKTtcbmV4cG9ydHMuRmFkZVRyYW5zaXRpb24gPSBGYWRlVHJhbnNpdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZhZGUtdHJhbnNpdGlvbi5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuL3RyYW5zaXRpb25cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBzY3JlZW5XaWR0aCA9IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4ud2lkdGhESVBzO1xudmFyIHNjcmVlbkhlaWdodCA9IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4uaGVpZ2h0RElQcztcbnZhciBsZWZ0RWRnZSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZVRyYW5zbGF0aW9uKC1zY3JlZW5XaWR0aCwgMCk7XG52YXIgcmlnaHRFZGdlID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlVHJhbnNsYXRpb24oc2NyZWVuV2lkdGgsIDApO1xudmFyIHRvcEVkZ2UgPSBDR0FmZmluZVRyYW5zZm9ybU1ha2VUcmFuc2xhdGlvbigwLCAtc2NyZWVuSGVpZ2h0KTtcbnZhciBib3R0b21FZGdlID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlVHJhbnNsYXRpb24oMCwgc2NyZWVuSGVpZ2h0KTtcbnZhciBTbGlkZVRyYW5zaXRpb24gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTbGlkZVRyYW5zaXRpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2xpZGVUcmFuc2l0aW9uKGRpcmVjdGlvbiwgZHVyYXRpb24sIGN1cnZlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGR1cmF0aW9uLCBjdXJ2ZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2RpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTbGlkZVRyYW5zaXRpb24ucHJvdG90eXBlLmFuaW1hdGVJT1NUcmFuc2l0aW9uID0gZnVuY3Rpb24gKGNvbnRhaW5lclZpZXcsIGZyb21WaWV3LCB0b1ZpZXcsIG9wZXJhdGlvbiwgY29tcGxldGlvbikge1xuICAgICAgICB2YXIgb3JpZ2luYWxUb1ZpZXdUcmFuc2Zvcm0gPSB0b1ZpZXcudHJhbnNmb3JtO1xuICAgICAgICB2YXIgb3JpZ2luYWxGcm9tVmlld1RyYW5zZm9ybSA9IGZyb21WaWV3LnRyYW5zZm9ybTtcbiAgICAgICAgdmFyIGZyb21WaWV3RW5kVHJhbnNmb3JtO1xuICAgICAgICB2YXIgdG9WaWV3QmVnaW5UcmFuc2Zvcm07XG4gICAgICAgIHZhciBwdXNoID0gKG9wZXJhdGlvbiA9PT0gMSk7XG4gICAgICAgIHN3aXRjaCAodGhpcy5fZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICAgICAgICAgIHRvVmlld0JlZ2luVHJhbnNmb3JtID0gcHVzaCA/IHJpZ2h0RWRnZSA6IGxlZnRFZGdlO1xuICAgICAgICAgICAgICAgIGZyb21WaWV3RW5kVHJhbnNmb3JtID0gcHVzaCA/IGxlZnRFZGdlIDogcmlnaHRFZGdlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgdG9WaWV3QmVnaW5UcmFuc2Zvcm0gPSBwdXNoID8gbGVmdEVkZ2UgOiByaWdodEVkZ2U7XG4gICAgICAgICAgICAgICAgZnJvbVZpZXdFbmRUcmFuc2Zvcm0gPSBwdXNoID8gcmlnaHRFZGdlIDogbGVmdEVkZ2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidG9wXCI6XG4gICAgICAgICAgICAgICAgdG9WaWV3QmVnaW5UcmFuc2Zvcm0gPSBwdXNoID8gYm90dG9tRWRnZSA6IHRvcEVkZ2U7XG4gICAgICAgICAgICAgICAgZnJvbVZpZXdFbmRUcmFuc2Zvcm0gPSBwdXNoID8gdG9wRWRnZSA6IGJvdHRvbUVkZ2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICAgICAgdG9WaWV3QmVnaW5UcmFuc2Zvcm0gPSBwdXNoID8gdG9wRWRnZSA6IGJvdHRvbUVkZ2U7XG4gICAgICAgICAgICAgICAgZnJvbVZpZXdFbmRUcmFuc2Zvcm0gPSBwdXNoID8gYm90dG9tRWRnZSA6IHRvcEVkZ2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdG9WaWV3LnRyYW5zZm9ybSA9IHRvVmlld0JlZ2luVHJhbnNmb3JtO1xuICAgICAgICBmcm9tVmlldy50cmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybUlkZW50aXR5O1xuICAgICAgICBzd2l0Y2ggKG9wZXJhdGlvbikge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIGNvbnRhaW5lclZpZXcuaW5zZXJ0U3Vidmlld0Fib3ZlU3Vidmlldyh0b1ZpZXcsIGZyb21WaWV3KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBjb250YWluZXJWaWV3Lmluc2VydFN1YnZpZXdCZWxvd1N1YnZpZXcodG9WaWV3LCBmcm9tVmlldyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5nZXREdXJhdGlvbigpO1xuICAgICAgICB2YXIgY3VydmUgPSB0aGlzLmdldEN1cnZlKCk7XG4gICAgICAgIFVJVmlldy5hbmltYXRlV2l0aER1cmF0aW9uQW5pbWF0aW9uc0NvbXBsZXRpb24oZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIFVJVmlldy5zZXRBbmltYXRpb25DdXJ2ZShjdXJ2ZSk7XG4gICAgICAgICAgICB0b1ZpZXcudHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eTtcbiAgICAgICAgICAgIGZyb21WaWV3LnRyYW5zZm9ybSA9IGZyb21WaWV3RW5kVHJhbnNmb3JtO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZmluaXNoZWQpIHtcbiAgICAgICAgICAgIHRvVmlldy50cmFuc2Zvcm0gPSBvcmlnaW5hbFRvVmlld1RyYW5zZm9ybTtcbiAgICAgICAgICAgIGZyb21WaWV3LnRyYW5zZm9ybSA9IG9yaWdpbmFsRnJvbVZpZXdUcmFuc2Zvcm07XG4gICAgICAgICAgICBjb21wbGV0aW9uKGZpbmlzaGVkKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU2xpZGVUcmFuc2l0aW9uO1xufSh0cmFuc2l0aW9uXzEuVHJhbnNpdGlvbikpO1xuZXhwb3J0cy5TbGlkZVRyYW5zaXRpb24gPSBTbGlkZVRyYW5zaXRpb247XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zbGlkZS10cmFuc2l0aW9uLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHJhbnNpdGlvbklkID0gMDtcbnZhciBUcmFuc2l0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUcmFuc2l0aW9uKGR1cmF0aW9uLCBjdXJ2ZSkge1xuICAgICAgICBpZiAoY3VydmUgPT09IHZvaWQgMCkgeyBjdXJ2ZSA9IDA7IH1cbiAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBkdXJhdGlvbiA/IChkdXJhdGlvbiAvIDEwMDApIDogMC4zNTtcbiAgICAgICAgdGhpcy5fY3VydmUgPSBjdXJ2ZTtcbiAgICAgICAgdGhpcy5faWQgPSB0cmFuc2l0aW9uSWQrKztcbiAgICB9XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuZ2V0RHVyYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kdXJhdGlvbjtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmdldEN1cnZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY3VydmU7XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5hbmltYXRlSU9TVHJhbnNpdGlvbiA9IGZ1bmN0aW9uIChjb250YWluZXJWaWV3LCBmcm9tVmlldywgdG9WaWV3LCBvcGVyYXRpb24sIGNvbXBsZXRpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWJzdHJhY3QgbWV0aG9kIGNhbGxcIik7XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5jcmVhdGVBbmRyb2lkQW5pbWF0b3IgPSBmdW5jdGlvbiAodHJhbnNpdGlvblR5cGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQWJzdHJhY3QgbWV0aG9kIGNhbGxcIik7XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiVHJhbnNpdGlvbkBcIiArIHRoaXMuX2lkO1xuICAgIH07XG4gICAgcmV0dXJuIFRyYW5zaXRpb247XG59KCkpO1xuZXhwb3J0cy5UcmFuc2l0aW9uID0gVHJhbnNpdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRyYW5zaXRpb24uaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuZXhwb3J0cy5GaWxlID0gZmlsZV9zeXN0ZW1fMS5GaWxlO1xuZXhwb3J0cy5rbm93bkZvbGRlcnMgPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycztcbmV4cG9ydHMucGF0aCA9IGZpbGVfc3lzdGVtXzEucGF0aDtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIikpO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcInNyY1wiIH0pO1xudmFyIFdlYlZpZXdCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV2ViVmlld0Jhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gV2ViVmlld0Jhc2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV2ViVmlld0Jhc2VfMSA9IFdlYlZpZXdCYXNlO1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZS5fb25Mb2FkRmluaXNoZWQgPSBmdW5jdGlvbiAodXJsLCBlcnJvcikge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogV2ViVmlld0Jhc2VfMS5sb2FkRmluaXNoZWRFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGVycm9yOiBlcnJvclxuICAgICAgICB9O1xuICAgICAgICB0aGlzLm5vdGlmeShhcmdzKTtcbiAgICB9O1xuICAgIFdlYlZpZXdCYXNlLnByb3RvdHlwZS5fb25Mb2FkU3RhcnRlZCA9IGZ1bmN0aW9uICh1cmwsIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBXZWJWaWV3QmFzZV8xLmxvYWRTdGFydGVkRXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG5hdmlnYXRpb25UeXBlOiBuYXZpZ2F0aW9uVHlwZSxcbiAgICAgICAgICAgIGVycm9yOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlld0Jhc2UucHJvdG90eXBlLCBcImNhbkdvQmFja1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBtZW1iZXIgaXMgYWJzdHJhY3QuXCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlld0Jhc2UucHJvdG90eXBlLCBcImNhbkdvRm9yd2FyZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBtZW1iZXIgaXMgYWJzdHJhY3QuXCIpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBXZWJWaWV3QmFzZS5wcm90b3R5cGVbZXhwb3J0cy5zcmNQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICBXZWJWaWV3QmFzZS5wcm90b3R5cGVbZXhwb3J0cy5zcmNQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHNyYykge1xuICAgICAgICB0aGlzLnN0b3BMb2FkaW5nKCk7XG4gICAgICAgIGlmIChzcmMuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgICAgICBzcmMgPSBcImZpbGU6Ly8vXCIgKyBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCArIFwiL1wiICsgc3JjLnN1YnN0cigyKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzcmMuaW5kZXhPZihcIi9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHNyYyA9IFwiZmlsZTovL1wiICsgc3JjO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiZmlsZTovLy9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHNyYyA9IGVuY29kZVVSSShzcmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiaHR0cDovL1wiKSA9PT0gMCB8fFxuICAgICAgICAgICAgc3JjLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcImh0dHBzOi8vXCIpID09PSAwIHx8XG4gICAgICAgICAgICBzcmMudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwiZmlsZTovLy9cIikgPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRVcmwoc3JjKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWREYXRhKHNyYyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBXZWJWaWV3QmFzZV8xO1xuICAgIFdlYlZpZXdCYXNlLmxvYWRTdGFydGVkRXZlbnQgPSBcImxvYWRTdGFydGVkXCI7XG4gICAgV2ViVmlld0Jhc2UubG9hZEZpbmlzaGVkRXZlbnQgPSBcImxvYWRGaW5pc2hlZFwiO1xuICAgIFdlYlZpZXdCYXNlID0gV2ViVmlld0Jhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIldlYlZpZXdcIilcbiAgICBdLCBXZWJWaWV3QmFzZSk7XG4gICAgcmV0dXJuIFdlYlZpZXdCYXNlO1xufSh2aWV3XzEuQ29udGFpbmVyVmlldykpO1xuZXhwb3J0cy5XZWJWaWV3QmFzZSA9IFdlYlZpZXdCYXNlO1xuZXhwb3J0cy5zcmNQcm9wZXJ0eS5yZWdpc3RlcihXZWJWaWV3QmFzZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD13ZWItdmlldy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB3ZWJfdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3dlYi12aWV3LWNvbW1vblwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi93ZWItdmlldy1jb21tb25cIikpO1xudmFyIFdLTmF2aWdhdGlvbkRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFdLTmF2aWdhdGlvbkRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXS05hdmlnYXRpb25EZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBXS05hdmlnYXRpb25EZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS53ZWJWaWV3RGVjaWRlUG9saWN5Rm9yTmF2aWdhdGlvbkFjdGlvbkRlY2lzaW9uSGFuZGxlciA9IGZ1bmN0aW9uICh3ZWJWaWV3LCBuYXZpZ2F0aW9uQWN0aW9uLCBkZWNpc2lvbkhhbmRsZXIpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lciAmJiBuYXZpZ2F0aW9uQWN0aW9uLnJlcXVlc3QuVVJMKSB7XG4gICAgICAgICAgICB2YXIgbmF2VHlwZSA9IFwib3RoZXJcIjtcbiAgICAgICAgICAgIHN3aXRjaCAobmF2aWdhdGlvbkFjdGlvbi5uYXZpZ2F0aW9uVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgbmF2VHlwZSA9IFwibGlua0NsaWNrZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBuYXZUeXBlID0gXCJmb3JtU3VibWl0dGVkXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgbmF2VHlwZSA9IFwiYmFja0ZvcndhcmRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBuYXZUeXBlID0gXCJyZWxvYWRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICBuYXZUeXBlID0gXCJmb3JtUmVzdWJtaXR0ZWRcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZWNpc2lvbkhhbmRsZXIoMSk7XG4gICAgICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV0tOYXZpZ2F0aW9uRGVsZWdhdGVDbGFzcy53ZWJWaWV3RGVjaWRlUG9saWN5Rm9yTmF2aWdhdGlvbkFjdGlvbkRlY2lzaW9uSGFuZGxlcihcIiArIG5hdmlnYXRpb25BY3Rpb24ucmVxdWVzdC5VUkwuYWJzb2x1dGVTdHJpbmcgKyBcIiwgXCIgKyBuYXZpZ2F0aW9uQWN0aW9uLm5hdmlnYXRpb25UeXBlICsgXCIpXCIsIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5fb25Mb2FkU3RhcnRlZChuYXZpZ2F0aW9uQWN0aW9uLnJlcXVlc3QuVVJMLmFic29sdXRlU3RyaW5nLCBuYXZUeXBlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS53ZWJWaWV3RGlkU3RhcnRQcm92aXNpb25hbE5hdmlnYXRpb24gPSBmdW5jdGlvbiAod2ViVmlldywgbmF2aWdhdGlvbikge1xuICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJXS05hdmlnYXRpb25EZWxlZ2F0ZUNsYXNzLndlYlZpZXdEaWRTdGFydFByb3Zpc2lvbmFsTmF2aWdhdGlvbihcIiArIHdlYlZpZXcuVVJMICsgXCIpXCIsIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFdLTmF2aWdhdGlvbkRlbGVnYXRlSW1wbC5wcm90b3R5cGUud2ViVmlld0RpZEZpbmlzaE5hdmlnYXRpb24gPSBmdW5jdGlvbiAod2ViVmlldywgbmF2aWdhdGlvbikge1xuICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJXS05hdmlnYXRpb25EZWxlZ2F0ZUNsYXNzLndlYlZpZXdEaWRGaW5pc2hOYXZpZ2F0aW9uKFwiICsgd2ViVmlldy5VUkwgKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgc3JjID0gb3duZXIuc3JjO1xuICAgICAgICAgICAgaWYgKHdlYlZpZXcuVVJMKSB7XG4gICAgICAgICAgICAgICAgc3JjID0gd2ViVmlldy5VUkwuYWJzb2x1dGVTdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5fb25Mb2FkRmluaXNoZWQoc3JjKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS53ZWJWaWV3RGlkRmFpbE5hdmlnYXRpb25XaXRoRXJyb3IgPSBmdW5jdGlvbiAod2ViVmlldywgbmF2aWdhdGlvbiwgZXJyb3IpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgdmFyIHNyYyA9IG93bmVyLnNyYztcbiAgICAgICAgICAgIGlmICh3ZWJWaWV3LlVSTCkge1xuICAgICAgICAgICAgICAgIHNyYyA9IHdlYlZpZXcuVVJMLmFic29sdXRlU3RyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIldLTmF2aWdhdGlvbkRlbGVnYXRlQ2xhc3Mud2ViVmlld0RpZEZhaWxOYXZpZ2F0aW9uV2l0aEVycm9yKFwiICsgZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24gKyBcIilcIiwgd2ViX3ZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkRlYnVnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG93bmVyLl9vbkxvYWRGaW5pc2hlZChzcmMsIGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS53ZWJWaWV3RGlkRmFpbFByb3Zpc2lvbmFsTmF2aWdhdGlvbldpdGhFcnJvciA9IGZ1bmN0aW9uICh3ZWJWaWV3LCBuYXZpZ2F0aW9uLCBlcnJvcikge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgc3JjID0gb3duZXIuc3JjO1xuICAgICAgICAgICAgaWYgKHdlYlZpZXcuVVJMKSB7XG4gICAgICAgICAgICAgICAgc3JjID0gd2ViVmlldy5VUkwuYWJzb2x1dGVTdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAod2ViX3ZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB3ZWJfdmlld19jb21tb25fMS50cmFjZVdyaXRlKFwiV0tOYXZpZ2F0aW9uRGVsZWdhdGVDbGFzcy53ZWJWaWV3RGlkRmFpbFByb3Zpc2lvbmFsTmF2aWdhdGlvbldpdGhFcnJvcihcIiArIGVycm9yLmxvY2FsaXplZERlc2NyaXB0aW9uICsgXCIpXCIsIHdlYl92aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5EZWJ1Zyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvd25lci5fb25Mb2FkRmluaXNoZWQoc3JjLCBlcnJvci5sb2NhbGl6ZWREZXNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFdLTmF2aWdhdGlvbkRlbGVnYXRlSW1wbC5PYmpDUHJvdG9jb2xzID0gW1dLTmF2aWdhdGlvbkRlbGVnYXRlXTtcbiAgICByZXR1cm4gV0tOYXZpZ2F0aW9uRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIFdlYlZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhXZWJWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFdlYlZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgV2ViVmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGpTY3JpcHQgPSBcInZhciBtZXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpOyBtZXRhLnNldEF0dHJpYnV0ZSgnbmFtZScsICd2aWV3cG9ydCcpOyBtZXRhLnNldEF0dHJpYnV0ZSgnY29udGVudCcsICdpbml0aWFsLXNjYWxlPTEuMCcpOyBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKG1ldGEpO1wiO1xuICAgICAgICB2YXIgd2tVU2NyaXB0ID0gV0tVc2VyU2NyaXB0LmFsbG9jKCkuaW5pdFdpdGhTb3VyY2VJbmplY3Rpb25UaW1lRm9yTWFpbkZyYW1lT25seShqU2NyaXB0LCAxLCB0cnVlKTtcbiAgICAgICAgdmFyIHdrVUNvbnRyb2xsZXIgPSBXS1VzZXJDb250ZW50Q29udHJvbGxlci5uZXcoKTtcbiAgICAgICAgd2tVQ29udHJvbGxlci5hZGRVc2VyU2NyaXB0KHdrVVNjcmlwdCk7XG4gICAgICAgIHZhciBjb25maWd1cmF0aW9uID0gV0tXZWJWaWV3Q29uZmlndXJhdGlvbi5uZXcoKTtcbiAgICAgICAgY29uZmlndXJhdGlvbi51c2VyQ29udGVudENvbnRyb2xsZXIgPSB3a1VDb250cm9sbGVyO1xuICAgICAgICBjb25maWd1cmF0aW9uLnByZWZlcmVuY2VzLnNldFZhbHVlRm9yS2V5KHRydWUsIFwiYWxsb3dGaWxlQWNjZXNzRnJvbUZpbGVVUkxzXCIpO1xuICAgICAgICByZXR1cm4gbmV3IFdLV2ViVmlldyh7XG4gICAgICAgICAgICBmcmFtZTogQ0dSZWN0WmVybyxcbiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb246IGNvbmZpZ3VyYXRpb25cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5pbml0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5pbml0TmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IFdLTmF2aWdhdGlvbkRlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uTG9hZGVkLmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuaW9zLm5hdmlnYXRpb25EZWxlZ2F0ZSA9IHRoaXMuX2RlbGVnYXRlO1xuICAgIH07XG4gICAgV2ViVmlldy5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pb3MubmF2aWdhdGlvbkRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vblVubG9hZGVkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViVmlldy5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5zdG9wTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pb3Muc3RvcExvYWRpbmcoKTtcbiAgICB9O1xuICAgIFdlYlZpZXcucHJvdG90eXBlLl9sb2FkVXJsID0gZnVuY3Rpb24gKHNyYykge1xuICAgICAgICBpZiAoc3JjLnN0YXJ0c1dpdGgoXCJmaWxlOi8vL1wiKSkge1xuICAgICAgICAgICAgdmFyIGNhY2hlUGF0aCA9IHNyYy5zdWJzdHJpbmcoMCwgc3JjLmxhc3RJbmRleE9mKFwiL1wiKSk7XG4gICAgICAgICAgICB0aGlzLmlvcy5sb2FkRmlsZVVSTEFsbG93aW5nUmVhZEFjY2Vzc1RvVVJMKE5TVVJMLlVSTFdpdGhTdHJpbmcoc3JjKSwgTlNVUkwuVVJMV2l0aFN0cmluZyhjYWNoZVBhdGgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW9zLmxvYWRSZXF1ZXN0KE5TVVJMUmVxdWVzdC5yZXF1ZXN0V2l0aFVSTChOU1VSTC5VUkxXaXRoU3RyaW5nKHNyYykpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgV2ViVmlldy5wcm90b3R5cGUuX2xvYWREYXRhID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgdGhpcy5pb3MubG9hZEhUTUxTdHJpbmdCYXNlVVJMKGNvbnRlbnQsIE5TVVJMLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmcoXCJmaWxlOi8vL1wiICsgd2ViX3ZpZXdfY29tbW9uXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoICsgXCIvXCIpKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJWaWV3LnByb3RvdHlwZSwgXCJjYW5Hb0JhY2tcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5jYW5Hb0JhY2s7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShXZWJWaWV3LnByb3RvdHlwZSwgXCJjYW5Hb0ZvcndhcmRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5jYW5Hb0ZvcndhcmQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFdlYlZpZXcucHJvdG90eXBlLmdvQmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pb3MuZ29CYWNrKCk7XG4gICAgfTtcbiAgICBXZWJWaWV3LnByb3RvdHlwZS5nb0ZvcndhcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaW9zLmdvRm9yd2FyZCgpO1xuICAgIH07XG4gICAgV2ViVmlldy5wcm90b3R5cGUucmVsb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlvcy5yZWxvYWQoKTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgV2ViVmlldy5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFdlYlZpZXc7XG59KHdlYl92aWV3X2NvbW1vbl8xLldlYlZpZXdCYXNlKSk7XG5leHBvcnRzLldlYlZpZXcgPSBXZWJWaWV3O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9d2ViLXZpZXcuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmaWxlX3N5c3RlbV8xID0gcmVxdWlyZShcIi4uL2ZpbGUtc3lzdGVtXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vcGxhdGZvcm1cIik7XG5leHBvcnRzLmRlYnVnID0gdHJ1ZTtcbnZhciBhcHBsaWNhdGlvblJvb3RQYXRoO1xuZnVuY3Rpb24gZW5zdXJlQXBwUm9vdFBhdGgoKSB7XG4gICAgaWYgKCFhcHBsaWNhdGlvblJvb3RQYXRoKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uUm9vdFBhdGggPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICAgICAgYXBwbGljYXRpb25Sb290UGF0aCA9IGFwcGxpY2F0aW9uUm9vdFBhdGguc3Vic3RyKDAsIGFwcGxpY2F0aW9uUm9vdFBhdGgubGVuZ3RoIC0gXCJhcHAvXCIubGVuZ3RoKTtcbiAgICB9XG59XG52YXIgU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTb3VyY2UodXJpLCBsaW5lLCBjb2x1bW4pIHtcbiAgICAgICAgZW5zdXJlQXBwUm9vdFBhdGgoKTtcbiAgICAgICAgaWYgKHVyaS5sZW5ndGggPiBhcHBsaWNhdGlvblJvb3RQYXRoLmxlbmd0aCAmJiB1cmkuc3Vic3RyKDAsIGFwcGxpY2F0aW9uUm9vdFBhdGgubGVuZ3RoKSA9PT0gYXBwbGljYXRpb25Sb290UGF0aCkge1xuICAgICAgICAgICAgdGhpcy5fdXJpID0gXCJmaWxlOi8vXCIgKyB1cmkuc3Vic3RyKGFwcGxpY2F0aW9uUm9vdFBhdGgubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3VyaSA9IHVyaTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9saW5lID0gbGluZTtcbiAgICAgICAgdGhpcy5fY29sdW1uID0gY29sdW1uO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlLnByb3RvdHlwZSwgXCJ1cmlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3VyaTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvdXJjZS5wcm90b3R5cGUsIFwibGluZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fbGluZTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvdXJjZS5wcm90b3R5cGUsIFwiY29sdW1uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9jb2x1bW47IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNvdXJjZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl91cmkgKyBcIjpcIiArIHRoaXMuX2xpbmUgKyBcIjpcIiArIHRoaXMuX2NvbHVtbjtcbiAgICB9O1xuICAgIFNvdXJjZS5nZXQgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBvYmplY3RbU291cmNlLl9zb3VyY2VdO1xuICAgIH07XG4gICAgU291cmNlLnNldCA9IGZ1bmN0aW9uIChvYmplY3QsIHNyYykge1xuICAgICAgICBvYmplY3RbU291cmNlLl9zb3VyY2VdID0gc3JjO1xuICAgIH07XG4gICAgU291cmNlLl9zb3VyY2UgPSBTeW1ib2woXCJzb3VyY2VcIik7XG4gICAgcmV0dXJuIFNvdXJjZTtcbn0oKSk7XG5leHBvcnRzLlNvdXJjZSA9IFNvdXJjZTtcbnZhciBTY29wZUVycm9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU2NvcGVFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTY29wZUVycm9yKGlubmVyLCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBmb3JtYXR0ZWRNZXNzYWdlO1xuICAgICAgICBpZiAobWVzc2FnZSAmJiBpbm5lci5tZXNzYWdlKSB7XG4gICAgICAgICAgICBmb3JtYXR0ZWRNZXNzYWdlID0gbWVzc2FnZSArIFwiXFxuID4gXCIgKyBpbm5lci5tZXNzYWdlLnJlcGxhY2UoXCJcXG5cIiwgXCJcXG4gIFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZE1lc3NhZ2UgPSBtZXNzYWdlIHx8IGlubmVyLm1lc3NhZ2UgfHwgdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZm9ybWF0dGVkTWVzc2FnZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhY2sgPSBwbGF0Zm9ybV8xLmlzQW5kcm9pZCA/IFwiRXJyb3I6IFwiICsgX3RoaXMubWVzc2FnZSArIFwiXFxuXCIgKyBpbm5lci5zdGFjay5zdWJzdHIoaW5uZXIuc3RhY2suaW5kZXhPZihcIlxcblwiKSArIDEpIDogaW5uZXIuc3RhY2s7XG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBmb3JtYXR0ZWRNZXNzYWdlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBTY29wZUVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0cy5TY29wZUVycm9yID0gU2NvcGVFcnJvcjtcbnZhciBTb3VyY2VFcnJvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNvdXJjZUVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNvdXJjZUVycm9yKGNoaWxkLCBzb3VyY2UsIG1lc3NhZ2UpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGNoaWxkLCBtZXNzYWdlID8gbWVzc2FnZSArIFwiIEBcIiArIHNvdXJjZSArIFwiXCIgOiBzb3VyY2UgKyBcIlwiKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gU291cmNlRXJyb3I7XG59KFNjb3BlRXJyb3IpKTtcbmV4cG9ydHMuU291cmNlRXJyb3IgPSBTb3VyY2VFcnJvcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYnVnLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGRpc3BhdGNoVG9NYWluVGhyZWFkKGZ1bmMpIHtcbiAgICBOU09wZXJhdGlvblF1ZXVlLm1haW5RdWV1ZS5hZGRPcGVyYXRpb25XaXRoQmxvY2soZnVuYyk7XG59XG5leHBvcnRzLmRpc3BhdGNoVG9NYWluVGhyZWFkID0gZGlzcGF0Y2hUb01haW5UaHJlYWQ7XG5mdW5jdGlvbiBpc01haW5UaHJlYWQoKSB7XG4gICAgcmV0dXJuIE5TVGhyZWFkLmlzTWFpblRocmVhZDtcbn1cbmV4cG9ydHMuaXNNYWluVGhyZWFkID0gaXNNYWluVGhyZWFkO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFpbnRocmVhZC1oZWxwZXIuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlcHNpbG9uID0gMUUtMDU7XG5mdW5jdGlvbiBhcmVDbG9zZSh2YWx1ZTEsIHZhbHVlMikge1xuICAgIHJldHVybiAoTWF0aC5hYnModmFsdWUxIC0gdmFsdWUyKSA8IGVwc2lsb24pO1xufVxuZXhwb3J0cy5hcmVDbG9zZSA9IGFyZUNsb3NlO1xuZnVuY3Rpb24gZ3JlYXRlclRoYW5PckNsb3NlKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuICh2YWx1ZTEgPiB2YWx1ZTIpIHx8IGFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMuZ3JlYXRlclRoYW5PckNsb3NlID0gZ3JlYXRlclRoYW5PckNsb3NlO1xuZnVuY3Rpb24gZ3JlYXRlclRoYW4odmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA+IHZhbHVlMikgJiYgIWFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMuZ3JlYXRlclRoYW4gPSBncmVhdGVyVGhhbjtcbmZ1bmN0aW9uIGxlc3NUaGFuKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuICh2YWx1ZTEgPCB2YWx1ZTIpICYmICFhcmVDbG9zZSh2YWx1ZTEsIHZhbHVlMik7XG59XG5leHBvcnRzLmxlc3NUaGFuID0gbGVzc1RoYW47XG5mdW5jdGlvbiBpc1plcm8odmFsdWUpIHtcbiAgICByZXR1cm4gKE1hdGguYWJzKHZhbHVlKSA8IGVwc2lsb24pO1xufVxuZXhwb3J0cy5pc1plcm8gPSBpc1plcm87XG5mdW5jdGlvbiBncmVhdGVyVGhhblplcm8odmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPiAwO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhblplcm8gPSBncmVhdGVyVGhhblplcm87XG5mdW5jdGlvbiBub3ROZWdhdGl2ZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA+PSAwO1xufVxuZXhwb3J0cy5ub3ROZWdhdGl2ZSA9IG5vdE5lZ2F0aXZlO1xuZXhwb3J0cy5yYWRpYW5zVG9EZWdyZWVzID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEgKiAoMTgwIC8gTWF0aC5QSSk7IH07XG5leHBvcnRzLmRlZ3JlZXNUb1JhZGlhbnMgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSAqIChNYXRoLlBJIC8gMTgwKTsgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW51bWJlci11dGlscy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmc7XG59XG5leHBvcnRzLmlzU3RyaW5nID0gaXNTdHJpbmc7XG5mdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBOdW1iZXI7XG59XG5leHBvcnRzLmlzTnVtYmVyID0gaXNOdW1iZXI7XG5mdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIEJvb2xlYW47XG59XG5leHBvcnRzLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtcbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJmdW5jdGlvblwiO1xufVxuZXhwb3J0cy5pc0Z1bmN0aW9uID0gaXNGdW5jdGlvbjtcbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCI7XG59XG5leHBvcnRzLmlzT2JqZWN0ID0gaXNPYmplY3Q7XG5mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5pc1VuZGVmaW5lZCA9IGlzVW5kZWZpbmVkO1xuZnVuY3Rpb24gaXNEZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSAhPT0gXCJ1bmRlZmluZWRcIjtcbn1cbmV4cG9ydHMuaXNEZWZpbmVkID0gaXNEZWZpbmVkO1xuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbDtcbn1cbmV4cG9ydHMuaXNOdWxsT3JVbmRlZmluZWQgPSBpc051bGxPclVuZGVmaW5lZDtcbmZ1bmN0aW9uIHZlcmlmeUNhbGxiYWNrKHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlICYmICFpc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2FsbGJhY2sgbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLlwiKTtcbiAgICB9XG59XG5leHBvcnRzLnZlcmlmeUNhbGxiYWNrID0gdmVyaWZ5Q2FsbGJhY2s7XG52YXIgY2xhc3NJbmZvc01hcCA9IG5ldyBNYXAoKTtcbnZhciBmdW5jTmFtZVJlZ2V4ID0gL2Z1bmN0aW9uIChbX2EtekEtWjAtOV17MSx9KVxcKC87XG5mdW5jdGlvbiBnZXRDbGFzcyhvYmplY3QpIHtcbiAgICByZXR1cm4gZ2V0Q2xhc3NJbmZvKG9iamVjdCkubmFtZTtcbn1cbmV4cG9ydHMuZ2V0Q2xhc3MgPSBnZXRDbGFzcztcbmZ1bmN0aW9uIGdldENsYXNzSW5mbyhvYmplY3QpIHtcbiAgICB2YXIgY29uc3RydWN0b3IgPSBvYmplY3QuY29uc3RydWN0b3I7XG4gICAgdmFyIHJlc3VsdCA9IGNsYXNzSW5mb3NNYXAuZ2V0KGNvbnN0cnVjdG9yKTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXN1bHQgPSBuZXcgQ2xhc3NJbmZvKGNvbnN0cnVjdG9yKTtcbiAgICAgICAgY2xhc3NJbmZvc01hcC5zZXQoY29uc3RydWN0b3IsIHJlc3VsdCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldENsYXNzSW5mbyA9IGdldENsYXNzSW5mbztcbmZ1bmN0aW9uIGdldEJhc2VDbGFzc2VzKG9iamVjdCkge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgaW5mbyA9IGdldENsYXNzSW5mbyhvYmplY3QpO1xuICAgIHdoaWxlIChpbmZvKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGluZm8ubmFtZSk7XG4gICAgICAgIGluZm8gPSBpbmZvLmJhc2VDbGFzc0luZm87XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldEJhc2VDbGFzc2VzID0gZ2V0QmFzZUNsYXNzZXM7XG52YXIgQ2xhc3NJbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDbGFzc0luZm8odHlwZUNvc250cnVjdG9yKSB7XG4gICAgICAgIHRoaXMuX3R5cGVDb3NudHJ1Y3RvciA9IHR5cGVDb3NudHJ1Y3RvcjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENsYXNzSW5mby5wcm90b3R5cGUsIFwibmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9uYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSAoZnVuY05hbWVSZWdleCkuZXhlYyh0aGlzLl90eXBlQ29zbnRydWN0b3IudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbmFtZSA9IChyZXN1bHRzICYmIHJlc3VsdHMubGVuZ3RoID4gMSkgPyByZXN1bHRzWzFdIDogXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2xhc3NJbmZvLnByb3RvdHlwZSwgXCJiYXNlQ2xhc3NJbmZvXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoaXNVbmRlZmluZWQodGhpcy5fYmFzZUNsYXNzSW5mbykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYXNlQ2xhc3NJbmZvID0gQ2xhc3NJbmZvLl9nZXRCYXNlKHRoaXMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iYXNlQ2xhc3NJbmZvICYmIHRoaXMuX2Jhc2VDbGFzc0luZm8ubmFtZSA9PT0gdGhpcy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Jhc2VDbGFzc0luZm8gPSBDbGFzc0luZm8uX2dldEJhc2UodGhpcy5fYmFzZUNsYXNzSW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Jhc2VDbGFzc0luZm87XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENsYXNzSW5mby5fZ2V0QmFzZSA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgICAgICB2YXIgY29uc3RydWN0b3JQcm90byA9IGluZm8uX3R5cGVDb3NudHJ1Y3Rvci5wcm90b3R5cGU7XG4gICAgICAgIGlmIChjb25zdHJ1Y3RvclByb3RvLl9fcHJvdG9fXykge1xuICAgICAgICAgICAgcmVzdWx0ID0gZ2V0Q2xhc3NJbmZvKGNvbnN0cnVjdG9yUHJvdG8uX19wcm90b19fKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIENsYXNzSW5mbztcbn0oKSk7XG5leHBvcnRzLkNsYXNzSW5mbyA9IENsYXNzSW5mbztcbmZ1bmN0aW9uIHRvVUlTdHJpbmcob2JqKSB7XG4gICAgcmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKG9iaikgPyBcIlwiIDogb2JqICsgXCJcIjtcbn1cbmV4cG9ydHMudG9VSVN0cmluZyA9IHRvVUlTdHJpbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4vdHlwZXNcIik7XG52YXIgbWFpbnRocmVhZF9oZWxwZXJfMSA9IHJlcXVpcmUoXCIuL21haW50aHJlYWQtaGVscGVyXCIpO1xudmFyIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xID0gcmVxdWlyZShcIi4uL3VpL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vbWFpbnRocmVhZC1oZWxwZXJcIikpO1xuZXhwb3J0cy5SRVNPVVJDRV9QUkVGSVggPSBcInJlczovL1wiO1xuZXhwb3J0cy5GSUxFX1BSRUZJWCA9IFwiZmlsZTovLy9cIjtcbmZ1bmN0aW9uIGVzY2FwZVJlZ2V4U3ltYm9scyhzb3VyY2UpIHtcbiAgICB2YXIgZXNjYXBlUmVnZXggPSAvW1xcLVxcW1xcXVxcL1xce1xcfVxcKFxcKVxcKlxcK1xcP1xcLlxcXFxcXF5cXCRcXHxdL2c7XG4gICAgcmV0dXJuIHNvdXJjZS5yZXBsYWNlKGVzY2FwZVJlZ2V4LCBcIlxcXFwkJlwiKTtcbn1cbmV4cG9ydHMuZXNjYXBlUmVnZXhTeW1ib2xzID0gZXNjYXBlUmVnZXhTeW1ib2xzO1xuZnVuY3Rpb24gY29udmVydFN0cmluZyh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQ7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyh2YWx1ZSkgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHZhbHVlQXNOdW1iZXIgPSArdmFsdWU7XG4gICAgICAgIGlmICghaXNOYU4odmFsdWVBc051bWJlcikpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlQXNOdW1iZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgJiYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiIHx8IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwiZmFsc2VcIikpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwidHJ1ZVwiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuY29udmVydFN0cmluZyA9IGNvbnZlcnRTdHJpbmc7XG5mdW5jdGlvbiBnZXRNb2R1bGVOYW1lKHBhdGgpIHtcbiAgICB2YXIgbW9kdWxlTmFtZSA9IHBhdGgucmVwbGFjZShcIi4vXCIsIFwiXCIpO1xuICAgIHJldHVybiBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUobW9kdWxlTmFtZSk7XG59XG5leHBvcnRzLmdldE1vZHVsZU5hbWUgPSBnZXRNb2R1bGVOYW1lO1xudmFyIGxheW91dENvbW1vbjtcbihmdW5jdGlvbiAobGF5b3V0Q29tbW9uKSB7XG4gICAgdmFyIE1PREVfU0hJRlQgPSAzMDtcbiAgICB2YXIgTU9ERV9NQVNLID0gMHgzIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLlVOU1BFQ0lGSUVEID0gMCA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5FWEFDVExZID0gMSA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5BVF9NT1NUID0gMiA8PCBNT0RFX1NISUZUO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQgPSAweDAwMDAwMDEwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TVEFURV9UT09fU01BTEwgPSAweDAxMDAwMDAwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TVEFURV9NQVNLID0gMHhmZjAwMDAwMDtcbiAgICBsYXlvdXRDb21tb24uTUVBU1VSRURfU0laRV9NQVNLID0gMHgwMGZmZmZmZjtcbiAgICBmdW5jdGlvbiBnZXRNb2RlKG1vZGUpIHtcbiAgICAgICAgc3dpdGNoIChtb2RlKSB7XG4gICAgICAgICAgICBjYXNlIGxheW91dENvbW1vbi5FWEFDVExZOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIkV4YWN0XCI7XG4gICAgICAgICAgICBjYXNlIGxheW91dENvbW1vbi5BVF9NT1NUOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIkF0TW9zdFwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJVbnNwZWNpZmllZFwiO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNb2RlID0gZ2V0TW9kZTtcbiAgICBmdW5jdGlvbiBnZXRNZWFzdXJlU3BlY01vZGUoc3BlYykge1xuICAgICAgICByZXR1cm4gKHNwZWMgJiBNT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24uZ2V0TWVhc3VyZVNwZWNNb2RlID0gZ2V0TWVhc3VyZVNwZWNNb2RlO1xuICAgIGZ1bmN0aW9uIGdldE1lYXN1cmVTcGVjU2l6ZShzcGVjKSB7XG4gICAgICAgIHJldHVybiAoc3BlYyAmIH5NT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24uZ2V0TWVhc3VyZVNwZWNTaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplO1xuICAgIGZ1bmN0aW9uIG1lYXN1cmVTcGVjVG9TdHJpbmcobWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIG1vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGUobWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgc2l6ZSA9IGdldE1lYXN1cmVTcGVjU2l6ZShtZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB0ZXh0ID0gXCJNZWFzdXJlU3BlYzogXCI7XG4gICAgICAgIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uVU5TUEVDSUZJRUQpIHtcbiAgICAgICAgICAgIHRleHQgKz0gXCJVTlNQRUNJRklFRCBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uRVhBQ1RMWSkge1xuICAgICAgICAgICAgdGV4dCArPSBcIkVYQUNUTFkgXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobW9kZSA9PT0gbGF5b3V0Q29tbW9uLkFUX01PU1QpIHtcbiAgICAgICAgICAgIHRleHQgKz0gXCJBVF9NT1NUIFwiO1xuICAgICAgICB9XG4gICAgICAgIHRleHQgKz0gc2l6ZTtcbiAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5tZWFzdXJlU3BlY1RvU3RyaW5nID0gbWVhc3VyZVNwZWNUb1N0cmluZztcbiAgICBmdW5jdGlvbiByb3VuZCh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzID0gTWF0aC5mbG9vcih2YWx1ZSArIDAuNSk7XG4gICAgICAgIGlmIChyZXMgIT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBsYXlvdXRDb21tb24ucm91bmQgPSByb3VuZDtcbn0pKGxheW91dENvbW1vbiA9IGV4cG9ydHMubGF5b3V0Q29tbW9uIHx8IChleHBvcnRzLmxheW91dENvbW1vbiA9IHt9KSk7XG5mdW5jdGlvbiBpc0ZpbGVPclJlc291cmNlUGF0aChwYXRoKSB7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyhwYXRoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBwYXRoLmluZGV4T2YoXCJ+L1wiKSA9PT0gMCB8fFxuICAgICAgICBwYXRoLmluZGV4T2YoXCIvXCIpID09PSAwIHx8XG4gICAgICAgIHBhdGguaW5kZXhPZihleHBvcnRzLlJFU09VUkNFX1BSRUZJWCkgPT09IDA7XG59XG5leHBvcnRzLmlzRmlsZU9yUmVzb3VyY2VQYXRoID0gaXNGaWxlT3JSZXNvdXJjZVBhdGg7XG5mdW5jdGlvbiBpc0ZvbnRJY29uVVJJKHVyaSkge1xuICAgIGlmICghdHlwZXMuaXNTdHJpbmcodXJpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBmaXJzdFNlZ21lbnQgPSB1cmkudHJpbSgpLnNwbGl0KFwiLy9cIilbMF07XG4gICAgcmV0dXJuIGZpcnN0U2VnbWVudCAmJiBmaXJzdFNlZ21lbnQuaW5kZXhPZihcImZvbnQ6XCIpID09PSAwO1xufVxuZXhwb3J0cy5pc0ZvbnRJY29uVVJJID0gaXNGb250SWNvblVSSTtcbmZ1bmN0aW9uIGlzRGF0YVVSSSh1cmkpIHtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHVyaSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgZmlyc3RTZWdtZW50ID0gdXJpLnRyaW0oKS5zcGxpdChcIixcIilbMF07XG4gICAgcmV0dXJuIGZpcnN0U2VnbWVudCAmJiBmaXJzdFNlZ21lbnQuaW5kZXhPZihcImRhdGE6XCIpID09PSAwICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiYmFzZTY0XCIpID49IDA7XG59XG5leHBvcnRzLmlzRGF0YVVSSSA9IGlzRGF0YVVSSTtcbmZ1bmN0aW9uIG1lcmdlU29ydChhcnIsIGNvbXBhcmVGdW5jKSB7XG4gICAgaWYgKGFyci5sZW5ndGggPCAyKSB7XG4gICAgICAgIHJldHVybiBhcnI7XG4gICAgfVxuICAgIHZhciBtaWRkbGUgPSBhcnIubGVuZ3RoIC8gMjtcbiAgICB2YXIgbGVmdCA9IGFyci5zbGljZSgwLCBtaWRkbGUpO1xuICAgIHZhciByaWdodCA9IGFyci5zbGljZShtaWRkbGUsIGFyci5sZW5ndGgpO1xuICAgIHJldHVybiBtZXJnZShtZXJnZVNvcnQobGVmdCwgY29tcGFyZUZ1bmMpLCBtZXJnZVNvcnQocmlnaHQsIGNvbXBhcmVGdW5jKSwgY29tcGFyZUZ1bmMpO1xufVxuZXhwb3J0cy5tZXJnZVNvcnQgPSBtZXJnZVNvcnQ7XG5mdW5jdGlvbiBtZXJnZShsZWZ0LCByaWdodCwgY29tcGFyZUZ1bmMpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgd2hpbGUgKGxlZnQubGVuZ3RoICYmIHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICBpZiAoY29tcGFyZUZ1bmMobGVmdFswXSwgcmlnaHRbMF0pIDw9IDApIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGxlZnQuc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3aGlsZSAobGVmdC5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICB9XG4gICAgd2hpbGUgKHJpZ2h0Lmxlbmd0aCkge1xuICAgICAgICByZXN1bHQucHVzaChyaWdodC5zaGlmdCgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMubWVyZ2UgPSBtZXJnZTtcbmZ1bmN0aW9uIGhhc0R1cGxpY2F0ZXMoYXJyKSB7XG4gICAgcmV0dXJuIGFyci5sZW5ndGggIT09IGVsaW1pbmF0ZUR1cGxpY2F0ZXMoYXJyKS5sZW5ndGg7XG59XG5leHBvcnRzLmhhc0R1cGxpY2F0ZXMgPSBoYXNEdXBsaWNhdGVzO1xuZnVuY3Rpb24gZWxpbWluYXRlRHVwbGljYXRlcyhhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KGFycikpO1xufVxuZXhwb3J0cy5lbGltaW5hdGVEdXBsaWNhdGVzID0gZWxpbWluYXRlRHVwbGljYXRlcztcbmZ1bmN0aW9uIGV4ZWN1dGVPbk1haW5UaHJlYWQoZnVuYykge1xuICAgIGlmIChtYWludGhyZWFkX2hlbHBlcl8xLmlzTWFpblRocmVhZCgpKSB7XG4gICAgICAgIHJldHVybiBmdW5jKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBtYWludGhyZWFkX2hlbHBlcl8xLmRpc3BhdGNoVG9NYWluVGhyZWFkKGZ1bmMpO1xuICAgIH1cbn1cbmV4cG9ydHMuZXhlY3V0ZU9uTWFpblRocmVhZCA9IGV4ZWN1dGVPbk1haW5UaHJlYWQ7XG5mdW5jdGlvbiBtYWluVGhyZWFkaWZ5KGZ1bmMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYXJnc1RvUGFzcyA9IGFyZ3VtZW50cztcbiAgICAgICAgZXhlY3V0ZU9uTWFpblRocmVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBmdW5jLmFwcGx5KF90aGlzLCBhcmdzVG9QYXNzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMubWFpblRocmVhZGlmeSA9IG1haW5UaHJlYWRpZnk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uL3RyYWNlXCIpO1xudmFyIHV0aWxzX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdXRpbHMtY29tbW9uXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdXRpbHMtY29tbW9uXCIpKTtcbnZhciBtYWluU2NyZWVuU2NhbGU7XG5mdW5jdGlvbiBpc09yaWVudGF0aW9uTGFuZHNjYXBlKG9yaWVudGF0aW9uKSB7XG4gICAgcmV0dXJuIG9yaWVudGF0aW9uID09PSAzIHx8IG9yaWVudGF0aW9uID09PSA0O1xufVxudmFyIGxheW91dDtcbihmdW5jdGlvbiAobGF5b3V0KSB7XG4gICAgdmFyIE1PREVfU0hJRlQgPSAzMDtcbiAgICB2YXIgTU9ERV9NQVNLID0gMHgzIDw8IE1PREVfU0hJRlQ7XG4gICAgZnVuY3Rpb24gbWFrZU1lYXN1cmVTcGVjKHNpemUsIG1vZGUpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJvdW5kKE1hdGgubWF4KDAsIHNpemUpKSAmIH5NT0RFX01BU0spIHwgKG1vZGUgJiBNT0RFX01BU0spO1xuICAgIH1cbiAgICBsYXlvdXQubWFrZU1lYXN1cmVTcGVjID0gbWFrZU1lYXN1cmVTcGVjO1xuICAgIGZ1bmN0aW9uIGdldERpc3BsYXlEZW5zaXR5KCkge1xuICAgICAgICByZXR1cm4gbWFpblNjcmVlblNjYWxlO1xuICAgIH1cbiAgICBsYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkgPSBnZXREaXNwbGF5RGVuc2l0eTtcbiAgICBmdW5jdGlvbiB0b0RldmljZVBpeGVscyh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgKiBtYWluU2NyZWVuU2NhbGU7XG4gICAgfVxuICAgIGxheW91dC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzO1xuICAgIGZ1bmN0aW9uIHRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlIC8gbWFpblNjcmVlblNjYWxlO1xuICAgIH1cbiAgICBsYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyA9IHRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHM7XG4gICAgZnVuY3Rpb24gbWVhc3VyZU5hdGl2ZVZpZXcobmF0aXZlVmlldywgd2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gbmF0aXZlVmlldztcbiAgICAgICAgdmFyIG5hdGl2ZVNpemUgPSB2aWV3LnNpemVUaGF0Rml0cyh7XG4gICAgICAgICAgICB3aWR0aDogd2lkdGhNb2RlID09PSAwID8gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIDogdG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh3aWR0aCksXG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodE1vZGUgPT09IDAgPyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgOiB0b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGhlaWdodClcbiAgICAgICAgfSk7XG4gICAgICAgIG5hdGl2ZVNpemUud2lkdGggPSB1dGlsc19jb21tb25fMS5sYXlvdXRDb21tb24ucm91bmQodG9EZXZpY2VQaXhlbHMobmF0aXZlU2l6ZS53aWR0aCkpO1xuICAgICAgICBuYXRpdmVTaXplLmhlaWdodCA9IHV0aWxzX2NvbW1vbl8xLmxheW91dENvbW1vbi5yb3VuZCh0b0RldmljZVBpeGVscyhuYXRpdmVTaXplLmhlaWdodCkpO1xuICAgICAgICByZXR1cm4gbmF0aXZlU2l6ZTtcbiAgICB9XG4gICAgbGF5b3V0Lm1lYXN1cmVOYXRpdmVWaWV3ID0gbWVhc3VyZU5hdGl2ZVZpZXc7XG59KShsYXlvdXQgPSBleHBvcnRzLmxheW91dCB8fCAoZXhwb3J0cy5sYXlvdXQgPSB7fSkpO1xuT2JqZWN0LmFzc2lnbihsYXlvdXQsIHV0aWxzX2NvbW1vbl8xLmxheW91dENvbW1vbik7XG52YXIgaW9zO1xuKGZ1bmN0aW9uIChpb3MpIHtcbiAgICBmdW5jdGlvbiBnZXR0ZXIoX3RoaXMsIHByb3BlcnR5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwidXRpbHMuaW9zLmdldHRlcigpIGlzIGRlcHJlY2F0ZWQ7IHVzZSB0aGUgcmVzcGVjdGl2ZSBuYXRpdmUgcHJvcGVydHkgaW5zdGVhZFwiKTtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvcGVydHkuY2FsbChfdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcHJvcGVydHk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaW9zLmdldHRlciA9IGdldHRlcjtcbiAgICB2YXIgY29sbGVjdGlvbnM7XG4gICAgKGZ1bmN0aW9uIChjb2xsZWN0aW9ucykge1xuICAgICAgICBmdW5jdGlvbiBqc0FycmF5VG9OU0FycmF5KHN0cikge1xuICAgICAgICAgICAgcmV0dXJuIE5TQXJyYXkuYXJyYXlXaXRoQXJyYXkoc3RyKTtcbiAgICAgICAgfVxuICAgICAgICBjb2xsZWN0aW9ucy5qc0FycmF5VG9OU0FycmF5ID0ganNBcnJheVRvTlNBcnJheTtcbiAgICAgICAgZnVuY3Rpb24gbnNBcnJheVRvSlNBcnJheShhKSB7XG4gICAgICAgICAgICB2YXIgYXJyID0gW107XG4gICAgICAgICAgICBpZiAoYSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYS5jb3VudDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goYS5vYmplY3RBdEluZGV4KGkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYXJyO1xuICAgICAgICB9XG4gICAgICAgIGNvbGxlY3Rpb25zLm5zQXJyYXlUb0pTQXJyYXkgPSBuc0FycmF5VG9KU0FycmF5O1xuICAgIH0pKGNvbGxlY3Rpb25zID0gaW9zLmNvbGxlY3Rpb25zIHx8IChpb3MuY29sbGVjdGlvbnMgPSB7fSkpO1xuICAgIGZ1bmN0aW9uIGlzTGFuZHNjYXBlKCkge1xuICAgICAgICB2YXIgZGV2aWNlID0gVUlEZXZpY2UuY3VycmVudERldmljZTtcbiAgICAgICAgdmFyIHN0YXR1c0Jhck9yaWVudGF0aW9uID0gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbi5zdGF0dXNCYXJPcmllbnRhdGlvbjtcbiAgICAgICAgdmFyIGlzU3RhdHVzQmFyT3JpZW50YXRpb25MYW5kc2NhcGUgPSBpc09yaWVudGF0aW9uTGFuZHNjYXBlKHN0YXR1c0Jhck9yaWVudGF0aW9uKTtcbiAgICAgICAgcmV0dXJuIGlzT3JpZW50YXRpb25MYW5kc2NhcGUoZGV2aWNlLm9yaWVudGF0aW9uKSB8fCBpc1N0YXR1c0Jhck9yaWVudGF0aW9uTGFuZHNjYXBlO1xuICAgIH1cbiAgICBpb3MuaXNMYW5kc2NhcGUgPSBpc0xhbmRzY2FwZTtcbiAgICBpb3MuTWFqb3JWZXJzaW9uID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhVSURldmljZS5jdXJyZW50RGV2aWNlLnN5c3RlbVZlcnNpb24pLmludFZhbHVlO1xuICAgIGZ1bmN0aW9uIG9wZW5GaWxlKGZpbGVQYXRoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYXBwUGF0aCA9IGdldEN1cnJlbnRBcHBQYXRoKCk7XG4gICAgICAgICAgICB2YXIgcGF0aCA9IGZpbGVQYXRoLnJlcGxhY2UoXCJ+XCIsIGFwcFBhdGgpO1xuICAgICAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyLmludGVyYWN0aW9uQ29udHJvbGxlcldpdGhVUkwoTlNVUkwuZmlsZVVSTFdpdGhQYXRoKHBhdGgpKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZGVsZWdhdGUgPSBuZXcgVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbCgpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIucHJlc2VudFByZXZpZXdBbmltYXRlZCh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIGluIG9wZW5GaWxlXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5FcnJvciwgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpb3Mub3BlbkZpbGUgPSBvcGVuRmlsZTtcbiAgICBmdW5jdGlvbiBnZXRDdXJyZW50QXBwUGF0aCgpIHtcbiAgICAgICAgdmFyIGN1cnJlbnREaXIgPSBfX2Rpcm5hbWU7XG4gICAgICAgIHZhciB0bnNNb2R1bGVzSW5kZXggPSBjdXJyZW50RGlyLmluZGV4T2YoXCIvdG5zX21vZHVsZXNcIik7XG4gICAgICAgIHZhciBhcHBQYXRoID0gY3VycmVudERpcjtcbiAgICAgICAgaWYgKHRuc01vZHVsZXNJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIGFwcFBhdGggPSBjdXJyZW50RGlyLnN1YnN0cmluZygwLCB0bnNNb2R1bGVzSW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBQYXRoO1xuICAgIH1cbiAgICBpb3MuZ2V0Q3VycmVudEFwcFBhdGggPSBnZXRDdXJyZW50QXBwUGF0aDtcbiAgICBmdW5jdGlvbiBqb2luUGF0aHMoKSB7XG4gICAgICAgIHZhciBwYXRocyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgcGF0aHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXBhdGhzIHx8IHBhdGhzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcoTlNTdHJpbmcucGF0aFdpdGhDb21wb25lbnRzKHBhdGhzKSkuc3RyaW5nQnlTdGFuZGFyZGl6aW5nUGF0aDtcbiAgICB9XG4gICAgaW9zLmpvaW5QYXRocyA9IGpvaW5QYXRocztcbiAgICBmdW5jdGlvbiBnZXRWaXNpYmxlVmlld0NvbnRyb2xsZXIocm9vdFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIGlmIChyb290Vmlld0NvbnRyb2xsZXIucHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRWaXNpYmxlVmlld0NvbnRyb2xsZXIocm9vdFZpZXdDb250cm9sbGVyLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm9vdFZpZXdDb250cm9sbGVyLmlzS2luZE9mQ2xhc3MoVUlOYXZpZ2F0aW9uQ29udHJvbGxlci5jbGFzcygpKSkge1xuICAgICAgICAgICAgcmV0dXJuIGdldFZpc2libGVWaWV3Q29udHJvbGxlcihyb290Vmlld0NvbnRyb2xsZXIudmlzaWJsZVZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm9vdFZpZXdDb250cm9sbGVyLmlzS2luZE9mQ2xhc3MoVUlUYWJCYXJDb250cm9sbGVyLmNsYXNzKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VmlzaWJsZVZpZXdDb250cm9sbGVyKHJvb3RWaWV3Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJvb3RWaWV3Q29udHJvbGxlcjtcbiAgICB9XG4gICAgaW9zLmdldFZpc2libGVWaWV3Q29udHJvbGxlciA9IGdldFZpc2libGVWaWV3Q29udHJvbGxlcjtcbn0pKGlvcyA9IGV4cG9ydHMuaW9zIHx8IChleHBvcnRzLmlvcyA9IHt9KSk7XG5mdW5jdGlvbiBHQygpIHtcbiAgICBfX2NvbGxlY3QoKTtcbn1cbmV4cG9ydHMuR0MgPSBHQztcbmZ1bmN0aW9uIHJlbGVhc2VOYXRpdmVPYmplY3Qob2JqZWN0KSB7XG4gICAgX19yZWxlYXNlTmF0aXZlQ291bnRlcnBhcnQob2JqZWN0KTtcbn1cbmV4cG9ydHMucmVsZWFzZU5hdGl2ZU9iamVjdCA9IHJlbGVhc2VOYXRpdmVPYmplY3Q7XG5mdW5jdGlvbiBvcGVuVXJsKGxvY2F0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIHVybCA9IE5TVVJMLlVSTFdpdGhTdHJpbmcobG9jYXRpb24udHJpbSgpKTtcbiAgICAgICAgaWYgKFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb24uY2FuT3BlblVSTCh1cmwpKSB7XG4gICAgICAgICAgICByZXR1cm4gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbi5vcGVuVVJMKHVybCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgdHJhY2VfMS53cml0ZShcIkVycm9yIGluIE9wZW5VUkxcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZXhwb3J0cy5vcGVuVXJsID0gb3BlblVybDtcbnZhciBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLmdldFZpZXdDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXBwID0gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbjtcbiAgICAgICAgcmV0dXJuIGFwcC5rZXlXaW5kb3cucm9vdFZpZXdDb250cm9sbGVyO1xuICAgIH07XG4gICAgVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJWaWV3Q29udHJvbGxlckZvclByZXZpZXcgPSBmdW5jdGlvbiAoY29udHJvbGxlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRWaWV3Q29udHJvbGxlcigpO1xuICAgIH07XG4gICAgVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJWaWV3Rm9yUHJldmlldyA9IGZ1bmN0aW9uIChjb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZpZXdDb250cm9sbGVyKCkudmlldztcbiAgICB9O1xuICAgIFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwucHJvdG90eXBlLmRvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyUmVjdEZvclByZXZpZXcgPSBmdW5jdGlvbiAoY29udHJvbGxlcikge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRWaWV3Q29udHJvbGxlcigpLnZpZXcuZnJhbWU7XG4gICAgfTtcbiAgICBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbm1haW5TY3JlZW5TY2FsZSA9IFVJU2NyZWVuLm1haW5TY3JlZW4uc2NhbGU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGh0dHAgPSByZXF1aXJlKFwiLi4vaHR0cFwiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi91dGlscy90eXBlc1wiKTtcbnZhciBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZTtcbihmdW5jdGlvbiAoWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUpIHtcbiAgICBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS5lbXB0eSA9IFwiXCI7XG4gICAgWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUudGV4dCA9IFwidGV4dFwiO1xuICAgIFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLmpzb24gPSBcImpzb25cIjtcbn0pKFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlIHx8IChYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZSA9IHt9KSk7XG52YXIgWE1MSHR0cFJlcXVlc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFhNTEh0dHBSZXF1ZXN0KCkge1xuICAgICAgICB0aGlzLlVOU0VOVCA9IDA7XG4gICAgICAgIHRoaXMuT1BFTkVEID0gMTtcbiAgICAgICAgdGhpcy5IRUFERVJTX1JFQ0VJVkVEID0gMjtcbiAgICAgICAgdGhpcy5MT0FESU5HID0gMztcbiAgICAgICAgdGhpcy5ET05FID0gNDtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUeXBlID0gXCJcIjtcbiAgICAgICAgdGhpcy50ZXh0VHlwZXMgPSBbXG4gICAgICAgICAgICBcInRleHQvcGxhaW5cIixcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24veG1sXCIsXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL3Jzcyt4bWxcIixcbiAgICAgICAgICAgIFwidGV4dC9odG1sXCIsXG4gICAgICAgICAgICBcInRleHQveG1sXCJcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdGhpcy5VTlNFTlQ7XG4gICAgfVxuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlciwgcGFzc3dvcmQpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKG1ldGhvZCkgJiYgdHlwZXMuaXNTdHJpbmcodXJsKSkge1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHsgdXJsOiB1cmwsIG1ldGhvZDogbWV0aG9kIH07XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zLmhlYWRlcnMgPSB7fTtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyh1c2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuaGVhZGVyc1tcInVzZXJcIl0gPSB1c2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKHBhc3N3b3JkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuaGVhZGVyc1tcInBhc3N3b3JkXCJdID0gcGFzc3dvcmQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuT1BFTkVEKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmFib3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9lcnJvckZsYWcgPSB0cnVlO1xuICAgICAgICB0aGlzLl9yZXNwb25zZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlVGV4dFJlYWRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5VTlNFTlQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5PUEVORUQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdGhpcy5VTlNFTlQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuRE9ORSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fZXJyb3JGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IG51bGw7XG4gICAgICAgIGlmICh0eXBlcy5pc0RlZmluZWQodGhpcy5fb3B0aW9ucykpIHtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhkYXRhKSAmJiB0aGlzLl9vcHRpb25zLm1ldGhvZCAhPT0gXCJHRVRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuY29udGVudCA9IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vcHRpb25zLmNvbnRlbnQgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBodHRwLnJlcXVlc3QodGhpcy5fb3B0aW9ucykudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuX2Vycm9yRmxhZykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZFJlc3BvbnNlKHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2Vycm9yRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3RoaXMuX3NldFJlYWR5U3RhdGUoX3RoaXMuRE9ORSwgZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9sb2FkUmVzcG9uc2UgPSBmdW5jdGlvbiAocikge1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSByLnN0YXR1c0NvZGU7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gci5jb250ZW50LnJhdyArIFwiXCI7XG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSByLmhlYWRlcnM7XG4gICAgICAgIHRoaXMuX3NldFJlYWR5U3RhdGUodGhpcy5IRUFERVJTX1JFQ0VJVkVEKTtcbiAgICAgICAgdGhpcy5fc2V0UmVhZHlTdGF0ZSh0aGlzLkxPQURJTkcpO1xuICAgICAgICB0aGlzLl9zZXRSZXNwb25zZVR5cGUoKTtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gci5jb250ZW50LnRvU3RyaW5nKCk7IH07XG4gICAgICAgIHRoaXMuX2FkZFRvU3RyaW5nT25SZXNwb25zZSgpO1xuICAgICAgICBpZiAodGhpcy5yZXNwb25zZVR5cGUgPT09IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLmpzb24pIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXNwb25zZVR5cGUgPT09IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gdGhpcy5yZXNwb25zZVRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0UmVhZHlTdGF0ZSh0aGlzLkRPTkUpO1xuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9hZGRUb1N0cmluZ09uUmVzcG9uc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0eXBlcy5pc09iamVjdCh0aGlzLnJlc3BvbnNlKSkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuX3Jlc3BvbnNlLCBcInRvU3RyaW5nXCIsIHtcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnJlc3BvbnNlVGV4dDsgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5pc1RleHRDb250ZW50VHlwZSA9IGZ1bmN0aW9uIChjb250ZW50VHlwZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50ZXh0VHlwZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50VHlwZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGhpcy50ZXh0VHlwZXNbaV0pID49IDApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuX3NldFJlc3BvbnNlVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMuZ2V0UmVzcG9uc2VIZWFkZXIoXCJDb250ZW50LVR5cGVcIik7XG4gICAgICAgIHZhciBjb250ZW50VHlwZSA9IGhlYWRlciAmJiBoZWFkZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlKSB7XG4gICAgICAgICAgICBpZiAoY29udGVudFR5cGUuaW5kZXhPZihcImFwcGxpY2F0aW9uL2pzb25cIikgPj0gMCB8fCBjb250ZW50VHlwZS5pbmRleE9mKFwiK2pzb25cIikgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzcG9uc2VUeXBlID0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuanNvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNUZXh0Q29udGVudFR5cGUoY29udGVudFR5cGUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS50ZXh0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS50ZXh0O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGhhbmRsZXIpIHtcbiAgICAgICAgaWYgKGV2ZW50TmFtZSAhPT0gXCJsb2FkXCIgJiYgZXZlbnROYW1lICE9PSBcImVycm9yXCIgJiYgZXZlbnROYW1lICE9PSBcInByb2dyZXNzXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV2ZW50IG5vdCBzdXBwb3J0ZWQ6IFwiICsgZXZlbnROYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGFuZGxlcnMgPSB0aGlzLl9saXN0ZW5lcnMuZ2V0KGV2ZW50TmFtZSkgfHwgW107XG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XG4gICAgICAgIHRoaXMuX2xpc3RlbmVycy5zZXQoZXZlbnROYW1lLCBoYW5kbGVycyk7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudE5hbWUsIHRvRGV0YWNoKSB7XG4gICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuX2xpc3RlbmVycy5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICAgICAgaGFuZGxlcnMgPSBoYW5kbGVycy5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHsgcmV0dXJuIGhhbmRsZXIgIT09IHRvRGV0YWNoOyB9KTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzLnNldChldmVudE5hbWUsIGhhbmRsZXJzKTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5lbWl0RXZlbnQgPSBmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuX2xpc3RlbmVycy5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICAgICAgaGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikge1xuICAgICAgICAgICAgaGFuZGxlci5hcHBseSh2b2lkIDAsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZXRSZXF1ZXN0SGVhZGVyID0gZnVuY3Rpb24gKGhlYWRlciwgdmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzRGVmaW5lZCh0aGlzLl9vcHRpb25zKSAmJiB0eXBlcy5pc1N0cmluZyhoZWFkZXIpICYmIHR5cGVzLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzW2hlYWRlcl0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmdldEFsbFJlc3BvbnNlSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5U3RhdGUgPCAyIHx8IHRoaXMuX2Vycm9yRmxhZykge1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5faGVhZGVycykge1xuICAgICAgICAgICAgcmVzdWx0ICs9IGkgKyBcIjogXCIgKyB0aGlzLl9oZWFkZXJzW2ldICsgXCJcXHJcXG5cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0LnN1YnN0cigwLCByZXN1bHQubGVuZ3RoIC0gMik7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VIZWFkZXIgPSBmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhoZWFkZXIpICYmIHRoaXMuX3JlYWR5U3RhdGUgPiAxXG4gICAgICAgICAgICAmJiB0aGlzLl9oZWFkZXJzXG4gICAgICAgICAgICAmJiAhdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICBoZWFkZXIgPSBoZWFkZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5faGVhZGVycykge1xuICAgICAgICAgICAgICAgIGlmIChpLnRvTG93ZXJDYXNlKCkgPT09IGhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhZGVyc1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3ZlcnJpZGVNaW1lVHlwZSA9IGZ1bmN0aW9uIChtaW1lKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlYWR5U3RhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWFkeVN0YXRlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlc3BvbnNlVHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNlVHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuZW1wdHkgfHwgdmFsdWUgaW4gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXNwb25zZVR5cGUgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlc3BvbnNlIHR5cGUgb2YgJ1wiICsgdmFsdWUgKyBcIicgbm90IHN1cHBvcnRlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5fc2V0UmVhZHlTdGF0ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5U3RhdGUgIT09IHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWFkeVN0YXRlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNGdW5jdGlvbih0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9ucmVhZHlzdGF0ZWNoYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9lcnJvckZsYWcpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZXMuaXNGdW5jdGlvbih0aGlzLm9uZXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KFwiZXJyb3JcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVzLmlzRnVuY3Rpb24odGhpcy5vbmxvYWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdEV2ZW50KFwibG9hZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXNwb25zZVRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc0Z1bmN0aW9uKHRoaXMuX3Jlc3BvbnNlVGV4dFJlYWRlcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJyZXNwb25zZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInN0YXR1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZSwgXCJzdGF0dXNUZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5VTlNFTlQgfHwgdGhpcy5fcmVhZHlTdGF0ZSA9PT0gdGhpcy5PUEVORUQgfHwgdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3RhdHVzZXNbdGhpcy5fc3RhdHVzXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFhNTEh0dHBSZXF1ZXN0O1xufSgpKTtcbmV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSBYTUxIdHRwUmVxdWVzdDtcbnZhciBzdGF0dXNlcyA9IHtcbiAgICAxMDA6IFwiQ29udGludWVcIixcbiAgICAxMDE6IFwiU3dpdGNoaW5nIFByb3RvY29sc1wiLFxuICAgIDIwMDogXCJPS1wiLFxuICAgIDIwMTogXCJDcmVhdGVkXCIsXG4gICAgMjAyOiBcIkFjY2VwdGVkXCIsXG4gICAgMjAzOiBcIk5vbiAtIEF1dGhvcml0YXRpdmUgSW5mb3JtYXRpb25cIixcbiAgICAyMDQ6IFwiTm8gQ29udGVudFwiLFxuICAgIDIwNTogXCJSZXNldCBDb250ZW50XCIsXG4gICAgMjA2OiBcIlBhcnRpYWwgQ29udGVudFwiLFxuICAgIDMwMDogXCJNdWx0aXBsZSBDaG9pY2VzXCIsXG4gICAgMzAxOiBcIk1vdmVkIFBlcm1hbmVudGx5XCIsXG4gICAgMzAyOiBcIkZvdW5kXCIsXG4gICAgMzAzOiBcIlNlZSBPdGhlclwiLFxuICAgIDMwNDogXCJOb3QgTW9kaWZpZWRcIixcbiAgICAzMDU6IFwiVXNlIFByb3h5XCIsXG4gICAgMzA3OiBcIlRlbXBvcmFyeSBSZWRpcmVjdFwiLFxuICAgIDQwMDogXCJCYWQgUmVxdWVzdFwiLFxuICAgIDQwMTogXCJVbmF1dGhvcml6ZWRcIixcbiAgICA0MDI6IFwiUGF5bWVudCBSZXF1aXJlZFwiLFxuICAgIDQwMzogXCJGb3JiaWRkZW5cIixcbiAgICA0MDQ6IFwiTm90IEZvdW5kXCIsXG4gICAgNDA1OiBcIk1ldGhvZCBOb3QgQWxsb3dlZFwiLFxuICAgIDQwNjogXCJOb3QgQWNjZXB0YWJsZVwiLFxuICAgIDQwNzogXCJQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZFwiLFxuICAgIDQwODogXCJSZXF1ZXN0IFRpbWVvdXRcIixcbiAgICA0MDk6IFwiQ29uZmxpY3RcIixcbiAgICA0MTA6IFwiR29uZVwiLFxuICAgIDQxMTogXCJMZW5ndGggUmVxdWlyZWRcIixcbiAgICA0MTI6IFwiUHJlY29uZGl0aW9uIEZhaWxlZFwiLFxuICAgIDQxMzogXCJSZXF1ZXN0IEVudGl0eSBUb28gTGFyZ2VcIixcbiAgICA0MTQ6IFwiUmVxdWVzdCAtIFVSSSBUb28gTG9uZ1wiLFxuICAgIDQxNTogXCJVbnN1cHBvcnRlZCBNZWRpYSBUeXBlXCIsXG4gICAgNDE2OiBcIlJlcXVlc3RlZCBSYW5nZSBOb3QgU2F0aXNmaWFibGVcIixcbiAgICA0MTc6IFwiRXhwZWN0YXRpb24gRmFpbGVkXCIsXG4gICAgNTAwOiBcIkludGVybmFsIFNlcnZlciBFcnJvclwiLFxuICAgIDUwMTogXCJOb3QgSW1wbGVtZW50ZWRcIixcbiAgICA1MDI6IFwiQmFkIEdhdGV3YXlcIixcbiAgICA1MDM6IFwiU2VydmljZSBVbmF2YWlsYWJsZVwiLFxuICAgIDUwNDogXCJHYXRld2F5IFRpbWVvdXRcIixcbiAgICA1MDU6IFwiSFRUUCBWZXJzaW9uIE5vdCBTdXBwb3J0ZWRcIlxufTtcbnZhciBGb3JtRGF0YSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRm9ybURhdGEoKSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSBuZXcgTWFwKCk7XG4gICAgfVxuICAgIEZvcm1EYXRhLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZGF0YS5zZXQobmFtZSwgdmFsdWUpO1xuICAgIH07XG4gICAgRm9ybURhdGEucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJyID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2RhdGEuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUsIG1hcCkge1xuICAgICAgICAgICAgYXJyLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhcnIuam9pbihcIiZcIik7XG4gICAgfTtcbiAgICByZXR1cm4gRm9ybURhdGE7XG59KCkpO1xuZXhwb3J0cy5Gb3JtRGF0YSA9IEZvcm1EYXRhO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9eGhyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlYXN5c2F4ID0gcmVxdWlyZShcIi4uL2pzLWxpYnMvZWFzeXNheFwiKTtcbnZhciBQYXJzZXJFdmVudFR5cGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcnNlckV2ZW50VHlwZSgpIHtcbiAgICB9XG4gICAgUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCA9IFwiU3RhcnRFbGVtZW50XCI7XG4gICAgUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQgPSBcIkVuZEVsZW1lbnRcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuVGV4dCA9IFwiVGV4dFwiO1xuICAgIFBhcnNlckV2ZW50VHlwZS5DREFUQSA9IFwiQ0RBVEFcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuQ29tbWVudCA9IFwiQ29tbWVudFwiO1xuICAgIHJldHVybiBQYXJzZXJFdmVudFR5cGU7XG59KCkpO1xuZXhwb3J0cy5QYXJzZXJFdmVudFR5cGUgPSBQYXJzZXJFdmVudFR5cGU7XG52YXIgUGFyc2VyRXZlbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcnNlckV2ZW50KGV2ZW50VHlwZSwgcG9zaXRpb24sIHByZWZpeCwgbmFtZXNwYWNlLCBlbGVtZW50TmFtZSwgYXR0cmlidXRlcywgZGF0YSkge1xuICAgICAgICB0aGlzLl9ldmVudFR5cGUgPSBldmVudFR5cGU7XG4gICAgICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgIHRoaXMuX3ByZWZpeCA9IHByZWZpeDtcbiAgICAgICAgdGhpcy5fbmFtZXNwYWNlID0gbmFtZXNwYWNlO1xuICAgICAgICB0aGlzLl9lbGVtZW50TmFtZSA9IGVsZW1lbnROYW1lO1xuICAgICAgICB0aGlzLl9hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICAgICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgfVxuICAgIFBhcnNlckV2ZW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGV2ZW50VHlwZTogdGhpcy5ldmVudFR5cGUsXG4gICAgICAgICAgICBwb3NpdGlvbjogdGhpcy5wb3NpdGlvbixcbiAgICAgICAgICAgIHByZWZpeDogdGhpcy5wcmVmaXgsXG4gICAgICAgICAgICBuYW1lc3BhY2U6IHRoaXMubmFtZXNwYWNlLFxuICAgICAgICAgICAgZWxlbWVudE5hbWU6IHRoaXMuZWxlbWVudE5hbWUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0aGlzLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBkYXRhOiB0aGlzLmRhdGFcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcImV2ZW50VHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2V2ZW50VHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJwb3NpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcInByZWZpeFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ByZWZpeDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJuYW1lc3BhY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lc3BhY2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwiZWxlbWVudE5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50TmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJhdHRyaWJ1dGVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cmlidXRlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJkYXRhXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFBhcnNlckV2ZW50O1xufSgpKTtcbmV4cG9ydHMuUGFyc2VyRXZlbnQgPSBQYXJzZXJFdmVudDtcbnZhciBfYW1wQ29kZXM7XG52YXIgX2VudGl0eVNlYXJjaFJlZ0V4ID0gLyYjKFxcZCspO3wmI3goWzAxMjM0NTY3ODlhYmNkZWZdKyk7fCYoXFx3Kyk7L2lnO1xuZnVuY3Rpb24gX2dlbmVyYXRlQW1wTWFwKCkge1xuICAgIHZhciBvYmpDb2RlcyA9IHsgVGFiOiA5LCBOZXdMaW5lOiAxMCwgZXhjbDogMzMsIHF1b3Q6IDM0LCBRVU9UOiAzNCwgbnVtOiAzNSwgZG9sbGFyOiAzNiwgcGVyY2VudDogMzcsIGFtcDogMzgsIEFNUDogMzgsIGFwb3M6IDM5LCBscGFyOiA0MCwgcnBhcjogNDEsIGFzdDogNDIsIG1pZGFzdDogNDIsIHBsdXM6IDQzLCBjb21tYTogNDQsIHBlcmlvZDogNDYsIHNvbDogNDcsIGNvbG9uOiA1OCwgc2VtaTogNTksIGx0OiA2MCwgTFQ6IDYwLCBlcXVhbHM6IDYxLCBndDogNjIsIEdUOiA2MiwgcXVlc3Q6IDYzLCBjb21tYXQ6IDY0LCBsc3FiOiA5MSwgbGJyYWNrOiA5MSwgYnNvbDogOTIsIHJzcWI6IDkyLCByYnJhY2s6IDkyLCBIYXQ6IDk0LCBsb3diYXI6IDk1LCBncmF2ZTogOTYsIERpYWNyaXRpY2FsR3JhdmU6IDk2LCBsY3ViOiAxMjMsIGxicmFjZTogMTIzLCB2ZXJiYXI6IDEyNCwgdmVydDogMTI0LCBWZXJ0aWNhbExpbmU6IDEyNCwgcmN1YjogMTI1LCByYnJhY2U6IDEyNSwgbmJzcDogMTYwLCBpZXhjbDogMTYxLCBjZW50OiAxNjIsIHBvdW5kOiAxNjMsIGN1cnJlbjogMTY0LCB5ZW46IDE2NSwgYnJ2YmFyOiAxNjYsIGJya2JhcjogMTY2LCBzZWN0OiAxNjcsIHVtbDogMTY4LCBjb3B5OiAxNjksIG9yZGY6IDE3MCwgbGFxdW86IDE3MSwgbm90OiAxNzIsIHNoeTogMTczLCByZWc6IDE3NCwgbWFjcjogMTc1LCBoaWJhcjogMTc1LCBkZWc6IDE3NiwgcGx1c21uOiAxNzcsIHN1cDI6IDE3OCwgc3VwMzogMTc5LCBhY3V0ZTogMTgwLCBtaWNybzogMTgxLCBwYXJhOiAxODIsIG1pZGRvdDogMTgzLCBjZWRpbDogMTg0LCBzdXAxOiAxODUsIG9yZG06IDE4NiwgcmFxdW86IDE4NywgZnJhYzE0OiAxODgsIGZyYWMxMjogMTg5LCBmcmFjMzQ6IDE5MCwgaXF1ZXN0OiAxOTEsIEFncmF2ZTogMTkyLCBBYWN1dGU6IDE5MywgQWNpcmM6IDE5NCwgQXRpbGRlOiAxOTUsIEF1bWw6IDE5NiwgQXJpbmc6IDE5NywgQUVsaWc6IDE5OCwgQ2NlZGlsOiAxOTksIEVncmF2ZTogMjAwLCBFYWN1dGU6IDIwMSwgRWNpcmM6IDIwMiwgRXVtbDogMjAzLCBJZ3JhdmU6IDIwNCwgSWFjdXRlOiAyMDUsIEljaXJjOiAyMDYsIEl1bWw6IDIwNywgRVRIOiAyMDgsIERzdHJvazogMjA4LCBOdGlsZGU6IDIwOSwgT2dyYXZlOiAyMTAsIE9hY3V0ZTogMjExLCBPY2lyYzogMjEyLCBPdGlsZGU6IDIxMywgT3VtbDogMjE0LCB0aW1lczogMjE1LCBPc2xhc2g6IDIxNiwgVWdyYXZlOiAyMTcsIFVhY3V0ZTogMjE4LCBVY2lyYzogMjE5LCBVdW1sOiAyMjAsIFlhY3V0ZTogMjIxLCBUSE9STjogMjIyLCBzemxpZzogMjIzLCBhZ3JhdmU6IDIyNCwgYWFjdXRlOiAyMjUsIGFjaXJjOiAyMjYsIGF0aWxkZTogMjI3LCBhdW1sOiAyMjgsIGFyaW5nOiAyMjksIGFlbGlnOiAyMzAsIGNjZWRpbDogMjMxLCBlZ3JhdmU6IDIzMiwgZWFjdXRlOiAyMzMsIGVjaXJjOiAyMzQsIGV1bWw6IDIzNSwgaWdyYXZlOiAyMzYsIGlhY3V0ZTogMjM3LCBpY2lyYzogMjM4LCBpdW1sOiAyMzksIGV0aDogMjQwLCBudGlsZGU6IDI0MSwgb2dyYXZlOiAyNDIsIG9hY3V0ZTogMjQzLCBvY2lyYzogMjQ0LCBvdGlsZGU6IDI0NSwgb3VtbDogMjQ2LCBkaXZpZGU6IDI0Nywgb3NsYXNoOiAyNDgsIHVncmF2ZTogMjQ5LCB1YWN1dGU6IDI1MCwgdWNpcmM6IDI1MSwgdXVtbDogMjUyLCB5YWN1dGU6IDI1MywgdGhvcm46IDI1NCwgeXVtbDogMjU1LCBmbm9mOiA0MDIsIGltcGVkOiA0MzcsIGdhY3V0ZTogNTAxLCBqbWF0aDogNTY3LCBjaXJjOiA3MTAsIGNhcm9uOiA3MTEsIEhhY2VrOiA3MTEsIGJyZXZlOiA3MjgsIEJyZXZlOiA3MjgsIGRvdDogNzI5LCBEaWFjcml0aWNhbERvdDogNzI5LCByaW5nOiA3MzAsIG9nb246IDczMSwgdGlsZGU6IDczMiwgRGlhY3JpdGljYWxUaWxkZTogNzMyLCBkYmxhYzogNzMzLCBEaWFjcml0aWNhbERvdWJsZUFjdXRlOiA3MzMsIERvd25CcmV2ZTogNzg1LCBVbmRlckJhcjogODE4LCBBbHBoYTogOTEzLCBCZXRhOiA5MTQsIEdhbW1hOiA5MTUsIERlbHRhOiA5MTYsIEVwc2lsb246IDkxNywgWmV0YTogOTE4LCBFdGE6IDkxOSwgVGhldGE6IDkyMCwgSW90YTogOTIxLCBLYXBwYTogOTIyLCBMYW1iZGE6IDkyMywgTXU6IDkyNCwgTnU6IDkyNSwgWGk6IDkyNiwgT21pY3JvbjogOTI3LCBQaTogOTI4LCBSaG86IDkyOSwgU2lnbWE6IDkzMSwgVGF1OiA5MzIsIFVwc2lsb246IDkzMywgUGhpOiA5MzQsIENoaTogOTM1LCBQc2k6IDkzNiwgT21lZ2E6IDkzNywgYWxwaGE6IDk0NSwgYmV0YTogOTQ2LCBnYW1tYTogOTQ3LCBkZWx0YTogOTQ4LCBlcHNpbG9uOiA5NDksIGVwc2l2OiA5NDksIHZhcmVwc2lsb246IDk0OSwgemV0YTogOTUwLCBldGE6IDk1MSwgdGhldGE6IDk1MiwgaW90YTogOTUzLCBrYXBwYTogOTU0LCBsYW1iZGE6IDk1NSwgbXU6IDk1NiwgbnU6IDk1NywgeGk6IDk1OCwgb21pY3JvbjogOTU5LCBwaTogOTYwLCByaG86IDk2MSwgc2lnbWFmOiA5NjIsIHNpZ21hdjogOTYyLCB2YXJzaWdtYTogOTYyLCBzaWdtYTogOTYzLCB0YXU6IDk2NCwgdXBzaWxvbjogOTY1LCBwaGk6IDk2NiwgY2hpOiA5NjcsIHBzaTogOTY4LCBvbWVnYTogOTY5LCB0aGV0YXY6IDk3NywgdmFydGhldGE6IDk3NywgdGhldGFzeW06IDk3NywgVXBzaTogOTc4LCB1cHNpaDogOTc4LCBzdHJhaWdodHBoaTogOTgxLCBwaXY6IDk4MiwgdmFycGk6IDk4MiwgR2FtbWFkOiA5ODgsIGdhbW1hZDogOTg5LCBkaWdhbW1hOiA5ODksIGthcHBhdjogMTAwOCwgdmFya2FwcGE6IDEwMDgsIHJob3Y6IDEwMDksIHZhcnJobzogMTAwOSwgZXBzaTogMTAxMywgc3RyYWlnaHRlcHNpbG9uOiAxMDEzLCBiZXBzaTogMTAxNCwgYmFja2Vwc2lsb246IDEwMTQsIGV1cm86IDgzNjQsIHRyYWRlOiA4NDgyLCBUUkFERTogODQ4MiwgZm9yYWxsOiA4NzA0LCBwYXJ0OiA4NzA2LCBsYXJyOiA4NTkyLCByYXJyOiA4NTkzLCBoeXBoZW46IDgyMDgsIGRhc2g6IDgyMDgsIG5kYXNoOiA4MjExLCBtZGFzaDogODIxMiwgaG9yYmFyOiA4MjEzLCBWZXJ0OiA4MjE0LCBWZXJiYXI6IDgyMTQsIGxzcXVvOiA4MjE2LCBPcGVuQ3VybHlRdW90ZTogODIxNiwgcnNxdW86IDgyMTcsIHJzcXVvcjogODIxNywgQ2xvc2VDdXJseVF1b3RlOiA4MjE3LCBsc3F1b3I6IDgyMTgsIHNicXVvOiA4MjE4LCBsZHF1bzogODIyMCwgT3BlbkN1cmx5RG91YmxlUXVvdGU6IDgyMjAsIHJkcXVvOiA4MjIxLCByZHF1b3I6IDgyMjEsIENsb3NlQ3VybHlEb3VibGVRdW90ZTogODIyMSwgbGRxdW9yOiA4MjIyLCBiZHF1bzogODIyMiwgZGFnZ2VyOiA4MjI0LCBEYWdnZXI6IDgyMjUsIGRkYWdnZXI6IDgyMjUsIGJ1bGw6IDgyMjYsIGJ1bGxldDogODIyNiwgbmxkcjogODIyOSwgaGVsbGlwOiA4MjMwLCBtbGRyOiA4MjMwLCBoeWJ1bGw6IDgyNTksIHRkb3Q6IDg0MTEsIFRyaXBsZURvdDogODQxMSwgRG90RG90OiA4NDEyLCBzdGFyOiA5NzM0LCBwaG9uZTogOTc0Miwgc3BhZGVzOiA5ODI0LCBjbHViczogOTgyNywgaGVhcnRzOiA5ODI5LCBkaWFtczogOTgzMCwgZmVtYWxlOiA5NzkyLCBtYWxlOiA5Nzk0LCBjaGVjazogMTAwMDMsIGNoZWNrbWFyazogMTAwMDMsIGNyb3NzOiAxMDAwNywgVmVydGljYWxTZXBhcmF0b3I6IDEwMDcyLCBFbXB0eVNtYWxsU3F1YXJlOiA5NzIzLCBGaWxsZWRTbWFsbFNxdWFyZTogOTcyNCwgc3RhcmY6IDk3MzMsIGJpZ3N0YXI6IDk3MzMsIHNxdWFyZTogOTYzMywgc3F1OiA5NjMzLCBTcXVhcmU6IDk2MzMgfTtcbiAgICB2YXIgYW1wQ29kZXMgPSBuZXcgTWFwKCk7XG4gICAgZm9yICh2YXIga2V5IGluIG9iakNvZGVzKSB7XG4gICAgICAgIGlmIChvYmpDb2Rlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBhbXBDb2Rlcy5zZXQoa2V5LCBvYmpDb2Rlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYW1wQ29kZXM7XG59XG5pZiAoZ2xvYmFsLl9fc25hcHNob3QpIHtcbiAgICBfYW1wQ29kZXMgPSBfZ2VuZXJhdGVBbXBNYXAoKTtcbn1cbmZ1bmN0aW9uIF9IYW5kbGVBbXBFbnRpdGllcyhmb3VuZCwgZGVjaW1hbFZhbHVlLCBoZXhWYWx1ZSwgd29yZFZhbHVlKSB7XG4gICAgaWYgKHdvcmRWYWx1ZSkge1xuICAgICAgICBpZiAoIV9hbXBDb2Rlcykge1xuICAgICAgICAgICAgX2FtcENvZGVzID0gX2dlbmVyYXRlQW1wTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlcyA9IF9hbXBDb2Rlcy5nZXQod29yZFZhbHVlKTtcbiAgICAgICAgaWYgKHJlcykge1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUocmVzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfVxuICAgIGlmIChkZWNpbWFsVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoZGVjaW1hbFZhbHVlLCAxMCkpO1xuICAgIH1cbiAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChoZXhWYWx1ZSwgMTYpKTtcbn1cbnZhciBYbWxQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFhtbFBhcnNlcihvbkV2ZW50LCBvbkVycm9yLCBwcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmFtZXNwYWNlcyA9IHByb2Nlc3NOYW1lc3BhY2VzO1xuICAgICAgICB0aGlzLl9wYXJzZXIgPSBuZXcgZWFzeXNheC5FYXN5U0FYUGFyc2VyKCk7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwic3RhcnROb2RlXCIsIGZ1bmN0aW9uIChlbGVtLCBhdHRyLCB1cSwgdGFnZW5kLCBzdHIsIHBvcykge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBhdHRyKCk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXNba2V5XSA9IFhtbFBhcnNlci5fZGVyZWZlcmVuY2VFbnRpdGllcyhhdHRyaWJ1dGVzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByZWZpeCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lc3BhY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IGVsZW07XG4gICAgICAgICAgICBpZiAodGhhdC5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhY2tFbnRyeSA9IFhtbFBhcnNlci5fZ2V0TmFtZXNwYWNlc1N0YWNrRW50cnkoYXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgdGhhdC5fbmFtZXNwYWNlU3RhY2sucHVzaChzdGFja0VudHJ5KTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzb2x2ZWQgPSB0aGF0Ll9yZXNvbHZlTmFtZXNwYWNlKG5hbWUpO1xuICAgICAgICAgICAgICAgIHByZWZpeCA9IHJlc29sdmVkLnByZWZpeDtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2UgPSByZXNvbHZlZC5uYW1lc3BhY2U7XG4gICAgICAgICAgICAgICAgbmFtZSA9IHJlc29sdmVkLm5hbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50LCBwb3MoKSwgcHJlZml4LCBuYW1lc3BhY2UsIG5hbWUsIGF0dHJpYnV0ZXMsIHVuZGVmaW5lZCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwidGV4dE5vZGVcIiwgZnVuY3Rpb24gKHRleHQsIHVxLCBwb3MpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gdXEoWG1sUGFyc2VyLl9kZXJlZmVyZW5jZUVudGl0aWVzKHRleHQpKTtcbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5UZXh0LCBwb3MoKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJlbmROb2RlXCIsIGZ1bmN0aW9uIChlbGVtLCB1cSwgdGFnc3RhcnQsIHN0ciwgcG9zKSB7XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIG5hbWVzcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZWxlbTtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZCA9IHRoYXQuX3Jlc29sdmVOYW1lc3BhY2UobmFtZSk7XG4gICAgICAgICAgICAgICAgcHJlZml4ID0gcmVzb2x2ZWQucHJlZml4O1xuICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHJlc29sdmVkLm5hbWVzcGFjZTtcbiAgICAgICAgICAgICAgICBuYW1lID0gcmVzb2x2ZWQubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50LCBwb3MoKSwgcHJlZml4LCBuYW1lc3BhY2UsIG5hbWUsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKSk7XG4gICAgICAgICAgICBpZiAodGhhdC5fcHJvY2Vzc05hbWVzcGFjZXMpIHtcbiAgICAgICAgICAgICAgICB0aGF0Ll9uYW1lc3BhY2VTdGFjay5wb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcImNkYXRhXCIsIGZ1bmN0aW9uIChkYXRhLCByZXMsIHBvcykge1xuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLkNEQVRBLCBwb3MoKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBkYXRhKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJjb21tZW50XCIsIGZ1bmN0aW9uICh0ZXh0LCB1cSwgcG9zKSB7XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuQ29tbWVudCwgcG9zKCksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGV4dCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhcnNlci5vbihcImVycm9yXCIsIGZ1bmN0aW9uIChtc2csIHBvcykge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKG1zZyksIHBvcygpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShYbWxQYXJzZXIucHJvdG90eXBlLCBcImFuZ3VsYXJTeW50YXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXJzZXIuYW5ndWxhclN5bnRheDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhcnNlci5hbmd1bGFyU3ludGF4ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFhtbFBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoeG1sU3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLl9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgdGhpcy5fbmFtZXNwYWNlU3RhY2sgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYXJzZXIucGFyc2UoeG1sU3RyaW5nKTtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5fZ2V0TmFtZXNwYWNlc1N0YWNrRW50cnkgPSBmdW5jdGlvbiAoYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgc3RhY2tFbnRyeSA9IHt9O1xuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBzdGFja0VudHJ5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lO1xuICAgICAgICB2YXIgbmFtZXNwYWNlUHJlZml4O1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF0dHJpYnV0ZU5hbWUgPSBrZXk7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlTmFtZS5pbmRleE9mKFwieG1sbnNcIikgIT09IDApIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5hbWVzcGFjZVByZWZpeCA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlTmFtZS5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBuYW1lc3BhY2VQcmVmaXggPSBhdHRyaWJ1dGVOYW1lLnNwbGl0KFwiOlwiKVsxXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YWNrRW50cnlbbmFtZXNwYWNlUHJlZml4XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhY2tFbnRyeTtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5wcm90b3R5cGUuX3Jlc29sdmVOYW1lc3BhY2UgPSBmdW5jdGlvbiAoZnVsbE5hbWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHsgcHJlZml4OiB1bmRlZmluZWQsIG5hbWVzcGFjZTogdW5kZWZpbmVkLCBuYW1lOiB1bmRlZmluZWQgfTtcbiAgICAgICAgcmVzdWx0LnByZWZpeCA9IFwiXCI7XG4gICAgICAgIGlmIChmdWxsTmFtZS5pbmRleE9mKFwiOlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IGZ1bGxOYW1lLnNwbGl0KFwiOlwiKTtcbiAgICAgICAgICAgIHJlc3VsdC5wcmVmaXggPSBzcGxpdFswXTtcbiAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gc3BsaXRbMV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQubmFtZSA9IGZ1bGxOYW1lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGFja0VudHJ5O1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbmFtZXNwYWNlU3RhY2subGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHN0YWNrRW50cnkgPSB0aGlzLl9uYW1lc3BhY2VTdGFja1tpXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzdGFja0VudHJ5KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFzdGFja0VudHJ5Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQucHJlZml4ID09PSBrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWVzcGFjZSA9IHN0YWNrRW50cnlba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFhtbFBhcnNlci5fZGVyZWZlcmVuY2VFbnRpdGllcyA9IGZ1bmN0aW9uIChzKSB7XG4gICAgICAgIHMgPSBTdHJpbmcocyk7XG4gICAgICAgIGlmIChzLmxlbmd0aCA+IDMgJiYgcy5pbmRleE9mKFwiJlwiKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UoX2VudGl0eVNlYXJjaFJlZ0V4LCBfSGFuZGxlQW1wRW50aXRpZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzO1xuICAgIH07XG4gICAgcmV0dXJuIFhtbFBhcnNlcjtcbn0oKSk7XG5leHBvcnRzLlhtbFBhcnNlciA9IFhtbFBhcnNlcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXhtbC5qcy5tYXAiLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5cygpIHtcclxuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xyXG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxyXG4gICAgICAgIGZvciAodmFyIGEgPSBhcmd1bWVudHNbaV0sIGogPSAwLCBqbCA9IGEubGVuZ3RoOyBqIDwgamw7IGorKywgaysrKVxyXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcclxuICAgIHJldHVybiByO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9